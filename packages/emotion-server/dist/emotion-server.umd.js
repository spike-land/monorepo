!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("through"),require("html-tokenize"),require("multipipe"),require("@zedvision/emotion-cache"),require("@zedvision/emotion-serialize"),require("@zedvision/emotion-utils")):"function"==typeof define&&define.amd?define(["exports","through","html-tokenize","multipipe","@zedvision/emotion-cache","@zedvision/emotion-serialize","@zedvision/emotion-utils"],t):t((e||self).emotionServer={},e.through,e.htmlTokenize,e.multipipe,e.e,e.emotionSerialize,e.emotionUtils)}(this,function(e,t,r,i,n,o,s){function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=u(t),l=u(r),d=u(i),c=u(n),f=function(e){return function(t){for(var r,i=new RegExp(e.key+"-([a-zA-Z0-9-_]+)","gm"),n={html:t,ids:[],css:""},o={};null!==(r=i.exec(t));)void 0===o[r[1]]&&(o[r[1]]=!0);return n.ids=Object.keys(e.inserted).filter(function(t){if((void 0!==o[t]||void 0===e.registered[e.key+"-"+t])&&!0!==e.inserted[t])return n.css+=e.inserted[t],!0}),n}};function y(e,t,r,i){return'<style data-emotion="'+e+" "+t.substring(1)+'"'+i+">"+r+"</style>"}var v=function(e,t){return function(r){var i=e.inserted,n=e.key,o=e.registered,s=new RegExp("<|"+n+"-([a-zA-Z0-9-_]+)","gm"),u={},a="",l="",d="";for(var c in i)if(i.hasOwnProperty(c)){var f=i[c];!0!==f&&void 0===o[n+"-"+c]&&(d+=f,l+=" "+c)}""!==d&&(a=y(n,l,d,t));for(var v,m="",g="",h=0;null!==(v=s.exec(r));)if("<"!==v[0]){var p=v[1],S=i[p];!0===S||void 0===S||u[p]||(u[p]=!0,g+=S,m+=" "+p)}else""!==m&&(a+=y(n,m,g,t),m="",g=""),a+=r.substring(h,v.index),h=v.index;return a+r.substring(h)}},m=function(e,t){return function(){var r={},i=l.default(),n=a.default(function(i){var n=i[1];if("open"===i[0]){for(var o,s="",u={},a=n.toString(),l=new RegExp(e.key+"-([a-zA-Z0-9-_]+)","gm");null!==(o=l.exec(a));)null!==o&&void 0===r[o[1]]&&(u[o[1]]=!0);Object.keys(e.inserted).forEach(function(t){!0!==e.inserted[t]&&void 0===r[t]&&(!0===u[t]||void 0===e.registered[e.key+"-"+t]&&(u[t]=!0))&&(r[t]=!0,s+=e.inserted[t])}),""!==s&&this.queue('<style data-emotion="'+e.key+" "+Object.keys(u).join(" ")+'"'+t+">"+s+"</style>")}this.queue(n)},function(){this.queue(null)});return d.default(i,n)}};function g(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function h(e,t,r){var i=[],n=s.getRegisteredStyles(e,i,r);return i.length<2?r:n+t(i)}var p=function e(t){for(var r="",i=0;i<t.length;i++){var n=t[i];if(null!=n){var o=void 0;switch(typeof n){case"boolean":break;case"object":if(Array.isArray(n))o=e(n);else for(var s in o="",n)n[s]&&s&&(o&&(o+=" "),o+=s);break;default:o=n}o&&(r&&(r+=" "),r+=o)}}return r},S=function(e){!0!==e.compat&&(e.compat=!0);var t=void 0!==e.nonce?' nonce="'+e.nonce+'"':"";return{extractCritical:f(e),renderStylesToString:v(e,t),renderStylesToNodeStream:m(e,t)}}(function(e){var t=c.default({key:"css"});t.sheet.speedy=function(e){if("production"!==process.env.NODE_ENV&&0!==this.ctr)throw new Error("speedy must be changed before any rules are inserted");this.isSpeedy=e},t.compat=!0;var r=function(){var e=o.serializeStyles([].slice.call(arguments),t.registered,void 0);return s.insertStyles(t,e,!1),t.key+"-"+e.name};return{css:r,cx:function(){return h(t.registered,r,p([].slice.call(arguments)))},injectGlobal:function(){var e=o.serializeStyles([].slice.call(arguments),t.registered);g(t,e)},keyframes:function(){var e=o.serializeStyles([].slice.call(arguments),t.registered),r="animation-"+e.name;return g(t,{name:e.name,styles:"@keyframes "+r+"{"+e.styles+"}"}),r},hydrate:function(e){e.forEach(function(e){t.inserted[e]=!0})},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:s.getRegisteredStyles.bind(null,t.registered),merge:h.bind(null,t.registered,r)}}().cache),b=S.renderStylesToString,k=S.renderStylesToNodeStream;e.extractCritical=S.extractCritical,e.renderStylesToNodeStream=k,e.renderStylesToString=b});
//# sourceMappingURL=emotion-server.umd.js.map
