import{jsx as v}from"https://unpkg.com/@spike.land/esm@0.4.33/dist/emotion-react.mjs";var i,y,p,w,s,O=async(t,r)=>(s=s||(await import("./session-YJULAMST.mjs")).default,s(t,r)),S=async t=>(i=i||(await import("./formatter-LUAJ56NO.mjs")).formatter,await i(t));async function E(t){let r=document.getElementById("shadowEditor"),a=await(await import("./startMonaco-4UBCXQJ3.mjs")).default({language:"typescript",container:r,code:t.code,onChange:(o,c)=>u(o,c,t,++t.i)});t.editor=a(),window.monaco.languages.registerOnTypeFormattingEditProvider("typescript",{autoFormatTriggerCharacters:["}","{",")","(",";"],async provideOnTypeFormattingEdits(o){let c=await i(o.getValue());return[{range:o.getFullModelRange(),text:c}]}}),window.sess=t,t.monaco=window.monaco}async function x({monaco:t,editor:r}){if(!t)return[{messageText:"Error with the error checking. Try to reload!"}];let e=r.getModel(),n=await(await t.languages.typescript.getTypeScriptWorker())(e),o=e.uri.toString(),c=n.getSemanticDiagnostics(o),d=n.getCompilerOptionsDiagnostics(o),l=n.getSyntacticDiagnostics(o),m=await Promise.race([c,d,l]);return console.log(m),[]}async function u(t,r=null,e,a){e.changes.push(r),i=i||(await import("./formatter-LUAJ56NO.mjs")).formatter,p=p||(await import("./esbuildEsm-7JIFWDZW.mjs")).transform,y=p,e.errorText="";let{monaco:n}=e;try{let o=await i(t),c=await y(o),d=!1;if(c.length){if(a<e.i)return;try{if(w=w||(await import("./renderToString-Z2FGBLHB.mjs")).getHtmlAndCss,a<e.i)return;let m=await U(c),{html:g,css:h}=w(m);e.transpiled=c,e.html=g;let f=await R(c);e.setChild(C=>[...C,f]),e.children=f,d=!g,e.code=o,e.codeNonFormatted=t;let b=o;if(e.css=h,e.i!==a)return;e.saveCode&&await e.saveCode({transpiled:c,code:b,i:a,css:h,html:g}),n.editor.setTheme("vs-dark");return}catch(m){console.error("EXCEPTION"),console.log({e:m}),d=!0,console.error({restartError:d})}}if(e.i>a)return;let l=await x(e);if(e.i>a)return;d&&l.push({messageText:"Error while starting the app. Check the console!"}),l.length&&console.log({err:l}),n.editor.setTheme("vs-dark")}catch(o){n.editor.setTheme("vs-light"),setTimeout(()=>{n.editor.setTheme("hc-black")},50),e.errorText=o.message,console.error(o.message)}}var L=async({code:t})=>{let r={code:t,i:0,changes:[],saveCode:()=>{},setChild:()=>{}};await u(t,null,r),await k(r)};async function k(t,r,e,a){t.saveCode=a,t.children=null;let{renderPreviewWindow:n}=await import("./renderPreviewWindow-SBAY73NO.mjs");await n(t,r,e),e||await E(t),t.update=o=>u(o,null,t),t.update(t.code)}async function R(t,r="window"){let e=r==="window"?t.replace("body{","#zbody{"):t,a=T(e),n=await import(a);return URL.revokeObjectURL(a),v(n.default)}function T(t){let r=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(r)}async function U(t,r="window"){let e=r==="window"?t.replace("body{","#zbody{"):t,a=T(e),n=(await import(a)).default;return URL.revokeObjectURL(a),n}export{O as initSession,S as prettier,k as quickStart,L as startFromCode,E as startMonacoWithSession};
//# sourceMappingURL=quickStart.mjs.map
