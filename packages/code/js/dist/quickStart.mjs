import{jsx as v}from"https://unpkg.com/@spike.land/esm@0.4.33/dist/emotion-react.mjs";var i,y,s,g,p,O=async(t,r)=>(p=p||(await import("./session-YJULAMST.mjs")).default,p(t,r)),S=async t=>(i=i||(await import("./formatter-LUAJ56NO.mjs")).formatter,await i(t));async function E(t){let r=document.getElementById("shadowEditor"),o=await(await import("./startMonaco-4UBCXQJ3.mjs")).default({language:"typescript",container:r,code:t.code,onChange:(a,c)=>u(a,c,t,++t.i)});t.editor=o(),window.monaco.languages.registerOnTypeFormattingEditProvider("typescript",{autoFormatTriggerCharacters:["}","{",")","(",";"],async provideOnTypeFormattingEdits(a){let c=await i(a.getValue());return[{range:a.getFullModelRange(),text:c}]}}),window.sess=t,t.monaco=window.monaco}async function x({monaco:t,editor:r}){if(!t)return[{messageText:"Error with the error checking. Try to reload!"}];let e=r.getModel(),n=await(await t.languages.typescript.getTypeScriptWorker())(e),a=e.uri.toString(),c=n.getSemanticDiagnostics(a),d=n.getCompilerOptionsDiagnostics(a),l=n.getSyntacticDiagnostics(a),m=await Promise.race([c,d,l]);return console.log(m),[]}async function u(t,r=null,e,o){e.changes.push(r),i=i||(await import("./formatter-LUAJ56NO.mjs")).formatter,s=s||(await import("./esbuildEsm-7JIFWDZW.mjs")).transform,y=s,window.sendChannel,e.errorText="";let{monaco:n}=e;try{let a=await i(t),c=await y(a),d=!1;if(c.length){if(o<e.i)return;try{if(g=g||(await import("./renderToString-Z2FGBLHB.mjs")).getHtmlAndCss,o<e.i)return;let m=await U(c),{html:w,css:h}=g(m);e.transpiled=c,e.html=w;let f=await R(c);e.setChild(b=>[...b,f]),e.children=f,d=!w,e.code=a,e.codeNonFormatted=t;let C=a;if(e.css=h,e.i!==o)return;e.saveCode&&await e.saveCode({transpiled:c,code:C,i:o,css:h,html:w}),n.editor.setTheme("vs-dark");return}catch(m){console.error("EXCEPTION"),console.log({e:m}),d=!0,console.error({restartError:d})}}if(e.i>o)return;let l=await x(e);if(e.i>o)return;d&&l.push({messageText:"Error while starting the app. Check the console!"}),l.length&&console.log({err:l}),n.editor.setTheme("vs-dark")}catch(a){n.editor.setTheme("vs-light"),setTimeout(()=>{n.editor.setTheme("hc-black")},50),e.errorText=a.message,console.error(a.message)}}var L=async({code:t})=>{let r={code:t,i:0,changes:[],saveCode:()=>{},setChild:()=>{}};await u(t,null,r),await k(r)};async function k(t,r,e,o){t.saveCode=o,t.children=null;let{renderPreviewWindow:n}=await import("./renderPreviewWindow-SBAY73NO.mjs");await n(t,r,e),e||await E(t),t.update=a=>u(a,null,t)}async function R(t,r="window"){let e=r==="window"?t.replace("body{","#zbody{"):t,o=T(e),n=await import(o);return URL.revokeObjectURL(o),v(n.default)}function T(t){let r=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(r)}async function U(t,r="window"){let e=r==="window"?t.replace("body{","#zbody{"):t,o=T(e),n=(await import(o)).default;return URL.revokeObjectURL(o),n}export{O as initSession,S as prettier,k as quickStart,L as startFromCode,E as startMonacoWithSession};
//# sourceMappingURL=quickStart.mjs.map
