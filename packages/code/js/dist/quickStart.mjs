import{jsx as v}from"https://unpkg.com/@spike.land/esm@0.4.33/dist/emotion-react.mjs";var i,f,w,g,p,O=async(t,r)=>(p=p||(await import("./session-YJULAMST.mjs")).default,p(t,r)),S=async t=>(i=i||(await import("./formatter-LUAJ56NO.mjs")).formatter,await i(t));async function E(t){let r=document.getElementById("shadowEditor"),o=await(await import("./startMonaco-4UBCXQJ3.mjs")).default({language:"typescript",container:r,code:t.code,onChange:(n,c)=>y(n,c,t,++t.i)});t.editor=o(),window.monaco.languages.registerOnTypeFormattingEditProvider("typescript",{autoFormatTriggerCharacters:["}","{",")","(",";"],async provideOnTypeFormattingEdits(n){let c=await i(n.getValue());return[{range:n.getFullModelRange(),text:c}]}}),window.sess=t,t.monaco=window.monaco}async function x({monaco:t,editor:r}){if(!t)return[{messageText:"Error with the error checking. Try to reload!"}];let e=r.getModel(),a=await(await t.languages.typescript.getTypeScriptWorker())(e),n=e.uri.toString(),c=a.getSemanticDiagnostics(n),d=a.getCompilerOptionsDiagnostics(n),l=a.getSyntacticDiagnostics(n),s=await Promise.race([c,d,l]);return console.log(s),[]}async function y(t,r=null,e,o){e.changes.push(r),i=i||(await import("./formatter-LUAJ56NO.mjs")).formatter,w=w||(await import("./esbuildEsm-7JIFWDZW.mjs")).transform,f=w,window.sendChannel,e.errorText="";let{monaco:a}=e;try{let n=await i(t),c=await f(n),d=!1;if(c.length){if(o<e.i)return;try{if(g=g||(await import("./renderToString-Z2FGBLHB.mjs")).getHtmlAndCss,o<e.i)return;let s=await U(c),{html:m,css:u}=g(s);e.transpiled=c,e.html=m;let h=await R(c);e.setChild(b=>[...b,h]),e.children=h,d=!m,e.code=n,e.codeNonFormatted=t;let C=n;if(e.css=u,e.i!==o)return;e.saveCode&&await e.saveCode({transpiled:c,code:C,i:o,css:u,html:m}),a.editor.setTheme("vs-dark");return}catch(s){console.error("EXCEPTION"),console.log({e:s}),d=!0,console.error({restartError:d})}}if(e.i>o)return;let l=await x(e);if(e.i>o)return;d&&l.push({messageText:"Error while starting the app. Check the console!"}),l.length&&console.log({err:l}),a.editor.setTheme("vs-dark")}catch(n){a.editor.setTheme("vs-light"),setTimeout(()=>{a.editor.setTheme("hc-black")},50),e.errorText=n.message,console.error(n.message)}}var L=async({code:t})=>{let r={code:t,i:0,changes:[],saveCode:()=>{},setChild:()=>{}};await y(t,null,r),await k(r)};async function k(t,r,e,o){t.saveCode=o,t.children=null;let{renderPreviewWindow:a}=await import("./renderPreviewWindow-SBAY73NO.mjs");await a(t,r,e),e||await E(t)}async function R(t,r="window"){let e=r==="window"?t.replace("body{","#zbody{"):t,o=T(e),a=await import(o);return URL.revokeObjectURL(o),v(a.default)}function T(t){let r=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(r)}async function U(t,r="window"){let e=r==="window"?t.replace("body{","#zbody{"):t,o=T(e),a=(await import(o)).default;return URL.revokeObjectURL(o),a}export{O as initSession,S as prettier,k as quickStart,L as startFromCode,E as startMonacoWithSession};
//# sourceMappingURL=quickStart.mjs.map
