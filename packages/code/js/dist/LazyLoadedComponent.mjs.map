{
  "version": 3,
  "sources": ["../LazyLoadedComponent.tsx"],
  "sourcesContent": ["interface ILaztCom {\n  name: string;\n  html: string;\n  transpiled: string;\n  hash: number;\n}\n\nexport const LazySpikeLandComponent = (\n  { name, html, hash, transpiled }: ILaztCom,\n) => {\n  const [hashCode, setHash] = React.useState(hash);\n\n  React.useEffect(() => {\n    const intervalHandler = setInterval(async () => {\n      const resp = await fetch(\n        `https://code.spike.land/api/room/${name}/hashCodeSession`,\n      );\n      const text = await resp.text();\n      setHash(Number(text));\n    }, 69_000);\n    return () => {\n      console.log(\"INTERVAL CLEARED\");\n      clearInterval(intervalHandler);\n    };\n  }, []);\n\n  React.useEffect(() => {\n    (async () => {\n      const resp = await fetch(\n        `https://code.spike.land/api/room/${name}/session`,\n      );\n      const { html, css, transpiled } = await resp.json();\n      setHtmlCss({\n        html:\n          `<div id=\"root\"><style>${css}</style><div id=\"zbody\">${html}</div></div>`,\n        LazyComponent: await getApp(transpiled),\n      });\n    })();\n  }, [hashCode]);\n\n  const LazyStarter = () =>\n    transpiled ? React.lazy(() => getApp(transpiled)) : <div></div>;\n\n  const [fallCont, setHtmlCss] = React.useState({\n    html,\n    LazyComponent: LazyStarter, // transpiled?  ,\n  });\n\n  const { LazyComponent } = fallCont;\n\n  return (\n    <React.Suspense\n      key={hashCode}\n      fallback={<div dangerouslySetInnerHTML={{ __html: fallCont.html }}></div>}\n    >\n      <LazyComponent key={hashCode} />\n    </React.Suspense>\n  );\n\n  function createJsBlob(code) {\n    const blob = new Blob([code], { type: \"application/javascript\" });\n\n    return URL.createObjectURL(blob);\n  }\n\n  async function getApp(transpiled) {\n    const objUrl = createJsBlob(transpiled);\n\n    const App = (await import(objUrl)).default;\n\n    URL.revokeObjectURL(objUrl);\n\n    return App;\n  }\n};\nexport default (props: { transpiled: string; hash: number; html: string }) => (\n  <LazySpikeLandComponent {...props}></LazySpikeLandComponent>\n);\n"],
  "mappings": "AAOO,GAAM,GAAyB,CACpC,CAAE,OAAM,OAAM,OAAM,gBACjB,CACH,GAAM,CAAC,EAAU,GAAW,MAAM,SAAS,GAE3C,MAAM,UAAU,IAAM,CACpB,GAAM,GAAkB,YAAY,SAAY,CAI9C,GAAM,GAAO,KAAM,AAHN,MAAM,OACjB,oCAAoC,sBAEd,OACxB,EAAQ,OAAO,KACd,MACH,MAAO,IAAM,CACX,QAAQ,IAAI,oBACZ,cAAc,KAEf,IAEH,MAAM,UAAU,IAAM,CACpB,AAAC,UAAY,CACX,GAAM,GAAO,KAAM,OACjB,oCAAoC,aAEhC,CAAE,OAAM,MAAK,cAAe,KAAM,GAAK,OAC7C,EAAW,CACT,KACE,yBAAyB,4BAA8B,gBACzD,cAAe,KAAM,GAAO,UAG/B,CAAC,IAEJ,GAAM,GAAc,IAClB,EAAa,MAAM,KAAK,IAAM,EAAO,IAAe,oBAAC,MAAD,MAEhD,CAAC,EAAU,GAAc,MAAM,SAAS,CAC5C,OACA,cAAe,IAGX,CAAE,iBAAkB,EAE1B,MACE,qBAAC,MAAM,SAAP,CACE,IAAK,EACL,SAAU,oBAAC,MAAD,CAAK,wBAAyB,CAAE,OAAQ,EAAS,SAE3D,oBAAC,EAAD,CAAe,IAAK,KAIxB,WAAsB,EAAM,CAC1B,GAAM,GAAO,GAAI,MAAK,CAAC,GAAO,CAAE,KAAM,2BAEtC,MAAO,KAAI,gBAAgB,GAG7B,iBAAsB,EAAY,CAChC,GAAM,GAAS,EAAa,GAEtB,EAAO,MAAM,QAAO,IAAS,QAEnC,WAAI,gBAAgB,GAEb,IAGJ,EAAQ,AAAC,GACd,oBAAC,EAAD,IAA4B",
  "names": []
}
