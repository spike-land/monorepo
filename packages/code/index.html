<!DOCTYPE html>
<html>

<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
  <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1">
  <meta content="utf-8" http-equiv="encoding">

  <script crossorigin src="https://unpkg.com/react@17.0.1/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17.0.1/umd/react-dom.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/@emotion/react@11.0.0/dist/emotion-react.umd.min.js"></script>
  <script crossorigin src="https://unpkg.com/@emotion/styled@11.0.0/dist/emotion-styled.umd.min.js"></script>


  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />
  
  <link rel="icon" href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABFFBMVEX/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/Bwf/ZGT/l5f/lpb/WFj/AwP/Li7/6ur/////3d3/Hx//Nzf/8vL/5+f/Jyf/zMz/9/f/9vb/9fX/+fn/39//IiL/QED/Pj7/Vlb/1dX/n5//Bgb/FRX/pKT//f3/ubn/ICD/Fxf/qan//v7/trb/GBj/qqr/srL/HR3/GRn/q6v/rq7/Gxv/Ghr/ra3/r6//paX/Fhb/sLD/oaH/FBT/HBz/sbH/nZ3/EhL//Pz/mJj/EBD/+vr/kZH/DQ3/g4P/vb3/QUH/MzP/NTX/ysr/9PT/7+//8fH/8PD/ycn/1tb/PT3/ERH/zc3/AQH/U1P/o6P/oqL/dHT/CwsnXuIzAAAAB3RSTlMRie2K+ev+okjQYAAAAAFiS0dEEJWyDSwAAAAHdElNRQfkCw8HNStlcP8AAAABA0lEQVQ4y42T11ICQRBFhziIoLiiSBCVjEjOIqCikiSoRP3//7Cma6mix+odz+s9s1vdt5oxk5mTmE2MWazcAKuF2bghNmY3FuyMK/iv4DhwHmJcbiQcHXskTjQknHpl4ewcCZrvwq8TCIIQwl/gl2Gdq+sbECJRYopYPCHyZIoYM32bEfndLpeFbA7yfIFYVLEE/y9XiE1WayLO5LLEqqt1yBtNoovKvcgTrQeirHYH8u4j0WY7L/Kn5x5Rdxrev7y+EXXzPsw3GI7GOgUs9N5BmExnc2Dm/Ughofkp1z35QsJiKQvTMRJW69Zmu8/m+0cacyVBtPkX9eEoT095vKrz/wWYHD/qOZ0BPQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0xMS0xNVQwNzo1Mzo0MyswMTowMKnrqaIAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMTEtMTVUMDc6NTM6NDMrMDE6MDDYthEeAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC" />
  <style>
    #container {
      background-color: #1e1e1e;
      width: 100%;
      height: 80vh;
    }


    #wrap {
      display: block;
      width: 100%;
      resize: vertical;
      height: 20vh;
      text-align: center;
      background-color: dimgray;
      overflow-y: scroll;
      
    }


    #root {
 
      display: inline-block;
      margin: 20px auto
    }

    #error {
      display: none;
      background-color: red;
      opacity: 0.7;
    }


    #ace {
      display: none;
      background-color: #1e1e1e;
      width: 100vw;
      height: 80vh;
    }

    .almosthidden {
      opacity: 0.5;
    }

    button {
      font-size: large;
    }
  </style>
</head>

<body>
  <div id="error" class="draggable"></div>
 
  <div id="wrap">  
<div id="root"></div>    

  </div>



  <div id="container"></div>

  <div id="ace"></div>

  <script type="module">
    import * as Comlink from "https://unpkg.com/comlink@4.3.0/dist/esm/comlink.mjs";




    async function initComlink() {
      const { port1, port2 } = new MessageChannel();
      const msg = {
        comlinkInit: true,
        port: port1,
      };

      navigator.serviceWorker.ready.then(registration => {
        registration.active.postMessage(msg, [port1]);
      });


      const swProxy = Comlink.wrap(port2);

      window["SHATEST"] = {
        get: async (key) => await swProxy.get(key),
        put: async (key, value) => await swProxy.put(key, value)
      }

      await swProxy.inc();
    }

    if (navigator.serviceWorker) {
      navigator.serviceWorker.addEventListener("controllerchange", initComlink);
      navigator.serviceWorker.register("sw.js");
      initComlink()
    }


// navigator.serviceWorker.getRegistrations().then(function (registrations) {
//     for (let registration of registrations) {
//       registration.unregister();
//     }
//   });

  </script>

  <script type="module">
    // window["motion"] = window["Motion"].motion;
    window["css"] = window["emotionReact"].css;
    window["jsx"] = window["emotionReact"].jsx;

    window["styled"] = window["emotionStyled"];

    //inject
    //inject



    async function restartCode(transpileCode) {

      //  console.log(replaced);
      const restart = new Function(
        "transpileCode",
        `return function() {  
        !!!{transpileCode}
      }`,
      )()
      restart();
    }


  </script>
  <script type="module">

    const runner = async () => {
      const cdnAddress = "https://unpkg.com/@zedvision/code";
      const script = "/dist/_cBundle.js.min.js";


      if (window.location.href.includes("0.0.0.0") || window.location.href.includes("localhost")) {
        const { run } = await import("./dist/_cBundle.js")
        run();
      } else {
        try{
          const version = "@latest";
          const { run } = await import(cdnAddress   +  version + script)
        run();
        } catch(e){
          
          //If the CDN doesn't have or package yet
          const { run } = await import(cdnAddress  + "@lat"+"est"  +  version + script)
          run();
        }
   
      }


    }


    runner();
  </script>
</body>

</html>