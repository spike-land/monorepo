const bt=r=>{const n=()=>jsx(React.Fragment,null,jsx(motion.div,{css:`
            background: red;
            border: 4px solid red;
            border-radius: 8px;
          `,animate:{scale:1,top:1,left:600},dragElastic:.5,dragMomentum:!1,initial:{top:1,left:0,scale:.7},transition:{duration:.5},drag:!0,dragConstraints:{left:-window.innerWidth+200,right:0,bottom:window.innerHeight-200,top:0}},jsx("div",{css:`
      display: block;
      with: 100%;
      text-align: right;
      background: linear-gradient(0deg, darkred, red);
    `},jsx("button",{css:`
              background: darkred;
              margin-top: -4px;
              color: white;
              cursor: pointer;
              font-weight: bold;
              font-family: Roboto;
              padding: 8px 16px;
              outline: none;
              border: none;
              border-radius: 0px 8px 0px 0px;
            `,onClick:()=>r()},"\u{1F30E} SHARE")),jsx("div",{css:`  
      min-width: 200px;
      padding: 30px;
      max-width: 600px;
      background: white;
      max-height: 800px;
      border-radius: 0px 0px 8px 8px;
      overflow-y: overlay;
    `,id:"root"})));Ht.render(jsx(n),he.getElementById("dragabbleWindow"))};function St(){const r=new JSFrame,n=r.create({name:"Win",title:"",width:window.innerWidth/2-40,height:600,minWidth:300,minHeight:300,appearanceName:"material",appearanceParam:{titleBar:{color:"white",height:40,background:"#1e1e1e"}},style:{backgroundColor:"rgba(255,255,255,0.8)",overflow:"auto"},style:{backgroundColor:"rgba(0,0,0,0.8)",overflow:"hidden",width:"100%"},html:'<div id="container"></div>'});n.setPosition(window.innerWidth-32,32,"RIGHT_TOP"),n.setControl({maximizeButton:"maximizeButton",demaximizeButton:"restoreButton",minimizeButton:"minimizeButton",deminimizeButton:"deminimizeButton",hideButton:"closeButton",animation:!0,animationDuration:150}),n.control.on("hid",(i,s)=>{i.closeFrame()}),n.control.on("maximized",(i,s)=>{r.showToast({text:"Maximized"})}),n.control.on("demaximized",(i,s)=>{}),n.control.on("minimized",(i,s)=>{}),n.control.on("dminimized",(i,s)=>{}),n.show(),console.log(n)}function pe(r){return new Promise(function(n,i){var s;s=window.document.createElement("script"),s.src=r,s.onload=()=>n(window),s.onerror=i,window.document.head.appendChild(s)})}const kt=async r=>he.querySelector(`script[src="${r}"]`)||new Promise(function(n,i){const s=window.document.createElement("script");s.src=r,s.onload=n,s.onerror=i,window.document.head.appendChild(s)}),xe=`import { useState } from "react";
import { motion } from "framer-motion";
import { css, Global } from "@emotion/react";;

const Slider = () => {
  const [sliderValue, setSlider] = useState(64);

  return <>
  <Global styles={css\`
      body{
          margin: 0;
          background: rgb(\${sliderValue},\${255-sliderValue},255);
          overflow: overlay;
        }  
    \`}/>
    <input max="128"
      css={\`
        appearance: none;
        width: 100%;
        height: 40px; 
        background: rgb(\${sliderValue*2},\${255-2*sliderValue},0); 
        outline: none; 
    \`} type="range"
      value={sliderValue} step="1"
      onChangeCapture={(e) => setSlider(Number(e.currentTarget.value))}>
    </input>
    <motion.p
      animate={{ fontSize: sliderValue + \`px\` }}>
      Example when the text gets bigger...
    </motion.p>
      <motion.p animate={{fontSize:128-sliderValue+"px"}}>
        ...or smaller
    </motion.p>
  </>
}

export default () => <>
  <Slider />
</>
`;(function(r,n){typeof exports=="object"&&typeof module!="undefined"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(r=r||self,n(r.Diff={}))})(this,function(r){"use strict";function n(){}n.prototype={diff:function(e,t){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.callback;typeof o=="function"&&(a=o,o={}),this.options=o;var f=this;function u(j){return a?(setTimeout(function(){a(void 0,j)},0),!0):j}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e)),t=this.removeEmpty(this.tokenize(t));var p=t.length,g=e.length,w=1,v=p+g,k=[{newPos:-1,components:[]}],L=this.extractCommon(k[0],t,e,0);if(k[0].newPos+1>=p&&L+1>=g)return u([{value:this.join(t),count:t.length}]);function x(){for(var j=-1*w;j<=w;j+=2){var D=void 0,$=k[j-1],A=k[j+1],M=(A?A.newPos:0)-j;$&&(k[j-1]=void 0);var O=$&&$.newPos+1<p,X=A&&0<=M&&M<g;if(!O&&!X){k[j]=void 0;continue}if(!O||X&&$.newPos<A.newPos?(D=s(A),f.pushComponent(D.components,void 0,!0)):(D=$,D.newPos++,f.pushComponent(D.components,!0,void 0)),M=f.extractCommon(D,t,e,j),D.newPos+1>=p&&M+1>=g)return u(i(f,D.components,t,e,f.useLongestToken));k[j]=D}w++}if(a)(function j(){setTimeout(function(){if(w>v)return a();x()||j()},0)})();else for(;w<=v;){var B=x();if(B)return B}},pushComponent:function(e,t,o){var a=e[e.length-1];a&&a.added===t&&a.removed===o?e[e.length-1]={count:a.count+1,added:t,removed:o}:e.push({count:1,added:t,removed:o})},extractCommon:function(e,t,o,a){for(var f=t.length,u=o.length,p=e.newPos,g=p-a,w=0;p+1<f&&g+1<u&&this.equals(t[p+1],o[g+1]);)p++,g++,w++;return w&&e.components.push({count:w}),e.newPos=p,g},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],o=0;o<e.length;o++)e[o]&&t.push(e[o]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function i(e,t,o,a,f){for(var u=0,p=t.length,g=0,w=0;u<p;u++){var v=t[u];if(v.removed){if(v.value=e.join(a.slice(w,w+v.count)),w+=v.count,u&&t[u-1].added){var k=t[u-1];t[u-1]=t[u],t[u]=k}}else{if(!v.added&&f){var L=o.slice(g,g+v.count);L=L.map(function(B,j){var D=a[w+j];return D.length>B.length?D:B}),v.value=e.join(L)}else v.value=e.join(o.slice(g,g+v.count));g+=v.count,v.added||(w+=v.count)}}var x=t[p-1];return p>1&&typeof x.value=="string"&&(x.added||x.removed)&&e.equals("",x.value)&&(t[p-2].value+=x.value,t.pop()),t}function s(e){return{newPos:e.newPos,components:e.components.slice(0)}}var d=new n;function c(e,t,o){return d.diff(e,t,o)}function l(e,t){if(typeof e=="function")t.callback=e;else if(e)for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}var h=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,m=/\S/,y=new n;y.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!m.test(e)&&!m.test(t)},y.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),o=0;o<t.length-1;o++)!t[o+1]&&t[o+2]&&h.test(t[o])&&h.test(t[o+2])&&(t[o]+=t[o+2],t.splice(o+1,2),o--);return t};function P(e,t,o){return o=l(o,{ignoreWhitespace:!0}),y.diff(e,t,o)}function H(e,t,o){return y.diff(e,t,o)}var F=new n;F.tokenize=function(e){var t=[],o=e.split(/(\n|\r\n)/);o[o.length-1]||o.pop();for(var a=0;a<o.length;a++){var f=o[a];a%2&&!this.options.newlineIsToken?t[t.length-1]+=f:(this.options.ignoreWhitespace&&(f=f.trim()),t.push(f))}return t};function re(e,t,o){return F.diff(e,t,o)}function ke(e,t,o){var a=l(o,{ignoreWhitespace:!0});return F.diff(e,t,a)}var le=new n;le.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};function S(e,t,o){return le.diff(e,t,o)}var E=new n;E.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};function T(e,t,o){return E.diff(e,t,o)}function C(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?C=function(t){return typeof t}:C=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(e)}function I(e){return q(e)||z(e)||de(e)||G()}function q(e){if(Array.isArray(e))return V(e)}function z(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function de(e,t){if(!e)return;if(typeof e=="string")return V(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(e);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return V(e,t)}function V(e,t){(t==null||t>e.length)&&(t=e.length);for(var o=0,a=new Array(t);o<t;o++)a[o]=e[o];return a}function G(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var me=Object.prototype.toString,K=new n;K.useLongestToken=!0,K.tokenize=F.tokenize,K.castInput=function(e){var t=this.options,o=t.undefinedReplacement,a=t.stringifyReplacer,f=a===void 0?function(u,p){return typeof p=="undefined"?o:p}:a;return typeof e=="string"?e:JSON.stringify(se(e,null,null,f),f,"  ")},K.equals=function(e,t){return n.prototype.equals.call(K,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};function je(e,t,o){return K.diff(e,t,o)}function se(e,t,o,a,f){t=t||[],o=o||[],a&&(e=a(f,e));var u;for(u=0;u<t.length;u+=1)if(t[u]===e)return o[u];var p;if(me.call(e)==="[object Array]"){for(t.push(e),p=new Array(e.length),o.push(p),u=0;u<e.length;u+=1)p[u]=se(e[u],t,o,a,f);return t.pop(),o.pop(),p}if(e&&e.toJSON&&(e=e.toJSON()),C(e)==="object"&&e!==null){t.push(e),p={},o.push(p);var g=[],w;for(w in e)e.hasOwnProperty(w)&&g.push(w);for(g.sort(),u=0;u<g.length;u+=1)w=g[u],p[w]=se(e[w],t,o,a,w);t.pop(),o.pop()}else p=e;return p}var ae=new n;ae.tokenize=function(e){return e.slice()},ae.join=ae.removeEmpty=function(e){return e};function ee(e,t,o){return ae.diff(e,t,o)}function te(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=e.split(/\r\n|[\n\v\f\r\x85]/),a=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],f=[],u=0;function p(){var v={};for(f.push(v);u<o.length;){var k=o[u];if(/^(\-\-\-|\+\+\+|@@)\s/.test(k))break;var L=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(k);L&&(v.index=L[1]),u++}for(g(v),g(v),v.hunks=[];u<o.length;){var x=o[u];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(x))break;if(/^@@/.test(x))v.hunks.push(w());else{if(x&&t.strict)throw new Error("Unknown line "+(u+1)+" "+JSON.stringify(x));u++}}}function g(v){var k=/^(---|\+\+\+)\s+(.*)$/.exec(o[u]);if(k){var L=k[1]==="---"?"old":"new",x=k[2].split("	",2),B=x[0].replace(/\\\\/g,"\\");/^".*"$/.test(B)&&(B=B.substr(1,B.length-2)),v[L+"FileName"]=B,v[L+"Header"]=(x[1]||"").trim(),u++}}function w(){var v=u,k=o[u++],L=k.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),x={oldStart:+L[1],oldLines:typeof L[2]=="undefined"?1:+L[2],newStart:+L[3],newLines:typeof L[4]=="undefined"?1:+L[4],lines:[],linedelimiters:[]};x.oldLines===0&&(x.oldStart+=1),x.newLines===0&&(x.newStart+=1);for(var B=0,j=0;u<o.length&&!(o[u].indexOf("--- ")===0&&u+2<o.length&&o[u+1].indexOf("+++ ")===0&&o[u+2].indexOf("@@")===0);u++){var D=o[u].length==0&&u!=o.length-1?" ":o[u][0];if(D==="+"||D==="-"||D===" "||D==="\\")x.lines.push(o[u]),x.linedelimiters.push(a[u]||`
`),D==="+"?B++:D==="-"?j++:D===" "&&(B++,j++);else break}if(!B&&x.newLines===1&&(x.newLines=0),!j&&x.oldLines===1&&(x.oldLines=0),t.strict){if(B!==x.newLines)throw new Error("Added line count did not match for hunk at line "+(v+1));if(j!==x.oldLines)throw new Error("Removed line count did not match for hunk at line "+(v+1))}return x}for(;u<o.length;)p();return f}function De(e,t,o){var a=!0,f=!1,u=!1,p=1;return function g(){if(a&&!u){if(f?p++:a=!1,e+p<=o)return p;u=!0}if(!f)return u||(a=!0),t<=e-p?-p++:(f=!0,g())}}function $e(e,t){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof t=="string"&&(t=te(t)),Array.isArray(t)){if(t.length>1)throw new Error("applyPatch only works with a single input.");t=t[0]}var a=e.split(/\r\n|[\n\v\f\r\x85]/),f=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],u=t.hunks,p=o.compareLine||function(Ie,fe,ve,ie){return fe===ie},g=0,w=o.fuzzFactor||0,v=0,k=0,L,x;function B(Ie,fe){for(var ve=0;ve<Ie.lines.length;ve++){var ie=Ie.lines[ve],Pe=ie.length>0?ie[0]:" ",xt=ie.length>0?ie.substr(1):ie;if(Pe===" "||Pe==="-"){if(!p(fe+1,a[fe],Pe,xt)&&(g++,g>w))return!1;fe++}}return!0}for(var j=0;j<u.length;j++){for(var D=u[j],$=a.length-D.oldLines,A=0,M=k+D.oldStart-1,O=De(M,v,$);A!==void 0;A=O())if(B(D,M+A)){D.offset=k+=A;break}if(A===void 0)return!1;v=D.offset+D.oldStart+D.oldLines}for(var X=0,ce=0;ce<u.length;ce++){var R=u[ce],J=R.oldStart+R.offset+X-1;X+=R.newLines-R.oldLines;for(var W=0;W<R.lines.length;W++){var _=R.lines[W],oe=_.length>0?_[0]:" ",Te=_.length>0?_.substr(1):_,we=R.linedelimiters[W];if(oe===" ")J++;else if(oe==="-")a.splice(J,1),f.splice(J,1);else if(oe==="+")a.splice(J,0,Te),f.splice(J,0,we),J++;else if(oe==="\\"){var ye=R.lines[W-1]?R.lines[W-1][0]:null;ye==="+"?L=!0:ye==="-"&&(x=!0)}}}if(L)for(;!a[a.length-1];)a.pop(),f.pop();else x&&(a.push(""),f.push(`
`));for(var ue=0;ue<a.length-1;ue++)a[ue]=a[ue]+f[ue];return a.join("")}function ct(e,t){typeof e=="string"&&(e=te(e));var o=0;function a(){var f=e[o++];if(!f)return t.complete();t.loadFile(f,function(u,p){if(u)return t.complete(u);var g=$e(p,f,t);t.patched(f,g,function(w){if(w)return t.complete(w);a()})})}a()}function Le(e,t,o,a,f,u,p){p||(p={}),typeof p.context=="undefined"&&(p.context=4);var g=re(o,a,p);g.push({value:"",lines:[]});function w(A){return A.map(function(M){return" "+M})}for(var v=[],k=0,L=0,x=[],B=1,j=1,D=function(A){var M=g[A],O=M.lines||M.value.replace(/\n$/,"").split(`
`);if(M.lines=O,M.added||M.removed){var X;if(!k){var ce=g[A-1];k=B,L=j,ce&&(x=p.context>0?w(ce.lines.slice(-p.context)):[],k-=x.length,L-=x.length)}(X=x).push.apply(X,I(O.map(function(ye){return(M.added?"+":"-")+ye}))),M.added?j+=O.length:B+=O.length}else{if(k)if(O.length<=p.context*2&&A<g.length-2){var R;(R=x).push.apply(R,I(w(O)))}else{var J,W=Math.min(O.length,p.context);(J=x).push.apply(J,I(w(O.slice(0,W))));var _={oldStart:k,oldLines:B-k+W,newStart:L,newLines:j-L+W,lines:x};if(A>=g.length-2&&O.length<=p.context){var oe=/\n$/.test(o),Te=/\n$/.test(a),we=O.length==0&&x.length>_.oldLines;!oe&&we&&o.length>0&&x.splice(_.oldLines,0,"\\ No newline at end of file"),(!oe&&!we||!Te)&&x.push("\\ No newline at end of file")}v.push(_),k=0,L=0,x=[]}B+=O.length,j+=O.length}},$=0;$<g.length;$++)D($);return{oldFileName:e,newFileName:t,oldHeader:f,newHeader:u,hunks:v}}function lt(e){var t=[];e.oldFileName==e.newFileName&&t.push("Index: "+e.oldFileName),t.push("==================================================================="),t.push("--- "+e.oldFileName+(typeof e.oldHeader=="undefined"?"":"	"+e.oldHeader)),t.push("+++ "+e.newFileName+(typeof e.newHeader=="undefined"?"":"	"+e.newHeader));for(var o=0;o<e.hunks.length;o++){var a=e.hunks[o];a.oldLines===0&&(a.oldStart-=1),a.newLines===0&&(a.newStart-=1),t.push("@@ -"+a.oldStart+","+a.oldLines+" +"+a.newStart+","+a.newLines+" @@"),t.push.apply(t,a.lines)}return t.join(`
`)+`
`}function Ue(e,t,o,a,f,u,p){return lt(Le(e,t,o,a,f,u,p))}function dt(e,t,o,a,f,u){return Ue(e,e,t,o,a,f,u)}function ut(e,t){return e.length!==t.length?!1:Ee(e,t)}function Ee(e,t){if(t.length>e.length)return!1;for(var o=0;o<t.length;o++)if(t[o]!==e[o])return!1;return!0}function ft(e){var t=Ce(e.lines),o=t.oldLines,a=t.newLines;o!==void 0?e.oldLines=o:delete e.oldLines,a!==void 0?e.newLines=a:delete e.newLines}function pt(e,t,o){e=Ve(e,o),t=Ve(t,o);var a={};(e.index||t.index)&&(a.index=e.index||t.index),(e.newFileName||t.newFileName)&&(We(e)?We(t)?(a.oldFileName=ge(a,e.oldFileName,t.oldFileName),a.newFileName=ge(a,e.newFileName,t.newFileName),a.oldHeader=ge(a,e.oldHeader,t.oldHeader),a.newHeader=ge(a,e.newHeader,t.newHeader)):(a.oldFileName=e.oldFileName,a.newFileName=e.newFileName,a.oldHeader=e.oldHeader,a.newHeader=e.newHeader):(a.oldFileName=t.oldFileName||e.oldFileName,a.newFileName=t.newFileName||e.newFileName,a.oldHeader=t.oldHeader||e.oldHeader,a.newHeader=t.newHeader||e.newHeader)),a.hunks=[];for(var f=0,u=0,p=0,g=0;f<e.hunks.length||u<t.hunks.length;){var w=e.hunks[f]||{oldStart:Infinity},v=t.hunks[u]||{oldStart:Infinity};if(Je(w,v))a.hunks.push(_e(w,p)),f++,g+=w.newLines-w.oldLines;else if(Je(v,w))a.hunks.push(_e(v,g)),u++,p+=v.newLines-v.oldLines;else{var k={oldStart:Math.min(w.oldStart,v.oldStart),oldLines:0,newStart:Math.min(w.newStart+p,v.oldStart+g),newLines:0,lines:[]};ht(k,w.oldStart,w.lines,v.oldStart,v.lines),u++,f++,a.hunks.push(k)}}return a}function Ve(e,t){if(typeof e=="string"){if(/^@@/m.test(e)||/^Index:/m.test(e))return te(e)[0];if(!t)throw new Error("Must provide a base reference or pass in a patch");return Le(void 0,void 0,t,e)}return e}function We(e){return e.newFileName&&e.newFileName!==e.oldFileName}function ge(e,t,o){return t===o?t:(e.conflict=!0,{mine:t,theirs:o})}function Je(e,t){return e.oldStart<t.oldStart&&e.oldStart+e.oldLines<t.oldStart}function _e(e,t){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+t,newLines:e.newLines,lines:e.lines}}function ht(e,t,o,a,f){var u={offset:t,lines:o,index:0},p={offset:a,lines:f,index:0};for(Ge(e,u,p),Ge(e,p,u);u.index<u.lines.length&&p.index<p.lines.length;){var g=u.lines[u.index],w=p.lines[p.index];if((g[0]==="-"||g[0]==="+")&&(w[0]==="-"||w[0]==="+"))mt(e,u,p);else if(g[0]==="+"&&w[0]===" "){var v;(v=e.lines).push.apply(v,I(ne(u)))}else if(w[0]==="+"&&g[0]===" "){var k;(k=e.lines).push.apply(k,I(ne(p)))}else g[0]==="-"&&w[0]===" "?qe(e,u,p):w[0]==="-"&&g[0]===" "?qe(e,p,u,!0):g===w?(e.lines.push(g),u.index++,p.index++):Be(e,ne(u),ne(p))}Ke(e,u),Ke(e,p),ft(e)}function mt(e,t,o){var a=ne(t),f=ne(o);if(Xe(a)&&Xe(f)){if(Ee(a,f)&&Ze(o,a,a.length-f.length)){var u;(u=e.lines).push.apply(u,I(a));return}else if(Ee(f,a)&&Ze(t,f,f.length-a.length)){var p;(p=e.lines).push.apply(p,I(f));return}}else if(ut(a,f)){var g;(g=e.lines).push.apply(g,I(a));return}Be(e,a,f)}function qe(e,t,o,a){var f=ne(t),u=gt(o,f);if(u.merged){var p;(p=e.lines).push.apply(p,I(u.merged))}else Be(e,a?u:f,a?f:u)}function Be(e,t,o){e.conflict=!0,e.lines.push({conflict:!0,mine:t,theirs:o})}function Ge(e,t,o){for(;t.offset<o.offset&&t.index<t.lines.length;){var a=t.lines[t.index++];e.lines.push(a),t.offset++}}function Ke(e,t){for(;t.index<t.lines.length;){var o=t.lines[t.index++];e.lines.push(o)}}function ne(e){for(var t=[],o=e.lines[e.index][0];e.index<e.lines.length;){var a=e.lines[e.index];if(o==="-"&&a[0]==="+"&&(o="+"),o===a[0])t.push(a),e.index++;else break}return t}function gt(e,t){for(var o=[],a=[],f=0,u=!1,p=!1;f<t.length&&e.index<e.lines.length;){var g=e.lines[e.index],w=t[f];if(w[0]==="+")break;if(u=u||g[0]!==" ",a.push(w),f++,g[0]==="+")for(p=!0;g[0]==="+";)o.push(g),g=e.lines[++e.index];w.substr(1)===g.substr(1)?(o.push(g),e.index++):p=!0}if((t[f]||"")[0]==="+"&&u&&(p=!0),p)return o;for(;f<t.length;)a.push(t[f++]);return{merged:a,changes:o}}function Xe(e){return e.reduce(function(t,o){return t&&o[0]==="-"},!0)}function Ze(e,t,o){for(var a=0;a<o;a++){var f=t[t.length-o+a].substr(1);if(e.lines[e.index+a]!==" "+f)return!1}return e.index+=o,!0}function Ce(e){var t=0,o=0;return e.forEach(function(a){if(typeof a!="string"){var f=Ce(a.mine),u=Ce(a.theirs);t!==void 0&&(f.oldLines===u.oldLines?t+=f.oldLines:t=void 0),o!==void 0&&(f.newLines===u.newLines?o+=f.newLines:o=void 0)}else o!==void 0&&(a[0]==="+"||a[0]===" ")&&o++,t!==void 0&&(a[0]==="-"||a[0]===" ")&&t++}),{oldLines:t,newLines:o}}function wt(e){for(var t=[],o,a,f=0;f<e.length;f++)o=e[f],o.added?a=1:o.removed?a=-1:a=0,t.push([a,o.value]);return t}function yt(e){for(var t=[],o=0;o<e.length;o++){var a=e[o];a.added?t.push("<ins>"):a.removed&&t.push("<del>"),t.push(vt(a.value)),a.added?t.push("</ins>"):a.removed&&t.push("</del>")}return t.join("")}function vt(e){var t=e;return t=t.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/"/g,"&quot;"),t}r.Diff=n,r.applyPatch=$e,r.applyPatches=ct,r.canonicalize=se,r.convertChangesToDMP=wt,r.convertChangesToXML=yt,r.createPatch=dt,r.createTwoFilesPatch=Ue,r.diffArrays=ee,r.diffChars=c,r.diffCss=T,r.diffJson=je,r.diffLines=re,r.diffSentences=S,r.diffTrimmedLines=ke,r.diffWords=P,r.diffWordsWithSpace=H,r.merge=pt,r.parsePatch=te,r.structuredPatch=Le,Object.defineProperty(r,"__esModule",{value:!0})});async function jt(r){const n=await crypto.subtle.digest("SHA-256",r),i=Array.from(new Uint8Array(n)),s=i.map(d=>("00"+d.toString(16)).slice(-2)).join("");return s}const Dt=r=>{if(r.length<10)return!1;const n=[...r.slice(0,8)].filter(s=>s<"0"||s>"f").length===0,i=r.slice(8);if(n&&i[0]==="["&&i[i.length-1]==="]"){try{return JSON.parse(i).length>1}catch{return!1}return!0}return!1},Lt=(r,n)=>{const i=JSON.parse(n);let s=r.slice(),d="";return i.forEach(c=>{if(Number(c)===c){const l=Math.abs(c),h=s.slice(0,l);s=s.slice(l),c>0&&(d+=String(h))}else d+=String(c)}),d};async function Et(r){const n=new TextEncoder().encode(r),i=await jt(n);return i.substr(0,8)}const Bt=async(r,n)=>{const i=Et(r),s=Diff.diffChars(r,n);return{b:await i,c:s.map(d=>d.added?d.value:d.removed?-d.count:d.count)}},Ct=(r,n)=>n.some(i=>r instanceof i);let Qe,Ye;function Tt(){return Qe||(Qe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function It(){return Ye||(Ye=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const et=new WeakMap,Ae=new WeakMap,tt=new WeakMap,Ne=new WeakMap,Me=new WeakMap;function Pt(r){if(Ae.has(r))return;const n=new Promise((i,s)=>{const d=()=>{r.removeEventListener("complete",c),r.removeEventListener("error",l),r.removeEventListener("abort",l)},c=()=>{i(),d()},l=()=>{s(r.error||new DOMException("AbortError","AbortError")),d()};r.addEventListener("complete",c),r.addEventListener("error",l),r.addEventListener("abort",l)});Ae.set(r,n)}const Oe=r=>Me.get(r),At=["get","getKey","getAll","getAllKeys","count"],Nt=["put","add","delete","clear"],He=new Map;function nt(r,n){if(!(r instanceof IDBDatabase&&!(n in r)&&typeof n=="string"))return;if(He.get(n))return He.get(n);const i=n.replace(/FromIndex$/,""),s=n!==i,d=Nt.includes(i);if(!(i in(s?IDBIndex:IDBObjectStore).prototype)||!(d||At.includes(i)))return;const c=async function(l,...h){const m=this.transaction(l,d?"readwrite":"readonly");let y=m.store;s&&(y=y.index(h.shift()));const P=await y[i](...h);return d&&await m.done,P};return He.set(n,c),c}async function Mt(r){const n=await crypto.subtle.digest("SHA-256",r),i=Array.from(new Uint8Array(n)),s=i.map(d=>("00"+d.toString(16)).slice(-2)).join("");return s}const b="0123456789abcdef".split(""),Ot=[-2147483648,8388608,32768,128],U=[24,16,8,0],N=[];class qt{#c;#s;#a;#e;#u;#d;#l;#t=1732584193;#n=4023233417;#o=2562383102;#i=271733878;#r=3285377520;#f=0;constructor(n=!1){this.init(n)}init(n){n?(N[0]=N[16]=N[1]=N[2]=N[3]=N[4]=N[5]=N[6]=N[7]=N[8]=N[9]=N[10]=N[11]=N[12]=N[13]=N[14]=N[15]=0,this.#c=N):this.#c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.#t=1732584193,this.#n=4023233417,this.#o=2562383102,this.#i=271733878,this.#r=3285377520,this.#s=this.#a=this.#e=this.#u=0,this.#d=this.#l=!1}update(n){if(this.#d)return this;let i;n instanceof ArrayBuffer?i=new Uint8Array(n):i=n;let s=0;const d=i.length,c=this.#c;for(;s<d;){let l;if(this.#l&&(this.#l=!1,c[0]=this.#s,c[16]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=c[9]=c[10]=c[11]=c[12]=c[13]=c[14]=c[15]=0),typeof i!="string")for(l=this.#a;s<d&&l<64;++s)c[l>>2]|=i[s]<<U[l++&3];else for(l=this.#a;s<d&&l<64;++s){let h=i.charCodeAt(s);h<128?c[l>>2]|=h<<U[l++&3]:h<2048?(c[l>>2]|=(192|h>>6)<<U[l++&3],c[l>>2]|=(128|h&63)<<U[l++&3]):h<55296||h>=57344?(c[l>>2]|=(224|h>>12)<<U[l++&3],c[l>>2]|=(128|h>>6&63)<<U[l++&3],c[l>>2]|=(128|h&63)<<U[l++&3]):(h=65536+((h&1023)<<10|i.charCodeAt(++s)&1023),c[l>>2]|=(240|h>>18)<<U[l++&3],c[l>>2]|=(128|h>>12&63)<<U[l++&3],c[l>>2]|=(128|h>>6&63)<<U[l++&3],c[l>>2]|=(128|h&63)<<U[l++&3])}this.#f=l,this.#e+=l-this.#a,l>=64?(this.#s=c[16],this.#a=l-64,this.hash(),this.#l=!0):this.#a=l}return this.#e>4294967295&&(this.#u+=this.#e/4294967296>>>0,this.#e=this.#e>>>0),this}finalize(){if(this.#d)return;this.#d=!0;const n=this.#c,i=this.#f;n[16]=this.#s,n[i>>2]|=Ot[i&3],this.#s=n[16],i>=56&&(this.#l||this.hash(),n[0]=this.#s,n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0),n[14]=this.#u<<3|this.#e>>>29,n[15]=this.#e<<3,this.hash()}hash(){let n=this.#t,i=this.#n,s=this.#o,d=this.#i,c=this.#r,l,h,m;const y=this.#c;for(h=16;h<80;++h)m=y[h-3]^y[h-8]^y[h-14]^y[h-16],y[h]=m<<1|m>>>31;for(h=0;h<20;h+=5)l=i&s|~i&d,m=n<<5|n>>>27,c=m+l+c+1518500249+y[h]>>>0,i=i<<30|i>>>2,l=n&i|~n&s,m=c<<5|c>>>27,d=m+l+d+1518500249+y[h+1]>>>0,n=n<<30|n>>>2,l=c&n|~c&i,m=d<<5|d>>>27,s=m+l+s+1518500249+y[h+2]>>>0,c=c<<30|c>>>2,l=d&c|~d&n,m=s<<5|s>>>27,i=m+l+i+1518500249+y[h+3]>>>0,d=d<<30|d>>>2,l=s&d|~s&c,m=i<<5|i>>>27,n=m+l+n+1518500249+y[h+4]>>>0,s=s<<30|s>>>2;for(;h<40;h+=5)l=i^s^d,m=n<<5|n>>>27,c=m+l+c+1859775393+y[h]>>>0,i=i<<30|i>>>2,l=n^i^s,m=c<<5|c>>>27,d=m+l+d+1859775393+y[h+1]>>>0,n=n<<30|n>>>2,l=c^n^i,m=d<<5|d>>>27,s=m+l+s+1859775393+y[h+2]>>>0,c=c<<30|c>>>2,l=d^c^n,m=s<<5|s>>>27,i=m+l+i+1859775393+y[h+3]>>>0,d=d<<30|d>>>2,l=s^d^c,m=i<<5|i>>>27,n=m+l+n+1859775393+y[h+4]>>>0,s=s<<30|s>>>2;for(;h<60;h+=5)l=i&s|i&d|s&d,m=n<<5|n>>>27,c=m+l+c-1894007588+y[h]>>>0,i=i<<30|i>>>2,l=n&i|n&s|i&s,m=c<<5|c>>>27,d=m+l+d-1894007588+y[h+1]>>>0,n=n<<30|n>>>2,l=c&n|c&i|n&i,m=d<<5|d>>>27,s=m+l+s-1894007588+y[h+2]>>>0,c=c<<30|c>>>2,l=d&c|d&n|c&n,m=s<<5|s>>>27,i=m+l+i-1894007588+y[h+3]>>>0,d=d<<30|d>>>2,l=s&d|s&c|d&c,m=i<<5|i>>>27,n=m+l+n-1894007588+y[h+4]>>>0,s=s<<30|s>>>2;for(;h<80;h+=5)l=i^s^d,m=n<<5|n>>>27,c=m+l+c-899497514+y[h]>>>0,i=i<<30|i>>>2,l=n^i^s,m=c<<5|c>>>27,d=m+l+d-899497514+y[h+1]>>>0,n=n<<30|n>>>2,l=c^n^i,m=d<<5|d>>>27,s=m+l+s-899497514+y[h+2]>>>0,c=c<<30|c>>>2,l=d^c^n,m=s<<5|s>>>27,i=m+l+i-899497514+y[h+3]>>>0,d=d<<30|d>>>2,l=s^d^c,m=i<<5|i>>>27,n=m+l+n-899497514+y[h+4]>>>0,s=s<<30|s>>>2;this.#t=this.#t+n>>>0,this.#n=this.#n+i>>>0,this.#o=this.#o+s>>>0,this.#i=this.#i+d>>>0,this.#r=this.#r+c>>>0}hex(){this.finalize();const n=this.#t,i=this.#n,s=this.#o,d=this.#i,c=this.#r;return b[n>>28&15]+b[n>>24&15]+b[n>>20&15]+b[n>>16&15]+b[n>>12&15]+b[n>>8&15]+b[n>>4&15]+b[n&15]+b[i>>28&15]+b[i>>24&15]+b[i>>20&15]+b[i>>16&15]+b[i>>12&15]+b[i>>8&15]+b[i>>4&15]+b[i&15]+b[s>>28&15]+b[s>>24&15]+b[s>>20&15]+b[s>>16&15]+b[s>>12&15]+b[s>>8&15]+b[s>>4&15]+b[s&15]+b[d>>28&15]+b[d>>24&15]+b[d>>20&15]+b[d>>16&15]+b[d>>12&15]+b[d>>8&15]+b[d>>4&15]+b[d&15]+b[c>>28&15]+b[c>>24&15]+b[c>>20&15]+b[c>>16&15]+b[c>>12&15]+b[c>>8&15]+b[c>>4&15]+b[c&15]}toString(){return this.hex()}digest(){this.finalize();const n=this.#t,i=this.#n,s=this.#o,d=this.#i,c=this.#r;return[n>>24&255,n>>16&255,n>>8&255,n&255,i>>24&255,i>>16&255,i>>8&255,i&255,s>>24&255,s>>16&255,s>>8&255,s&255,d>>24&255,d>>16&255,d>>8&255,d&255,c>>24&255,c>>16&255,c>>8&255,c&255]}array(){return this.digest()}arrayBuffer(){this.finalize();const n=new ArrayBuffer(20),i=new DataView(n);return i.setUint32(0,this.#t),i.setUint32(4,this.#n),i.setUint32(8,this.#o),i.setUint32(12,this.#i),i.setUint32(16,this.#r),n}}function Gt(r,n=""){if(!r)throw new DenoStdInternalError(n)}const Kt="00000000-0000-0000-0000-000000000000",he=window.document;var Ht=window.ReactDOM;const Fe=()=>he.location.href.includes("zed.dev")?"https://code.zed.dev":"https://code.zed.vision";let ot=!0,Z="",Q=0,Ft=0,it="",rt="",be="",st;function zt(r){const n=[...r].map(i=>{const s=i.toString(16);return i<16?"0"+s:s});return[...n.slice(0,4),"-",...n.slice(4,6),"-",...n.slice(6,8),"-",...n.slice(8,10),"-",...n.slice(10,16)].join("")}function Xt(r){const n=[];return r.replace(/[a-fA-F0-9]{2}/g,i=>(n.push(parseInt(i,16)),"")),n}function Zt(r){r=unescape(encodeURIComponent(r));const n=new Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}function Qt(r){const n=new ArrayBuffer(r.length),i=new Uint8Array(n);for(let s=0;s<r.length;s++)i[s]=r[s];return n}const Rt=async({onChange:r,code:n,language:i})=>{if(typeof window=="undefined")return"";const s=window.document,d=window.document.getElementById("container");if(!d){const y=s.getElementById("container");y.id="container",s.body.appendChild(y)}const c=i==="typescript"?"file:///main.tsx":"file:///main.html";let l;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent)){const y=window.document.createElement("div");y.id="ace",window.document.body.appendChild(y),await pe("https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.min.js"),i==="typescript"?await pe("https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/mode-typescript.min.js"):await pe("https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/mode-html.min.js"),await pe("https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/theme-monokai.min.js"),window.document.getElementById("ace").style.setProperty("display","block"),d.style.setProperty("display","none"),l=window.ace.edit("ace"),l.getSession().setMode("ace/mode/typescript");const P=H=>setTimeout(()=>{const F=window.ace.edit("ace"),re=F.getTheme();re!=="ace/theme/monokai "&&(F.setOptions({fontSize:"14pt"}),F.setTheme("ace/theme/monokai"),P(2*H))},H);P(100),l.setValue(n),l.blur()}if(window.monaco===void 0){const y="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.21.2/min/vs",{require:P}=await pe(`${y}/loader.min.js`);P.config({paths:{vs:y}}),await new Promise(H=>P(["vs/editor/editor.main"],F=>{H(F)}))}const h=window.monaco,m={monaco:h,editor:h.editor.create(window.document.getElementById("container"),{formatOnType:!0,scrollbar:{horizontal:"hidden",verticalHasArrows:!0,verticalScrollbarSize:20},minimap:{enabled:!1},folding:!1,multiCursorModifier:"alt",wordWrap:"on",wordWrapBreakAfterCharacters:">([{]))],;} ",mouseWheelZoom:!1,wordWrapColumn:80,automaticLayout:!0,scrollBeyondLastLine:!1,autoIndent:"brackets",autoClosingQuotes:"always",padding:{bottom:300},lineNumbers:"on",autoClosingBrackets:"always",autoClosingOvertype:"always",suggest:{},codeLens:!0,autoSurround:"languageDefined",trimAutoWhitespace:!0,codeActionsOnSaveTimeout:100,model:h.editor.getModel(c)||h.editor.createModel(n,i,h.Uri.parse(c)),value:n,language:i,theme:"vs-dark"})};if(m.editor.onDidChangeModelContent(()=>r(m.editor.getValue())),l&&l.session.on("change",function(){const y=l.getValue();m.editor.setValue(y),r(y)}),l&&s.getElementById("container").replaceWith(s.getElementById("ace")),m.monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSuggestionDiagnostics:!0,noSemanticValidation:!0,noSyntaxValidation:!0}),i==="typescript"){const y=[{name:"react",url:"https://unpkg.com/@types/react@17.0.0/index.d.ts",depend:["global","csstype","react-dom","prop-types"]},{name:"global",url:"https://unpkg.com/@types/react@17.0.0/global.d.ts",depend:[]},{name:"prop-types",url:"https://unpkg.com/@types/prop-types@15.7.3/index.d.ts",depend:[]},{name:"react-dom",url:"https://unpkg.com/@types/react-dom@17.0.0/index.d.ts",depend:[]},{name:"csstype",url:"https://unpkg.com/csstype@3.0.5/index.d.ts",depend:[]},{name:"@emotion/styled/base.d.ts",url:"https://unpkg.com/@emotion/styled@11.0.0/types/base.d.ts",depend:["@emotion/react","@emotion/serialize","react"]},{name:"@emotion/styled/index.d.ts",url:"https://unpkg.com/@emotion/styled@11.0.0/types/index.d.ts",depend:["@emotion/react","@emotion/serialize","react"]},{name:"@emotion/cache/index.d.ts",url:"https://unpkg.com/@emotion/cache@11.0.0/types/index.d.ts",depend:["@emotion/utils"]},{name:"@emotion/react/index.d.ts",url:"https://unpkg.com/@emotion/react@11.1.2/types/index.d.ts",depend:["@emotion/cache"]},{name:"@emotion/react/jsx-namespace.d.ts",url:"https://unpkg.com/@emotion/react@11.1.2/types/jsx-namespace.d.ts",depend:["@emotion/utils","csstype"]},{name:"@emotion/react/css-prop.d.ts",url:"https://unpkg.com/@emotion/react@11.1.2/types/css-prop.d.ts",depend:["@emotion/utils","csstype"]},{name:"@emotion/react/helper.d.ts",url:"https://unpkg.com/@emotion/react@11.1.2/types/helper.d.ts",depend:["@emotion/utils","csstype"]},{name:"@emotion/react/theming.d.ts",url:"https://unpkg.com/@emotion/react@11.1.2/types/theming.d.ts",depend:["@emotion/utils","csstype"]},{name:"@emotion/serialize/index.d.ts",url:"https://unpkg.com/@emotion/serialize@1.0.0/types/index.d.ts",depend:["@emotion/utils","csstype"]},{name:"@emotion/utils/index.d.ts",url:"https://unpkg.com/@emotion/utils@1.0.0/types/index.d.ts",depend:[]},{name:"framer-motion",url:"https://unpkg.com/framer-motion@2.9.5/dist/framer-motion.d.ts",depend:[]},{name:"popmotion",url:"https://unpkg.com/browse/popmotion@9.0.1/lib/index.d.ts"}],P=y.map(({name:H,url:F})=>(async()=>m.monaco.languages.typescript.typescriptDefaults.addExtraLib(await(await fetch(F)).text(),H.includes("@emotion")?`file:///node_modules/${H}`:`file:///node_modules/@types/${H}/index.d.ts`))());return m.monaco.languages.typescript.typescriptDefaults.setCompilerOptions({target:m.monaco.languages.typescript.ScriptTarget.ESNext,allowNonTsExtensions:!0,allowUmdGlobalAccess:!0,strict:!0,allowJs:!0,noEmitOnError:!0,allowSyntheticDefaultImports:!0,moduleResolution:m.monaco.languages.typescript.ModuleResolutionKind.Nodejs,module:m.monaco.languages.typescript.ModuleKind.CommonJS,noEmit:!0,typeRoots:["node_modules/@types"],jsx:"react-jsx",esModuleInterop:!0}),await Promise.all(P),m.monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSuggestionDiagnostics:!1,noSemanticValidation:!1,noSyntaxValidation:!1}),m}};async function ze(r){const n=new TextEncoder().encode(r),i=await Mt(n);return i.substr(0,8)}const $t=function(){const r=new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$","i");function n(s){return r.test(s)}function i(){const s=crypto.getRandomValues(new Uint8Array(16));return s[6]=s[6]&15|64,s[8]=s[8]&63|128,zt(s)}return{validate:n,generate:i}}();function Ut(r){const n=new Promise((i,s)=>{const d=()=>{r.removeEventListener("success",c),r.removeEventListener("error",l)},c=()=>{i(Y(r.result)),d()},l=()=>{s(r.error),d()};r.addEventListener("success",c),r.addEventListener("error",l)});return n.then(i=>{i instanceof IDBCursor&&et.set(i,r)}).catch(()=>{}),Me.set(n,r),n}let Re={get(r,n,i){if(r instanceof IDBTransaction){if(n==="done")return Ae.get(r);if(n==="objectStoreNames")return r.objectStoreNames||tt.get(r);if(n==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return Y(r[n])},set(r,n,i){return r[n]=i,!0},has(r,n){return r instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in r}};function Vt(r){Re=r(Re)}function Wt(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(n,...i){const s=r.call(Oe(this),n,...i);return tt.set(s,n.sort?n.sort():[n]),Y(s)}:It().includes(r)?function(...n){return r.apply(Oe(this),n),Y(et.get(this))}:function(...n){return Y(r.apply(Oe(this),n))}}function Jt(r){return typeof r=="function"?Wt(r):(r instanceof IDBTransaction&&Pt(r),Ct(r,Tt())?new Proxy(r,Re):r)}function Y(r){if(r instanceof IDBRequest)return Ut(r);if(Ne.has(r))return Ne.get(r);const n=Jt(r);return n!==r&&(Ne.set(r,n),Me.set(n,r)),n}function _t(r,n,{blocked:i,upgrade:s,blocking:d,terminated:c}={}){const l=indexedDB.open(r,n),h=Y(l);return s&&l.addEventListener("upgradeneeded",m=>{s(Y(l.result),m.oldVersion,m.newVersion,Y(l.transaction))}),i&&l.addEventListener("blocked",()=>i()),h.then(m=>{c&&m.addEventListener("close",()=>c()),d&&m.addEventListener("versionchange",()=>d())}).catch(()=>{}),h}Vt(r=>({...r,get:(n,i,s)=>nt(n,i)||r.get(n,i,s),has:(n,i)=>!!nt(n,i)||r.has(n,i)}));const Se=async()=>{const r=_t("localZedCodeStore",1,{upgrade(i){i.createObjectStore("codeStore")}}),n={async get(i,s="string"){let d;try{if(d=await(await r).get("codeStore",i),!d)return null}catch(c){return null}if(s==="json")return JSON.parse(d);if(s==="string"){const c=await d;if(typeof c===s){const m=c;if(Dt(c)){const y=c.slice(0,8),P=c.slice(8),H=await n.get(y);return Lt(H,P)}return c}const l=new TextDecoder,h=l.decode(c);return h}return d},async put(i,s){let d;try{const l=await n.get(i);if(l.length===8&&l!==s){const h=await n.get(s),m=await n.get(l),y=await ze(m);if(y===l){const P=await Bt(h,m),H=P.b+JSON.stringify(P.c);(await r).put("codeStore",H,y)}}}catch{d=""}if(d!==""&&s===d)return data;let c;return typeof s!="string"?c=new TextDecoder().decode(s):c=s,(await r).put("codeStore",c,i)},async delete(i){return(await r).delete("codeStore",i)},async clear(){return(await r).clear("codeStore")},async keys(){return(await r).getAllKeys("codeStore")}};return n};export const getProjects=async()=>{const r=await at(),n=await Se(),i=await n.get(r,"json");if(!i||!i.list){const s=$t.generate();return await n.put(r,JSON.stringify({list:[s],[s]:{created:Date.now(),lastOpen:Date.now()}})),[s]}return i.list};async function at(){const r=await Se(),n=await r.get("uuid");if(!n)if(window.location.href.includes("zed.dev"))r.put("uuid","1234");else{const i=await fetch("https://code.zed.vision/register"),s=await i.json();return r.put("uuid",s.uuid),s.uuid}return n}export async function run(r="window"){await kt("https://unpkg.com/@babel/standalone@7.12.9/babel.min.js"),r==="editor"&&St(),r=="window"&&bt(async()=>{const S=await st();window.open(S)});const n=await Se(),i=await at(),s=await getProjects(),d=s[0],c=await H();P(le(c)),be=c;const l=await Rt({language:"typescript",code:c,onChange:m});async function h(S){if(Q===1)return;try{Q=1;const E=await y(),T=he.getElementById("error");if(Q=0,S!==Z)return;if(E&&E.length){const{diff:C}=await import("../../diff/diff.min.js");if(Z!=S)return;if(it===S)return;const I=await C(be,S);if(I.c.length<=3){l.monaco.editor.setTheme("hc-black");return}T.innerHTML=E[0].messageText.toString(),T.style.display="block",it=S;return}be=S,T.style.display="none",l.monaco.editor.setTheme("vs-dark"),Ft=0,Q=0,P(le(S))}catch(E){if(Q=0,S!==Z)return;l.monaco.editor.setTheme("vs-light"),setTimeout(()=>{l.monaco.editor.setTheme("hc-black")},50),console.error(E)}}function m(S){if(!l)return;if(Z=S,!Q)h(Z);else{const E=S,T=setInterval(()=>{(S!==Z||!Q)&&clearInterval(T),Q||h(Z)},100)}}async function y(){if(!l||!l.monaco)return;const S=l.monaco.Uri.parse("file:///main.tsx"),E=await l.monaco.languages.typescript.getTypeScriptWorker(),T=await(await E(S)).getSemanticDiagnostics("file:///main.tsx"),C=await(await E(S)).getCompilerOptionsDiagnostics("file:///main.tsx"),I=await(await E(S)).getSyntacticDiagnostics("file:///main.tsx");return[...T,...C,...I]}function P(S){const E=/import/gi,T="///",C=`
    Object.assign(window, React);
    if (window.Motion) {
        Object.assign(window, window.Motion);
    }
    if (window.emotionStyled){
      window.styled= window.emotionStyled;
    }
    ;
    `+S.replaceAll(E,T).replace("export default","DefaultElement = "),I=()=>{const q=new Function("code",`return function(){  
          let DefaultElement;
        
        ${C}

                return ReactDOM.render(jsx(DefaultElement), document.getElementById("root"));
      }`)();q(),st=async()=>{const z=new Function("code",`return function(){
            let DefaultElement;
  
          ${C}
  
                  return ReactDOMServer.renderToString(jsx(DefaultElement));
        }`)(),de=z(),V=Array.from(he.querySelector("head > style[data-emotion=css]").sheet.cssRules).map(ee=>ee.cssText).filter(ee=>de.includes(ee.substring(3,8))).join(`
  `);let G;if(C.includes("body{")){const ee=C.indexOf("body{"),te=C.slice(ee),De=te.indexOf("}");G=te.slice(0,De+1)}let me="",K="";C.includes("Motion")&&(me='<script crossorigin src="https://unpkg.com/framer-motion@2.9.5/dist/framer-motion.js"></script>',K="const {motion} = Motion");const je=`<!DOCTYPE html>
        <html lang="en">
        <head>
        <title>Generated with code.zed.vision</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <head profile="http://www.w3.org/2005/10/profile">
        <link rel="icon" 
              type="image/png"
              href="https://zed.vision/favicon.ico">
        <style>
        ${G}
        ${V}
        </style>
        </head>
        <body>
        <div id="root">
        ${de}
        </div>
        <script crossorigin src="https://unpkg.com/react@17.0.1/umd/react.production.min.js"></script>
        ${me}
        <script crossorigin src="https://unpkg.com/react-dom@17.0.1/umd/react-dom.production.min.js"></script>
        <script crossorigin src="https://unpkg.com/@emotion/react@11.1.2/dist/emotion-react.umd.min.js"></script>
        <script crossorigin src="https://unpkg.com/@emotion/styled@11.0.0/dist/emotion-styled.umd.min.js"></script>
        <script type="module">
        Object.assign(window, emotionReact);

       const styled = window["emotionStyled"];

        let DefaultElement;

        ${C}

        ReactDOM.hydrate(jsx(DefaultElement), document.body.children[0]);
        </script>
        </body>
        </html>
        `,se=await re(je),ae=await ke(se);return ae}};if(!ot){const q=async z=>{if(z!==be)return;if(rt===z)return;rt=z;const de=new Request(Fe(),{body:z,method:"POST",headers:{"content-type":"text/plain;charset=UTF-8"}}),V=await ze(z);try{const G=await n.get(d);G!==V&&(await n.put(V,z),await n.put(d,V),F("h",V))}catch(G){console.error(G)}};q(Z)}ot=!1,I()}async function H(){const S=await Se(),E=new URLSearchParams(window.location.search),T=E.get("h")||await S.get(d);if(T){let C;try{C=await S.get(T)}catch{console.error("error load key: "+T)}if(C)return C;let I;try{const q=await fetch(Fe()+"/?h="+T);I=await q.json()}catch(q){const z=await ze(xe);return S.put(z,xe),await S.put(d,z),xe}return I}return xe}function F(S,E){const T=new URLSearchParams(window.location.search);T.set(S,E),window.history.replaceState({},"",decodeURIComponent(`${window.location.pathname}?${T}`))}function re(S){const E=new Blob([S],{type:"text/html"});return E}async function ke(S){const E=Fe(),T=new Request(E,{body:S,method:"POST",headers:{"content-type":"text/html;charset=UTF-8",SHARE:"true"}}),C=await fetch(T),{hash:I}=await C.json();return`${E}/${I}`}function le(S){const{transform:E}=window.Babel;return E(`/** @jsx jsx */

  Object.assign(window, React);
  `+S,{plugins:[],presets:["react",["typescript",{isTSX:!0,allExtensions:!0}]]}).code}}
