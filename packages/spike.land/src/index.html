<!DOCTYPE html>
<html lang="en">

<head profile="http://www.w3.org/2005/10/profile">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <base href="/">
  <link rel="shortcut icon" type="image/png" href="/favicons/chunk-chunk-fe2f7da4f9ccc2.png">
  <title>Instant React Editor</title>

  <script type="importmap"></script>
  <style>
    html,
    body {
      overflow: hidden;
      margin: 0;
      height: 100%;
      --webkit-overflow-scrolling: touch;
      overscroll-behavior-x: none;
    }

    q {
      display: none;
    }


    @media screen and (prefers-color-scheme: dark) {
      body {
        background-color: #121212;
        ;
        color: hsl(210, 10%, 62%);
        --text-color-normal: hsl(210, 10%, 62%);
        --text-color-light: hsl(210, 15%, 35%);
        --text-color-richer: hsl(210, 50%, 72%);
        --text-color-highlight: hsl(25, 70%, 45%);
      }
    }


    @media screen and (prefers-color-scheme: light) {
      body {
        background-color: white;
        color: black;
        --text-color-normal: #0a244d;
        --text-color-light: #8cabd9;
      }
    }

    /**reset*/
  </style>
</head>


<body>
  <div id="root"></div>
  <script type="module">
    import { hydrate, md5 } from "./hydrate.mjs?ASSET_HASH";
    import load from "./load.mjs?ASSET_HASH";


    globalThis.assetHash = "ASSET_HASH";
    const paths = location.pathname.split("/");
    const codeSpace = paths[2];

    const rootEl = document.getElementById(`root`);


    if (location.pathname !== `/live/${codeSpace}` && !location.pathname.endsWith("worker")) {
      const bc = new BroadcastChannel(location.origin);
      hydrate(codeSpace);
      bc.onmessage = async (event) => {
        if (event.data.codeSpace === codeSpace && event.data.sess) {
          const { html, css, transpiled, i } = event.data.sess;
          //     unmountComponentAtNode(document.getElementById(codeSpace+"-css"));

          //      document.body = `<div id="root" data-i="${i}" style="height: 100%;">${html.split(md5(transpiled)).join(`css`)}</div>`,
          await hydrate(codeSpace, event.data.sess);
        }
      };
    } else if (location.pathname.endsWith('worker')){
      load();
    } else {
      load();
    }
  </script>

  <script type="module">
    import {Workbox} from '/node_modules/workbox-window@6.5.4/build/workbox-window.prod.mjs';

if ('serviceWorker' in navigator) {
  const wb = new Workbox('/sw.js');

  wb.register();
}
  </script>

</body>

</html>