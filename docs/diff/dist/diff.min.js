(function(i,l){typeof exports=="object"&&typeof module!="undefined"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(i=i||self,l(i.Diff={}))})(this,function(i){"use strict";function l(){}l.prototype={diff:function(n,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=r.callback;typeof r=="function"&&(o=r,r={}),this.options=r;var s=this;function f(p){return o?(setTimeout(function(){o(void 0,p)},0),!0):p}n=this.castInput(n),t=this.castInput(t),n=this.removeEmpty(this.tokenize(n)),t=this.removeEmpty(this.tokenize(t));var a=t.length,u=n.length,d=1,h=a+u,v=[{newPos:-1,components:[]}],c=this.extractCommon(v[0],t,n,0);if(v[0].newPos+1>=a&&c+1>=u)return f([{value:this.join(t),count:t.length}]);function m(){for(var p=-1*d;p<=d;p+=2){var H=void 0,A=v[p-1],I=v[p+1],M=(I?I.newPos:0)-p;A&&(v[p-1]=void 0);var N=A&&A.newPos+1<a,P=I&&0<=M&&M<u;if(!N&&!P){v[p]=void 0;continue}if(!N||P&&A.newPos<I.newPos?(H=w(I),s.pushComponent(H.components,void 0,!0)):(H=A,H.newPos++,s.pushComponent(H.components,!0,void 0)),M=s.extractCommon(H,t,n,p),H.newPos+1>=a&&M+1>=u)return f(g(s,H.components,t,n,s.useLongestToken));v[p]=H}d++}if(o)(function p(){setTimeout(function(){if(d>h)return o();m()||p()},0)})();else for(;d<=h;){var S=m();if(S)return S}},pushComponent:function(n,t,r){var o=n[n.length-1];o&&o.added===t&&o.removed===r?n[n.length-1]={count:o.count+1,added:t,removed:r}:n.push({count:1,added:t,removed:r})},extractCommon:function(n,t,r,o){for(var s=t.length,f=r.length,a=n.newPos,u=a-o,d=0;a+1<s&&u+1<f&&this.equals(t[a+1],r[u+1]);)a++,u++,d++;return d&&n.components.push({count:d}),n.newPos=a,u},equals:function(n,t){return this.options.comparator?this.options.comparator(n,t):n===t||this.options.ignoreCase&&n.toLowerCase()===t.toLowerCase()},removeEmpty:function(n){for(var t=[],r=0;r<n.length;r++)n[r]&&t.push(n[r]);return t},castInput:function(n){return n},tokenize:function(n){return n.split("")},join:function(n){return n.join("")}};function g(e,n,t,r,o){for(var s=0,f=n.length,a=0,u=0;s<f;s++){var d=n[s];if(d.removed){if(d.value=e.join(r.slice(u,u+d.count)),u+=d.count,s&&n[s-1].added){var v=n[s-1];n[s-1]=n[s],n[s]=v}}else{if(!d.added&&o){var h=t.slice(a,a+d.count);h=h.map(function(m,S){var p=r[u+S];return p.length>m.length?p:m}),d.value=e.join(h)}else d.value=e.join(t.slice(a,a+d.count));a+=d.count,d.added||(u+=d.count)}}var c=n[f-1];return f>1&&typeof c.value=="string"&&(c.added||c.removed)&&e.equals("",c.value)&&(n[f-2].value+=c.value,n.pop()),n}function w(e){return{newPos:e.newPos,components:e.components.slice(0)}}var L=new l;function E(e,n,t){return L.diff(e,n,t)}function y(e,n){if(typeof e=="function")n.callback=e;else if(e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}var F=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,x=/\S/,b=new l;b.equals=function(e,n){return this.options.ignoreCase&&(e=e.toLowerCase(),n=n.toLowerCase()),e===n||this.options.ignoreWhitespace&&!x.test(e)&&!x.test(n)},b.tokenize=function(e){for(var n=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),t=0;t<n.length-1;t++)!n[t+1]&&n[t+2]&&F.test(n[t])&&F.test(n[t+2])&&(n[t]+=n[t+2],n.splice(t+1,2),t--);return n};function z(e,n,t){return t=y(t,{ignoreWhitespace:!0}),b.diff(e,n,t)}function O(e,n,t){return b.diff(e,n,t)}var W=new l;W.tokenize=function(e){var n=[],t=e.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var r=0;r<t.length;r++){var o=t[r];r%2&&!this.options.newlineIsToken?n[n.length-1]+=o:(this.options.ignoreWhitespace&&(o=o.trim()),n.push(o))}return n};function ve(e,n,t){return W.diff(e,n,t)}function Re(e,n,t){var r=y(t,{ignoreWhitespace:!0});return W.diff(e,n,r)}var ge=new l;ge.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};function Je(e,n,t){return ge.diff(e,n,t)}var we=new l;we.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};function Ve(e,n,t){return we.diff(e,n,t)}function Y(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Y=function(n){return typeof n}:Y=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Y(e)}function C(e){return $e(e)||De(e)||Ue(e)||Be()}function $e(e){if(Array.isArray(e))return ie(e)}function De(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function Ue(e,n){if(!e)return;if(typeof e=="string")return ie(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ie(e,n)}function ie(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Be(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Xe=Object.prototype.toString,X=new l;X.useLongestToken=!0,X.tokenize=W.tokenize,X.castInput=function(e){var n=this.options,t=n.undefinedReplacement,r=n.stringifyReplacer,o=r===void 0?function(s,f){return typeof f=="undefined"?t:f}:r;return typeof e=="string"?e:JSON.stringify(K(e,null,null,o),o,"  ")},X.equals=function(e,n){return l.prototype.equals.call(X,e.replace(/,([\r\n])/g,"$1"),n.replace(/,([\r\n])/g,"$1"))};function je(e,n,t){return X.diff(e,n,t)}function K(e,n,t,r,o){n=n||[],t=t||[],r&&(e=r(o,e));var s;for(s=0;s<n.length;s+=1)if(n[s]===e)return t[s];var f;if(Xe.call(e)==="[object Array]"){for(n.push(e),f=new Array(e.length),t.push(f),s=0;s<e.length;s+=1)f[s]=K(e[s],n,t,r,o);return n.pop(),t.pop(),f}if(e&&e.toJSON&&(e=e.toJSON()),Y(e)==="object"&&e!==null){n.push(e),f={},t.push(f);var a=[],u;for(u in e)e.hasOwnProperty(u)&&a.push(u);for(a.sort(),s=0;s<a.length;s+=1)u=a[s],f[u]=K(e[u],n,t,r,u);n.pop(),t.pop()}else f=e;return f}var k=new l;k.tokenize=function(e){return e.slice()},k.join=k.removeEmpty=function(e){return e};function Ge(e,n,t){return k.diff(e,n,t)}function _(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.split(/\r\n|[\n\v\f\r\x85]/),r=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=[],s=0;function f(){var d={};for(o.push(d);s<t.length;){var h=t[s];if(/^(\-\-\-|\+\+\+|@@)\s/.test(h))break;var v=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(h);v&&(d.index=v[1]),s++}for(a(d),a(d),d.hunks=[];s<t.length;){var c=t[s];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(c))break;if(/^@@/.test(c))d.hunks.push(u());else{if(c&&n.strict)throw new Error("Unknown line "+(s+1)+" "+JSON.stringify(c));s++}}}function a(d){var h=/^(---|\+\+\+)\s+(.*)$/.exec(t[s]);if(h){var v=h[1]==="---"?"old":"new",c=h[2].split("	",2),m=c[0].replace(/\\\\/g,"\\");/^".*"$/.test(m)&&(m=m.substr(1,m.length-2)),d[v+"FileName"]=m,d[v+"Header"]=(c[1]||"").trim(),s++}}function u(){var d=s,h=t[s++],v=h.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),c={oldStart:+v[1],oldLines:typeof v[2]=="undefined"?1:+v[2],newStart:+v[3],newLines:typeof v[4]=="undefined"?1:+v[4],lines:[],linedelimiters:[]};c.oldLines===0&&(c.oldStart+=1),c.newLines===0&&(c.newStart+=1);for(var m=0,S=0;s<t.length&&!(t[s].indexOf("--- ")===0&&s+2<t.length&&t[s+1].indexOf("+++ ")===0&&t[s+2].indexOf("@@")===0);s++){var p=t[s].length==0&&s!=t.length-1?" ":t[s][0];if(p==="+"||p==="-"||p===" "||p==="\\")c.lines.push(t[s]),c.linedelimiters.push(r[s]||`
`),p==="+"?m++:p==="-"?S++:p===" "&&(m++,S++);else break}if(!m&&c.newLines===1&&(c.newLines=0),!S&&c.oldLines===1&&(c.oldLines=0),n.strict){if(m!==c.newLines)throw new Error("Added line count did not match for hunk at line "+(d+1));if(S!==c.oldLines)throw new Error("Removed line count did not match for hunk at line "+(d+1))}return c}for(;s<t.length;)f();return o}function Ze(e,n,t){var r=!0,o=!1,s=!1,f=1;return function a(){if(r&&!s){if(o?f++:r=!1,e+f<=t)return f;s=!0}if(!o)return s||(r=!0),n<=e-f?-f++:(o=!0,a())}}function ye(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof n=="string"&&(n=_(n)),Array.isArray(n)){if(n.length>1)throw new Error("applyPatch only works with a single input.");n=n[0]}var r=e.split(/\r\n|[\n\v\f\r\x85]/),o=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],s=n.hunks,f=t.compareLine||function(ue,Z,te,U){return Z===U},a=0,u=t.fuzzFactor||0,d=0,h=0,v,c;function m(ue,Z){for(var te=0;te<ue.lines.length;te++){var U=ue.lines[te],de=U.length>0?U[0]:" ",an=U.length>0?U.substr(1):U;if(de===" "||de==="-"){if(!f(Z+1,r[Z],de,an)&&(a++,a>u))return!1;Z++}}return!0}for(var S=0;S<s.length;S++){for(var p=s[S],H=r.length-p.oldLines,A=0,I=h+p.oldStart-1,M=Ze(I,d,H);A!==void 0;A=M())if(m(p,I+A)){p.offset=h+=A;break}if(A===void 0)return!1;d=p.offset+p.oldStart+p.oldLines}for(var N=0,P=0;P<s.length;P++){var T=s[P],q=T.oldStart+T.offset+N-1;N+=T.newLines-T.oldLines;for(var R=0;R<T.lines.length;R++){var J=T.lines[R],V=J.length>0?J[0]:" ",ne=J.length>0?J.substr(1):J,le=T.linedelimiters[R];if(V===" ")q++;else if(V==="-")r.splice(q,1),o.splice(q,1);else if(V==="+")r.splice(q,0,ne),o.splice(q,0,le),q++;else if(V==="\\"){var G=T.lines[R-1]?T.lines[R-1][0]:null;G==="+"?v=!0:G==="-"&&(c=!0)}}}if(v)for(;!r[r.length-1];)r.pop(),o.pop();else c&&(r.push(""),o.push(`
`));for(var D=0;D<r.length-1;D++)r[D]=r[D]+o[D];return r.join("")}function Qe(e,n){typeof e=="string"&&(e=_(e));var t=0;function r(){var o=e[t++];if(!o)return n.complete();n.loadFile(o,function(s,f){if(s)return n.complete(s);var a=ye(f,o,n);n.patched(o,a,function(u){if(u)return n.complete(u);r()})})}r()}function se(e,n,t,r,o,s,f){f||(f={}),typeof f.context=="undefined"&&(f.context=4);var a=ve(t,r,f);a.push({value:"",lines:[]});function u(A){return A.map(function(I){return" "+I})}for(var d=[],h=0,v=0,c=[],m=1,S=1,p=function(I){var M=a[I],N=M.lines||M.value.replace(/\n$/,"").split(`
`);if(M.lines=N,M.added||M.removed){var P;if(!h){var T=a[I-1];h=m,v=S,T&&(c=f.context>0?u(T.lines.slice(-f.context)):[],h-=c.length,v-=c.length)}(P=c).push.apply(P,C(N.map(function(D){return(M.added?"+":"-")+D}))),M.added?S+=N.length:m+=N.length}else{if(h)if(N.length<=f.context*2&&I<a.length-2){var q;(q=c).push.apply(q,C(u(N)))}else{var R,J=Math.min(N.length,f.context);(R=c).push.apply(R,C(u(N.slice(0,J))));var V={oldStart:h,oldLines:m-h+J,newStart:v,newLines:S-v+J,lines:c};if(I>=a.length-2&&N.length<=f.context){var ne=/\n$/.test(t),le=/\n$/.test(r),G=N.length==0&&c.length>V.oldLines;!ne&&G&&t.length>0&&c.splice(V.oldLines,0,"\\ No newline at end of file"),(!ne&&!G||!le)&&c.push("\\ No newline at end of file")}d.push(V),h=0,v=0,c=[]}m+=N.length,S+=N.length}},H=0;H<a.length;H++)p(H);return{oldFileName:e,newFileName:n,oldHeader:o,newHeader:s,hunks:d}}function Ye(e){var n=[];e.oldFileName==e.newFileName&&n.push("Index: "+e.oldFileName),n.push("==================================================================="),n.push("--- "+e.oldFileName+(typeof e.oldHeader=="undefined"?"":"	"+e.oldHeader)),n.push("+++ "+e.newFileName+(typeof e.newHeader=="undefined"?"":"	"+e.newHeader));for(var t=0;t<e.hunks.length;t++){var r=e.hunks[t];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),n.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@"),n.push.apply(n,r.lines)}return n.join(`
`)+`
`}function me(e,n,t,r,o,s,f){return Ye(se(e,n,t,r,o,s,f))}function Ke(e,n,t,r,o,s){return me(e,e,n,t,r,o,s)}function ke(e,n){return e.length!==n.length?!1:oe(e,n)}function oe(e,n){if(n.length>e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function _e(e){var n=ae(e.lines),t=n.oldLines,r=n.newLines;t!==void 0?e.oldLines=t:delete e.oldLines,r!==void 0?e.newLines=r:delete e.newLines}function en(e,n,t){e=Le(e,t),n=Le(n,t);var r={};(e.index||n.index)&&(r.index=e.index||n.index),(e.newFileName||n.newFileName)&&(xe(e)?xe(n)?(r.oldFileName=ee(r,e.oldFileName,n.oldFileName),r.newFileName=ee(r,e.newFileName,n.newFileName),r.oldHeader=ee(r,e.oldHeader,n.oldHeader),r.newHeader=ee(r,e.newHeader,n.newHeader)):(r.oldFileName=e.oldFileName,r.newFileName=e.newFileName,r.oldHeader=e.oldHeader,r.newHeader=e.newHeader):(r.oldFileName=n.oldFileName||e.oldFileName,r.newFileName=n.newFileName||e.newFileName,r.oldHeader=n.oldHeader||e.oldHeader,r.newHeader=n.newHeader||e.newHeader)),r.hunks=[];for(var o=0,s=0,f=0,a=0;o<e.hunks.length||s<n.hunks.length;){var u=e.hunks[o]||{oldStart:Infinity},d=n.hunks[s]||{oldStart:Infinity};if(be(u,d))r.hunks.push(Fe(u,f)),o++,a+=u.newLines-u.oldLines;else if(be(d,u))r.hunks.push(Fe(d,a)),s++,f+=d.newLines-d.oldLines;else{var h={oldStart:Math.min(u.oldStart,d.oldStart),oldLines:0,newStart:Math.min(u.newStart+f,d.oldStart+a),newLines:0,lines:[]};nn(h,u.oldStart,u.lines,d.oldStart,d.lines),s++,o++,r.hunks.push(h)}}return r}function Le(e,n){if(typeof e=="string"){if(/^@@/m.test(e)||/^Index:/m.test(e))return _(e)[0];if(!n)throw new Error("Must provide a base reference or pass in a patch");return se(void 0,void 0,n,e)}return e}function xe(e){return e.newFileName&&e.newFileName!==e.oldFileName}function ee(e,n,t){return n===t?n:(e.conflict=!0,{mine:n,theirs:t})}function be(e,n){return e.oldStart<n.oldStart&&e.oldStart+e.oldLines<n.oldStart}function Fe(e,n){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+n,newLines:e.newLines,lines:e.lines}}function nn(e,n,t,r,o){var s={offset:n,lines:t,index:0},f={offset:r,lines:o,index:0};for(Ne(e,s,f),Ne(e,f,s);s.index<s.lines.length&&f.index<f.lines.length;){var a=s.lines[s.index],u=f.lines[f.index];if((a[0]==="-"||a[0]==="+")&&(u[0]==="-"||u[0]==="+"))tn(e,s,f);else if(a[0]==="+"&&u[0]===" "){var d;(d=e.lines).push.apply(d,C($(s)))}else if(u[0]==="+"&&a[0]===" "){var h;(h=e.lines).push.apply(h,C($(f)))}else a[0]==="-"&&u[0]===" "?Se(e,s,f):u[0]==="-"&&a[0]===" "?Se(e,f,s,!0):a===u?(e.lines.push(a),s.index++,f.index++):fe(e,$(s),$(f))}Ee(e,s),Ee(e,f),_e(e)}function tn(e,n,t){var r=$(n),o=$(t);if(He(r)&&He(o)){if(oe(r,o)&&Ie(t,r,r.length-o.length)){var s;(s=e.lines).push.apply(s,C(r));return}else if(oe(o,r)&&Ie(n,o,o.length-r.length)){var f;(f=e.lines).push.apply(f,C(o));return}}else if(ke(r,o)){var a;(a=e.lines).push.apply(a,C(r));return}fe(e,r,o)}function Se(e,n,t,r){var o=$(n),s=rn(t,o);if(s.merged){var f;(f=e.lines).push.apply(f,C(s.merged))}else fe(e,r?s:o,r?o:s)}function fe(e,n,t){e.conflict=!0,e.lines.push({conflict:!0,mine:n,theirs:t})}function Ne(e,n,t){for(;n.offset<t.offset&&n.index<n.lines.length;){var r=n.lines[n.index++];e.lines.push(r),n.offset++}}function Ee(e,n){for(;n.index<n.lines.length;){var t=n.lines[n.index++];e.lines.push(t)}}function $(e){for(var n=[],t=e.lines[e.index][0];e.index<e.lines.length;){var r=e.lines[e.index];if(t==="-"&&r[0]==="+"&&(t="+"),t===r[0])n.push(r),e.index++;else break}return n}function rn(e,n){for(var t=[],r=[],o=0,s=!1,f=!1;o<n.length&&e.index<e.lines.length;){var a=e.lines[e.index],u=n[o];if(u[0]==="+")break;if(s=s||a[0]!==" ",r.push(u),o++,a[0]==="+")for(f=!0;a[0]==="+";)t.push(a),a=e.lines[++e.index];u.substr(1)===a.substr(1)?(t.push(a),e.index++):f=!0}if((n[o]||"")[0]==="+"&&s&&(f=!0),f)return t;for(;o<n.length;)r.push(n[o++]);return{merged:r,changes:t}}function He(e){return e.reduce(function(n,t){return n&&t[0]==="-"},!0)}function Ie(e,n,t){for(var r=0;r<t;r++){var o=n[n.length-t+r].substr(1);if(e.lines[e.index+r]!==" "+o)return!1}return e.index+=t,!0}function ae(e){var n=0,t=0;return e.forEach(function(r){if(typeof r!="string"){var o=ae(r.mine),s=ae(r.theirs);n!==void 0&&(o.oldLines===s.oldLines?n+=o.oldLines:n=void 0),t!==void 0&&(o.newLines===s.newLines?t+=o.newLines:t=void 0)}else t!==void 0&&(r[0]==="+"||r[0]===" ")&&t++,n!==void 0&&(r[0]==="-"||r[0]===" ")&&n++}),{oldLines:n,newLines:t}}function sn(e){for(var n=[],t,r,o=0;o<e.length;o++)t=e[o],t.added?r=1:t.removed?r=-1:r=0,n.push([r,t.value]);return n}function on(e){for(var n=[],t=0;t<e.length;t++){var r=e[t];r.added?n.push("<ins>"):r.removed&&n.push("<del>"),n.push(fn(r.value)),r.added?n.push("</ins>"):r.removed&&n.push("</del>")}return n.join("")}function fn(e){var n=e;return n=n.replace(/&/g,"&amp;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/"/g,"&quot;"),n}i.Diff=l,i.applyPatch=ye,i.applyPatches=Qe,i.canonicalize=K,i.convertChangesToDMP=sn,i.convertChangesToXML=on,i.createPatch=Ke,i.createTwoFilesPatch=me,i.diffArrays=Ge,i.diffChars=E,i.diffCss=Ve,i.diffJson=je,i.diffLines=ve,i.diffSentences=Je,i.diffTrimmedLines=Re,i.diffWords=z,i.diffWordsWithSpace=O,i.merge=en,i.parsePatch=_,i.structuredPatch=se,Object.defineProperty(i,"__esModule",{value:!0})});const Oe=Symbol("Comlink.proxy"),ln=Symbol("Comlink.endpoint"),un=Symbol("Comlink.releaseProxy"),ce=Symbol("Comlink.thrown"),Ae=i=>typeof i=="object"&&i!==null||typeof i=="function",dn={canHandle:i=>Ae(i)&&ce in i,serialize({value:i}){let l;return i instanceof Error?l={isError:!0,value:{message:i.message,name:i.name,stack:i.stack}}:l={isError:!1,value:i},[l,[]]},deserialize(i){throw i.isError?Object.assign(new Error(i.value.message),i.value):i.value}};function cn(i){return i.constructor.name==="MessagePort"}function Me(i){cn(i)&&i.close()}function re(i){if(i)throw new Error("Proxy has been released and is not useable")}function pn(i){return Array.prototype.concat.apply([],i)}const Te=new WeakMap;function hn(i,l){return Te.set(i,l),i}function vn(i){return Object.assign(i,{[Oe]:!0})}function gn(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}let Q;export const isDiff=i=>{if(i.length<10)return!1;const l=[...i.slice(0,8)].filter(w=>w<"0"||w>"f").length===0,g=i.slice(8);if(l&&g[0]==="["&&g[g.length-1]==="]")try{return JSON.parse(g).length>1}catch{return!1}return!1},assemble=(i,l)=>{const g=JSON.parse(l);let w=i.slice(),L="";return g.forEach(E=>{if(Number(E)===E){const y=Math.abs(E),F=w.slice(0,y);w=w.slice(y),E>0&&(L+=String(F))}else L+=String(E)}),L};function j(i,l,g){return new Promise(w=>{const L=gn();i.addEventListener("message",function E(y){if(!y.data||!y.data.id||y.data.id!==L)return;i.removeEventListener("message",E),w(y.data)}),i.start&&i.start(),i.postMessage(Object.assign({id:L},l),g)})}const wn={canHandle:i=>Ae(i)&&i[Oe],serialize(i){const{port1:l,port2:g}=new MessageChannel;return We(i,l),[g,[g]]},deserialize(i){return i.start(),Ce(i)}},ze=new Map([["proxy",wn],["throw",dn]]);function We(i,l=self){l.addEventListener("message",function g(w){if(!w||!w.data)return;const{id:L,type:E,path:y}=Object.assign({path:[]},w.data),F=(w.data.argumentList||[]).map(B);let x;try{const b=y.slice(0,-1).reduce((O,W)=>O[W],i),z=y.reduce((O,W)=>O[W],i);switch(E){case 0:x=z;break;case 1:b[y.slice(-1)[0]]=B(w.data.value),x=!0;break;case 2:x=z.apply(b,F);break;case 3:{const O=new z(...F);x=vn(O)}break;case 4:{const{port1:O,port2:W}=new MessageChannel;We(i,W),x=hn(O,[O])}break;case 5:x=void 0;break}}catch(b){x={value:b,[ce]:0}}Promise.resolve(x).catch(b=>({value:b,[ce]:0})).then(b=>{const[z,O]=he(b);l.postMessage(Object.assign(Object.assign({},z),{id:L}),O),E===5&&(l.removeEventListener("message",g),Me(l))})}),l.start&&l.start()}function Ce(i,l){return pe(i,[],l)}function pe(i,l=[],g=function(){}){let w=!1;const L=new Proxy(g,{get(E,y){if(re(w),y===un)return()=>j(i,{type:5,path:l.map(F=>F.toString())}).then(()=>{Me(i),w=!0});if(y==="then"){if(l.length===0)return{then:()=>L};const F=j(i,{type:0,path:l.map(x=>x.toString())}).then(B);return F.then.bind(F)}return pe(i,[...l,y])},set(E,y,F){re(w);const[x,b]=he(F);return j(i,{type:1,path:[...l,y].map(z=>z.toString()),value:x},b).then(B)},apply(E,y,F){re(w);const x=l[l.length-1];if(x===ln)return j(i,{type:4}).then(B);if(x==="bind")return pe(i,l.slice(0,-1));const[b,z]=Pe(F);return j(i,{type:2,path:l.map(O=>O.toString()),argumentList:b},z).then(B)},construct(E,y){re(w);const[F,x]=Pe(y);return j(i,{type:3,path:l.map(b=>b.toString()),argumentList:F},x).then(B)}});return L}function Pe(i){const l=i.map(he);return[l.map(g=>g[0]),pn(l.map(g=>g[1]))]}function he(i){for(const[l,g]of ze)if(g.canHandle(i)){const[w,L]=g.serialize(i);return[{type:3,name:l,value:w},L]}return[{type:0,value:i},Te.get(i)||[]]}function B(i){switch(i.type){case 3:return ze.get(i.name).deserialize(i.value);case 0:return i.value}}async function yn(i){const l=new TextEncoder().encode(i);return mn(l)}async function mn(i){return Q=Q||await qe(),Q(i)}function qe(){const i=new Worker("./dist/sha256.worker.js");return Q=Ce(i),Q}qe();export const diff=async(i,l)=>{const g=yn(i),w=Diff.diffChars(i,l);return{b:await g,c:w.map(L=>L.added?L.value:L.removed?-L.count:L.count)}};
