import{l as Je}from"./HR3VR7QX.mjs";import{c as H,e as tn,g as m}from"./YZ5NCQOK.mjs";var Mi=H((Sa,zi)=>{m();var vt=-1,ht=1,Z=0;function me(t,e,r,n){if(t===e)return t?[[Z,t]]:[];if(r!=null){var i=vs(t,e,r);if(i)return i}var s=Ur(t,e),o=t.substring(0,s);t=t.substring(s),e=e.substring(s),s=$r(t,e);var a=t.substring(t.length-s);t=t.substring(0,t.length-s),e=e.substring(0,e.length-s);var u=ps(t,e);return o&&u.unshift([Z,o]),a&&u.push([Z,a]),wi(u,n),u}function ps(t,e){var r;if(!t)return[[ht,e]];if(!e)return[[vt,t]];var n=t.length>e.length?t:e,i=t.length>e.length?e:t,s=n.indexOf(i);if(s!==-1)return r=[[ht,n.substring(0,s)],[Z,i],[ht,n.substring(s+i.length)]],t.length>e.length&&(r[0][0]=r[2][0]=vt),r;if(i.length===1)return[[vt,t],[ht,e]];var o=ls(t,e);if(o){var a=o[0],u=o[1],f=o[2],p=o[3],c=o[4],l=me(a,f),h=me(u,p);return l.concat([[Z,c]],h)}return _s(t,e)}function _s(t,e){for(var r=t.length,n=e.length,i=Math.ceil((r+n)/2),s=i,o=2*i,a=new Array(o),u=new Array(o),f=0;f<o;f++)a[f]=-1,u[f]=-1;a[s+1]=0,u[s+1]=0;for(var p=r-n,c=p%2!==0,l=0,h=0,_=0,d=0,v=0;v<i;v++){for(var S=-v+l;S<=v-h;S+=2){var b=s+S,M;S===-v||S!==v&&a[b-1]<a[b+1]?M=a[b+1]:M=a[b-1]+1;for(var A=M-S;M<r&&A<n&&t.charAt(M)===e.charAt(A);)M++,A++;if(a[b]=M,M>r)h+=2;else if(A>n)l+=2;else if(c){var y=s+p-S;if(y>=0&&y<o&&u[y]!==-1){var g=r-u[y];if(M>=g)return Si(t,e,M,A)}}}for(var w=-v+_;w<=v-d;w+=2){var y=s+w,g;w===-v||w!==v&&u[y-1]<u[y+1]?g=u[y+1]:g=u[y-1]+1;for(var I=g-w;g<r&&I<n&&t.charAt(r-g-1)===e.charAt(n-I-1);)g++,I++;if(u[y]=g,g>r)d+=2;else if(I>n)_+=2;else if(!c){var b=s+p-w;if(b>=0&&b<o&&a[b]!==-1){var M=a[b],A=s+M-b;if(g=r-g,M>=g)return Si(t,e,M,A)}}}}return[[vt,t],[ht,e]]}function Si(t,e,r,n){var i=t.substring(0,r),s=e.substring(0,n),o=t.substring(r),a=e.substring(n),u=me(i,s),f=me(o,a);return u.concat(f)}function Ur(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var r=0,n=Math.min(t.length,e.length),i=n,s=0;r<i;)t.substring(s,i)==e.substring(s,i)?(r=i,s=r):n=i,i=Math.floor((n-r)/2+r);return bi(t.charCodeAt(i-1))&&i--,i}function $r(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var r=0,n=Math.min(t.length,e.length),i=n,s=0;r<i;)t.substring(t.length-i,t.length-s)==e.substring(e.length-i,e.length-s)?(r=i,s=r):n=i,i=Math.floor((n-r)/2+r);return Oi(t.charCodeAt(t.length-i))&&i--,i}function ls(t,e){var r=t.length>e.length?t:e,n=t.length>e.length?e:t;if(r.length<4||n.length*2<r.length)return null;function i(h,_,d){for(var v=h.substring(d,d+Math.floor(h.length/4)),S=-1,b="",M,A,y,g;(S=_.indexOf(v,S+1))!==-1;){var w=Ur(h.substring(d),_.substring(S)),I=$r(h.substring(0,d),_.substring(0,S));b.length<I+w&&(b=_.substring(S-I,S)+_.substring(S,S+w),M=h.substring(0,d-I),A=h.substring(d+w),y=_.substring(0,S-I),g=_.substring(S+w))}return b.length*2>=h.length?[M,A,y,g,b]:null}var s=i(r,n,Math.ceil(r.length/4)),o=i(r,n,Math.ceil(r.length/2)),a;if(!s&&!o)return null;o?s?a=s[4].length>o[4].length?s:o:a=o:a=s;var u,f,p,c;t.length>e.length?(u=a[0],f=a[1],p=a[2],c=a[3]):(p=a[0],c=a[1],u=a[2],f=a[3]);var l=a[4];return[u,f,p,c,l]}function wi(t,e){t.push([Z,""]);for(var r=0,n=0,i=0,s="",o="",a;r<t.length;){if(r<t.length-1&&!t[r][1]){t.splice(r,1);continue}switch(t[r][0]){case ht:i++,o+=t[r][1],r++;break;case vt:n++,s+=t[r][1],r++;break;case Z:var u=r-i-n-1;if(e){if(u>=0&&Ei(t[u][1])){var f=t[u][1].slice(-1);if(t[u][1]=t[u][1].slice(0,-1),s=f+s,o=f+o,!t[u][1]){t.splice(u,1),r--;var p=u-1;t[p]&&t[p][0]===ht&&(i++,o=t[p][1]+o,p--),t[p]&&t[p][0]===vt&&(n++,s=t[p][1]+s,p--),u=p}}if(Ii(t[r][1])){var f=t[r][1].charAt(0);t[r][1]=t[r][1].slice(1),s+=f,o+=f}}if(r<t.length-1&&!t[r][1]){t.splice(r,1);break}if(s.length>0||o.length>0){s.length>0&&o.length>0&&(a=Ur(o,s),a!==0&&(u>=0?t[u][1]+=o.substring(0,a):(t.splice(0,0,[Z,o.substring(0,a)]),r++),o=o.substring(a),s=s.substring(a)),a=$r(o,s),a!==0&&(t[r][1]=o.substring(o.length-a)+t[r][1],o=o.substring(0,o.length-a),s=s.substring(0,s.length-a)));var c=i+n;s.length===0&&o.length===0?(t.splice(r-c,c),r=r-c):s.length===0?(t.splice(r-c,c,[ht,o]),r=r-c+1):o.length===0?(t.splice(r-c,c,[vt,s]),r=r-c+1):(t.splice(r-c,c,[vt,s],[ht,o]),r=r-c+2)}r!==0&&t[r-1][0]===Z?(t[r-1][1]+=t[r][1],t.splice(r,1)):r++,i=0,n=0,s="",o="";break}}t[t.length-1][1]===""&&t.pop();var l=!1;for(r=1;r<t.length-1;)t[r-1][0]===Z&&t[r+1][0]===Z&&(t[r][1].substring(t[r][1].length-t[r-1][1].length)===t[r-1][1]?(t[r][1]=t[r-1][1]+t[r][1].substring(0,t[r][1].length-t[r-1][1].length),t[r+1][1]=t[r-1][1]+t[r+1][1],t.splice(r-1,1),l=!0):t[r][1].substring(0,t[r+1][1].length)==t[r+1][1]&&(t[r-1][1]+=t[r+1][1],t[r][1]=t[r][1].substring(t[r+1][1].length)+t[r+1][1],t.splice(r+1,1),l=!0)),r++;l&&wi(t,e)}function bi(t){return t>=55296&&t<=56319}function Oi(t){return t>=56320&&t<=57343}function Ii(t){return Oi(t.charCodeAt(0))}function Ei(t){return bi(t.charCodeAt(t.length-1))}function ds(t){for(var e=[],r=0;r<t.length;r++)t[r][1].length>0&&e.push(t[r]);return e}function Lr(t,e,r,n){return Ei(t)||Ii(n)?null:ds([[Z,t],[vt,e],[ht,r],[Z,n]])}function vs(t,e,r){var n=typeof r=="number"?{index:r,length:0}:r.oldRange,i=typeof r=="number"?null:r.newRange,s=t.length,o=e.length;if(n.length===0&&(i===null||i.length===0)){var a=n.index,u=t.slice(0,a),f=t.slice(a),p=i?i.index:null;t:{var c=a+o-s;if(p!==null&&p!==c||c<0||c>o)break t;var l=e.slice(0,c),h=e.slice(c);if(h!==f)break t;var _=Math.min(a,c),d=u.slice(0,_),v=l.slice(0,_);if(d!==v)break t;var S=u.slice(_),b=l.slice(_);return Lr(d,S,b,f)}t:{if(p!==null&&p!==a)break t;var M=a,l=e.slice(0,M),h=e.slice(M);if(l!==u)break t;var A=Math.min(s-M,o-M),y=f.slice(f.length-A),g=h.slice(h.length-A);if(y!==g)break t;var S=f.slice(0,f.length-A),b=h.slice(0,h.length-A);return Lr(u,S,b,y)}}if(n.length>0&&i&&i.length===0){t:{var d=t.slice(0,n.index),y=t.slice(n.index+n.length),_=d.length,A=y.length;if(o<_+A)break t;var v=e.slice(0,_),g=e.slice(o-A);if(d!==v||y!==g)break t;var S=t.slice(_,s-A),b=e.slice(_,o-A);return Lr(d,S,b,y)}}return null}function Ue(t,e,r){return me(t,e,r,!0)}Ue.INSERT=ht;Ue.DELETE=vt;Ue.EQUAL=Z;zi.exports=Ue});var kr=H((Ma,qi)=>{m();function ms(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}qi.exports=ms});var Di=H((Ca,Ni)=>{m();var Ss=typeof self=="object"&&self&&self.Object===Object&&self;Ni.exports=Ss});var Fr=H((Ta,Li)=>{m();var ws=Di(),bs=typeof self=="object"&&self&&self.Object===Object&&self,Os=ws||bs||Function("return this")();Li.exports=Os});var $i=H((Aa,Ui)=>{m();var Is=Fr(),Es=function(){return Is.Date.now()};Ui.exports=Es});var ki=H((Ra,Pi)=>{m();var zs=/\s/;function Ms(t){for(var e=t.length;e--&&zs.test(t.charAt(e)););return e}Pi.exports=Ms});var Wi=H((ja,Fi)=>{m();var Cs=ki(),Ts=/^\s+/;function As(t){return t&&t.slice(0,Cs(t)+1).replace(Ts,"")}Fi.exports=As});var Wr=H((qa,Bi)=>{m();var Rs=Fr(),js=Rs.Symbol;Bi.exports=js});var Yi=H((Na,Ki)=>{m();var Hi=Wr(),Ji=Object.prototype,qs=Ji.hasOwnProperty,Ns=Ji.toString,Se=Hi?Hi.toStringTag:void 0;function Ds(t){var e=qs.call(t,Se),r=t[Se];try{t[Se]=void 0;var n=!0}catch{}var i=Ns.call(t);return n&&(e?t[Se]=r:delete t[Se]),i}Ki.exports=Ds});var Vi=H((Da,Gi)=>{m();var Ls=Object.prototype,Us=Ls.toString;function $s(t){return Us.call(t)}Gi.exports=$s});var xi=H((La,Qi)=>{m();var Xi=Wr(),Ps=Yi(),ks=Vi(),Fs="[object Null]",Ws="[object Undefined]",Zi=Xi?Xi.toStringTag:void 0;function Bs(t){return t==null?t===void 0?Ws:Fs:Zi&&Zi in Object(t)?Ps(t):ks(t)}Qi.exports=Bs});var eo=H((Ua,to)=>{m();function Hs(t){return t!=null&&typeof t=="object"}to.exports=Hs});var no=H(($a,ro)=>{m();var Js=xi(),Ks=eo(),Ys="[object Symbol]";function Gs(t){return typeof t=="symbol"||Ks(t)&&Js(t)==Ys}ro.exports=Gs});var ao=H((Pa,so)=>{m();var Vs=Wi(),io=kr(),Xs=no(),oo=0/0,Zs=/^[-+]0x[0-9a-f]+$/i,Qs=/^0b[01]+$/i,xs=/^0o[0-7]+$/i,ta=parseInt;function ea(t){if(typeof t=="number")return t;if(Xs(t))return oo;if(io(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=io(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Vs(t);var r=Qs.test(t);return r||xs.test(t)?ta(t.slice(2),r?2:8):Zs.test(t)?oo:+t}so.exports=ea});var co=H((ka,fo)=>{m();var ra=kr(),Br=$i(),uo=ao(),na="Expected a function",ia=Math.max,oa=Math.min;function sa(t,e,r){var n,i,s,o,a,u,f=0,p=!1,c=!1,l=!0;if(typeof t!="function")throw new TypeError(na);e=uo(e)||0,ra(r)&&(p=!!r.leading,c="maxWait"in r,s=c?ia(uo(r.maxWait)||0,e):s,l="trailing"in r?!!r.trailing:l);function h(g){var w=n,I=i;return n=i=void 0,f=g,o=t.apply(I,w),o}function _(g){return f=g,a=setTimeout(S,e),p?h(g):o}function d(g){var w=g-u,I=g-f,et=e-w;return c?oa(et,s-I):et}function v(g){var w=g-u,I=g-f;return u===void 0||w>=e||w<0||c&&I>=s}function S(){var g=Br();if(v(g))return b(g);a=setTimeout(S,d(g))}function b(g){return a=void 0,l&&n?h(g):(n=i=void 0,o)}function M(){a!==void 0&&clearTimeout(a),f=0,n=u=i=a=void 0}function A(){return a===void 0?o:b(Br())}function y(){var g=Br(),w=v(g);if(n=arguments,i=this,u=g,w){if(a===void 0)return _(u);if(c)return clearTimeout(a),a=setTimeout(S,e),h(u)}return a===void 0&&(a=setTimeout(S,e)),o}return y.cancel=M,y.flush=A,y}fo.exports=sa});m();m();m();var he="delete",R=5,rt=1<<R,J=rt-1,O={};function Qe(){return{value:!1}}function nt(t){t&&(t.value=!0)}function ar(){}function Lt(t){return t.size===void 0&&(t.size=t.__iterate(Mn)),t.size}function Ot(t,e){if(typeof e!="number"){var r=e>>>0;if(""+r!==e||r===4294967295)return NaN;e=r}return e<0?Lt(t)+e:e}function Mn(){return!0}function pe(t,e,r){return(t===0&&!Tn(t)||r!==void 0&&t<=-r)&&(e===void 0||r!==void 0&&e>=r)}function Bt(t,e){return Cn(t,e,0)}function _e(t,e){return Cn(t,e,e)}function Cn(t,e,r){return t===void 0?r:Tn(t)?e===1/0?e:Math.max(0,e+t)|0:e===void 0||e===t?t:Math.min(e,t)|0}function Tn(t){return t<0||t===0&&1/t===-1/0}var An="@@__IMMUTABLE_ITERABLE__@@";function X(t){return Boolean(t&&t[An])}var Rn="@@__IMMUTABLE_KEYED__@@";function N(t){return Boolean(t&&t[Rn])}var jn="@@__IMMUTABLE_INDEXED__@@";function V(t){return Boolean(t&&t[jn])}function Ae(t){return N(t)||V(t)}var D=function(e){return X(e)?e:x(e)},st=function(t){function e(r){return N(r)?r:Et(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(D),Rt=function(t){function e(r){return V(r)?r:at(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(D),Ht=function(t){function e(r){return X(r)&&!Ae(r)?r:Gt(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(D);D.Keyed=st;D.Indexed=Rt;D.Set=Ht;var qn="@@__IMMUTABLE_SEQ__@@";function ur(t){return Boolean(t&&t[qn])}var Nn="@@__IMMUTABLE_RECORD__@@";function Jt(t){return Boolean(t&&t[Nn])}function lt(t){return X(t)||Jt(t)}var Kt="@@__IMMUTABLE_ORDERED__@@";function ft(t){return Boolean(t&&t[Kt])}var le=0,ct=1,ot=2,xe=typeof Symbol=="function"&&Symbol.iterator,Dn="@@iterator",Re=xe||Dn,E=function(e){this.next=e};E.prototype.toString=function(){return"[Iterator]"};E.KEYS=le;E.VALUES=ct;E.ENTRIES=ot;E.prototype.inspect=E.prototype.toSource=function(){return this.toString()};E.prototype[Re]=function(){return this};function j(t,e,r,n){var i=t===0?e:t===1?r:[e,r];return n?n.value=i:n={value:i,done:!1},n}function K(){return{value:void 0,done:!0}}function Ln(t){return Array.isArray(t)?!0:!!je(t)}function en(t){return t&&typeof t.next=="function"}function tr(t){var e=je(t);return e&&e.call(t)}function je(t){var e=t&&(xe&&t[xe]||t[Dn]);if(typeof e=="function")return e}function mo(t){var e=je(t);return e&&e===t.entries}function So(t){var e=je(t);return e&&e===t.keys}var Yt=Object.prototype.hasOwnProperty;function Un(t){return Array.isArray(t)||typeof t=="string"?!0:t&&typeof t=="object"&&Number.isInteger(t.length)&&t.length>=0&&(t.length===0?Object.keys(t).length===1:t.hasOwnProperty(t.length-1))}var x=function(t){function e(r){return r==null?cr():lt(r)?r.toSeq():bo(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq {","}")},e.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},e.prototype.__iterate=function(n,i){var s=this._cache;if(s){for(var o=s.length,a=0;a!==o;){var u=s[i?o-++a:a++];if(n(u[1],u[0],this)===!1)break}return a}return this.__iterateUncached(n,i)},e.prototype.__iterator=function(n,i){var s=this._cache;if(s){var o=s.length,a=0;return new E(function(){if(a===o)return K();var u=s[i?o-++a:a++];return j(n,u[0],u[1])})}return this.__iteratorUncached(n,i)},e}(D),Et=function(t){function e(r){return r==null?cr().toKeyedSeq():X(r)?N(r)?r.toSeq():r.fromEntrySeq():Jt(r)?r.toSeq():hr(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toKeyedSeq=function(){return this},e}(x),at=function(t){function e(r){return r==null?cr():X(r)?N(r)?r.entrySeq():r.toIndexedSeq():Jt(r)?r.toSeq().entrySeq():$n(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toIndexedSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq [","]")},e}(x),Gt=function(t){function e(r){return(X(r)&&!Ae(r)?r:at(r)).toSetSeq()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toSetSeq=function(){return this},e}(x);x.isSeq=ur;x.Keyed=Et;x.Set=Gt;x.Indexed=at;x.prototype[qn]=!0;var At=function(t){function e(r){this._array=r,this.size=r.length}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(n,i){return this.has(n)?this._array[Ot(this,n)]:i},e.prototype.__iterate=function(n,i){for(var s=this._array,o=s.length,a=0;a!==o;){var u=i?o-++a:a++;if(n(s[u],u,this)===!1)break}return a},e.prototype.__iterator=function(n,i){var s=this._array,o=s.length,a=0;return new E(function(){if(a===o)return K();var u=i?o-++a:a++;return j(n,u,s[u])})},e}(at),fr=function(t){function e(r){var n=Object.keys(r).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(r):[]);this._object=r,this._keys=n,this.size=n.length}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(n,i){return i!==void 0&&!this.has(n)?i:this._object[n]},e.prototype.has=function(n){return Yt.call(this._object,n)},e.prototype.__iterate=function(n,i){for(var s=this._object,o=this._keys,a=o.length,u=0;u!==a;){var f=o[i?a-++u:u++];if(n(s[f],f,this)===!1)break}return u},e.prototype.__iterator=function(n,i){var s=this._object,o=this._keys,a=o.length,u=0;return new E(function(){if(u===a)return K();var f=o[i?a-++u:u++];return j(n,f,s[f])})},e}(Et);fr.prototype[Kt]=!0;var wo=function(t){function e(r){this._collection=r,this.size=r.length||r.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.__iterateUncached=function(n,i){if(i)return this.cacheResult().__iterate(n,i);var s=this._collection,o=tr(s),a=0;if(en(o))for(var u;!(u=o.next()).done&&n(u.value,a++,this)!==!1;);return a},e.prototype.__iteratorUncached=function(n,i){if(i)return this.cacheResult().__iterator(n,i);var s=this._collection,o=tr(s);if(!en(o))return new E(K);var a=0;return new E(function(){var u=o.next();return u.done?u:j(n,a++,u.value)})},e}(at),rn;function cr(){return rn||(rn=new At([]))}function hr(t){var e=pr(t);if(e)return e.fromEntrySeq();if(typeof t=="object")return new fr(t);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+t)}function $n(t){var e=pr(t);if(e)return e;throw new TypeError("Expected Array or collection object of values: "+t)}function bo(t){var e=pr(t);if(e)return mo(t)?e.fromEntrySeq():So(t)?e.toSetSeq():e;if(typeof t=="object")return new fr(t);throw new TypeError("Expected Array or collection object of values, or keyed object: "+t)}function pr(t){return Un(t)?new At(t):Ln(t)?new wo(t):void 0}var Pn="@@__IMMUTABLE_MAP__@@";function _r(t){return Boolean(t&&t[Pn])}function kn(t){return _r(t)&&ft(t)}function nn(t){return Boolean(t&&typeof t.equals=="function"&&typeof t.hashCode=="function")}function P(t,e){if(t===e||t!==t&&e!==e)return!0;if(!t||!e)return!1;if(typeof t.valueOf=="function"&&typeof e.valueOf=="function"){if(t=t.valueOf(),e=e.valueOf(),t===e||t!==t&&e!==e)return!0;if(!t||!e)return!1}return!!(nn(t)&&nn(e)&&t.equals(e))}var te=typeof Math.imul=="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(e,r){e|=0,r|=0;var n=e&65535,i=r&65535;return n*i+((e>>>16)*i+n*(r>>>16)<<16>>>0)|0};function qe(t){return t>>>1&1073741824|t&3221225471}var Oo=Object.prototype.valueOf;function Q(t){if(t==null)return on(t);if(typeof t.hashCode=="function")return qe(t.hashCode(t));var e=To(t);if(e==null)return on(e);switch(typeof e){case"boolean":return e?1108378657:1108378656;case"number":return Io(e);case"string":return e.length>Ao?Eo(e):er(e);case"object":case"function":return Mo(e);case"symbol":return zo(e);default:if(typeof e.toString=="function")return er(e.toString());throw new Error("Value type "+typeof e+" cannot be hashed.")}}function on(t){return t===null?1108378658:1108378659}function Io(t){if(t!==t||t===1/0)return 0;var e=t|0;for(e!==t&&(e^=t*4294967295);t>4294967295;)t/=4294967295,e^=t;return qe(e)}function Eo(t){var e=Ge[t];return e===void 0&&(e=er(t),Ye===Ro&&(Ye=0,Ge={}),Ye++,Ge[t]=e),e}function er(t){for(var e=0,r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return qe(e)}function zo(t){var e=un[t];return e!==void 0||(e=Fn(),un[t]=e),e}function Mo(t){var e;if(rr&&(e=nr.get(t),e!==void 0)||(e=t[Tt],e!==void 0)||!an&&(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[Tt],e!==void 0||(e=Co(t),e!==void 0)))return e;if(e=Fn(),rr)nr.set(t,e);else{if(sn!==void 0&&sn(t)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(an)Object.defineProperty(t,Tt,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(t.propertyIsEnumerable!==void 0&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[Tt]=e;else if(t.nodeType!==void 0)t[Tt]=e;else throw new Error("Unable to set a non-enumerable property on object.")}return e}var sn=Object.isExtensible,an=function(){try{return Object.defineProperty({},"@",{}),!0}catch{return!1}}();function Co(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}function To(t){return t.valueOf!==Oo&&typeof t.valueOf=="function"?t.valueOf(t):t}function Fn(){var t=++Ke;return Ke&1073741824&&(Ke=0),t}var rr=typeof WeakMap=="function",nr;rr&&(nr=new WeakMap);var un=Object.create(null),Ke=0,Tt="__immutablehash__";typeof Symbol=="function"&&(Tt=Symbol(Tt));var Ao=16,Ro=255,Ye=0,Ge={},Ne=function(t){function e(r,n){this._iter=r,this._useKeys=n,this.size=r.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(n,i){return this._iter.get(n,i)},e.prototype.has=function(n){return this._iter.has(n)},e.prototype.valueSeq=function(){return this._iter.valueSeq()},e.prototype.reverse=function(){var n=this,i=lr(this,!0);return this._useKeys||(i.valueSeq=function(){return n._iter.toSeq().reverse()}),i},e.prototype.map=function(n,i){var s=this,o=Kn(this,n,i);return this._useKeys||(o.valueSeq=function(){return s._iter.toSeq().map(n,i)}),o},e.prototype.__iterate=function(n,i){var s=this;return this._iter.__iterate(function(o,a){return n(o,a,s)},i)},e.prototype.__iterator=function(n,i){return this._iter.__iterator(n,i)},e}(Et);Ne.prototype[Kt]=!0;var Wn=function(t){function e(r){this._iter=r,this.size=r.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.includes=function(n){return this._iter.includes(n)},e.prototype.__iterate=function(n,i){var s=this,o=0;return i&&Lt(this),this._iter.__iterate(function(a){return n(a,i?s.size-++o:o++,s)},i)},e.prototype.__iterator=function(n,i){var s=this,o=this._iter.__iterator(ct,i),a=0;return i&&Lt(this),new E(function(){var u=o.next();return u.done?u:j(n,i?s.size-++a:a++,u.value,u)})},e}(at),Bn=function(t){function e(r){this._iter=r,this.size=r.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.has=function(n){return this._iter.includes(n)},e.prototype.__iterate=function(n,i){var s=this;return this._iter.__iterate(function(o){return n(o,o,s)},i)},e.prototype.__iterator=function(n,i){var s=this._iter.__iterator(ct,i);return new E(function(){var o=s.next();return o.done?o:j(n,o.value,o.value,o)})},e}(Gt),Hn=function(t){function e(r){this._iter=r,this.size=r.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.entrySeq=function(){return this._iter.toSeq()},e.prototype.__iterate=function(n,i){var s=this;return this._iter.__iterate(function(o){if(o){cn(o);var a=X(o);return n(a?o.get(1):o[1],a?o.get(0):o[0],s)}},i)},e.prototype.__iterator=function(n,i){var s=this._iter.__iterator(ct,i);return new E(function(){for(;;){var o=s.next();if(o.done)return o;var a=o.value;if(a){cn(a);var u=X(a);return j(n,u?a.get(0):a[0],u?a.get(1):a[1],o)}}})},e}(Et);Wn.prototype.cacheResult=Ne.prototype.cacheResult=Bn.prototype.cacheResult=Hn.prototype.cacheResult=vr;function Jn(t){var e=dt(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var r=t.reverse.apply(this);return r.flip=function(){return t.reverse()},r},e.has=function(r){return t.includes(r)},e.includes=function(r){return t.has(r)},e.cacheResult=vr,e.__iterateUncached=function(r,n){var i=this;return t.__iterate(function(s,o){return r(o,s,i)!==!1},n)},e.__iteratorUncached=function(r,n){if(r===ot){var i=t.__iterator(r,n);return new E(function(){var s=i.next();if(!s.done){var o=s.value[0];s.value[0]=s.value[1],s.value[1]=o}return s})}return t.__iterator(r===ct?le:ct,n)},e}function Kn(t,e,r){var n=dt(t);return n.size=t.size,n.has=function(i){return t.has(i)},n.get=function(i,s){var o=t.get(i,O);return o===O?s:e.call(r,o,i,t)},n.__iterateUncached=function(i,s){var o=this;return t.__iterate(function(a,u,f){return i(e.call(r,a,u,f),u,o)!==!1},s)},n.__iteratorUncached=function(i,s){var o=t.__iterator(ot,s);return new E(function(){var a=o.next();if(a.done)return a;var u=a.value,f=u[0];return j(i,f,e.call(r,u[1],f,t),a)})},n}function lr(t,e){var r=this,n=dt(t);return n._iter=t,n.size=t.size,n.reverse=function(){return t},t.flip&&(n.flip=function(){var i=Jn(t);return i.reverse=function(){return t.flip()},i}),n.get=function(i,s){return t.get(e?i:-1-i,s)},n.has=function(i){return t.has(e?i:-1-i)},n.includes=function(i){return t.includes(i)},n.cacheResult=vr,n.__iterate=function(i,s){var o=this,a=0;return s&&Lt(t),t.__iterate(function(u,f){return i(u,e?f:s?o.size-++a:a++,o)},!s)},n.__iterator=function(i,s){var o=0;s&&Lt(t);var a=t.__iterator(ot,!s);return new E(function(){var u=a.next();if(u.done)return u;var f=u.value;return j(i,e?f[0]:s?r.size-++o:o++,f[1],u)})},n}function Yn(t,e,r,n){var i=dt(t);return n&&(i.has=function(s){var o=t.get(s,O);return o!==O&&!!e.call(r,o,s,t)},i.get=function(s,o){var a=t.get(s,O);return a!==O&&e.call(r,a,s,t)?a:o}),i.__iterateUncached=function(s,o){var a=this,u=0;return t.__iterate(function(f,p,c){if(e.call(r,f,p,c))return u++,s(f,n?p:u-1,a)},o),u},i.__iteratorUncached=function(s,o){var a=t.__iterator(ot,o),u=0;return new E(function(){for(;;){var f=a.next();if(f.done)return f;var p=f.value,c=p[0],l=p[1];if(e.call(r,l,c,t))return j(s,n?c:u++,l,f)}})},i}function jo(t,e,r){var n=Xt().asMutable();return t.__iterate(function(i,s){n.update(e.call(r,i,s,t),0,function(o){return o+1})}),n.asImmutable()}function qo(t,e,r){var n=N(t),i=(ft(t)?St():Xt()).asMutable();t.__iterate(function(o,a){i.update(e.call(r,o,a,t),function(u){return u=u||[],u.push(n?[a,o]:o),u})});var s=Xn(t);return i.map(function(o){return C(t,s(o))}).asImmutable()}function dr(t,e,r,n){var i=t.size;if(pe(e,r,i))return t;var s=Bt(e,i),o=_e(r,i);if(s!==s||o!==o)return dr(t.toSeq().cacheResult(),e,r,n);var a=o-s,u;a===a&&(u=a<0?0:a);var f=dt(t);return f.size=u===0?u:t.size&&u||void 0,!n&&ur(t)&&u>=0&&(f.get=function(p,c){return p=Ot(this,p),p>=0&&p<u?t.get(p+s,c):c}),f.__iterateUncached=function(p,c){var l=this;if(u===0)return 0;if(c)return this.cacheResult().__iterate(p,c);var h=0,_=!0,d=0;return t.__iterate(function(v,S){if(!(_&&(_=h++<s)))return d++,p(v,n?S:d-1,l)!==!1&&d!==u}),d},f.__iteratorUncached=function(p,c){if(u!==0&&c)return this.cacheResult().__iterator(p,c);if(u===0)return new E(K);var l=t.__iterator(p,c),h=0,_=0;return new E(function(){for(;h++<s;)l.next();if(++_>u)return K();var d=l.next();return n||p===ct||d.done?d:p===le?j(p,_-1,void 0,d):j(p,_-1,d.value[1],d)})},f}function No(t,e,r){var n=dt(t);return n.__iterateUncached=function(i,s){var o=this;if(s)return this.cacheResult().__iterate(i,s);var a=0;return t.__iterate(function(u,f,p){return e.call(r,u,f,p)&&++a&&i(u,f,o)}),a},n.__iteratorUncached=function(i,s){var o=this;if(s)return this.cacheResult().__iterator(i,s);var a=t.__iterator(ot,s),u=!0;return new E(function(){if(!u)return K();var f=a.next();if(f.done)return f;var p=f.value,c=p[0],l=p[1];return e.call(r,l,c,o)?i===ot?f:j(i,c,l,f):(u=!1,K())})},n}function Gn(t,e,r,n){var i=dt(t);return i.__iterateUncached=function(s,o){var a=this;if(o)return this.cacheResult().__iterate(s,o);var u=!0,f=0;return t.__iterate(function(p,c,l){if(!(u&&(u=e.call(r,p,c,l))))return f++,s(p,n?c:f-1,a)}),f},i.__iteratorUncached=function(s,o){var a=this;if(o)return this.cacheResult().__iterator(s,o);var u=t.__iterator(ot,o),f=!0,p=0;return new E(function(){var c,l,h;do{if(c=u.next(),c.done)return n||s===ct?c:s===le?j(s,p++,void 0,c):j(s,p++,c.value[1],c);var _=c.value;l=_[0],h=_[1],f&&(f=e.call(r,h,l,a))}while(f);return s===ot?c:j(s,l,h,c)})},i}function Do(t,e){var r=N(t),n=[t].concat(e).map(function(o){return X(o)?r&&(o=st(o)):o=r?hr(o):$n(Array.isArray(o)?o:[o]),o}).filter(function(o){return o.size!==0});if(n.length===0)return t;if(n.length===1){var i=n[0];if(i===t||r&&N(i)||V(t)&&V(i))return i}var s=new At(n);return r?s=s.toKeyedSeq():V(t)||(s=s.toSetSeq()),s=s.flatten(!0),s.size=n.reduce(function(o,a){if(o!==void 0){var u=a.size;if(u!==void 0)return o+u}},0),s}function Vn(t,e,r){var n=dt(t);return n.__iterateUncached=function(i,s){if(s)return this.cacheResult().__iterate(i,s);var o=0,a=!1;function u(f,p){f.__iterate(function(c,l){return(!e||p<e)&&X(c)?u(c,p+1):(o++,i(c,r?l:o-1,n)===!1&&(a=!0)),!a},s)}return u(t,0),o},n.__iteratorUncached=function(i,s){if(s)return this.cacheResult().__iterator(i,s);var o=t.__iterator(i,s),a=[],u=0;return new E(function(){for(;o;){var f=o.next();if(f.done!==!1){o=a.pop();continue}var p=f.value;if(i===ot&&(p=p[1]),(!e||a.length<e)&&X(p))a.push(o),o=p.__iterator(i,s);else return r?f:j(i,u++,p,f)}return K()})},n}function Lo(t,e,r){var n=Xn(t);return t.toSeq().map(function(i,s){return n(e.call(r,i,s,t))}).flatten(!0)}function Uo(t,e){var r=dt(t);return r.size=t.size&&t.size*2-1,r.__iterateUncached=function(n,i){var s=this,o=0;return t.__iterate(function(a){return(!o||n(e,o++,s)!==!1)&&n(a,o++,s)!==!1},i),o},r.__iteratorUncached=function(n,i){var s=t.__iterator(ct,i),o=0,a;return new E(function(){return(!a||o%2)&&(a=s.next(),a.done)?a:o%2?j(n,o++,e):j(n,o++,a.value,a)})},r}function Ut(t,e,r){e||(e=Zn);var n=N(t),i=0,s=t.toSeq().map(function(o,a){return[a,o,i++,r?r(o,a,t):o]}).valueSeq().toArray();return s.sort(function(o,a){return e(o[3],a[3])||o[2]-a[2]}).forEach(n?function(o,a){s[a].length=2}:function(o,a){s[a]=o[1]}),n?Et(s):V(t)?at(s):Gt(s)}function be(t,e,r){if(e||(e=Zn),r){var n=t.toSeq().map(function(i,s){return[i,r(i,s,t)]}).reduce(function(i,s){return fn(e,i[1],s[1])?s:i});return n&&n[0]}return t.reduce(function(i,s){return fn(e,i,s)?s:i})}function fn(t,e,r){var n=t(r,e);return n===0&&r!==e&&(r==null||r!==r)||n>0}function Oe(t,e,r,n){var i=dt(t),s=new At(r).map(function(o){return o.size});return i.size=n?s.max():s.min(),i.__iterate=function(o,a){for(var u=this.__iterator(ct,a),f,p=0;!(f=u.next()).done&&o(f.value,p++,this)!==!1;);return p},i.__iteratorUncached=function(o,a){var u=r.map(function(c){return c=D(c),tr(a?c.reverse():c)}),f=0,p=!1;return new E(function(){var c;return p||(c=u.map(function(l){return l.next()}),p=n?c.every(function(l){return l.done}):c.some(function(l){return l.done})),p?K():j(o,f++,e.apply(null,c.map(function(l){return l.value})))})},i}function C(t,e){return t===e?t:ur(t)?e:t.constructor(e)}function cn(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function Xn(t){return N(t)?st:V(t)?Rt:Ht}function dt(t){return Object.create((N(t)?Et:V(t)?at:Gt).prototype)}function vr(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):x.prototype.cacheResult.call(this)}function Zn(t,e){return t===void 0&&e===void 0?0:t===void 0?1:e===void 0?-1:t>e?1:t<e?-1:0}function _t(t,e){e=e||0;for(var r=Math.max(0,t.length-e),n=new Array(r),i=0;i<r;i++)n[i]=t[i+e];return n}function gr(t,e){if(!t)throw new Error(e)}function it(t){gr(t!==1/0,"Cannot perform this action with an infinite size.")}function Qn(t){if(Un(t)&&typeof t!="string")return t;if(ft(t))return t.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+t)}var $o=Object.prototype.toString;function Po(t){if(!t||typeof t!="object"||$o.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var r=e,n=Object.getPrototypeOf(e);n!==null;)r=n,n=Object.getPrototypeOf(r);return r===e}function It(t){return typeof t=="object"&&(lt(t)||Array.isArray(t)||Po(t))}function oe(t){try{return typeof t=="string"?JSON.stringify(t):String(t)}catch{return JSON.stringify(t)}}function ko(t,e){return lt(t)?t.has(e):It(t)&&Yt.call(t,e)}function xn(t,e,r){return lt(t)?t.get(e,r):ko(t,e)?typeof t.get=="function"?t.get(e):t[e]:r}function Ce(t){if(Array.isArray(t))return _t(t);var e={};for(var r in t)Yt.call(t,r)&&(e[r]=t[r]);return e}function Fo(t,e){if(!It(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(lt(t)){if(!t.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+t);return t.remove(e)}if(!Yt.call(t,e))return t;var r=Ce(t);return Array.isArray(r)?r.splice(e,1):delete r[e],r}function Wo(t,e,r){if(!It(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(lt(t)){if(!t.set)throw new TypeError("Cannot update immutable value without .set() method: "+t);return t.set(e,r)}if(Yt.call(t,e)&&r===t[e])return t;var n=Ce(t);return n[e]=r,n}function Vt(t,e,r,n){n||(n=r,r=void 0);var i=ti(lt(t),t,Qn(e),0,r,n);return i===O?r:i}function ti(t,e,r,n,i,s){var o=e===O;if(n===r.length){var a=o?i:e,u=s(a);return u===a?e:u}if(!o&&!It(e))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,n).map(oe)+"]: "+e);var f=r[n],p=o?O:xn(e,f,O),c=ti(p===O?t:lt(p),p,r,n+1,i,s);return c===p?e:c===O?Fo(e,f):Wo(o?t?ut():{}:e,f,c)}function Bo(t,e,r){return Vt(t,e,O,function(){return r})}function yr(t,e){return Bo(this,t,e)}function Ho(t,e){return Vt(t,e,function(){return O})}function mr(t){return Ho(this,t)}function ei(t,e,r,n){return Vt(t,[e],r,n)}function Sr(t,e,r){return arguments.length===1?t(this):ei(this,t,e,r)}function wr(t,e,r){return Vt(this,t,e,r)}function ri(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return ii(this,t)}function ni(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];if(typeof t!="function")throw new TypeError("Invalid merger function: "+t);return ii(this,e,t)}function ii(t,e,r){for(var n=[],i=0;i<e.length;i++){var s=st(e[i]);s.size!==0&&n.push(s)}return n.length===0?t:t.toSeq().size===0&&!t.__ownerID&&n.length===1?t.constructor(n[0]):t.withMutations(function(o){for(var a=r?function(f,p){ei(o,p,O,function(c){return c===O?f:r(c,f,p)})}:function(f,p){o.set(p,f)},u=0;u<n.length;u++)n[u].forEach(a)})}function br(t,e,r){return Or(t,e,Jo(r))}function Or(t,e,r){if(!It(t))throw new TypeError("Cannot merge into non-data-structure value: "+t);if(lt(t))return typeof r=="function"&&t.mergeWith?t.mergeWith.apply(t,[r].concat(e)):t.merge?t.merge.apply(t,e):t.concat.apply(t,e);for(var n=Array.isArray(t),i=t,s=n?Rt:st,o=n?function(u){i===t&&(i=Ce(i)),i.push(u)}:function(u,f){var p=Yt.call(i,f),c=p&&r?r(i[f],u,f):u;(!p||c!==i[f])&&(i===t&&(i=Ce(i)),i[f]=c)},a=0;a<e.length;a++)s(e[a]).forEach(o);return i}function Jo(t){function e(r,n,i){return It(r)&&It(n)&&Ko(r,n)?Or(r,[n],e):t?t(r,n,i):n}return e}function Ko(t,e){var r=x(t),n=x(e);return V(r)===V(n)&&N(r)===N(n)}function oi(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return br(this,t)}function si(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return br(this,e,t)}function Ir(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Vt(this,t,ut(),function(n){return Or(n,e)})}function Er(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Vt(this,t,ut(),function(n){return br(n,e)})}function de(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this}function ve(){return this.__ownerID?this:this.__ensureOwner(new ar)}function ge(){return this.__ensureOwner()}function zr(){return this.__altered}var Xt=function(t){function e(r){return r==null?ut():_r(r)&&!ft(r)?r:ut().withMutations(function(n){var i=t(r);it(i.size),i.forEach(function(s,o){return n.set(o,s)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return ut().withMutations(function(s){for(var o=0;o<n.length;o+=2){if(o+1>=n.length)throw new Error("Missing value for key: "+n[o]);s.set(n[o],n[o+1])}})},e.prototype.toString=function(){return this.__toString("Map {","}")},e.prototype.get=function(n,i){return this._root?this._root.get(0,void 0,n,i):i},e.prototype.set=function(n,i){return _n(this,n,i)},e.prototype.remove=function(n){return _n(this,n,O)},e.prototype.deleteAll=function(n){var i=D(n);return i.size===0?this:this.withMutations(function(s){i.forEach(function(o){return s.remove(o)})})},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):ut()},e.prototype.sort=function(n){return St(Ut(this,n))},e.prototype.sortBy=function(n,i){return St(Ut(this,i,n))},e.prototype.map=function(n,i){var s=this;return this.withMutations(function(o){o.forEach(function(a,u){o.set(u,n.call(i,a,u,s))})})},e.prototype.__iterator=function(n,i){return new Yo(this,n,i)},e.prototype.__iterate=function(n,i){var s=this,o=0;return this._root&&this._root.iterate(function(a){return o++,n(a[1],a[0],s)},i),o},e.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Mr(this.size,this._root,n,this.__hash):this.size===0?ut():(this.__ownerID=n,this.__altered=!1,this)},e}(st);Xt.isMap=_r;var q=Xt.prototype;q[Pn]=!0;q[he]=q.remove;q.removeAll=q.deleteAll;q.setIn=yr;q.removeIn=q.deleteIn=mr;q.update=Sr;q.updateIn=wr;q.merge=q.concat=ri;q.mergeWith=ni;q.mergeDeep=oi;q.mergeDeepWith=si;q.mergeIn=Ir;q.mergeDeepIn=Er;q.withMutations=de;q.wasAltered=zr;q.asImmutable=ge;q["@@transducer/init"]=q.asMutable=ve;q["@@transducer/step"]=function(t,e){return t.set(e[0],e[1])};q["@@transducer/result"]=function(t){return t.asImmutable()};var se=function(e,r){this.ownerID=e,this.entries=r};se.prototype.get=function(e,r,n,i){for(var s=this.entries,o=0,a=s.length;o<a;o++)if(P(n,s[o][0]))return s[o][1];return i};se.prototype.update=function(e,r,n,i,s,o,a){for(var u=s===O,f=this.entries,p=0,c=f.length;p<c&&!P(i,f[p][0]);p++);var l=p<c;if(l?f[p][1]===s:u)return this;if(nt(a),(u||!l)&&nt(o),!(u&&f.length===1)){if(!l&&!u&&f.length>=xo)return Go(e,f,i,s);var h=e&&e===this.ownerID,_=h?f:_t(f);return l?u?p===c-1?_.pop():_[p]=_.pop():_[p]=[i,s]:_.push([i,s]),h?(this.entries=_,this):new se(e,_)}};var $t=function(e,r,n){this.ownerID=e,this.bitmap=r,this.nodes=n};$t.prototype.get=function(e,r,n,i){r===void 0&&(r=Q(n));var s=1<<((e===0?r:r>>>e)&J),o=this.bitmap;return(o&s)===0?i:this.nodes[ai(o&s-1)].get(e+R,r,n,i)};$t.prototype.update=function(e,r,n,i,s,o,a){n===void 0&&(n=Q(i));var u=(r===0?n:n>>>r)&J,f=1<<u,p=this.bitmap,c=(p&f)!==0;if(!c&&s===O)return this;var l=ai(p&f-1),h=this.nodes,_=c?h[l]:void 0,d=Cr(_,e,r+R,n,i,s,o,a);if(d===_)return this;if(!c&&d&&h.length>=ts)return Xo(e,h,p,u,d);if(c&&!d&&h.length===2&&ln(h[l^1]))return h[l^1];if(c&&d&&h.length===1&&ln(d))return d;var v=e&&e===this.ownerID,S=c?d?p:p^f:p|f,b=c?d?ui(h,l,d,v):Qo(h,l,v):Zo(h,l,d,v);return v?(this.bitmap=S,this.nodes=b,this):new $t(e,S,b)};var ae=function(e,r,n){this.ownerID=e,this.count=r,this.nodes=n};ae.prototype.get=function(e,r,n,i){r===void 0&&(r=Q(n));var s=(e===0?r:r>>>e)&J,o=this.nodes[s];return o?o.get(e+R,r,n,i):i};ae.prototype.update=function(e,r,n,i,s,o,a){n===void 0&&(n=Q(i));var u=(r===0?n:n>>>r)&J,f=s===O,p=this.nodes,c=p[u];if(f&&!c)return this;var l=Cr(c,e,r+R,n,i,s,o,a);if(l===c)return this;var h=this.count;if(!c)h++;else if(!l&&(h--,h<es))return Vo(e,p,h,u);var _=e&&e===this.ownerID,d=ui(p,u,l,_);return _?(this.count=h,this.nodes=d,this):new ae(e,h,d)};var Pt=function(e,r,n){this.ownerID=e,this.keyHash=r,this.entries=n};Pt.prototype.get=function(e,r,n,i){for(var s=this.entries,o=0,a=s.length;o<a;o++)if(P(n,s[o][0]))return s[o][1];return i};Pt.prototype.update=function(e,r,n,i,s,o,a){n===void 0&&(n=Q(i));var u=s===O;if(n!==this.keyHash)return u?this:(nt(a),nt(o),Tr(this,e,r,n,[i,s]));for(var f=this.entries,p=0,c=f.length;p<c&&!P(i,f[p][0]);p++);var l=p<c;if(l?f[p][1]===s:u)return this;if(nt(a),(u||!l)&&nt(o),u&&c===2)return new mt(e,this.keyHash,f[p^1]);var h=e&&e===this.ownerID,_=h?f:_t(f);return l?u?p===c-1?_.pop():_[p]=_.pop():_[p]=[i,s]:_.push([i,s]),h?(this.entries=_,this):new Pt(e,this.keyHash,_)};var mt=function(e,r,n){this.ownerID=e,this.keyHash=r,this.entry=n};mt.prototype.get=function(e,r,n,i){return P(n,this.entry[0])?this.entry[1]:i};mt.prototype.update=function(e,r,n,i,s,o,a){var u=s===O,f=P(i,this.entry[0]);if(f?s===this.entry[1]:u)return this;if(nt(a),u){nt(o);return}return f?e&&e===this.ownerID?(this.entry[1]=s,this):new mt(e,this.keyHash,[i,s]):(nt(o),Tr(this,e,r,Q(i),[i,s]))};se.prototype.iterate=Pt.prototype.iterate=function(t,e){for(var r=this.entries,n=0,i=r.length-1;n<=i;n++)if(t(r[e?i-n:n])===!1)return!1};$t.prototype.iterate=ae.prototype.iterate=function(t,e){for(var r=this.nodes,n=0,i=r.length-1;n<=i;n++){var s=r[e?i-n:n];if(s&&s.iterate(t,e)===!1)return!1}};mt.prototype.iterate=function(t,e){return t(this.entry)};var Yo=function(t){function e(r,n,i){this._type=n,this._reverse=i,this._stack=r._root&&hn(r._root)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){for(var n=this._type,i=this._stack;i;){var s=i.node,o=i.index++,a=void 0;if(s.entry){if(o===0)return Ve(n,s.entry)}else if(s.entries){if(a=s.entries.length-1,o<=a)return Ve(n,s.entries[this._reverse?a-o:o])}else if(a=s.nodes.length-1,o<=a){var u=s.nodes[this._reverse?a-o:o];if(u){if(u.entry)return Ve(n,u.entry);i=this._stack=hn(u,i)}continue}i=this._stack=this._stack.__prev}return K()},e}(E);function Ve(t,e){return j(t,e[0],e[1])}function hn(t,e){return{node:t,index:0,__prev:e}}function Mr(t,e,r,n){var i=Object.create(q);return i.size=t,i._root=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var pn;function ut(){return pn||(pn=Mr(0))}function _n(t,e,r){var n,i;if(t._root){var s=Qe(),o=Qe();if(n=Cr(t._root,t.__ownerID,0,void 0,e,r,s,o),!o.value)return t;i=t.size+(s.value?r===O?-1:1:0)}else{if(r===O)return t;i=1,n=new se(t.__ownerID,[[e,r]])}return t.__ownerID?(t.size=i,t._root=n,t.__hash=void 0,t.__altered=!0,t):n?Mr(i,n):ut()}function Cr(t,e,r,n,i,s,o,a){return t?t.update(e,r,n,i,s,o,a):s===O?t:(nt(a),nt(o),new mt(e,n,[i,s]))}function ln(t){return t.constructor===mt||t.constructor===Pt}function Tr(t,e,r,n,i){if(t.keyHash===n)return new Pt(e,n,[t.entry,i]);var s=(r===0?t.keyHash:t.keyHash>>>r)&J,o=(r===0?n:n>>>r)&J,a,u=s===o?[Tr(t,e,r+R,n,i)]:(a=new mt(e,n,i),s<o?[t,a]:[a,t]);return new $t(e,1<<s|1<<o,u)}function Go(t,e,r,n){t||(t=new ar);for(var i=new mt(t,Q(r),[r,n]),s=0;s<e.length;s++){var o=e[s];i=i.update(t,0,void 0,o[0],o[1])}return i}function Vo(t,e,r,n){for(var i=0,s=0,o=new Array(r),a=0,u=1,f=e.length;a<f;a++,u<<=1){var p=e[a];p!==void 0&&a!==n&&(i|=u,o[s++]=p)}return new $t(t,i,o)}function Xo(t,e,r,n,i){for(var s=0,o=new Array(rt),a=0;r!==0;a++,r>>>=1)o[a]=r&1?e[s++]:void 0;return o[n]=i,new ae(t,s+1,o)}function ai(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),t=t+(t>>4)&252645135,t+=t>>8,t+=t>>16,t&127}function ui(t,e,r,n){var i=n?t:_t(t);return i[e]=r,i}function Zo(t,e,r,n){var i=t.length+1;if(n&&e+1===i)return t[e]=r,t;for(var s=new Array(i),o=0,a=0;a<i;a++)a===e?(s[a]=r,o=-1):s[a]=t[a+o];return s}function Qo(t,e,r){var n=t.length-1;if(r&&e===n)return t.pop(),t;for(var i=new Array(n),s=0,o=0;o<n;o++)o===e&&(s=1),i[o]=t[o+s];return i}var xo=rt/4,ts=rt/2,es=rt/4,fi="@@__IMMUTABLE_LIST__@@";function ci(t){return Boolean(t&&t[fi])}var De=function(t){function e(r){var n=Me();if(r==null)return n;if(ci(r))return r;var i=t(r),s=i.size;return s===0?n:(it(s),s>0&&s<rt?ue(0,s,R,null,new bt(i.toArray())):n.withMutations(function(o){o.setSize(s),i.forEach(function(a,u){return o.set(u,a)})}))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("List [","]")},e.prototype.get=function(n,i){if(n=Ot(this,n),n>=0&&n<this.size){n+=this._origin;var s=hi(this,n);return s&&s.array[n&J]}return i},e.prototype.set=function(n,i){return rs(this,n,i)},e.prototype.remove=function(n){return this.has(n)?n===0?this.shift():n===this.size-1?this.pop():this.splice(n,1):this},e.prototype.insert=function(n,i){return this.splice(n,0,i)},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=R,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):Me()},e.prototype.push=function(){var n=arguments,i=this.size;return this.withMutations(function(s){wt(s,0,i+n.length);for(var o=0;o<n.length;o++)s.set(i+o,n[o])})},e.prototype.pop=function(){return wt(this,0,-1)},e.prototype.unshift=function(){var n=arguments;return this.withMutations(function(i){wt(i,-n.length);for(var s=0;s<n.length;s++)i.set(s,n[s])})},e.prototype.shift=function(){return wt(this,1)},e.prototype.concat=function(){for(var n=arguments,i=[],s=0;s<arguments.length;s++){var o=n[s],a=t(typeof o!="string"&&Ln(o)?o:[o]);a.size!==0&&i.push(a)}return i.length===0?this:this.size===0&&!this.__ownerID&&i.length===1?this.constructor(i[0]):this.withMutations(function(u){i.forEach(function(f){return f.forEach(function(p){return u.push(p)})})})},e.prototype.setSize=function(n){return wt(this,0,n)},e.prototype.map=function(n,i){var s=this;return this.withMutations(function(o){for(var a=0;a<s.size;a++)o.set(a,n.call(i,o.get(a),a,s))})},e.prototype.slice=function(n,i){var s=this.size;return pe(n,i,s)?this:wt(this,Bt(n,s),_e(i,s))},e.prototype.__iterator=function(n,i){var s=i?this.size:0,o=dn(this,i);return new E(function(){var a=o();return a===ie?K():j(n,i?--s:s++,a)})},e.prototype.__iterate=function(n,i){for(var s=i?this.size:0,o=dn(this,i),a;(a=o())!==ie&&n(a,i?--s:s++,this)!==!1;);return s},e.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?ue(this._origin,this._capacity,this._level,this._root,this._tail,n,this.__hash):this.size===0?Me():(this.__ownerID=n,this.__altered=!1,this)},e}(Rt);De.isList=ci;var $=De.prototype;$[fi]=!0;$[he]=$.remove;$.merge=$.concat;$.setIn=yr;$.deleteIn=$.removeIn=mr;$.update=Sr;$.updateIn=wr;$.mergeIn=Ir;$.mergeDeepIn=Er;$.withMutations=de;$.wasAltered=zr;$.asImmutable=ge;$["@@transducer/init"]=$.asMutable=ve;$["@@transducer/step"]=function(t,e){return t.push(e)};$["@@transducer/result"]=function(t){return t.asImmutable()};var bt=function(e,r){this.array=e,this.ownerID=r};bt.prototype.removeBefore=function(e,r,n){if(n===r?1<<r:this.array.length===0)return this;var i=n>>>r&J;if(i>=this.array.length)return new bt([],e);var s=i===0,o;if(r>0){var a=this.array[i];if(o=a&&a.removeBefore(e,r-R,n),o===a&&s)return this}if(s&&!o)return this;var u=kt(this,e);if(!s)for(var f=0;f<i;f++)u.array[f]=void 0;return o&&(u.array[i]=o),u};bt.prototype.removeAfter=function(e,r,n){if(n===(r?1<<r:0)||this.array.length===0)return this;var i=n-1>>>r&J;if(i>=this.array.length)return this;var s;if(r>0){var o=this.array[i];if(s=o&&o.removeAfter(e,r-R,n),s===o&&i===this.array.length-1)return this}var a=kt(this,e);return a.array.splice(i+1),s&&(a.array[i]=s),a};var ie={};function dn(t,e){var r=t._origin,n=t._capacity,i=fe(n),s=t._tail;return o(t._root,t._level,0);function o(f,p,c){return p===0?a(f,c):u(f,p,c)}function a(f,p){var c=p===i?s&&s.array:f&&f.array,l=p>r?0:r-p,h=n-p;return h>rt&&(h=rt),function(){if(l===h)return ie;var _=e?--h:l++;return c&&c[_]}}function u(f,p,c){var l,h=f&&f.array,_=c>r?0:r-c>>p,d=(n-c>>p)+1;return d>rt&&(d=rt),function(){for(;;){if(l){var v=l();if(v!==ie)return v;l=null}if(_===d)return ie;var S=e?--d:_++;l=o(h&&h[S],p-R,c+(S<<p))}}}}function ue(t,e,r,n,i,s,o){var a=Object.create($);return a.size=e-t,a._origin=t,a._capacity=e,a._level=r,a._root=n,a._tail=i,a.__ownerID=s,a.__hash=o,a.__altered=!1,a}var vn;function Me(){return vn||(vn=ue(0,0,R))}function rs(t,e,r){if(e=Ot(t,e),e!==e)return t;if(e>=t.size||e<0)return t.withMutations(function(o){e<0?wt(o,e).set(0,r):wt(o,0,e+1).set(e,r)});e+=t._origin;var n=t._tail,i=t._root,s=Qe();return e>=fe(t._capacity)?n=ir(n,t.__ownerID,0,e,r,s):i=ir(i,t.__ownerID,t._level,e,r,s),s.value?t.__ownerID?(t._root=i,t._tail=n,t.__hash=void 0,t.__altered=!0,t):ue(t._origin,t._capacity,t._level,i,n):t}function ir(t,e,r,n,i,s){var o=n>>>r&J,a=t&&o<t.array.length;if(!a&&i===void 0)return t;var u;if(r>0){var f=t&&t.array[o],p=ir(f,e,r-R,n,i,s);return p===f?t:(u=kt(t,e),u.array[o]=p,u)}return a&&t.array[o]===i?t:(s&&nt(s),u=kt(t,e),i===void 0&&o===u.array.length-1?u.array.pop():u.array[o]=i,u)}function kt(t,e){return e&&t&&e===t.ownerID?t:new bt(t?t.array.slice():[],e)}function hi(t,e){if(e>=fe(t._capacity))return t._tail;if(e<1<<t._level+R){for(var r=t._root,n=t._level;r&&n>0;)r=r.array[e>>>n&J],n-=R;return r}}function wt(t,e,r){e!==void 0&&(e|=0),r!==void 0&&(r|=0);var n=t.__ownerID||new ar,i=t._origin,s=t._capacity,o=i+e,a=r===void 0?s:r<0?s+r:i+r;if(o===i&&a===s)return t;if(o>=a)return t.clear();for(var u=t._level,f=t._root,p=0;o+p<0;)f=new bt(f&&f.array.length?[void 0,f]:[],n),u+=R,p+=1<<u;p&&(o+=p,i+=p,a+=p,s+=p);for(var c=fe(s),l=fe(a);l>=1<<u+R;)f=new bt(f&&f.array.length?[f]:[],n),u+=R;var h=t._tail,_=l<c?hi(t,a-1):l>c?new bt([],n):h;if(h&&l>c&&o<s&&h.array.length){f=kt(f,n);for(var d=f,v=u;v>R;v-=R){var S=c>>>v&J;d=d.array[S]=kt(d.array[S],n)}d.array[c>>>R&J]=h}if(a<s&&(_=_&&_.removeAfter(n,0,a)),o>=l)o-=l,a-=l,u=R,f=null,_=_&&_.removeBefore(n,0,o);else if(o>i||l<c){for(p=0;f;){var b=o>>>u&J;if(b!==l>>>u&J)break;b&&(p+=(1<<u)*b),u-=R,f=f.array[b]}f&&o>i&&(f=f.removeBefore(n,u,o-p)),f&&l<c&&(f=f.removeAfter(n,u,l-p)),p&&(o-=p,a-=p)}return t.__ownerID?(t.size=a-o,t._origin=o,t._capacity=a,t._level=u,t._root=f,t._tail=_,t.__hash=void 0,t.__altered=!0,t):ue(o,a,u,f,_)}function fe(t){return t<rt?0:t-1>>>R<<R}var St=function(t){function e(r){return r==null?ee():kn(r)?r:ee().withMutations(function(n){var i=st(r);it(i.size),i.forEach(function(s,o){return n.set(o,s)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("OrderedMap {","}")},e.prototype.get=function(n,i){var s=this._map.get(n);return s!==void 0?this._list.get(s)[1]:i},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):ee()},e.prototype.set=function(n,i){return yn(this,n,i)},e.prototype.remove=function(n){return yn(this,n,O)},e.prototype.__iterate=function(n,i){var s=this;return this._list.__iterate(function(o){return o&&n(o[1],o[0],s)},i)},e.prototype.__iterator=function(n,i){return this._list.fromEntrySeq().__iterator(n,i)},e.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n),s=this._list.__ensureOwner(n);return n?Ar(i,s,n,this.__hash):this.size===0?ee():(this.__ownerID=n,this.__altered=!1,this._map=i,this._list=s,this)},e}(Xt);St.isOrderedMap=kn;St.prototype[Kt]=!0;St.prototype[he]=St.prototype.remove;function Ar(t,e,r,n){var i=Object.create(St.prototype);return i.size=t?t.size:0,i._map=t,i._list=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var gn;function ee(){return gn||(gn=Ar(ut(),Me()))}function yn(t,e,r){var n=t._map,i=t._list,s=n.get(e),o=s!==void 0,a,u;if(r===O){if(!o)return t;i.size>=rt&&i.size>=n.size*2?(u=i.filter(function(f,p){return f!==void 0&&s!==p}),a=u.toKeyedSeq().map(function(f){return f[0]}).flip().toMap(),t.__ownerID&&(a.__ownerID=u.__ownerID=t.__ownerID)):(a=n.remove(e),u=s===i.size-1?i.pop():i.set(s,void 0))}else if(o){if(r===i.get(s)[1])return t;a=n,u=i.set(s,[e,r])}else a=n.set(e,i.size),u=i.set(i.size,[e,r]);return t.__ownerID?(t.size=a.size,t._map=a,t._list=u,t.__hash=void 0,t.__altered=!0,t):Ar(a,u)}var pi="@@__IMMUTABLE_STACK__@@";function or(t){return Boolean(t&&t[pi])}var Rr=function(t){function e(r){return r==null?Ie():or(r)?r:Ie().pushAll(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("Stack [","]")},e.prototype.get=function(n,i){var s=this._head;for(n=Ot(this,n);s&&n--;)s=s.next;return s?s.value:i},e.prototype.peek=function(){return this._head&&this._head.value},e.prototype.push=function(){var n=arguments;if(arguments.length===0)return this;for(var i=this.size+arguments.length,s=this._head,o=arguments.length-1;o>=0;o--)s={value:n[o],next:s};return this.__ownerID?(this.size=i,this._head=s,this.__hash=void 0,this.__altered=!0,this):re(i,s)},e.prototype.pushAll=function(n){if(n=t(n),n.size===0)return this;if(this.size===0&&or(n))return n;it(n.size);var i=this.size,s=this._head;return n.__iterate(function(o){i++,s={value:o,next:s}},!0),this.__ownerID?(this.size=i,this._head=s,this.__hash=void 0,this.__altered=!0,this):re(i,s)},e.prototype.pop=function(){return this.slice(1)},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Ie()},e.prototype.slice=function(n,i){if(pe(n,i,this.size))return this;var s=Bt(n,this.size),o=_e(i,this.size);if(o!==this.size)return t.prototype.slice.call(this,n,i);for(var a=this.size-s,u=this._head;s--;)u=u.next;return this.__ownerID?(this.size=a,this._head=u,this.__hash=void 0,this.__altered=!0,this):re(a,u)},e.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?re(this.size,this._head,n,this.__hash):this.size===0?Ie():(this.__ownerID=n,this.__altered=!1,this)},e.prototype.__iterate=function(n,i){var s=this;if(i)return new At(this.toArray()).__iterate(function(u,f){return n(u,f,s)},i);for(var o=0,a=this._head;a&&n(a.value,o++,this)!==!1;)a=a.next;return o},e.prototype.__iterator=function(n,i){if(i)return new At(this.toArray()).__iterator(n,i);var s=0,o=this._head;return new E(function(){if(o){var a=o.value;return o=o.next,j(n,s++,a)}return K()})},e}(Rt);Rr.isStack=or;var Y=Rr.prototype;Y[pi]=!0;Y.shift=Y.pop;Y.unshift=Y.push;Y.unshiftAll=Y.pushAll;Y.withMutations=de;Y.wasAltered=zr;Y.asImmutable=ge;Y["@@transducer/init"]=Y.asMutable=ve;Y["@@transducer/step"]=function(t,e){return t.unshift(e)};Y["@@transducer/result"]=function(t){return t.asImmutable()};function re(t,e,r,n){var i=Object.create(Y);return i.size=t,i._head=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var mn;function Ie(){return mn||(mn=re(0))}var _i="@@__IMMUTABLE_SET__@@";function jr(t){return Boolean(t&&t[_i])}function li(t){return jr(t)&&ft(t)}function qr(t,e){if(t===e)return!0;if(!X(e)||t.size!==void 0&&e.size!==void 0&&t.size!==e.size||t.__hash!==void 0&&e.__hash!==void 0&&t.__hash!==e.__hash||N(t)!==N(e)||V(t)!==V(e)||ft(t)!==ft(e))return!1;if(t.size===0&&e.size===0)return!0;var r=!Ae(t);if(ft(t)){var n=t.entries();return e.every(function(u,f){var p=n.next().value;return p&&P(p[1],u)&&(r||P(p[0],f))})&&n.next().done}var i=!1;if(t.size===void 0)if(e.size===void 0)typeof t.cacheResult=="function"&&t.cacheResult();else{i=!0;var s=t;t=e,e=s}var o=!0,a=e.__iterate(function(u,f){if(r?!t.has(u):i?!P(u,t.get(f,O)):!P(t.get(f,O),u))return o=!1,!1});return o&&t.size===a}function jt(t,e){var r=function(n){t.prototype[n]=e[n]};return Object.keys(e).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(r),t}function Te(t){if(!t||typeof t!="object")return t;if(!X(t)){if(!It(t))return t;t=x(t)}if(N(t)){var e={};return t.__iterate(function(n,i){e[i]=Te(n)}),e}var r=[];return t.__iterate(function(n){r.push(Te(n))}),r}var Le=function(t){function e(r){return r==null?ne():jr(r)&&!ft(r)?r:ne().withMutations(function(n){var i=t(r);it(i.size),i.forEach(function(s){return n.add(s)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(n){return this(st(n).keySeq())},e.intersect=function(n){return n=D(n).toArray(),n.length?k.intersect.apply(e(n.pop()),n):ne()},e.union=function(n){return n=D(n).toArray(),n.length?k.union.apply(e(n.pop()),n):ne()},e.prototype.toString=function(){return this.__toString("Set {","}")},e.prototype.has=function(n){return this._map.has(n)},e.prototype.add=function(n){return Ee(this,this._map.set(n,n))},e.prototype.remove=function(n){return Ee(this,this._map.remove(n))},e.prototype.clear=function(){return Ee(this,this._map.clear())},e.prototype.map=function(n,i){var s=this,o=!1,a=Ee(this,this._map.mapEntries(function(u){var f=u[1],p=n.call(i,f,f,s);return p!==f&&(o=!0),[p,p]},i));return o?a:this},e.prototype.union=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return n=n.filter(function(s){return s.size!==0}),n.length===0?this:this.size===0&&!this.__ownerID&&n.length===1?this.constructor(n[0]):this.withMutations(function(s){for(var o=0;o<n.length;o++)t(n[o]).forEach(function(a){return s.add(a)})})},e.prototype.intersect=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(o){return t(o)});var s=[];return this.forEach(function(o){n.every(function(a){return a.includes(o)})||s.push(o)}),this.withMutations(function(o){s.forEach(function(a){o.remove(a)})})},e.prototype.subtract=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(o){return t(o)});var s=[];return this.forEach(function(o){n.some(function(a){return a.includes(o)})&&s.push(o)}),this.withMutations(function(o){s.forEach(function(a){o.remove(a)})})},e.prototype.sort=function(n){return ce(Ut(this,n))},e.prototype.sortBy=function(n,i){return ce(Ut(this,i,n))},e.prototype.wasAltered=function(){return this._map.wasAltered()},e.prototype.__iterate=function(n,i){var s=this;return this._map.__iterate(function(o){return n(o,o,s)},i)},e.prototype.__iterator=function(n,i){return this._map.__iterator(n,i)},e.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n);return n?this.__make(i,n):this.size===0?this.__empty():(this.__ownerID=n,this._map=i,this)},e}(Ht);Le.isSet=jr;var k=Le.prototype;k[_i]=!0;k[he]=k.remove;k.merge=k.concat=k.union;k.withMutations=de;k.asImmutable=ge;k["@@transducer/init"]=k.asMutable=ve;k["@@transducer/step"]=function(t,e){return t.add(e)};k["@@transducer/result"]=function(t){return t.asImmutable()};k.__empty=ne;k.__make=di;function Ee(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:e.size===0?t.__empty():t.__make(e)}function di(t,e){var r=Object.create(k);return r.size=t?t.size:0,r._map=t,r.__ownerID=e,r}var Sn;function ne(){return Sn||(Sn=di(ut()))}var ns=function(t){function e(r,n,i){if(!(this instanceof e))return new e(r,n,i);if(gr(i!==0,"Cannot step a Range by 0"),r=r||0,n===void 0&&(n=1/0),i=i===void 0?1:Math.abs(i),n<r&&(i=-i),this._start=r,this._end=n,this._step=i,this.size=Math.max(0,Math.ceil((n-r)/i-1)+1),this.size===0){if(Xe)return Xe;Xe=this}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step!==1?" by "+this._step:"")+" ]"},e.prototype.get=function(n,i){return this.has(n)?this._start+Ot(this,n)*this._step:i},e.prototype.includes=function(n){var i=(n-this._start)/this._step;return i>=0&&i<this.size&&i===Math.floor(i)},e.prototype.slice=function(n,i){return pe(n,i,this.size)?this:(n=Bt(n,this.size),i=_e(i,this.size),i<=n?new e(0,0):new e(this.get(n,this._end),this.get(i,this._end),this._step))},e.prototype.indexOf=function(n){var i=n-this._start;if(i%this._step===0){var s=i/this._step;if(s>=0&&s<this.size)return s}return-1},e.prototype.lastIndexOf=function(n){return this.indexOf(n)},e.prototype.__iterate=function(n,i){for(var s=this.size,o=this._step,a=i?this._start+(s-1)*o:this._start,u=0;u!==s&&n(a,i?s-++u:u++,this)!==!1;)a+=i?-o:o;return u},e.prototype.__iterator=function(n,i){var s=this.size,o=this._step,a=i?this._start+(s-1)*o:this._start,u=0;return new E(function(){if(u===s)return K();var f=a;return a+=i?-o:o,j(n,i?s-++u:u++,f)})},e.prototype.equals=function(n){return n instanceof e?this._start===n._start&&this._end===n._end&&this._step===n._step:qr(this,n)},e}(at),Xe;function vi(t,e,r){for(var n=Qn(e),i=0;i!==n.length;)if(t=xn(t,n[i++],O),t===O)return r;return t}function gi(t,e){return vi(this,t,e)}function is(t,e){return vi(t,e,O)!==O}function os(t){return is(this,t)}function yi(){it(this.size);var t={};return this.__iterate(function(e,r){t[r]=e}),t}D.isIterable=X;D.isKeyed=N;D.isIndexed=V;D.isAssociative=Ae;D.isOrdered=ft;D.Iterator=E;jt(D,{toArray:function(){it(this.size);var e=new Array(this.size||0),r=N(this),n=0;return this.__iterate(function(i,s){e[n++]=r?[s,i]:i}),e},toIndexedSeq:function(){return new Wn(this)},toJS:function(){return Te(this)},toKeyedSeq:function(){return new Ne(this,!0)},toMap:function(){return Xt(this.toKeyedSeq())},toObject:yi,toOrderedMap:function(){return St(this.toKeyedSeq())},toOrderedSet:function(){return ce(N(this)?this.valueSeq():this)},toSet:function(){return Le(N(this)?this.valueSeq():this)},toSetSeq:function(){return new Bn(this)},toSeq:function(){return V(this)?this.toIndexedSeq():N(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Rr(N(this)?this.valueSeq():this)},toList:function(){return De(N(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(e,r){return this.size===0?e+r:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+r},concat:function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return C(this,Do(this,e))},includes:function(e){return this.some(function(r){return P(r,e)})},entries:function(){return this.__iterator(ot)},every:function(e,r){it(this.size);var n=!0;return this.__iterate(function(i,s,o){if(!e.call(r,i,s,o))return n=!1,!1}),n},filter:function(e,r){return C(this,Yn(this,e,r,!0))},find:function(e,r,n){var i=this.findEntry(e,r);return i?i[1]:n},forEach:function(e,r){return it(this.size),this.__iterate(r?e.bind(r):e)},join:function(e){it(this.size),e=e!==void 0?""+e:",";var r="",n=!0;return this.__iterate(function(i){n?n=!1:r+=e,r+=i!=null?i.toString():""}),r},keys:function(){return this.__iterator(le)},map:function(e,r){return C(this,Kn(this,e,r))},reduce:function(e,r,n){return wn(this,e,r,n,arguments.length<2,!1)},reduceRight:function(e,r,n){return wn(this,e,r,n,arguments.length<2,!0)},reverse:function(){return C(this,lr(this,!0))},slice:function(e,r){return C(this,dr(this,e,r,!0))},some:function(e,r){return!this.every(ze(e),r)},sort:function(e){return C(this,Ut(this,e))},values:function(){return this.__iterator(ct)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(e,r){return Lt(e?this.toSeq().filter(e,r):this)},countBy:function(e,r){return jo(this,e,r)},equals:function(e){return qr(this,e)},entrySeq:function(){var e=this;if(e._cache)return new At(e._cache);var r=e.toSeq().map(as).toIndexedSeq();return r.fromEntrySeq=function(){return e.toSeq()},r},filterNot:function(e,r){return this.filter(ze(e),r)},findEntry:function(e,r,n){var i=n;return this.__iterate(function(s,o,a){if(e.call(r,s,o,a))return i=[o,s],!1}),i},findKey:function(e,r){var n=this.findEntry(e,r);return n&&n[0]},findLast:function(e,r,n){return this.toKeyedSeq().reverse().find(e,r,n)},findLastEntry:function(e,r,n){return this.toKeyedSeq().reverse().findEntry(e,r,n)},findLastKey:function(e,r){return this.toKeyedSeq().reverse().findKey(e,r)},first:function(e){return this.find(Mn,null,e)},flatMap:function(e,r){return C(this,Lo(this,e,r))},flatten:function(e){return C(this,Vn(this,e,!0))},fromEntrySeq:function(){return new Hn(this)},get:function(e,r){return this.find(function(n,i){return P(i,e)},void 0,r)},getIn:gi,groupBy:function(e,r){return qo(this,e,r)},has:function(e){return this.get(e,O)!==O},hasIn:os,isSubset:function(e){return e=typeof e.includes=="function"?e:D(e),this.every(function(r){return e.includes(r)})},isSuperset:function(e){return e=typeof e.isSubset=="function"?e:D(e),e.isSubset(this)},keyOf:function(e){return this.findKey(function(r){return P(r,e)})},keySeq:function(){return this.toSeq().map(ss).toIndexedSeq()},last:function(e){return this.toSeq().reverse().first(e)},lastKeyOf:function(e){return this.toKeyedSeq().reverse().keyOf(e)},max:function(e){return be(this,e)},maxBy:function(e,r){return be(this,r,e)},min:function(e){return be(this,e?bn(e):In)},minBy:function(e,r){return be(this,r?bn(r):In,e)},rest:function(){return this.slice(1)},skip:function(e){return e===0?this:this.slice(Math.max(0,e))},skipLast:function(e){return e===0?this:this.slice(0,-Math.max(0,e))},skipWhile:function(e,r){return C(this,Gn(this,e,r,!0))},skipUntil:function(e,r){return this.skipWhile(ze(e),r)},sortBy:function(e,r){return C(this,Ut(this,r,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return this.slice(-Math.max(0,e))},takeWhile:function(e,r){return C(this,No(this,e,r))},takeUntil:function(e,r){return this.takeWhile(ze(e),r)},update:function(e){return e(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=us(this))}});var B=D.prototype;B[An]=!0;B[Re]=B.values;B.toJSON=B.toArray;B.__toStringMapper=oe;B.inspect=B.toSource=function(){return this.toString()};B.chain=B.flatMap;B.contains=B.includes;jt(st,{flip:function(){return C(this,Jn(this))},mapEntries:function(e,r){var n=this,i=0;return C(this,this.toSeq().map(function(s,o){return e.call(r,[o,s],i++,n)}).fromEntrySeq())},mapKeys:function(e,r){var n=this;return C(this,this.toSeq().flip().map(function(i,s){return e.call(r,i,s,n)}).flip())}});var ye=st.prototype;ye[Rn]=!0;ye[Re]=B.entries;ye.toJSON=yi;ye.__toStringMapper=function(t,e){return oe(e)+": "+oe(t)};jt(Rt,{toKeyedSeq:function(){return new Ne(this,!1)},filter:function(e,r){return C(this,Yn(this,e,r,!1))},findIndex:function(e,r){var n=this.findEntry(e,r);return n?n[0]:-1},indexOf:function(e){var r=this.keyOf(e);return r===void 0?-1:r},lastIndexOf:function(e){var r=this.lastKeyOf(e);return r===void 0?-1:r},reverse:function(){return C(this,lr(this,!1))},slice:function(e,r){return C(this,dr(this,e,r,!1))},splice:function(e,r){var n=arguments.length;if(r=Math.max(r||0,0),n===0||n===2&&!r)return this;e=Bt(e,e<0?this.count():this.size);var i=this.slice(0,e);return C(this,n===1?i:i.concat(_t(arguments,2),this.slice(e+r)))},findLastIndex:function(e,r){var n=this.findLastEntry(e,r);return n?n[0]:-1},first:function(e){return this.get(0,e)},flatten:function(e){return C(this,Vn(this,e,!1))},get:function(e,r){return e=Ot(this,e),e<0||this.size===1/0||this.size!==void 0&&e>this.size?r:this.find(function(n,i){return i===e},void 0,r)},has:function(e){return e=Ot(this,e),e>=0&&(this.size!==void 0?this.size===1/0||e<this.size:this.indexOf(e)!==-1)},interpose:function(e){return C(this,Uo(this,e))},interleave:function(){var e=[this].concat(_t(arguments)),r=Oe(this.toSeq(),at.of,e),n=r.flatten(!0);return r.size&&(n.size=r.size*e.length),C(this,n)},keySeq:function(){return ns(0,this.size)},last:function(e){return this.get(-1,e)},skipWhile:function(e,r){return C(this,Gn(this,e,r,!1))},zip:function(){var e=[this].concat(_t(arguments));return C(this,Oe(this,On,e))},zipAll:function(){var e=[this].concat(_t(arguments));return C(this,Oe(this,On,e,!0))},zipWith:function(e){var r=_t(arguments);return r[0]=this,C(this,Oe(this,e,r))}});var Zt=Rt.prototype;Zt[jn]=!0;Zt[Kt]=!0;jt(Ht,{get:function(e,r){return this.has(e)?e:r},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}});var Ft=Ht.prototype;Ft.has=B.includes;Ft.contains=Ft.includes;Ft.keys=Ft.values;jt(Et,ye);jt(at,Zt);jt(Gt,Ft);function wn(t,e,r,n,i,s){return it(t.size),t.__iterate(function(o,a,u){i?(i=!1,r=o):r=e.call(n,r,o,a,u)},s),r}function ss(t,e){return e}function as(t,e){return[e,t]}function ze(t){return function(){return!t.apply(this,arguments)}}function bn(t){return function(){return-t.apply(this,arguments)}}function On(){return _t(arguments)}function In(t,e){return t<e?1:t>e?-1:0}function us(t){if(t.size===1/0)return 0;var e=ft(t),r=N(t),n=e?1:0,i=t.__iterate(r?e?function(s,o){n=31*n+En(Q(s),Q(o))|0}:function(s,o){n=n+En(Q(s),Q(o))|0}:e?function(s){n=31*n+Q(s)|0}:function(s){n=n+Q(s)|0});return fs(i,n)}function fs(t,e){return e=te(e,3432918353),e=te(e<<15|e>>>-15,461845907),e=te(e<<13|e>>>-13,5),e=(e+3864292196|0)^t,e=te(e^e>>>16,2246822507),e=te(e^e>>>13,3266489909),e=qe(e^e>>>16),e}function En(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}var ce=function(t){function e(r){return r==null?sr():li(r)?r:sr().withMutations(function(n){var i=Ht(r);it(i.size),i.forEach(function(s){return n.add(s)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(n){return this(st(n).keySeq())},e.prototype.toString=function(){return this.__toString("OrderedSet {","}")},e}(Le);ce.isOrderedSet=li;var qt=ce.prototype;qt[Kt]=!0;qt.zip=Zt.zip;qt.zipWith=Zt.zipWith;qt.zipAll=Zt.zipAll;qt.__empty=sr;qt.__make=mi;function mi(t,e){var r=Object.create(qt);return r.size=t?t.size:0,r._map=t,r.__ownerID=e,r}var zn;function sr(){return zn||(zn=mi(ee()))}function cs(t){if(Jt(t))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(lt(t))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(t===null||typeof t!="object")throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}var U=function(e,r){var n;cs(e);var i=function(a){var u=this;if(a instanceof i)return a;if(!(this instanceof i))return new i(a);if(!n){n=!0;var f=Object.keys(e),p=s._indices={};s._name=r,s._keys=f,s._defaultValues=e;for(var c=0;c<f.length;c++){var l=f[c];p[l]=c,s[l]?typeof console=="object"&&console.warn&&console.warn("Cannot define "+Dr(this)+' with property "'+l+'" since that property name is part of the Record API.'):hs(s,l)}}return this.__ownerID=void 0,this._values=De().withMutations(function(h){h.setSize(u._keys.length),st(a).forEach(function(_,d){h.set(u._indices[d],_===u._defaultValues[d]?void 0:_)})}),this},s=i.prototype=Object.create(T);return s.constructor=i,r&&(i.displayName=r),i};U.prototype.toString=function(){for(var e=Dr(this)+" { ",r=this._keys,n,i=0,s=r.length;i!==s;i++)n=r[i],e+=(i?", ":"")+n+": "+oe(this.get(n));return e+" }"};U.prototype.equals=function(e){return this===e||Jt(e)&&Wt(this).equals(Wt(e))};U.prototype.hashCode=function(){return Wt(this).hashCode()};U.prototype.has=function(e){return this._indices.hasOwnProperty(e)};U.prototype.get=function(e,r){if(!this.has(e))return r;var n=this._indices[e],i=this._values.get(n);return i===void 0?this._defaultValues[e]:i};U.prototype.set=function(e,r){if(this.has(e)){var n=this._values.set(this._indices[e],r===this._defaultValues[e]?void 0:r);if(n!==this._values&&!this.__ownerID)return Nr(this,n)}return this};U.prototype.remove=function(e){return this.set(e)};U.prototype.clear=function(){var e=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:Nr(this,e)};U.prototype.wasAltered=function(){return this._values.wasAltered()};U.prototype.toSeq=function(){return Wt(this)};U.prototype.toJS=function(){return Te(this)};U.prototype.entries=function(){return this.__iterator(ot)};U.prototype.__iterator=function(e,r){return Wt(this).__iterator(e,r)};U.prototype.__iterate=function(e,r){return Wt(this).__iterate(e,r)};U.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var r=this._values.__ensureOwner(e);return e?Nr(this,r,e):(this.__ownerID=e,this._values=r,this)};U.isRecord=Jt;U.getDescriptiveName=Dr;var T=U.prototype;T[Nn]=!0;T[he]=T.remove;T.deleteIn=T.removeIn=mr;T.getIn=gi;T.hasIn=B.hasIn;T.merge=ri;T.mergeWith=ni;T.mergeIn=Ir;T.mergeDeep=oi;T.mergeDeepWith=si;T.mergeDeepIn=Er;T.setIn=yr;T.update=Sr;T.updateIn=wr;T.withMutations=de;T.asMutable=ve;T.asImmutable=ge;T[Re]=T.entries;T.toJSON=T.toObject=B.toObject;T.inspect=T.toSource=function(){return this.toString()};function Nr(t,e,r){var n=Object.create(Object.getPrototypeOf(t));return n._values=e,n.__ownerID=r,n}function Dr(t){return t.constructor.displayName||t.constructor.name||"Record"}function Wt(t){return hr(t._keys.map(function(e){return[e,t.get(e)]}))}function hs(t,e){try{Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(r){gr(this.__ownerID,"Cannot set on an immutable record."),this.set(e,r)}})}catch{}}var ya=function(t){function e(r,n){if(!(this instanceof e))return new e(r,n);if(this._value=r,this.size=n===void 0?1/0:Math.max(0,n),this.size===0){if(Ze)return Ze;Ze=this}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.size===0?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},e.prototype.get=function(n,i){return this.has(n)?this._value:i},e.prototype.includes=function(n){return P(this._value,n)},e.prototype.slice=function(n,i){var s=this.size;return pe(n,i,s)?this:new e(this._value,_e(i,s)-Bt(n,s))},e.prototype.reverse=function(){return this},e.prototype.indexOf=function(n){return P(this._value,n)?0:-1},e.prototype.lastIndexOf=function(n){return P(this._value,n)?this.size:-1},e.prototype.__iterate=function(n,i){for(var s=this.size,o=0;o!==s&&n(this._value,i?s-++o:o++,this)!==!1;);return o},e.prototype.__iterator=function(n,i){var s=this,o=this.size,a=0;return new E(function(){return a===o?K():j(n,i?o-++a:a++,s._value)})},e.prototype.equals=function(n){return n instanceof e?P(this._value,n._value):qr(n)},e}(at),Ze;m();var Ci=tn(Mi(),1);function Ti(t,e){var r=(0,Ci.default)(t,e);return r.map(i=>i[0]===1?i:[i[0],i[1].length])}function Ai(t,e){for(var r="",n=0,i=0;i<e.length;i++){var s=e[i],o=s[0],a=s[1];s[0]===-1&&typeof a=="number"?n+=a:o==0&&typeof a=="number"?r+=t.slice(n,n+=a):r+=a}return r}function gs(t,e){return U({...e,room:t,state:U(e.state)()})}var pt=null,gt={},Pr=class{session;update(){Object.keys(this.cb).map(e=>this.cb[e]).map(e=>{try{e(!0)}catch(r){console.error("error calling callback",{err:r})}})}cb={};onUpdate(e,r){this.cb[r]=e}hashCodeSession=0;room;originStr;created=new Date().toISOString();constructor(e,r,n){pt=this,this.room=e,this.originStr=n;let i=null;this.session=gs(e,{...r,state:i||JSON.parse(Nt(r.state,this.originStr))})()}hashOfState=()=>{let e=this.session.get("state"),r=e.hashCode();return gt[r]=e,r};createPatchFromHashCode=async(e,r)=>{let n=JSON.parse(Nt(r,this.originStr));if(!gt[e]){let p=await fetch(`/live/${this.room}
        `),{mST:c,hashCode:l}=await p.json();gt[l]=this.session.get("state").merge(c)}let i=gt[e],s=Nt(i.toJSON(),this.originStr),o=i.merge(n),a=Nt(o.toJSON(),this.originStr),u=o.hashCode();gt[u]=o;let f=ys(s,a);return{oldHash:e,newHash:u,patch:f}};applyPatch=async({oldHash:e,newHash:r,patch:n})=>{let i=this.room||"";if(!Object.keys(gt).map(c=>Number(c)).includes(Number(e))&&i){console.log(Object.keys(gt));let c=await fetch(`/live/${i}/mST`);if(c.ok){let l=await c.json(),h=this.session.get("state").merge(JSON.parse(Nt(l.mST,this.originStr)));gt[h.hashCode()]=h}else{let{mST:l}=await import(location.origin+`/live/${this.room}/mst.mjs?${Date.now()}`),h=this.session.get("state").merge(JSON.parse(Nt(l,this.originStr)));gt[h.hashCode()]=h}}let s=Nt(gt[e].toJSON(),this.originStr),o=Ai(s,n),a=JSON.parse(o),u=this.session.get("state").merge(a),f=this.session.get("state").merge(u);if(f.hashCode()===r)this.session=this.session.set("state",f);else{new Error("Wrong patch");return}};json(){let e=this.session.toJSON(),r=e.state.toJSON();return{...e,state:r}}setRoom(e){let r=this.session.set("room",e);this.session=r}},zt=()=>pt?pt.hashOfState():0,Qt=t=>{if(!pt)return{i:0,transpiled:"",code:"",html:"",css:""};if(t)return Ri(pt.json().state,t);let{i:e,transpiled:r,code:n,html:i,css:s}=pt.json().state;return{i:e,transpiled:r,code:n,html:i,css:s}};function Ri(t,e){let{i:r,transpiled:n,code:i,html:s,css:o}=t,a={i:r,transpiled:n,code:i,html:s,css:o};return a.code=a.code.replace("from '/live",`from '${e}/live`),a.code=a.code.replace("from './",`from '${e}/live/`),a.transpiled=a.transpiled.replace('from "/live',`from "${e}/live`),a.transpiled=a.transpiled.replace('from "./',`from "${e}/live/`),a}function Nt(t,e){return JSON.stringify(Ri(t,e))}var $e=async t=>{await pt?.applyPatch(t),pt?.update()},Ea=(t,e="default")=>pt?.onUpdate(t,e),Pe=(t,e)=>pt.createPatchFromHashCode(t,e),ke=t=>Pe(zt(),t),ji=(t,e,r)=>pt||new Pr(t,e,r);function ys(t,e){return Ti(t,e)}var _o=tn(co(),1);m();var Fe,aa=new Uint8Array(16);function ua(){if(!Fe&&(Fe=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Fe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Fe(aa)}var fa=/^(?:[\da-f]{8}-[\da-f]{4}-[1-5][\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}|0{8}-(?:0{4}-){3}0{12})$/i;function ca(t){return typeof t=="string"&&fa.test(t)}var F=[];for(let t=0;t<256;++t)F.push((t+256).toString(16).slice(1));function ha(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(F[t[e+0]]+F[t[e+1]]+F[t[e+2]]+F[t[e+3]]+"-"+F[t[e+4]]+F[t[e+5]]+"-"+F[t[e+6]]+F[t[e+7]]+"-"+F[t[e+8]]+F[t[e+9]]+"-"+F[t[e+10]]+F[t[e+11]]+F[t[e+12]]+F[t[e+13]]+F[t[e+14]]+F[t[e+15]]).toLowerCase();if(!ca(r))throw new TypeError("Stringified UUID is invalid");return r}function ho(t,e,r){t=t||{};let n=t.random||(t.rng||ua)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=n[i];return e}return ha(n)}m();import{Fragment as pa}from"/react.mjs";m();function Hr(t){var e="0123456789abcdef";function r(y){var g,w="";for(g=0;g<=3;g++)w+=e.charAt(y>>g*8+4&15)+e.charAt(y>>g*8&15);return w}function n(y,g){var w=(y&65535)+(g&65535),I=(y>>16)+(g>>16)+(w>>16);return I<<16|w&65535}function i(y,g){return y<<g|y>>>32-g}function s(y,g,w,I,et,yt){return n(i(n(n(g,y),n(I,yt)),et),w)}function o(y,g,w,I,et,yt,Ct){return s(g&w|~g&I,y,g,et,yt,Ct)}function a(y,g,w,I,et,yt,Ct){return s(g&I|w&~I,y,g,et,yt,Ct)}function u(y,g,w,I,et,yt,Ct){return s(g^w^I,y,g,et,yt,Ct)}function f(y,g,w,I,et,yt,Ct){return s(w^(g|~I),y,g,et,yt,Ct)}function p(y){var g,w=(y.length+8>>6)+1,I=new Array(w*16);for(g=0;g<w*16;g++)I[g]=0;for(g=0;g<y.length;g++)I[g>>2]|=y.charCodeAt(g)<<g%4*8;return I[g>>2]|=128<<g%4*8,I[w*16-2]=y.length*8,I}var c,l=p(t),h=1732584193,_=-271733879,d=-1732584194,v=271733878,S,b,M,A;for(c=0;c<l.length;c+=16)S=h,b=_,M=d,A=v,h=o(h,_,d,v,l[c+0],7,-680876936),v=o(v,h,_,d,l[c+1],12,-389564586),d=o(d,v,h,_,l[c+2],17,606105819),_=o(_,d,v,h,l[c+3],22,-1044525330),h=o(h,_,d,v,l[c+4],7,-176418897),v=o(v,h,_,d,l[c+5],12,1200080426),d=o(d,v,h,_,l[c+6],17,-1473231341),_=o(_,d,v,h,l[c+7],22,-45705983),h=o(h,_,d,v,l[c+8],7,1770035416),v=o(v,h,_,d,l[c+9],12,-1958414417),d=o(d,v,h,_,l[c+10],17,-42063),_=o(_,d,v,h,l[c+11],22,-1990404162),h=o(h,_,d,v,l[c+12],7,1804603682),v=o(v,h,_,d,l[c+13],12,-40341101),d=o(d,v,h,_,l[c+14],17,-1502002290),_=o(_,d,v,h,l[c+15],22,1236535329),h=a(h,_,d,v,l[c+1],5,-165796510),v=a(v,h,_,d,l[c+6],9,-1069501632),d=a(d,v,h,_,l[c+11],14,643717713),_=a(_,d,v,h,l[c+0],20,-373897302),h=a(h,_,d,v,l[c+5],5,-701558691),v=a(v,h,_,d,l[c+10],9,38016083),d=a(d,v,h,_,l[c+15],14,-660478335),_=a(_,d,v,h,l[c+4],20,-405537848),h=a(h,_,d,v,l[c+9],5,568446438),v=a(v,h,_,d,l[c+14],9,-1019803690),d=a(d,v,h,_,l[c+3],14,-187363961),_=a(_,d,v,h,l[c+8],20,1163531501),h=a(h,_,d,v,l[c+13],5,-1444681467),v=a(v,h,_,d,l[c+2],9,-51403784),d=a(d,v,h,_,l[c+7],14,1735328473),_=a(_,d,v,h,l[c+12],20,-1926607734),h=u(h,_,d,v,l[c+5],4,-378558),v=u(v,h,_,d,l[c+8],11,-2022574463),d=u(d,v,h,_,l[c+11],16,1839030562),_=u(_,d,v,h,l[c+14],23,-35309556),h=u(h,_,d,v,l[c+1],4,-1530992060),v=u(v,h,_,d,l[c+4],11,1272893353),d=u(d,v,h,_,l[c+7],16,-155497632),_=u(_,d,v,h,l[c+10],23,-1094730640),h=u(h,_,d,v,l[c+13],4,681279174),v=u(v,h,_,d,l[c+0],11,-358537222),d=u(d,v,h,_,l[c+3],16,-722521979),_=u(_,d,v,h,l[c+6],23,76029189),h=u(h,_,d,v,l[c+9],4,-640364487),v=u(v,h,_,d,l[c+12],11,-421815835),d=u(d,v,h,_,l[c+15],16,530742520),_=u(_,d,v,h,l[c+2],23,-995338651),h=f(h,_,d,v,l[c+0],6,-198630844),v=f(v,h,_,d,l[c+7],10,1126891415),d=f(d,v,h,_,l[c+14],15,-1416354905),_=f(_,d,v,h,l[c+5],21,-57434055),h=f(h,_,d,v,l[c+12],6,1700485571),v=f(v,h,_,d,l[c+3],10,-1894986606),d=f(d,v,h,_,l[c+10],15,-1051523),_=f(_,d,v,h,l[c+1],21,-2054922799),h=f(h,_,d,v,l[c+8],6,1873313359),v=f(v,h,_,d,l[c+15],10,-30611744),d=f(d,v,h,_,l[c+6],15,-1560198380),_=f(_,d,v,h,l[c+13],21,1309151649),h=f(h,_,d,v,l[c+4],6,-145523070),v=f(v,h,_,d,l[c+11],10,-1120210379),d=f(d,v,h,_,l[c+2],15,718787259),_=f(_,d,v,h,l[c+9],21,-343485551),h=n(h,S),_=n(_,b),d=n(d,M),v=n(v,A);return r(h)+r(_)+r(d)+r(v)}Object.assign(window,{esmsInitOptions:{shimMode:!0,polyfillEnable:["css-modules","json-modules"]}});var po=async t=>import("./LERC2OP6.mjs").then(()=>importShim.addImportMap({imports:{"framer-motion":location.origin+"/"+t["framer-motion.mjs"],"@emotion/react":location.origin+"/"+t["emotion.mjs"],react:location.origin+"/"+t["react.mjs"],"react-dom":location.origin+"/"+t["react.mjs"],"react-dom/client":location.origin+"/"+t["react.mjs"],"react-dom/server":location.origin+"/"+t["react.mjs"],"react/jsx-runtime":location.origin+"/"+t["react.mjs"]}})),Jr=()=>Je(pa,null),xt={},Ga=({hash:t})=>{let e=Hr(Qt().transpiled);return xt[e]&&(Jr=xt[e]),Je(Jr,{key:t})};async function Va(t){let e=Hr(t);return xt[e]||(xt[e]=(await importShim(_a(t))).default),Jr=xt[e],xt[e]}function _a(t){let e=new File([t],"index.mjs",{type:"application/javascript"});return URL.createObjectURL(e)}var Be=[],tt=(self&&self.crypto&&self.crypto.randomUUID&&self.crypto.randomUUID()||ho()).slice(0,8),z={},Gr,Mt,Vr,Xr=0,we=0,lo=0,Zr=0,W=null,vo,Dt=!1,Qr={webRtcArray:Be,rtcConns:z,send:t=>{let e=t.target,r=JSON.stringify({...t,name:t.name||tt});Be.map(n=>{try{if(console.log("WebRtc send",t,n),n.readyState!=="open")return;(!e||n.target===e&&!He.includes(n.target))&&n.send(r)}catch(i){console.error("Error in broadcasting event",{e:i})}})}};async function la(t){let{renderPreviewWindow:e}=await import("./2MAWW3RG.mjs");return e(t)}var tu=async t=>{Mt=t.codeSpace,Vr=t.address;let{assets:e}=t;ji(Mt,{name:tt,state:t.mST},""),po(e),la(Mt),go(),Gr=new BroadcastChannel("spike.land"),Gr.onmessage=async r=>{if(!(r.data.ignoreUser&&r.data.ignoreUser===tt)&&(console.log({event:r}),r.data.codeSpace===Mt&&r.data.address&&!Vr&&W?.send(JSON.stringify({codeSpace:Mt,address:r.data.address})),r.data.ignoreUser&&!He.includes(r.data.ignoreUser)&&He.push(r.data.ignoreUser),r.data.codeSpace===Mt&&r.data.sess.code!==Qt().code)){let n=await ke(r.data.sess);await $e(n)}}};(async()=>{if(navigator&&navigator?.serviceWorker){navigator.serviceWorker.register("/sw.js",{scope:"/"});let t=await navigator.serviceWorker.ready;await ga(),Promise.all((await navigator.serviceWorker.getRegistrations()).map(e=>{t!==e&&e.unregister()}))}})();var Kr=null;async function We(){return!Dt||W===null?(W=null,await go()):W}var He=[];async function eu(t){if(t.i<=Qt().i)return;console.log("creating a patch");let e=await ke(t);if(console.log("applying the patch"),await $e(e),console.log("done"),t.i===Qt().i){Gr.postMessage({ignoreUser:tt,sess:t,codeSpace:Mt,address:Vr,messageData:e});try{(async()=>{if(Object.keys(z).length!=0)try{let r=we?await Pe(we,t):await ke(t);r&&r.patch&&(console.log("sendRTC"),Qr.send(r))}catch(r){console.error("Error sending RTC...",{e:r})}})()}catch{console.log("Error 1")}try{(async()=>{if(W){console.log({wsLastHashCode:Xr});let r=await Pe(Xr,t);if(!r)return;if(r.newHash!==zt()){console.error("NEW hash is not even hashCode",zt());return}let n=JSON.stringify({...r,name:tt});vo(n)}else Dt=!1,await We()})()}catch(r){console.error("error 2",{e:r})}}}async function go(){if(W!==null)return W;Dt=!0,console.log("WS connect!");let t=new WebSocket(`wss://${location.host}/live/`+Mt+"/websocket");return Dt=!1,t.addEventListener("open",()=>(console.log("NEW WS CONNECTION"),W=t,vo=(0,_o.default)(r=>{try{W&&W?.send&&W?.send(r)}catch{W=null,Dt=!1,We()}},500,{maxWait:1200,leading:!0,trailing:!0}),W.addEventListener("message",r=>xr(r,"ws")),Kr&&clearInterval(Kr),Kr=setInterval(()=>{let n=Date.now()-Zr;if(n>4e4)try{if(t.readyState===t.OPEN)return t?.send(JSON.stringify({name:tt,timestamp:lo+n}));Dt=!1,We()}catch{Dt=!1,We()}},3e4),t.send(JSON.stringify({name:tt})),t)),t}var Yr={};async function xr(t,e){if(W==null)return;Zr=Date.now();let r=JSON.parse(t.data);if(console.log("ws",r.name,r.oldHash,r.newHash),e==="ws"&&r.timestamp&&(Zr=Date.now(),lo=r.timestamp),e==="ws"&&(r.hashCode||r.newHash)&&(Xr=r.hashCode||r.newHash),(e==="rtc"&&r.hashCode||r.newHash)&&(we=r.hashCode||r.newHash),He.includes(r.name)||r.newHash===zt())return;if(r.oldHash&&r.newHash){if(Yr[r.oldHash]&&Yr[r.oldHash]===r.newHash)return;Yr[r.oldHash]=r.newHash}if(r.newHash===zt())return;if((async()=>{try{if(r.type==="new-ice-candidate"){await va(r.candidate,r.name);return}if(r.type==="offer"){await s(r.offer,r.name);return}if(r.type==="answer"){await i(r.answer,r.name);return}if(r.name&&r.name!==tt&&!z[r.name]){await n(r.name);return}}catch(o){console.log({e:o}),da("Error with p2p")}})(),r.patch&&r.name!==tt){if(r.newHash===zt())return;if(await $e(r),r.newHash===zt()){Qr&&Qr.send({hashCode:r.newHash});return}else console.log("error -sending on sendChannel");return}if(r.name===tt)return;function n(o){if(G(`Setting up a connection with ${o}`),z[o]){G(`Aborting, since we have connection with this ${o}`);return}z[o]=new RTCPeerConnection(yo),z[o].onicecandidate=h=>{h.candidate&&(G("*** Outgoing ICE candidate: "+h.candidate),W?.send(JSON.stringify({type:"new-ice-candidate",target:o,name:tt,candidate:h.candidate.toJSON()})))},z[o].oniceconnectionstatechange=c,z[o].onicegatheringstatechange=l,z[o].onsignalingstatechange=()=>{switch(G("*** rtcConns[target].signalingState  changed to: "+z[o].signalingState),z[o].signalingState){case"closed":break}},z[o].onnegotiationneeded=p,z[o].ontrack=h=>console.log(h),z[o].ondatachannel=h=>{console.log("Receive Channel Callback");let _=h.channel;_.binaryType="arraybuffer",_.addEventListener("close",f),_.addEventListener("message",v=>xr(v,"rtc"));let d=Object.assign(_,{target:o});Be.push(d)};let a={ordered:!0,reliable:!0,maxPacketLifeTime:3e3},u=Object.assign(z[o].createDataChannel(o,a),{target:o});return u.binaryType="arraybuffer",u.addEventListener("message",h=>{console.log("***********RTC***",{msg:h});let _=JSON.parse(h.data);return _&&_.hashCode&&(we=_.hashCode),_&&_.newHash&&(we=_.newHash),xr(h,"rtc")}),u.addEventListener("error",h=>{console.log("xxxxxx-  Data Channel Error:",h)}),u.addEventListener("open",()=>{console.log("@@@@@@@@RTC IS OPEN&&&&&&&&"),Be.push(u)}),u.addEventListener("close",()=>{console.log("xxxxxxxx- The Data Channel is Closed")}),z[o];function f(){console.log("Receive channel is closed"),z[o].close(),delete z[o],console.log("Closed remote peer connection")}async function p(){G("*** Negotiation needed");try{G("---> Creating offer");let h=await z[o].createOffer();if(z[o].signalingState!="stable"){G("The connection isn't stable yet; postponing...");return}G("---> Setting local description to the offer"),await z[o].setLocalDescription(h),G("---> Sending the offer to the remote peer"),W?.send(JSON.stringify({target:o,name:tt,type:"offer",offer:z[o].localDescription}))}catch{G("*** The following error occurred while handling the negotiationneeded event:")}}function c(){switch(G("*** ICE connection state changed to "+z[o].iceConnectionState),z[o].iceConnectionState){case"closed":case"failed":case"disconnected":break}}function l(){G("*** rtcConns[target].iceGatheringState changed to: "+z[o].iceGatheringState)}}async function i(o,a){G("*** Call recipient has accepted our call"),await z[a].setRemoteDescription(new RTCSessionDescription(o)).catch(console.error)}async function s(o,a){z[a]||n(a),await z[a].setRemoteDescription(new RTCSessionDescription(o)),G("---> Creating and sending answer to caller");let u=await z[a].createAnswer();await z[a].setLocalDescription(u),W?.send(JSON.stringify({target:a,name:tt,type:"answer",answer:u}))}}function G(t){let e=new Date;console.log("["+e.toLocaleTimeString()+"] "+t)}function da(t){let e=new Date;console.trace("["+e.toLocaleTimeString()+"] "+t)}var yo={iceServers:["stun3.l.google.com:19302"].map(t=>({urls:`stun:${t}`}))};yo.iceServers=[{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.l.google.com:19302"}];async function va(t,e){G("*** Adding received ICE candidate: "+JSON.stringify(t));let r=new RTCIceCandidate(t);console.log(z[e]),await z[e].addIceCandidate(r)}async function ga(){try{if(navigator.serviceWorker.onmessage=async t=>{let e=t.source;if(e!=null)switch(t.data.method){case"ipfs-message-port":console.log("Message port request");let{connect:r}=await import("./MVAI7L3K.mjs");console.log("can connect trough",{connect:r});let n=new MessageChannel;return await r(n),console.log({channel:n}),e.postMessage({method:"ipfs-message-port",id:t.data.id,port:n.port2},{transfer:[n.port2]})}},document.documentElement.dataset.viewer)return(async e=>{switch((e&&e.split("/")||[])[0]||""){case"ipfs":case"ipns":document.body.innerHTML=`<iframe id="viewer" style="width:100%;height:100%;position:fixed;top:0;left:0;border:none;" src="/view${e}"></iframe>`}})(location.pathname)}catch{console.log("ipfs load error")}}export{zt as a,Qt as b,Ea as c,Ga as d,Va as e,la as f,tu as g,eu as h,go as i};
