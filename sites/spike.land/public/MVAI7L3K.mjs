import{a as $s,b as aE,c as Ni,d as Vn,e as hn,f as oE,g as fe,h as ut}from"./YZ5NCQOK.mjs";var vg=Ni(($N,wg)=>{"use strict";fe();var OS=async e=>{let t=[];for await(let r of e)t.push(r);return t};wg.exports=OS});var Rg=Ni((fO,Ag)=>{fe();var Pa=1e3,Wa=Pa*60,Ga=Wa*60,Zs=Ga*24,US=Zs*7,FS=Zs*365.25;Ag.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return jS(e);if(r==="number"&&isFinite(e))return t.long?YS(e):qS(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function jS(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!!t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*FS;case"weeks":case"week":case"w":return r*US;case"days":case"day":case"d":return r*Zs;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Ga;case"minutes":case"minute":case"mins":case"min":case"m":return r*Wa;case"seconds":case"second":case"secs":case"sec":case"s":return r*Pa;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function qS(e){var t=Math.abs(e);return t>=Zs?Math.round(e/Zs)+"d":t>=Ga?Math.round(e/Ga)+"h":t>=Wa?Math.round(e/Wa)+"m":t>=Pa?Math.round(e/Pa)+"s":e+"ms"}function YS(e){var t=Math.abs(e);return t>=Zs?ah(e,t,Zs,"day"):t>=Ga?ah(e,t,Ga,"hour"):t>=Wa?ah(e,t,Wa,"minute"):t>=Pa?ah(e,t,Pa,"second"):e+" ms"}function ah(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}});var Lg=Ni((yO,Ng)=>{fe();function QS(e){r.debug=r,r.default=r,r.coerce=l,r.disable=s,r.enable=i,r.enabled=a,r.humanize=Rg(),r.destroy=u,Object.keys(e).forEach(h=>{r[h]=e[h]}),r.names=[],r.skips=[],r.formatters={};function t(h){let f=0;for(let y=0;y<h.length;y++)f=(f<<5)-f+h.charCodeAt(y),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=t;function r(h){let f,y=null,p,v;function d(...g){if(!d.enabled)return;let b=d,_=Number(new Date),m=_-(f||_);b.diff=m,b.prev=f,b.curr=_,f=_,g[0]=r.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let E=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(N,R)=>{if(N==="%%")return"%";E++;let T=r.formatters[R];if(typeof T=="function"){let S=g[E];N=T.call(b,S),g.splice(E,1),E--}return N}),r.formatArgs.call(b,g),(b.log||r.log).apply(b,g)}return d.namespace=h,d.useColors=r.useColors(),d.color=r.selectColor(h),d.extend=n,d.destroy=r.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>y!==null?y:(p!==r.namespaces&&(p=r.namespaces,v=r.enabled(h)),v),set:g=>{y=g}}),typeof r.init=="function"&&r.init(d),d}function n(h,f){let y=r(this.namespace+(typeof f>"u"?":":f)+h);return y.log=this.log,y}function i(h){r.save(h),r.namespaces=h,r.names=[],r.skips=[];let f,y=(typeof h=="string"?h:"").split(/[\s,]+/),p=y.length;for(f=0;f<p;f++)!y[f]||(h=y[f].replace(/\*/g,".*?"),h[0]==="-"?r.skips.push(new RegExp("^"+h.slice(1)+"$")):r.names.push(new RegExp("^"+h+"$")))}function s(){let h=[...r.names.map(o),...r.skips.map(o).map(f=>"-"+f)].join(",");return r.enable(""),h}function a(h){if(h[h.length-1]==="*")return!0;let f,y;for(f=0,y=r.skips.length;f<y;f++)if(r.skips[f].test(h))return!1;for(f=0,y=r.names.length;f<y;f++)if(r.names[f].test(h))return!0;return!1}function o(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}function l(h){return h instanceof Error?h.stack||h.message:h}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Ng.exports=QS});var Og=Ni((qn,oh)=>{fe();qn.formatArgs=JS;qn.save=oA;qn.load=tI;qn.useColors=ZS;qn.storage=rI();qn.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();qn.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function ZS(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function JS(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+oh.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),e.splice(n,0,t)}qn.log=console.debug||console.log||(()=>{});function oA(e){try{e?qn.storage.setItem("debug",e):qn.storage.removeItem("debug")}catch{}}function tI(){let e;try{e=qn.storage.getItem("debug")}catch{}return!e&&typeof ut<"u"&&"env"in ut&&(e=!1),e}function rI(){try{return localStorage}catch{}}oh.exports=Lg()(qn);var{formatters:nI}=oh.exports;nI.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var os=Ni((SO,Bg)=>{"use strict";fe();function xg(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function uI(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return xg(e,r)}catch{r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),xg(new i,r)}}Bg.exports=uI});var Hm=Ni((Ex,$m)=>{fe();$m.exports=Wf;var Km=128,GI=127,YI=~GI,QI=Math.pow(2,31);function Wf(e,t,r){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw Wf.bytes=0,new RangeError("Could not encode varint");t=t||[],r=r||0;for(var n=r;e>=QI;)t[r++]=e&255|Km,e/=128;for(;e&YI;)t[r++]=e&255|Km,e>>>=7;return t[r]=e|0,Wf.bytes=r-n+1,t}});var r6=Ni((_x,t6)=>{fe();t6.exports=ep;var ZI=128,e6=127;function ep(e,n){var r=0,n=n||0,i=0,s=n,a,o=e.length;do{if(s>=o||i>49)throw ep.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&e6)<<i:(a&e6)*Math.pow(2,i),i+=7}while(a>=ZI);return ep.bytes=s-n,r}});var N6=Ni((Sx,n6)=>{fe();var JI=Math.pow(2,7),cR=Math.pow(2,14),hR=Math.pow(2,21),yR=Math.pow(2,28),vR=Math.pow(2,35),bR=Math.pow(2,42),ER=Math.pow(2,49),_R=Math.pow(2,56),zR=Math.pow(2,63);n6.exports=function(e){return e<JI?1:e<cR?2:e<hR?3:e<yR?4:e<vR?5:e<bR?6:e<ER?7:e<_R?8:e<zR?9:10}});var id=Ni((Ax,i4)=>{fe();i4.exports={encode:Hm(),decode:r6(),encodingLength:N6()}});var r1=Ni((cV,e5)=>{"use strict";fe();function Xk(e){let t=new Uint8Array(e),r=0;if(e>0)if(e>65536)for(;r<e;)r+65536>e?(crypto.getRandomValues(t.subarray(r,r+(e-r))),r+=e-r):(crypto.getRandomValues(t.subarray(r,r+65536)),r+=65536);else crypto.getRandomValues(t);return t}e5.exports=Xk});var b0=Ni((IV,p0)=>{"use strict";fe();var vT=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),_8=()=>{let e=new Error("Delay aborted");return e.name="AbortError",e},P8=({clearTimeout:e,setTimeout:t,willResolve:r})=>(n,{value:i,signal:s}={})=>{if(s&&s.aborted)return Promise.reject(_8());let a,o,l,u=e||clearTimeout,h=()=>{u(a),l(_8())},f=()=>{s&&s.removeEventListener("abort",h)},y=new Promise((p,v)=>{o=()=>{f(),r?p(i):v(i)},l=v,a=(t||setTimeout)(o,n)});return s&&s.addEventListener("abort",h,{once:!0}),y.clear=()=>{u(a),a=null,o()},y},N8=e=>{let t=P8({...e,willResolve:!0});return t.reject=P8({...e,willResolve:!1}),t.range=(r,n,i)=>t(vT(r,n),i),t},Qp=N8();Qp.createWithTimers=N8;p0.exports=Qp;p0.exports.default=Qp});var KP={};var Zv=aE(()=>{"use strict";fe();(function(e,t){typeof module=="object"&&module.exports?module.exports=t():e.IpfsCore=t()})(typeof self<"u"?self:void 0,function(){var IpfsCore=(()=>{var npe=Object.create,S4=Object.defineProperty,ipe=Object.getOwnPropertyDescriptor,ope=Object.getOwnPropertyNames,spe=Object.getPrototypeOf,ape=Object.prototype.hasOwnProperty,jd=(e=>typeof $s<"u"?$s:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof $s<"u"?$s:t)[r]}):e)(function(e){if(typeof $s<"u")return $s.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),Fe=(e,t)=>()=>(e&&(t=e(e=0)),t),A=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ct=(e,t)=>{for(var r in t)S4(e,r,{get:t[r],enumerable:!0})},SN=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ope(t))!ape.call(e,i)&&i!==r&&S4(e,i,{get:()=>t[i],enumerable:!(n=ipe(t,i))||n.enumerable});return e},w=(e,t,r)=>(r=e!=null?npe(spe(e)):{},SN(t||!e||!e.__esModule?S4(r,"default",{value:e,enumerable:!0}):r,e)),cr=e=>SN(S4({},"__esModule",{value:!0}),e),AN=A(e=>{"use strict";c(),e.byteLength=l,e.toByteArray=h,e.fromByteArray=p;var t=[],r=[],n=typeof Uint8Array<"u"?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(s=0,a=i.length;s<a;++s)t[s]=i[s],r[i.charCodeAt(s)]=s;var s,a;r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63;function o(v){var d=v.length;if(d%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=v.indexOf("=");g===-1&&(g=d);var b=g===d?0:4-g%4;return[g,b]}function l(v){var d=o(v),g=d[0],b=d[1];return(g+b)*3/4-b}function u(v,d,g){return(d+g)*3/4-g}function h(v){var d,g=o(v),b=g[0],_=g[1],m=new n(u(v,b,_)),E=0,D=_>0?b-4:b,N;for(N=0;N<D;N+=4)d=r[v.charCodeAt(N)]<<18|r[v.charCodeAt(N+1)]<<12|r[v.charCodeAt(N+2)]<<6|r[v.charCodeAt(N+3)],m[E++]=d>>16&255,m[E++]=d>>8&255,m[E++]=d&255;return _===2&&(d=r[v.charCodeAt(N)]<<2|r[v.charCodeAt(N+1)]>>4,m[E++]=d&255),_===1&&(d=r[v.charCodeAt(N)]<<10|r[v.charCodeAt(N+1)]<<4|r[v.charCodeAt(N+2)]>>2,m[E++]=d>>8&255,m[E++]=d&255),m}function f(v){return t[v>>18&63]+t[v>>12&63]+t[v>>6&63]+t[v&63]}function y(v,d,g){for(var b,_=[],m=d;m<g;m+=3)b=(v[m]<<16&16711680)+(v[m+1]<<8&65280)+(v[m+2]&255),_.push(f(b));return _.join("")}function p(v){for(var d,g=v.length,b=g%3,_=[],m=16383,E=0,D=g-b;E<D;E+=m)_.push(y(v,E,E+m>D?D:E+m));return b===1?(d=v[g-1],_.push(t[d>>2]+t[d<<4&63]+"==")):b===2&&(d=(v[g-2]<<8)+v[g-1],_.push(t[d>>10]+t[d>>4&63]+t[d<<2&63]+"=")),_.join("")}}),TN=A(e=>{c(),e.read=function(t,r,n,i,s){var a,o,l=s*8-i-1,u=(1<<l)-1,h=u>>1,f=-7,y=n?s-1:0,p=n?-1:1,v=t[r+y];for(y+=p,a=v&(1<<-f)-1,v>>=-f,f+=l;f>0;a=a*256+t[r+y],y+=p,f-=8);for(o=a&(1<<-f)-1,a>>=-f,f+=i;f>0;o=o*256+t[r+y],y+=p,f-=8);if(a===0)a=1-h;else{if(a===u)return o?NaN:(v?-1:1)*(1/0);o=o+Math.pow(2,i),a=a-h}return(v?-1:1)*o*Math.pow(2,a-i)},e.write=function(t,r,n,i,s,a){var o,l,u,h=a*8-s-1,f=(1<<h)-1,y=f>>1,p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=i?0:a-1,d=i?1:-1,g=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(l=isNaN(r)?1:0,o=f):(o=Math.floor(Math.log(r)/Math.LN2),r*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+y>=1?r+=p/u:r+=p*Math.pow(2,1-y),r*u>=2&&(o++,u/=2),o+y>=f?(l=0,o=f):o+y>=1?(l=(r*u-1)*Math.pow(2,s),o=o+y):(l=r*Math.pow(2,y-1)*Math.pow(2,s),o=0));s>=8;t[n+v]=l&255,v+=d,l/=256,s-=8);for(o=o<<s|l,h+=s;h>0;t[n+v]=o&255,v+=d,o/=256,h-=8);t[n+v-d]|=g*128}}),_i=A(e=>{"use strict";c();var t=AN(),r=TN(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=_,e.INSPECT_MAX_BYTES=50;var i=2147483647;e.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=s(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{let x=new Uint8Array(1),$={foo:function(){return 42}};return Object.setPrototypeOf($,Uint8Array.prototype),Object.setPrototypeOf(x,$),x.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function a(x){if(x>i)throw new RangeError('The value "'+x+'" is invalid for option "size"');let $=new Uint8Array(x);return Object.setPrototypeOf($,o.prototype),$}function o(x,$,J){if(typeof x=="number"){if(typeof $=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(x)}return l(x,$,J)}o.poolSize=8192;function l(x,$,J){if(typeof x=="string")return y(x,$);if(ArrayBuffer.isView(x))return v(x);if(x==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof x);if(Wt(x,ArrayBuffer)||x&&Wt(x.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Wt(x,SharedArrayBuffer)||x&&Wt(x.buffer,SharedArrayBuffer)))return d(x,$,J);if(typeof x=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let ge=x.valueOf&&x.valueOf();if(ge!=null&&ge!==x)return o.from(ge,$,J);let Le=g(x);if(Le)return Le;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof x[Symbol.toPrimitive]=="function")return o.from(x[Symbol.toPrimitive]("string"),$,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof x)}o.from=function(x,$,J){return l(x,$,J)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function u(x){if(typeof x!="number")throw new TypeError('"size" argument must be of type number');if(x<0)throw new RangeError('The value "'+x+'" is invalid for option "size"')}function h(x,$,J){return u(x),x<=0?a(x):$!==void 0?typeof J=="string"?a(x).fill($,J):a(x).fill($):a(x)}o.alloc=function(x,$,J){return h(x,$,J)};function f(x){return u(x),a(x<0?0:b(x)|0)}o.allocUnsafe=function(x){return f(x)},o.allocUnsafeSlow=function(x){return f(x)};function y(x,$){if((typeof $!="string"||$==="")&&($="utf8"),!o.isEncoding($))throw new TypeError("Unknown encoding: "+$);let J=m(x,$)|0,ge=a(J),Le=ge.write(x,$);return Le!==J&&(ge=ge.slice(0,Le)),ge}function p(x){let $=x.length<0?0:b(x.length)|0,J=a($);for(let ge=0;ge<$;ge+=1)J[ge]=x[ge]&255;return J}function v(x){if(Wt(x,Uint8Array)){let $=new Uint8Array(x);return d($.buffer,$.byteOffset,$.byteLength)}return p(x)}function d(x,$,J){if($<0||x.byteLength<$)throw new RangeError('"offset" is outside of buffer bounds');if(x.byteLength<$+(J||0))throw new RangeError('"length" is outside of buffer bounds');let ge;return $===void 0&&J===void 0?ge=new Uint8Array(x):J===void 0?ge=new Uint8Array(x,$):ge=new Uint8Array(x,$,J),Object.setPrototypeOf(ge,o.prototype),ge}function g(x){if(o.isBuffer(x)){let $=b(x.length)|0,J=a($);return J.length===0||x.copy(J,0,0,$),J}if(x.length!==void 0)return typeof x.length!="number"||lr(x.length)?a(0):p(x);if(x.type==="Buffer"&&Array.isArray(x.data))return p(x.data)}function b(x){if(x>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return x|0}function _(x){return+x!=x&&(x=0),o.alloc(+x)}o.isBuffer=function(x){return x!=null&&x._isBuffer===!0&&x!==o.prototype},o.compare=function(x,$){if(Wt(x,Uint8Array)&&(x=o.from(x,x.offset,x.byteLength)),Wt($,Uint8Array)&&($=o.from($,$.offset,$.byteLength)),!o.isBuffer(x)||!o.isBuffer($))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(x===$)return 0;let J=x.length,ge=$.length;for(let Le=0,it=Math.min(J,ge);Le<it;++Le)if(x[Le]!==$[Le]){J=x[Le],ge=$[Le];break}return J<ge?-1:ge<J?1:0},o.isEncoding=function(x){switch(String(x).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(x,$){if(!Array.isArray(x))throw new TypeError('"list" argument must be an Array of Buffers');if(x.length===0)return o.alloc(0);let J;if($===void 0)for($=0,J=0;J<x.length;++J)$+=x[J].length;let ge=o.allocUnsafe($),Le=0;for(J=0;J<x.length;++J){let it=x[J];if(Wt(it,Uint8Array))Le+it.length>ge.length?(o.isBuffer(it)||(it=o.from(it)),it.copy(ge,Le)):Uint8Array.prototype.set.call(ge,it,Le);else if(o.isBuffer(it))it.copy(ge,Le);else throw new TypeError('"list" argument must be an Array of Buffers');Le+=it.length}return ge};function m(x,$){if(o.isBuffer(x))return x.length;if(ArrayBuffer.isView(x)||Wt(x,ArrayBuffer))return x.byteLength;if(typeof x!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof x);let J=x.length,ge=arguments.length>2&&arguments[2]===!0;if(!ge&&J===0)return 0;let Le=!1;for(;;)switch($){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return tt(x).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J*2;case"hex":return J>>>1;case"base64":return Lt(x).length;default:if(Le)return ge?-1:tt(x).length;$=(""+$).toLowerCase(),Le=!0}}o.byteLength=m;function E(x,$,J){let ge=!1;if(($===void 0||$<0)&&($=0),$>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0,$>>>=0,J<=$))return"";for(x||(x="utf8");;)switch(x){case"hex":return de(this,$,J);case"utf8":case"utf-8":return Y(this,$,J);case"ascii":return H(this,$,J);case"latin1":case"binary":return W(this,$,J);case"base64":return ne(this,$,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return De(this,$,J);default:if(ge)throw new TypeError("Unknown encoding: "+x);x=(x+"").toLowerCase(),ge=!0}}o.prototype._isBuffer=!0;function D(x,$,J){let ge=x[$];x[$]=x[J],x[J]=ge}o.prototype.swap16=function(){let x=this.length;if(x%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let $=0;$<x;$+=2)D(this,$,$+1);return this},o.prototype.swap32=function(){let x=this.length;if(x%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let $=0;$<x;$+=4)D(this,$,$+3),D(this,$+1,$+2);return this},o.prototype.swap64=function(){let x=this.length;if(x%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let $=0;$<x;$+=8)D(this,$,$+7),D(this,$+1,$+6),D(this,$+2,$+5),D(this,$+3,$+4);return this},o.prototype.toString=function(){let x=this.length;return x===0?"":arguments.length===0?Y(this,0,x):E.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(x){if(!o.isBuffer(x))throw new TypeError("Argument must be a Buffer");return this===x?!0:o.compare(this,x)===0},o.prototype.inspect=function(){let x="",$=e.INSPECT_MAX_BYTES;return x=this.toString("hex",0,$).replace(/(.{2})/g,"$1 ").trim(),this.length>$&&(x+=" ... "),"<Buffer "+x+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(x,$,J,ge,Le){if(Wt(x,Uint8Array)&&(x=o.from(x,x.offset,x.byteLength)),!o.isBuffer(x))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof x);if($===void 0&&($=0),J===void 0&&(J=x?x.length:0),ge===void 0&&(ge=0),Le===void 0&&(Le=this.length),$<0||J>x.length||ge<0||Le>this.length)throw new RangeError("out of range index");if(ge>=Le&&$>=J)return 0;if(ge>=Le)return-1;if($>=J)return 1;if($>>>=0,J>>>=0,ge>>>=0,Le>>>=0,this===x)return 0;let it=Le-ge,bt=J-$,Kt=Math.min(it,bt),ar=this.slice(ge,Le),Pr=x.slice($,J);for(let Rr=0;Rr<Kt;++Rr)if(ar[Rr]!==Pr[Rr]){it=ar[Rr],bt=Pr[Rr];break}return it<bt?-1:bt<it?1:0};function N(x,$,J,ge,Le){if(x.length===0)return-1;if(typeof J=="string"?(ge=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),J=+J,lr(J)&&(J=Le?0:x.length-1),J<0&&(J=x.length+J),J>=x.length){if(Le)return-1;J=x.length-1}else if(J<0)if(Le)J=0;else return-1;if(typeof $=="string"&&($=o.from($,ge)),o.isBuffer($))return $.length===0?-1:R(x,$,J,ge,Le);if(typeof $=="number")return $=$&255,typeof Uint8Array.prototype.indexOf=="function"?Le?Uint8Array.prototype.indexOf.call(x,$,J):Uint8Array.prototype.lastIndexOf.call(x,$,J):R(x,[$],J,ge,Le);throw new TypeError("val must be string, number or Buffer")}function R(x,$,J,ge,Le){let it=1,bt=x.length,Kt=$.length;if(ge!==void 0&&(ge=String(ge).toLowerCase(),ge==="ucs2"||ge==="ucs-2"||ge==="utf16le"||ge==="utf-16le")){if(x.length<2||$.length<2)return-1;it=2,bt/=2,Kt/=2,J/=2}function ar(Rr,Xr){return it===1?Rr[Xr]:Rr.readUInt16BE(Xr*it)}let Pr;if(Le){let Rr=-1;for(Pr=J;Pr<bt;Pr++)if(ar(x,Pr)===ar($,Rr===-1?0:Pr-Rr)){if(Rr===-1&&(Rr=Pr),Pr-Rr+1===Kt)return Rr*it}else Rr!==-1&&(Pr-=Pr-Rr),Rr=-1}else for(J+Kt>bt&&(J=bt-Kt),Pr=J;Pr>=0;Pr--){let Rr=!0;for(let Xr=0;Xr<Kt;Xr++)if(ar(x,Pr+Xr)!==ar($,Xr)){Rr=!1;break}if(Rr)return Pr}return-1}o.prototype.includes=function(x,$,J){return this.indexOf(x,$,J)!==-1},o.prototype.indexOf=function(x,$,J){return N(this,x,$,J,!0)},o.prototype.lastIndexOf=function(x,$,J){return N(this,x,$,J,!1)};function T(x,$,J,ge){J=Number(J)||0;let Le=x.length-J;ge?(ge=Number(ge),ge>Le&&(ge=Le)):ge=Le;let it=$.length;ge>it/2&&(ge=it/2);let bt;for(bt=0;bt<ge;++bt){let Kt=parseInt($.substr(bt*2,2),16);if(lr(Kt))return bt;x[J+bt]=Kt}return bt}function S(x,$,J,ge){return $t(tt($,x.length-J),x,J,ge)}function O(x,$,J,ge){return $t(Ft($),x,J,ge)}function F(x,$,J,ge){return $t(Lt($),x,J,ge)}function G(x,$,J,ge){return $t(Dt($,x.length-J),x,J,ge)}o.prototype.write=function(x,$,J,ge){if($===void 0)ge="utf8",J=this.length,$=0;else if(J===void 0&&typeof $=="string")ge=$,J=this.length,$=0;else if(isFinite($))$=$>>>0,isFinite(J)?(J=J>>>0,ge===void 0&&(ge="utf8")):(ge=J,J=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let Le=this.length-$;if((J===void 0||J>Le)&&(J=Le),x.length>0&&(J<0||$<0)||$>this.length)throw new RangeError("Attempt to write outside buffer bounds");ge||(ge="utf8");let it=!1;for(;;)switch(ge){case"hex":return T(this,x,$,J);case"utf8":case"utf-8":return S(this,x,$,J);case"ascii":case"latin1":case"binary":return O(this,x,$,J);case"base64":return F(this,x,$,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,x,$,J);default:if(it)throw new TypeError("Unknown encoding: "+ge);ge=(""+ge).toLowerCase(),it=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ne(x,$,J){return $===0&&J===x.length?t.fromByteArray(x):t.fromByteArray(x.slice($,J))}function Y(x,$,J){J=Math.min(x.length,J);let ge=[],Le=$;for(;Le<J;){let it=x[Le],bt=null,Kt=it>239?4:it>223?3:it>191?2:1;if(Le+Kt<=J){let ar,Pr,Rr,Xr;switch(Kt){case 1:it<128&&(bt=it);break;case 2:ar=x[Le+1],(ar&192)===128&&(Xr=(it&31)<<6|ar&63,Xr>127&&(bt=Xr));break;case 3:ar=x[Le+1],Pr=x[Le+2],(ar&192)===128&&(Pr&192)===128&&(Xr=(it&15)<<12|(ar&63)<<6|Pr&63,Xr>2047&&(Xr<55296||Xr>57343)&&(bt=Xr));break;case 4:ar=x[Le+1],Pr=x[Le+2],Rr=x[Le+3],(ar&192)===128&&(Pr&192)===128&&(Rr&192)===128&&(Xr=(it&15)<<18|(ar&63)<<12|(Pr&63)<<6|Rr&63,Xr>65535&&Xr<1114112&&(bt=Xr))}}bt===null?(bt=65533,Kt=1):bt>65535&&(bt-=65536,ge.push(bt>>>10&1023|55296),bt=56320|bt&1023),ge.push(bt),Le+=Kt}return oe(ge)}var ce=4096;function oe(x){let $=x.length;if($<=ce)return String.fromCharCode.apply(String,x);let J="",ge=0;for(;ge<$;)J+=String.fromCharCode.apply(String,x.slice(ge,ge+=ce));return J}function H(x,$,J){let ge="";J=Math.min(x.length,J);for(let Le=$;Le<J;++Le)ge+=String.fromCharCode(x[Le]&127);return ge}function W(x,$,J){let ge="";J=Math.min(x.length,J);for(let Le=$;Le<J;++Le)ge+=String.fromCharCode(x[Le]);return ge}function de(x,$,J){let ge=x.length;(!$||$<0)&&($=0),(!J||J<0||J>ge)&&(J=ge);let Le="";for(let it=$;it<J;++it)Le+=Cr[x[it]];return Le}function De(x,$,J){let ge=x.slice($,J),Le="";for(let it=0;it<ge.length-1;it+=2)Le+=String.fromCharCode(ge[it]+ge[it+1]*256);return Le}o.prototype.slice=function(x,$){let J=this.length;x=~~x,$=$===void 0?J:~~$,x<0?(x+=J,x<0&&(x=0)):x>J&&(x=J),$<0?($+=J,$<0&&($=0)):$>J&&($=J),$<x&&($=x);let ge=this.subarray(x,$);return Object.setPrototypeOf(ge,o.prototype),ge};function Pe(x,$,J){if(x%1!==0||x<0)throw new RangeError("offset is not uint");if(x+$>J)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(x,$,J){x=x>>>0,$=$>>>0,J||Pe(x,$,this.length);let ge=this[x],Le=1,it=0;for(;++it<$&&(Le*=256);)ge+=this[x+it]*Le;return ge},o.prototype.readUintBE=o.prototype.readUIntBE=function(x,$,J){x=x>>>0,$=$>>>0,J||Pe(x,$,this.length);let ge=this[x+--$],Le=1;for(;$>0&&(Le*=256);)ge+=this[x+--$]*Le;return ge},o.prototype.readUint8=o.prototype.readUInt8=function(x,$){return x=x>>>0,$||Pe(x,1,this.length),this[x]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(x,$){return x=x>>>0,$||Pe(x,2,this.length),this[x]|this[x+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(x,$){return x=x>>>0,$||Pe(x,2,this.length),this[x]<<8|this[x+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(x,$){return x=x>>>0,$||Pe(x,4,this.length),(this[x]|this[x+1]<<8|this[x+2]<<16)+this[x+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(x,$){return x=x>>>0,$||Pe(x,4,this.length),this[x]*16777216+(this[x+1]<<16|this[x+2]<<8|this[x+3])},o.prototype.readBigUInt64LE=sr(function(x){x=x>>>0,yt(x,"offset");let $=this[x],J=this[x+7];($===void 0||J===void 0)&&V(x,this.length-8);let ge=$+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24,Le=this[++x]+this[++x]*2**8+this[++x]*2**16+J*2**24;return BigInt(ge)+(BigInt(Le)<<BigInt(32))}),o.prototype.readBigUInt64BE=sr(function(x){x=x>>>0,yt(x,"offset");let $=this[x],J=this[x+7];($===void 0||J===void 0)&&V(x,this.length-8);let ge=$*2**24+this[++x]*2**16+this[++x]*2**8+this[++x],Le=this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+J;return(BigInt(ge)<<BigInt(32))+BigInt(Le)}),o.prototype.readIntLE=function(x,$,J){x=x>>>0,$=$>>>0,J||Pe(x,$,this.length);let ge=this[x],Le=1,it=0;for(;++it<$&&(Le*=256);)ge+=this[x+it]*Le;return Le*=128,ge>=Le&&(ge-=Math.pow(2,8*$)),ge},o.prototype.readIntBE=function(x,$,J){x=x>>>0,$=$>>>0,J||Pe(x,$,this.length);let ge=$,Le=1,it=this[x+--ge];for(;ge>0&&(Le*=256);)it+=this[x+--ge]*Le;return Le*=128,it>=Le&&(it-=Math.pow(2,8*$)),it},o.prototype.readInt8=function(x,$){return x=x>>>0,$||Pe(x,1,this.length),this[x]&128?(255-this[x]+1)*-1:this[x]},o.prototype.readInt16LE=function(x,$){x=x>>>0,$||Pe(x,2,this.length);let J=this[x]|this[x+1]<<8;return J&32768?J|4294901760:J},o.prototype.readInt16BE=function(x,$){x=x>>>0,$||Pe(x,2,this.length);let J=this[x+1]|this[x]<<8;return J&32768?J|4294901760:J},o.prototype.readInt32LE=function(x,$){return x=x>>>0,$||Pe(x,4,this.length),this[x]|this[x+1]<<8|this[x+2]<<16|this[x+3]<<24},o.prototype.readInt32BE=function(x,$){return x=x>>>0,$||Pe(x,4,this.length),this[x]<<24|this[x+1]<<16|this[x+2]<<8|this[x+3]},o.prototype.readBigInt64LE=sr(function(x){x=x>>>0,yt(x,"offset");let $=this[x],J=this[x+7];($===void 0||J===void 0)&&V(x,this.length-8);let ge=this[x+4]+this[x+5]*2**8+this[x+6]*2**16+(J<<24);return(BigInt(ge)<<BigInt(32))+BigInt($+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24)}),o.prototype.readBigInt64BE=sr(function(x){x=x>>>0,yt(x,"offset");let $=this[x],J=this[x+7];($===void 0||J===void 0)&&V(x,this.length-8);let ge=($<<24)+this[++x]*2**16+this[++x]*2**8+this[++x];return(BigInt(ge)<<BigInt(32))+BigInt(this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+J)}),o.prototype.readFloatLE=function(x,$){return x=x>>>0,$||Pe(x,4,this.length),r.read(this,x,!0,23,4)},o.prototype.readFloatBE=function(x,$){return x=x>>>0,$||Pe(x,4,this.length),r.read(this,x,!1,23,4)},o.prototype.readDoubleLE=function(x,$){return x=x>>>0,$||Pe(x,8,this.length),r.read(this,x,!0,52,8)},o.prototype.readDoubleBE=function(x,$){return x=x>>>0,$||Pe(x,8,this.length),r.read(this,x,!1,52,8)};function $e(x,$,J,ge,Le,it){if(!o.isBuffer(x))throw new TypeError('"buffer" argument must be a Buffer instance');if($>Le||$<it)throw new RangeError('"value" argument is out of bounds');if(J+ge>x.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(x,$,J,ge){if(x=+x,$=$>>>0,J=J>>>0,!ge){let bt=Math.pow(2,8*J)-1;$e(this,x,$,J,bt,0)}let Le=1,it=0;for(this[$]=x&255;++it<J&&(Le*=256);)this[$+it]=x/Le&255;return $+J},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(x,$,J,ge){if(x=+x,$=$>>>0,J=J>>>0,!ge){let bt=Math.pow(2,8*J)-1;$e(this,x,$,J,bt,0)}let Le=J-1,it=1;for(this[$+Le]=x&255;--Le>=0&&(it*=256);)this[$+Le]=x/it&255;return $+J},o.prototype.writeUint8=o.prototype.writeUInt8=function(x,$,J){return x=+x,$=$>>>0,J||$e(this,x,$,1,255,0),this[$]=x&255,$+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(x,$,J){return x=+x,$=$>>>0,J||$e(this,x,$,2,65535,0),this[$]=x&255,this[$+1]=x>>>8,$+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(x,$,J){return x=+x,$=$>>>0,J||$e(this,x,$,2,65535,0),this[$]=x>>>8,this[$+1]=x&255,$+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(x,$,J){return x=+x,$=$>>>0,J||$e(this,x,$,4,4294967295,0),this[$+3]=x>>>24,this[$+2]=x>>>16,this[$+1]=x>>>8,this[$]=x&255,$+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(x,$,J){return x=+x,$=$>>>0,J||$e(this,x,$,4,4294967295,0),this[$]=x>>>24,this[$+1]=x>>>16,this[$+2]=x>>>8,this[$+3]=x&255,$+4};function Be(x,$,J,ge,Le){ft($,ge,Le,x,J,7);let it=Number($&BigInt(4294967295));x[J++]=it,it=it>>8,x[J++]=it,it=it>>8,x[J++]=it,it=it>>8,x[J++]=it;let bt=Number($>>BigInt(32)&BigInt(4294967295));return x[J++]=bt,bt=bt>>8,x[J++]=bt,bt=bt>>8,x[J++]=bt,bt=bt>>8,x[J++]=bt,J}function nt(x,$,J,ge,Le){ft($,ge,Le,x,J,7);let it=Number($&BigInt(4294967295));x[J+7]=it,it=it>>8,x[J+6]=it,it=it>>8,x[J+5]=it,it=it>>8,x[J+4]=it;let bt=Number($>>BigInt(32)&BigInt(4294967295));return x[J+3]=bt,bt=bt>>8,x[J+2]=bt,bt=bt>>8,x[J+1]=bt,bt=bt>>8,x[J]=bt,J+8}o.prototype.writeBigUInt64LE=sr(function(x,$=0){return Be(this,x,$,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=sr(function(x,$=0){return nt(this,x,$,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(x,$,J,ge){if(x=+x,$=$>>>0,!ge){let Kt=Math.pow(2,8*J-1);$e(this,x,$,J,Kt-1,-Kt)}let Le=0,it=1,bt=0;for(this[$]=x&255;++Le<J&&(it*=256);)x<0&&bt===0&&this[$+Le-1]!==0&&(bt=1),this[$+Le]=(x/it>>0)-bt&255;return $+J},o.prototype.writeIntBE=function(x,$,J,ge){if(x=+x,$=$>>>0,!ge){let Kt=Math.pow(2,8*J-1);$e(this,x,$,J,Kt-1,-Kt)}let Le=J-1,it=1,bt=0;for(this[$+Le]=x&255;--Le>=0&&(it*=256);)x<0&&bt===0&&this[$+Le+1]!==0&&(bt=1),this[$+Le]=(x/it>>0)-bt&255;return $+J},o.prototype.writeInt8=function(x,$,J){return x=+x,$=$>>>0,J||$e(this,x,$,1,127,-128),x<0&&(x=255+x+1),this[$]=x&255,$+1},o.prototype.writeInt16LE=function(x,$,J){return x=+x,$=$>>>0,J||$e(this,x,$,2,32767,-32768),this[$]=x&255,this[$+1]=x>>>8,$+2},o.prototype.writeInt16BE=function(x,$,J){return x=+x,$=$>>>0,J||$e(this,x,$,2,32767,-32768),this[$]=x>>>8,this[$+1]=x&255,$+2},o.prototype.writeInt32LE=function(x,$,J){return x=+x,$=$>>>0,J||$e(this,x,$,4,2147483647,-2147483648),this[$]=x&255,this[$+1]=x>>>8,this[$+2]=x>>>16,this[$+3]=x>>>24,$+4},o.prototype.writeInt32BE=function(x,$,J){return x=+x,$=$>>>0,J||$e(this,x,$,4,2147483647,-2147483648),x<0&&(x=4294967295+x+1),this[$]=x>>>24,this[$+1]=x>>>16,this[$+2]=x>>>8,this[$+3]=x&255,$+4},o.prototype.writeBigInt64LE=sr(function(x,$=0){return Be(this,x,$,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=sr(function(x,$=0){return nt(this,x,$,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ve(x,$,J,ge,Le,it){if(J+ge>x.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function et(x,$,J,ge,Le){return $=+$,J=J>>>0,Le||Ve(x,$,J,4,34028234663852886e22,-34028234663852886e22),r.write(x,$,J,ge,23,4),J+4}o.prototype.writeFloatLE=function(x,$,J){return et(this,x,$,!0,J)},o.prototype.writeFloatBE=function(x,$,J){return et(this,x,$,!1,J)};function ht(x,$,J,ge,Le){return $=+$,J=J>>>0,Le||Ve(x,$,J,8,17976931348623157e292,-17976931348623157e292),r.write(x,$,J,ge,52,8),J+8}o.prototype.writeDoubleLE=function(x,$,J){return ht(this,x,$,!0,J)},o.prototype.writeDoubleBE=function(x,$,J){return ht(this,x,$,!1,J)},o.prototype.copy=function(x,$,J,ge){if(!o.isBuffer(x))throw new TypeError("argument should be a Buffer");if(J||(J=0),!ge&&ge!==0&&(ge=this.length),$>=x.length&&($=x.length),$||($=0),ge>0&&ge<J&&(ge=J),ge===J||x.length===0||this.length===0)return 0;if($<0)throw new RangeError("targetStart out of bounds");if(J<0||J>=this.length)throw new RangeError("Index out of range");if(ge<0)throw new RangeError("sourceEnd out of bounds");ge>this.length&&(ge=this.length),x.length-$<ge-J&&(ge=x.length-$+J);let Le=ge-J;return this===x&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin($,J,ge):Uint8Array.prototype.set.call(x,this.subarray(J,ge),$),Le},o.prototype.fill=function(x,$,J,ge){if(typeof x=="string"){if(typeof $=="string"?(ge=$,$=0,J=this.length):typeof J=="string"&&(ge=J,J=this.length),ge!==void 0&&typeof ge!="string")throw new TypeError("encoding must be a string");if(typeof ge=="string"&&!o.isEncoding(ge))throw new TypeError("Unknown encoding: "+ge);if(x.length===1){let it=x.charCodeAt(0);(ge==="utf8"&&it<128||ge==="latin1")&&(x=it)}}else typeof x=="number"?x=x&255:typeof x=="boolean"&&(x=Number(x));if($<0||this.length<$||this.length<J)throw new RangeError("Out of range index");if(J<=$)return this;$=$>>>0,J=J===void 0?this.length:J>>>0,x||(x=0);let Le;if(typeof x=="number")for(Le=$;Le<J;++Le)this[Le]=x;else{let it=o.isBuffer(x)?x:o.from(x,ge),bt=it.length;if(bt===0)throw new TypeError('The value "'+x+'" is invalid for argument "value"');for(Le=0;Le<J-$;++Le)this[Le+$]=it[Le%bt]}return this};var Z={};function le(x,$,J){Z[x]=class extends J{constructor(){super(),Object.defineProperty(this,"message",{value:$.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${x}]`,this.stack,delete this.name}get code(){return x}set code(ge){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ge,writable:!0})}toString(){return`${this.name} [${x}]: ${this.message}`}}}le("ERR_BUFFER_OUT_OF_BOUNDS",function(x){return x?`${x} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),le("ERR_INVALID_ARG_TYPE",function(x,$){return`The "${x}" argument must be of type number. Received type ${typeof $}`},TypeError),le("ERR_OUT_OF_RANGE",function(x,$,J){let ge=`The value of "${x}" is out of range.`,Le=J;return Number.isInteger(J)&&Math.abs(J)>2**32?Le=ke(String(J)):typeof J=="bigint"&&(Le=String(J),(J>BigInt(2)**BigInt(32)||J<-(BigInt(2)**BigInt(32)))&&(Le=ke(Le)),Le+="n"),ge+=` It must be ${$}. Received ${Le}`,ge},RangeError);function ke(x){let $="",J=x.length,ge=x[0]==="-"?1:0;for(;J>=ge+4;J-=3)$=`_${x.slice(J-3,J)}${$}`;return`${x.slice(0,J)}${$}`}function Ge(x,$,J){yt($,"offset"),(x[$]===void 0||x[$+J]===void 0)&&V($,x.length-(J+1))}function ft(x,$,J,ge,Le,it){if(x>J||x<$){let bt=typeof $=="bigint"?"n":"",Kt;throw it>3?$===0||$===BigInt(0)?Kt=`>= 0${bt} and < 2${bt} ** ${(it+1)*8}${bt}`:Kt=`>= -(2${bt} ** ${(it+1)*8-1}${bt}) and < 2 ** ${(it+1)*8-1}${bt}`:Kt=`>= ${$}${bt} and <= ${J}${bt}`,new Z.ERR_OUT_OF_RANGE("value",Kt,x)}Ge(ge,Le,it)}function yt(x,$){if(typeof x!="number")throw new Z.ERR_INVALID_ARG_TYPE($,"number",x)}function V(x,$,J){throw Math.floor(x)!==x?(yt(x,J),new Z.ERR_OUT_OF_RANGE(J||"offset","an integer",x)):$<0?new Z.ERR_BUFFER_OUT_OF_BOUNDS:new Z.ERR_OUT_OF_RANGE(J||"offset",`>= ${J?1:0} and <= ${$}`,x)}var z=/[^+/0-9A-Za-z-_]/g;function Oe(x){if(x=x.split("=")[0],x=x.trim().replace(z,""),x.length<2)return"";for(;x.length%4!==0;)x=x+"=";return x}function tt(x,$){$=$||1/0;let J,ge=x.length,Le=null,it=[];for(let bt=0;bt<ge;++bt){if(J=x.charCodeAt(bt),J>55295&&J<57344){if(!Le){if(J>56319){($-=3)>-1&&it.push(239,191,189);continue}else if(bt+1===ge){($-=3)>-1&&it.push(239,191,189);continue}Le=J;continue}if(J<56320){($-=3)>-1&&it.push(239,191,189),Le=J;continue}J=(Le-55296<<10|J-56320)+65536}else Le&&($-=3)>-1&&it.push(239,191,189);if(Le=null,J<128){if(($-=1)<0)break;it.push(J)}else if(J<2048){if(($-=2)<0)break;it.push(J>>6|192,J&63|128)}else if(J<65536){if(($-=3)<0)break;it.push(J>>12|224,J>>6&63|128,J&63|128)}else if(J<1114112){if(($-=4)<0)break;it.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw new Error("Invalid code point")}return it}function Ft(x){let $=[];for(let J=0;J<x.length;++J)$.push(x.charCodeAt(J)&255);return $}function Dt(x,$){let J,ge,Le,it=[];for(let bt=0;bt<x.length&&!(($-=2)<0);++bt)J=x.charCodeAt(bt),ge=J>>8,Le=J%256,it.push(Le),it.push(ge);return it}function Lt(x){return t.toByteArray(Oe(x))}function $t(x,$,J,ge){let Le;for(Le=0;Le<ge&&!(Le+J>=$.length||Le>=x.length);++Le)$[Le+J]=x[Le];return Le}function Wt(x,$){return x instanceof $||x!=null&&x.constructor!=null&&x.constructor.name!=null&&x.constructor.name===$.name}function lr(x){return x!==x}var Cr=function(){let x="0123456789abcdef",$=new Array(256);for(let J=0;J<16;++J){let ge=J*16;for(let Le=0;Le<16;++Le)$[ge+Le]=x[J]+x[Le]}return $}();function sr(x){return typeof BigInt>"u"?Sr:x}function Sr(){throw new Error("BigInt not supported")}}),jN=A((e,t)=>{c();var r=t.exports={},n,i;function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?n=setTimeout:n=s}catch{n=s}try{typeof clearTimeout=="function"?i=clearTimeout:i=a}catch{i=a}})();function o(b){if(n===setTimeout)return setTimeout(b,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(b,0);try{return n(b,0)}catch{try{return n.call(null,b,0)}catch{return n.call(this,b,0)}}}function l(b){if(i===clearTimeout)return clearTimeout(b);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(b);try{return i(b)}catch{try{return i.call(null,b)}catch{return i.call(this,b)}}}var u=[],h=!1,f,y=-1;function p(){!h||!f||(h=!1,f.length?u=f.concat(u):y=-1,u.length&&v())}function v(){if(!h){var b=o(p);h=!0;for(var _=u.length;_;){for(f=u,u=[];++y<_;)f&&f[y].run();y=-1,_=u.length}f=null,h=!1,l(b)}}r.nextTick=function(b){var _=new Array(arguments.length-1);if(arguments.length>1)for(var m=1;m<arguments.length;m++)_[m-1]=arguments[m];u.push(new d(b,_)),u.length===1&&!h&&o(v)};function d(b,_){this.fun=b,this.array=_}d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function g(){}r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(b){return[]},r.binding=function(b){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(b){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}),Buffer,process,c=Fe(()=>{({Buffer}=_i()),process=jN()}),V7=A((e,t)=>{"use strict";c(),t.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let n=Object.getPrototypeOf(r);return n===null||n===Object.prototype}}),z7=A((e,t)=>{"use strict";c();var r=V7(),{hasOwnProperty:n}=Object.prototype,{propertyIsEnumerable:i}=Object,s=(d,g,b)=>Object.defineProperty(d,g,{value:b,writable:!0,enumerable:!0,configurable:!0}),a=e,o={concatArrays:!1,ignoreUndefined:!1},l=d=>{let g=[];for(let b in d)n.call(d,b)&&g.push(b);if(Object.getOwnPropertySymbols){let b=Object.getOwnPropertySymbols(d);for(let _ of b)i.call(d,_)&&g.push(_)}return g};function u(d){return Array.isArray(d)?h(d):r(d)?f(d):d}function h(d){let g=d.slice(0,0);return l(d).forEach(b=>{s(g,b,u(d[b]))}),g}function f(d){let g=Object.getPrototypeOf(d)===null?Object.create(null):{};return l(d).forEach(b=>{s(g,b,u(d[b]))}),g}var y=(d,g,b,_)=>(b.forEach(m=>{typeof g[m]>"u"&&_.ignoreUndefined||(m in d&&d[m]!==Object.getPrototypeOf(d)?s(d,m,v(d[m],g[m],_)):s(d,m,u(g[m])))}),d),p=(d,g,b)=>{let _=d.slice(0,0),m=0;return[d,g].forEach(E=>{let D=[];for(let N=0;N<E.length;N++)!n.call(E,N)||(D.push(String(N)),E===d?s(_,m++,E[N]):s(_,m++,u(E[N])));_=y(_,E,l(E).filter(N=>!D.includes(N)),b)}),_};function v(d,g,b){return b.concatArrays&&Array.isArray(d)&&Array.isArray(g)?p(d,g,b):!r(g)||!r(d)?u(g):y(d,g,l(g),b)}t.exports=function(...d){let g=v(u(o),this!==a&&this||{},o),b={_:{}};for(let _ of d)if(_!==void 0){if(!r(_))throw new TypeError("`"+_+"` is not an Option Object");b=v(b,{_},g)}return b._}}),H7=A((e,t)=>{c();function r(){return typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}t.exports=r}),$7=A((e,t)=>{"use strict";c();var r=H7(),n=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,i=r(),s=n&&!i,a=i&&!n,o=i&&n,l=typeof jd=="function"&&typeof process<"u"&&typeof process.release<"u"&&process.release.name==="node"&&!i,u=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,h=typeof process<"u"&&typeof process.env<"u"&&!1,f=typeof navigator<"u"&&navigator.product==="ReactNative";t.exports={isTest:h,isElectron:i,isElectronMain:a,isElectronRenderer:o,isNode:l,isBrowser:s,isWebWorker:u,isEnvWithDom:n,isReactNative:f}}),G7=A((e,t)=>{c();var r=1e3,n=r*60,i=n*60,s=i*24,a=s*7,o=s*365.25;t.exports=function(y,p){p=p||{};var v=typeof y;if(v==="string"&&y.length>0)return l(y);if(v==="number"&&isFinite(y))return p.long?h(y):u(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))};function l(y){if(y=String(y),!(y.length>100)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(p){var v=parseFloat(p[1]),d=(p[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return v*o;case"weeks":case"week":case"w":return v*a;case"days":case"day":case"d":return v*s;case"hours":case"hour":case"hrs":case"hr":case"h":return v*i;case"minutes":case"minute":case"mins":case"min":case"m":return v*n;case"seconds":case"second":case"secs":case"sec":case"s":return v*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return v;default:return}}}}function u(y){var p=Math.abs(y);return p>=s?Math.round(y/s)+"d":p>=i?Math.round(y/i)+"h":p>=n?Math.round(y/n)+"m":p>=r?Math.round(y/r)+"s":y+"ms"}function h(y){var p=Math.abs(y);return p>=s?f(y,p,s,"day"):p>=i?f(y,p,i,"hour"):p>=n?f(y,p,n,"minute"):p>=r?f(y,p,r,"second"):y+" ms"}function f(y,p,v,d){var g=p>=v*1.5;return Math.round(y/v)+" "+d+(g?"s":"")}}),sO=A((e,t)=>{c();function r(n){s.debug=s,s.default=s,s.coerce=f,s.disable=l,s.enable=o,s.enabled=u,s.humanize=G7(),s.destroy=y,Object.keys(n).forEach(p=>{s[p]=n[p]}),s.names=[],s.skips=[],s.formatters={};function i(p){let v=0;for(let d=0;d<p.length;d++)v=(v<<5)-v+p.charCodeAt(d),v|=0;return s.colors[Math.abs(v)%s.colors.length]}s.selectColor=i;function s(p){let v,d=null,g,b;function _(...m){if(!_.enabled)return;let E=_,D=Number(new Date),N=D-(v||D);E.diff=N,E.prev=v,E.curr=D,v=D,m[0]=s.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let R=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(T,S)=>{if(T==="%%")return"%";R++;let O=s.formatters[S];if(typeof O=="function"){let F=m[R];T=O.call(E,F),m.splice(R,1),R--}return T}),s.formatArgs.call(E,m),(E.log||s.log).apply(E,m)}return _.namespace=p,_.useColors=s.useColors(),_.color=s.selectColor(p),_.extend=a,_.destroy=s.destroy,Object.defineProperty(_,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(g!==s.namespaces&&(g=s.namespaces,b=s.enabled(p)),b),set:m=>{d=m}}),typeof s.init=="function"&&s.init(_),_}function a(p,v){let d=s(this.namespace+(typeof v>"u"?":":v)+p);return d.log=this.log,d}function o(p){s.save(p),s.namespaces=p,s.names=[],s.skips=[];let v,d=(typeof p=="string"?p:"").split(/[\s,]+/),g=d.length;for(v=0;v<g;v++)!d[v]||(p=d[v].replace(/\*/g,".*?"),p[0]==="-"?s.skips.push(new RegExp("^"+p.slice(1)+"$")):s.names.push(new RegExp("^"+p+"$")))}function l(){let p=[...s.names.map(h),...s.skips.map(h).map(v=>"-"+v)].join(",");return s.enable(""),p}function u(p){if(p[p.length-1]==="*")return!0;let v,d;for(v=0,d=s.skips.length;v<d;v++)if(s.skips[v].test(p))return!1;for(v=0,d=s.names.length;v<d;v++)if(s.names[v].test(p))return!0;return!1}function h(p){return p.toString().substring(2,p.toString().length-2).replace(/\.\*\?$/,"*")}function f(p){return p instanceof Error?p.stack||p.message:p}function y(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return s.enable(s.load()),s}t.exports=r}),Mi=A((e,t)=>{c(),e.formatArgs=n,e.save=i,e.load=s,e.useColors=r,e.storage=a(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;let u="color: "+this.color;l.splice(1,0,u,"color: inherit");let h=0,f=0;l[0].replace(/%[a-zA-Z%]/g,y=>{y!=="%%"&&(h++,y==="%c"&&(f=h))}),l.splice(f,0,u)}e.log=console.debug||console.log||(()=>{});function i(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function s(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=process.env.DEBUG),l}function a(){try{return localStorage}catch{}}t.exports=sO()(e);var{formatters:o}=t.exports;o.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}});function p0e(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var o=e.length,l=e.charAt(0),u=Math.log(o)/Math.log(256),h=Math.log(256)/Math.log(o);function f(v){if(v instanceof Uint8Array||(ArrayBuffer.isView(v)?v=new Uint8Array(v.buffer,v.byteOffset,v.byteLength):Array.isArray(v)&&(v=Uint8Array.from(v))),!(v instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(v.length===0)return"";for(var d=0,g=0,b=0,_=v.length;b!==_&&v[b]===0;)b++,d++;for(var m=(_-b)*h+1>>>0,E=new Uint8Array(m);b!==_;){for(var D=v[b],N=0,R=m-1;(D!==0||N<g)&&R!==-1;R--,N++)D+=256*E[R]>>>0,E[R]=D%o>>>0,D=D/o>>>0;if(D!==0)throw new Error("Non-zero carry");g=N,b++}for(var T=m-g;T!==m&&E[T]===0;)T++;for(var S=l.repeat(d);T<m;++T)S+=e.charAt(E[T]);return S}function y(v){if(typeof v!="string")throw new TypeError("Expected String");if(v.length===0)return new Uint8Array;var d=0;if(v[d]!==" "){for(var g=0,b=0;v[d]===l;)g++,d++;for(var _=(v.length-d)*u+1>>>0,m=new Uint8Array(_);v[d];){var E=r[v.charCodeAt(d)];if(E===255)return;for(var D=0,N=_-1;(E!==0||D<b)&&N!==-1;N--,D++)E+=o*m[N]>>>0,m[N]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");b=D,d++}if(v[d]!==" "){for(var R=_-b;R!==_&&m[R]===0;)R++;for(var T=new Uint8Array(g+(_-R)),S=g;R!==_;)T[S++]=m[R++];return T}}}function p(v){var d=y(v);if(d)return d;throw new Error(`Non-${t} character`)}return{encode:f,decodeUnsafe:y,decode:p}}var m0e,y0e,aO,cO=Fe(()=>{c(),m0e=p0e,y0e=m0e,aO=y0e}),op={};ct(op,{coerce:()=>Uo,empty:()=>uO,equals:()=>W7,fromHex:()=>w0e,fromString:()=>j7,isBinary:()=>E0e,toHex:()=>g0e,toString:()=>Y7});var uO,g0e,w0e,W7,Uo,E0e,j7,Y7,Mu=Fe(()=>{c(),uO=new Uint8Array(0),g0e=e=>e.reduce((t,r)=>t+r.toString(16).padStart(2,"0"),""),w0e=e=>{let t=e.match(/../g);return t?new Uint8Array(t.map(r=>parseInt(r,16))):uO},W7=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Uo=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},E0e=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),j7=e=>new TextEncoder().encode(e),Y7=e=>new TextDecoder().decode(e)}),Q7,X7,Z7,lO,J7,sp,Uu,b0e,_0e,zr,_s=Fe(()=>{c(),cO(),Mu(),Q7=class{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},X7=class{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return lO(this,e)}},Z7=class{constructor(e){this.decoders=e}or(e){return lO(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},lO=(e,t)=>new Z7({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),J7=class{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Q7(e,t,r),this.decoder=new X7(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},sp=({name:e,prefix:t,encode:r,decode:n})=>new J7(e,t,r,n),Uu=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=aO(r,t);return sp({prefix:e,name:t,encode:n,decode:s=>Uo(i(s))})},b0e=(e,t,r,n)=>{let i={};for(let h=0;h<t.length;++h)i[t[h]]=h;let s=e.length;for(;e[s-1]==="=";)--s;let a=new Uint8Array(s*r/8|0),o=0,l=0,u=0;for(let h=0;h<s;++h){let f=i[e[h]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);l=l<<r|f,o+=r,o>=8&&(o-=8,a[u++]=255&l>>o)}if(o>=r||255&l<<8-o)throw new SyntaxError("Unexpected end of data");return a},_0e=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,s="",a=0,o=0;for(let l=0;l<e.length;++l)for(o=o<<8|e[l],a+=8;a>r;)a-=r,s+=t[i&o>>a];if(a&&(s+=t[i&o<<r-a]),n)for(;s.length*r&7;)s+="=";return s},zr=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>sp({prefix:t,name:e,encode(i){return _0e(i,n,r)},decode(i){return b0e(i,n,r,e)}})}),ap={};ct(ap,{base58btc:()=>Ne,base58flickr:()=>v0e});var Ne,v0e,Hr=Fe(()=>{c(),_s(),Ne=Uu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),v0e=Uu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})}),Vm={};ct(Vm,{base32:()=>xt,base32hex:()=>x0e,base32hexpad:()=>A0e,base32hexpadupper:()=>T0e,base32hexupper:()=>R0e,base32pad:()=>t9,base32padupper:()=>S0e,base32upper:()=>e9,base32z:()=>I0e});var xt,e9,t9,S0e,x0e,R0e,A0e,T0e,I0e,si=Fe(()=>{c(),_s(),xt=zr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),e9=zr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),t9=zr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),S0e=zr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),x0e=zr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),R0e=zr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),A0e=zr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),T0e=zr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),I0e=zr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),N4={};ct(N4,{base64:()=>to,base64pad:()=>C0e,base64url:()=>qm,base64urlpad:()=>P0e});var to,C0e,qm,P0e,ma=Fe(()=>{c(),_s(),to=zr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),C0e=zr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),qm=zr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),P0e=zr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})}),K=A((e,t)=>{"use strict";c();function r(i,s){for(let a in s)Object.defineProperty(i,a,{value:s[a],enumerable:!0,configurable:!0});return i}function n(i,s,a){if(!i||typeof i=="string")throw new TypeError("Please pass an Error to err-code");a||(a={}),typeof s=="object"&&(a=s,s=""),s&&(a.code=s);try{return r(i,a)}catch{a.message=i.message,a.stack=i.stack;let o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(i)),r(new o,a)}}t.exports=n}),pO=A((e,t)=>{"use strict";c(),t.exports=r;function r(n,i){for(var s=new Array(arguments.length-1),a=0,o=2,l=!0;o<arguments.length;)s[a++]=arguments[o++];return new Promise(function(u,h){s[a]=function(f){if(l)if(l=!1,f)h(f);else{for(var y=new Array(arguments.length-1),p=0;p<y.length;)y[p++]=arguments[p];u.apply(null,y)}};try{n.apply(i||null,s)}catch(f){l&&(l=!1,h(f))}})}}),wO=A(e=>{"use strict";c();var t=e;t.length=function(a){var o=a.length;if(!o)return 0;for(var l=0;--o%4>1&&a.charAt(o)==="=";)++l;return Math.ceil(a.length*3)/4-l};var r=new Array(64),n=new Array(123);for(i=0;i<64;)n[r[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;var i;t.encode=function(a,o,l){for(var u=null,h=[],f=0,y=0,p;o<l;){var v=a[o++];switch(y){case 0:h[f++]=r[v>>2],p=(v&3)<<4,y=1;break;case 1:h[f++]=r[p|v>>4],p=(v&15)<<2,y=2;break;case 2:h[f++]=r[p|v>>6],h[f++]=r[v&63],y=0;break}f>8191&&((u||(u=[])).push(String.fromCharCode.apply(String,h)),f=0)}return y&&(h[f++]=r[p],h[f++]=61,y===1&&(h[f++]=61)),u?(f&&u.push(String.fromCharCode.apply(String,h.slice(0,f))),u.join("")):String.fromCharCode.apply(String,h.slice(0,f))};var s="invalid encoding";t.decode=function(a,o,l){for(var u=l,h=0,f,y=0;y<a.length;){var p=a.charCodeAt(y++);if(p===61&&h>1)break;if((p=n[p])===void 0)throw Error(s);switch(h){case 0:f=p,h=1;break;case 1:o[l++]=f<<2|(p&48)>>4,f=p,h=2;break;case 2:o[l++]=(f&15)<<4|(p&60)>>2,f=p,h=3;break;case 3:o[l++]=(f&3)<<6|p,h=0;break}}if(h===1)throw Error(s);return l-u},t.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)}}),bO=A((e,t)=>{"use strict";c(),t.exports=r;function r(){this._listeners={}}r.prototype.on=function(n,i,s){return(this._listeners[n]||(this._listeners[n]=[])).push({fn:i,ctx:s||this}),this},r.prototype.off=function(n,i){if(n===void 0)this._listeners={};else if(i===void 0)this._listeners[n]=[];else for(var s=this._listeners[n],a=0;a<s.length;)s[a].fn===i?s.splice(a,1):++a;return this},r.prototype.emit=function(n){var i=this._listeners[n];if(i){for(var s=[],a=1;a<arguments.length;)s.push(arguments[a++]);for(a=0;a<i.length;)i[a].fn.apply(i[a++].ctx,s)}return this}}),TO=A((e,t)=>{"use strict";c(),t.exports=r(r);function r(o){return typeof Float32Array<"u"?function(){var l=new Float32Array([-0]),u=new Uint8Array(l.buffer),h=u[3]===128;function f(d,g,b){l[0]=d,g[b]=u[0],g[b+1]=u[1],g[b+2]=u[2],g[b+3]=u[3]}function y(d,g,b){l[0]=d,g[b]=u[3],g[b+1]=u[2],g[b+2]=u[1],g[b+3]=u[0]}o.writeFloatLE=h?f:y,o.writeFloatBE=h?y:f;function p(d,g){return u[0]=d[g],u[1]=d[g+1],u[2]=d[g+2],u[3]=d[g+3],l[0]}function v(d,g){return u[3]=d[g],u[2]=d[g+1],u[1]=d[g+2],u[0]=d[g+3],l[0]}o.readFloatLE=h?p:v,o.readFloatBE=h?v:p}():function(){function l(h,f,y,p){var v=f<0?1:0;if(v&&(f=-f),f===0)h(1/f>0?0:2147483648,y,p);else if(isNaN(f))h(2143289344,y,p);else if(f>34028234663852886e22)h((v<<31|2139095040)>>>0,y,p);else if(f<11754943508222875e-54)h((v<<31|Math.round(f/1401298464324817e-60))>>>0,y,p);else{var d=Math.floor(Math.log(f)/Math.LN2),g=Math.round(f*Math.pow(2,-d)*8388608)&8388607;h((v<<31|d+127<<23|g)>>>0,y,p)}}o.writeFloatLE=l.bind(null,n),o.writeFloatBE=l.bind(null,i);function u(h,f,y){var p=h(f,y),v=(p>>31)*2+1,d=p>>>23&255,g=p&8388607;return d===255?g?NaN:v*(1/0):d===0?v*1401298464324817e-60*g:v*Math.pow(2,d-150)*(g+8388608)}o.readFloatLE=u.bind(null,s),o.readFloatBE=u.bind(null,a)}(),typeof Float64Array<"u"?function(){var l=new Float64Array([-0]),u=new Uint8Array(l.buffer),h=u[7]===128;function f(d,g,b){l[0]=d,g[b]=u[0],g[b+1]=u[1],g[b+2]=u[2],g[b+3]=u[3],g[b+4]=u[4],g[b+5]=u[5],g[b+6]=u[6],g[b+7]=u[7]}function y(d,g,b){l[0]=d,g[b]=u[7],g[b+1]=u[6],g[b+2]=u[5],g[b+3]=u[4],g[b+4]=u[3],g[b+5]=u[2],g[b+6]=u[1],g[b+7]=u[0]}o.writeDoubleLE=h?f:y,o.writeDoubleBE=h?y:f;function p(d,g){return u[0]=d[g],u[1]=d[g+1],u[2]=d[g+2],u[3]=d[g+3],u[4]=d[g+4],u[5]=d[g+5],u[6]=d[g+6],u[7]=d[g+7],l[0]}function v(d,g){return u[7]=d[g],u[6]=d[g+1],u[5]=d[g+2],u[4]=d[g+3],u[3]=d[g+4],u[2]=d[g+5],u[1]=d[g+6],u[0]=d[g+7],l[0]}o.readDoubleLE=h?p:v,o.readDoubleBE=h?v:p}():function(){function l(h,f,y,p,v,d){var g=p<0?1:0;if(g&&(p=-p),p===0)h(0,v,d+f),h(1/p>0?0:2147483648,v,d+y);else if(isNaN(p))h(0,v,d+f),h(2146959360,v,d+y);else if(p>17976931348623157e292)h(0,v,d+f),h((g<<31|2146435072)>>>0,v,d+y);else{var b;if(p<22250738585072014e-324)b=p/5e-324,h(b>>>0,v,d+f),h((g<<31|b/4294967296)>>>0,v,d+y);else{var _=Math.floor(Math.log(p)/Math.LN2);_===1024&&(_=1023),b=p*Math.pow(2,-_),h(b*4503599627370496>>>0,v,d+f),h((g<<31|_+1023<<20|b*1048576&1048575)>>>0,v,d+y)}}}o.writeDoubleLE=l.bind(null,n,0,4),o.writeDoubleBE=l.bind(null,i,4,0);function u(h,f,y,p,v){var d=h(p,v+f),g=h(p,v+y),b=(g>>31)*2+1,_=g>>>20&2047,m=4294967296*(g&1048575)+d;return _===2047?m?NaN:b*(1/0):_===0?b*5e-324*m:b*Math.pow(2,_-1075)*(m+4503599627370496)}o.readDoubleLE=u.bind(null,s,0,4),o.readDoubleBE=u.bind(null,a,4,0)}(),o}function n(o,l,u){l[u]=o&255,l[u+1]=o>>>8&255,l[u+2]=o>>>16&255,l[u+3]=o>>>24}function i(o,l,u){l[u]=o>>>24,l[u+1]=o>>>16&255,l[u+2]=o>>>8&255,l[u+3]=o&255}function s(o,l){return(o[l]|o[l+1]<<8|o[l+2]<<16|o[l+3]<<24)>>>0}function a(o,l){return(o[l]<<24|o[l+1]<<16|o[l+2]<<8|o[l+3])>>>0}}),IO=A((exports,module)=>{"use strict";c(),module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}}),PO=A(e=>{"use strict";c();var t=e;t.length=function(r){for(var n=0,i=0,s=0;s<r.length;++s)i=r.charCodeAt(s),i<128?n+=1:i<2048?n+=2:(i&64512)===55296&&(r.charCodeAt(s+1)&64512)===56320?(++s,n+=4):n+=3;return n},t.read=function(r,n,i){var s=i-n;if(s<1)return"";for(var a=null,o=[],l=0,u;n<i;)u=r[n++],u<128?o[l++]=u:u>191&&u<224?o[l++]=(u&31)<<6|r[n++]&63:u>239&&u<365?(u=((u&7)<<18|(r[n++]&63)<<12|(r[n++]&63)<<6|r[n++]&63)-65536,o[l++]=55296+(u>>10),o[l++]=56320+(u&1023)):o[l++]=(u&15)<<12|(r[n++]&63)<<6|r[n++]&63,l>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,o)),l=0);return a?(l&&a.push(String.fromCharCode.apply(String,o.slice(0,l))),a.join("")):String.fromCharCode.apply(String,o.slice(0,l))},t.write=function(r,n,i){for(var s=i,a,o,l=0;l<r.length;++l)a=r.charCodeAt(l),a<128?n[i++]=a:a<2048?(n[i++]=a>>6|192,n[i++]=a&63|128):(a&64512)===55296&&((o=r.charCodeAt(l+1))&64512)===56320?(a=65536+((a&1023)<<10)+(o&1023),++l,n[i++]=a>>18|240,n[i++]=a>>12&63|128,n[i++]=a>>6&63|128,n[i++]=a&63|128):(n[i++]=a>>12|224,n[i++]=a>>6&63|128,n[i++]=a&63|128);return i-s}}),kO=A((e,t)=>{"use strict";c(),t.exports=r;function r(n,i,s){var a=s||8192,o=a>>>1,l=null,u=a;return function(h){if(h<1||h>o)return n(h);u+h>a&&(l=n(a),u=0);var f=i.call(l,u,u+=h);return u&7&&(u=(u|7)+1),f}}}),OO=A((e,t)=>{"use strict";c(),t.exports=n;var r=Ku();function n(o,l){this.lo=o>>>0,this.hi=l>>>0}var i=n.zero=new n(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var s=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(o){if(o===0)return i;var l=o<0;l&&(o=-o);var u=o>>>0,h=(o-u)/4294967296>>>0;return l&&(h=~h>>>0,u=~u>>>0,++u>4294967295&&(u=0,++h>4294967295&&(h=0))),new n(u,h)},n.from=function(o){if(typeof o=="number")return n.fromNumber(o);if(r.isString(o))if(r.Long)o=r.Long.fromString(o);else return n.fromNumber(parseInt(o,10));return o.low||o.high?new n(o.low>>>0,o.high>>>0):i},n.prototype.toNumber=function(o){if(!o&&this.hi>>>31){var l=~this.lo+1>>>0,u=~this.hi>>>0;return l||(u=u+1>>>0),-(l+u*4294967296)}return this.lo+this.hi*4294967296},n.prototype.toLong=function(o){return r.Long?new r.Long(this.lo|0,this.hi|0,Boolean(o)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(o)}};var a=String.prototype.charCodeAt;n.fromHash=function(o){return o===s?i:new n((a.call(o,0)|a.call(o,1)<<8|a.call(o,2)<<16|a.call(o,3)<<24)>>>0,(a.call(o,4)|a.call(o,5)<<8|a.call(o,6)<<16|a.call(o,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var o=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^o)>>>0,this.lo=(this.lo<<1^o)>>>0,this},n.prototype.zzDecode=function(){var o=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^o)>>>0,this.hi=(this.hi>>>1^o)>>>0,this},n.prototype.length=function(){var o=this.lo,l=(this.lo>>>28|this.hi<<4)>>>0,u=this.hi>>>24;return u===0?l===0?o<16384?o<128?1:2:o<2097152?3:4:l<16384?l<128?5:6:l<2097152?7:8:u<128?9:10}}),Ku=A(e=>{"use strict";c();var t=e;t.asPromise=pO(),t.base64=wO(),t.EventEmitter=bO(),t.float=TO(),t.inquire=IO(),t.utf8=PO(),t.pool=kO(),t.LongBits=OO(),t.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node),t.global=t.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||e,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(i){return typeof i=="number"&&isFinite(i)&&Math.floor(i)===i},t.isString=function(i){return typeof i=="string"||i instanceof String},t.isObject=function(i){return i&&typeof i=="object"},t.isset=t.isSet=function(i,s){var a=i[s];return a!=null&&i.hasOwnProperty(s)?typeof a!="object"||(Array.isArray(a)?a.length:Object.keys(a).length)>0:!1},t.Buffer=function(){try{var i=t.inquire("buffer").Buffer;return i.prototype.utf8Write?i:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(i){return typeof i=="number"?t.Buffer?t._Buffer_allocUnsafe(i):new t.Array(i):t.Buffer?t._Buffer_from(i):typeof Uint8Array>"u"?i:new Uint8Array(i)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(i){return i?t.LongBits.from(i).toHash():t.LongBits.zeroHash},t.longFromHash=function(i,s){var a=t.LongBits.fromHash(i);return t.Long?t.Long.fromBits(a.lo,a.hi,s):a.toNumber(Boolean(s))};function r(i,s,a){for(var o=Object.keys(s),l=0;l<o.length;++l)(i[o[l]]===void 0||!a)&&(i[o[l]]=s[o[l]]);return i}t.merge=r,t.lcFirst=function(i){return i.charAt(0).toLowerCase()+i.substring(1)};function n(i){function s(a,o){if(!(this instanceof s))return new s(a,o);Object.defineProperty(this,"message",{get:function(){return a}}),Error.captureStackTrace?Error.captureStackTrace(this,s):Object.defineProperty(this,"stack",{value:new Error().stack||""}),o&&r(this,o)}return(s.prototype=Object.create(Error.prototype)).constructor=s,Object.defineProperty(s.prototype,"name",{get:function(){return i}}),s.prototype.toString=function(){return this.name+": "+this.message},s}t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(i){for(var s={},a=0;a<i.length;++a)s[i[a]]=1;return function(){for(var o=Object.keys(this),l=o.length-1;l>-1;--l)if(s[o[l]]===1&&this[o[l]]!==void 0&&this[o[l]]!==null)return o[l]}},t.oneOfSetter=function(i){return function(s){for(var a=0;a<i.length;++a)i[a]!==s&&delete this[i[a]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var i=t.Buffer;if(!i){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=i.from!==Uint8Array.from&&i.from||function(s,a){return new i(s,a)},t._Buffer_allocUnsafe=i.allocUnsafe||function(s){return new i(s)}}}),l9=A((e,t)=>{"use strict";c(),t.exports=h;var r=Ku(),n,i=r.LongBits,s=r.base64,a=r.utf8;function o(_,m,E){this.fn=_,this.len=m,this.next=void 0,this.val=E}function l(){}function u(_){this.head=_.head,this.tail=_.tail,this.len=_.len,this.next=_.states}function h(){this.len=0,this.head=new o(l,0,0),this.tail=this.head,this.states=null}var f=function(){return r.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h}};h.create=f(),h.alloc=function(_){return new r.Array(_)},r.Array!==Array&&(h.alloc=r.pool(h.alloc,r.Array.prototype.subarray)),h.prototype._push=function(_,m,E){return this.tail=this.tail.next=new o(_,m,E),this.len+=m,this};function y(_,m,E){m[E]=_&255}function p(_,m,E){for(;_>127;)m[E++]=_&127|128,_>>>=7;m[E]=_}function v(_,m){this.len=_,this.next=void 0,this.val=m}v.prototype=Object.create(o.prototype),v.prototype.fn=p,h.prototype.uint32=function(_){return this.len+=(this.tail=this.tail.next=new v((_=_>>>0)<128?1:_<16384?2:_<2097152?3:_<268435456?4:5,_)).len,this},h.prototype.int32=function(_){return _<0?this._push(d,10,i.fromNumber(_)):this.uint32(_)},h.prototype.sint32=function(_){return this.uint32((_<<1^_>>31)>>>0)};function d(_,m,E){for(;_.hi;)m[E++]=_.lo&127|128,_.lo=(_.lo>>>7|_.hi<<25)>>>0,_.hi>>>=7;for(;_.lo>127;)m[E++]=_.lo&127|128,_.lo=_.lo>>>7;m[E++]=_.lo}h.prototype.uint64=function(_){var m=i.from(_);return this._push(d,m.length(),m)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(_){var m=i.from(_).zzEncode();return this._push(d,m.length(),m)},h.prototype.bool=function(_){return this._push(y,1,_?1:0)};function g(_,m,E){m[E]=_&255,m[E+1]=_>>>8&255,m[E+2]=_>>>16&255,m[E+3]=_>>>24}h.prototype.fixed32=function(_){return this._push(g,4,_>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(_){var m=i.from(_);return this._push(g,4,m.lo)._push(g,4,m.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(_){return this._push(r.float.writeFloatLE,4,_)},h.prototype.double=function(_){return this._push(r.float.writeDoubleLE,8,_)};var b=r.Array.prototype.set?function(_,m,E){m.set(_,E)}:function(_,m,E){for(var D=0;D<_.length;++D)m[E+D]=_[D]};h.prototype.bytes=function(_){var m=_.length>>>0;if(!m)return this._push(y,1,0);if(r.isString(_)){var E=h.alloc(m=s.length(_));s.decode(_,E,0),_=E}return this.uint32(m)._push(b,m,_)},h.prototype.string=function(_){var m=a.length(_);return m?this.uint32(m)._push(a.write,m,_):this._push(y,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new o(l,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new o(l,0,0),this.len=0),this},h.prototype.ldelim=function(){var _=this.head,m=this.tail,E=this.len;return this.reset().uint32(E),E&&(this.tail.next=_.next,this.tail=m,this.len+=E),this},h.prototype.finish=function(){for(var _=this.head.next,m=this.constructor.alloc(this.len),E=0;_;)_.fn(_.val,m,E),E+=_.len,_=_.next;return m},h._configure=function(_){n=_,h.create=f(),n._configure()}}),zO=A((e,t)=>{"use strict";c(),t.exports=i;var r=l9();(i.prototype=Object.create(r.prototype)).constructor=i;var n=Ku();function i(){r.call(this)}i._configure=function(){i.alloc=n._Buffer_allocUnsafe,i.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&n.Buffer.prototype.set.name==="set"?function(a,o,l){o.set(a,l)}:function(a,o,l){if(a.copy)a.copy(o,l,0,a.length);else for(var u=0;u<a.length;)o[l++]=a[u++]}},i.prototype.bytes=function(a){n.isString(a)&&(a=n._Buffer_from(a,"base64"));var o=a.length>>>0;return this.uint32(o),o&&this._push(i.writeBytesBuffer,o,a),this};function s(a,o,l){a.length<40?n.utf8.write(a,o,l):o.utf8Write?o.utf8Write(a,l):o.write(a,l)}i.prototype.string=function(a){var o=n.Buffer.byteLength(a);return this.uint32(o),o&&this._push(s,o,a),this},i._configure()}),d9=A((e,t)=>{"use strict";c(),t.exports=o;var r=Ku(),n,i=r.LongBits,s=r.utf8;function a(p,v){return RangeError("index out of range: "+p.pos+" + "+(v||1)+" > "+p.len)}function o(p){this.buf=p,this.pos=0,this.len=p.length}var l=typeof Uint8Array<"u"?function(p){if(p instanceof Uint8Array||Array.isArray(p))return new o(p);throw Error("illegal buffer")}:function(p){if(Array.isArray(p))return new o(p);throw Error("illegal buffer")},u=function(){return r.Buffer?function(p){return(o.create=function(v){return r.Buffer.isBuffer(v)?new n(v):l(v)})(p)}:l};o.create=u(),o.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,o.prototype.uint32=function(){var p=4294967295;return function(){if(p=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(p=(p|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(p=(p|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(p=(p|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(p=(p|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return p;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return p}}(),o.prototype.int32=function(){return this.uint32()|0},o.prototype.sint32=function(){var p=this.uint32();return p>>>1^-(p&1)|0};function h(){var p=new i(0,0),v=0;if(this.len-this.pos>4){for(;v<4;++v)if(p.lo=(p.lo|(this.buf[this.pos]&127)<<v*7)>>>0,this.buf[this.pos++]<128)return p;if(p.lo=(p.lo|(this.buf[this.pos]&127)<<28)>>>0,p.hi=(p.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return p;v=0}else{for(;v<3;++v){if(this.pos>=this.len)throw a(this);if(p.lo=(p.lo|(this.buf[this.pos]&127)<<v*7)>>>0,this.buf[this.pos++]<128)return p}return p.lo=(p.lo|(this.buf[this.pos++]&127)<<v*7)>>>0,p}if(this.len-this.pos>4){for(;v<5;++v)if(p.hi=(p.hi|(this.buf[this.pos]&127)<<v*7+3)>>>0,this.buf[this.pos++]<128)return p}else for(;v<5;++v){if(this.pos>=this.len)throw a(this);if(p.hi=(p.hi|(this.buf[this.pos]&127)<<v*7+3)>>>0,this.buf[this.pos++]<128)return p}throw Error("invalid varint encoding")}o.prototype.bool=function(){return this.uint32()!==0};function f(p,v){return(p[v-4]|p[v-3]<<8|p[v-2]<<16|p[v-1]<<24)>>>0}o.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},o.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)|0};function y(){if(this.pos+8>this.len)throw a(this,8);return new i(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}o.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var p=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,p},o.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var p=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,p},o.prototype.bytes=function(){var p=this.uint32(),v=this.pos,d=this.pos+p;if(d>this.len)throw a(this,p);return this.pos+=p,Array.isArray(this.buf)?this.buf.slice(v,d):v===d?new this.buf.constructor(0):this._slice.call(this.buf,v,d)},o.prototype.string=function(){var p=this.bytes();return s.read(p,0,p.length)},o.prototype.skip=function(p){if(typeof p=="number"){if(this.pos+p>this.len)throw a(this,p);this.pos+=p}else do if(this.pos>=this.len)throw a(this);while(this.buf[this.pos++]&128);return this},o.prototype.skipType=function(p){switch(p){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(p=this.uint32()&7)!==4;)this.skipType(p);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+p+" at offset "+this.pos)}return this},o._configure=function(p){n=p,o.create=u(),n._configure();var v=r.Long?"toLong":"toNumber";r.merge(o.prototype,{int64:function(){return h.call(this)[v](!1)},uint64:function(){return h.call(this)[v](!0)},sint64:function(){return h.call(this).zzDecode()[v](!1)},fixed64:function(){return y.call(this)[v](!0)},sfixed64:function(){return y.call(this)[v](!1)}})}}),ZO=A((e,t)=>{"use strict";c(),t.exports=i;var r=d9();(i.prototype=Object.create(r.prototype)).constructor=i;var n=Ku();function i(s){r.call(this,s)}i._configure=function(){n.Buffer&&(i.prototype._slice=n.Buffer.prototype.slice)},i.prototype.string=function(){var s=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+s,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+s,this.len))},i._configure()}),eL=A((e,t)=>{"use strict";c(),t.exports=n;var r=Ku();(n.prototype=Object.create(r.EventEmitter.prototype)).constructor=n;function n(i,s,a){if(typeof i!="function")throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=i,this.requestDelimited=Boolean(s),this.responseDelimited=Boolean(a)}n.prototype.rpcCall=function i(s,a,o,l,u){if(!l)throw TypeError("request must be specified");var h=this;if(!u)return r.asPromise(i,h,s,a,o,l);if(!h.rpcImpl){setTimeout(function(){u(Error("already ended"))},0);return}try{return h.rpcImpl(s,a[h.requestDelimited?"encodeDelimited":"encode"](l).finish(),function(f,y){if(f)return h.emit("error",f,s),u(f);if(y===null){h.end(!0);return}if(!(y instanceof o))try{y=o[h.responseDelimited?"decodeDelimited":"decode"](y)}catch(p){return h.emit("error",p,s),u(p)}return h.emit("data",y,s),u(null,y)})}catch(f){h.emit("error",f,s),setTimeout(function(){u(f)},0);return}},n.prototype.end=function(i){return this.rpcImpl&&(i||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}}),rL=A(e=>{"use strict";c();var t=e;t.Service=eL()}),iL=A((e,t)=>{"use strict";c(),t.exports={}}),aL=A(e=>{"use strict";c();var t=e;t.build="minimal",t.Writer=l9(),t.BufferWriter=zO(),t.Reader=d9(),t.BufferReader=ZO(),t.util=Ku(),t.rpc=rL(),t.roots=iL(),t.configure=r;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}r()}),Ea=A((e,t)=>{"use strict";c(),t.exports=aL()});function mL(e,t,r){t=t||[],r=r||0;for(var n=r;e>=G0e;)t[r++]=e&255|dL,e/=128;for(;e&$0e;)t[r++]=e&255|dL,e>>>=7;return t[r]=e|0,mL.bytes=r-n+1,t}function y9(e,n){var r=0,n=n||0,i=0,s=n,a,o=e.length;do{if(s>=o)throw y9.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&pL)<<i:(a&pL)*Math.pow(2,i),i+=7}while(a>=j0e);return y9.bytes=s-n,r}var z0e,dL,H0e,$0e,G0e,W0e,j0e,pL,Y0e,Q0e,X0e,Z0e,J0e,e1e,t1e,r1e,n1e,i1e,o1e,s1e,Gm,yL=Fe(()=>{c(),z0e=mL,dL=128,H0e=127,$0e=~H0e,G0e=Math.pow(2,31),W0e=y9,j0e=128,pL=127,Y0e=Math.pow(2,7),Q0e=Math.pow(2,14),X0e=Math.pow(2,21),Z0e=Math.pow(2,28),J0e=Math.pow(2,35),e1e=Math.pow(2,42),t1e=Math.pow(2,49),r1e=Math.pow(2,56),n1e=Math.pow(2,63),i1e=function(e){return e<Y0e?1:e<Q0e?2:e<X0e?3:e<Z0e?4:e<J0e?5:e<e1e?6:e<t1e?7:e<r1e?8:e<n1e?9:10},o1e={encode:z0e,decode:W0e,encodingLength:i1e},s1e=o1e,Gm=s1e}),Wm,lp,fp,K4=Fe(()=>{c(),yL(),Wm=e=>[Gm.decode(e),Gm.decode.bytes],lp=(e,t,r=0)=>(Gm.encode(e,t,r),t),fp=e=>Gm.encodingLength(e)}),xn={};ct(xn,{Digest:()=>Ff,create:()=>xs,decode:()=>_r,equals:()=>g9});var xs,_r,g9,Ff,On=Fe(()=>{c(),Mu(),K4(),xs=(e,t)=>{let r=t.byteLength,n=fp(e),i=n+fp(r),s=new Uint8Array(i+r);return lp(e,s,0),lp(r,s,n),s.set(t,i),new Ff(e,r,t,s)},_r=e=>{let t=Uo(e),[r,n]=Wm(t),[i,s]=Wm(t.subarray(n)),a=t.subarray(n+s);if(a.byteLength!==i)throw new Error("Incorrect length");return new Ff(r,i,a,t)},g9=(e,t)=>e===t?!0:e.code===t.code&&e.size===t.size&&W7(e.bytes,t.bytes),Ff=class{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}}),Ym={};ct(Ym,{CID:()=>I});var I,a1e,c1e,u1e,jm,l1e,gL,wL,V4,q4,f1e,h1e,d1e,te=Fe(()=>{c(),K4(),On(),Hr(),si(),Mu(),I=class{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:q4,byteLength:q4,code:V4,version:V4,multihash:V4,bytes:V4,_baseCache:q4,asCID:q4})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==jm)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==l1e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return I.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,r=xs(e,t);return I.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&g9(this.multihash,e.multihash)}toString(e){let{bytes:t,version:r,_baseCache:n}=this;switch(r){case 0:return c1e(t,n,e||Ne.encoder);default:return u1e(t,n,e||xt.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return h1e(/^0\.0/,d1e),!!(e&&(e[wL]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof I)return e;if(e!=null&&e.asCID===e){let{version:t,code:r,multihash:n,bytes:i}=e;return new I(t,r,n,i||gL(t,r,n.bytes))}else if(e!=null&&e[wL]===!0){let{version:t,multihash:r,code:n}=e,i=_r(r);return I.create(t,n,i)}else return null}static create(e,t,r){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==jm)throw new Error(`Version 0 CID must use dag-pb (code: ${jm}) block encoding`);return new I(e,t,r,r.bytes)}case 1:{let n=gL(e,t,r.bytes);return new I(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return I.create(0,jm,e)}static createV1(e,t){return I.create(1,e,t)}static decode(e){let[t,r]=I.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=I.inspectBytes(e),r=t.size-t.multihashSize,n=Uo(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");let i=n.subarray(t.multihashSize-t.digestSize),s=new Ff(t.multihashCode,t.digestSize,i,n);return[t.version===0?I.createV0(s):I.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0,r=()=>{let[h,f]=Wm(e.subarray(t));return t+=f,h},n=r(),i=jm;if(n===18?(n=0,t=0):n===1&&(i=r()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let s=t,a=r(),o=r(),l=t+o,u=l-s;return{version:n,codec:i,multihashCode:a,digestSize:o,multihashSize:u,size:l}}static parse(e,t){let[r,n]=a1e(e,t),i=I.decode(n);return i._baseCache.set(r,e),i}},a1e=(e,t)=>{switch(e[0]){case"Q":{let r=t||Ne;return[Ne.prefix,r.decode(`${Ne.prefix}${e}`)]}case Ne.prefix:{let r=t||Ne;return[Ne.prefix,r.decode(e)]}case xt.prefix:{let r=t||xt;return[xt.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},c1e=(e,t,r)=>{let{prefix:n}=r;if(n!==Ne.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return i},u1e=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let s=r.encode(e);return t.set(n,s),s}else return i},jm=112,l1e=18,gL=(e,t,r)=>{let n=fp(e),i=n+fp(t),s=new Uint8Array(i+r.byteLength);return lp(e,s,0),lp(t,s,n),s.set(r,i),s},wL=Symbol.for("@ipld/js-cid/CID"),V4={writable:!1,configurable:!1,enumerable:!0},q4={writable:!1,enumerable:!1,configurable:!1},f1e="0.0.0-dev",h1e=(e,t)=>{if(e.test(f1e))console.warn(t);else throw new Error(t)},d1e=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});function CL(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";let t=typeof e;return R1e.includes(t)?t:t==="function"?"Function":Array.isArray(e)?"Array":T1e(e)?"Buffer":I1e(e)||"Object"}function T1e(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function I1e(e){let t=Object.prototype.toString.call(e).slice(8,-1);if(A1e.includes(t))return t}var R1e,A1e,PL=Fe(()=>{c(),R1e=["string","number","bigint","symbol"],A1e=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]}),L,Q,vi=Fe(()=>{c(),L=class{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}},L.uint=new L(0,"uint",!0),L.negint=new L(1,"negint",!0),L.bytes=new L(2,"bytes",!0),L.string=new L(3,"string",!0),L.array=new L(4,"array",!1),L.map=new L(5,"map",!1),L.tag=new L(6,"tag",!1),L.float=new L(7,"float",!0),L.false=new L(7,"false",!0),L.true=new L(7,"true",!0),L.null=new L(7,"null",!0),L.undefined=new L(7,"undefined",!0),L.break=new L(7,"break",!0),Q=class{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function H4(e){return dp&&globalThis.Buffer.isBuffer(e)}function Xm(e){return e instanceof Uint8Array?H4(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}function ML(e,t){if(H4(e)&&H4(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function DL(e,t=1/0){let r,n=e.length,i=null,s=[];for(let a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}else if(a+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function kL(e,t,r){let n=[];for(;t<r;){let i=e[t],s=null,a=i>239?4:i>223?3:i>191?2:1;if(t+a<=r){let o,l,u,h;switch(a){case 1:i<128&&(s=i);break;case 2:o=e[t+1],(o&192)===128&&(h=(i&31)<<6|o&63,h>127&&(s=h));break;case 3:o=e[t+1],l=e[t+2],(o&192)===128&&(l&192)===128&&(h=(i&15)<<12|(o&63)<<6|l&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:o=e[t+1],l=e[t+2],u=e[t+3],(o&192)===128&&(l&192)===128&&(u&192)===128&&(h=(i&15)<<18|(o&63)<<12|(l&63)<<6|u&63,h>65535&&h<1114112&&(s=h))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),t+=a}return _9(n)}function _9(e){let t=e.length;if(t<=NL)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=NL));return r}var dp,C1e,P1e,OL,$4,ba,pp,LL,BL,NL,zu=Fe(()=>{c(),dp=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",C1e=new TextDecoder,P1e=new TextEncoder,OL=dp?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):kL(e,t,r):(e,t,r)=>r-t>64?C1e.decode(e.subarray(t,r)):kL(e,t,r),$4=dp?e=>e.length>64?globalThis.Buffer.from(e):DL(e):e=>e.length>64?P1e.encode(e):DL(e),ba=e=>Uint8Array.from(e),pp=dp?(e,t,r)=>H4(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),LL=dp?(e,t)=>(e=e.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),Xm(globalThis.Buffer.concat(e,t))):(e,t)=>{let r=new Uint8Array(t),n=0;for(let i of e)n+i.length>r.length&&(i=i.subarray(0,r.length-n)),r.set(i,n),n+=i.length;return r},BL=dp?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e),NL=4096}),D1e,Zm,UL=Fe(()=>{c(),zu(),D1e=256,Zm=class{constructor(e=D1e){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){let r=t.length-(this.maxCursor-this.cursor)-1;r<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,r),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=BL(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=pp(r,0,this.cursor)}else t=LL(this.chunks,this.cursor);return e&&this.reset(),t}}});function _c(e,t,r){if(e.length-t<r)throw new Error(`${Ie} not enough data for type`)}var Ie,bc,Jm,ro=Fe(()=>{c(),Ie="CBOR decode error:",bc="CBOR encode error:",Jm=[],Jm[23]=1,Jm[24]=2,Jm[25]=3,Jm[26]=5,Jm[27]=9});function no(e,t,r){_c(e,t,1);let n=e[t];if(r.strict===!0&&n<Bn[0])throw new Error(`${Ie} integer encoded in more bytes than necessary (strict decode)`);return n}function io(e,t,r){_c(e,t,2);let n=e[t]<<8|e[t+1];if(r.strict===!0&&n<Bn[1])throw new Error(`${Ie} integer encoded in more bytes than necessary (strict decode)`);return n}function oo(e,t,r){_c(e,t,4);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(r.strict===!0&&n<Bn[2])throw new Error(`${Ie} integer encoded in more bytes than necessary (strict decode)`);return n}function so(e,t,r){_c(e,t,8);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],s=(BigInt(n)<<BigInt(32))+BigInt(i);if(r.strict===!0&&s<Bn[3])throw new Error(`${Ie} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(r.allowBigInt===!0)return s;throw new Error(`${Ie} integers outside of the safe integer range are not supported`)}function FL(e,t,r,n){return new Q(L.uint,no(e,t+1,n),2)}function KL(e,t,r,n){return new Q(L.uint,io(e,t+1,n),3)}function VL(e,t,r,n){return new Q(L.uint,oo(e,t+1,n),5)}function qL(e,t,r,n){return new Q(L.uint,so(e,t+1,n),9)}function Ko(e,t){return Zn(e,0,t.value)}function Zn(e,t,r){if(r<Bn[0]){let n=Number(r);e.push([t|n])}else if(r<Bn[1]){let n=Number(r);e.push([t|24,n])}else if(r<Bn[2]){let n=Number(r);e.push([t|25,n>>>8,n&255])}else if(r<Bn[3]){let n=Number(r);e.push([t|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<Bn[4]){let i=[t|27,0,0,0,0,0,0,0],s=Number(n&BigInt(4294967295)),a=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=s&255,s=s>>8,i[7]=s&255,s=s>>8,i[6]=s&255,s=s>>8,i[5]=s&255,i[4]=a&255,a=a>>8,i[3]=a&255,a=a>>8,i[2]=a&255,a=a>>8,i[1]=a&255,e.push(i)}else throw new Error(`${Ie} encountered BigInt larger than allowable range`)}}var Bn,_a=Fe(()=>{c(),vi(),ro(),Bn=[24,256,65536,4294967296,BigInt("18446744073709551616")],Ko.encodedSize=function(e){return Zn.encodedSize(e.value)},Zn.encodedSize=function(e){return e<Bn[0]?1:e<Bn[1]?2:e<Bn[2]?3:e<Bn[3]?5:9},Ko.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}});function zL(e,t,r,n){return new Q(L.negint,-1-no(e,t+1,n),2)}function HL(e,t,r,n){return new Q(L.negint,-1-io(e,t+1,n),3)}function $L(e,t,r,n){return new Q(L.negint,-1-oo(e,t+1,n),5)}function WL(e,t,r,n){let i=so(e,t+1,n);if(typeof i!="bigint"){let s=-1-i;if(s>=Number.MIN_SAFE_INTEGER)return new Q(L.negint,s,9)}if(n.allowBigInt!==!0)throw new Error(`${Ie} integers outside of the safe integer range are not supported`);return new Q(L.negint,v9-BigInt(i),9)}function G4(e,t){let r=t.value,n=typeof r=="bigint"?r*v9-GL:r*-1-1;Zn(e,t.type.majorEncoded,n)}var v9,GL,S9=Fe(()=>{c(),vi(),_a(),ro(),v9=BigInt(-1),GL=BigInt(1),G4.encodedSize=function(e){let t=e.value,r=typeof t=="bigint"?t*v9-GL:t*-1-1;return r<Bn[0]?1:r<Bn[1]?2:r<Bn[2]?3:r<Bn[3]?5:9},G4.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}});function e2(e,t,r,n){_c(e,t,r+n);let i=pp(e,t+r,t+r+n);return new Q(L.bytes,i,r+n)}function jL(e,t,r,n){return e2(e,t,1,r)}function YL(e,t,r,n){return e2(e,t,2,no(e,t+1,n))}function QL(e,t,r,n){return e2(e,t,3,io(e,t+1,n))}function XL(e,t,r,n){return e2(e,t,5,oo(e,t+1,n))}function ZL(e,t,r,n){let i=so(e,t+1,n);if(typeof i=="bigint")throw new Error(`${Ie} 64-bit integer bytes lengths not supported`);return e2(e,t,9,i)}function W4(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===L.string?$4(e.value):e.value),e.encodedBytes}function mp(e,t){let r=W4(t);Zn(e,t.type.majorEncoded,r.length),e.push(r)}function N1e(e,t){return e.length<t.length?-1:e.length>t.length?1:ML(e,t)}var j4=Fe(()=>{c(),vi(),ro(),_a(),zu(),mp.encodedSize=function(e){let t=W4(e);return Zn.encodedSize(t.length)+t.length},mp.compareTokens=function(e,t){return N1e(W4(e),W4(t))}});function t2(e,t,r,n,i){let s=r+n;_c(e,t,s);let a=new Q(L.string,OL(e,t+r,t+s),s);return i.retainStringBytes===!0&&(a.byteValue=pp(e,t+r,t+s)),a}function JL(e,t,r,n){return t2(e,t,1,r,n)}function eB(e,t,r,n){return t2(e,t,2,no(e,t+1,n),n)}function tB(e,t,r,n){return t2(e,t,3,io(e,t+1,n),n)}function rB(e,t,r,n){return t2(e,t,5,oo(e,t+1,n),n)}function nB(e,t,r,n){let i=so(e,t+1,n);if(typeof i=="bigint")throw new Error(`${Ie} 64-bit integer string lengths not supported`);return t2(e,t,9,i,n)}var iB,x9=Fe(()=>{c(),vi(),ro(),_a(),j4(),zu(),iB=mp});function yp(e,t,r,n){return new Q(L.array,n,r)}function oB(e,t,r,n){return yp(e,t,1,r)}function sB(e,t,r,n){return yp(e,t,2,no(e,t+1,n))}function aB(e,t,r,n){return yp(e,t,3,io(e,t+1,n))}function cB(e,t,r,n){return yp(e,t,5,oo(e,t+1,n))}function uB(e,t,r,n){let i=so(e,t+1,n);if(typeof i=="bigint")throw new Error(`${Ie} 64-bit integer array lengths not supported`);return yp(e,t,9,i)}function lB(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${Ie} indefinite length items not allowed`);return yp(e,t,1,1/0)}function Y4(e,t){Zn(e,L.array.majorEncoded,t.value)}var R9=Fe(()=>{c(),vi(),_a(),ro(),Y4.compareTokens=Ko.compareTokens,Y4.encodedSize=function(e){return Zn.encodedSize(e.value)}});function gp(e,t,r,n){return new Q(L.map,n,r)}function fB(e,t,r,n){return gp(e,t,1,r)}function hB(e,t,r,n){return gp(e,t,2,no(e,t+1,n))}function dB(e,t,r,n){return gp(e,t,3,io(e,t+1,n))}function pB(e,t,r,n){return gp(e,t,5,oo(e,t+1,n))}function mB(e,t,r,n){let i=so(e,t+1,n);if(typeof i=="bigint")throw new Error(`${Ie} 64-bit integer map lengths not supported`);return gp(e,t,9,i)}function yB(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${Ie} indefinite length items not allowed`);return gp(e,t,1,1/0)}function Q4(e,t){Zn(e,L.map.majorEncoded,t.value)}var A9=Fe(()=>{c(),vi(),_a(),ro(),Q4.compareTokens=Ko.compareTokens,Q4.encodedSize=function(e){return Zn.encodedSize(e.value)}});function gB(e,t,r,n){return new Q(L.tag,r,1)}function wB(e,t,r,n){return new Q(L.tag,no(e,t+1,n),2)}function EB(e,t,r,n){return new Q(L.tag,io(e,t+1,n),3)}function bB(e,t,r,n){return new Q(L.tag,oo(e,t+1,n),5)}function _B(e,t,r,n){return new Q(L.tag,so(e,t+1,n),9)}function X4(e,t){Zn(e,L.tag.majorEncoded,t.value)}var T9=Fe(()=>{c(),vi(),_a(),X4.compareTokens=Ko.compareTokens,X4.encodedSize=function(e){return Zn.encodedSize(e.value)}});function vB(e,t,r,n){if(n.allowUndefined===!1)throw new Error(`${Ie} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new Q(L.null,null,1):new Q(L.undefined,void 0,1)}function SB(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${Ie} indefinite length items not allowed`);return new Q(L.break,void 0,1)}function I9(e,t,r){if(r){if(r.allowNaN===!1&&Number.isNaN(e))throw new Error(`${Ie} NaN values are not supported`);if(r.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${Ie} Infinity values are not supported`)}return new Q(L.float,e,t)}function xB(e,t,r,n){return I9(C9(e,t+1),3,n)}function RB(e,t,r,n){return I9(P9(e,t+1),5,n)}function AB(e,t,r,n){return I9(PB(e,t+1),9,n)}function Z4(e,t,r){let n=t.value;if(n===!1)e.push([L.float.majorEncoded|F1e]);else if(n===!0)e.push([L.float.majorEncoded|K1e]);else if(n===null)e.push([L.float.majorEncoded|V1e]);else if(n===void 0)e.push([L.float.majorEncoded|q1e]);else{let i,s=!1;(!r||r.float64!==!0)&&(IB(n),i=C9(Rs,1),n===i||Number.isNaN(n)?(Rs[0]=249,e.push(Rs.slice(0,3)),s=!0):(CB(n),i=P9(Rs,1),n===i&&(Rs[0]=250,e.push(Rs.slice(0,5)),s=!0))),s||(z1e(n),i=PB(Rs,1),Rs[0]=251,e.push(Rs.slice(0,9)))}}function IB(e){if(e===1/0)Vo.setUint16(0,31744,!1);else if(e===-1/0)Vo.setUint16(0,64512,!1);else if(Number.isNaN(e))Vo.setUint16(0,32256,!1);else{Vo.setFloat32(0,e);let t=Vo.getUint32(0),r=(t&2139095040)>>23,n=t&8388607;if(r===255)Vo.setUint16(0,31744,!1);else if(r===0)Vo.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{let i=r-127;i<-24?Vo.setUint16(0,0):i<-14?Vo.setUint16(0,(t&2147483648)>>16|1<<24+i,!1):Vo.setUint16(0,(t&2147483648)>>16|i+15<<10|n>>13,!1)}}}function C9(e,t){if(e.length-t<2)throw new Error(`${Ie} not enough data for float16`);let r=(e[t]<<8)+e[t+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,i=r&1023,s;return n===0?s=i*5960464477539063e-23:n!==31?s=(i+1024)*2**(n-25):s=i===0?1/0:NaN,r&32768?-s:s}function CB(e){Vo.setFloat32(0,e,!1)}function P9(e,t){if(e.length-t<4)throw new Error(`${Ie} not enough data for float32`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function z1e(e){Vo.setFloat64(0,e,!1)}function PB(e,t){if(e.length-t<8)throw new Error(`${Ie} not enough data for float64`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}var F1e,K1e,V1e,q1e,TB,Vo,Rs,D9=Fe(()=>{c(),vi(),ro(),_a(),F1e=20,K1e=21,V1e=22,q1e=23,Z4.encodedSize=function(e,t){let r=e.value;if(r===!1||r===!0||r===null||r===void 0)return 1;if(!t||t.float64!==!0){IB(r);let n=C9(Rs,1);if(r===n||Number.isNaN(r))return 3;if(CB(r),n=P9(Rs,1),r===n)return 5}return 9},TB=new ArrayBuffer(9),Vo=new DataView(TB,1),Rs=new Uint8Array(TB,0),Z4.compareTokens=Ko.compareTokens});function Vt(e,t,r){throw new Error(`${Ie} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function J4(e){return()=>{throw new Error(`${Ie} ${e}`)}}function DB(e){switch(e.type){case L.false:return ba([244]);case L.true:return ba([245]);case L.null:return ba([246]);case L.bytes:return e.value.length?void 0:ba([64]);case L.string:return e.value===""?ba([96]):void 0;case L.array:return e.value===0?ba([128]):void 0;case L.map:return e.value===0?ba([160]):void 0;case L.uint:return e.value<24?ba([Number(e.value)]):void 0;case L.negint:if(e.value>=-24)return ba([31-Number(e.value)])}}var ie,As,k9=Fe(()=>{c(),vi(),_a(),S9(),j4(),x9(),R9(),A9(),T9(),D9(),ro(),zu(),ie=[];for(let e=0;e<=23;e++)ie[e]=Vt;ie[24]=FL,ie[25]=KL,ie[26]=VL,ie[27]=qL,ie[28]=Vt,ie[29]=Vt,ie[30]=Vt,ie[31]=Vt;for(let e=32;e<=55;e++)ie[e]=Vt;ie[56]=zL,ie[57]=HL,ie[58]=$L,ie[59]=WL,ie[60]=Vt,ie[61]=Vt,ie[62]=Vt,ie[63]=Vt;for(let e=64;e<=87;e++)ie[e]=jL;ie[88]=YL,ie[89]=QL,ie[90]=XL,ie[91]=ZL,ie[92]=Vt,ie[93]=Vt,ie[94]=Vt,ie[95]=J4("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)ie[e]=JL;ie[120]=eB,ie[121]=tB,ie[122]=rB,ie[123]=nB,ie[124]=Vt,ie[125]=Vt,ie[126]=Vt,ie[127]=J4("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)ie[e]=oB;ie[152]=sB,ie[153]=aB,ie[154]=cB,ie[155]=uB,ie[156]=Vt,ie[157]=Vt,ie[158]=Vt,ie[159]=lB;for(let e=160;e<=183;e++)ie[e]=fB;ie[184]=hB,ie[185]=dB,ie[186]=pB,ie[187]=mB,ie[188]=Vt,ie[189]=Vt,ie[190]=Vt,ie[191]=yB;for(let e=192;e<=215;e++)ie[e]=gB;ie[216]=wB,ie[217]=EB,ie[218]=bB,ie[219]=_B,ie[220]=Vt,ie[221]=Vt,ie[222]=Vt,ie[223]=Vt;for(let e=224;e<=243;e++)ie[e]=J4("simple values are not supported");ie[244]=Vt,ie[245]=Vt,ie[246]=Vt,ie[247]=vB,ie[248]=J4("simple values are not supported"),ie[249]=xB,ie[250]=RB,ie[251]=AB,ie[252]=Vt,ie[253]=Vt,ie[254]=Vt,ie[255]=SB,As=[];for(let e=0;e<24;e++)As[e]=new Q(L.uint,e,1);for(let e=-1;e>=-24;e--)As[31-e]=new Q(L.negint,e,1);As[64]=new Q(L.bytes,new Uint8Array(0),1),As[96]=new Q(L.string,"",1),As[128]=new Q(L.array,0,1),As[160]=new Q(L.map,0,1),As[244]=new Q(L.false,!1,1),As[245]=new Q(L.true,!0,1),As[246]=new Q(L.null,null,1)});function G1e(){let e=[];return e[L.uint.major]=Ko,e[L.negint.major]=G4,e[L.bytes.major]=mp,e[L.string.major]=iB,e[L.array.major]=Y4,e[L.map.major]=Q4,e[L.tag.major]=X4,e[L.float.major]=Z4,e}function ew(e,t={},r){let n=CL(e),i=t&&t.typeEncoders&&t.typeEncoders[n]||$u[n];if(typeof i=="function"){let a=i(e,n,t,r);if(a!=null)return a}let s=$u[n];if(!s)throw new Error(`${bc} unsupported type: ${n}`);return s(e,n,t,r)}function W1e(e,t){t.mapSorter&&e.sort(t.mapSorter)}function j1e(e,t){let r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);let i=r.type.major,s=kB[i].compareTokens(r,n);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function NB(e,t,r,n){if(Array.isArray(t))for(let i of t)NB(e,i,r,n);else r[t.type.major](e,t,n)}function O9(e,t,r){let n=ew(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){let i=r.quickEncodeToken(n);if(i)return i;let s=t[n.type.major];if(s.encodedSize){let a=s.encodedSize(n,r),o=new Zm(a);if(s(o,n,r),o.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Xm(o.chunks[0])}}return N9.reset(),NB(N9,n,t,r),N9.toBytes(!0)}function ao(e,t){return t=Object.assign({},$1e,t),O9(e,kB,t)}var $1e,kB,N9,wp,Hu,$u,L9=Fe(()=>{c(),PL(),vi(),UL(),ro(),k9(),zu(),_a(),S9(),j4(),x9(),R9(),A9(),T9(),D9(),$1e={float64:!1,mapSorter:j1e,quickEncodeToken:DB},kB=G1e(),N9=new Zm,wp=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${bc} object contains circular references`);return new wp(t,e)}},Hu={null:new Q(L.null,null),undefined:new Q(L.undefined,void 0),true:new Q(L.true,!0),false:new Q(L.false,!1),emptyArray:new Q(L.array,0),emptyMap:new Q(L.map,0)},$u={number(e,t,r,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new Q(L.float,e):e>=0?new Q(L.uint,e):new Q(L.negint,e)},bigint(e,t,r,n){return e>=BigInt(0)?new Q(L.uint,e):new Q(L.negint,e)},Uint8Array(e,t,r,n){return new Q(L.bytes,e)},string(e,t,r,n){return new Q(L.string,e)},boolean(e,t,r,n){return e?Hu.true:Hu.false},null(e,t,r,n){return Hu.null},undefined(e,t,r,n){return Hu.undefined},ArrayBuffer(e,t,r,n){return new Q(L.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new Q(L.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return r.addBreakTokens===!0?[Hu.emptyArray,new Q(L.break)]:Hu.emptyArray;n=wp.createCheck(n,e);let i=[],s=0;for(let a of e)i[s++]=ew(a,r,n);return r.addBreakTokens?[new Q(L.array,e.length),i,new Q(L.break)]:[new Q(L.array,e.length),i]},Object(e,t,r,n){let i=t!=="Object",s=i?e.keys():Object.keys(e),a=i?e.size:s.length;if(!a)return r.addBreakTokens===!0?[Hu.emptyMap,new Q(L.break)]:Hu.emptyMap;n=wp.createCheck(n,e);let o=[],l=0;for(let u of s)o[l++]=[ew(u,r,n),ew(i?e.get(u):e[u],r,n)];return W1e(o,r),r.addBreakTokens?[new Q(L.map,a),o,new Q(L.break)]:[new Q(L.map,a),o]}},$u.Map=$u.Object,$u.Buffer=$u.Uint8Array;for(let e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))$u[`${e}Array`]=$u.DataView});function Q1e(e,t,r){let n=[];for(let i=0;i<e.value;i++){let s=n2(t,r);if(s===tw){if(e.value===1/0)break;throw new Error(`${Ie} got unexpected break to lengthed array`)}if(s===r2)throw new Error(`${Ie} found array but not enough entries (got ${i}, expected ${e.value})`);n[i]=s}return n}function X1e(e,t,r){let n=r.useMaps===!0,i=n?void 0:{},s=n?new Map:void 0;for(let a=0;a<e.value;a++){let o=n2(t,r);if(o===tw){if(e.value===1/0)break;throw new Error(`${Ie} got unexpected break to lengthed map`)}if(o===r2)throw new Error(`${Ie} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(n!==!0&&typeof o!="string")throw new Error(`${Ie} non-string keys not supported (got ${typeof o})`);let l=n2(t,r);if(l===r2)throw new Error(`${Ie} found map but not enough entries (got ${a} [no value], expected ${e.value})`);n?s.set(o,l):i[o]=l}return n?s:i}function n2(e,t){if(e.done())return r2;let r=e.next();if(r.type===L.break)return tw;if(r.type.terminal)return r.value;if(r.type===L.array)return Q1e(r,e,t);if(r.type===L.map)return X1e(r,e,t);if(r.type===L.tag){if(t.tags&&typeof t.tags[r.value]=="function"){let n=n2(e,t);return t.tags[r.value](n)}throw new Error(`${Ie} tag not supported (${r.value})`)}throw new Error("unsupported")}function Mn(e,t){if(!(e instanceof Uint8Array))throw new Error(`${Ie} data to decode must be a Uint8Array`);t=Object.assign({},Y1e,t);let r=t.tokenizer||new B9(e,t),n=n2(r,t);if(n===r2)throw new Error(`${Ie} did not find any content to decode`);if(n===tw)throw new Error(`${Ie} got unexpected break`);if(!r.done())throw new Error(`${Ie} too many terminals, data makes no sense`);return n}var Y1e,B9,r2,tw,M9=Fe(()=>{c(),ro(),vi(),k9(),Y1e={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},B9=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=As[e];if(t===void 0){let r=ie[e];if(!r)throw new Error(`${Ie} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let n=e&31;t=r(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}},r2=Symbol.for("DONE"),tw=Symbol.for("BREAK")}),Vf=Fe(()=>{c(),L9(),M9(),vi()}),Ep,F9,rw=Fe(()=>{c(),On(),Ep=({name:e,code:t,encode:r})=>new F9(e,t,r),F9=class{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?xs(this.code,t):t.then(r=>xs(this.code,r))}else throw Error("Unknown type, must be binary type")}}}),bp=Fe(()=>{c(),te(),K4(),Mu(),rw(),On()}),G9=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0}),e.fromBase64url=e.toBase64url=void 0;var t=(ma(),cr(N4));function r(i){return t.base64url.encode(i).slice(1)}e.toBase64url=r;function n(i){return t.base64url.decode(`u${i}`)}e.fromBase64url=n}),FB=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=G9(),r=(te(),cr(Ym));function n(l){let[u,h,f]=l;return{payload:h,signatures:[{protected:u,signature:f}],link:r.CID.decode(t.fromBase64url(h))}}function i(l){let u={signature:t.fromBase64url(l.signature)};return l.header&&(u.header=l.header),l.protected&&(u.protected=t.fromBase64url(l.protected)),u}function s(l){let u=t.fromBase64url(l.payload);try{r.CID.decode(u)}catch{throw new Error("Not a valid DagJWS")}return{payload:u,signatures:l.signatures.map(i)}}function a(l){let u={signature:t.toBase64url(l.signature)};return l.header&&(u.header=l.header),l.protected&&(u.protected=t.toBase64url(l.protected)),u}function o(l){let u={payload:t.toBase64url(l.payload),signatures:l.signatures.map(a)};return u.link=r.CID.decode(new Uint8Array(l.payload)),u}e.default={fromSplit:n,encode:s,decode:o}}),KB=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=G9();function r(o){let[l,u,h,f,y]=o,p={ciphertext:f,iv:h,protected:l,tag:y};return u&&(p.recipients=[{encrypted_key:u}]),p}function n(o){let l={};return o.encrypted_key&&(l.encrypted_key=t.fromBase64url(o.encrypted_key)),o.header&&(l.header=o.header),l}function i(o){let l={ciphertext:t.fromBase64url(o.ciphertext),protected:t.fromBase64url(o.protected),iv:t.fromBase64url(o.iv),tag:t.fromBase64url(o.tag)};return o.aad&&(l.aad=t.fromBase64url(o.aad)),o.recipients&&(l.recipients=o.recipients.map(n)),o.unprotected&&(l.unprotected=o.unprotected),l}function s(o){let l={};return o.encrypted_key&&(l.encrypted_key=t.toBase64url(o.encrypted_key)),o.header&&(l.header=o.header),l}function a(o){let l={ciphertext:t.toBase64url(o.ciphertext),protected:t.toBase64url(o.protected),iv:t.toBase64url(o.iv),tag:t.toBase64url(o.tag)};return o.aad&&(l.aad=t.toBase64url(o.aad)),o.recipients&&(l.recipients=o.recipients.map(s)),o.unprotected&&(l.unprotected=o.unprotected),l}e.default={fromSplit:r,decode:a,encode:i}}),zB={};ct(zB,{code:()=>kme,decode:()=>Ome,encode:()=>Nme,name:()=>Dme});function Ame(e){if(e.asCID!==e)return null;let t=I.asCID(e);if(!t)return null;let r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new Q(L.tag,VB),new Q(L.bytes,r)]}function Tme(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Ime(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function Pme(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return I.decode(e.subarray(1))}var VB,Cme,qB,Dme,kme,Nme,Ome,HB=Fe(()=>{c(),Vf(),te(),VB=42,Cme={float64:!0,typeEncoders:{Object:Ame,undefined:Tme,number:Ime}},qB={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]},qB.tags[VB]=Pme,Dme="dag-cbor",kme=113,Nme=e=>ao(e,Cme),Ome=e=>Mn(e,qB)}),Z9=A(e=>{"use strict";c();var t=e&&e.__createBinding||(Object.create?function(d,g,b,_){_===void 0&&(_=b),Object.defineProperty(d,_,{enumerable:!0,get:function(){return g[b]}})}:function(d,g,b,_){_===void 0&&(_=b),d[_]=g[b]}),r=e&&e.__setModuleDefault||(Object.create?function(d,g){Object.defineProperty(d,"default",{enumerable:!0,value:g})}:function(d,g){d.default=g}),n=e&&e.__importStar||function(d){if(d&&d.__esModule)return d;var g={};if(d!=null)for(var b in d)b!=="default"&&Object.prototype.hasOwnProperty.call(d,b)&&t(g,d,b);return r(g,d),g},i=e&&e.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.encode=e.toGeneral=e.code=e.name=void 0;var s=i(FB()),a=i(KB()),o=n((HB(),cr(zB)));e.name="dag-jose",e.code=133;function l(d){return"payload"in d&&typeof d.payload=="string"&&"signatures"in d&&Array.isArray(d.signatures)}function u(d){return"payload"in d&&d.payload instanceof Uint8Array&&"signatures"in d&&Array.isArray(d.signatures)}function h(d){return"ciphertext"in d&&d.ciphertext instanceof Uint8Array&&"iv"in d&&d.iv instanceof Uint8Array&&"protected"in d&&d.protected instanceof Uint8Array&&"tag"in d&&d.tag instanceof Uint8Array}function f(d){return"ciphertext"in d&&typeof d.ciphertext=="string"&&"iv"in d&&typeof d.iv=="string"&&"protected"in d&&typeof d.protected=="string"&&"tag"in d&&typeof d.tag=="string"}function y(d){if(typeof d=="string"){let g=d.split(".");if(g.length===3)return s.default.fromSplit(g);if(g.length===5)return a.default.fromSplit(g);throw new Error("Not a valid JOSE string")}if(l(d)||f(d))return d;throw new Error("Not a valid unencoded JOSE object")}e.toGeneral=y;function p(d){typeof d=="string"&&(d=y(d));let g;if(l(d))g=s.default.encode(d);else if(f(d))g=a.default.encode(d);else throw new Error("Not a valid JOSE object");return new Uint8Array(o.encode(g))}e.encode=p;function v(d){let g;try{g=o.decode(d)}catch{throw new Error("Not a valid DAG-JOSE object")}if(u(g))return s.default.decode(g);if(h(g))return a.default.decode(g);throw new Error("Not a valid DAG-JOSE object")}e.decode=v}),J9={};ct(J9,{identity:()=>$r});var QB,qme,XB,zme,$r,va=Fe(()=>{c(),Mu(),On(),QB=0,qme="identity",XB=Uo,zme=e=>xs(QB,XB(e)),$r={code:QB,name:qme,encode:XB,digest:zme}}),eS={};ct(eS,{identity:()=>Hme});var Hme,ZB=Fe(()=>{c(),_s(),Mu(),Hme=sp({prefix:"\0",name:"identity",encode:e=>Y7(e),decode:e=>j7(e)})}),tS={};ct(tS,{base2:()=>$me});var $me,JB=Fe(()=>{c(),_s(),$me=zr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),rS={};ct(rS,{base8:()=>Gme});var Gme,eM=Fe(()=>{c(),_s(),Gme=zr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),nS={};ct(nS,{base10:()=>Wme});var Wme,tM=Fe(()=>{c(),_s(),Wme=Uu({prefix:"9",name:"base10",alphabet:"0123456789"})}),iS={};ct(iS,{base16:()=>jme,base16upper:()=>Yme});var jme,Yme,rM=Fe(()=>{c(),_s(),jme=zr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Yme=zr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})}),oS={};ct(oS,{base36:()=>xp,base36upper:()=>Qme});var xp,Qme,nw=Fe(()=>{c(),_s(),xp=Uu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Qme=Uu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),sS={};ct(sS,{base256emoji:()=>t2e});function Jme(e){return e.reduce((t,r)=>(t+=Xme[r],t),"")}function e2e(e){let t=[];for(let r of e){let n=Zme[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var nM,Xme,Zme,t2e,iM=Fe(()=>{c(),_s(),nM=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Xme=nM.reduce((e,t,r)=>(e[r]=t,e),[]),Zme=nM.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),t2e=sp({prefix:"\u{1F680}",name:"base256emoji",encode:Jme,decode:e2e})}),aS={};ct(aS,{sha256:()=>xe,sha512:()=>r2e});var oM,xe,r2e,vr=Fe(()=>{c(),rw(),oM=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),xe=Ep({name:"sha2-256",code:18,encode:oM("SHA-256")}),r2e=Ep({name:"sha2-512",code:19,encode:oM("SHA-512")})}),Fi={};ct(Fi,{code:()=>Un,decode:()=>o2e,encode:()=>i2e,name:()=>n2e});var n2e,Un,i2e,o2e,zo=Fe(()=>{c(),Mu(),n2e="raw",Un=85,i2e=e=>Uo(e),o2e=e=>Uo(e)}),iw={};ct(iw,{code:()=>cS,decode:()=>l2e,encode:()=>u2e,name:()=>c2e});var s2e,a2e,c2e,cS,u2e,l2e,uS=Fe(()=>{c(),s2e=new TextEncoder,a2e=new TextDecoder,c2e="json",cS=512,u2e=e=>s2e.encode(JSON.stringify(e)),l2e=e=>JSON.parse(a2e.decode(e))}),Sa,ow,sw,o2=Fe(()=>{c(),ZB(),JB(),eM(),tM(),rM(),si(),nw(),Hr(),ma(),iM(),vr(),va(),zo(),uS(),bp(),Sa={...eS,...tS,...rS,...nS,...iS,...Vm,...oS,...ap,...N4,...sS},ow={...aS,...J9},sw={raw:Fi,json:iw}});function aM(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var sM,fS,f2e,aw,hS=Fe(()=>{c(),o2(),sM=aM("utf8","u",e=>{let t=new TextDecoder("utf8");return"u"+t.decode(e)},e=>new TextEncoder().encode(e.substring(1))),fS=aM("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),f2e={utf8:sM,"utf-8":sM,hex:Sa.base16,latin1:fS,ascii:fS,binary:fS,...Sa},aw=f2e}),dS={};ct(dS,{fromString:()=>U});function U(e,t="utf8"){let r=aw[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}var Re=Fe(()=>{c(),hS()}),lM=A((e,t)=>{"use strict";c();var r="[a-fA-F\\d:]",n=f=>f&&f.includeBoundaries?`(?:(?<=\\s|^)(?=${r})|(?<=${r})(?=\\s|$))`:"",i="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",a=`
(?:
(?:${s}:){7}(?:${s}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${s}:){6}(?:${i}|:${s}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${s}:){5}(?::${i}|(?::${s}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${s}:){4}(?:(?::${s}){0,1}:${i}|(?::${s}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${s}:){3}(?:(?::${s}){0,2}:${i}|(?::${s}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${s}:){2}(?:(?::${s}){0,3}:${i}|(?::${s}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${s}:){1}(?:(?::${s}){0,4}:${i}|(?::${s}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${s}){0,5}:${i}|(?::${s}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=new RegExp(`(?:^${i}$)|(?:^${a}$)`),l=new RegExp(`^${i}$`),u=new RegExp(`^${a}$`),h=f=>f&&f.exact?o:new RegExp(`(?:${n(f)}${i}${n(f)})|(?:${n(f)}${a}${n(f)})`,"g");h.v4=f=>f&&f.exact?l:new RegExp(`${n(f)}${i}${n(f)}`,"g"),h.v6=f=>f&&f.exact?u:new RegExp(`${n(f)}${a}${n(f)}`,"g"),t.exports=h}),hM=A((e,t)=>{"use strict";c();var r=lM(),n=i=>r({exact:!0}).test(i);n.v4=i=>r.v4({exact:!0}).test(i),n.v6=i=>r.v6({exact:!0}).test(i),n.version=i=>n(i)?n.v4(i)?4:6:void 0,t.exports=n}),Ap={};ct(Ap,{toString:()=>M});function M(e,t="utf8"){let r=aw[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}var me=Fe(()=>{c(),hS()}),gM=A((e,t)=>{"use strict";c();var r=hM(),{toString:n}=(me(),cr(Ap)),i=r,s=r.v4,a=r.v6,o=function(u,h,f){f=~~f;let y;if(s(u))y=h||new Uint8Array(f+4),u.split(/\./g).map(function(p){y[f++]=parseInt(p,10)&255});else if(a(u)){let p=u.split(":",8),v;for(v=0;v<p.length;v++){let d=s(p[v]),g;d&&(g=o(p[v]),p[v]=n(g.slice(0,2),"base16")),g&&++v<8&&p.splice(v,0,n(g.slice(2,4),"base16"))}if(p[0]==="")for(;p.length<8;)p.unshift("0");else if(p[p.length-1]==="")for(;p.length<8;)p.push("0");else if(p.length<8){for(v=0;v<p.length&&p[v]!=="";v++);let d=[v,"1"];for(v=9-p.length;v>0;v--)d.push("0");p.splice.apply(p,d)}for(y=h||new Uint8Array(f+16),v=0;v<p.length;v++){let d=parseInt(p[v],16);y[f++]=d>>8&255,y[f++]=d&255}}if(!y)throw Error("Invalid ip address: "+u);return y},l=function(u,h,f){h=~~h,f=f||u.length-h;let y=[],p,v=new DataView(u.buffer);if(f===4){for(let d=0;d<f;d++)y.push(u[h+d]);p=y.join(".")}else if(f===16){for(let d=0;d<f;d+=2)y.push(v.getUint16(h+d).toString(16));p=y.join(":"),p=p.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),p=p.replace(/:{3,4}/,"::")}return p};t.exports={isIP:i,isV4:s,isV6:a,toBytes:o,toString:l}}),uw=A((e,t)=>{"use strict";c();function r(s){if(typeof s=="number"){if(r.codes[s])return r.codes[s];throw new Error("no protocol with code: "+s)}else if(typeof s=="string"){if(r.names[s])return r.names[s];throw new Error("no protocol with name: "+s)}throw new Error("invalid protocol id type: "+s)}var n=-1;r.lengthPrefixedVarSize=n,r.V=n,r.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,n,"ip6zone"],[53,n,"dns","resolvable"],[54,n,"dns4","resolvable"],[55,n,"dns6","resolvable"],[56,n,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,n,"unix",!1,"path"],[421,n,"ipfs"],[421,n,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,n,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,n,"memory"]],r.names={},r.codes={},r.table.map(s=>{let a=i.apply(null,s);return r.codes[a.code]=a,r.names[a.name]=a,null}),r.object=i;function i(s,a,o,l,u){return{code:s,size:a,name:o,resolvable:Boolean(l),path:Boolean(u)}}t.exports=r}),vM=A((e,t)=>{c(),t.exports=a;var r=128,n=127,i=~n,s=Math.pow(2,31);function a(o,l,u){if(Number.MAX_SAFE_INTEGER&&o>Number.MAX_SAFE_INTEGER)throw a.bytes=0,new RangeError("Could not encode varint");l=l||[],u=u||0;for(var h=u;o>=s;)l[u++]=o&255|r,o/=128;for(;o&i;)l[u++]=o&255|r,o>>>=7;return l[u]=o|0,a.bytes=u-h+1,l}}),RM=A((e,t)=>{c(),t.exports=i;var r=128,n=127;function i(s,l){var o=0,l=l||0,u=0,h=l,f,y=s.length;do{if(h>=y||u>49)throw i.bytes=0,new RangeError("Could not decode varint");f=s[h++],o+=u<28?(f&n)<<u:(f&n)*Math.pow(2,u),u+=7}while(f>=r);return i.bytes=h-l,o}}),TM=A((e,t)=>{c();var r=Math.pow(2,7),n=Math.pow(2,14),i=Math.pow(2,21),s=Math.pow(2,28),a=Math.pow(2,35),o=Math.pow(2,42),l=Math.pow(2,49),u=Math.pow(2,56),h=Math.pow(2,63);t.exports=function(f){return f<r?1:f<n?2:f<i?3:f<s?4:f<a?5:f<o?6:f<l?7:f<u?8:f<h?9:10}}),ai=A((e,t)=>{c(),t.exports={encode:vM(),decode:RM(),encodingLength:TM()}}),s2={};ct(s2,{concat:()=>Ae});function Ae(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));let r=new Uint8Array(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return r}var ur=Fe(()=>{c()}),BM=A((e,t)=>{"use strict";c();var r=gM(),n=uw(),{CID:i}=(te(),cr(Ym)),{base32:s}=(si(),cr(Vm)),{base58btc:a}=(Hr(),cr(ap)),o=(On(),cr(xn)),l=ai(),{toString:u}=(me(),cr(Ap)),{fromString:h}=(Re(),cr(dS)),{concat:f}=(ur(),cr(s2));t.exports=y;function y(T,S){return S instanceof Uint8Array?y.toString(T,S):y.toBytes(T,S)}y.toString=function(T,S){switch(n(T).code){case 4:case 41:return v(S);case 6:case 273:case 33:case 132:return g(S).toString();case 53:case 54:case 55:case 56:case 400:case 777:return _(S);case 421:return E(S);case 444:return R(S);case 445:return R(S);default:return u(S,"base16")}},y.toBytes=function(T,S){switch(n(T).code){case 4:return p(S);case 41:return p(S);case 6:case 273:case 33:case 132:return d(parseInt(S,10));case 53:case 54:case 55:case 56:case 400:case 777:return b(S);case 421:return m(S);case 444:return D(S);case 445:return N(S);default:return h(S,"base16")}};function p(T){if(!r.isIP(T))throw new Error("invalid ip address");return r.toBytes(T)}function v(T){let S=r.toString(T);if(!S||!r.isIP(S))throw new Error("invalid ip address");return S}function d(T){let S=new ArrayBuffer(2);return new DataView(S).setUint16(0,T),new Uint8Array(S)}function g(T){return new DataView(T.buffer).getUint16(T.byteOffset)}function b(T){let S=h(T),O=Uint8Array.from(l.encode(S.length));return f([O,S],O.length+S.length)}function _(T){let S=l.decode(T);if(T=T.slice(l.decode.bytes),T.length!==S)throw new Error("inconsistent lengths");return u(T)}function m(T){let S;T[0]==="Q"||T[0]==="1"?S=o.decode(a.decode(`z${T}`)).bytes:S=i.parse(T).multihash.bytes;let O=Uint8Array.from(l.encode(S.length));return f([O,S],O.length+S.length)}function E(T){let S=l.decode(T),O=T.slice(l.decode.bytes);if(O.length!==S)throw new Error("inconsistent lengths");return u(O,"base58btc")}function D(T){let S=T.split(":");if(S.length!==2)throw new Error("failed to parse onion addr: "+S+" does not contain a port number");if(S[0].length!==16)throw new Error("failed to parse onion addr: "+S[0]+" not a Tor onion address.");let O=s.decode("b"+S[0]),F=parseInt(S[1],10);if(F<1||F>65536)throw new Error("Port number is not in range(1, 65536)");let G=d(F);return f([O,G],O.length+G.length)}function N(T){let S=T.split(":");if(S.length!==2)throw new Error("failed to parse onion addr: "+S+" does not contain a port number");if(S[0].length!==56)throw new Error("failed to parse onion addr: "+S[0]+" not a Tor onion3 address.");let O=s.decode("b"+S[0]),F=parseInt(S[1],10);if(F<1||F>65536)throw new Error("Port number is not in range(1, 65536)");let G=d(F);return f([O,G],O.length+G.length)}function R(T){let S=T.slice(0,T.length-2),O=T.slice(T.length-2),F=u(S,"base32"),G=g(O);return F+":"+G}}),jM=A((e,t)=>{"use strict";c();var r=BM(),n=uw(),i=ai(),{concat:s}=(ur(),cr(s2)),{toString:a}=(me(),cr(Ap));t.exports={stringToStringTuples:o,stringTuplesToString:l,tuplesToStringTuples:h,stringTuplesToTuples:u,bytesToTuples:p,tuplesToBytes:f,bytesToString:v,stringToBytes:d,fromString:g,fromBytes:b,validateBytes:_,isValidBytes:m,cleanPath:E,ParseError:D,protoFromTuple:N,sizeForAddr:y};function o(R){let T=[],S=R.split("/").slice(1);if(S.length===1&&S[0]==="")return[];for(let O=0;O<S.length;O++){let F=S[O],G=n(F);if(G.size===0){T.push([F]);continue}if(O++,O>=S.length)throw D("invalid address: "+R);if(G.path){T.push([F,E(S.slice(O).join("/"))]);break}T.push([F,S[O]])}return T}function l(R){let T=[];return R.map(S=>{let O=N(S);return T.push(O.name),S.length>1&&T.push(S[1]),null}),E(T.join("/"))}function u(R){return R.map(T=>{Array.isArray(T)||(T=[T]);let S=N(T);return T.length>1?[S.code,r.toBytes(S.code,T[1])]:[S.code]})}function h(R){return R.map(T=>{let S=N(T);return T[1]?[S.code,r.toString(S.code,T[1])]:[S.code]})}function f(R){return b(s(R.map(T=>{let S=N(T),O=Uint8Array.from(i.encode(S.code));return T.length>1&&(O=s([O,T[1]])),O})))}function y(R,T){return R.size>0?R.size/8:R.size===0?0:i.decode(T)+i.decode.bytes}function p(R){let T=[],S=0;for(;S<R.length;){let O=i.decode(R,S),F=i.decode.bytes,G=n(O),ne=y(G,R.slice(S+F));if(ne===0){T.push([O]),S+=F;continue}let Y=R.slice(S+F,S+F+ne);if(S+=ne+F,S>R.length)throw D("Invalid address Uint8Array: "+a(R,"base16"));T.push([O,Y])}return T}function v(R){let T=p(R),S=h(T);return l(S)}function d(R){R=E(R);let T=o(R),S=u(T);return f(S)}function g(R){return d(R)}function b(R){let T=_(R);if(T)throw T;return Uint8Array.from(R)}function _(R){try{p(R)}catch(T){return T}}function m(R){return _(R)===void 0}function E(R){return"/"+R.trim().split("/").filter(T=>T).join("/")}function D(R){return new Error("Error parsing address: "+R)}function N(R){return n(R[0])}}),YM={};ct(YM,{equals:()=>Ce});function Ce(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var yr=Fe(()=>{c()}),mw=A((e,t)=>{"use strict";c();var r=jM(),n=uw(),i=ai(),{CID:s}=(te(),cr(Ym)),{base58btc:a}=(Hr(),cr(ap)),o=K(),l=Symbol.for("nodejs.util.inspect.custom"),{toString:u}=(me(),cr(Ap)),{equals:h}=(yr(),cr(YM)),f=new Map,y=Symbol.for("@multiformats/js-multiaddr/multiaddr"),p=class{constructor(d){if(d==null&&(d=""),Object.defineProperty(this,y,{value:!0}),d instanceof Uint8Array)this.bytes=r.fromBytes(d);else if(typeof d=="string"){if(d.length>0&&d.charAt(0)!=="/")throw new Error(`multiaddr "${d}" must start with a "/"`);this.bytes=r.fromString(d)}else if(p.isMultiaddr(d))this.bytes=r.fromBytes(d.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return r.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let d={},g=this.toString().split("/");return d.family=g[1]==="ip4"?4:6,d.host=g[2],d.transport=g[3],d.port=parseInt(g[4]),d}protos(){return this.protoCodes().map(d=>Object.assign({},n(d)))}protoCodes(){let d=[],g=this.bytes,b=0;for(;b<g.length;){let _=i.decode(g,b),m=i.decode.bytes,E=n(_);b+=r.sizeForAddr(E,g.slice(b+m))+m,d.push(_)}return d}protoNames(){return this.protos().map(d=>d.name)}tuples(){return r.bytesToTuples(this.bytes)}stringTuples(){let d=r.bytesToTuples(this.bytes);return r.tuplesToStringTuples(d)}encapsulate(d){return d=new p(d),new p(this.toString()+d.toString())}decapsulate(d){let g=d.toString(),b=this.toString(),_=b.lastIndexOf(g);if(_<0)throw new Error("Address "+this+" does not contain subaddress: "+d);return new p(b.slice(0,_))}decapsulateCode(d){let g=this.tuples();for(let b=g.length-1;b>=0;b--)if(g[b][0]===d)return new p(r.tuplesToBytes(g.slice(0,b)));return this}getPeerId(){try{let d=this.stringTuples().filter(g=>g[0]===n.names.ipfs.code).pop();if(d&&d[1]){let g=d[1];return g[0]==="Q"||g[0]==="1"?u(a.decode(`z${g}`),"base58btc"):u(s.parse(g).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let d=null;try{d=this.stringTuples().filter(g=>!!n(g[0]).path)[0][1],d||(d=null)}catch{d=null}return d}equals(d){return h(this.bytes,d.bytes)}async resolve(){let d=this.protos().find(b=>b.resolvable);if(!d)return[this];let g=f.get(d.name);if(!g)throw o(new Error(`no available resolver for ${d.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await g(this)).map(b=>new p(b))}nodeAddress(){let d=this.protoCodes(),g=this.protoNames(),b=this.toString().split("/").slice(1);if(b.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(d[0]!==4&&d[0]!==41&&d[0]!==54&&d[0]!==55)throw new Error(`no protocol with name: "'${g[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(b[2]!=="tcp"&&b[2]!=="udp")throw new Error(`no protocol with name: "'${g[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:d[0]===41||d[0]===55?6:4,address:b[1],port:parseInt(b[3])}}isThinWaistAddress(d){let g=(d||this).protos();return!(g.length!==2||g[0].code!==4&&g[0].code!==41||g[1].code!==6&&g[1].code!==273)}static fromNodeAddress(d,g){if(!d)throw new Error("requires node address object");if(!g)throw new Error("requires transport protocol");let b;switch(d.family){case 4:b="ip4";break;case 6:b="ip6";break;default:throw Error(`Invalid addr family. Got '${d.family}' instead of 4 or 6`)}return new p("/"+[b,d.address,g,d.port].join("/"))}static isName(d){return p.isMultiaddr(d)?d.protos().some(g=>g.resolvable):!1}static isMultiaddr(d){return d instanceof p||Boolean(d&&d[y])}[l](){return"<Multiaddr "+u(this.bytes,"base16")+" - "+r.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+u(this.bytes,"base16")+" - "+r.bytesToString(this.bytes)+">"}};p.protocols=n,p.resolvers=f;function v(d){return new p(d)}t.exports={Multiaddr:p,multiaddr:v,protocols:n,resolvers:f}}),uU=A((e,t)=>{"use strict";c();var{Multiaddr:r}=mw(),n=ne("dns4"),i=ne("dns6"),s=ne("dnsaddr"),a=G(ne("dns"),s,n,i),o=G(ne("ip4"),ne("ip6")),l=G(F(o,ne("tcp")),F(a,ne("tcp"))),u=F(o,ne("udp")),h=F(u,ne("utp")),f=F(u,ne("quic")),y=G(F(l,ne("ws")),F(a,ne("ws"))),p=G(F(l,ne("wss")),F(a,ne("wss"))),v=G(F(l,ne("http")),F(o,ne("http")),F(a,ne("http"))),d=G(F(l,ne("https")),F(o,ne("https")),F(a,ne("https"))),g=G(F(y,ne("p2p-webrtc-star"),ne("p2p")),F(p,ne("p2p-webrtc-star"),ne("p2p")),F(y,ne("p2p-webrtc-star")),F(p,ne("p2p-webrtc-star"))),b=G(F(y,ne("p2p-websocket-star"),ne("p2p")),F(p,ne("p2p-websocket-star"),ne("p2p")),F(y,ne("p2p-websocket-star")),F(p,ne("p2p-websocket-star"))),_=G(F(v,ne("p2p-webrtc-direct"),ne("p2p")),F(d,ne("p2p-webrtc-direct"),ne("p2p")),F(v,ne("p2p-webrtc-direct")),F(d,ne("p2p-webrtc-direct"))),m=G(y,p,v,d,g,_,l,h,f,a),E=G(F(m,ne("p2p-stardust"),ne("p2p")),F(m,ne("p2p-stardust"))),D=G(F(m,ne("p2p")),g,_,ne("p2p")),N=G(F(D,ne("p2p-circuit"),D),F(D,ne("p2p-circuit")),F(ne("p2p-circuit"),D),F(m,ne("p2p-circuit")),F(ne("p2p-circuit"),m),ne("p2p-circuit")),R=()=>G(F(N,R),N),T=R(),S=G(F(T,D,T),F(D,T),F(T,D),T,D);t.exports={DNS:a,DNS4:n,DNS6:i,DNSADDR:s,IP:o,TCP:l,UDP:u,QUIC:f,UTP:h,HTTP:v,HTTPS:d,WebSockets:y,WebSocketsSecure:p,WebSocketStar:b,WebRTCStar:g,WebRTCDirect:_,Reliable:m,Stardust:E,Circuit:T,P2P:S,IPFS:S};function O(Y){function ce(oe){if(!r.isMultiaddr(oe))try{oe=new r(oe)}catch{return!1}let H=Y(oe.protoNames());return H===null?!1:H===!0||H===!1?H:H.length===0}return ce}function F(...Y){function ce(oe){if(oe.length<Y.length)return null;let H=oe;return Y.some(W=>(H=typeof W=="function"?W().partialMatch(oe):W.partialMatch(oe),Array.isArray(H)&&(oe=H),H===null)),H}return{toString:function(){return"{ "+Y.join(" ")+" }"},input:Y,matches:O(ce),partialMatch:ce}}function G(...Y){function ce(oe){let H=null;return Y.some(W=>{let de=typeof W=="function"?W().partialMatch(oe):W.partialMatch(oe);return de?(H=de,!0):!1}),H}return{toString:function(){return"{ "+Y.join(" ")+" }"},input:Y,matches:O(ce),partialMatch:ce}}function ne(Y){let ce=Y;function oe(W){let de;if(typeof W=="string"||W instanceof Uint8Array)try{de=new r(W)}catch{return!1}else de=W;let De=de.protoNames();return De.length===1&&De[0]===ce}function H(W){return W.length===0?null:W[0]===ce?W.slice(1):null}return{toString:function(){return ce},matches:oe,partialMatch:H}}}),DS=A((e,t)=>{"use strict";c();var r=typeof navigator<"u"&&navigator.product==="ReactNative";function n(){return r?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}var i=self.URL,s=n(),a=class{constructor(l="",u=s){this.super=new i(l,u),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(l){this.super.hash=l}set host(l){this.super.host=l}set hostname(l){this.super.hostname=l}set href(l){this.super.href=l}set password(l){this.super.password=l}set pathname(l){this.super.pathname=l}set port(l){this.super.port=l}set protocol(l){this.super.protocol=l}set search(l){this.super.search=l}set username(l){this.super.username=l}static createObjectURL(l){return i.createObjectURL(l)}static revokeObjectURL(l){i.revokeObjectURL(l)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function o(l){if(typeof l=="string")return new i(l).toString();if(!(l instanceof i)){let u=l.username&&l.password?`${l.username}:${l.password}@`:"",h=l.auth?l.auth+"@":"",f=l.port?":"+l.port:"",y=l.protocol?l.protocol+"//":"",p=l.host||"",v=l.hostname||"",d=l.search||(l.query?"?"+l.query:""),g=l.hash||"",b=l.pathname||"",_=l.path||b+d;return`${y}${u||h}${p||v+f}${_}${g}`}}t.exports={URLWithLegacySupport:a,URLSearchParams:self.URLSearchParams,defaultBase:s,format:o}}),pU=A((e,t)=>{"use strict";c();var{URLWithLegacySupport:r,format:n}=DS();t.exports=(i,s={},a={},o)=>{let l=s.protocol?s.protocol.replace(":",""):"http";l=(a[l]||o||l)+":";let u;try{u=new r(i)}catch{u={}}let h=Object.assign({},s,{protocol:l||u.protocol,host:s.host||u.host});return new r(i,n(h)).toString()}}),ww=A((e,t)=>{"use strict";c();var{URLWithLegacySupport:r,format:n,URLSearchParams:i,defaultBase:s}=DS(),a=pU();t.exports={URL:r,URLSearchParams:i,format:n,relative:a,defaultBase:s}}),m2=A((e,t)=>{"use strict";c();var{base58btc:r}=(Hr(),cr(ap)),{base32:n}=(si(),cr(Vm)),i=(On(),cr(xn)),{Multiaddr:s}=mw(),a=uU(),{CID:o}=(te(),cr(Ym)),{URL:l}=ww(),{toString:u}=(me(),cr(Ap)),h=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,f=/^\/(ip[fn]s)\/([^/?#]+)/,y=1,p=2,v=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,d=1,g=2,b=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function _(W){let de=O(W);try{i.decode(r.decode("z"+de))}catch{return!1}return!0}function m(W){try{n.decode(W)}catch{return!1}return!0}function E(W){try{return typeof W=="string"?Boolean(o.parse(W)):W instanceof Uint8Array?Boolean(o.decode(W)):Boolean(o.asCID(W))}catch{return!1}}function D(W){if(!W)return!1;if(s.isMultiaddr(W))return!0;try{return new s(W),!0}catch{return!1}}function N(W){return D(W)&&a.P2P.matches(W)}function R(W,de,De=y,Pe=p){let $e=O(W);if(!$e)return!1;let Be=$e.match(de);if(!Be||Be[De]!=="ipfs")return!1;let nt=Be[Pe];return nt&&de===v&&(nt=nt.toLowerCase()),E(nt)}function T(W,de,De=y,Pe=p){let $e=O(W);if(!$e)return!1;let Be=$e.match(de);if(!Be||Be[De]!=="ipns")return!1;let nt=Be[Pe];if(nt&&de===v){if(nt=nt.toLowerCase(),E(nt))return!0;try{!nt.includes(".")&&nt.includes("-")&&(nt=nt.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:Ve}=new l(`http://${nt}`);return b.test(Ve)}catch{return!1}}return!0}function S(W){return typeof W=="string"}function O(W){return W instanceof Uint8Array?u(W,"base58btc"):S(W)?W:!1}var F=W=>R(W,v,g,d),G=W=>T(W,v,g,d),ne=W=>F(W)||G(W),Y=W=>R(W,h)||F(W),ce=W=>T(W,h)||G(W),oe=W=>Y(W)||ce(W)||ne(W),H=W=>R(W,f)||T(W,f);t.exports={multihash:_,multiaddr:D,peerMultiaddr:N,cid:E,base32cid:W=>m(W)&&E(W),ipfsSubdomain:F,ipnsSubdomain:G,subdomain:ne,subdomainGatewayPattern:v,ipfsUrl:Y,ipnsUrl:ce,url:oe,pathGatewayPattern:h,ipfsPath:W=>R(W,f),ipnsPath:W=>T(W,f),path:H,pathPattern:f,urlOrPath:W=>oe(W)||H(W),cidPath:W=>S(W)&&!E(W)&&R(`/ipfs/${W}`,f)}}),CU,PU=Fe(()=>{c(),CU="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"}),MS={};ct(MS,{customAlphabet:()=>gye,customRandom:()=>kU,nanoid:()=>jf,random:()=>DU,urlAlphabet:()=>CU});var DU,kU,gye,jf,Lp=Fe(()=>{c(),PU(),DU=e=>crypto.getRandomValues(new Uint8Array(e)),kU=(e,t,r)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*n*t/e.length);return(s=t)=>{let a="";for(;;){let o=r(i),l=i;for(;l--;)if(a+=e[o[l]&n]||"",a.length===s)return a}}},gye=(e,t=21)=>kU(e,t,DU),jf=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,r)=>(r&=63,r<36?t+=r.toString(36):r<62?t+=(r-26).toString(36).toUpperCase():r>62?t+="-":t+="_",t),"")}),LU=A((e,t)=>{"use strict";c(),t.exports=function(){return Date.now()}}),y2=A((e,t)=>{"use strict";c();var r=LU(),n=class{constructor(s,a,o){let l=this;this._started=r(),this._rescheduled=0,this._scheduled=a,this._args=o,this._triggered=!1,this._timerWrapper=()=>{l._rescheduled>0?(l._scheduled=l._rescheduled-(r()-l._started),l._schedule(l._scheduled)):(l._triggered=!0,s.apply(null,l._args))},this._timer=setTimeout(this._timerWrapper,a)}reschedule(s){s||(s=this._scheduled);let a=r();a+s-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(s)):this._triggered?this._schedule(s):(this._started=a,this._rescheduled=s)}_schedule(s){this._triggered=!1,this._started=r(),this._rescheduled=0,this._scheduled=s,this._timer=setTimeout(this._timerWrapper,s)}clear(){clearTimeout(this._timer)}};function i(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let s;if(arguments.length>0){s=new Array(arguments.length-2);for(var a=0;a<s.length;a++)s[a]=arguments[a+2]}return new n(arguments[0],arguments[1],s)}t.exports=i}),$o=A((e,t)=>{"use strict";c();var{AbortController:r}=globalThis,n=y2(),i=class extends r{constructor(s){super(),this._ms=s,this._timer=n(()=>this.abort(),s),Object.setPrototypeOf(this,i.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=n(()=>this.abort(),this._ms)}};t.exports={TimeoutController:i}}),Vi=A((e,t)=>{c();function r(n){let i=new globalThis.AbortController;function s(){i.abort();for(let a of n)!a||!a.removeEventListener||a.removeEventListener("abort",s)}for(let a of n)if(!(!a||!a.addEventListener)){if(a.aborted){s();break}a.addEventListener("abort",s)}return i.signal}t.exports=r,t.exports.anySignal=r}),Mp=A((e,t)=>{c(),t.exports=function(r){if(!r)throw Error("hashlru must have a max value, of type number, greater than 0");var n=0,i=Object.create(null),s=Object.create(null);function a(o,l){i[o]=l,n++,n>=r&&(n=0,s=i,i=Object.create(null))}return{has:function(o){return i[o]!==void 0||s[o]!==void 0},remove:function(o){i[o]!==void 0&&(i[o]=void 0),s[o]!==void 0&&(s[o]=void 0)},get:function(o){var l=i[o];if(l!==void 0)return l;if((l=s[o])!==void 0)return a(o,l),l},set:function(o,l){i[o]!==void 0?i[o]=l:a(o,l)},clear:function(){i=Object.create(null),s=Object.create(null)}}}}),Xu=A((e,t)=>{"use strict";c();var r=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function s(u,h,f){this.fn=u,this.context=h,this.once=f||!1}function a(u,h,f,y,p){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new s(f,y||u,p),d=n?n+h:h;return u._events[d]?u._events[d].fn?u._events[d]=[u._events[d],v]:u._events[d].push(v):(u._events[d]=v,u._eventsCount++),u}function o(u,h){--u._eventsCount===0?u._events=new i:delete u._events[h]}function l(){this._events=new i,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],h,f;if(this._eventsCount===0)return u;for(f in h=this._events)r.call(h,f)&&u.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},l.prototype.listeners=function(u){var h=n?n+u:u,f=this._events[h];if(!f)return[];if(f.fn)return[f.fn];for(var y=0,p=f.length,v=new Array(p);y<p;y++)v[y]=f[y].fn;return v},l.prototype.listenerCount=function(u){var h=n?n+u:u,f=this._events[h];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,h,f,y,p,v){var d=n?n+u:u;if(!this._events[d])return!1;var g=this._events[d],b=arguments.length,_,m;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),b){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,h),!0;case 3:return g.fn.call(g.context,h,f),!0;case 4:return g.fn.call(g.context,h,f,y),!0;case 5:return g.fn.call(g.context,h,f,y,p),!0;case 6:return g.fn.call(g.context,h,f,y,p,v),!0}for(m=1,_=new Array(b-1);m<b;m++)_[m-1]=arguments[m];g.fn.apply(g.context,_)}else{var E=g.length,D;for(m=0;m<E;m++)switch(g[m].once&&this.removeListener(u,g[m].fn,void 0,!0),b){case 1:g[m].fn.call(g[m].context);break;case 2:g[m].fn.call(g[m].context,h);break;case 3:g[m].fn.call(g[m].context,h,f);break;case 4:g[m].fn.call(g[m].context,h,f,y);break;default:if(!_)for(D=1,_=new Array(b-1);D<b;D++)_[D-1]=arguments[D];g[m].fn.apply(g[m].context,_)}}return!0},l.prototype.on=function(u,h,f){return a(this,u,h,f,!1)},l.prototype.once=function(u,h,f){return a(this,u,h,f,!0)},l.prototype.removeListener=function(u,h,f,y){var p=n?n+u:u;if(!this._events[p])return this;if(!h)return o(this,p),this;var v=this._events[p];if(v.fn)v.fn===h&&(!y||v.once)&&(!f||v.context===f)&&o(this,p);else{for(var d=0,g=[],b=v.length;d<b;d++)(v[d].fn!==h||y&&!v[d].once||f&&v[d].context!==f)&&g.push(v[d]);g.length?this._events[p]=g.length===1?g[0]:g:o(this,p)}return this},l.prototype.removeAllListeners=function(u){var h;return u?(h=n?n+u:u,this._events[h]&&o(this,h)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,typeof t<"u"&&(t.exports=l)}),XS=A(e=>{"use strict";c();var t=class extends Error{constructor(i="Request timed out"){super(i),this.name="TimeoutError"}};e.TimeoutError=t;var r=class extends Error{constructor(i="The operation was aborted."){super(i),this.name="AbortError"}};e.AbortError=r;var n=class extends Error{constructor(i){super(i.statusText),this.name="HTTPError",this.response=i}};e.HTTPError=n}),T2=A((e,t)=>{"use strict";c();var r=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof n<"u")return n;throw new Error("unable to locate global object")},n=r();t.exports=e=n.fetch,n.fetch&&(e.default=n.fetch.bind(n)),e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response}),cF=A((e,t)=>{"use strict";c(),globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?t.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:t.exports={default:T2().default,Headers:T2().Headers,Request:T2().Request,Response:T2().Response}}),lF=A((e,t)=>{"use strict";c(),t.exports=cF()}),dF=A((e,t)=>{"use strict";c();var{TimeoutError:r,AbortError:n}=XS(),{Response:i,Request:s,Headers:a,default:o}=lF(),l=(p,v={})=>{let d=new XMLHttpRequest;d.open(v.method||"GET",p.toString(),!0);let{timeout:g,headers:b}=v;if(g&&g>0&&g<1/0&&(d.timeout=g),v.overrideMimeType!=null&&d.overrideMimeType(v.overrideMimeType),b)for(let[_,m]of new a(b))d.setRequestHeader(_,m);return v.signal&&(v.signal.onabort=()=>d.abort()),v.onUploadProgress&&(d.upload.onprogress=v.onUploadProgress),d.responseType="arraybuffer",new Promise((_,m)=>{let E=D=>{switch(D.type){case"error":{_(i.error());break}case"load":{_(new y(d.responseURL,d.response,{status:d.status,statusText:d.statusText,headers:f(d.getAllResponseHeaders())}));break}case"timeout":{m(new r);break}case"abort":{m(new n);break}default:break}};d.onerror=E,d.onload=E,d.ontimeout=E,d.onabort=E,d.send(v.body)})},u=o,h=(p,v={})=>v.onUploadProgress!=null?l(p,v):u(p,v),f=p=>{let v=new a;for(let d of p.trim().split(/[\r\n]+/)){let g=d.indexOf(": ");g>0&&v.set(d.slice(0,g),d.slice(g+1))}return v},y=class extends i{constructor(p,v,d){super(v,d),Object.defineProperty(this,"url",{value:p})}};t.exports={fetch:h,Request:s,Headers:a}}),Vp=A((e,t)=>{"use strict";c();var{fetch:r,Request:n,Headers:i}=dF(),{TimeoutError:s,HTTPError:a}=XS(),o=z7().bind({ignoreUndefined:!0}),{URL:l,URLSearchParams:u}=ww(),h=Vi(),f=(m,E,D)=>{if(E===void 0)return m;let N=Date.now(),R=()=>Date.now()-N>=E;return new Promise((T,S)=>{let O=setTimeout(()=>{R()&&(S(new s),D.abort())},E),F=G=>ne=>{if(clearTimeout(O),R()){S(new s);return}G(ne)};m.then(F(T),F(S))})},y={throwHttpErrors:!0,credentials:"same-origin"},p=class{constructor(m={}){this.opts=o(y,m)}async fetch(m,E={}){let D=o(this.opts,E),N=new i(D.headers);if(typeof m!="string"&&!(m instanceof l||m instanceof n))throw new TypeError("`resource` must be a string, URL, or Request");let R=new l(m.toString(),D.base),{searchParams:T,transformSearchParams:S,json:O}=D;T&&(typeof S=="function"?R.search=S(new u(D.searchParams)):R.search=new u(D.searchParams)),O&&(D.body=JSON.stringify(D.json),N.set("content-type","application/json"));let F=new AbortController,G=h([F.signal,D.signal]),ne=await f(r(R.toString(),{...D,signal:G,timeout:void 0,headers:N}),D.timeout,F);if(!ne.ok&&D.throwHttpErrors)throw D.handleError&&await D.handleError(ne),new a(ne);return ne.iterator=async function*(){yield*d(ne.body)},ne.ndjson=async function*(){for await(let Y of v(ne.iterator()))E.transform?yield E.transform(Y):yield Y},ne}post(m,E={}){return this.fetch(m,{...E,method:"POST"})}get(m,E={}){return this.fetch(m,{...E,method:"GET"})}put(m,E={}){return this.fetch(m,{...E,method:"PUT"})}delete(m,E={}){return this.fetch(m,{...E,method:"DELETE"})}options(m,E={}){return this.fetch(m,{...E,method:"OPTIONS"})}},v=async function*(m){let E=new TextDecoder,D="";for await(let N of m){D+=E.decode(N,{stream:!0});let R=D.split(/\r?\n/);for(let T=0;T<R.length-1;T++){let S=R[T].trim();S.length>0&&(yield JSON.parse(S))}D=R[R.length-1]}D+=E.decode(),D=D.trim(),D.length!==0&&(yield JSON.parse(D))},d=m=>{if(_(m)){let E=m[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:E.next.bind(E),return(D){return m.destroy(),typeof E.return=="function"?E.return():Promise.resolve({done:!0,value:D})}}}}}if(b(m)){let E=m.getReader();return async function*(){try{for(;;){let{done:D,value:N}=await E.read();if(D)return;N&&(yield N)}}finally{E.releaseLock()}}()}if(g(m))return m;throw new TypeError("Body can't be converted to AsyncIterable")},g=m=>typeof m=="object"&&m!==null&&typeof m[Symbol.asyncIterator]=="function",b=m=>m&&typeof m.getReader=="function",_=m=>Object.prototype.hasOwnProperty.call(m,"readable")&&Object.prototype.hasOwnProperty.call(m,"writable");p.HTTPError=a,p.TimeoutError=s,p.streamToAsyncIterator=d,p.post=(m,E)=>new p(E).post(m,E),p.get=(m,E)=>new p(E).get(m,E),p.put=(m,E)=>new p(E).put(m,E),p.delete=(m,E)=>new p(E).delete(m,E),p.options=(m,E)=>new p(E).options(m,E),t.exports=p}),qi=A((e,t)=>{"use strict";c();var r=async n=>{let i;for await(let s of n)i=s;return i};t.exports=r}),UF=A((e,t)=>{c();var r=function(){typeof t<"u"&&(t.exports=E);var n=24*3600,i=3200,s=(365*400+97)*i/400,a=n*s,o=a*1e3,l=1e3*1e4*1e4*n,u=16777216,h=65536*65536,f=1e3*1e3,y=1e3*1e3*1e3,p="000000000",v=Math.trunc||Pe,d=E.prototype;E.fromDate=G,E.fromInt64BE=de(0,1,2,3,0,4),E.fromInt64LE=de(3,2,1,0,4,0),E.fromString=F,E.fromTimeT=ne,d.year=0,d.time=0,d.nano=0,d.addNano=S,d.getNano=O,d.getTimeT=ce,d.getYear=D,d.toDate=R,d.toJSON=oe,d.toString=H,d.writeInt64BE=W(0,1,2,3,0,4),d.writeInt64LE=W(3,2,1,0,4,0);var g="%Y-%m-%dT%H:%M:%S.%NZ",b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],_=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],m={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return E;function E(Ve,et,ht){var Z=this;if(!(Z instanceof E))return new E(Ve,et,ht);Z.time=+Ve||0,Z.nano=+et||0,Z.year=+ht||0,N(Z)}function D(){var Ve=this.toDate().getUTCFullYear();return Ve+this.year}function N(Ve){var et=Ve.year,ht=Ve.time,Z=Ve.nano,le,ke;if(Z<0||f<=Z){var Ge=Math.floor(Z/f);Z-=Ge*f,ht+=Ge,le=1}var ft=et%i;if(ht<-l||l<ht||ft){ke=v(ht/o),ke&&(et+=ke*i,ht-=ke*o);var yt=T(ht);yt.setUTCFullYear(ft+yt.getUTCFullYear()),et-=ft,ht=+yt,ke=v(et/i);var V=ht+ke*o;ke&&-l<=V&&V<=l&&(et-=ke*i,ht=V),le=1}return le&&(Ve.year=et,Ve.time=ht,Ve.nano=Z),Ve}function R(){var Ve=N(this);return T(Ve.time)}function T(Ve){var et=new Date(0);return et.setTime(Ve),et}function S(Ve){return this.nano+=+Ve||0,this}function O(){var Ve=N(this);return(Ve.time%1e3*f+ +Ve.nano+y)%y}function F(Ve){var et,ht=new E;Ve+="";var Z=Ve.replace(/^\s*[+\-]?\d+/,function(le){var ke=+le,Ge=1970+(ke-1970)%400;return ht.year=ke-Ge,Ge}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(le,ke,Ge){return ke<0&&(Ge*=-1),et=(+ke*60+ +Ge)*6e4,""}).replace(/\.\d+$/,function(le){return ht.nano=+(le+p).substr(1,9),""}).split(/\D+/);if(Z.length>1?Z[1]--:Z[1]=0,ht.time=et=Date.UTC.apply(Date,Z)-(et||0),isNaN(et))throw new TypeError("Invalid Date");return N(ht)}function G(Ve){return new E(+Ve)}function ne(Ve){return Y(Ve,0)}function Y(Ve,et){et|=0,et*=h,Ve=+Ve||0;var ht=v(et/a)+v(Ve/a),Z=et%a+Ve%a,le=v(Z/a);return le&&(ht+=le,Z-=le*a),new E(Z*1e3,0,ht*i)}function ce(){var Ve=N(this),et=Math.floor(Ve.time/1e3),ht=Ve.year;return ht&&(et+=ht*s*n/i),et}function oe(){return this.toString().replace(/0{1,6}Z$/,"Z")}function H(Ve){var et=this,ht=et.toDate(),Z={H:V,L:tt,M:z,N:Ft,S:Oe,Y:ke,a:Dt,b:Lt,d:ft,e:yt,m:Ge};return le(Ve||g);function le($t){return $t.replace(/%./g,function(Wt){var lr=Wt[1],Cr=m[lr],sr=Z[lr];return Cr?le(Cr):sr?sr():Wt})}function ke(){var $t=et.getYear();return $t>999999?"+"+$t:$t>9999?"+"+nt($t,6):$t>=0?nt($t,4):$t>=-999999?"-"+nt(-$t,6):$t}function Ge(){return Be(ht.getUTCMonth()+1)}function ft(){return Be(ht.getUTCDate())}function yt(){return $e(ht.getUTCDate())}function V(){return Be(ht.getUTCHours())}function z(){return Be(ht.getUTCMinutes())}function Oe(){return Be(ht.getUTCSeconds())}function tt(){return nt(ht.getUTCMilliseconds(),3)}function Ft(){return nt(et.getNano(),9)}function Dt(){return _[ht.getUTCDay()]}function Lt(){return b[ht.getUTCMonth()]}}function W(Ve,et,ht,Z,le,ke){return Ge;function Ge(yt,V){var z=N(this);yt||(yt=new Array(8)),De(yt,V|=0);var Oe=Math.floor(z.time/1e3),tt=z.year*(s*n/i),Ft=v(tt/h)+v(Oe/h),Dt=tt%h+Oe%h,Lt=Math.floor(Dt/h);return Lt&&(Ft+=Lt,Dt-=Lt*h),ft(yt,V+le,Ft),ft(yt,V+ke,Dt),yt}function ft(yt,V,z){yt[V+Ve]=z>>24&255,yt[V+et]=z>>16&255,yt[V+ht]=z>>8&255,yt[V+Z]=z&255}}function de(Ve,et,ht,Z,le,ke){return Ge;function Ge(yt,V){De(yt,V|=0);var z=ft(yt,V+le),Oe=ft(yt,V+ke);return Y(Oe,z)}function ft(yt,V){return yt[V+Ve]*u+(yt[V+et]<<16|yt[V+ht]<<8|yt[V+Z])}}function De(Ve,et){var ht=Ve&&Ve.length;if(ht==null)throw new TypeError("Invalid Buffer");if(ht<et+8)throw new RangeError("Out of range")}function Pe(Ve){var et=Ve-Ve%1;return et===0&&(Ve<0||Ve===0&&1/Ve!==1/0)?-0:et}function $e(Ve){return(Ve>9?"":" ")+(Ve|0)}function Be(Ve){return(Ve>9?"":"0")+(Ve|0)}function nt(Ve,et){return(p+(Ve|0)).substr(-et)}}()}),st=A((e,t)=>{c(),t.exports={options:{usePureJavaScript:!1}}}),iK=A((e,t)=>{c();var r={};t.exports=r;var n={};r.encode=function(s,a,o){if(typeof a!="string")throw new TypeError('"alphabet" must be a string.');if(o!==void 0&&typeof o!="number")throw new TypeError('"maxline" must be a number.');var l="";if(!(s instanceof Uint8Array))l=i(s,a);else{var u=0,h=a.length,f=a.charAt(0),y=[0];for(u=0;u<s.length;++u){for(var p=0,v=s[u];p<y.length;++p)v+=y[p]<<8,y[p]=v%h,v=v/h|0;for(;v>0;)y.push(v%h),v=v/h|0}for(u=0;s[u]===0&&u<s.length-1;++u)l+=f;for(u=y.length-1;u>=0;--u)l+=a[y[u]]}if(o){var d=new RegExp(".{1,"+o+"}","g");l=l.match(d).join(`\r
`)}return l},r.decode=function(s,a){if(typeof s!="string")throw new TypeError('"input" must be a string.');if(typeof a!="string")throw new TypeError('"alphabet" must be a string.');var o=n[a];if(!o){o=n[a]=[];for(var l=0;l<a.length;++l)o[a.charCodeAt(l)]=l}s=s.replace(/\s/g,"");for(var u=a.length,h=a.charAt(0),f=[0],l=0;l<s.length;l++){var y=o[s.charCodeAt(l)];if(y===void 0)return;for(var p=0,v=y;p<f.length;++p)v+=f[p]*u,f[p]=v&255,v>>=8;for(;v>0;)f.push(v&255),v>>=8}for(var d=0;s[d]===h&&d<s.length-1;++d)f.push(0);return typeof Buffer<"u"?Buffer.from(f.reverse()):new Uint8Array(f.reverse())};function i(s,a){var o=0,l=a.length,u=a.charAt(0),h=[0];for(o=0;o<s.length();++o){for(var f=0,y=s.at(o);f<h.length;++f)y+=h[f]<<8,h[f]=y%l,y=y/l|0;for(;y>0;)h.push(y%l),y=y/l|0}var p="";for(o=0;s.at(o)===0&&o<s.length()-1;++o)p+=u;for(o=h.length-1;o>=0;--o)p+=a[h[o]];return p}}),gr=A((e,t)=>{c();var r=st(),n=iK(),i=t.exports=r.util=r.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){i.nextTick=process.nextTick,typeof setImmediate=="function"?i.setImmediate=setImmediate:i.setImmediate=i.nextTick;return}if(typeof setImmediate=="function"){i.setImmediate=function(){return setImmediate.apply(void 0,arguments)},i.nextTick=function(O){return setImmediate(O)};return}if(i.setImmediate=function(O){setTimeout(O,0)},typeof window<"u"&&typeof window.postMessage=="function"){let O=function(F){if(F.source===window&&F.data===E){F.stopPropagation();var G=D.slice();D.length=0,G.forEach(function(ne){ne()})}};var m=O,E="forge.setImmediate",D=[];i.setImmediate=function(F){D.push(F),D.length===1&&window.postMessage(E,"*")},window.addEventListener("message",O,!0)}if(typeof MutationObserver<"u"){var N=Date.now(),R=!0,T=document.createElement("div"),D=[];new MutationObserver(function(){var F=D.slice();D.length=0,F.forEach(function(G){G()})}).observe(T,{attributes:!0});var S=i.setImmediate;i.setImmediate=function(F){Date.now()-N>15?(N=Date.now(),S(F)):(D.push(F),D.length===1&&T.setAttribute("a",R=!R))}}i.nextTick=i.setImmediate})(),i.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,i.globalScope=function(){return i.isNodejs?globalThis:typeof self>"u"?window:self}(),i.isArray=Array.isArray||function(m){return Object.prototype.toString.call(m)==="[object Array]"},i.isArrayBuffer=function(m){return typeof ArrayBuffer<"u"&&m instanceof ArrayBuffer},i.isArrayBufferView=function(m){return m&&i.isArrayBuffer(m.buffer)&&m.byteLength!==void 0};function s(m){if(!(m===8||m===16||m===24||m===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+m)}i.ByteBuffer=a;function a(m){if(this.data="",this.read=0,typeof m=="string")this.data=m;else if(i.isArrayBuffer(m)||i.isArrayBufferView(m))if(typeof Buffer<"u"&&m instanceof Buffer)this.data=m.toString("binary");else{var E=new Uint8Array(m);try{this.data=String.fromCharCode.apply(null,E)}catch{for(var D=0;D<E.length;++D)this.putByte(E[D])}}else(m instanceof a||typeof m=="object"&&typeof m.data=="string"&&typeof m.read=="number")&&(this.data=m.data,this.read=m.read);this._constructedStringLength=0}i.ByteStringBuffer=a;var o=4096;i.ByteStringBuffer.prototype._optimizeConstructedString=function(m){this._constructedStringLength+=m,this._constructedStringLength>o&&(this.data.substr(0,1),this._constructedStringLength=0)},i.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},i.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},i.ByteStringBuffer.prototype.putByte=function(m){return this.putBytes(String.fromCharCode(m))},i.ByteStringBuffer.prototype.fillWithByte=function(m,E){m=String.fromCharCode(m);for(var D=this.data;E>0;)E&1&&(D+=m),E>>>=1,E>0&&(m+=m);return this.data=D,this._optimizeConstructedString(E),this},i.ByteStringBuffer.prototype.putBytes=function(m){return this.data+=m,this._optimizeConstructedString(m.length),this},i.ByteStringBuffer.prototype.putString=function(m){return this.putBytes(i.encodeUtf8(m))},i.ByteStringBuffer.prototype.putInt16=function(m){return this.putBytes(String.fromCharCode(m>>8&255)+String.fromCharCode(m&255))},i.ByteStringBuffer.prototype.putInt24=function(m){return this.putBytes(String.fromCharCode(m>>16&255)+String.fromCharCode(m>>8&255)+String.fromCharCode(m&255))},i.ByteStringBuffer.prototype.putInt32=function(m){return this.putBytes(String.fromCharCode(m>>24&255)+String.fromCharCode(m>>16&255)+String.fromCharCode(m>>8&255)+String.fromCharCode(m&255))},i.ByteStringBuffer.prototype.putInt16Le=function(m){return this.putBytes(String.fromCharCode(m&255)+String.fromCharCode(m>>8&255))},i.ByteStringBuffer.prototype.putInt24Le=function(m){return this.putBytes(String.fromCharCode(m&255)+String.fromCharCode(m>>8&255)+String.fromCharCode(m>>16&255))},i.ByteStringBuffer.prototype.putInt32Le=function(m){return this.putBytes(String.fromCharCode(m&255)+String.fromCharCode(m>>8&255)+String.fromCharCode(m>>16&255)+String.fromCharCode(m>>24&255))},i.ByteStringBuffer.prototype.putInt=function(m,E){s(E);var D="";do E-=8,D+=String.fromCharCode(m>>E&255);while(E>0);return this.putBytes(D)},i.ByteStringBuffer.prototype.putSignedInt=function(m,E){return m<0&&(m+=2<<E-1),this.putInt(m,E)},i.ByteStringBuffer.prototype.putBuffer=function(m){return this.putBytes(m.getBytes())},i.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},i.ByteStringBuffer.prototype.getInt16=function(){var m=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,m},i.ByteStringBuffer.prototype.getInt24=function(){var m=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,m},i.ByteStringBuffer.prototype.getInt32=function(){var m=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,m},i.ByteStringBuffer.prototype.getInt16Le=function(){var m=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,m},i.ByteStringBuffer.prototype.getInt24Le=function(){var m=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,m},i.ByteStringBuffer.prototype.getInt32Le=function(){var m=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,m},i.ByteStringBuffer.prototype.getInt=function(m){s(m);var E=0;do E=(E<<8)+this.data.charCodeAt(this.read++),m-=8;while(m>0);return E},i.ByteStringBuffer.prototype.getSignedInt=function(m){var E=this.getInt(m),D=2<<m-2;return E>=D&&(E-=D<<1),E},i.ByteStringBuffer.prototype.getBytes=function(m){var E;return m?(m=Math.min(this.length(),m),E=this.data.slice(this.read,this.read+m),this.read+=m):m===0?E="":(E=this.read===0?this.data:this.data.slice(this.read),this.clear()),E},i.ByteStringBuffer.prototype.bytes=function(m){return typeof m>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+m)},i.ByteStringBuffer.prototype.at=function(m){return this.data.charCodeAt(this.read+m)},i.ByteStringBuffer.prototype.setAt=function(m,E){return this.data=this.data.substr(0,this.read+m)+String.fromCharCode(E)+this.data.substr(this.read+m+1),this},i.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},i.ByteStringBuffer.prototype.copy=function(){var m=i.createBuffer(this.data);return m.read=this.read,m},i.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},i.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},i.ByteStringBuffer.prototype.truncate=function(m){var E=Math.max(0,this.length()-m);return this.data=this.data.substr(this.read,E),this.read=0,this},i.ByteStringBuffer.prototype.toHex=function(){for(var m="",E=this.read;E<this.data.length;++E){var D=this.data.charCodeAt(E);D<16&&(m+="0"),m+=D.toString(16)}return m},i.ByteStringBuffer.prototype.toString=function(){return i.decodeUtf8(this.bytes())};function l(m,E){E=E||{},this.read=E.readOffset||0,this.growSize=E.growSize||1024;var D=i.isArrayBuffer(m),N=i.isArrayBufferView(m);if(D||N){D?this.data=new DataView(m):this.data=new DataView(m.buffer,m.byteOffset,m.byteLength),this.write="writeOffset"in E?E.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,m!=null&&this.putBytes(m),"writeOffset"in E&&(this.write=E.writeOffset)}i.DataBuffer=l,i.DataBuffer.prototype.length=function(){return this.write-this.read},i.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},i.DataBuffer.prototype.accommodate=function(m,E){if(this.length()>=m)return this;E=Math.max(E||this.growSize,m);var D=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),N=new Uint8Array(this.length()+E);return N.set(D),this.data=new DataView(N.buffer),this},i.DataBuffer.prototype.putByte=function(m){return this.accommodate(1),this.data.setUint8(this.write++,m),this},i.DataBuffer.prototype.fillWithByte=function(m,E){this.accommodate(E);for(var D=0;D<E;++D)this.data.setUint8(m);return this},i.DataBuffer.prototype.putBytes=function(m,E){if(i.isArrayBufferView(m)){var D=new Uint8Array(m.buffer,m.byteOffset,m.byteLength),N=D.byteLength-D.byteOffset;this.accommodate(N);var R=new Uint8Array(this.data.buffer,this.write);return R.set(D),this.write+=N,this}if(i.isArrayBuffer(m)){var D=new Uint8Array(m);this.accommodate(D.byteLength);var R=new Uint8Array(this.data.buffer);return R.set(D,this.write),this.write+=D.byteLength,this}if(m instanceof i.DataBuffer||typeof m=="object"&&typeof m.read=="number"&&typeof m.write=="number"&&i.isArrayBufferView(m.data)){var D=new Uint8Array(m.data.byteLength,m.read,m.length());this.accommodate(D.byteLength);var R=new Uint8Array(m.data.byteLength,this.write);return R.set(D),this.write+=D.byteLength,this}if(m instanceof i.ByteStringBuffer&&(m=m.data,E="binary"),E=E||"binary",typeof m=="string"){var T;if(E==="hex")return this.accommodate(Math.ceil(m.length/2)),T=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.hex.decode(m,T,this.write),this;if(E==="base64")return this.accommodate(Math.ceil(m.length/4)*3),T=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.base64.decode(m,T,this.write),this;if(E==="utf8"&&(m=i.encodeUtf8(m),E="binary"),E==="binary"||E==="raw")return this.accommodate(m.length),T=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.raw.decode(T),this;if(E==="utf16")return this.accommodate(m.length*2),T=new Uint16Array(this.data.buffer,this.write),this.write+=i.text.utf16.encode(T),this;throw new Error("Invalid encoding: "+E)}throw Error("Invalid parameter: "+m)},i.DataBuffer.prototype.putBuffer=function(m){return this.putBytes(m),m.clear(),this},i.DataBuffer.prototype.putString=function(m){return this.putBytes(m,"utf16")},i.DataBuffer.prototype.putInt16=function(m){return this.accommodate(2),this.data.setInt16(this.write,m),this.write+=2,this},i.DataBuffer.prototype.putInt24=function(m){return this.accommodate(3),this.data.setInt16(this.write,m>>8&65535),this.data.setInt8(this.write,m>>16&255),this.write+=3,this},i.DataBuffer.prototype.putInt32=function(m){return this.accommodate(4),this.data.setInt32(this.write,m),this.write+=4,this},i.DataBuffer.prototype.putInt16Le=function(m){return this.accommodate(2),this.data.setInt16(this.write,m,!0),this.write+=2,this},i.DataBuffer.prototype.putInt24Le=function(m){return this.accommodate(3),this.data.setInt8(this.write,m>>16&255),this.data.setInt16(this.write,m>>8&65535,!0),this.write+=3,this},i.DataBuffer.prototype.putInt32Le=function(m){return this.accommodate(4),this.data.setInt32(this.write,m,!0),this.write+=4,this},i.DataBuffer.prototype.putInt=function(m,E){s(E),this.accommodate(E/8);do E-=8,this.data.setInt8(this.write++,m>>E&255);while(E>0);return this},i.DataBuffer.prototype.putSignedInt=function(m,E){return s(E),this.accommodate(E/8),m<0&&(m+=2<<E-1),this.putInt(m,E)},i.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},i.DataBuffer.prototype.getInt16=function(){var m=this.data.getInt16(this.read);return this.read+=2,m},i.DataBuffer.prototype.getInt24=function(){var m=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,m},i.DataBuffer.prototype.getInt32=function(){var m=this.data.getInt32(this.read);return this.read+=4,m},i.DataBuffer.prototype.getInt16Le=function(){var m=this.data.getInt16(this.read,!0);return this.read+=2,m},i.DataBuffer.prototype.getInt24Le=function(){var m=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,m},i.DataBuffer.prototype.getInt32Le=function(){var m=this.data.getInt32(this.read,!0);return this.read+=4,m},i.DataBuffer.prototype.getInt=function(m){s(m);var E=0;do E=(E<<8)+this.data.getInt8(this.read++),m-=8;while(m>0);return E},i.DataBuffer.prototype.getSignedInt=function(m){var E=this.getInt(m),D=2<<m-2;return E>=D&&(E-=D<<1),E},i.DataBuffer.prototype.getBytes=function(m){var E;return m?(m=Math.min(this.length(),m),E=this.data.slice(this.read,this.read+m),this.read+=m):m===0?E="":(E=this.read===0?this.data:this.data.slice(this.read),this.clear()),E},i.DataBuffer.prototype.bytes=function(m){return typeof m>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+m)},i.DataBuffer.prototype.at=function(m){return this.data.getUint8(this.read+m)},i.DataBuffer.prototype.setAt=function(m,E){return this.data.setUint8(m,E),this},i.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},i.DataBuffer.prototype.copy=function(){return new i.DataBuffer(this)},i.DataBuffer.prototype.compact=function(){if(this.read>0){var m=new Uint8Array(this.data.buffer,this.read),E=new Uint8Array(m.byteLength);E.set(m),this.data=new DataView(E),this.write-=this.read,this.read=0}return this},i.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},i.DataBuffer.prototype.truncate=function(m){return this.write=Math.max(0,this.length()-m),this.read=Math.min(this.read,this.write),this},i.DataBuffer.prototype.toHex=function(){for(var m="",E=this.read;E<this.data.byteLength;++E){var D=this.data.getUint8(E);D<16&&(m+="0"),m+=D.toString(16)}return m},i.DataBuffer.prototype.toString=function(m){var E=new Uint8Array(this.data,this.read,this.length());if(m=m||"utf8",m==="binary"||m==="raw")return i.binary.raw.encode(E);if(m==="hex")return i.binary.hex.encode(E);if(m==="base64")return i.binary.base64.encode(E);if(m==="utf8")return i.text.utf8.decode(E);if(m==="utf16")return i.text.utf16.decode(E);throw new Error("Invalid encoding: "+m)},i.createBuffer=function(m,E){return E=E||"raw",m!==void 0&&E==="utf8"&&(m=i.encodeUtf8(m)),new i.ByteBuffer(m)},i.fillString=function(m,E){for(var D="";E>0;)E&1&&(D+=m),E>>>=1,E>0&&(m+=m);return D},i.xorBytes=function(m,E,D){for(var N="",R="",T="",S=0,O=0;D>0;--D,++S)R=m.charCodeAt(S)^E.charCodeAt(S),O>=10&&(N+=T,T="",O=0),T+=String.fromCharCode(R),++O;return N+=T,N},i.hexToBytes=function(m){var E="",D=0;for(m.length&!0&&(D=1,E+=String.fromCharCode(parseInt(m[0],16)));D<m.length;D+=2)E+=String.fromCharCode(parseInt(m.substr(D,2),16));return E},i.bytesToHex=function(m){return i.createBuffer(m).toHex()},i.int32ToBytes=function(m){return String.fromCharCode(m>>24&255)+String.fromCharCode(m>>16&255)+String.fromCharCode(m>>8&255)+String.fromCharCode(m&255)};var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],f="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";i.encode64=function(m,E){for(var D="",N="",R,T,S,O=0;O<m.length;)R=m.charCodeAt(O++),T=m.charCodeAt(O++),S=m.charCodeAt(O++),D+=u.charAt(R>>2),D+=u.charAt((R&3)<<4|T>>4),isNaN(T)?D+="==":(D+=u.charAt((T&15)<<2|S>>6),D+=isNaN(S)?"=":u.charAt(S&63)),E&&D.length>E&&(N+=D.substr(0,E)+`\r
`,D=D.substr(E));return N+=D,N},i.decode64=function(m){m=m.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var E="",D,N,R,T,S=0;S<m.length;)D=h[m.charCodeAt(S++)-43],N=h[m.charCodeAt(S++)-43],R=h[m.charCodeAt(S++)-43],T=h[m.charCodeAt(S++)-43],E+=String.fromCharCode(D<<2|N>>4),R!==64&&(E+=String.fromCharCode((N&15)<<4|R>>2),T!==64&&(E+=String.fromCharCode((R&3)<<6|T)));return E},i.encodeUtf8=function(m){return unescape(encodeURIComponent(m))},i.decodeUtf8=function(m){return decodeURIComponent(escape(m))},i.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:n.encode,decode:n.decode}},i.binary.raw.encode=function(m){return String.fromCharCode.apply(null,m)},i.binary.raw.decode=function(m,E,D){var N=E;N||(N=new Uint8Array(m.length)),D=D||0;for(var R=D,T=0;T<m.length;++T)N[R++]=m.charCodeAt(T);return E?R-D:N},i.binary.hex.encode=i.bytesToHex,i.binary.hex.decode=function(m,E,D){var N=E;N||(N=new Uint8Array(Math.ceil(m.length/2))),D=D||0;var R=0,T=D;for(m.length&1&&(R=1,N[T++]=parseInt(m[0],16));R<m.length;R+=2)N[T++]=parseInt(m.substr(R,2),16);return E?T-D:N},i.binary.base64.encode=function(m,E){for(var D="",N="",R,T,S,O=0;O<m.byteLength;)R=m[O++],T=m[O++],S=m[O++],D+=u.charAt(R>>2),D+=u.charAt((R&3)<<4|T>>4),isNaN(T)?D+="==":(D+=u.charAt((T&15)<<2|S>>6),D+=isNaN(S)?"=":u.charAt(S&63)),E&&D.length>E&&(N+=D.substr(0,E)+`\r
`,D=D.substr(E));return N+=D,N},i.binary.base64.decode=function(m,E,D){var N=E;N||(N=new Uint8Array(Math.ceil(m.length/4)*3)),m=m.replace(/[^A-Za-z0-9\+\/\=]/g,""),D=D||0;for(var R,T,S,O,F=0,G=D;F<m.length;)R=h[m.charCodeAt(F++)-43],T=h[m.charCodeAt(F++)-43],S=h[m.charCodeAt(F++)-43],O=h[m.charCodeAt(F++)-43],N[G++]=R<<2|T>>4,S!==64&&(N[G++]=(T&15)<<4|S>>2,O!==64&&(N[G++]=(S&3)<<6|O));return E?G-D:N.subarray(0,G)},i.binary.base58.encode=function(m,E){return i.binary.baseN.encode(m,f,E)},i.binary.base58.decode=function(m,E){return i.binary.baseN.decode(m,f,E)},i.text={utf8:{},utf16:{}},i.text.utf8.encode=function(m,E,D){m=i.encodeUtf8(m);var N=E;N||(N=new Uint8Array(m.length)),D=D||0;for(var R=D,T=0;T<m.length;++T)N[R++]=m.charCodeAt(T);return E?R-D:N},i.text.utf8.decode=function(m){return i.decodeUtf8(String.fromCharCode.apply(null,m))},i.text.utf16.encode=function(m,E,D){var N=E;N||(N=new Uint8Array(m.length*2));var R=new Uint16Array(N.buffer);D=D||0;for(var T=D,S=D,O=0;O<m.length;++O)R[S++]=m.charCodeAt(O),T+=2;return E?T-D:N},i.text.utf16.decode=function(m){return String.fromCharCode.apply(null,new Uint16Array(m.buffer))},i.deflate=function(m,E,D){if(E=i.decode64(m.deflate(i.encode64(E)).rval),D){var N=2,R=E.charCodeAt(1);R&32&&(N=6),E=E.substring(N,E.length-4)}return E},i.inflate=function(m,E,D){var N=m.inflate(i.encode64(E)).rval;return N===null?null:i.decode64(N)};var y=function(m,E,D){if(!m)throw new Error("WebStorage not available.");var N;if(D===null?N=m.removeItem(E):(D=i.encode64(JSON.stringify(D)),N=m.setItem(E,D)),typeof N<"u"&&N.rval!==!0){var R=new Error(N.error.message);throw R.id=N.error.id,R.name=N.error.name,R}},p=function(m,E){if(!m)throw new Error("WebStorage not available.");var D=m.getItem(E);if(m.init)if(D.rval===null){if(D.error){var N=new Error(D.error.message);throw N.id=D.error.id,N.name=D.error.name,N}D=null}else D=D.rval;return D!==null&&(D=JSON.parse(i.decode64(D))),D},v=function(m,E,D,N){var R=p(m,E);R===null&&(R={}),R[D]=N,y(m,E,R)},d=function(m,E,D){var N=p(m,E);return N!==null&&(N=D in N?N[D]:null),N},g=function(m,E,D){var N=p(m,E);if(N!==null&&D in N){delete N[D];var R=!0;for(var T in N){R=!1;break}R&&(N=null),y(m,E,N)}},b=function(m,E){y(m,E,null)},_=function(m,E,D){var N=null;typeof D>"u"&&(D=["web","flash"]);var R,T=!1,S=null;for(var O in D){R=D[O];try{if(R==="flash"||R==="both"){if(E[0]===null)throw new Error("Flash local storage not available.");N=m.apply(this,E),T=R==="flash"}(R==="web"||R==="both")&&(E[0]=localStorage,N=m.apply(this,E),T=!0)}catch(F){S=F}if(T)break}if(!T)throw S;return N};i.setItem=function(m,E,D,N,R){_(v,arguments,R)},i.getItem=function(m,E,D,N){return _(d,arguments,N)},i.removeItem=function(m,E,D,N){_(g,arguments,N)},i.clearItems=function(m,E,D){_(b,arguments,D)},i.isEmpty=function(m){for(var E in m)if(m.hasOwnProperty(E))return!1;return!0},i.format=function(m){for(var E=/%./g,D,N,R=0,T=[],S=0;D=E.exec(m);){N=m.substring(S,E.lastIndex-2),N.length>0&&T.push(N),S=E.lastIndex;var O=D[0][1];switch(O){case"s":case"o":R<arguments.length?T.push(arguments[R+++1]):T.push("<?>");break;case"%":T.push("%");break;default:T.push("<%"+O+"?>")}}return T.push(m.substring(S)),T.join("")},i.formatNumber=function(m,E,D,N){var R=m,T=isNaN(E=Math.abs(E))?2:E,S=D===void 0?",":D,O=N===void 0?".":N,F=R<0?"-":"",G=parseInt(R=Math.abs(+R||0).toFixed(T),10)+"",ne=G.length>3?G.length%3:0;return F+(ne?G.substr(0,ne)+O:"")+G.substr(ne).replace(/(\d{3})(?=\d)/g,"$1"+O)+(T?S+Math.abs(R-G).toFixed(T).slice(2):"")},i.formatSize=function(m){return m>=1073741824?m=i.formatNumber(m/1073741824,2,".","")+" GiB":m>=1048576?m=i.formatNumber(m/1048576,2,".","")+" MiB":m>=1024?m=i.formatNumber(m/1024,0)+" KiB":m=i.formatNumber(m,0)+" bytes",m},i.bytesFromIP=function(m){return m.indexOf(".")!==-1?i.bytesFromIPv4(m):m.indexOf(":")!==-1?i.bytesFromIPv6(m):null},i.bytesFromIPv4=function(m){if(m=m.split("."),m.length!==4)return null;for(var E=i.createBuffer(),D=0;D<m.length;++D){var N=parseInt(m[D],10);if(isNaN(N))return null;E.putByte(N)}return E.getBytes()},i.bytesFromIPv6=function(m){var E=0;m=m.split(":").filter(function(S){return S.length===0&&++E,!0});for(var D=(8-m.length+E)*2,N=i.createBuffer(),R=0;R<8;++R){if(!m[R]||m[R].length===0){N.fillWithByte(0,D),D=0;continue}var T=i.hexToBytes(m[R]);T.length<2&&N.putByte(0),N.putBytes(T)}return N.getBytes()},i.bytesToIP=function(m){return m.length===4?i.bytesToIPv4(m):m.length===16?i.bytesToIPv6(m):null},i.bytesToIPv4=function(m){if(m.length!==4)return null;for(var E=[],D=0;D<m.length;++D)E.push(m.charCodeAt(D));return E.join(".")},i.bytesToIPv6=function(m){if(m.length!==16)return null;for(var E=[],D=[],N=0,R=0;R<m.length;R+=2){for(var T=i.bytesToHex(m[R]+m[R+1]);T[0]==="0"&&T!=="0";)T=T.substr(1);if(T==="0"){var S=D[D.length-1],O=E.length;!S||O!==S.end+1?D.push({start:O,end:O}):(S.end=O,S.end-S.start>D[N].end-D[N].start&&(N=D.length-1))}E.push(T)}if(D.length>0){var F=D[N];F.end-F.start>0&&(E.splice(F.start,F.end-F.start+1,""),F.start===0&&E.unshift(""),F.end===7&&E.push(""))}return E.join(":")},i.estimateCores=function(m,E){if(typeof m=="function"&&(E=m,m={}),m=m||{},"cores"in i&&!m.update)return E(null,i.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return i.cores=navigator.hardwareConcurrency,E(null,i.cores);if(typeof Worker>"u")return i.cores=1,E(null,i.cores);if(typeof Blob>"u")return i.cores=2,E(null,i.cores);var D=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(S){for(var O=Date.now(),F=O+4;Date.now()<F;);self.postMessage({st:O,et:F})})}.toString(),")()"],{type:"application/javascript"}));N([],5,16);function N(S,O,F){if(O===0){var G=Math.floor(S.reduce(function(ne,Y){return ne+Y},0)/S.length);return i.cores=Math.max(1,G),URL.revokeObjectURL(D),E(null,i.cores)}R(F,function(ne,Y){S.push(T(F,Y)),N(S,O-1,F)})}function R(S,O){for(var F=[],G=[],ne=0;ne<S;++ne){var Y=new Worker(D);Y.addEventListener("message",function(ce){if(G.push(ce.data),G.length===S){for(var oe=0;oe<S;++oe)F[oe].terminate();O(null,G)}}),F.push(Y)}for(var ne=0;ne<S;++ne)F[ne].postMessage(ne)}function T(S,O){for(var F=[],G=0;G<S;++G)for(var ne=O[G],Y=F[G]=[],ce=0;ce<S;++ce)if(G!==ce){var oe=O[ce];(ne.st>oe.st&&ne.st<oe.et||oe.st>ne.st&&oe.st<ne.et)&&Y.push(ce)}return F.reduce(function(H,W){return Math.max(H,W.length)},0)}}}),$p=A((e,t)=>{c();var r=st();r.pki=r.pki||{};var n=t.exports=r.pki.oids=r.oids=r.oids||{};function i(a,o){n[a]=o,n[o]=a}function s(a,o){n[a]=o}i("1.2.840.113549.1.1.1","rsaEncryption"),i("1.2.840.113549.1.1.4","md5WithRSAEncryption"),i("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),i("1.2.840.113549.1.1.7","RSAES-OAEP"),i("1.2.840.113549.1.1.8","mgf1"),i("1.2.840.113549.1.1.9","pSpecified"),i("1.2.840.113549.1.1.10","RSASSA-PSS"),i("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),i("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),i("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),i("1.3.101.112","EdDSA25519"),i("1.2.840.10040.4.3","dsa-with-sha1"),i("1.3.14.3.2.7","desCBC"),i("1.3.14.3.2.26","sha1"),i("1.3.14.3.2.29","sha1WithRSASignature"),i("2.16.840.1.101.3.4.2.1","sha256"),i("2.16.840.1.101.3.4.2.2","sha384"),i("2.16.840.1.101.3.4.2.3","sha512"),i("2.16.840.1.101.3.4.2.4","sha224"),i("2.16.840.1.101.3.4.2.5","sha512-224"),i("2.16.840.1.101.3.4.2.6","sha512-256"),i("1.2.840.113549.2.2","md2"),i("1.2.840.113549.2.5","md5"),i("1.2.840.113549.1.7.1","data"),i("1.2.840.113549.1.7.2","signedData"),i("1.2.840.113549.1.7.3","envelopedData"),i("1.2.840.113549.1.7.4","signedAndEnvelopedData"),i("1.2.840.113549.1.7.5","digestedData"),i("1.2.840.113549.1.7.6","encryptedData"),i("1.2.840.113549.1.9.1","emailAddress"),i("1.2.840.113549.1.9.2","unstructuredName"),i("1.2.840.113549.1.9.3","contentType"),i("1.2.840.113549.1.9.4","messageDigest"),i("1.2.840.113549.1.9.5","signingTime"),i("1.2.840.113549.1.9.6","counterSignature"),i("1.2.840.113549.1.9.7","challengePassword"),i("1.2.840.113549.1.9.8","unstructuredAddress"),i("1.2.840.113549.1.9.14","extensionRequest"),i("1.2.840.113549.1.9.20","friendlyName"),i("1.2.840.113549.1.9.21","localKeyId"),i("1.2.840.113549.1.9.22.1","x509Certificate"),i("1.2.840.113549.1.12.10.1.1","keyBag"),i("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),i("1.2.840.113549.1.12.10.1.3","certBag"),i("1.2.840.113549.1.12.10.1.4","crlBag"),i("1.2.840.113549.1.12.10.1.5","secretBag"),i("1.2.840.113549.1.12.10.1.6","safeContentsBag"),i("1.2.840.113549.1.5.13","pkcs5PBES2"),i("1.2.840.113549.1.5.12","pkcs5PBKDF2"),i("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),i("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),i("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),i("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),i("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),i("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),i("1.2.840.113549.2.7","hmacWithSHA1"),i("1.2.840.113549.2.8","hmacWithSHA224"),i("1.2.840.113549.2.9","hmacWithSHA256"),i("1.2.840.113549.2.10","hmacWithSHA384"),i("1.2.840.113549.2.11","hmacWithSHA512"),i("1.2.840.113549.3.7","des-EDE3-CBC"),i("2.16.840.1.101.3.4.1.2","aes128-CBC"),i("2.16.840.1.101.3.4.1.22","aes192-CBC"),i("2.16.840.1.101.3.4.1.42","aes256-CBC"),i("2.5.4.3","commonName"),i("2.5.4.4","surname"),i("2.5.4.5","serialNumber"),i("2.5.4.6","countryName"),i("2.5.4.7","localityName"),i("2.5.4.8","stateOrProvinceName"),i("2.5.4.9","streetAddress"),i("2.5.4.10","organizationName"),i("2.5.4.11","organizationalUnitName"),i("2.5.4.12","title"),i("2.5.4.13","description"),i("2.5.4.15","businessCategory"),i("2.5.4.17","postalCode"),i("2.5.4.42","givenName"),i("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),i("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),i("2.16.840.1.113730.1.1","nsCertType"),i("2.16.840.1.113730.1.13","nsComment"),s("2.5.29.1","authorityKeyIdentifier"),s("2.5.29.2","keyAttributes"),s("2.5.29.3","certificatePolicies"),s("2.5.29.4","keyUsageRestriction"),s("2.5.29.5","policyMapping"),s("2.5.29.6","subtreesConstraint"),s("2.5.29.7","subjectAltName"),s("2.5.29.8","issuerAltName"),s("2.5.29.9","subjectDirectoryAttributes"),s("2.5.29.10","basicConstraints"),s("2.5.29.11","nameConstraints"),s("2.5.29.12","policyConstraints"),s("2.5.29.13","basicConstraints"),i("2.5.29.14","subjectKeyIdentifier"),i("2.5.29.15","keyUsage"),s("2.5.29.16","privateKeyUsagePeriod"),i("2.5.29.17","subjectAltName"),i("2.5.29.18","issuerAltName"),i("2.5.29.19","basicConstraints"),s("2.5.29.20","cRLNumber"),s("2.5.29.21","cRLReason"),s("2.5.29.22","expirationDate"),s("2.5.29.23","instructionCode"),s("2.5.29.24","invalidityDate"),s("2.5.29.25","cRLDistributionPoints"),s("2.5.29.26","issuingDistributionPoint"),s("2.5.29.27","deltaCRLIndicator"),s("2.5.29.28","issuingDistributionPoint"),s("2.5.29.29","certificateIssuer"),s("2.5.29.30","nameConstraints"),i("2.5.29.31","cRLDistributionPoints"),i("2.5.29.32","certificatePolicies"),s("2.5.29.33","policyMappings"),s("2.5.29.34","policyConstraints"),i("2.5.29.35","authorityKeyIdentifier"),s("2.5.29.36","policyConstraints"),i("2.5.29.37","extKeyUsage"),s("2.5.29.46","freshestCRL"),s("2.5.29.54","inhibitAnyPolicy"),i("1.3.6.1.4.1.11129.2.4.2","timestampList"),i("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),i("1.3.6.1.5.5.7.3.1","serverAuth"),i("1.3.6.1.5.5.7.3.2","clientAuth"),i("1.3.6.1.5.5.7.3.3","codeSigning"),i("1.3.6.1.5.5.7.3.4","emailProtection"),i("1.3.6.1.5.5.7.3.8","timeStamping")}),Aa=A((e,t)=>{c();var r=st();gr(),$p();var n=t.exports=r.asn1=r.asn1||{};n.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},n.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},n.create=function(l,u,h,f,y){if(r.util.isArray(f)){for(var p=[],v=0;v<f.length;++v)f[v]!==void 0&&p.push(f[v]);f=p}var d={tagClass:l,type:u,constructed:h,composed:h||r.util.isArray(f),value:f};return y&&"bitStringContents"in y&&(d.bitStringContents=y.bitStringContents,d.original=n.copy(d)),d},n.copy=function(l,u){var h;if(r.util.isArray(l)){h=[];for(var f=0;f<l.length;++f)h.push(n.copy(l[f],u));return h}return typeof l=="string"?l:(h={tagClass:l.tagClass,type:l.type,constructed:l.constructed,composed:l.composed,value:n.copy(l.value,u)},u&&!u.excludeBitStringContents&&(h.bitStringContents=l.bitStringContents),h)},n.equals=function(l,u,h){if(r.util.isArray(l)){if(!r.util.isArray(u)||l.length!==u.length)return!1;for(var f=0;f<l.length;++f)if(!n.equals(l[f],u[f]))return!1;return!0}if(typeof l!=typeof u)return!1;if(typeof l=="string")return l===u;var y=l.tagClass===u.tagClass&&l.type===u.type&&l.constructed===u.constructed&&l.composed===u.composed&&n.equals(l.value,u.value);return h&&h.includeBitStringContents&&(y=y&&l.bitStringContents===u.bitStringContents),y},n.getBerValueLength=function(l){var u=l.getByte();if(u!==128){var h,f=u&128;return f?h=l.getInt((u&127)<<3):h=u,h}};function i(l,u,h){if(h>u){var f=new Error("Too few bytes to parse DER.");throw f.available=l.length(),f.remaining=u,f.requested=h,f}}var s=function(l,u){var h=l.getByte();if(u--,h!==128){var f,y=h&128;if(!y)f=h;else{var p=h&127;i(l,u,p),f=l.getInt(p<<3)}if(f<0)throw new Error("Negative length: "+f);return f}};n.fromDer=function(l,u){u===void 0&&(u={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof u=="boolean"&&(u={strict:u,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in u||(u.strict=!0),"parseAllBytes"in u||(u.parseAllBytes=!0),"decodeBitStrings"in u||(u.decodeBitStrings=!0),typeof l=="string"&&(l=r.util.createBuffer(l));var h=l.length(),f=a(l,l.length(),0,u);if(u.parseAllBytes&&l.length()!==0){var y=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw y.byteCount=h,y.remaining=l.length(),y}return f};function a(l,u,h,f){var y;i(l,u,2);var p=l.getByte();u--;var v=p&192,d=p&31;y=l.length();var g=s(l,u);if(u-=y-l.length(),g!==void 0&&g>u){if(f.strict){var b=new Error("Too few bytes to read ASN.1 value.");throw b.available=l.length(),b.remaining=u,b.requested=g,b}g=u}var _,m,E=(p&32)===32;if(E)if(_=[],g===void 0)for(;;){if(i(l,u,2),l.bytes(2)===String.fromCharCode(0,0)){l.getBytes(2),u-=2;break}y=l.length(),_.push(a(l,u,h+1,f)),u-=y-l.length()}else for(;g>0;)y=l.length(),_.push(a(l,g,h+1,f)),u-=y-l.length(),g-=y-l.length();if(_===void 0&&v===n.Class.UNIVERSAL&&d===n.Type.BITSTRING&&(m=l.bytes(g)),_===void 0&&f.decodeBitStrings&&v===n.Class.UNIVERSAL&&d===n.Type.BITSTRING&&g>1){var D=l.read,N=u,R=0;if(d===n.Type.BITSTRING&&(i(l,u,1),R=l.getByte(),u--),R===0)try{y=l.length();var T={strict:!0,decodeBitStrings:!0},S=a(l,u,h+1,T),O=y-l.length();u-=O,d==n.Type.BITSTRING&&O++;var F=S.tagClass;O===g&&(F===n.Class.UNIVERSAL||F===n.Class.CONTEXT_SPECIFIC)&&(_=[S])}catch{}_===void 0&&(l.read=D,u=N)}if(_===void 0){if(g===void 0){if(f.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");g=u}if(d===n.Type.BMPSTRING)for(_="";g>0;g-=2)i(l,u,2),_+=String.fromCharCode(l.getInt16()),u-=2;else _=l.getBytes(g),u-=g}var G=m===void 0?null:{bitStringContents:m};return n.create(v,d,E,_,G)}n.toDer=function(l){var u=r.util.createBuffer(),h=l.tagClass|l.type,f=r.util.createBuffer(),y=!1;if("bitStringContents"in l&&(y=!0,l.original&&(y=n.equals(l,l.original))),y)f.putBytes(l.bitStringContents);else if(l.composed){l.constructed?h|=32:f.putByte(0);for(var p=0;p<l.value.length;++p)l.value[p]!==void 0&&f.putBuffer(n.toDer(l.value[p]))}else if(l.type===n.Type.BMPSTRING)for(var p=0;p<l.value.length;++p)f.putInt16(l.value.charCodeAt(p));else l.type===n.Type.INTEGER&&l.value.length>1&&(l.value.charCodeAt(0)===0&&(l.value.charCodeAt(1)&128)===0||l.value.charCodeAt(0)===255&&(l.value.charCodeAt(1)&128)===128)?f.putBytes(l.value.substr(1)):f.putBytes(l.value);if(u.putByte(h),f.length()<=127)u.putByte(f.length()&127);else{var v=f.length(),d="";do d+=String.fromCharCode(v&255),v=v>>>8;while(v>0);u.putByte(d.length|128);for(var p=d.length-1;p>=0;--p)u.putByte(d.charCodeAt(p))}return u.putBuffer(f),u},n.oidToDer=function(l){var u=l.split("."),h=r.util.createBuffer();h.putByte(40*parseInt(u[0],10)+parseInt(u[1],10));for(var f,y,p,v,d=2;d<u.length;++d){f=!0,y=[],p=parseInt(u[d],10);do v=p&127,p=p>>>7,f||(v|=128),y.push(v),f=!1;while(p>0);for(var g=y.length-1;g>=0;--g)h.putByte(y[g])}return h},n.derToOid=function(l){var u;typeof l=="string"&&(l=r.util.createBuffer(l));var h=l.getByte();u=Math.floor(h/40)+"."+h%40;for(var f=0;l.length()>0;)h=l.getByte(),f=f<<7,h&128?f+=h&127:(u+="."+(f+h),f=0);return u},n.utcTimeToDate=function(l){var u=new Date,h=parseInt(l.substr(0,2),10);h=h>=50?1900+h:2e3+h;var f=parseInt(l.substr(2,2),10)-1,y=parseInt(l.substr(4,2),10),p=parseInt(l.substr(6,2),10),v=parseInt(l.substr(8,2),10),d=0;if(l.length>11){var g=l.charAt(10),b=10;g!=="+"&&g!=="-"&&(d=parseInt(l.substr(10,2),10),b+=2)}if(u.setUTCFullYear(h,f,y),u.setUTCHours(p,v,d,0),b&&(g=l.charAt(b),g==="+"||g==="-")){var _=parseInt(l.substr(b+1,2),10),m=parseInt(l.substr(b+4,2),10),E=_*60+m;E*=6e4,g==="+"?u.setTime(+u-E):u.setTime(+u+E)}return u},n.generalizedTimeToDate=function(l){var u=new Date,h=parseInt(l.substr(0,4),10),f=parseInt(l.substr(4,2),10)-1,y=parseInt(l.substr(6,2),10),p=parseInt(l.substr(8,2),10),v=parseInt(l.substr(10,2),10),d=parseInt(l.substr(12,2),10),g=0,b=0,_=!1;l.charAt(l.length-1)==="Z"&&(_=!0);var m=l.length-5,E=l.charAt(m);if(E==="+"||E==="-"){var D=parseInt(l.substr(m+1,2),10),N=parseInt(l.substr(m+4,2),10);b=D*60+N,b*=6e4,E==="+"&&(b*=-1),_=!0}return l.charAt(14)==="."&&(g=parseFloat(l.substr(14),10)*1e3),_?(u.setUTCFullYear(h,f,y),u.setUTCHours(p,v,d,g),u.setTime(+u+b)):(u.setFullYear(h,f,y),u.setHours(p,v,d,g)),u},n.dateToUtcTime=function(l){if(typeof l=="string")return l;var u="",h=[];h.push((""+l.getUTCFullYear()).substr(2)),h.push(""+(l.getUTCMonth()+1)),h.push(""+l.getUTCDate()),h.push(""+l.getUTCHours()),h.push(""+l.getUTCMinutes()),h.push(""+l.getUTCSeconds());for(var f=0;f<h.length;++f)h[f].length<2&&(u+="0"),u+=h[f];return u+="Z",u},n.dateToGeneralizedTime=function(l){if(typeof l=="string")return l;var u="",h=[];h.push(""+l.getUTCFullYear()),h.push(""+(l.getUTCMonth()+1)),h.push(""+l.getUTCDate()),h.push(""+l.getUTCHours()),h.push(""+l.getUTCMinutes()),h.push(""+l.getUTCSeconds());for(var f=0;f<h.length;++f)h[f].length<2&&(u+="0"),u+=h[f];return u+="Z",u},n.integerToDer=function(l){var u=r.util.createBuffer();if(l>=-128&&l<128)return u.putSignedInt(l,8);if(l>=-32768&&l<32768)return u.putSignedInt(l,16);if(l>=-8388608&&l<8388608)return u.putSignedInt(l,24);if(l>=-2147483648&&l<2147483648)return u.putSignedInt(l,32);var h=new Error("Integer too large; max is 32-bits.");throw h.integer=l,h},n.derToInteger=function(l){typeof l=="string"&&(l=r.util.createBuffer(l));var u=l.length()*8;if(u>32)throw new Error("Integer too large; max is 32-bits.");return l.getSignedInt(u)},n.validate=function(l,u,h,f){var y=!1;if((l.tagClass===u.tagClass||typeof u.tagClass>"u")&&(l.type===u.type||typeof u.type>"u"))if(l.constructed===u.constructed||typeof u.constructed>"u"){if(y=!0,u.value&&r.util.isArray(u.value))for(var p=0,v=0;y&&v<u.value.length;++v)y=u.value[v].optional||!1,l.value[p]&&(y=n.validate(l.value[p],u.value[v],h,f),y?++p:u.value[v].optional&&(y=!0)),!y&&f&&f.push("["+u.name+'] Tag class "'+u.tagClass+'", type "'+u.type+'" expected value length "'+u.value.length+'", got "'+l.value.length+'"');if(y&&h&&(u.capture&&(h[u.capture]=l.value),u.captureAsn1&&(h[u.captureAsn1]=l),u.captureBitStringContents&&"bitStringContents"in l&&(h[u.captureBitStringContents]=l.bitStringContents),u.captureBitStringValue&&"bitStringContents"in l)){var d;if(l.bitStringContents.length<2)h[u.captureBitStringValue]="";else{var g=l.bitStringContents.charCodeAt(0);if(g!==0)throw new Error("captureBitStringValue only supported for zero unused bits");h[u.captureBitStringValue]=l.bitStringContents.slice(1)}}}else f&&f.push("["+u.name+'] Expected constructed "'+u.constructed+'", got "'+l.constructed+'"');else f&&(l.tagClass!==u.tagClass&&f.push("["+u.name+'] Expected tag class "'+u.tagClass+'", got "'+l.tagClass+'"'),l.type!==u.type&&f.push("["+u.name+'] Expected type "'+u.type+'", got "'+l.type+'"'));return y};var o=/[^\\u0000-\\u00ff]/;n.prettyPrint=function(l,u,h){var f="";u=u||0,h=h||2,u>0&&(f+=`
`);for(var y="",p=0;p<u*h;++p)y+=" ";switch(f+=y+"Tag: ",l.tagClass){case n.Class.UNIVERSAL:f+="Universal:";break;case n.Class.APPLICATION:f+="Application:";break;case n.Class.CONTEXT_SPECIFIC:f+="Context-Specific:";break;case n.Class.PRIVATE:f+="Private:";break}if(l.tagClass===n.Class.UNIVERSAL)switch(f+=l.type,l.type){case n.Type.NONE:f+=" (None)";break;case n.Type.BOOLEAN:f+=" (Boolean)";break;case n.Type.INTEGER:f+=" (Integer)";break;case n.Type.BITSTRING:f+=" (Bit string)";break;case n.Type.OCTETSTRING:f+=" (Octet string)";break;case n.Type.NULL:f+=" (Null)";break;case n.Type.OID:f+=" (Object Identifier)";break;case n.Type.ODESC:f+=" (Object Descriptor)";break;case n.Type.EXTERNAL:f+=" (External or Instance of)";break;case n.Type.REAL:f+=" (Real)";break;case n.Type.ENUMERATED:f+=" (Enumerated)";break;case n.Type.EMBEDDED:f+=" (Embedded PDV)";break;case n.Type.UTF8:f+=" (UTF8)";break;case n.Type.ROID:f+=" (Relative Object Identifier)";break;case n.Type.SEQUENCE:f+=" (Sequence)";break;case n.Type.SET:f+=" (Set)";break;case n.Type.PRINTABLESTRING:f+=" (Printable String)";break;case n.Type.IA5String:f+=" (IA5String (ASCII))";break;case n.Type.UTCTIME:f+=" (UTC time)";break;case n.Type.GENERALIZEDTIME:f+=" (Generalized time)";break;case n.Type.BMPSTRING:f+=" (BMP String)";break}else f+=l.type;if(f+=`
`,f+=y+"Constructed: "+l.constructed+`
`,l.composed){for(var v=0,d="",p=0;p<l.value.length;++p)l.value[p]!==void 0&&(v+=1,d+=n.prettyPrint(l.value[p],u+1,h),p+1<l.value.length&&(d+=","));f+=y+"Sub values: "+v+d}else{if(f+=y+"Value: ",l.type===n.Type.OID){var g=n.derToOid(l.value);f+=g,r.pki&&r.pki.oids&&g in r.pki.oids&&(f+=" ("+r.pki.oids[g]+") ")}if(l.type===n.Type.INTEGER)try{f+=n.derToInteger(l.value)}catch{f+="0x"+r.util.bytesToHex(l.value)}else if(l.type===n.Type.BITSTRING){if(l.value.length>1?f+="0x"+r.util.bytesToHex(l.value.slice(1)):f+="(none)",l.value.length>0){var b=l.value.charCodeAt(0);b==1?f+=" (1 unused bit shown)":b>1&&(f+=" ("+b+" unused bits shown)")}}else if(l.type===n.Type.OCTETSTRING)o.test(l.value)||(f+="("+l.value+") "),f+="0x"+r.util.bytesToHex(l.value);else if(l.type===n.Type.UTF8)try{f+=r.util.decodeUtf8(l.value)}catch(_){if(_.message==="URI malformed")f+="0x"+r.util.bytesToHex(l.value)+" (malformed UTF8)";else throw _}else l.type===n.Type.PRINTABLESTRING||l.type===n.Type.IA5String?f+=l.value:o.test(l.value)?f+="0x"+r.util.bytesToHex(l.value):l.value.length===0?f+="[null]":f+=l.value}return f}}),yx=A((e,t)=>{c();var r=st();gr(),t.exports=r.cipher=r.cipher||{},r.cipher.algorithms=r.cipher.algorithms||{},r.cipher.createCipher=function(i,s){var a=i;if(typeof a=="string"&&(a=r.cipher.getAlgorithm(a),a&&(a=a())),!a)throw new Error("Unsupported algorithm: "+i);return new r.cipher.BlockCipher({algorithm:a,key:s,decrypt:!1})},r.cipher.createDecipher=function(i,s){var a=i;if(typeof a=="string"&&(a=r.cipher.getAlgorithm(a),a&&(a=a())),!a)throw new Error("Unsupported algorithm: "+i);return new r.cipher.BlockCipher({algorithm:a,key:s,decrypt:!0})},r.cipher.registerAlgorithm=function(i,s){i=i.toUpperCase(),r.cipher.algorithms[i]=s},r.cipher.getAlgorithm=function(i){return i=i.toUpperCase(),i in r.cipher.algorithms?r.cipher.algorithms[i]:null};var n=r.cipher.BlockCipher=function(i){this.algorithm=i.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=i.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=i.decrypt,this.algorithm.initialize(i)};n.prototype.start=function(i){i=i||{};var s={};for(var a in i)s[a]=i[a];s.decrypt=this._decrypt,this._finish=!1,this._input=r.util.createBuffer(),this.output=i.output||r.util.createBuffer(),this.mode.start(s)},n.prototype.update=function(i){for(i&&this._input.putBuffer(i);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},n.prototype.finish=function(i){i&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(a){return i(this.blockSize,a,!1)},this.mode.unpad=function(a){return i(this.blockSize,a,!0)});var s={};return s.decrypt=this._decrypt,s.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,s)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,s))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,s))}}),wx=A((e,t)=>{c();var r=st();gr(),r.cipher=r.cipher||{};var n=t.exports=r.cipher.modes=r.cipher.modes||{};n.ecb=function(o){o=o||{},this.name="ECB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},n.ecb.prototype.start=function(o){},n.ecb.prototype.encrypt=function(o,l,u){if(o.length()<this.blockSize&&!(u&&o.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=o.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)l.putInt32(this._outBlock[h])},n.ecb.prototype.decrypt=function(o,l,u){if(o.length()<this.blockSize&&!(u&&o.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=o.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)l.putInt32(this._outBlock[h])},n.ecb.prototype.pad=function(o,l){var u=o.length()===this.blockSize?this.blockSize:this.blockSize-o.length();return o.fillWithByte(u,u),!0},n.ecb.prototype.unpad=function(o,l){if(l.overflow>0)return!1;var u=o.length(),h=o.at(u-1);return h>this.blockSize<<2?!1:(o.truncate(h),!0)},n.cbc=function(o){o=o||{},this.name="CBC",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},n.cbc.prototype.start=function(o){if(o.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in o)this._iv=i(o.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},n.cbc.prototype.encrypt=function(o,l,u){if(o.length()<this.blockSize&&!(u&&o.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=this._prev[h]^o.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)l.putInt32(this._outBlock[h]);this._prev=this._outBlock},n.cbc.prototype.decrypt=function(o,l,u){if(o.length()<this.blockSize&&!(u&&o.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=o.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)l.putInt32(this._prev[h]^this._outBlock[h]);this._prev=this._inBlock.slice(0)},n.cbc.prototype.pad=function(o,l){var u=o.length()===this.blockSize?this.blockSize:this.blockSize-o.length();return o.fillWithByte(u,u),!0},n.cbc.prototype.unpad=function(o,l){if(l.overflow>0)return!1;var u=o.length(),h=o.at(u-1);return h>this.blockSize<<2?!1:(o.truncate(h),!0)},n.cfb=function(o){o=o||{},this.name="CFB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},n.cfb.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=i(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},n.cfb.prototype.encrypt=function(o,l,u){var h=o.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var f=0;f<this._ints;++f)this._inBlock[f]=o.getInt32()^this._outBlock[f],l.putInt32(this._inBlock[f]);return}var y=(this.blockSize-h)%this.blockSize;y>0&&(y=this.blockSize-y),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialBlock[f]=o.getInt32()^this._outBlock[f],this._partialOutput.putInt32(this._partialBlock[f]);if(y>0)o.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),y>0&&!u)return l.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=y,!0;l.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0},n.cfb.prototype.decrypt=function(o,l,u){var h=o.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var f=0;f<this._ints;++f)this._inBlock[f]=o.getInt32(),l.putInt32(this._inBlock[f]^this._outBlock[f]);return}var y=(this.blockSize-h)%this.blockSize;y>0&&(y=this.blockSize-y),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialBlock[f]=o.getInt32(),this._partialOutput.putInt32(this._partialBlock[f]^this._outBlock[f]);if(y>0)o.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),y>0&&!u)return l.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=y,!0;l.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0},n.ofb=function(o){o=o||{},this.name="OFB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},n.ofb.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=i(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},n.ofb.prototype.encrypt=function(o,l,u){var h=o.length();if(o.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var f=0;f<this._ints;++f)l.putInt32(o.getInt32()^this._outBlock[f]),this._inBlock[f]=this._outBlock[f];return}var y=(this.blockSize-h)%this.blockSize;y>0&&(y=this.blockSize-y),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(o.getInt32()^this._outBlock[f]);if(y>0)o.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._outBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),y>0&&!u)return l.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=y,!0;l.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0},n.ofb.prototype.decrypt=n.ofb.prototype.encrypt,n.ctr=function(o){o=o||{},this.name="CTR",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},n.ctr.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=i(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},n.ctr.prototype.encrypt=function(o,l,u){var h=o.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize)for(var f=0;f<this._ints;++f)l.putInt32(o.getInt32()^this._outBlock[f]);else{var y=(this.blockSize-h)%this.blockSize;y>0&&(y=this.blockSize-y),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(o.getInt32()^this._outBlock[f]);if(y>0&&(o.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),y>0&&!u)return l.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=y,!0;l.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}s(this._inBlock)},n.ctr.prototype.decrypt=n.ctr.prototype.encrypt,n.gcm=function(o){o=o||{},this.name="GCM",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0,this._R=3774873600},n.gcm.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");var l=r.util.createBuffer(o.iv);this._cipherLength=0;var u;if("additionalData"in o?u=r.util.createBuffer(o.additionalData):u=r.util.createBuffer(),"tagLength"in o?this._tagLength=o.tagLength:this._tagLength=128,this._tag=null,o.decrypt&&(this._tag=r.util.createBuffer(o.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var h=l.length();if(h===12)this._j0=[l.getInt32(),l.getInt32(),l.getInt32(),1];else{for(this._j0=[0,0,0,0];l.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[l.getInt32(),l.getInt32(),l.getInt32(),l.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(a(h*8)))}this._inBlock=this._j0.slice(0),s(this._inBlock),this._partialBytes=0,u=r.util.createBuffer(u),this._aDataLength=a(u.length()*8);var f=u.length()%this.blockSize;for(f&&u.fillWithByte(0,this.blockSize-f),this._s=[0,0,0,0];u.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[u.getInt32(),u.getInt32(),u.getInt32(),u.getInt32()])},n.gcm.prototype.encrypt=function(o,l,u){var h=o.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var f=0;f<this._ints;++f)l.putInt32(this._outBlock[f]^=o.getInt32());this._cipherLength+=this.blockSize}else{var y=(this.blockSize-h)%this.blockSize;y>0&&(y=this.blockSize-y),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(o.getInt32()^this._outBlock[f]);if(y<=0||u){if(u){var p=h%this.blockSize;this._cipherLength+=p,this._partialOutput.truncate(this.blockSize-p)}else this._cipherLength+=this.blockSize;for(var f=0;f<this._ints;++f)this._outBlock[f]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),y>0&&!u)return o.read-=this.blockSize,l.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=y,!0;l.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),s(this._inBlock)},n.gcm.prototype.decrypt=function(o,l,u){var h=o.length();if(h<this.blockSize&&!(u&&h>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),s(this._inBlock),this._hashBlock[0]=o.getInt32(),this._hashBlock[1]=o.getInt32(),this._hashBlock[2]=o.getInt32(),this._hashBlock[3]=o.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var f=0;f<this._ints;++f)l.putInt32(this._outBlock[f]^this._hashBlock[f]);h<this.blockSize?this._cipherLength+=h%this.blockSize:this._cipherLength+=this.blockSize},n.gcm.prototype.afterFinish=function(o,l){var u=!0;l.decrypt&&l.overflow&&o.truncate(this.blockSize-l.overflow),this.tag=r.util.createBuffer();var h=this._aDataLength.concat(a(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,h);var f=[];this.cipher.encrypt(this._j0,f);for(var y=0;y<this._ints;++y)this.tag.putInt32(this._s[y]^f[y]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),l.decrypt&&this.tag.bytes()!==this._tag&&(u=!1),u},n.gcm.prototype.multiply=function(o,l){for(var u=[0,0,0,0],h=l.slice(0),f=0;f<128;++f){var y=o[f/32|0]&1<<31-f%32;y&&(u[0]^=h[0],u[1]^=h[1],u[2]^=h[2],u[3]^=h[3]),this.pow(h,h)}return u},n.gcm.prototype.pow=function(o,l){for(var u=o[3]&1,h=3;h>0;--h)l[h]=o[h]>>>1|(o[h-1]&1)<<31;l[0]=o[0]>>>1,u&&(l[0]^=this._R)},n.gcm.prototype.tableMultiply=function(o){for(var l=[0,0,0,0],u=0;u<32;++u){var h=u/8|0,f=o[h]>>>(7-u%8)*4&15,y=this._m[u][f];l[0]^=y[0],l[1]^=y[1],l[2]^=y[2],l[3]^=y[3]}return l},n.gcm.prototype.ghash=function(o,l,u){return l[0]^=u[0],l[1]^=u[1],l[2]^=u[2],l[3]^=u[3],this.tableMultiply(l)},n.gcm.prototype.generateHashTable=function(o,l){for(var u=8/l,h=4*u,f=16*u,y=new Array(f),p=0;p<f;++p){var v=[0,0,0,0],d=p/h|0,g=(h-1-p%h)*l;v[d]=1<<l-1<<g,y[p]=this.generateSubHashTable(this.multiply(v,o),l)}return y},n.gcm.prototype.generateSubHashTable=function(o,l){var u=1<<l,h=u>>>1,f=new Array(u);f[h]=o.slice(0);for(var y=h>>>1;y>0;)this.pow(f[2*y],f[y]=[]),y>>=1;for(y=2;y<h;){for(var p=1;p<y;++p){var v=f[y],d=f[p];f[y+p]=[v[0]^d[0],v[1]^d[1],v[2]^d[2],v[3]^d[3]]}y*=2}for(f[0]=[0,0,0,0],y=h+1;y<u;++y){var g=f[y^h];f[y]=[o[0]^g[0],o[1]^g[1],o[2]^g[2],o[3]^g[3]]}return f};function i(o,l){if(typeof o=="string"&&(o=r.util.createBuffer(o)),r.util.isArray(o)&&o.length>4){var u=o;o=r.util.createBuffer();for(var h=0;h<u.length;++h)o.putByte(u[h])}if(o.length()<l)throw new Error("Invalid IV length; got "+o.length()+" bytes and expected "+l+" bytes.");if(!r.util.isArray(o)){for(var f=[],y=l/4,h=0;h<y;++h)f.push(o.getInt32());o=f}return o}function s(o){o[o.length-1]=o[o.length-1]+1&4294967295}function a(o){return[o/4294967296|0,o&4294967295]}}),jp=A((e,t)=>{c();var r=st();yx(),wx(),gr(),t.exports=r.aes=r.aes||{},r.aes.startEncrypting=function(d,g,b,_){var m=v({key:d,output:b,decrypt:!1,mode:_});return m.start(g),m},r.aes.createEncryptionCipher=function(d,g){return v({key:d,output:null,decrypt:!1,mode:g})},r.aes.startDecrypting=function(d,g,b,_){var m=v({key:d,output:b,decrypt:!0,mode:_});return m.start(g),m},r.aes.createDecryptionCipher=function(d,g){return v({key:d,output:null,decrypt:!0,mode:g})},r.aes.Algorithm=function(d,g){i||f();var b=this;b.name=d,b.mode=new g({blockSize:16,cipher:{encrypt:function(_,m){return p(b._w,_,m,!1)},decrypt:function(_,m){return p(b._w,_,m,!0)}}}),b._init=!1},r.aes.Algorithm.prototype.initialize=function(d){if(!this._init){var g=d.key,b;if(typeof g=="string"&&(g.length===16||g.length===24||g.length===32))g=r.util.createBuffer(g);else if(r.util.isArray(g)&&(g.length===16||g.length===24||g.length===32)){b=g,g=r.util.createBuffer();for(var _=0;_<b.length;++_)g.putByte(b[_])}if(!r.util.isArray(g)){b=g,g=[];var m=b.length();if(m===16||m===24||m===32){m=m>>>2;for(var _=0;_<m;++_)g.push(b.getInt32())}}if(!r.util.isArray(g)||!(g.length===4||g.length===6||g.length===8))throw new Error("Invalid key parameter.");var E=this.mode.name,D=["CFB","OFB","CTR","GCM"].indexOf(E)!==-1;this._w=y(g,d.decrypt&&!D),this._init=!0}},r.aes._expandKey=function(d,g){return i||f(),y(d,g)},r.aes._updateBlock=p,n("AES-ECB",r.cipher.modes.ecb),n("AES-CBC",r.cipher.modes.cbc),n("AES-CFB",r.cipher.modes.cfb),n("AES-OFB",r.cipher.modes.ofb),n("AES-CTR",r.cipher.modes.ctr),n("AES-GCM",r.cipher.modes.gcm);function n(d,g){var b=function(){return new r.aes.Algorithm(d,g)};r.cipher.registerAlgorithm(d,b)}var i=!1,s=4,a,o,l,u,h;function f(){i=!0,l=[0,1,2,4,8,16,32,64,128,27,54];for(var d=new Array(256),g=0;g<128;++g)d[g]=g<<1,d[g+128]=g+128<<1^283;a=new Array(256),o=new Array(256),u=new Array(4),h=new Array(4);for(var g=0;g<4;++g)u[g]=new Array(256),h[g]=new Array(256);for(var b=0,_=0,m,E,D,N,R,T,S,g=0;g<256;++g){N=_^_<<1^_<<2^_<<3^_<<4,N=N>>8^N&255^99,a[b]=N,o[N]=b,R=d[N],m=d[b],E=d[m],D=d[E],T=R<<24^N<<16^N<<8^(N^R),S=(m^E^D)<<24^(b^D)<<16^(b^E^D)<<8^(b^m^D);for(var O=0;O<4;++O)u[O][b]=T,h[O][N]=S,T=T<<24|T>>>8,S=S<<24|S>>>8;b===0?b=_=1:(b=m^d[d[d[m^D]]],_^=d[d[_]])}}function y(d,g){for(var b=d.slice(0),_,m=1,E=b.length,D=E+6+1,N=s*D,R=E;R<N;++R)_=b[R-1],R%E===0?(_=a[_>>>16&255]<<24^a[_>>>8&255]<<16^a[_&255]<<8^a[_>>>24]^l[m]<<24,m++):E>6&&R%E===4&&(_=a[_>>>24]<<24^a[_>>>16&255]<<16^a[_>>>8&255]<<8^a[_&255]),b[R]=b[R-E]^_;if(g){var T,S=h[0],O=h[1],F=h[2],G=h[3],ne=b.slice(0);N=b.length;for(var R=0,Y=N-s;R<N;R+=s,Y-=s)if(R===0||R===N-s)ne[R]=b[Y],ne[R+1]=b[Y+3],ne[R+2]=b[Y+2],ne[R+3]=b[Y+1];else for(var ce=0;ce<s;++ce)T=b[Y+ce],ne[R+(3&-ce)]=S[a[T>>>24]]^O[a[T>>>16&255]]^F[a[T>>>8&255]]^G[a[T&255]];b=ne}return b}function p(d,g,b,_){var m=d.length/4-1,E,D,N,R,T;_?(E=h[0],D=h[1],N=h[2],R=h[3],T=o):(E=u[0],D=u[1],N=u[2],R=u[3],T=a);var S,O,F,G,ne,Y,ce;S=g[0]^d[0],O=g[_?3:1]^d[1],F=g[2]^d[2],G=g[_?1:3]^d[3];for(var oe=3,H=1;H<m;++H)ne=E[S>>>24]^D[O>>>16&255]^N[F>>>8&255]^R[G&255]^d[++oe],Y=E[O>>>24]^D[F>>>16&255]^N[G>>>8&255]^R[S&255]^d[++oe],ce=E[F>>>24]^D[G>>>16&255]^N[S>>>8&255]^R[O&255]^d[++oe],G=E[G>>>24]^D[S>>>16&255]^N[O>>>8&255]^R[F&255]^d[++oe],S=ne,O=Y,F=ce;b[0]=T[S>>>24]<<24^T[O>>>16&255]<<16^T[F>>>8&255]<<8^T[G&255]^d[++oe],b[_?3:1]=T[O>>>24]<<24^T[F>>>16&255]<<16^T[G>>>8&255]<<8^T[S&255]^d[++oe],b[2]=T[F>>>24]<<24^T[G>>>16&255]<<16^T[S>>>8&255]<<8^T[O&255]^d[++oe],b[_?1:3]=T[G>>>24]<<24^T[S>>>16&255]<<16^T[O>>>8&255]<<8^T[F&255]^d[++oe]}function v(d){d=d||{};var g=(d.mode||"CBC").toUpperCase(),b="AES-"+g,_;d.decrypt?_=r.cipher.createDecipher(b,d.key):_=r.cipher.createCipher(b,d.key);var m=_.start;return _.start=function(E,D){var N=null;D instanceof r.util.ByteBuffer&&(N=D,D={}),D=D||{},D.output=N,D.iv=E,m.call(_,D)},_}}),jw=A((e,t)=>{c();var r=st();yx(),wx(),gr(),t.exports=r.des=r.des||{},r.des.startEncrypting=function(d,g,b,_){var m=v({key:d,output:b,decrypt:!1,mode:_||(g===null?"ECB":"CBC")});return m.start(g),m},r.des.createEncryptionCipher=function(d,g){return v({key:d,output:null,decrypt:!1,mode:g})},r.des.startDecrypting=function(d,g,b,_){var m=v({key:d,output:b,decrypt:!0,mode:_||(g===null?"ECB":"CBC")});return m.start(g),m},r.des.createDecryptionCipher=function(d,g){return v({key:d,output:null,decrypt:!0,mode:g})},r.des.Algorithm=function(d,g){var b=this;b.name=d,b.mode=new g({blockSize:8,cipher:{encrypt:function(_,m){return p(b._keys,_,m,!1)},decrypt:function(_,m){return p(b._keys,_,m,!0)}}}),b._init=!1},r.des.Algorithm.prototype.initialize=function(d){if(!this._init){var g=r.util.createBuffer(d.key);if(this.name.indexOf("3DES")===0&&g.length()!==24)throw new Error("Invalid Triple-DES key size: "+g.length()*8);this._keys=y(g),this._init=!0}},n("DES-ECB",r.cipher.modes.ecb),n("DES-CBC",r.cipher.modes.cbc),n("DES-CFB",r.cipher.modes.cfb),n("DES-OFB",r.cipher.modes.ofb),n("DES-CTR",r.cipher.modes.ctr),n("3DES-ECB",r.cipher.modes.ecb),n("3DES-CBC",r.cipher.modes.cbc),n("3DES-CFB",r.cipher.modes.cfb),n("3DES-OFB",r.cipher.modes.ofb),n("3DES-CTR",r.cipher.modes.ctr);function n(d,g){var b=function(){return new r.des.Algorithm(d,g)};r.cipher.registerAlgorithm(d,b)}var i=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],o=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],l=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],u=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],f=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function y(d){for(var g=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],b=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],_=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],m=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],E=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],D=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],N=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],R=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],T=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],S=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],O=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],F=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],G=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],ne=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],Y=d.length()>8?3:1,ce=[],oe=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],H=0,W,de=0;de<Y;de++){var De=d.getInt32(),Pe=d.getInt32();W=(De>>>4^Pe)&252645135,Pe^=W,De^=W<<4,W=(Pe>>>-16^De)&65535,De^=W,Pe^=W<<-16,W=(De>>>2^Pe)&858993459,Pe^=W,De^=W<<2,W=(Pe>>>-16^De)&65535,De^=W,Pe^=W<<-16,W=(De>>>1^Pe)&1431655765,Pe^=W,De^=W<<1,W=(Pe>>>8^De)&16711935,De^=W,Pe^=W<<8,W=(De>>>1^Pe)&1431655765,Pe^=W,De^=W<<1,W=De<<8|Pe>>>20&240,De=Pe<<24|Pe<<8&16711680|Pe>>>8&65280|Pe>>>24&240,Pe=W;for(var $e=0;$e<oe.length;++$e){oe[$e]?(De=De<<2|De>>>26,Pe=Pe<<2|Pe>>>26):(De=De<<1|De>>>27,Pe=Pe<<1|Pe>>>27),De&=-15,Pe&=-15;var Be=g[De>>>28]|b[De>>>24&15]|_[De>>>20&15]|m[De>>>16&15]|E[De>>>12&15]|D[De>>>8&15]|N[De>>>4&15],nt=R[Pe>>>28]|T[Pe>>>24&15]|S[Pe>>>20&15]|O[Pe>>>16&15]|F[Pe>>>12&15]|G[Pe>>>8&15]|ne[Pe>>>4&15];W=(nt>>>16^Be)&65535,ce[H++]=Be^W,ce[H++]=nt^W<<16}}return ce}function p(d,g,b,_){var m=d.length===32?3:9,E;m===3?E=_?[30,-2,-2]:[0,32,2]:E=_?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var D,N=g[0],R=g[1];D=(N>>>4^R)&252645135,R^=D,N^=D<<4,D=(N>>>16^R)&65535,R^=D,N^=D<<16,D=(R>>>2^N)&858993459,N^=D,R^=D<<2,D=(R>>>8^N)&16711935,N^=D,R^=D<<8,D=(N>>>1^R)&1431655765,R^=D,N^=D<<1,N=N<<1|N>>>31,R=R<<1|R>>>31;for(var T=0;T<m;T+=3){for(var S=E[T+1],O=E[T+2],F=E[T];F!=S;F+=O){var G=R^d[F],ne=(R>>>4|R<<28)^d[F+1];D=N,N=R,R=D^(s[G>>>24&63]|o[G>>>16&63]|u[G>>>8&63]|f[G&63]|i[ne>>>24&63]|a[ne>>>16&63]|l[ne>>>8&63]|h[ne&63])}D=N,N=R,R=D}N=N>>>1|N<<31,R=R>>>1|R<<31,D=(N>>>1^R)&1431655765,R^=D,N^=D<<1,D=(R>>>8^N)&16711935,N^=D,R^=D<<8,D=(R>>>2^N)&858993459,N^=D,R^=D<<2,D=(N>>>16^R)&65535,R^=D,N^=D<<16,D=(N>>>4^R)&252645135,R^=D,N^=D<<4,b[0]=N,b[1]=R}function v(d){d=d||{};var g=(d.mode||"CBC").toUpperCase(),b="DES-"+g,_;d.decrypt?_=r.cipher.createDecipher(b,d.key):_=r.cipher.createCipher(b,d.key);var m=_.start;return _.start=function(E,D){var N=null;D instanceof r.util.ByteBuffer&&(N=D,D={}),D=D||{},D.output=N,D.iv=E,m.call(_,D)},_}}),sl=A((e,t)=>{c();var r=st();t.exports=r.md=r.md||{},r.md.algorithms=r.md.algorithms||{}}),vK=A((e,t)=>{c();var r=st();sl(),gr();var n=t.exports=r.hmac=r.hmac||{};n.create=function(){var i=null,s=null,a=null,o=null,l={};return l.start=function(u,h){if(u!==null)if(typeof u=="string")if(u=u.toLowerCase(),u in r.md.algorithms)s=r.md.algorithms[u].create();else throw new Error('Unknown hash algorithm "'+u+'"');else s=u;if(h===null)h=i;else{if(typeof h=="string")h=r.util.createBuffer(h);else if(r.util.isArray(h)){var f=h;h=r.util.createBuffer();for(var y=0;y<f.length;++y)h.putByte(f[y])}var p=h.length();p>s.blockLength&&(s.start(),s.update(h.bytes()),h=s.digest()),a=r.util.createBuffer(),o=r.util.createBuffer(),p=h.length();for(var y=0;y<p;++y){var f=h.at(y);a.putByte(54^f),o.putByte(92^f)}if(p<s.blockLength)for(var f=s.blockLength-p,y=0;y<f;++y)a.putByte(54),o.putByte(92);i=h,a=a.bytes(),o=o.bytes()}s.start(),s.update(a)},l.update=function(u){s.update(u)},l.getMac=function(){var u=s.digest().bytes();return s.start(),s.update(o),s.update(u),s.digest()},l.digest=l.getMac,l}}),rh=A(()=>{c()}),vx=A((e,t)=>{c();var r=st();vK(),sl(),gr();var n=r.pkcs5=r.pkcs5||{},i;r.util.isNodejs&&!r.options.usePureJavaScript&&(i=rh()),t.exports=r.pbkdf2=n.pbkdf2=function(s,a,o,l,u,h){if(typeof u=="function"&&(h=u,u=null),r.util.isNodejs&&!r.options.usePureJavaScript&&i.pbkdf2&&(u===null||typeof u!="object")&&(i.pbkdf2Sync.length>4||!u||u==="sha1"))return typeof u!="string"&&(u="sha1"),s=Buffer.from(s,"binary"),a=Buffer.from(a,"binary"),h?i.pbkdf2Sync.length===4?i.pbkdf2(s,a,o,l,function(T,S){if(T)return h(T);h(null,S.toString("binary"))}):i.pbkdf2(s,a,o,l,u,function(T,S){if(T)return h(T);h(null,S.toString("binary"))}):i.pbkdf2Sync.length===4?i.pbkdf2Sync(s,a,o,l).toString("binary"):i.pbkdf2Sync(s,a,o,l,u).toString("binary");if((typeof u>"u"||u===null)&&(u="sha1"),typeof u=="string"){if(!(u in r.md.algorithms))throw new Error("Unknown hash algorithm: "+u);u=r.md[u].create()}var f=u.digestLength;if(l>4294967295*f){var y=new Error("Derived key is too long.");if(h)return h(y);throw y}var p=Math.ceil(l/f),v=l-(p-1)*f,d=r.hmac.create();d.start(u,s);var g="",b,_,m;if(!h){for(var E=1;E<=p;++E){d.start(null,null),d.update(a),d.update(r.util.int32ToBytes(E)),b=m=d.digest().getBytes();for(var D=2;D<=o;++D)d.start(null,null),d.update(m),_=d.digest().getBytes(),b=r.util.xorBytes(b,_,f),m=_;g+=E<p?b:b.substr(0,v)}return g}var E=1,D;function N(){if(E>p)return h(null,g);d.start(null,null),d.update(a),d.update(r.util.int32ToBytes(E)),b=m=d.digest().getBytes(),D=2,R()}function R(){if(D<=o)return d.start(null,null),d.update(m),_=d.digest().getBytes(),b=r.util.xorBytes(b,_,f),m=_,++D,r.util.setImmediate(R);g+=E<p?b:b.substr(0,v),++E,N()}N()}}),Zw=A((e,t)=>{c();var r=st();gr();var n=t.exports=r.pem=r.pem||{};n.encode=function(a,o){o=o||{};var l="-----BEGIN "+a.type+`-----\r
`,u;if(a.procType&&(u={name:"Proc-Type",values:[String(a.procType.version),a.procType.type]},l+=i(u)),a.contentDomain&&(u={name:"Content-Domain",values:[a.contentDomain]},l+=i(u)),a.dekInfo&&(u={name:"DEK-Info",values:[a.dekInfo.algorithm]},a.dekInfo.parameters&&u.values.push(a.dekInfo.parameters),l+=i(u)),a.headers)for(var h=0;h<a.headers.length;++h)l+=i(a.headers[h]);return a.procType&&(l+=`\r
`),l+=r.util.encode64(a.body,o.maxline||64)+`\r
`,l+="-----END "+a.type+`-----\r
`,l},n.decode=function(a){for(var o=[],l=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,u=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,h=/\r?\n/,f;f=l.exec(a),!!f;){var y=f[1];y==="NEW CERTIFICATE REQUEST"&&(y="CERTIFICATE REQUEST");var p={type:y,procType:null,contentDomain:null,dekInfo:null,headers:[],body:r.util.decode64(f[3])};if(o.push(p),!!f[2]){for(var v=f[2].split(h),d=0;f&&d<v.length;){for(var g=v[d].replace(/\s+$/,""),b=d+1;b<v.length;++b){var _=v[b];if(!/\s/.test(_[0]))break;g+=_,d=b}if(f=g.match(u),f){for(var m={name:f[1],values:[]},E=f[2].split(","),D=0;D<E.length;++D)m.values.push(s(E[D]));if(p.procType)if(!p.contentDomain&&m.name==="Content-Domain")p.contentDomain=E[0]||"";else if(!p.dekInfo&&m.name==="DEK-Info"){if(m.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');p.dekInfo={algorithm:E[0],parameters:E[1]||null}}else p.headers.push(m);else{if(m.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(m.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');p.procType={version:E[0],type:E[1]}}}++d}if(p.procType==="ENCRYPTED"&&!p.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(o.length===0)throw new Error("Invalid PEM formatted message.");return o};function i(a){for(var o=a.name+": ",l=[],u=function(v,d){return" "+d},h=0;h<a.values.length;++h)l.push(a.values[h].replace(/^(\S+\r\n)/,u));o+=l.join(",")+`\r
`;for(var f=0,y=-1,h=0;h<o.length;++h,++f)if(f>65&&y!==-1){var p=o[y];p===","?(++y,o=o.substr(0,y)+`\r
 `+o.substr(y)):o=o.substr(0,y)+`\r
`+p+o.substr(y+1),f=h-y-1,y=-1,++h}else(o[h]===" "||o[h]==="	"||o[h]===",")&&(y=h);return o}function s(a){return a.replace(/^\s+/,"")}}),DK=A((e,t)=>{c();var r=st();sl(),gr();var n=t.exports=r.sha256=r.sha256||{};r.md.sha256=r.md.algorithms.sha256=n,n.create=function(){s||o();var u=null,h=r.util.createBuffer(),f=new Array(64),y={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return y.start=function(){y.messageLength=0,y.fullMessageLength=y.messageLength64=[];for(var p=y.messageLengthSize/4,v=0;v<p;++v)y.fullMessageLength.push(0);return h=r.util.createBuffer(),u={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},y},y.start(),y.update=function(p,v){v==="utf8"&&(p=r.util.encodeUtf8(p));var d=p.length;y.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var g=y.fullMessageLength.length-1;g>=0;--g)y.fullMessageLength[g]+=d[1],d[1]=d[0]+(y.fullMessageLength[g]/4294967296>>>0),y.fullMessageLength[g]=y.fullMessageLength[g]>>>0,d[0]=d[1]/4294967296>>>0;return h.putBytes(p),l(u,f,h),(h.read>2048||h.length()===0)&&h.compact(),y},y.digest=function(){var p=r.util.createBuffer();p.putBytes(h.bytes());var v=y.fullMessageLength[y.fullMessageLength.length-1]+y.messageLengthSize,d=v&y.blockLength-1;p.putBytes(i.substr(0,y.blockLength-d));for(var g,b,_=y.fullMessageLength[0]*8,m=0;m<y.fullMessageLength.length-1;++m)g=y.fullMessageLength[m+1]*8,b=g/4294967296>>>0,_+=b,p.putInt32(_>>>0),_=g>>>0;p.putInt32(_);var E={h0:u.h0,h1:u.h1,h2:u.h2,h3:u.h3,h4:u.h4,h5:u.h5,h6:u.h6,h7:u.h7};l(E,f,p);var D=r.util.createBuffer();return D.putInt32(E.h0),D.putInt32(E.h1),D.putInt32(E.h2),D.putInt32(E.h3),D.putInt32(E.h4),D.putInt32(E.h5),D.putInt32(E.h6),D.putInt32(E.h7),D},y};var i=null,s=!1,a=null;function o(){i=String.fromCharCode(128),i+=r.util.fillString(String.fromCharCode(0),64),a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0}function l(u,h,f){for(var y,p,v,d,g,b,_,m,E,D,N,R,T,S,O,F=f.length();F>=64;){for(_=0;_<16;++_)h[_]=f.getInt32();for(;_<64;++_)y=h[_-2],y=(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10,p=h[_-15],p=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,h[_]=y+h[_-7]+p+h[_-16]|0;for(m=u.h0,E=u.h1,D=u.h2,N=u.h3,R=u.h4,T=u.h5,S=u.h6,O=u.h7,_=0;_<64;++_)d=(R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7),g=S^R&(T^S),v=(m>>>2|m<<30)^(m>>>13|m<<19)^(m>>>22|m<<10),b=m&E|D&(m^E),y=O+d+g+a[_]+h[_],p=v+b,O=S,S=T,T=R,R=N+y>>>0,N=D,D=E,E=m,m=y+p>>>0;u.h0=u.h0+m|0,u.h1=u.h1+E|0,u.h2=u.h2+D|0,u.h3=u.h3+N|0,u.h4=u.h4+R|0,u.h5=u.h5+T|0,u.h6=u.h6+S|0,u.h7=u.h7+O|0,F-=64}}}),NK=A((e,t)=>{c();var r=st();gr();var n=null;r.util.isNodejs&&!r.options.usePureJavaScript&&!process.versions["node-webkit"]&&(n=rh());var i=t.exports=r.prng=r.prng||{};i.create=function(s){for(var a={plugin:s,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},o=s.md,l=new Array(32),u=0;u<32;++u)l[u]=o.create();a.pools=l,a.pool=0,a.generate=function(v,d){if(!d)return a.generateSync(v);var g=a.plugin.cipher,b=a.plugin.increment,_=a.plugin.formatKey,m=a.plugin.formatSeed,E=r.util.createBuffer();a.key=null,D();function D(N){if(N)return d(N);if(E.length()>=v)return d(null,E.getBytes(v));if(a.generated>1048575&&(a.key=null),a.key===null)return r.util.nextTick(function(){h(D)});var R=g(a.key,a.seed);a.generated+=R.length,E.putBytes(R),a.key=_(g(a.key,b(a.seed))),a.seed=m(g(a.key,a.seed)),r.util.setImmediate(D)}},a.generateSync=function(v){var d=a.plugin.cipher,g=a.plugin.increment,b=a.plugin.formatKey,_=a.plugin.formatSeed;a.key=null;for(var m=r.util.createBuffer();m.length()<v;){a.generated>1048575&&(a.key=null),a.key===null&&f();var E=d(a.key,a.seed);a.generated+=E.length,m.putBytes(E),a.key=b(d(a.key,g(a.seed))),a.seed=_(d(a.key,a.seed))}return m.getBytes(v)};function h(v){if(a.pools[0].messageLength>=32)return y(),v();var d=32-a.pools[0].messageLength<<5;a.seedFile(d,function(g,b){if(g)return v(g);a.collect(b),y(),v()})}function f(){if(a.pools[0].messageLength>=32)return y();var v=32-a.pools[0].messageLength<<5;a.collect(a.seedFileSync(v)),y()}function y(){a.reseeds=a.reseeds===4294967295?0:a.reseeds+1;var v=a.plugin.md.create();v.update(a.keyBytes);for(var d=1,g=0;g<32;++g)a.reseeds%d===0&&(v.update(a.pools[g].digest().getBytes()),a.pools[g].start()),d=d<<1;a.keyBytes=v.digest().getBytes(),v.start(),v.update(a.keyBytes);var b=v.digest().getBytes();a.key=a.plugin.formatKey(a.keyBytes),a.seed=a.plugin.formatSeed(b),a.generated=0}function p(v){var d=null,g=r.util.globalScope,b=g.crypto||g.msCrypto;b&&b.getRandomValues&&(d=function(O){return b.getRandomValues(O)});var _=r.util.createBuffer();if(d)for(;_.length()<v;){var m=Math.max(1,Math.min(v-_.length(),65536)/4),E=new Uint32Array(Math.floor(m));try{d(E);for(var D=0;D<E.length;++D)_.putInt32(E[D])}catch(O){if(!(typeof QuotaExceededError<"u"&&O instanceof QuotaExceededError))throw O}}if(_.length()<v)for(var N,R,T,S=Math.floor(Math.random()*65536);_.length()<v;){R=16807*(S&65535),N=16807*(S>>16),R+=(N&32767)<<16,R+=N>>15,R=(R&2147483647)+(R>>31),S=R&4294967295;for(var D=0;D<3;++D)T=S>>>(D<<3),T^=Math.floor(Math.random()*256),_.putByte(T&255)}return _.getBytes(v)}return n?(a.seedFile=function(v,d){n.randomBytes(v,function(g,b){if(g)return d(g);d(null,b.toString())})},a.seedFileSync=function(v){return n.randomBytes(v).toString()}):(a.seedFile=function(v,d){try{d(null,p(v))}catch(g){d(g)}},a.seedFileSync=p),a.collect=function(v){for(var d=v.length,g=0;g<d;++g)a.pools[a.pool].update(v.substr(g,1)),a.pool=a.pool===31?0:a.pool+1},a.collectInt=function(v,d){for(var g="",b=0;b<d;b+=8)g+=String.fromCharCode(v>>b&255);a.collect(g)},a.registerWorker=function(v){if(v===self)a.seedFile=function(g,b){function _(m){var E=m.data;E.forge&&E.forge.prng&&(self.removeEventListener("message",_),b(E.forge.prng.err,E.forge.prng.bytes))}self.addEventListener("message",_),self.postMessage({forge:{prng:{needed:g}}})};else{var d=function(g){var b=g.data;b.forge&&b.forge.prng&&a.seedFile(b.forge.prng.needed,function(_,m){v.postMessage({forge:{prng:{err:_,bytes:m}}})})};v.addEventListener("message",d)}},a}}),nh=A((e,t)=>{c();var r=st();jp(),DK(),NK(),gr(),function(){if(r.random&&r.random.getBytes){t.exports=r.random;return}(function(n){var i={},s=new Array(4),a=r.util.createBuffer();i.formatKey=function(v){var d=r.util.createBuffer(v);return v=new Array(4),v[0]=d.getInt32(),v[1]=d.getInt32(),v[2]=d.getInt32(),v[3]=d.getInt32(),r.aes._expandKey(v,!1)},i.formatSeed=function(v){var d=r.util.createBuffer(v);return v=new Array(4),v[0]=d.getInt32(),v[1]=d.getInt32(),v[2]=d.getInt32(),v[3]=d.getInt32(),v},i.cipher=function(v,d){return r.aes._updateBlock(v,d,s,!1),a.putInt32(s[0]),a.putInt32(s[1]),a.putInt32(s[2]),a.putInt32(s[3]),a.getBytes()},i.increment=function(v){return++v[3],v},i.md=r.md.sha256;function o(){var v=r.prng.create(i);return v.getBytes=function(d,g){return v.generate(d,g)},v.getBytesSync=function(d){return v.generate(d)},v}var l=o(),u=null,h=r.util.globalScope,f=h.crypto||h.msCrypto;if(f&&f.getRandomValues&&(u=function(v){return f.getRandomValues(v)}),r.options.usePureJavaScript||!r.util.isNodejs&&!u){if(typeof window>"u"||window.document,l.collectInt(+new Date,32),typeof navigator<"u"){var y="";for(var p in navigator)try{typeof navigator[p]=="string"&&(y+=navigator[p])}catch{}l.collect(y),y=null}n&&(n().mousemove(function(v){l.collectInt(v.clientX,16),l.collectInt(v.clientY,16)}),n().keypress(function(v){l.collectInt(v.charCode,8)}))}if(!r.random)r.random=l;else for(var p in l)r.random[p]=l[p];r.random.createInstance=o,t.exports=r.random})(typeof jQuery<"u"?jQuery:null)}()}),MK=A((e,t)=>{c();var r=st();gr();var n=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],i=[1,2,3,5],s=function(l,u){return l<<u&65535|(l&65535)>>16-u},a=function(l,u){return(l&65535)>>u|l<<16-u&65535};t.exports=r.rc2=r.rc2||{},r.rc2.expandKey=function(l,u){typeof l=="string"&&(l=r.util.createBuffer(l)),u=u||128;var h=l,f=l.length(),y=u,p=Math.ceil(y/8),v=255>>(y&7),d;for(d=f;d<128;d++)h.putByte(n[h.at(d-1)+h.at(d-f)&255]);for(h.setAt(128-p,n[h.at(128-p)&v]),d=127-p;d>=0;d--)h.setAt(d,n[h.at(d+1)^h.at(d+p)]);return h};var o=function(l,u,h){var f=!1,y=null,p=null,v=null,d,g,b,_,m=[];for(l=r.rc2.expandKey(l,u),b=0;b<64;b++)m.push(l.getInt16Le());h?(d=function(N){for(b=0;b<4;b++)N[b]+=m[_]+(N[(b+3)%4]&N[(b+2)%4])+(~N[(b+3)%4]&N[(b+1)%4]),N[b]=s(N[b],i[b]),_++},g=function(N){for(b=0;b<4;b++)N[b]+=m[N[(b+3)%4]&63]}):(d=function(N){for(b=3;b>=0;b--)N[b]=a(N[b],i[b]),N[b]-=m[_]+(N[(b+3)%4]&N[(b+2)%4])+(~N[(b+3)%4]&N[(b+1)%4]),_--},g=function(N){for(b=3;b>=0;b--)N[b]-=m[N[(b+3)%4]&63]});var E=function(N){var R=[];for(b=0;b<4;b++){var T=y.getInt16Le();v!==null&&(h?T^=v.getInt16Le():v.putInt16Le(T)),R.push(T&65535)}_=h?0:63;for(var S=0;S<N.length;S++)for(var O=0;O<N[S][0];O++)N[S][1](R);for(b=0;b<4;b++)v!==null&&(h?v.putInt16Le(R[b]):R[b]^=v.getInt16Le()),p.putInt16Le(R[b])},D=null;return D={start:function(N,R){N&&typeof N=="string"&&(N=r.util.createBuffer(N)),f=!1,y=r.util.createBuffer(),p=R||new r.util.createBuffer,v=N,D.output=p},update:function(N){for(f||y.putBuffer(N);y.length()>=8;)E([[5,d],[1,g],[6,d],[1,g],[5,d]])},finish:function(N){var R=!0;if(h)if(N)R=N(8,y,!h);else{var T=y.length()===8?8:8-y.length();y.fillWithByte(T,T)}if(R&&(f=!0,D.update()),!h&&(R=y.length()===0,R))if(N)R=N(8,p,!h);else{var S=p.length(),O=p.at(S-1);O>S?R=!1:p.truncate(O)}return R}},D};r.rc2.startEncrypting=function(l,u,h){var f=r.rc2.createEncryptionCipher(l,128);return f.start(u,h),f},r.rc2.createEncryptionCipher=function(l,u){return o(l,u,!0)},r.rc2.startDecrypting=function(l,u,h){var f=r.rc2.createDecryptionCipher(l,128);return f.start(u,h),f},r.rc2.createDecryptionCipher=function(l,u){return o(l,u,!1)}}),L2=A((e,t)=>{c();var r=st();t.exports=r.jsbn=r.jsbn||{};var n,i=0xdeadbeefcafe,s=(i&16777215)==15715070;function a(re,se,he){this.data=[],re!=null&&(typeof re=="number"?this.fromNumber(re,se,he):se==null&&typeof re!="string"?this.fromString(re,256):this.fromString(re,se))}r.jsbn.BigInteger=a;function o(){return new a(null)}function l(re,se,he,Me,gt,Et){for(;--Et>=0;){var Ut=se*this.data[re++]+he.data[Me]+gt;gt=Math.floor(Ut/67108864),he.data[Me++]=Ut&67108863}return gt}function u(re,se,he,Me,gt,Et){for(var Ut=se&32767,Mt=se>>15;--Et>=0;){var Nr=this.data[re]&32767,un=this.data[re++]>>15,ui=Mt*Nr+un*Ut;Nr=Ut*Nr+((ui&32767)<<15)+he.data[Me]+(gt&1073741823),gt=(Nr>>>30)+(ui>>>15)+Mt*un+(gt>>>30),he.data[Me++]=Nr&1073741823}return gt}function h(re,se,he,Me,gt,Et){for(var Ut=se&16383,Mt=se>>14;--Et>=0;){var Nr=this.data[re]&16383,un=this.data[re++]>>14,ui=Mt*Nr+un*Ut;Nr=Ut*Nr+((ui&16383)<<14)+he.data[Me]+gt,gt=(Nr>>28)+(ui>>14)+Mt*un,he.data[Me++]=Nr&268435455}return gt}typeof navigator>"u"?(a.prototype.am=h,n=28):s&&navigator.appName=="Microsoft Internet Explorer"?(a.prototype.am=u,n=30):s&&navigator.appName!="Netscape"?(a.prototype.am=l,n=26):(a.prototype.am=h,n=28),a.prototype.DB=n,a.prototype.DM=(1<<n)-1,a.prototype.DV=1<<n;var f=52;a.prototype.FV=Math.pow(2,f),a.prototype.F1=f-n,a.prototype.F2=2*n-f;var y="0123456789abcdefghijklmnopqrstuvwxyz",p=new Array,v,d;for(v="0".charCodeAt(0),d=0;d<=9;++d)p[v++]=d;for(v="a".charCodeAt(0),d=10;d<36;++d)p[v++]=d;for(v="A".charCodeAt(0),d=10;d<36;++d)p[v++]=d;function g(re){return y.charAt(re)}function b(re,se){var he=p[re.charCodeAt(se)];return he??-1}function _(re){for(var se=this.t-1;se>=0;--se)re.data[se]=this.data[se];re.t=this.t,re.s=this.s}function m(re){this.t=1,this.s=re<0?-1:0,re>0?this.data[0]=re:re<-1?this.data[0]=re+this.DV:this.t=0}function E(re){var se=o();return se.fromInt(re),se}function D(re,se){var he;if(se==16)he=4;else if(se==8)he=3;else if(se==256)he=8;else if(se==2)he=1;else if(se==32)he=5;else if(se==4)he=2;else{this.fromRadix(re,se);return}this.t=0,this.s=0;for(var Me=re.length,gt=!1,Et=0;--Me>=0;){var Ut=he==8?re[Me]&255:b(re,Me);if(Ut<0){re.charAt(Me)=="-"&&(gt=!0);continue}gt=!1,Et==0?this.data[this.t++]=Ut:Et+he>this.DB?(this.data[this.t-1]|=(Ut&(1<<this.DB-Et)-1)<<Et,this.data[this.t++]=Ut>>this.DB-Et):this.data[this.t-1]|=Ut<<Et,Et+=he,Et>=this.DB&&(Et-=this.DB)}he==8&&(re[0]&128)!=0&&(this.s=-1,Et>0&&(this.data[this.t-1]|=(1<<this.DB-Et)-1<<Et)),this.clamp(),gt&&a.ZERO.subTo(this,this)}function N(){for(var re=this.s&this.DM;this.t>0&&this.data[this.t-1]==re;)--this.t}function R(re){if(this.s<0)return"-"+this.negate().toString(re);var se;if(re==16)se=4;else if(re==8)se=3;else if(re==2)se=1;else if(re==32)se=5;else if(re==4)se=2;else return this.toRadix(re);var he=(1<<se)-1,Me,gt=!1,Et="",Ut=this.t,Mt=this.DB-Ut*this.DB%se;if(Ut-- >0)for(Mt<this.DB&&(Me=this.data[Ut]>>Mt)>0&&(gt=!0,Et=g(Me));Ut>=0;)Mt<se?(Me=(this.data[Ut]&(1<<Mt)-1)<<se-Mt,Me|=this.data[--Ut]>>(Mt+=this.DB-se)):(Me=this.data[Ut]>>(Mt-=se)&he,Mt<=0&&(Mt+=this.DB,--Ut)),Me>0&&(gt=!0),gt&&(Et+=g(Me));return gt?Et:"0"}function T(){var re=o();return a.ZERO.subTo(this,re),re}function S(){return this.s<0?this.negate():this}function O(re){var se=this.s-re.s;if(se!=0)return se;var he=this.t;if(se=he-re.t,se!=0)return this.s<0?-se:se;for(;--he>=0;)if((se=this.data[he]-re.data[he])!=0)return se;return 0}function F(re){var se=1,he;return(he=re>>>16)!=0&&(re=he,se+=16),(he=re>>8)!=0&&(re=he,se+=8),(he=re>>4)!=0&&(re=he,se+=4),(he=re>>2)!=0&&(re=he,se+=2),(he=re>>1)!=0&&(re=he,se+=1),se}function G(){return this.t<=0?0:this.DB*(this.t-1)+F(this.data[this.t-1]^this.s&this.DM)}function ne(re,se){var he;for(he=this.t-1;he>=0;--he)se.data[he+re]=this.data[he];for(he=re-1;he>=0;--he)se.data[he]=0;se.t=this.t+re,se.s=this.s}function Y(re,se){for(var he=re;he<this.t;++he)se.data[he-re]=this.data[he];se.t=Math.max(this.t-re,0),se.s=this.s}function ce(re,se){var he=re%this.DB,Me=this.DB-he,gt=(1<<Me)-1,Et=Math.floor(re/this.DB),Ut=this.s<<he&this.DM,Mt;for(Mt=this.t-1;Mt>=0;--Mt)se.data[Mt+Et+1]=this.data[Mt]>>Me|Ut,Ut=(this.data[Mt]&gt)<<he;for(Mt=Et-1;Mt>=0;--Mt)se.data[Mt]=0;se.data[Et]=Ut,se.t=this.t+Et+1,se.s=this.s,se.clamp()}function oe(re,se){se.s=this.s;var he=Math.floor(re/this.DB);if(he>=this.t){se.t=0;return}var Me=re%this.DB,gt=this.DB-Me,Et=(1<<Me)-1;se.data[0]=this.data[he]>>Me;for(var Ut=he+1;Ut<this.t;++Ut)se.data[Ut-he-1]|=(this.data[Ut]&Et)<<gt,se.data[Ut-he]=this.data[Ut]>>Me;Me>0&&(se.data[this.t-he-1]|=(this.s&Et)<<gt),se.t=this.t-he,se.clamp()}function H(re,se){for(var he=0,Me=0,gt=Math.min(re.t,this.t);he<gt;)Me+=this.data[he]-re.data[he],se.data[he++]=Me&this.DM,Me>>=this.DB;if(re.t<this.t){for(Me-=re.s;he<this.t;)Me+=this.data[he],se.data[he++]=Me&this.DM,Me>>=this.DB;Me+=this.s}else{for(Me+=this.s;he<re.t;)Me-=re.data[he],se.data[he++]=Me&this.DM,Me>>=this.DB;Me-=re.s}se.s=Me<0?-1:0,Me<-1?se.data[he++]=this.DV+Me:Me>0&&(se.data[he++]=Me),se.t=he,se.clamp()}function W(re,se){var he=this.abs(),Me=re.abs(),gt=he.t;for(se.t=gt+Me.t;--gt>=0;)se.data[gt]=0;for(gt=0;gt<Me.t;++gt)se.data[gt+he.t]=he.am(0,Me.data[gt],se,gt,0,he.t);se.s=0,se.clamp(),this.s!=re.s&&a.ZERO.subTo(se,se)}function de(re){for(var se=this.abs(),he=re.t=2*se.t;--he>=0;)re.data[he]=0;for(he=0;he<se.t-1;++he){var Me=se.am(he,se.data[he],re,2*he,0,1);(re.data[he+se.t]+=se.am(he+1,2*se.data[he],re,2*he+1,Me,se.t-he-1))>=se.DV&&(re.data[he+se.t]-=se.DV,re.data[he+se.t+1]=1)}re.t>0&&(re.data[re.t-1]+=se.am(he,se.data[he],re,2*he,0,1)),re.s=0,re.clamp()}function De(re,se,he){var Me=re.abs();if(!(Me.t<=0)){var gt=this.abs();if(gt.t<Me.t){se?.fromInt(0),he!=null&&this.copyTo(he);return}he==null&&(he=o());var Et=o(),Ut=this.s,Mt=re.s,Nr=this.DB-F(Me.data[Me.t-1]);Nr>0?(Me.lShiftTo(Nr,Et),gt.lShiftTo(Nr,he)):(Me.copyTo(Et),gt.copyTo(he));var un=Et.t,ui=Et.data[un-1];if(ui!=0){var zn=ui*(1<<this.F1)+(un>1?Et.data[un-2]>>this.F2:0),es=this.FV/zn,Pu=(1<<this.F1)/zn,Ri=1<<this.F2,Pi=he.t,Bu=Pi-un,vs=se??o();for(Et.dlShiftTo(Bu,vs),he.compareTo(vs)>=0&&(he.data[he.t++]=1,he.subTo(vs,he)),a.ONE.dlShiftTo(un,vs),vs.subTo(Et,Et);Et.t<un;)Et.data[Et.t++]=0;for(;--Bu>=0;){var h1=he.data[--Pi]==ui?this.DM:Math.floor(he.data[Pi]*es+(he.data[Pi-1]+Ri)*Pu);if((he.data[Pi]+=Et.am(0,h1,he,Bu,0,un))<h1)for(Et.dlShiftTo(Bu,vs),he.subTo(vs,he);he.data[Pi]<--h1;)he.subTo(vs,he)}se!=null&&(he.drShiftTo(un,se),Ut!=Mt&&a.ZERO.subTo(se,se)),he.t=un,he.clamp(),Nr>0&&he.rShiftTo(Nr,he),Ut<0&&a.ZERO.subTo(he,he)}}}function Pe(re){var se=o();return this.abs().divRemTo(re,null,se),this.s<0&&se.compareTo(a.ZERO)>0&&re.subTo(se,se),se}function $e(re){this.m=re}function Be(re){return re.s<0||re.compareTo(this.m)>=0?re.mod(this.m):re}function nt(re){return re}function Ve(re){re.divRemTo(this.m,null,re)}function et(re,se,he){re.multiplyTo(se,he),this.reduce(he)}function ht(re,se){re.squareTo(se),this.reduce(se)}$e.prototype.convert=Be,$e.prototype.revert=nt,$e.prototype.reduce=Ve,$e.prototype.mulTo=et,$e.prototype.sqrTo=ht;function Z(){if(this.t<1)return 0;var re=this.data[0];if((re&1)==0)return 0;var se=re&3;return se=se*(2-(re&15)*se)&15,se=se*(2-(re&255)*se)&255,se=se*(2-((re&65535)*se&65535))&65535,se=se*(2-re*se%this.DV)%this.DV,se>0?this.DV-se:-se}function le(re){this.m=re,this.mp=re.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<re.DB-15)-1,this.mt2=2*re.t}function ke(re){var se=o();return re.abs().dlShiftTo(this.m.t,se),se.divRemTo(this.m,null,se),re.s<0&&se.compareTo(a.ZERO)>0&&this.m.subTo(se,se),se}function Ge(re){var se=o();return re.copyTo(se),this.reduce(se),se}function ft(re){for(;re.t<=this.mt2;)re.data[re.t++]=0;for(var se=0;se<this.m.t;++se){var he=re.data[se]&32767,Me=he*this.mpl+((he*this.mph+(re.data[se]>>15)*this.mpl&this.um)<<15)&re.DM;for(he=se+this.m.t,re.data[he]+=this.m.am(0,Me,re,se,0,this.m.t);re.data[he]>=re.DV;)re.data[he]-=re.DV,re.data[++he]++}re.clamp(),re.drShiftTo(this.m.t,re),re.compareTo(this.m)>=0&&re.subTo(this.m,re)}function yt(re,se){re.squareTo(se),this.reduce(se)}function V(re,se,he){re.multiplyTo(se,he),this.reduce(he)}le.prototype.convert=ke,le.prototype.revert=Ge,le.prototype.reduce=ft,le.prototype.mulTo=V,le.prototype.sqrTo=yt;function z(){return(this.t>0?this.data[0]&1:this.s)==0}function Oe(re,se){if(re>4294967295||re<1)return a.ONE;var he=o(),Me=o(),gt=se.convert(this),Et=F(re)-1;for(gt.copyTo(he);--Et>=0;)if(se.sqrTo(he,Me),(re&1<<Et)>0)se.mulTo(Me,gt,he);else{var Ut=he;he=Me,Me=Ut}return se.revert(he)}function tt(re,se){var he;return re<256||se.isEven()?he=new $e(se):he=new le(se),this.exp(re,he)}a.prototype.copyTo=_,a.prototype.fromInt=m,a.prototype.fromString=D,a.prototype.clamp=N,a.prototype.dlShiftTo=ne,a.prototype.drShiftTo=Y,a.prototype.lShiftTo=ce,a.prototype.rShiftTo=oe,a.prototype.subTo=H,a.prototype.multiplyTo=W,a.prototype.squareTo=de,a.prototype.divRemTo=De,a.prototype.invDigit=Z,a.prototype.isEven=z,a.prototype.exp=Oe,a.prototype.toString=R,a.prototype.negate=T,a.prototype.abs=S,a.prototype.compareTo=O,a.prototype.bitLength=G,a.prototype.mod=Pe,a.prototype.modPowInt=tt,a.ZERO=E(0),a.ONE=E(1);function Ft(){var re=o();return this.copyTo(re),re}function Dt(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Lt(){return this.t==0?this.s:this.data[0]<<24>>24}function $t(){return this.t==0?this.s:this.data[0]<<16>>16}function Wt(re){return Math.floor(Math.LN2*this.DB/Math.log(re))}function lr(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Cr(re){if(re==null&&(re=10),this.signum()==0||re<2||re>36)return"0";var se=this.chunkSize(re),he=Math.pow(re,se),Me=E(he),gt=o(),Et=o(),Ut="";for(this.divRemTo(Me,gt,Et);gt.signum()>0;)Ut=(he+Et.intValue()).toString(re).substr(1)+Ut,gt.divRemTo(Me,gt,Et);return Et.intValue().toString(re)+Ut}function sr(re,se){this.fromInt(0),se==null&&(se=10);for(var he=this.chunkSize(se),Me=Math.pow(se,he),gt=!1,Et=0,Ut=0,Mt=0;Mt<re.length;++Mt){var Nr=b(re,Mt);if(Nr<0){re.charAt(Mt)=="-"&&this.signum()==0&&(gt=!0);continue}Ut=se*Ut+Nr,++Et>=he&&(this.dMultiply(Me),this.dAddOffset(Ut,0),Et=0,Ut=0)}Et>0&&(this.dMultiply(Math.pow(se,Et)),this.dAddOffset(Ut,0)),gt&&a.ZERO.subTo(this,this)}function Sr(re,se,he){if(typeof se=="number")if(re<2)this.fromInt(1);else for(this.fromNumber(re,he),this.testBit(re-1)||this.bitwiseTo(a.ONE.shiftLeft(re-1),Kt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(se);)this.dAddOffset(2,0),this.bitLength()>re&&this.subTo(a.ONE.shiftLeft(re-1),this);else{var Me=new Array,gt=re&7;Me.length=(re>>3)+1,se.nextBytes(Me),gt>0?Me[0]&=(1<<gt)-1:Me[0]=0,this.fromString(Me,256)}}function x(){var re=this.t,se=new Array;se[0]=this.s;var he=this.DB-re*this.DB%8,Me,gt=0;if(re-- >0)for(he<this.DB&&(Me=this.data[re]>>he)!=(this.s&this.DM)>>he&&(se[gt++]=Me|this.s<<this.DB-he);re>=0;)he<8?(Me=(this.data[re]&(1<<he)-1)<<8-he,Me|=this.data[--re]>>(he+=this.DB-8)):(Me=this.data[re]>>(he-=8)&255,he<=0&&(he+=this.DB,--re)),(Me&128)!=0&&(Me|=-256),gt==0&&(this.s&128)!=(Me&128)&&++gt,(gt>0||Me!=this.s)&&(se[gt++]=Me);return se}function $(re){return this.compareTo(re)==0}function J(re){return this.compareTo(re)<0?this:re}function ge(re){return this.compareTo(re)>0?this:re}function Le(re,se,he){var Me,gt,Et=Math.min(re.t,this.t);for(Me=0;Me<Et;++Me)he.data[Me]=se(this.data[Me],re.data[Me]);if(re.t<this.t){for(gt=re.s&this.DM,Me=Et;Me<this.t;++Me)he.data[Me]=se(this.data[Me],gt);he.t=this.t}else{for(gt=this.s&this.DM,Me=Et;Me<re.t;++Me)he.data[Me]=se(gt,re.data[Me]);he.t=re.t}he.s=se(this.s,re.s),he.clamp()}function it(re,se){return re&se}function bt(re){var se=o();return this.bitwiseTo(re,it,se),se}function Kt(re,se){return re|se}function ar(re){var se=o();return this.bitwiseTo(re,Kt,se),se}function Pr(re,se){return re^se}function Rr(re){var se=o();return this.bitwiseTo(re,Pr,se),se}function Xr(re,se){return re&~se}function Jv(re){var se=o();return this.bitwiseTo(re,Xr,se),se}function Xb(){for(var re=o(),se=0;se<this.t;++se)re.data[se]=this.DM&~this.data[se];return re.t=this.t,re.s=~this.s,re}function Zb(re){var se=o();return re<0?this.rShiftTo(-re,se):this.lShiftTo(re,se),se}function e7(re){var se=o();return re<0?this.lShiftTo(-re,se):this.rShiftTo(re,se),se}function t7(re){if(re==0)return-1;var se=0;return(re&65535)==0&&(re>>=16,se+=16),(re&255)==0&&(re>>=8,se+=8),(re&15)==0&&(re>>=4,se+=4),(re&3)==0&&(re>>=2,se+=2),(re&1)==0&&++se,se}function C7(){for(var re=0;re<this.t;++re)if(this.data[re]!=0)return re*this.DB+t7(this.data[re]);return this.s<0?this.t*this.DB:-1}function k7(re){for(var se=0;re!=0;)re&=re-1,++se;return se}function D7(){for(var re=0,se=this.s&this.DM,he=0;he<this.t;++he)re+=k7(this.data[he]^se);return re}function P7(re){var se=Math.floor(re/this.DB);return se>=this.t?this.s!=0:(this.data[se]&1<<re%this.DB)!=0}function N7(re,se){var he=a.ONE.shiftLeft(re);return this.bitwiseTo(he,se,he),he}function L7(re){return this.changeBit(re,Kt)}function O7(re){return this.changeBit(re,Xr)}function B7(re){return this.changeBit(re,Pr)}function M7(re,se){for(var he=0,Me=0,gt=Math.min(re.t,this.t);he<gt;)Me+=this.data[he]+re.data[he],se.data[he++]=Me&this.DM,Me>>=this.DB;if(re.t<this.t){for(Me+=re.s;he<this.t;)Me+=this.data[he],se.data[he++]=Me&this.DM,Me>>=this.DB;Me+=this.s}else{for(Me+=this.s;he<re.t;)Me+=re.data[he],se.data[he++]=Me&this.DM,Me>>=this.DB;Me+=re.s}se.s=Me<0?-1:0,Me>0?se.data[he++]=Me:Me<-1&&(se.data[he++]=this.DV+Me),se.t=he,se.clamp()}function U7(re){var se=o();return this.addTo(re,se),se}function F7(re){var se=o();return this.subTo(re,se),se}function K7(re){var se=o();return this.multiplyTo(re,se),se}function q7(re){var se=o();return this.divRemTo(re,se,null),se}function r9(re){var se=o();return this.divRemTo(re,null,se),se}function n9(re){var se=o(),he=o();return this.divRemTo(re,se,he),new Array(se,he)}function i9(re){this.data[this.t]=this.am(0,re-1,this,0,0,this.t),++this.t,this.clamp()}function s9(re,se){if(re!=0){for(;this.t<=se;)this.data[this.t++]=0;for(this.data[se]+=re;this.data[se]>=this.DV;)this.data[se]-=this.DV,++se>=this.t&&(this.data[this.t++]=0),++this.data[se]}}function Wo(){}function k2(re){return re}function a9(re,se,he){re.multiplyTo(se,he)}function o9(re,se){re.squareTo(se)}Wo.prototype.convert=k2,Wo.prototype.revert=k2,Wo.prototype.mulTo=a9,Wo.prototype.sqrTo=o9;function c9(re){return this.exp(re,new Wo)}function u9(re,se,he){var Me=Math.min(this.t+re.t,se);for(he.s=0,he.t=Me;Me>0;)he.data[--Me]=0;var gt;for(gt=he.t-this.t;Me<gt;++Me)he.data[Me+this.t]=this.am(0,re.data[Me],he,Me,0,this.t);for(gt=Math.min(re.t,se);Me<gt;++Me)this.am(0,re.data[Me],he,Me,0,se-Me);he.clamp()}function h9(re,se,he){--se;var Me=he.t=this.t+re.t-se;for(he.s=0;--Me>=0;)he.data[Me]=0;for(Me=Math.max(se-this.t,0);Me<re.t;++Me)he.data[this.t+Me-se]=this.am(se-Me,re.data[Me],he,0,0,this.t+Me-se);he.clamp(),he.drShiftTo(1,he)}function wa(re){this.r2=o(),this.q3=o(),a.ONE.dlShiftTo(2*re.t,this.r2),this.mu=this.r2.divide(re),this.m=re}function f9(re){if(re.s<0||re.t>2*this.m.t)return re.mod(this.m);if(re.compareTo(this.m)<0)return re;var se=o();return re.copyTo(se),this.reduce(se),se}function p9(re){return re}function j9(re){for(re.drShiftTo(this.m.t-1,this.r2),re.t>this.m.t+1&&(re.t=this.m.t+1,re.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);re.compareTo(this.r2)<0;)re.dAddOffset(1,this.m.t+1);for(re.subTo(this.r2,re);re.compareTo(this.m)>=0;)re.subTo(this.m,re)}function W9(re,se){re.squareTo(se),this.reduce(se)}function Y9(re,se,he){re.multiplyTo(se,he),this.reduce(he)}wa.prototype.convert=f9,wa.prototype.revert=p9,wa.prototype.reduce=j9,wa.prototype.mulTo=Y9,wa.prototype.sqrTo=W9;function Q9(re,se){var he=re.bitLength(),Me,gt=E(1),Et;if(he<=0)return gt;he<18?Me=1:he<48?Me=3:he<144?Me=4:he<768?Me=5:Me=6,he<8?Et=new $e(se):se.isEven()?Et=new wa(se):Et=new le(se);var Ut=new Array,Mt=3,Nr=Me-1,un=(1<<Me)-1;if(Ut[1]=Et.convert(this),Me>1){var ui=o();for(Et.sqrTo(Ut[1],ui);Mt<=un;)Ut[Mt]=o(),Et.mulTo(ui,Ut[Mt-2],Ut[Mt]),Mt+=2}var zn=re.t-1,es,Pu=!0,Ri=o(),Pi;for(he=F(re.data[zn])-1;zn>=0;){for(he>=Nr?es=re.data[zn]>>he-Nr&un:(es=(re.data[zn]&(1<<he+1)-1)<<Nr-he,zn>0&&(es|=re.data[zn-1]>>this.DB+he-Nr)),Mt=Me;(es&1)==0;)es>>=1,--Mt;if((he-=Mt)<0&&(he+=this.DB,--zn),Pu)Ut[es].copyTo(gt),Pu=!1;else{for(;Mt>1;)Et.sqrTo(gt,Ri),Et.sqrTo(Ri,gt),Mt-=2;Mt>0?Et.sqrTo(gt,Ri):(Pi=gt,gt=Ri,Ri=Pi),Et.mulTo(Ri,Ut[es],gt)}for(;zn>=0&&(re.data[zn]&1<<he)==0;)Et.sqrTo(gt,Ri),Pi=gt,gt=Ri,Ri=Pi,--he<0&&(he=this.DB-1,--zn)}return Et.revert(gt)}function X9(re){var se=this.s<0?this.negate():this.clone(),he=re.s<0?re.negate():re.clone();if(se.compareTo(he)<0){var Me=se;se=he,he=Me}var gt=se.getLowestSetBit(),Et=he.getLowestSetBit();if(Et<0)return se;for(gt<Et&&(Et=gt),Et>0&&(se.rShiftTo(Et,se),he.rShiftTo(Et,he));se.signum()>0;)(gt=se.getLowestSetBit())>0&&se.rShiftTo(gt,se),(gt=he.getLowestSetBit())>0&&he.rShiftTo(gt,he),se.compareTo(he)>=0?(se.subTo(he,se),se.rShiftTo(1,se)):(he.subTo(se,he),he.rShiftTo(1,he));return Et>0&&he.lShiftTo(Et,he),he}function eE(re){if(re<=0)return 0;var se=this.DV%re,he=this.s<0?re-1:0;if(this.t>0)if(se==0)he=this.data[0]%re;else for(var Me=this.t-1;Me>=0;--Me)he=(se*he+this.data[Me])%re;return he}function tE(re){var se=re.isEven();if(this.isEven()&&se||re.signum()==0)return a.ZERO;for(var he=re.clone(),Me=this.clone(),gt=E(1),Et=E(0),Ut=E(0),Mt=E(1);he.signum()!=0;){for(;he.isEven();)he.rShiftTo(1,he),se?((!gt.isEven()||!Et.isEven())&&(gt.addTo(this,gt),Et.subTo(re,Et)),gt.rShiftTo(1,gt)):Et.isEven()||Et.subTo(re,Et),Et.rShiftTo(1,Et);for(;Me.isEven();)Me.rShiftTo(1,Me),se?((!Ut.isEven()||!Mt.isEven())&&(Ut.addTo(this,Ut),Mt.subTo(re,Mt)),Ut.rShiftTo(1,Ut)):Mt.isEven()||Mt.subTo(re,Mt),Mt.rShiftTo(1,Mt);he.compareTo(Me)>=0?(he.subTo(Me,he),se&&gt.subTo(Ut,gt),Et.subTo(Mt,Et)):(Me.subTo(he,Me),se&&Ut.subTo(gt,Ut),Mt.subTo(Et,Mt))}if(Me.compareTo(a.ONE)!=0)return a.ZERO;if(Mt.compareTo(re)>=0)return Mt.subtract(re);if(Mt.signum()<0)Mt.addTo(re,Mt);else return Mt;return Mt.signum()<0?Mt.add(re):Mt}var Ai=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],rE=(1<<26)/Ai[Ai.length-1];function nE(re){var se,he=this.abs();if(he.t==1&&he.data[0]<=Ai[Ai.length-1]){for(se=0;se<Ai.length;++se)if(he.data[0]==Ai[se])return!0;return!1}if(he.isEven())return!1;for(se=1;se<Ai.length;){for(var Me=Ai[se],gt=se+1;gt<Ai.length&&Me<rE;)Me*=Ai[gt++];for(Me=he.modInt(Me);se<gt;)if(Me%Ai[se++]==0)return!1}return he.millerRabin(re)}function iE(re){var se=this.subtract(a.ONE),he=se.getLowestSetBit();if(he<=0)return!1;for(var Me=se.shiftRight(he),gt=sE(),Et,Ut=0;Ut<re;++Ut){do Et=new a(this.bitLength(),gt);while(Et.compareTo(a.ONE)<=0||Et.compareTo(se)>=0);var Mt=Et.modPow(Me,this);if(Mt.compareTo(a.ONE)!=0&&Mt.compareTo(se)!=0){for(var Nr=1;Nr++<he&&Mt.compareTo(se)!=0;)if(Mt=Mt.modPowInt(2,this),Mt.compareTo(a.ONE)==0)return!1;if(Mt.compareTo(se)!=0)return!1}}return!0}function sE(){return{nextBytes:function(re){for(var se=0;se<re.length;++se)re[se]=Math.floor(Math.random()*256)}}}a.prototype.chunkSize=Wt,a.prototype.toRadix=Cr,a.prototype.fromRadix=sr,a.prototype.fromNumber=Sr,a.prototype.bitwiseTo=Le,a.prototype.changeBit=N7,a.prototype.addTo=M7,a.prototype.dMultiply=i9,a.prototype.dAddOffset=s9,a.prototype.multiplyLowerTo=u9,a.prototype.multiplyUpperTo=h9,a.prototype.modInt=eE,a.prototype.millerRabin=iE,a.prototype.clone=Ft,a.prototype.intValue=Dt,a.prototype.byteValue=Lt,a.prototype.shortValue=$t,a.prototype.signum=lr,a.prototype.toByteArray=x,a.prototype.equals=$,a.prototype.min=J,a.prototype.max=ge,a.prototype.and=bt,a.prototype.or=ar,a.prototype.xor=Rr,a.prototype.andNot=Jv,a.prototype.not=Xb,a.prototype.shiftLeft=Zb,a.prototype.shiftRight=e7,a.prototype.getLowestSetBit=C7,a.prototype.bitCount=D7,a.prototype.testBit=P7,a.prototype.setBit=L7,a.prototype.clearBit=O7,a.prototype.flipBit=B7,a.prototype.add=U7,a.prototype.subtract=F7,a.prototype.multiply=K7,a.prototype.divide=q7,a.prototype.remainder=r9,a.prototype.divideAndRemainder=n9,a.prototype.modPow=Q9,a.prototype.modInverse=tE,a.prototype.pow=c9,a.prototype.gcd=X9,a.prototype.isProbablePrime=nE}),QK=A((e,t)=>{c();var r=st();sl(),gr();var n=t.exports=r.sha1=r.sha1||{};r.md.sha1=r.md.algorithms.sha1=n,n.create=function(){s||a();var l=null,u=r.util.createBuffer(),h=new Array(80),f={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return f.start=function(){f.messageLength=0,f.fullMessageLength=f.messageLength64=[];for(var y=f.messageLengthSize/4,p=0;p<y;++p)f.fullMessageLength.push(0);return u=r.util.createBuffer(),l={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},f},f.start(),f.update=function(y,p){p==="utf8"&&(y=r.util.encodeUtf8(y));var v=y.length;f.messageLength+=v,v=[v/4294967296>>>0,v>>>0];for(var d=f.fullMessageLength.length-1;d>=0;--d)f.fullMessageLength[d]+=v[1],v[1]=v[0]+(f.fullMessageLength[d]/4294967296>>>0),f.fullMessageLength[d]=f.fullMessageLength[d]>>>0,v[0]=v[1]/4294967296>>>0;return u.putBytes(y),o(l,h,u),(u.read>2048||u.length()===0)&&u.compact(),f},f.digest=function(){var y=r.util.createBuffer();y.putBytes(u.bytes());var p=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize,v=p&f.blockLength-1;y.putBytes(i.substr(0,f.blockLength-v));for(var d,g,b=f.fullMessageLength[0]*8,_=0;_<f.fullMessageLength.length-1;++_)d=f.fullMessageLength[_+1]*8,g=d/4294967296>>>0,b+=g,y.putInt32(b>>>0),b=d>>>0;y.putInt32(b);var m={h0:l.h0,h1:l.h1,h2:l.h2,h3:l.h3,h4:l.h4};o(m,h,y);var E=r.util.createBuffer();return E.putInt32(m.h0),E.putInt32(m.h1),E.putInt32(m.h2),E.putInt32(m.h3),E.putInt32(m.h4),E},f};var i=null,s=!1;function a(){i=String.fromCharCode(128),i+=r.util.fillString(String.fromCharCode(0),64),s=!0}function o(l,u,h){for(var f,y,p,v,d,g,b,_,m=h.length();m>=64;){for(y=l.h0,p=l.h1,v=l.h2,d=l.h3,g=l.h4,_=0;_<16;++_)f=h.getInt32(),u[_]=f,b=d^p&(v^d),f=(y<<5|y>>>27)+b+g+1518500249+f,g=d,d=v,v=(p<<30|p>>>2)>>>0,p=y,y=f;for(;_<20;++_)f=u[_-3]^u[_-8]^u[_-14]^u[_-16],f=f<<1|f>>>31,u[_]=f,b=d^p&(v^d),f=(y<<5|y>>>27)+b+g+1518500249+f,g=d,d=v,v=(p<<30|p>>>2)>>>0,p=y,y=f;for(;_<32;++_)f=u[_-3]^u[_-8]^u[_-14]^u[_-16],f=f<<1|f>>>31,u[_]=f,b=p^v^d,f=(y<<5|y>>>27)+b+g+1859775393+f,g=d,d=v,v=(p<<30|p>>>2)>>>0,p=y,y=f;for(;_<40;++_)f=u[_-6]^u[_-16]^u[_-28]^u[_-32],f=f<<2|f>>>30,u[_]=f,b=p^v^d,f=(y<<5|y>>>27)+b+g+1859775393+f,g=d,d=v,v=(p<<30|p>>>2)>>>0,p=y,y=f;for(;_<60;++_)f=u[_-6]^u[_-16]^u[_-28]^u[_-32],f=f<<2|f>>>30,u[_]=f,b=p&v|d&(p^v),f=(y<<5|y>>>27)+b+g+2400959708+f,g=d,d=v,v=(p<<30|p>>>2)>>>0,p=y,y=f;for(;_<80;++_)f=u[_-6]^u[_-16]^u[_-28]^u[_-32],f=f<<2|f>>>30,u[_]=f,b=p^v^d,f=(y<<5|y>>>27)+b+g+3395469782+f,g=d,d=v,v=(p<<30|p>>>2)>>>0,p=y,y=f;l.h0=l.h0+y|0,l.h1=l.h1+p|0,l.h2=l.h2+v|0,l.h3=l.h3+d|0,l.h4=l.h4+g|0,m-=64}}}),JK=A((e,t)=>{c();var r=st();gr(),nh(),QK();var n=t.exports=r.pkcs1=r.pkcs1||{};n.encode_rsa_oaep=function(s,a,o){var l,u,h,f;typeof o=="string"?(l=o,u=arguments[3]||void 0,h=arguments[4]||void 0):o&&(l=o.label||void 0,u=o.seed||void 0,h=o.md||void 0,o.mgf1&&o.mgf1.md&&(f=o.mgf1.md)),h?h.start():h=r.md.sha1.create(),f||(f=h);var y=Math.ceil(s.n.bitLength()/8),p=y-2*h.digestLength-2;if(a.length>p){var v=new Error("RSAES-OAEP input message length is too long.");throw v.length=a.length,v.maxLength=p,v}l||(l=""),h.update(l,"raw");for(var d=h.digest(),g="",b=p-a.length,_=0;_<b;_++)g+="\0";var m=d.getBytes()+g+""+a;if(!u)u=r.random.getBytes(h.digestLength);else if(u.length!==h.digestLength){var v=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw v.seedLength=u.length,v.digestLength=h.digestLength,v}var E=i(u,y-h.digestLength-1,f),D=r.util.xorBytes(m,E,m.length),N=i(D,h.digestLength,f),R=r.util.xorBytes(u,N,u.length);return"\0"+R+D},n.decode_rsa_oaep=function(s,a,o){var l,u,h;typeof o=="string"?(l=o,u=arguments[3]||void 0):o&&(l=o.label||void 0,u=o.md||void 0,o.mgf1&&o.mgf1.md&&(h=o.mgf1.md));var f=Math.ceil(s.n.bitLength()/8);if(a.length!==f){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=a.length,y.expectedLength=f,y}if(u===void 0?u=r.md.sha1.create():u.start(),h||(h=u),f<2*u.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");l||(l=""),u.update(l,"raw");for(var p=u.digest().getBytes(),v=a.charAt(0),d=a.substring(1,u.digestLength+1),g=a.substring(1+u.digestLength),b=i(g,u.digestLength,h),_=r.util.xorBytes(d,b,d.length),m=i(_,f-u.digestLength-1,h),E=r.util.xorBytes(g,m,g.length),D=E.substring(0,u.digestLength),y=v!=="\0",N=0;N<u.digestLength;++N)y|=p.charAt(N)!==D.charAt(N);for(var R=1,T=u.digestLength,S=u.digestLength;S<E.length;S++){var O=E.charCodeAt(S),F=O&1^1,G=R?65534:0;y|=O&G,R=R&F,T+=R}if(y||E.charCodeAt(T)!==1)throw new Error("Invalid RSAES-OAEP padding.");return E.substring(T+1)};function i(s,a,o){o||(o=r.md.sha1.create());for(var l="",u=Math.ceil(a/o.digestLength),h=0;h<u;++h){var f=String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,h&255);o.start(),o.update(s+f),l+=o.digest().getBytes()}return l.substring(0,a)}}),eV=A((e,t)=>{c();var r=st();gr(),L2(),nh(),function(){if(r.prime){t.exports=r.prime;return}var n=t.exports=r.prime=r.prime||{},i=r.jsbn.BigInteger,s=[6,4,2,4,2,4,6,2],a=new i(null);a.fromInt(30);var o=function(v,d){return v|d};n.generateProbablePrime=function(v,d,g){typeof d=="function"&&(g=d,d={}),d=d||{};var b=d.algorithm||"PRIMEINC";typeof b=="string"&&(b={name:b}),b.options=b.options||{};var _=d.prng||r.random,m={nextBytes:function(E){for(var D=_.getBytesSync(E.length),N=0;N<E.length;++N)E[N]=D.charCodeAt(N)}};if(b.name==="PRIMEINC")return l(v,m,b.options,g);throw new Error("Invalid prime generation algorithm: "+b.name)};function l(v,d,g,b){return"workers"in g?f(v,d,g,b):u(v,d,g,b)}function u(v,d,g,b){var _=y(v,d),m=0,E=p(_.bitLength());"millerRabinTests"in g&&(E=g.millerRabinTests);var D=10;"maxBlockTime"in g&&(D=g.maxBlockTime),h(_,v,d,m,E,D,b)}function h(v,d,g,b,_,m,E){var D=+new Date;do{if(v.bitLength()>d&&(v=y(d,g)),v.isProbablePrime(_))return E(null,v);v.dAddOffset(s[b++%8],0)}while(m<0||+new Date-D<m);r.util.setImmediate(function(){h(v,d,g,b,_,m,E)})}function f(v,d,g,b){if(typeof Worker>"u")return u(v,d,g,b);var _=y(v,d),m=g.workers,E=g.workLoad||100,D=E*30/8,N=g.workerScript||"forge/prime.worker.js";if(m===-1)return r.util.estimateCores(function(T,S){T&&(S=2),m=S-1,R()});R();function R(){m=Math.max(1,m);for(var T=[],S=0;S<m;++S)T[S]=new Worker(N);for(var O=m,S=0;S<m;++S)T[S].addEventListener("message",G);var F=!1;function G(ne){if(!F){--O;var Y=ne.data;if(Y.found){for(var ce=0;ce<T.length;++ce)T[ce].terminate();return F=!0,b(null,new i(Y.prime,16))}_.bitLength()>v&&(_=y(v,d));var oe=_.toString(16);ne.target.postMessage({hex:oe,workLoad:E}),_.dAddOffset(D,0)}}}}function y(v,d){var g=new i(v,d),b=v-1;return g.testBit(b)||g.bitwiseTo(i.ONE.shiftLeft(b),o,g),g.dAddOffset(31-g.mod(a).byteValue(),0),g}function p(v){return v<=100?27:v<=150?18:v<=200?15:v<=250?12:v<=300?9:v<=350?8:v<=400?7:v<=500?6:v<=600?5:v<=800?4:v<=1250?3:2}}()}),sh=A((e,t)=>{c();var r=st();Aa(),L2(),$p(),JK(),eV(),nh(),gr(),typeof n>"u"&&(n=r.jsbn.BigInteger);var n,i=r.util.isNodejs?rh():null,s=r.asn1,a=r.util;r.pki=r.pki||{},t.exports=r.pki.rsa=r.rsa=r.rsa||{};var o=r.pki,l=[6,4,2,4,2,4,6,2],u={name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},h={name:"RSAPrivateKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},f={name:"RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},y=r.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p={name:"DigestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},v=function(S){var O;if(S.algorithm in o.oids)O=o.oids[S.algorithm];else{var F=new Error("Unknown message digest algorithm.");throw F.algorithm=S.algorithm,F}var G=s.oidToDer(O).getBytes(),ne=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),Y=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);Y.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,G)),Y.value.push(s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,""));var ce=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,S.digest().getBytes());return ne.value.push(Y),ne.value.push(ce),s.toDer(ne).getBytes()},d=function(S,O,F){if(F)return S.modPow(O.e,O.n);if(!O.p||!O.q)return S.modPow(O.d,O.n);O.dP||(O.dP=O.d.mod(O.p.subtract(n.ONE))),O.dQ||(O.dQ=O.d.mod(O.q.subtract(n.ONE))),O.qInv||(O.qInv=O.q.modInverse(O.p));var G;do G=new n(r.util.bytesToHex(r.random.getBytes(O.n.bitLength()/8)),16);while(G.compareTo(O.n)>=0||!G.gcd(O.n).equals(n.ONE));S=S.multiply(G.modPow(O.e,O.n)).mod(O.n);for(var ne=S.mod(O.p).modPow(O.dP,O.p),Y=S.mod(O.q).modPow(O.dQ,O.q);ne.compareTo(Y)<0;)ne=ne.add(O.p);var ce=ne.subtract(Y).multiply(O.qInv).mod(O.p).multiply(O.q).add(Y);return ce=ce.multiply(G.modInverse(O.n)).mod(O.n),ce};o.rsa.encrypt=function(S,O,F){var G=F,ne,Y=Math.ceil(O.n.bitLength()/8);F!==!1&&F!==!0?(G=F===2,ne=g(S,O,F)):(ne=r.util.createBuffer(),ne.putBytes(S));for(var ce=new n(ne.toHex(),16),oe=d(ce,O,G),H=oe.toString(16),W=r.util.createBuffer(),de=Y-Math.ceil(H.length/2);de>0;)W.putByte(0),--de;return W.putBytes(r.util.hexToBytes(H)),W.getBytes()},o.rsa.decrypt=function(S,O,F,G){var ne=Math.ceil(O.n.bitLength()/8);if(S.length!==ne){var Y=new Error("Encrypted message length is invalid.");throw Y.length=S.length,Y.expected=ne,Y}var ce=new n(r.util.createBuffer(S).toHex(),16);if(ce.compareTo(O.n)>=0)throw new Error("Encrypted message is invalid.");for(var oe=d(ce,O,F),H=oe.toString(16),W=r.util.createBuffer(),de=ne-Math.ceil(H.length/2);de>0;)W.putByte(0),--de;return W.putBytes(r.util.hexToBytes(H)),G!==!1?b(W.getBytes(),O,F):W.getBytes()},o.rsa.createKeyPairGenerationState=function(S,O,F){typeof S=="string"&&(S=parseInt(S,10)),S=S||2048,F=F||{};var G=F.prng||r.random,ne={nextBytes:function(oe){for(var H=G.getBytesSync(oe.length),W=0;W<oe.length;++W)oe[W]=H.charCodeAt(W)}},Y=F.algorithm||"PRIMEINC",ce;if(Y==="PRIMEINC")ce={algorithm:Y,state:0,bits:S,rng:ne,eInt:O||65537,e:new n(null),p:null,q:null,qBits:S>>1,pBits:S-(S>>1),pqState:0,num:null,keys:null},ce.e.fromInt(ce.eInt);else throw new Error("Invalid key generation algorithm: "+Y);return ce},o.rsa.stepKeyPairGenerationState=function(S,O){"algorithm"in S||(S.algorithm="PRIMEINC");var F=new n(null);F.fromInt(30);for(var G=0,ne=function(De,Pe){return De|Pe},Y=+new Date,ce,oe=0;S.keys===null&&(O<=0||oe<O);){if(S.state===0){var H=S.p===null?S.pBits:S.qBits,W=H-1;S.pqState===0?(S.num=new n(H,S.rng),S.num.testBit(W)||S.num.bitwiseTo(n.ONE.shiftLeft(W),ne,S.num),S.num.dAddOffset(31-S.num.mod(F).byteValue(),0),G=0,++S.pqState):S.pqState===1?S.num.bitLength()>H?S.pqState=0:S.num.isProbablePrime(E(S.num.bitLength()))?++S.pqState:S.num.dAddOffset(l[G++%8],0):S.pqState===2?S.pqState=S.num.subtract(n.ONE).gcd(S.e).compareTo(n.ONE)===0?3:0:S.pqState===3&&(S.pqState=0,S.p===null?S.p=S.num:S.q=S.num,S.p!==null&&S.q!==null&&++S.state,S.num=null)}else if(S.state===1)S.p.compareTo(S.q)<0&&(S.num=S.p,S.p=S.q,S.q=S.num),++S.state;else if(S.state===2)S.p1=S.p.subtract(n.ONE),S.q1=S.q.subtract(n.ONE),S.phi=S.p1.multiply(S.q1),++S.state;else if(S.state===3)S.phi.gcd(S.e).compareTo(n.ONE)===0?++S.state:(S.p=null,S.q=null,S.state=0);else if(S.state===4)S.n=S.p.multiply(S.q),S.n.bitLength()===S.bits?++S.state:(S.q=null,S.state=0);else if(S.state===5){var de=S.e.modInverse(S.phi);S.keys={privateKey:o.rsa.setPrivateKey(S.n,S.e,de,S.p,S.q,de.mod(S.p1),de.mod(S.q1),S.q.modInverse(S.p)),publicKey:o.rsa.setPublicKey(S.n,S.e)}}ce=+new Date,oe+=ce-Y,Y=ce}return S.keys!==null},o.rsa.generateKeyPair=function(S,O,F,G){if(arguments.length===1?typeof S=="object"?(F=S,S=void 0):typeof S=="function"&&(G=S,S=void 0):arguments.length===2?typeof S=="number"?typeof O=="function"?(G=O,O=void 0):typeof O!="number"&&(F=O,O=void 0):(F=S,G=O,S=void 0,O=void 0):arguments.length===3&&(typeof O=="number"?typeof F=="function"&&(G=F,F=void 0):(G=F,F=O,O=void 0)),F=F||{},S===void 0&&(S=F.bits||2048),O===void 0&&(O=F.e||65537),!r.options.usePureJavaScript&&!F.prng&&S>=256&&S<=16384&&(O===65537||O===3)){if(G){if(D("generateKeyPair"))return i.generateKeyPair("rsa",{modulusLength:S,publicExponent:O,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(oe,H,W){if(oe)return G(oe);G(null,{privateKey:o.privateKeyFromPem(W),publicKey:o.publicKeyFromPem(H)})});if(N("generateKey")&&N("exportKey"))return a.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:S,publicExponent:T(O),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(oe){return a.globalScope.crypto.subtle.exportKey("pkcs8",oe.privateKey)}).then(void 0,function(oe){G(oe)}).then(function(oe){if(oe){var H=o.privateKeyFromAsn1(s.fromDer(r.util.createBuffer(oe)));G(null,{privateKey:H,publicKey:o.setRsaPublicKey(H.n,H.e)})}});if(R("generateKey")&&R("exportKey")){var ne=a.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:S,publicExponent:T(O),hash:{name:"SHA-256"}},!0,["sign","verify"]);ne.oncomplete=function(oe){var H=oe.target.result,W=a.globalScope.msCrypto.subtle.exportKey("pkcs8",H.privateKey);W.oncomplete=function(de){var De=de.target.result,Pe=o.privateKeyFromAsn1(s.fromDer(r.util.createBuffer(De)));G(null,{privateKey:Pe,publicKey:o.setRsaPublicKey(Pe.n,Pe.e)})},W.onerror=function(de){G(de)}},ne.onerror=function(oe){G(oe)};return}}else if(D("generateKeyPairSync")){var Y=i.generateKeyPairSync("rsa",{modulusLength:S,publicExponent:O,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:o.privateKeyFromPem(Y.privateKey),publicKey:o.publicKeyFromPem(Y.publicKey)}}}var ce=o.rsa.createKeyPairGenerationState(S,O,F);if(!G)return o.rsa.stepKeyPairGenerationState(ce,0),ce.keys;_(ce,F,G)},o.setRsaPublicKey=o.rsa.setPublicKey=function(S,O){var F={n:S,e:O};return F.encrypt=function(G,ne,Y){if(typeof ne=="string"?ne=ne.toUpperCase():ne===void 0&&(ne="RSAES-PKCS1-V1_5"),ne==="RSAES-PKCS1-V1_5")ne={encode:function(oe,H,W){return g(oe,H,2).getBytes()}};else if(ne==="RSA-OAEP"||ne==="RSAES-OAEP")ne={encode:function(oe,H){return r.pkcs1.encode_rsa_oaep(H,oe,Y)}};else if(["RAW","NONE","NULL",null].indexOf(ne)!==-1)ne={encode:function(oe){return oe}};else if(typeof ne=="string")throw new Error('Unsupported encryption scheme: "'+ne+'".');var ce=ne.encode(G,F,!0);return o.rsa.encrypt(ce,F,!0)},F.verify=function(G,ne,Y,ce){typeof Y=="string"?Y=Y.toUpperCase():Y===void 0&&(Y="RSASSA-PKCS1-V1_5"),ce===void 0&&(ce={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in ce||(ce._parseAllDigestBytes=!0),Y==="RSASSA-PKCS1-V1_5"?Y={verify:function(H,W){W=b(W,F,!0);var de=s.fromDer(W,{parseAllBytes:ce._parseAllDigestBytes}),De={},Pe=[];if(!s.validate(de,p,De,Pe)){var $e=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw $e.errors=Pe,$e}var Be=s.derToOid(De.algorithmIdentifier);if(!(Be===r.oids.md2||Be===r.oids.md5||Be===r.oids.sha1||Be===r.oids.sha224||Be===r.oids.sha256||Be===r.oids.sha384||Be===r.oids.sha512||Be===r.oids["sha512-224"]||Be===r.oids["sha512-256"])){var $e=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw $e.oid=Be,$e}if((Be===r.oids.md2||Be===r.oids.md5)&&!("parameters"in De))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return H===De.digest}}:(Y==="NONE"||Y==="NULL"||Y===null)&&(Y={verify:function(H,W){return W=b(W,F,!0),H===W}});var oe=o.rsa.decrypt(ne,F,!0,!1);return Y.verify(G,oe,F.n.bitLength())},F},o.setRsaPrivateKey=o.rsa.setPrivateKey=function(S,O,F,G,ne,Y,ce,oe){var H={n:S,e:O,d:F,p:G,q:ne,dP:Y,dQ:ce,qInv:oe};return H.decrypt=function(W,de,De){typeof de=="string"?de=de.toUpperCase():de===void 0&&(de="RSAES-PKCS1-V1_5");var Pe=o.rsa.decrypt(W,H,!1,!1);if(de==="RSAES-PKCS1-V1_5")de={decode:b};else if(de==="RSA-OAEP"||de==="RSAES-OAEP")de={decode:function($e,Be){return r.pkcs1.decode_rsa_oaep(Be,$e,De)}};else if(["RAW","NONE","NULL",null].indexOf(de)!==-1)de={decode:function($e){return $e}};else throw new Error('Unsupported encryption scheme: "'+de+'".');return de.decode(Pe,H,!1)},H.sign=function(W,de){var De=!1;typeof de=="string"&&(de=de.toUpperCase()),de===void 0||de==="RSASSA-PKCS1-V1_5"?(de={encode:v},De=1):(de==="NONE"||de==="NULL"||de===null)&&(de={encode:function(){return W}},De=1);var Pe=de.encode(W,H.n.bitLength());return o.rsa.encrypt(Pe,H,De)},H},o.wrapRsaPrivateKey=function(S){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,s.toDer(S).getBytes())])},o.privateKeyFromAsn1=function(S){var O={},F=[];if(s.validate(S,u,O,F)&&(S=s.fromDer(r.util.createBuffer(O.privateKey))),O={},F=[],!s.validate(S,h,O,F)){var G=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw G.errors=F,G}var ne,Y,ce,oe,H,W,de,De;return ne=r.util.createBuffer(O.privateKeyModulus).toHex(),Y=r.util.createBuffer(O.privateKeyPublicExponent).toHex(),ce=r.util.createBuffer(O.privateKeyPrivateExponent).toHex(),oe=r.util.createBuffer(O.privateKeyPrime1).toHex(),H=r.util.createBuffer(O.privateKeyPrime2).toHex(),W=r.util.createBuffer(O.privateKeyExponent1).toHex(),de=r.util.createBuffer(O.privateKeyExponent2).toHex(),De=r.util.createBuffer(O.privateKeyCoefficient).toHex(),o.setRsaPrivateKey(new n(ne,16),new n(Y,16),new n(ce,16),new n(oe,16),new n(H,16),new n(W,16),new n(de,16),new n(De,16))},o.privateKeyToAsn1=o.privateKeyToRSAPrivateKey=function(S){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,m(S.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,m(S.e)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,m(S.d)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,m(S.p)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,m(S.q)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,m(S.dP)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,m(S.dQ)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,m(S.qInv))])},o.publicKeyFromAsn1=function(S){var O={},F=[];if(s.validate(S,y,O,F)){var G=s.derToOid(O.publicKeyOid);if(G!==o.oids.rsaEncryption){var ne=new Error("Cannot read public key. Unknown OID.");throw ne.oid=G,ne}S=O.rsaPublicKey}if(F=[],!s.validate(S,f,O,F)){var ne=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw ne.errors=F,ne}var Y=r.util.createBuffer(O.publicKeyModulus).toHex(),ce=r.util.createBuffer(O.publicKeyExponent).toHex();return o.setRsaPublicKey(new n(Y,16),new n(ce,16))},o.publicKeyToAsn1=o.publicKeyToSubjectPublicKeyInfo=function(S){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,[o.publicKeyToRSAPublicKey(S)])])},o.publicKeyToRSAPublicKey=function(S){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,m(S.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,m(S.e))])};function g(S,O,F){var G=r.util.createBuffer(),ne=Math.ceil(O.n.bitLength()/8);if(S.length>ne-11){var Y=new Error("Message is too long for PKCS#1 v1.5 padding.");throw Y.length=S.length,Y.max=ne-11,Y}G.putByte(0),G.putByte(F);var ce=ne-3-S.length,oe;if(F===0||F===1){oe=F===0?0:255;for(var H=0;H<ce;++H)G.putByte(oe)}else for(;ce>0;){for(var W=0,de=r.random.getBytes(ce),H=0;H<ce;++H)oe=de.charCodeAt(H),oe===0?++W:G.putByte(oe);ce=W}return G.putByte(0),G.putBytes(S),G}function b(S,O,F,G){var ne=Math.ceil(O.n.bitLength()/8),Y=r.util.createBuffer(S),ce=Y.getByte(),oe=Y.getByte();if(ce!==0||F&&oe!==0&&oe!==1||!F&&oe!=2||F&&oe===0&&typeof G>"u")throw new Error("Encryption block is invalid.");var H=0;if(oe===0){H=ne-3-G;for(var W=0;W<H;++W)if(Y.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(oe===1)for(H=0;Y.length()>1;){if(Y.getByte()!==255){--Y.read;break}++H}else if(oe===2)for(H=0;Y.length()>1;){if(Y.getByte()===0){--Y.read;break}++H}var de=Y.getByte();if(de!==0||H!==ne-3-Y.length())throw new Error("Encryption block is invalid.");return Y.getBytes()}function _(S,O,F){typeof O=="function"&&(F=O,O={}),O=O||{};var G={algorithm:{name:O.algorithm||"PRIMEINC",options:{workers:O.workers||2,workLoad:O.workLoad||100,workerScript:O.workerScript}}};"prng"in O&&(G.prng=O.prng),ne();function ne(){Y(S.pBits,function(oe,H){if(oe)return F(oe);if(S.p=H,S.q!==null)return ce(oe,S.q);Y(S.qBits,ce)})}function Y(oe,H){r.prime.generateProbablePrime(oe,G,H)}function ce(oe,H){if(oe)return F(oe);if(S.q=H,S.p.compareTo(S.q)<0){var W=S.p;S.p=S.q,S.q=W}if(S.p.subtract(n.ONE).gcd(S.e).compareTo(n.ONE)!==0){S.p=null,ne();return}if(S.q.subtract(n.ONE).gcd(S.e).compareTo(n.ONE)!==0){S.q=null,Y(S.qBits,ce);return}if(S.p1=S.p.subtract(n.ONE),S.q1=S.q.subtract(n.ONE),S.phi=S.p1.multiply(S.q1),S.phi.gcd(S.e).compareTo(n.ONE)!==0){S.p=S.q=null,ne();return}if(S.n=S.p.multiply(S.q),S.n.bitLength()!==S.bits){S.q=null,Y(S.qBits,ce);return}var de=S.e.modInverse(S.phi);S.keys={privateKey:o.rsa.setPrivateKey(S.n,S.e,de,S.p,S.q,de.mod(S.p1),de.mod(S.q1),S.q.modInverse(S.p)),publicKey:o.rsa.setPublicKey(S.n,S.e)},F(null,S.keys)}}function m(S){var O=S.toString(16);O[0]>="8"&&(O="00"+O);var F=r.util.hexToBytes(O);return F.length>1&&(F.charCodeAt(0)===0&&(F.charCodeAt(1)&128)===0||F.charCodeAt(0)===255&&(F.charCodeAt(1)&128)===128)?F.substr(1):F}function E(S){return S<=100?27:S<=150?18:S<=200?15:S<=250?12:S<=300?9:S<=350?8:S<=400?7:S<=500?6:S<=600?5:S<=800?4:S<=1250?3:2}function D(S){return r.util.isNodejs&&typeof i[S]=="function"}function N(S){return typeof a.globalScope<"u"&&typeof a.globalScope.crypto=="object"&&typeof a.globalScope.crypto.subtle=="object"&&typeof a.globalScope.crypto.subtle[S]=="function"}function R(S){return typeof a.globalScope<"u"&&typeof a.globalScope.msCrypto=="object"&&typeof a.globalScope.msCrypto.subtle=="object"&&typeof a.globalScope.msCrypto.subtle[S]=="function"}function T(S){for(var O=r.util.hexToBytes(S.toString(16)),F=new Uint8Array(O.length),G=0;G<O.length;++G)F[G]=O.charCodeAt(G);return F}}),i6=A((e,t)=>{c();var r=st();jp(),Aa(),jw(),sl(),$p(),vx(),Zw(),nh(),MK(),sh(),gr(),typeof n>"u"&&(n=r.jsbn.BigInteger);var n,i=r.asn1,s=r.pki=r.pki||{};t.exports=s.pbe=r.pbe=r.pbe||{};var a=s.oids,o={name:"EncryptedPrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},l={name:"PBES2Algorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},u={name:"pkcs-12PbeParams",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"iterations"}]};s.encryptPrivateKeyInfo=function(v,d,g){g=g||{},g.saltSize=g.saltSize||8,g.count=g.count||2048,g.algorithm=g.algorithm||"aes128",g.prfAlgorithm=g.prfAlgorithm||"sha1";var b=r.random.getBytesSync(g.saltSize),_=g.count,m=i.integerToDer(_),E,D,N;if(g.algorithm.indexOf("aes")===0||g.algorithm==="des"){var R,T,S;switch(g.algorithm){case"aes128":E=16,R=16,T=a["aes128-CBC"],S=r.aes.createEncryptionCipher;break;case"aes192":E=24,R=16,T=a["aes192-CBC"],S=r.aes.createEncryptionCipher;break;case"aes256":E=32,R=16,T=a["aes256-CBC"],S=r.aes.createEncryptionCipher;break;case"des":E=8,R=8,T=a.desCBC,S=r.des.createEncryptionCipher;break;default:var O=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw O.algorithm=g.algorithm,O}var F="hmacWith"+g.prfAlgorithm.toUpperCase(),G=y(F),ne=r.pkcs5.pbkdf2(d,b,_,E,G),Y=r.random.getBytesSync(R),ce=S(ne);ce.start(Y),ce.update(i.toDer(v)),ce.finish(),N=ce.output.getBytes();var oe=p(b,m,E,F);D=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.pkcs5PBES2).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.pkcs5PBKDF2).getBytes()),oe]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(T).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,Y)])])])}else if(g.algorithm==="3des"){E=24;var H=new r.util.ByteBuffer(b),ne=s.pbe.generatePkcs12Key(d,H,1,_,E),Y=s.pbe.generatePkcs12Key(d,H,2,_,E),ce=r.des.createEncryptionCipher(ne);ce.start(Y),ce.update(i.toDer(v)),ce.finish(),N=ce.output.getBytes(),D=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,b),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,m.getBytes())])])}else{var O=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw O.algorithm=g.algorithm,O}var W=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[D,i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,N)]);return W},s.decryptPrivateKeyInfo=function(v,d){var g=null,b={},_=[];if(!i.validate(v,o,b,_)){var m=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw m.errors=_,m}var E=i.derToOid(b.encryptionOid),D=s.pbe.getCipher(E,b.encryptionParams,d),N=r.util.createBuffer(b.encryptedData);return D.update(N),D.finish()&&(g=i.fromDer(D.output)),g},s.encryptedPrivateKeyToPem=function(v,d){var g={type:"ENCRYPTED PRIVATE KEY",body:i.toDer(v).getBytes()};return r.pem.encode(g,{maxline:d})},s.encryptedPrivateKeyFromPem=function(v){var d=r.pem.decode(v)[0];if(d.type!=="ENCRYPTED PRIVATE KEY"){var g=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw g.headerType=d.type,g}if(d.procType&&d.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return i.fromDer(d.body)},s.encryptRsaPrivateKey=function(v,d,g){if(g=g||{},!g.legacy){var b=s.wrapRsaPrivateKey(s.privateKeyToAsn1(v));return b=s.encryptPrivateKeyInfo(b,d,g),s.encryptedPrivateKeyToPem(b)}var _,m,E,D;switch(g.algorithm){case"aes128":_="AES-128-CBC",E=16,m=r.random.getBytesSync(16),D=r.aes.createEncryptionCipher;break;case"aes192":_="AES-192-CBC",E=24,m=r.random.getBytesSync(16),D=r.aes.createEncryptionCipher;break;case"aes256":_="AES-256-CBC",E=32,m=r.random.getBytesSync(16),D=r.aes.createEncryptionCipher;break;case"3des":_="DES-EDE3-CBC",E=24,m=r.random.getBytesSync(8),D=r.des.createEncryptionCipher;break;case"des":_="DES-CBC",E=8,m=r.random.getBytesSync(8),D=r.des.createEncryptionCipher;break;default:var N=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+g.algorithm+'".');throw N.algorithm=g.algorithm,N}var R=r.pbe.opensslDeriveBytes(d,m.substr(0,8),E),T=D(R);T.start(m),T.update(i.toDer(s.privateKeyToAsn1(v))),T.finish();var S={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:_,parameters:r.util.bytesToHex(m).toUpperCase()},body:T.output.getBytes()};return r.pem.encode(S)},s.decryptRsaPrivateKey=function(v,d){var g=null,b=r.pem.decode(v)[0];if(b.type!=="ENCRYPTED PRIVATE KEY"&&b.type!=="PRIVATE KEY"&&b.type!=="RSA PRIVATE KEY"){var _=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw _.headerType=_,_}if(b.procType&&b.procType.type==="ENCRYPTED"){var m,E;switch(b.dekInfo.algorithm){case"DES-CBC":m=8,E=r.des.createDecryptionCipher;break;case"DES-EDE3-CBC":m=24,E=r.des.createDecryptionCipher;break;case"AES-128-CBC":m=16,E=r.aes.createDecryptionCipher;break;case"AES-192-CBC":m=24,E=r.aes.createDecryptionCipher;break;case"AES-256-CBC":m=32,E=r.aes.createDecryptionCipher;break;case"RC2-40-CBC":m=5,E=function(S){return r.rc2.createDecryptionCipher(S,40)};break;case"RC2-64-CBC":m=8,E=function(S){return r.rc2.createDecryptionCipher(S,64)};break;case"RC2-128-CBC":m=16,E=function(S){return r.rc2.createDecryptionCipher(S,128)};break;default:var _=new Error('Could not decrypt private key; unsupported encryption algorithm "'+b.dekInfo.algorithm+'".');throw _.algorithm=b.dekInfo.algorithm,_}var D=r.util.hexToBytes(b.dekInfo.parameters),N=r.pbe.opensslDeriveBytes(d,D.substr(0,8),m),R=E(N);if(R.start(D),R.update(r.util.createBuffer(b.body)),R.finish())g=R.output.getBytes();else return g}else g=b.body;return b.type==="ENCRYPTED PRIVATE KEY"?g=s.decryptPrivateKeyInfo(i.fromDer(g),d):g=i.fromDer(g),g!==null&&(g=s.privateKeyFromAsn1(g)),g},s.pbe.generatePkcs12Key=function(v,d,g,b,_,m){var E,D;if(typeof m>"u"||m===null){if(!("sha1"in r.md))throw new Error('"sha1" hash algorithm unavailable.');m=r.md.sha1.create()}var N=m.digestLength,R=m.blockLength,T=new r.util.ByteBuffer,S=new r.util.ByteBuffer;if(v!=null){for(D=0;D<v.length;D++)S.putInt16(v.charCodeAt(D));S.putInt16(0)}var O=S.length(),F=d.length(),G=new r.util.ByteBuffer;G.fillWithByte(g,R);var ne=R*Math.ceil(F/R),Y=new r.util.ByteBuffer;for(D=0;D<ne;D++)Y.putByte(d.at(D%F));var ce=R*Math.ceil(O/R),oe=new r.util.ByteBuffer;for(D=0;D<ce;D++)oe.putByte(S.at(D%O));var H=Y;H.putBuffer(oe);for(var W=Math.ceil(_/N),de=1;de<=W;de++){var De=new r.util.ByteBuffer;De.putBytes(G.bytes()),De.putBytes(H.bytes());for(var Pe=0;Pe<b;Pe++)m.start(),m.update(De.getBytes()),De=m.digest();var $e=new r.util.ByteBuffer;for(D=0;D<R;D++)$e.putByte(De.at(D%N));var Be=Math.ceil(F/R)+Math.ceil(O/R),nt=new r.util.ByteBuffer;for(E=0;E<Be;E++){var Ve=new r.util.ByteBuffer(H.getBytes(R)),et=511;for(D=$e.length()-1;D>=0;D--)et=et>>8,et+=$e.at(D)+Ve.at(D),Ve.setAt(D,et&255);nt.putBuffer(Ve)}H=nt,T.putBuffer(De)}return T.truncate(T.length()-_),T},s.pbe.getCipher=function(v,d,g){switch(v){case s.oids.pkcs5PBES2:return s.pbe.getCipherForPBES2(v,d,g);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(v,d,g);default:var b=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw b.oid=v,b.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],b}},s.pbe.getCipherForPBES2=function(v,d,g){var b={},_=[];if(!i.validate(d,l,b,_)){var m=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw m.errors=_,m}if(v=i.derToOid(b.kdfOid),v!==s.oids.pkcs5PBKDF2){var m=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw m.oid=v,m.supportedOids=["pkcs5PBKDF2"],m}if(v=i.derToOid(b.encOid),v!==s.oids["aes128-CBC"]&&v!==s.oids["aes192-CBC"]&&v!==s.oids["aes256-CBC"]&&v!==s.oids["des-EDE3-CBC"]&&v!==s.oids.desCBC){var m=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw m.oid=v,m.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],m}var E=b.kdfSalt,D=r.util.createBuffer(b.kdfIterationCount);D=D.getInt(D.length()<<3);var N,R;switch(s.oids[v]){case"aes128-CBC":N=16,R=r.aes.createDecryptionCipher;break;case"aes192-CBC":N=24,R=r.aes.createDecryptionCipher;break;case"aes256-CBC":N=32,R=r.aes.createDecryptionCipher;break;case"des-EDE3-CBC":N=24,R=r.des.createDecryptionCipher;break;case"desCBC":N=8,R=r.des.createDecryptionCipher;break}var T=f(b.prfOid),S=r.pkcs5.pbkdf2(g,E,D,N,T),O=b.encIv,F=R(S);return F.start(O),F},s.pbe.getCipherForPKCS12PBE=function(v,d,g){var b={},_=[];if(!i.validate(d,u,b,_)){var m=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw m.errors=_,m}var E=r.util.createBuffer(b.salt),D=r.util.createBuffer(b.iterations);D=D.getInt(D.length()<<3);var N,R,T;switch(v){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:N=24,R=8,T=r.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:N=5,R=8,T=function(ne,Y){var ce=r.rc2.createDecryptionCipher(ne,40);return ce.start(Y,null),ce};break;default:var m=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw m.oid=v,m}var S=f(b.prfOid),O=s.pbe.generatePkcs12Key(g,E,1,D,N,S);S.start();var F=s.pbe.generatePkcs12Key(g,E,2,D,R,S);return T(O,F)},s.pbe.opensslDeriveBytes=function(v,d,g,b){if(typeof b>"u"||b===null){if(!("md5"in r.md))throw new Error('"md5" hash algorithm unavailable.');b=r.md.md5.create()}d===null&&(d="");for(var _=[h(b,v+d)],m=16,E=1;m<g;++E,m+=16)_.push(h(b,_[E-1]+v+d));return _.join("").substr(0,g)};function h(v,d){return v.start().update(d).digest().getBytes()}function f(v){var d;if(!v)d="hmacWithSHA1";else if(d=s.oids[i.derToOid(v)],!d){var g=new Error("Unsupported PRF OID.");throw g.oid=v,g.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],g}return y(d)}function y(v){var d=r.md;switch(v){case"hmacWithSHA224":d=r.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":v=v.substr(8).toLowerCase();break;default:var g=new Error("Unsupported PRF algorithm.");throw g.algorithm=v,g.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],g}if(!d||!(v in d))throw new Error("Unknown hash algorithm: "+v);return d[v].create()}function p(v,d,g,b){var _=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,v),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,d.getBytes())]);return b!=="hmacWithSHA1"&&_.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,r.util.hexToBytes(g.toString(16))),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids[b]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])),_}}),Bx=A((e,t)=>{c();var r=st();sl(),gr();var n=t.exports=r.sha512=r.sha512||{};r.md.sha512=r.md.algorithms.sha512=n;var i=r.sha384=r.sha512.sha384=r.sha512.sha384||{};i.create=function(){return n.create("SHA-384")},r.md.sha384=r.md.algorithms.sha384=i,r.sha512.sha256=r.sha512.sha256||{create:function(){return n.create("SHA-512/256")}},r.md["sha512/256"]=r.md.algorithms["sha512/256"]=r.sha512.sha256,r.sha512.sha224=r.sha512.sha224||{create:function(){return n.create("SHA-512/224")}},r.md["sha512/224"]=r.md.algorithms["sha512/224"]=r.sha512.sha224,n.create=function(f){if(a||u(),typeof f>"u"&&(f="SHA-512"),!(f in l))throw new Error("Invalid SHA-512 algorithm: "+f);for(var y=l[f],p=null,v=r.util.createBuffer(),d=new Array(80),g=0;g<80;++g)d[g]=new Array(2);var b=64;switch(f){case"SHA-384":b=48;break;case"SHA-512/256":b=32;break;case"SHA-512/224":b=28;break}var _={algorithm:f.replace("-","").toLowerCase(),blockLength:128,digestLength:b,messageLength:0,fullMessageLength:null,messageLengthSize:16};return _.start=function(){_.messageLength=0,_.fullMessageLength=_.messageLength128=[];for(var m=_.messageLengthSize/4,E=0;E<m;++E)_.fullMessageLength.push(0);v=r.util.createBuffer(),p=new Array(y.length);for(var E=0;E<y.length;++E)p[E]=y[E].slice(0);return _},_.start(),_.update=function(m,E){E==="utf8"&&(m=r.util.encodeUtf8(m));var D=m.length;_.messageLength+=D,D=[D/4294967296>>>0,D>>>0];for(var N=_.fullMessageLength.length-1;N>=0;--N)_.fullMessageLength[N]+=D[1],D[1]=D[0]+(_.fullMessageLength[N]/4294967296>>>0),_.fullMessageLength[N]=_.fullMessageLength[N]>>>0,D[0]=D[1]/4294967296>>>0;return v.putBytes(m),h(p,d,v),(v.read>2048||v.length()===0)&&v.compact(),_},_.digest=function(){var m=r.util.createBuffer();m.putBytes(v.bytes());var E=_.fullMessageLength[_.fullMessageLength.length-1]+_.messageLengthSize,D=E&_.blockLength-1;m.putBytes(s.substr(0,_.blockLength-D));for(var N,R,T=_.fullMessageLength[0]*8,S=0;S<_.fullMessageLength.length-1;++S)N=_.fullMessageLength[S+1]*8,R=N/4294967296>>>0,T+=R,m.putInt32(T>>>0),T=N>>>0;m.putInt32(T);for(var O=new Array(p.length),S=0;S<p.length;++S)O[S]=p[S].slice(0);h(O,d,m);var F=r.util.createBuffer(),G;f==="SHA-512"?G=O.length:f==="SHA-384"?G=O.length-2:G=O.length-4;for(var S=0;S<G;++S)F.putInt32(O[S][0]),(S!==G-1||f!=="SHA-512/224")&&F.putInt32(O[S][1]);return F},_};var s=null,a=!1,o=null,l=null;function u(){s=String.fromCharCode(128),s+=r.util.fillString(String.fromCharCode(0),128),o=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],l={},l["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],l["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],l["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],l["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],a=!0}function h(f,y,p){for(var v,d,g,b,_,m,E,D,N,R,T,S,O,F,G,ne,Y,ce,oe,H,W,de,De,Pe,$e,Be,nt,Ve,et,ht,Z,le,ke,Ge,ft,yt=p.length();yt>=128;){for(et=0;et<16;++et)y[et][0]=p.getInt32()>>>0,y[et][1]=p.getInt32()>>>0;for(;et<80;++et)le=y[et-2],ht=le[0],Z=le[1],v=((ht>>>19|Z<<13)^(Z>>>29|ht<<3)^ht>>>6)>>>0,d=((ht<<13|Z>>>19)^(Z<<3|ht>>>29)^(ht<<26|Z>>>6))>>>0,Ge=y[et-15],ht=Ge[0],Z=Ge[1],g=((ht>>>1|Z<<31)^(ht>>>8|Z<<24)^ht>>>7)>>>0,b=((ht<<31|Z>>>1)^(ht<<24|Z>>>8)^(ht<<25|Z>>>7))>>>0,ke=y[et-7],ft=y[et-16],Z=d+ke[1]+b+ft[1],y[et][0]=v+ke[0]+g+ft[0]+(Z/4294967296>>>0)>>>0,y[et][1]=Z>>>0;for(O=f[0][0],F=f[0][1],G=f[1][0],ne=f[1][1],Y=f[2][0],ce=f[2][1],oe=f[3][0],H=f[3][1],W=f[4][0],de=f[4][1],De=f[5][0],Pe=f[5][1],$e=f[6][0],Be=f[6][1],nt=f[7][0],Ve=f[7][1],et=0;et<80;++et)E=((W>>>14|de<<18)^(W>>>18|de<<14)^(de>>>9|W<<23))>>>0,D=((W<<18|de>>>14)^(W<<14|de>>>18)^(de<<23|W>>>9))>>>0,N=($e^W&(De^$e))>>>0,R=(Be^de&(Pe^Be))>>>0,_=((O>>>28|F<<4)^(F>>>2|O<<30)^(F>>>7|O<<25))>>>0,m=((O<<4|F>>>28)^(F<<30|O>>>2)^(F<<25|O>>>7))>>>0,T=(O&G|Y&(O^G))>>>0,S=(F&ne|ce&(F^ne))>>>0,Z=Ve+D+R+o[et][1]+y[et][1],v=nt+E+N+o[et][0]+y[et][0]+(Z/4294967296>>>0)>>>0,d=Z>>>0,Z=m+S,g=_+T+(Z/4294967296>>>0)>>>0,b=Z>>>0,nt=$e,Ve=Be,$e=De,Be=Pe,De=W,Pe=de,Z=H+d,W=oe+v+(Z/4294967296>>>0)>>>0,de=Z>>>0,oe=Y,H=ce,Y=G,ce=ne,G=O,ne=F,Z=d+b,O=v+g+(Z/4294967296>>>0)>>>0,F=Z>>>0;Z=f[0][1]+F,f[0][0]=f[0][0]+O+(Z/4294967296>>>0)>>>0,f[0][1]=Z>>>0,Z=f[1][1]+ne,f[1][0]=f[1][0]+G+(Z/4294967296>>>0)>>>0,f[1][1]=Z>>>0,Z=f[2][1]+ce,f[2][0]=f[2][0]+Y+(Z/4294967296>>>0)>>>0,f[2][1]=Z>>>0,Z=f[3][1]+H,f[3][0]=f[3][0]+oe+(Z/4294967296>>>0)>>>0,f[3][1]=Z>>>0,Z=f[4][1]+de,f[4][0]=f[4][0]+W+(Z/4294967296>>>0)>>>0,f[4][1]=Z>>>0,Z=f[5][1]+Pe,f[5][0]=f[5][0]+De+(Z/4294967296>>>0)>>>0,f[5][1]=Z>>>0,Z=f[6][1]+Be,f[6][0]=f[6][0]+$e+(Z/4294967296>>>0)>>>0,f[6][1]=Z>>>0,Z=f[7][1]+Ve,f[7][0]=f[7][0]+nt+(Z/4294967296>>>0)>>>0,f[7][1]=Z>>>0,yt-=128}}}),uh=A((e,t)=>{"use strict";c();function r(n){let i=new Uint8Array(n),s=0;if(n>0)if(n>65536)for(;s<n;)s+65536>n?(crypto.getRandomValues(i.subarray(s,s+(n-s))),s+=n-s):(crypto.getRandomValues(i.subarray(s,s+65536)),s+=65536);else crypto.getRandomValues(i);return i}t.exports=r}),Vs=A((e,t)=>{"use strict";c();var r=async n=>{let i=[];for await(let s of n)i.push(s);return i};t.exports=r}),Ci=A((e,t)=>{"use strict";c();var r=async n=>{for await(let i of n);};t.exports=r}),Gi=A((e,t)=>{"use strict";c();var r=async function*(n,i){for await(let s of n)await i(s)&&(yield s)};t.exports=r}),h0=A((e,t)=>{"use strict";c();var r=async function*(n,i){let s=0;if(!(i<1)){for await(let a of n)if(yield a,s++,s===i)return}};t.exports=r}),Qq=A((e,t)=>{c(),t.exports=class{constructor(r){if(!(r>0)||(r-1&r)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(r),this.mask=r-1,this.top=0,this.btm=0,this.next=null}push(r){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=r,this.top=this.top+1&this.mask,!0)}shift(){let r=this.buffer[this.btm];if(r!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,r}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}}),d0=A((e,t)=>{c();var r=Qq();t.exports=class{constructor(n){this.hwm=n||16,this.head=new r(this.hwm),this.tail=this.head}push(n){if(!this.head.push(n)){let i=this.head;this.head=i.next=new r(2*this.head.buffer.length),this.head.push(n)}}shift(){let n=this.tail.shift();if(n===void 0&&this.tail.next){let i=this.tail.next;return this.tail.next=null,this.tail=i,this.tail.shift()}return n}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}}),ez=A((e,t)=>{c();var r=d0();t.exports=n=>{n=n||{};let i;typeof n=="function"?(i=n,n={}):i=n.onEnd;let s=new r,a,o,l,u=()=>{if(!s.isEmpty()){if(n.writev){let _,m=[];for(;!s.isEmpty();){if(_=s.shift(),_.error)throw _.error;m.push(_.value)}return{done:_.done,value:m}}let b=s.shift();if(b.error)throw b.error;return b}return l?{done:!0}:new Promise((b,_)=>{o=m=>(o=null,m.error?_(m.error):n.writev&&!m.done?b({done:m.done,value:[m.value]}):b(m),a)})},h=b=>o?o(b):(s.push(b),a),f=b=>(s=new r,o?o({error:b}):(s.push({error:b}),a)),y=b=>l?a:h({done:!1,value:b}),p=b=>l?a:(l=!0,b?f(b):h({done:!0})),v=()=>(s=new r,p(),{done:!0}),d=b=>(p(b),{done:!0});if(a={[Symbol.asyncIterator](){return this},next:u,return:v,throw:d,push:y,end:p},!i)return a;let g=a;return a={[Symbol.asyncIterator](){return this},next(){return g.next()},throw(b){return g.throw(b),i&&(i(b),i=null),{done:!0}},return(){return g.return(),i&&(i(),i=null),{done:!0}},push:y,end(b){return g.end(b),i&&(i(b),i=null),a}},a}}),D6=A((e,t)=>{c(),function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=function(i,s,a,o,l){for(s=s.split?s.split("."):s,o=0;o<s.length;o++)i=i?i[s[o]]:l;return i===l?a:i}:typeof define=="function"&&define.amd?define(function(){return function(i,s,a,o,l){for(s=s.split?s.split("."):s,o=0;o<s.length;o++)i=i?i[s[o]]:l;return i===l?a:i}}):r.dlv=function(i,s,a,o,l){for(s=s.split?s.split("."):s,o=0;o<s.length;o++)i=i?i[s[o]]:l;return i===l?a:i}}(e)}),ei=A((e,t)=>{"use strict";c();var r=async function*(n,i){for await(let s of n)yield i(s)};t.exports=r}),az=A((e,t)=>{c();var r=(...o)=>{let l;for(;o.length;)l=o.shift()(l);return l},n=o=>o&&(typeof o[Symbol.asyncIterator]=="function"||typeof o[Symbol.iterator]=="function"||typeof o.next=="function"),i=o=>o&&typeof o.sink=="function"&&n(o.source),s=o=>l=>(o.sink(l),o.source),a=(...o)=>{if(i(o[0])){let l=o[0];o[0]=()=>l.source}else if(n(o[0])){let l=o[0];o[0]=()=>l}if(o.length>1&&i(o[o.length-1])&&(o[o.length-1]=o[o.length-1].sink),o.length>2)for(let l=1;l<o.length-1;l++)i(o[l])&&(o[l]=s(o[l]));return r(...o)};t.exports=a,t.exports.pipe=a,t.exports.rawPipe=r,t.exports.isIterable=n,t.exports.isDuplex=i}),lz=A((e,t)=>{c();var r=d0();t.exports=n=>{n=n||{};let i;typeof n=="function"?(i=n,n={}):i=n.onEnd;let s=new r,a,o,l,u=()=>{if(!s.isEmpty()){if(n.writev){let _,m=[];for(;!s.isEmpty();){if(_=s.shift(),_.error)throw _.error;m.push(_.value)}return{done:_.done,value:m}}let b=s.shift();if(b.error)throw b.error;return b}return l?{done:!0}:new Promise((b,_)=>{o=m=>(o=null,m.error?_(m.error):n.writev&&!m.done?b({done:m.done,value:[m.value]}):b(m),a)})},h=b=>o?o(b):(s.push(b),a),f=b=>(s=new r,o?o({error:b}):(s.push({error:b}),a)),y=b=>l?a:h({done:!1,value:b}),p=b=>l?a:(l=!0,b?f(b):h({done:!0})),v=()=>(s=new r,p(),{done:!0}),d=b=>(p(b),{done:!0});if(a={[Symbol.asyncIterator](){return this},next:u,return:v,throw:d,push:y,end:p},!i)return a;let g=a;return a={[Symbol.asyncIterator](){return this},next(){return g.next()},throw(b){return g.throw(b),i&&(i(b),i=null),{done:!0}},return(){return g.return(),i&&(i(),i=null),{done:!0}},push:y,end(b){return g.end(b),i&&(i(b),i=null),a}},a}}),Fc=A((e,t)=>{"use strict";c();var r=lz(),n=async function*(...i){let s=r();setTimeout(async()=>{try{await Promise.all(i.map(async a=>{for await(let o of a)s.push(o)})),s.end()}catch(a){s.end(a)}},0),yield*s};t.exports=n}),Sz=A((e,t)=>{"use strict";c();var r=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;t.exports=function(n,i){if(i==null&&(i=!1),n.length<2||n.length>255)return!1;var s=n[n.length-1];if(i){if(s!==".")return!1}else if(s===".")return!1;return r.test(n)}}),hH=A((e,t)=>{"use strict";c();var r=()=>{let n={};return n.promise=new Promise((i,s)=>{n.resolve=i,n.reject=s}),n};t.exports=r}),In=A((e,t)=>{"use strict";c();var r=typeof Reflect=="object"?Reflect:null,n=r&&typeof r.apply=="function"?r.apply:function(N,R,T){return Function.prototype.apply.call(N,R,T)},i;r&&typeof r.ownKeys=="function"?i=r.ownKeys:Object.getOwnPropertySymbols?i=function(N){return Object.getOwnPropertyNames(N).concat(Object.getOwnPropertySymbols(N))}:i=function(N){return Object.getOwnPropertyNames(N)};function s(N){console&&console.warn&&console.warn(N)}var a=Number.isNaN||function(N){return N!==N};function o(){o.init.call(this)}t.exports=o,t.exports.once=m,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var l=10;function u(N){if(typeof N!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof N)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(N){if(typeof N!="number"||N<0||a(N))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+N+".");l=N}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(N){if(typeof N!="number"||N<0||a(N))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+N+".");return this._maxListeners=N,this};function h(N){return N._maxListeners===void 0?o.defaultMaxListeners:N._maxListeners}o.prototype.getMaxListeners=function(){return h(this)},o.prototype.emit=function(N){for(var R=[],T=1;T<arguments.length;T++)R.push(arguments[T]);var S=N==="error",O=this._events;if(O!==void 0)S=S&&O.error===void 0;else if(!S)return!1;if(S){var F;if(R.length>0&&(F=R[0]),F instanceof Error)throw F;var G=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw G.context=F,G}var ne=O[N];if(ne===void 0)return!1;if(typeof ne=="function")n(ne,this,R);else for(var Y=ne.length,ce=g(ne,Y),T=0;T<Y;++T)n(ce[T],this,R);return!0};function f(N,R,T,S){var O,F,G;if(u(T),F=N._events,F===void 0?(F=N._events=Object.create(null),N._eventsCount=0):(F.newListener!==void 0&&(N.emit("newListener",R,T.listener?T.listener:T),F=N._events),G=F[R]),G===void 0)G=F[R]=T,++N._eventsCount;else if(typeof G=="function"?G=F[R]=S?[T,G]:[G,T]:S?G.unshift(T):G.push(T),O=h(N),O>0&&G.length>O&&!G.warned){G.warned=!0;var ne=new Error("Possible EventEmitter memory leak detected. "+G.length+" "+String(R)+" listeners added. Use emitter.setMaxListeners() to increase limit");ne.name="MaxListenersExceededWarning",ne.emitter=N,ne.type=R,ne.count=G.length,s(ne)}return N}o.prototype.addListener=function(N,R){return f(this,N,R,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(N,R){return f(this,N,R,!0)};function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(N,R,T){var S={fired:!1,wrapFn:void 0,target:N,type:R,listener:T},O=y.bind(S);return O.listener=T,S.wrapFn=O,O}o.prototype.once=function(N,R){return u(R),this.on(N,p(this,N,R)),this},o.prototype.prependOnceListener=function(N,R){return u(R),this.prependListener(N,p(this,N,R)),this},o.prototype.removeListener=function(N,R){var T,S,O,F,G;if(u(R),S=this._events,S===void 0)return this;if(T=S[N],T===void 0)return this;if(T===R||T.listener===R)--this._eventsCount===0?this._events=Object.create(null):(delete S[N],S.removeListener&&this.emit("removeListener",N,T.listener||R));else if(typeof T!="function"){for(O=-1,F=T.length-1;F>=0;F--)if(T[F]===R||T[F].listener===R){G=T[F].listener,O=F;break}if(O<0)return this;O===0?T.shift():b(T,O),T.length===1&&(S[N]=T[0]),S.removeListener!==void 0&&this.emit("removeListener",N,G||R)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(N){var R,T,S;if(T=this._events,T===void 0)return this;if(T.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):T[N]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete T[N]),this;if(arguments.length===0){var O=Object.keys(T),F;for(S=0;S<O.length;++S)F=O[S],F!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=T[N],typeof R=="function")this.removeListener(N,R);else if(R!==void 0)for(S=R.length-1;S>=0;S--)this.removeListener(N,R[S]);return this};function v(N,R,T){var S=N._events;if(S===void 0)return[];var O=S[R];return O===void 0?[]:typeof O=="function"?T?[O.listener||O]:[O]:T?_(O):g(O,O.length)}o.prototype.listeners=function(N){return v(this,N,!0)},o.prototype.rawListeners=function(N){return v(this,N,!1)},o.listenerCount=function(N,R){return typeof N.listenerCount=="function"?N.listenerCount(R):d.call(N,R)},o.prototype.listenerCount=d;function d(N){var R=this._events;if(R!==void 0){var T=R[N];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function g(N,R){for(var T=new Array(R),S=0;S<R;++S)T[S]=N[S];return T}function b(N,R){for(;R+1<N.length;R++)N[R]=N[R+1];N.pop()}function _(N){for(var R=new Array(N.length),T=0;T<R.length;++T)R[T]=N[T].listener||N[T];return R}function m(N,R){return new Promise(function(T,S){function O(G){N.removeListener(R,F),S(G)}function F(){typeof N.removeListener=="function"&&N.removeListener("error",O),T([].slice.call(arguments))}D(N,R,F,{once:!0}),R!=="error"&&E(N,O,{once:!0})})}function E(N,R,T){typeof N.on=="function"&&D(N,"error",R,T)}function D(N,R,T,S){if(typeof N.on=="function")S.once?N.once(R,T):N.on(R,T);else if(typeof N.addEventListener=="function")N.addEventListener(R,function O(F){S.once&&N.removeEventListener(R,O),T(F)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof N)}}),n5=A((e,t)=>{"use strict";c();var r=hH(),n=In().EventEmitter;async function*i(s,a={}){let o=a.concurrency||1/0;o<1&&(o=1/0);let l=a.ordered==null?!1:a.ordered,u=new n,h=[],f=r(),y=r(),p=!1,v,d=!1;u.on("task-complete",()=>{y.resolve()}),Promise.resolve().then(async()=>{try{for await(let m of s){if(h.length===o&&(f=r(),await f.promise),d)break;let E={done:!1};h.push(E),m().then(D=>{E.done=!0,E.ok=!0,E.value=D,u.emit("task-complete")},D=>{E.done=!0,E.err=D,u.emit("task-complete")})}p=!0,u.emit("task-complete")}catch(m){v=m,u.emit("task-complete")}});function g(){return Boolean(l?h[0]&&h[0].done:h.find(m=>m.done))}function*b(){for(;h.length&&h[0].done;){let m=h[0];if(h.shift(),m.ok)yield m.value;else throw d=!0,f.resolve(),m.err;f.resolve()}}function*_(){for(;g();)for(let m=0;m<h.length;m++)if(h[m].done){let E=h[m];if(h.splice(m,1),m--,E.ok)yield E.value;else throw d=!0,f.resolve(),E.err;f.resolve()}}for(;;){if(g()||(y=r(),await y.promise),v)throw v;if(l?yield*b():yield*_(),p&&h.length===0)break}}t.exports=i}),v0=A((e,t)=>{"use strict";c();async function*r(n,i={}){let s=n.getReader();try{for(;;){let a=await s.read();if(a.done)return;yield a.value}}finally{i.preventCancel!==!0&&s.cancel(),s.releaseLock()}}t.exports=r}),LH=A((e,t)=>{"use strict";c();var r=v0();function n(i){return typeof i.stream=="function"?r(i.stream()):r(new Response(i).body)}t.exports=n}),S0=A((e,t)=>{"use strict";c();function r(n){let[i,s]=n[Symbol.asyncIterator]?[n[Symbol.asyncIterator](),Symbol.asyncIterator]:[n[Symbol.iterator](),Symbol.iterator],a=[];return{peek:()=>i.next(),push:o=>{a.push(o)},next:()=>a.length?{done:!1,value:a.shift()}:i.next(),[s](){return this}}}t.exports=r}),h5=A((e,t)=>{"use strict";c();async function*r(n,i=1){let s=[];i<1&&(i=1);for await(let a of n)for(s.push(a);s.length>=i;)yield s.slice(0,i),s=s.slice(i);for(;s.length;)yield s.slice(0,i),s=s.slice(i)}t.exports=r}),d5=A((e,t)=>{"use strict";c();var r=h5();async function*n(i,s=1){for await(let a of r(i,s)){let o=a.map(l=>l().then(u=>({ok:!0,value:u}),u=>({ok:!1,err:u})));for(let l=0;l<o.length;l++){let u=await o[l];if(u.ok)yield u.value;else throw u.err}}}t.exports=n}),QH=A((e,t)=>{c(),function(r,n){"use strict";var i={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function s(d){if(!Array.isArray(d)&&!ArrayBuffer.isView(d))return!1;for(var g=0;g<d.length;g++)if(!Number.isInteger(d[g])||d[g]<0||d[g]>255)return!1;return!0}function a(d,g){return(d&65535)*g+(((d>>>16)*g&65535)<<16)}function o(d,g){return d<<g|d>>>32-g}function l(d){return d^=d>>>16,d=a(d,2246822507),d^=d>>>13,d=a(d,3266489909),d^=d>>>16,d}function u(d,g){d=[d[0]>>>16,d[0]&65535,d[1]>>>16,d[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var b=[0,0,0,0];return b[3]+=d[3]+g[3],b[2]+=b[3]>>>16,b[3]&=65535,b[2]+=d[2]+g[2],b[1]+=b[2]>>>16,b[2]&=65535,b[1]+=d[1]+g[1],b[0]+=b[1]>>>16,b[1]&=65535,b[0]+=d[0]+g[0],b[0]&=65535,[b[0]<<16|b[1],b[2]<<16|b[3]]}function h(d,g){d=[d[0]>>>16,d[0]&65535,d[1]>>>16,d[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var b=[0,0,0,0];return b[3]+=d[3]*g[3],b[2]+=b[3]>>>16,b[3]&=65535,b[2]+=d[2]*g[3],b[1]+=b[2]>>>16,b[2]&=65535,b[2]+=d[3]*g[2],b[1]+=b[2]>>>16,b[2]&=65535,b[1]+=d[1]*g[3],b[0]+=b[1]>>>16,b[1]&=65535,b[1]+=d[2]*g[2],b[0]+=b[1]>>>16,b[1]&=65535,b[1]+=d[3]*g[1],b[0]+=b[1]>>>16,b[1]&=65535,b[0]+=d[0]*g[3]+d[1]*g[2]+d[2]*g[1]+d[3]*g[0],b[0]&=65535,[b[0]<<16|b[1],b[2]<<16|b[3]]}function f(d,g){return g%=64,g===32?[d[1],d[0]]:g<32?[d[0]<<g|d[1]>>>32-g,d[1]<<g|d[0]>>>32-g]:(g-=32,[d[1]<<g|d[0]>>>32-g,d[0]<<g|d[1]>>>32-g])}function y(d,g){return g%=64,g===0?d:g<32?[d[0]<<g|d[1]>>>32-g,d[1]<<g]:[d[1]<<g-32,0]}function p(d,g){return[d[0]^g[0],d[1]^g[1]]}function v(d){return d=p(d,[0,d[0]>>>1]),d=h(d,[4283543511,3981806797]),d=p(d,[0,d[0]>>>1]),d=h(d,[3301882366,444984403]),d=p(d,[0,d[0]>>>1]),d}i.x86.hash32=function(d,g){if(i.inputValidation&&!s(d))return n;g=g||0;for(var b=d.length%4,_=d.length-b,m=g,E=0,D=3432918353,N=461845907,R=0;R<_;R=R+4)E=d[R]|d[R+1]<<8|d[R+2]<<16|d[R+3]<<24,E=a(E,D),E=o(E,15),E=a(E,N),m^=E,m=o(m,13),m=a(m,5)+3864292196;switch(E=0,b){case 3:E^=d[R+2]<<16;case 2:E^=d[R+1]<<8;case 1:E^=d[R],E=a(E,D),E=o(E,15),E=a(E,N),m^=E}return m^=d.length,m=l(m),m>>>0},i.x86.hash128=function(d,g){if(i.inputValidation&&!s(d))return n;g=g||0;for(var b=d.length%16,_=d.length-b,m=g,E=g,D=g,N=g,R=0,T=0,S=0,O=0,F=597399067,G=2869860233,ne=951274213,Y=2716044179,ce=0;ce<_;ce=ce+16)R=d[ce]|d[ce+1]<<8|d[ce+2]<<16|d[ce+3]<<24,T=d[ce+4]|d[ce+5]<<8|d[ce+6]<<16|d[ce+7]<<24,S=d[ce+8]|d[ce+9]<<8|d[ce+10]<<16|d[ce+11]<<24,O=d[ce+12]|d[ce+13]<<8|d[ce+14]<<16|d[ce+15]<<24,R=a(R,F),R=o(R,15),R=a(R,G),m^=R,m=o(m,19),m+=E,m=a(m,5)+1444728091,T=a(T,G),T=o(T,16),T=a(T,ne),E^=T,E=o(E,17),E+=D,E=a(E,5)+197830471,S=a(S,ne),S=o(S,17),S=a(S,Y),D^=S,D=o(D,15),D+=N,D=a(D,5)+2530024501,O=a(O,Y),O=o(O,18),O=a(O,F),N^=O,N=o(N,13),N+=m,N=a(N,5)+850148119;switch(R=0,T=0,S=0,O=0,b){case 15:O^=d[ce+14]<<16;case 14:O^=d[ce+13]<<8;case 13:O^=d[ce+12],O=a(O,Y),O=o(O,18),O=a(O,F),N^=O;case 12:S^=d[ce+11]<<24;case 11:S^=d[ce+10]<<16;case 10:S^=d[ce+9]<<8;case 9:S^=d[ce+8],S=a(S,ne),S=o(S,17),S=a(S,Y),D^=S;case 8:T^=d[ce+7]<<24;case 7:T^=d[ce+6]<<16;case 6:T^=d[ce+5]<<8;case 5:T^=d[ce+4],T=a(T,G),T=o(T,16),T=a(T,ne),E^=T;case 4:R^=d[ce+3]<<24;case 3:R^=d[ce+2]<<16;case 2:R^=d[ce+1]<<8;case 1:R^=d[ce],R=a(R,F),R=o(R,15),R=a(R,G),m^=R}return m^=d.length,E^=d.length,D^=d.length,N^=d.length,m+=E,m+=D,m+=N,E+=m,D+=m,N+=m,m=l(m),E=l(E),D=l(D),N=l(N),m+=E,m+=D,m+=N,E+=m,D+=m,N+=m,("00000000"+(m>>>0).toString(16)).slice(-8)+("00000000"+(E>>>0).toString(16)).slice(-8)+("00000000"+(D>>>0).toString(16)).slice(-8)+("00000000"+(N>>>0).toString(16)).slice(-8)},i.x64.hash128=function(d,g){if(i.inputValidation&&!s(d))return n;g=g||0;for(var b=d.length%16,_=d.length-b,m=[0,g],E=[0,g],D=[0,0],N=[0,0],R=[2277735313,289559509],T=[1291169091,658871167],S=0;S<_;S=S+16)D=[d[S+4]|d[S+5]<<8|d[S+6]<<16|d[S+7]<<24,d[S]|d[S+1]<<8|d[S+2]<<16|d[S+3]<<24],N=[d[S+12]|d[S+13]<<8|d[S+14]<<16|d[S+15]<<24,d[S+8]|d[S+9]<<8|d[S+10]<<16|d[S+11]<<24],D=h(D,R),D=f(D,31),D=h(D,T),m=p(m,D),m=f(m,27),m=u(m,E),m=u(h(m,[0,5]),[0,1390208809]),N=h(N,T),N=f(N,33),N=h(N,R),E=p(E,N),E=f(E,31),E=u(E,m),E=u(h(E,[0,5]),[0,944331445]);switch(D=[0,0],N=[0,0],b){case 15:N=p(N,y([0,d[S+14]],48));case 14:N=p(N,y([0,d[S+13]],40));case 13:N=p(N,y([0,d[S+12]],32));case 12:N=p(N,y([0,d[S+11]],24));case 11:N=p(N,y([0,d[S+10]],16));case 10:N=p(N,y([0,d[S+9]],8));case 9:N=p(N,[0,d[S+8]]),N=h(N,T),N=f(N,33),N=h(N,R),E=p(E,N);case 8:D=p(D,y([0,d[S+7]],56));case 7:D=p(D,y([0,d[S+6]],48));case 6:D=p(D,y([0,d[S+5]],40));case 5:D=p(D,y([0,d[S+4]],32));case 4:D=p(D,y([0,d[S+3]],24));case 3:D=p(D,y([0,d[S+2]],16));case 2:D=p(D,y([0,d[S+1]],8));case 1:D=p(D,[0,d[S]]),D=h(D,R),D=f(D,31),D=h(D,T),m=p(m,D)}return m=p(m,[0,d.length]),E=p(E,[0,d.length]),m=u(m,E),E=u(E,m),m=v(m),E=v(E),m=u(m,E),E=u(E,m),("00000000"+(m[0]>>>0).toString(16)).slice(-8)+("00000000"+(m[1]>>>0).toString(16)).slice(-8)+("00000000"+(E[0]>>>0).toString(16)).slice(-8)+("00000000"+(E[1]>>>0).toString(16)).slice(-8)},typeof e<"u"?(typeof t<"u"&&t.exports&&(e=t.exports=i),e.murmurHash3=i):typeof define=="function"&&define.amd?define([],function(){return i}):(i._murmurHash3=r.murmurHash3,i.noConflict=function(){return r.murmurHash3=i._murmurHash3,i._murmurHash3=n,i.noConflict=n,i},r.murmurHash3=i)}(e)}),ZH=A((e,t)=>{c(),t.exports=QH()}),YR=A((e,t)=>{"use strict";c();var{Buffer:r}=_i(),n=Symbol.for("BufferList");function i(s){if(!(this instanceof i))return new i(s);i._init.call(this,s)}i._init=function(s){Object.defineProperty(this,n,{value:!0}),this._bufs=[],this.length=0,s&&this.append(s)},i.prototype._new=function(s){return new i(s)},i.prototype._offset=function(s){if(s===0)return[0,0];let a=0;for(let o=0;o<this._bufs.length;o++){let l=a+this._bufs[o].length;if(s<l||o===this._bufs.length-1)return[o,s-a];a=l}},i.prototype._reverseOffset=function(s){let a=s[0],o=s[1];for(let l=0;l<a;l++)o+=this._bufs[l].length;return o},i.prototype.get=function(s){if(s>this.length||s<0)return;let a=this._offset(s);return this._bufs[a[0]][a[1]]},i.prototype.slice=function(s,a){return typeof s=="number"&&s<0&&(s+=this.length),typeof a=="number"&&a<0&&(a+=this.length),this.copy(null,0,s,a)},i.prototype.copy=function(s,a,o,l){if((typeof o!="number"||o<0)&&(o=0),(typeof l!="number"||l>this.length)&&(l=this.length),o>=this.length||l<=0)return s||r.alloc(0);let u=!!s,h=this._offset(o),f=l-o,y=f,p=u&&a||0,v=h[1];if(o===0&&l===this.length){if(!u)return this._bufs.length===1?this._bufs[0]:r.concat(this._bufs,this.length);for(let d=0;d<this._bufs.length;d++)this._bufs[d].copy(s,p),p+=this._bufs[d].length;return s}if(y<=this._bufs[h[0]].length-v)return u?this._bufs[h[0]].copy(s,a,v,v+y):this._bufs[h[0]].slice(v,v+y);u||(s=r.allocUnsafe(f));for(let d=h[0];d<this._bufs.length;d++){let g=this._bufs[d].length-v;if(y>g)this._bufs[d].copy(s,p,v),p+=g;else{this._bufs[d].copy(s,p,v,v+y),p+=g;break}y-=g,v&&(v=0)}return s.length>p?s.slice(0,p):s},i.prototype.shallowSlice=function(s,a){if(s=s||0,a=typeof a!="number"?this.length:a,s<0&&(s+=this.length),a<0&&(a+=this.length),s===a)return this._new();let o=this._offset(s),l=this._offset(a),u=this._bufs.slice(o[0],l[0]+1);return l[1]===0?u.pop():u[u.length-1]=u[u.length-1].slice(0,l[1]),o[1]!==0&&(u[0]=u[0].slice(o[1])),this._new(u)},i.prototype.toString=function(s,a,o){return this.slice(a,o).toString(s)},i.prototype.consume=function(s){if(s=Math.trunc(s),Number.isNaN(s)||s<=0)return this;for(;this._bufs.length;)if(s>=this._bufs[0].length)s-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(s),this.length-=s;break}return this},i.prototype.duplicate=function(){let s=this._new();for(let a=0;a<this._bufs.length;a++)s.append(this._bufs[a]);return s},i.prototype.append=function(s){if(s==null)return this;if(s.buffer)this._appendBuffer(r.from(s.buffer,s.byteOffset,s.byteLength));else if(Array.isArray(s))for(let a=0;a<s.length;a++)this.append(s[a]);else if(this._isBufferList(s))for(let a=0;a<s._bufs.length;a++)this.append(s._bufs[a]);else typeof s=="number"&&(s=s.toString()),this._appendBuffer(r.from(s));return this},i.prototype._appendBuffer=function(s){this._bufs.push(s),this.length+=s.length},i.prototype.indexOf=function(s,a,o){if(o===void 0&&typeof a=="string"&&(o=a,a=void 0),typeof s=="function"||Array.isArray(s))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof s=="number"?s=r.from([s]):typeof s=="string"?s=r.from(s,o):this._isBufferList(s)?s=s.slice():Array.isArray(s.buffer)?s=r.from(s.buffer,s.byteOffset,s.byteLength):r.isBuffer(s)||(s=r.from(s)),a=Number(a||0),isNaN(a)&&(a=0),a<0&&(a=this.length+a),a<0&&(a=0),s.length===0)return a>this.length?this.length:a;let l=this._offset(a),u=l[0],h=l[1];for(;u<this._bufs.length;u++){let f=this._bufs[u];for(;h<f.length;)if(f.length-h>=s.length){let y=f.indexOf(s,h);if(y!==-1)return this._reverseOffset([u,y]);h=f.length-s.length+1}else{let y=this._reverseOffset([u,h]);if(this._match(y,s))return y;h++}h=0}return-1},i.prototype._match=function(s,a){if(this.length-s<a.length)return!1;for(let o=0;o<a.length;o++)if(this.get(s+o)!==a[o])return!1;return!0},function(){let s={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let a in s)(function(o){s[o]===null?i.prototype[o]=function(l,u){return this.slice(l,l+u)[o](0,u)}:i.prototype[o]=function(l=0){return this.slice(l,l+s[o])[o](0)}})(a)}(),i.prototype._isBufferList=function(s){return s instanceof i||i.isBufferList(s)},i.isBufferList=function(s){return s!=null&&s[n]},t.exports=i}),m$=A((e,t)=>{c();var r=class{constructor(n,i=12,s=8*1024,a=32*1024,o=64,l){this.bits=i,this.min=s,this.max=a,this.asModule=n,this.rabin=new n.Rabin(i,s,a,o,l),this.polynomial=l}fingerprint(n){let{__retain:i,__release:s,__allocArray:a,__getInt32Array:o,Int32Array_ID:l,Uint8Array_ID:u}=this.asModule,h=new Int32Array(Math.ceil(n.length/this.min)),f=i(a(l,h)),y=i(a(u,n)),p=this.rabin.fingerprint(y,f),v=o(p);s(y),s(f);let d=v.indexOf(0);return d>=0?v.subarray(0,d):v}};t.exports=r}),_$=A(e=>{"use strict";c();var t=typeof BigUint64Array<"u",r=Symbol(),n=1024;function i(y,p){let v=new Uint32Array(y),d=new Uint16Array(y);var g=v[p+-4>>>2]>>>1,b=p>>>1;if(g<=n)return String.fromCharCode.apply(String,d.subarray(b,b+g));let _=[];do{let m=d[b+n-1],E=m>=55296&&m<56320?n-1:n;_.push(String.fromCharCode.apply(String,d.subarray(b,b+=E))),g-=E}while(g>n);return _.join("")+String.fromCharCode.apply(String,d.subarray(b,b+g))}function s(y){let p={};function v(g,b){return g?i(g.buffer,b):"<yet unknown>"}let d=y.env=y.env||{};return d.abort=d.abort||function(g,b,_,m){let E=p.memory||d.memory;throw Error("abort: "+v(E,g)+" at "+v(E,b)+":"+_+":"+m)},d.trace=d.trace||function(g,b){let _=p.memory||d.memory;console.log("trace: "+v(_,g)+(b?" ":"")+Array.prototype.slice.call(arguments,2,2+b).join(", "))},y.Math=y.Math||Math,y.Date=y.Date||Date,p}function a(y,p){let v=p.exports,d=v.memory,g=v.table,b=v.__alloc,_=v.__retain,m=v.__rtti_base||-1;function E(W){let de=new Uint32Array(d.buffer),De=de[m>>>2];if((W>>>=0)>=De)throw Error("invalid id: "+W);return de[(m+4>>>2)+W*2]}function D(W){let de=new Uint32Array(d.buffer),De=de[m>>>2];if((W>>>=0)>=De)throw Error("invalid id: "+W);return de[(m+4>>>2)+W*2+1]}function N(W){return 31-Math.clz32(W>>>5&31)}function R(W){return 31-Math.clz32(W>>>14&31)}function T(W){let de=W.length,De=b(de<<1,1),Pe=new Uint16Array(d.buffer);for(var $e=0,Be=De>>>1;$e<de;++$e)Pe[Be+$e]=W.charCodeAt($e);return De}y.__allocString=T;function S(W){let de=d.buffer;if(new Uint32Array(de)[W+-8>>>2]!==1)throw Error("not a string: "+W);return i(de,W)}y.__getString=S;function O(W,de,De){let Pe=d.buffer;if(De)switch(W){case 2:return new Float32Array(Pe);case 3:return new Float64Array(Pe)}else switch(W){case 0:return new(de?Int8Array:Uint8Array)(Pe);case 1:return new(de?Int16Array:Uint16Array)(Pe);case 2:return new(de?Int32Array:Uint32Array)(Pe);case 3:return new(de?BigInt64Array:BigUint64Array)(Pe)}throw Error("unsupported align: "+W)}function F(W,de){let De=E(W);if(!(De&3))throw Error("not an array: "+W+" @ "+De);let Pe=N(De),$e=de.length,Be=b($e<<Pe,0),nt=b(De&2?16:12,W),Ve=new Uint32Array(d.buffer);Ve[nt+0>>>2]=_(Be),Ve[nt+4>>>2]=Be,Ve[nt+8>>>2]=$e<<Pe,De&2&&(Ve[nt+12>>>2]=$e);let et=O(Pe,De&1024,De&2048);if(De&8192)for(let ht=0;ht<$e;++ht)et[(Be>>>Pe)+ht]=_(de[ht]);else et.set(de,Be>>>Pe);return nt}y.__allocArray=F;function G(W){let de=new Uint32Array(d.buffer),De=de[W+-8>>>2],Pe=E(De);if(!(Pe&1))throw Error("not an array: "+De);let $e=N(Pe);var Be=de[W+4>>>2];let nt=Pe&2?de[W+12>>>2]:de[Be+-4>>>2]>>>$e;return O($e,Pe&1024,Pe&2048).subarray(Be>>>=$e,Be+nt)}y.__getArrayView=G;function ne(W){let de=G(W),De=de.length,Pe=new Array(De);for(let $e=0;$e<De;$e++)Pe[$e]=de[$e];return Pe}y.__getArray=ne;function Y(W){let de=d.buffer,De=new Uint32Array(de)[W+-4>>>2];return de.slice(W,W+De)}y.__getArrayBuffer=Y;function ce(W,de,De){return new W(oe(W,de,De))}function oe(W,de,De){let Pe=d.buffer,$e=new Uint32Array(Pe),Be=$e[De+4>>>2];return new W(Pe,Be,$e[Be+-4>>>2]>>>de)}y.__getInt8Array=ce.bind(null,Int8Array,0),y.__getInt8ArrayView=oe.bind(null,Int8Array,0),y.__getUint8Array=ce.bind(null,Uint8Array,0),y.__getUint8ArrayView=oe.bind(null,Uint8Array,0),y.__getUint8ClampedArray=ce.bind(null,Uint8ClampedArray,0),y.__getUint8ClampedArrayView=oe.bind(null,Uint8ClampedArray,0),y.__getInt16Array=ce.bind(null,Int16Array,1),y.__getInt16ArrayView=oe.bind(null,Int16Array,1),y.__getUint16Array=ce.bind(null,Uint16Array,1),y.__getUint16ArrayView=oe.bind(null,Uint16Array,1),y.__getInt32Array=ce.bind(null,Int32Array,2),y.__getInt32ArrayView=oe.bind(null,Int32Array,2),y.__getUint32Array=ce.bind(null,Uint32Array,2),y.__getUint32ArrayView=oe.bind(null,Uint32Array,2),t&&(y.__getInt64Array=ce.bind(null,BigInt64Array,3),y.__getInt64ArrayView=oe.bind(null,BigInt64Array,3),y.__getUint64Array=ce.bind(null,BigUint64Array,3),y.__getUint64ArrayView=oe.bind(null,BigUint64Array,3)),y.__getFloat32Array=ce.bind(null,Float32Array,2),y.__getFloat32ArrayView=oe.bind(null,Float32Array,2),y.__getFloat64Array=ce.bind(null,Float64Array,3),y.__getFloat64ArrayView=oe.bind(null,Float64Array,3);function H(W,de){let De=new Uint32Array(d.buffer);var Pe=De[W+-8>>>2];if(Pe<=De[m>>>2])do if(Pe==de)return!0;while(Pe=D(Pe));return!1}return y.__instanceof=H,y.memory=y.memory||d,y.table=y.table||g,f(v,y)}function o(y){return typeof Response<"u"&&y instanceof Response}async function l(y,p){return o(y=await y)?h(y,p):a(s(p||(p={})),await WebAssembly.instantiate(y instanceof WebAssembly.Module?y:await WebAssembly.compile(y),p))}e.instantiate=l;function u(y,p){return a(s(p||(p={})),new WebAssembly.Instance(y instanceof WebAssembly.Module?y:new WebAssembly.Module(y),p))}e.instantiateSync=u;async function h(y,p){return WebAssembly.instantiateStreaming?a(s(p||(p={})),(await WebAssembly.instantiateStreaming(y,p)).instance):l(o(y=await y)?y.arrayBuffer():y,p)}e.instantiateStreaming=h;function f(y,p){var v=p?Object.create(p):{},d=y.__argumentsLength?function(g){y.__argumentsLength.value=g}:y.__setArgumentsLength||y.__setargc||function(){};for(let g in y){if(!Object.prototype.hasOwnProperty.call(y,g))continue;let b=y[g],_=g.split("."),m=v;for(;_.length>1;){let N=_.shift();Object.prototype.hasOwnProperty.call(m,N)||(m[N]={}),m=m[N]}let E=_[0],D=E.indexOf("#");if(D>=0){let N=E.substring(0,D),R=m[N];if(typeof R>"u"||!R.prototype){let T=function(...S){return T.wrap(T.prototype.constructor(0,...S))};T.prototype={valueOf:function(){return this[r]}},T.wrap=function(S){return Object.create(T.prototype,{[r]:{value:S,writable:!1}})},R&&Object.getOwnPropertyNames(R).forEach(S=>Object.defineProperty(T,S,Object.getOwnPropertyDescriptor(R,S))),m[N]=T}if(E=E.substring(D+1),m=m[N].prototype,/^(get|set):/.test(E)){if(!Object.prototype.hasOwnProperty.call(m,E=E.substring(4))){let T=y[g.replace("set:","get:")],S=y[g.replace("get:","set:")];Object.defineProperty(m,E,{get:function(){return T(this[r])},set:function(O){S(this[r],O)},enumerable:!0})}}else E==="constructor"?(m[E]=(...T)=>(d(T.length),b(...T))).original=b:(m[E]=function(...T){return d(T.length),b(this[r],...T)}).original=b}else/^(get|set):/.test(E)?Object.prototype.hasOwnProperty.call(m,E=E.substring(4))||Object.defineProperty(m,E,{get:y[g.replace("set:","get:")],set:y[g.replace("get:","set:")],enumerable:!0}):typeof b=="function"&&b!==d?(m[E]=(...N)=>(d(N.length),b(...N))).original=b:m[E]=b}return v}e.demangle=f}),S$=A((e,t)=>{c();var{instantiate:r}=_$();n.supported=typeof WebAssembly<"u";function n(i={}){if(!n.supported)return null;var s=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return r(new Response(new Blob([s],{type:"application/wasm"})),i)}t.exports=n}),A$=A((e,t)=>{c();var r=m$(),n=S$(),i=async(s,a,o,l,u)=>{let h=await n();return new r(h,s,a,o,l,u)};t.exports={Rabin:r,create:i}}),L$=A((e,t)=>{"use strict";c(),t.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(a,o){let l=this._internalPositionFor(a,!1);if(o===void 0)l!==-1&&(this._unsetInternalPos(l),this._unsetBit(a),this._changedLength=!0,this._changedData=!0);else{let u=!1;l===-1?(l=this._data.length,this._setBit(a),this._changedData=!0):u=!0,this._setInternalPos(l,a,o,u),this._changedLength=!0}}unset(a){this.set(a,void 0)}get(a){this._sortData();let o=this._internalPositionFor(a,!0);if(o!==-1)return this._data[o][1]}push(a){return this.set(this.length,a),this.length}get length(){if(this._sortData(),this._changedLength){let a=this._data[this._data.length-1];this._length=a?a[0]+1:0,this._changedLength=!1}return this._length}forEach(a){let o=0;for(;o<this.length;)a(this.get(o),o,this),o++}map(a){let o=0,l=new Array(this.length);for(;o<this.length;)l[o]=a(this.get(o),o,this),o++;return l}reduce(a,o){let l=0,u=o;for(;l<this.length;){let h=this.get(l);u=a(u,h,l),l++}return u}find(a){let o=0,l,u;for(;o<this.length&&!l;)u=this.get(o),l=a(u),o++;return l?u:void 0}_internalPositionFor(a,o){let l=this._bytePosFor(a,o);if(l>=this._bitArrays.length)return-1;let u=this._bitArrays[l],h=a-l*7;if(!((u&1<<h)>0))return-1;let f=this._bitArrays.slice(0,l).reduce(r,0),y=~(4294967295<<h+1),p=n(u&y);return f+p-1}_bytePosFor(a,o){let l=Math.floor(a/7),u=l+1;for(;!o&&this._bitArrays.length<u;)this._bitArrays.push(0);return l}_setBit(a){let o=this._bytePosFor(a,!1);this._bitArrays[o]|=1<<a-o*7}_unsetBit(a){let o=this._bytePosFor(a,!1);this._bitArrays[o]&=~(1<<a-o*7)}_setInternalPos(a,o,l,u){let h=this._data,f=[o,l];if(u)this._sortData(),h[a]=f;else{if(h.length)if(h[h.length-1][0]>=o)h.push(f);else if(h[0][0]<=o)h.unshift(f);else{let y=Math.round(h.length/2);this._data=h.slice(0,y).concat(f).concat(h.slice(y))}else this._data.push(f);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(a){this._data.splice(a,1)}_sortData(){this._changedData&&this._data.sort(i),this._changedData=!1}bitField(){let a=[],o=8,l=0,u=0,h,f=this._bitArrays.slice();for(;f.length||l;){l===0&&(h=f.shift(),l=7);let p=Math.min(l,o),v=~(255<<p);u|=(h&v)<<8-o,h=h>>>p,l-=p,o-=p,(!o||!l&&!f.length)&&(a.push(u),u=0,o=8)}for(var y=a.length-1;y>0&&a[y]===0;y--)a.pop();return a}compactArray(){return this._sortData(),this._data.map(s)}};function r(a,o){return a+n(o)}function n(a){let o=a;return o=o-(o>>1&1431655765),o=(o&858993459)+(o>>2&858993459),(o+(o>>4)&252645135)*16843009>>24}function i(a,o){return a[0]-o[0]}function s(a){return a[1]}}),U$=A((e,t)=>{"use strict";c();var r=L$(),{fromString:n}=(Re(),cr(dS)),i=class{constructor(u,h,f=0){this._options=u,this._popCount=0,this._parent=h,this._posAtParent=f,this._children=new r,this.key=null}async put(u,h){let f=await this._findNewBucketAndPos(u);await f.bucket._putAt(f,u,h)}async get(u){let h=await this._findChild(u);if(h)return h.value}async del(u){let h=await this._findPlace(u),f=h.bucket._at(h.pos);f&&f.key===u&&h.bucket._delAt(h.pos)}leafCount(){return this._children.compactArray().reduce((u,h)=>h instanceof i?u+h.leafCount():u+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let u=this._children.compactArray();for(let h of u)h instanceof i?yield*h.eachLeafSeries():yield h;return[]}serialize(u,h){let f=[];return h(this._children.reduce((y,p,v)=>(p&&(p instanceof i?y.push(p.serialize(u,h)):y.push(u(p,v))),y),f))}asyncTransform(u,h){return l(this,u,h)}toJSON(){return this.serialize(a,o)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(u){let h=await this._findPlace(u),f=h.bucket._at(h.pos);if(!(f instanceof i)&&f&&f.key===u)return f}async _findPlace(u){let h=this._options.hash(typeof u=="string"?n(u):u),f=await h.take(this._options.bits),y=this._children.get(f);return y instanceof i?y._findPlace(h):{bucket:this,pos:f,hash:h,existingChild:y}}async _findNewBucketAndPos(u){let h=await this._findPlace(u);if(h.existingChild&&h.existingChild.key!==u){let f=new i(this._options,h.bucket,h.pos);h.bucket._putObjectAt(h.pos,f);let y=await f._findPlace(h.existingChild.hash);return y.bucket._putAt(y,h.existingChild.key,h.existingChild.value),f._findNewBucketAndPos(h.hash)}return h}_putAt(u,h,f){this._putObjectAt(u.pos,{key:h,value:f,hash:u.hash})}_putObjectAt(u,h){this._children.get(u)||this._popCount++,this._children.set(u,h)}_delAt(u){if(u===-1)throw new Error("Invalid position");this._children.get(u)&&this._popCount--,this._children.unset(u),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let u=this._children.find(s);if(u&&!(u instanceof i)){let h=u.hash;h.untake(this._options.bits);let f={pos:this._posAtParent,hash:h,bucket:this._parent};this._parent._putAt(f,u.key,u.value)}}else this._parent._delAt(this._posAtParent)}_at(u){return this._children.get(u)}};function s(u){return Boolean(u)}function a(u,h){return u.key}function o(u){return u}async function l(u,h,f){let y=[];for(let p of u._children.compactArray())if(p instanceof i)await l(p,h,f);else{let v=await h(p);y.push({bitField:u._children.bitField(),children:v})}return f(y)}t.exports=i}),K$=A((e,t)=>{"use strict";c();var r=[255,254,252,248,240,224,192,128],n=[1,3,7,15,31,63,127,255];t.exports=class{constructor(a){this._value=a,this._currentBytePos=a.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(a){let o=a,l=0;for(;o&&this._haveBits();){let u=this._value[this._currentBytePos],h=this._currentBitPos+1,f=Math.min(h,o),y=i(u,h-f,f);l=(l<<f)+y,o-=f,this._currentBitPos-=f,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return l}untake(a){for(this._currentBitPos+=a;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function i(a,o,l){let u=s(o,l);return(a&u)>>>o}function s(a,o){return r[a]&n[Math.min(o+a-1,7)]}}),V$=A((e,t)=>{"use strict";c();var r=K$(),{concat:n}=(ur(),cr(s2));function i(a){function o(l){return l instanceof s?l:new s(l,a)}return o}var s=class{constructor(a,o){if(!(a instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=a,this._hashFn=o,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(a){let o=a;for(;this._availableBits<o;)await this._produceMoreBits();let l=0;for(;o>0;){let u=this._buffers[this._currentBufferIndex],h=Math.min(u.availableBits(),o),f=u.take(h);l=(l<<h)+f,o-=h,this._availableBits-=h,u.availableBits()===0&&this._currentBufferIndex++}return l}untake(a){let o=a;for(;o>0;){let l=this._buffers[this._currentBufferIndex],u=Math.min(l.totalBits()-l.availableBits(),o);l.untake(u),o-=u,this._availableBits+=u,this._currentBufferIndex>0&&l.totalBits()===l.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let a=this._depth?n([this._value,Uint8Array.from([this._depth])]):this._value,o=await this._hashFn(a),l=new r(o);this._buffers.push(l),this._availableBits+=l.availableBits()}};t.exports=i,t.exports.InfiniteHash=s}),wy=A((e,t)=>{"use strict";c();var r=U$(),n=V$();function i(s){if(!s||!s.hashFn)throw new Error("please define an options.hashFn");let a={bits:s.bits||8,hash:n(s.hashFn)};return new r(a)}t.exports={createHAMT:i,Bucket:r}}),SG=A((e,t)=>{"use strict";c(),t.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,SIGUNUSED:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488383,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}}),hA=A((e,t)=>{"use strict";c();var{concat:r}=(ur(),cr(s2));async function n(i){let s=new Uint8Array(0);for await(let a of i)s=r([s,a],s.length+a.length);return s}t.exports=n}),Gc=A((e,t)=>{"use strict";c();var r=async n=>{for await(let i of n)return i};t.exports=r}),_T=A((e,t)=>{c(),t.exports=r;function r(n,i,s){if(!n)return s;var a,o;if(Array.isArray(i)&&(a=i.slice(0)),typeof i=="string"&&(a=i.split(".")),typeof i=="symbol"&&(a=[i]),!Array.isArray(a))throw new Error("props arg must be an array, a string or a symbol");for(;a.length;)if(o=a.shift(),!n||(n=n[o],n===void 0))return s;return n}}),Jy=A((e,t)=>{"use strict";c();var r=async n=>{let i=0;for await(let s of n)i++;return i};t.exports=r}),nQ=A((e,t)=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0}),r.BASE=2166136261;function r(n,i=r.BASE){let s=n.length;for(let a=0;a<s;a++)i^=n.charCodeAt(a),i+=(i<<1)+(i<<4)+(i<<7)+(i<<8)+(i<<24);return i>>>0}e.default=r,t.exports=r}),CQ=A((e,t)=>{"use strict";c(),t.exports=a,t.exports.format=o,t.exports.parse=l;var r=/\B(?=(\d{3})+(?!\d))/g,n=/(?:\.0*|(\.[^0]+)0+)$/,i={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},s=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function a(u,h){return typeof u=="string"?l(u):typeof u=="number"?o(u,h):null}function o(u,h){if(!Number.isFinite(u))return null;var f=Math.abs(u),y=h&&h.thousandsSeparator||"",p=h&&h.unitSeparator||"",v=h&&h.decimalPlaces!==void 0?h.decimalPlaces:2,d=Boolean(h&&h.fixedDecimals),g=h&&h.unit||"";(!g||!i[g.toLowerCase()])&&(f>=i.pb?g="PB":f>=i.tb?g="TB":f>=i.gb?g="GB":f>=i.mb?g="MB":f>=i.kb?g="KB":g="B");var b=u/i[g.toLowerCase()],_=b.toFixed(v);return d||(_=_.replace(n,"$1")),y&&(_=_.split(".").map(function(m,E){return E===0?m.replace(r,y):m}).join(".")),_+p+g}function l(u){if(typeof u=="number"&&!isNaN(u))return u;if(typeof u!="string")return null;var h=s.exec(u),f,y="b";return h?(f=parseFloat(h[1]),y=h[4].toLowerCase()):(f=parseInt(u,10),y="b"),isNaN(f)?null:Math.floor(i[y]*f)}}),BQ=A((e,t)=>{"use strict";c(),t.exports=(r,n)=>(n=n||(()=>{}),r.then(i=>new Promise(s=>{s(n())}).then(()=>i),i=>new Promise(s=>{s(n())}).then(()=>{throw i})))}),UQ=A((e,t)=>{"use strict";c();var r=BQ(),n=class extends Error{constructor(s){super(s),this.name="TimeoutError"}},i=(s,a,o)=>new Promise((l,u)=>{if(typeof a!="number"||a<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(a===1/0){l(s);return}let h=setTimeout(()=>{if(typeof o=="function"){try{l(o())}catch(p){u(p)}return}let f=typeof o=="string"?o:`Promise timed out after ${a} milliseconds`,y=o instanceof Error?o:new n(f);typeof s.cancel=="function"&&s.cancel(),u(y)},a);r(s.then(l,u),()=>{clearTimeout(h)})});t.exports=i,t.exports.default=i,t.exports.TimeoutError=n}),FQ=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});function t(r,n,i){let s=0,a=r.length;for(;a>0;){let o=a/2|0,l=s+o;i(r[l],n)<=0?(s=++l,a-=o+1):a=o}return s}e.default=t}),KQ=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=FQ(),r=class{constructor(){this._queue=[]}enqueue(n,i){i=Object.assign({priority:0},i);let s={priority:i.priority,run:n};if(this.size&&this._queue[this.size-1].priority>=i.priority){this._queue.push(s);return}let a=t.default(this._queue,s,(o,l)=>l.priority-o.priority);this._queue.splice(a,0,s)}dequeue(){return this._queue.shift()?.run}filter(n){return this._queue.filter(i=>i.priority===n.priority).map(i=>i.run)}get size(){return this._queue.length}};e.default=r}),HT=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=Xu(),r=UQ(),n=KQ(),i=()=>{},s=new r.TimeoutError,a=class extends t{constructor(o){var l,u,h,f;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=i,this._resolveIdle=i,o=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:n.default},o),!(typeof o.intervalCap=="number"&&o.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(u=(l=o.intervalCap)===null||l===void 0?void 0:l.toString())!==null&&u!==void 0?u:""}\` (${typeof o.intervalCap})`);if(o.interval===void 0||!(Number.isFinite(o.interval)&&o.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(f=(h=o.interval)===null||h===void 0?void 0:h.toString())!==null&&f!==void 0?f:""}\` (${typeof o.interval})`);this._carryoverConcurrencyCount=o.carryoverConcurrencyCount,this._isIntervalIgnored=o.intervalCap===1/0||o.interval===0,this._intervalCap=o.intervalCap,this._interval=o.interval,this._queue=new o.queueClass,this._queueClass=o.queueClass,this.concurrency=o.concurrency,this._timeout=o.timeout,this._throwOnTimeout=o.throwOnTimeout===!0,this._isPaused=o.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=i,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=i,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let o=Date.now();if(this._intervalId===void 0){let l=this._intervalEnd-o;if(l<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},l)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let o=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let l=this._queue.dequeue();return l?(this.emit("active"),l(),o&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(o){if(!(typeof o=="number"&&o>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${o}\` (${typeof o})`);this._concurrency=o,this._processQueue()}async add(o,l={}){return new Promise((u,h)=>{let f=async()=>{this._pendingCount++,this._intervalCount++;try{let y=this._timeout===void 0&&l.timeout===void 0?o():r.default(Promise.resolve(o()),l.timeout===void 0?this._timeout:l.timeout,()=>{(l.throwOnTimeout===void 0?this._throwOnTimeout:l.throwOnTimeout)&&h(s)});u(await y)}catch(y){h(y)}this._next()};this._queue.enqueue(f,l),this._tryToStartAnother(),this.emit("add")})}async addAll(o,l){return Promise.all(o.map(async u=>this.add(u,l)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(o=>{let l=this._resolveEmpty;this._resolveEmpty=()=>{l(),o()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(o=>{let l=this._resolveIdle;this._resolveIdle=()=>{l(),o()}})}get size(){return this._queue.size}sizeBy(o){return this._queue.filter(o).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(o){this._timeout=o}};e.default=a}),HQ=A((e,t)=>{c(),t.exports=r;function r(i,s,a){var o,l;if(Array.isArray(s)&&(o=s.slice(0)),typeof s=="string"&&(o=s.split(".")),typeof s=="symbol"&&(o=[s]),!Array.isArray(o))throw new Error("props arg must be an array, a string or a symbol");if(l=o.pop(),!l)return!1;n(l);for(var u;u=o.shift();)if(n(u),typeof i[u]>"u"&&(i[u]={}),i=i[u],!i||typeof i!="object")return!1;return i[l]=a,!0}function n(i){if(i==="__proto__"||i==="constructor"||i==="prototype")throw new Error("setting of prototype values not supported")}}),YQ=A((e,t)=>{"use strict";c();var r=V7();t.exports=(n,i={})=>{if(!r(n)&&!Array.isArray(n))throw new TypeError("Expected a plain object or array");let{deep:s}=i,a=[],o=[],l=h=>{let f=a.indexOf(h);if(f!==-1)return o[f];let y=[];return a.push(h),o.push(y),y.push(...h.map(p=>Array.isArray(p)?l(p):r(p)?u(p):p)),y},u=h=>{let f=a.indexOf(h);if(f!==-1)return o[f];let y={},p=Object.keys(h).sort(i.compare);a.push(h),o.push(y);for(let v of p){let d=h[v],g;s&&Array.isArray(d)?g=l(d):g=s&&r(d)?u(d):d,Object.defineProperty(y,v,{...Object.getOwnPropertyDescriptor(h,v),value:g})}return y};return Array.isArray(n)?s?l(n):n.slice():u(n)}}),eX=A((e,t)=>{c();var r=d0();t.exports=n=>{n=n||{};let i;typeof n=="function"?(i=n,n={}):i=n.onEnd;let s=new r,a,o,l,u=()=>{if(!s.isEmpty()){if(n.writev){let _,m=[];for(;!s.isEmpty();){if(_=s.shift(),_.error)throw _.error;m.push(_.value)}return{done:_.done,value:m}}let b=s.shift();if(b.error)throw b.error;return b}return l?{done:!0}:new Promise((b,_)=>{o=m=>(o=null,m.error?_(m.error):n.writev&&!m.done?b({done:m.done,value:[m.value]}):b(m),a)})},h=b=>o?o(b):(s.push(b),a),f=b=>(s=new r,o?o({error:b}):(s.push({error:b}),a)),y=b=>l?a:h({done:!1,value:b}),p=b=>l?a:(l=!0,b?f(b):h({done:!0})),v=()=>(s=new r,p(),{done:!0}),d=b=>(p(b),{done:!0});if(a={[Symbol.asyncIterator](){return this},next:u,return:v,throw:d,push:y,end:p},!i)return a;let g=a;return a={[Symbol.asyncIterator](){return this},next(){return g.next()},throw(b){return g.throw(b),i&&(i(b),i=null),{done:!0}},return(){return g.return(),i&&(i(),i=null),{done:!0}},push:y,end(b){return g.end(b),i&&(i(b),i=null),a}},a}}),JT=A((e,t)=>{c(),t.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}}),EX=A(()=>{c()}),CX=A((e,t)=>{c();var r=In().EventEmitter,{nanoid:n}=(Lp(),cr(MS)),{WORKER_REQUEST_READ_LOCK:i,WORKER_RELEASE_READ_LOCK:s,MASTER_GRANT_READ_LOCK:a,WORKER_REQUEST_WRITE_LOCK:o,WORKER_RELEASE_WRITE_LOCK:l,MASTER_GRANT_WRITE_LOCK:u}=JT(),h,f=(p,v,d,g,b)=>(_,m)=>{m&&m.type===d&&p.emit(v,m.name,()=>(_.send({type:b,name:m.name,identifier:m.identifier}),new Promise(E=>{let D=N=>{N&&N.type===g&&N.identifier===m.identifier&&(_.removeListener("message",D),E())};_.on("message",D)})))},y=(p,v,d,g)=>()=>{let b=n();return process.send({type:v,identifier:b,name:p}),new Promise(_=>{let m=E=>{E&&E.type===d&&E.identifier===b&&(process.removeListener("message",m),_(()=>{process.send({type:g,identifier:b,name:p})}))};process.on("message",m)})};t.exports=p=>{try{if(h=EX(),!Object.keys(h).length)return}catch{return}if(h.isMaster||p.singleProcess){let v=new r;return h.on("message",f(v,"requestReadLock",i,s,a)),h.on("message",f(v,"requestWriteLock",o,l,u)),v}return{isWorker:!0,readLock:v=>y(v,i,a,s),writeLock:v=>y(v,o,u,l)}}}),eI=A((e,t)=>{c();var r={},n=i=>{i.addEventListener("message",s=>{n.dispatchEvent("message",i,s)}),i.port&&i.port.addEventListener("message",s=>{n.dispatchEvent("message",i,s)})};n.addEventListener=(i,s)=>{r[i]||(r[i]=[]),r[i].push(s)},n.removeEventListener=(i,s)=>{!r[i]||(r[i]=r[i].filter(a=>a===s))},n.dispatchEvent=function(){let i=Array.prototype.slice.call(arguments),s=i.shift();!r[s]||r[s].forEach(a=>a.apply(null,i))},t.exports=n}),VX=A((e,t)=>{c();var r=In().EventEmitter,{nanoid:n}=(Lp(),cr(MS)),{WORKER_REQUEST_READ_LOCK:i,WORKER_RELEASE_READ_LOCK:s,MASTER_GRANT_READ_LOCK:a,WORKER_REQUEST_WRITE_LOCK:o,WORKER_RELEASE_WRITE_LOCK:l,MASTER_GRANT_WRITE_LOCK:u}=JT(),h=eI(),f=(v,d,g,b,_)=>(m,E)=>{if(!E||!E.data||E.data.type!==g)return;let D={type:E.data.type,name:E.data.name,identifier:E.data.identifier};v.emit(d,D.name,()=>(m.postMessage({type:_,name:D.name,identifier:D.identifier}),new Promise(N=>{let R=T=>{if(!T||!T.data)return;let S={type:T.data.type,name:T.data.name,identifier:T.data.identifier};S&&S.type===b&&S.identifier===D.identifier&&(m.removeEventListener("message",R),N())};m.addEventListener("message",R)})))},y=(v,d,g,b)=>()=>{let _=n();return globalThis.postMessage({type:d,identifier:_,name:v}),new Promise(m=>{let E=D=>{if(!D||!D.data)return;let N={type:D.data.type,identifier:D.data.identifier};N&&N.type===g&&N.identifier===_&&(globalThis.removeEventListener("message",E),m(()=>{globalThis.postMessage({type:b,identifier:_,name:v})}))};globalThis.addEventListener("message",E)})},p={singleProcess:!1};t.exports=v=>{if(v=Object.assign({},p,v),!!globalThis.document||v.singleProcess){let d=new r;return h.addEventListener("message",f(d,"requestReadLock",i,s,a)),h.addEventListener("message",f(d,"requestWriteLock",o,l,u)),d}return{isWorker:!0,readLock:d=>y(d,i,a,s),writeLock:d=>y(d,o,u,l)}}}),qX=A((e,t)=>{"use strict";c();var r,n=t.exports.timeout=function(i,s){var a=new r,o;return Promise.race([i,new Promise(function(l,u){o=setTimeout(function(){u(a)},s)})]).then(function(l){return clearTimeout(o),l},function(l){throw clearTimeout(o),l})};r=t.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"},r.prototype=Object.create(Error.prototype),r.prototype.name="TimeoutError"}),HX=A((e,t)=>{c();var r=CX(),n=VX(),{default:i}=HT(),{timeout:s}=qX(),a=eI(),o={},l;function u(y,p){let v,d=new Promise(g=>{v=g});return y.add(()=>s((()=>new Promise(g=>{v(()=>{g()})}))(),p.timeout)),d}var h=(y,p)=>{if(l.isWorker)return{readLock:l.readLock(y,p),writeLock:l.writeLock(y,p)};let v=new i({concurrency:1}),d=null;return{readLock:()=>{if(d)return u(d,p);d=new i({concurrency:p.concurrency,autoStart:!1});let g=d,b=u(d,p);return v.add(()=>(g.start(),g.onIdle().then(()=>{d===g&&(d=null)}))),b},writeLock:()=>(d=null,u(v,p))}},f={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};t.exports=(y,p)=>(p||(p={}),typeof y=="object"&&(p=y,y="lock"),y||(y="lock"),p=Object.assign({},f,p),l||(l=r(p)||n(p),l.isWorker||(l.on("requestReadLock",(v,d)=>{!o[v]||o[v].readLock().then(g=>d().finally(()=>g()))}),l.on("requestWriteLock",async(v,d)=>{!o[v]||o[v].writeLock().then(g=>d().finally(()=>g()))}))),o[y]||(o[y]=h(y,p)),o[y]),t.exports.Worker=function(y,p){p=p||globalThis.Worker;let v;try{v=new p(y)}catch(d){d.message.includes("not a constructor")&&(v=p(y))}if(!v)throw new Error("Could not create Worker from",p);return a(v),v}}),WX=A((e,t)=>{c();var r=(...o)=>{let l;for(;o.length;)l=o.shift()(l);return l},n=o=>o&&(typeof o[Symbol.asyncIterator]=="function"||typeof o[Symbol.iterator]=="function"||typeof o.next=="function"),i=o=>o&&typeof o.sink=="function"&&n(o.source),s=o=>l=>(o.sink(l),o.source),a=(...o)=>{if(i(o[0])){let l=o[0];o[0]=()=>l.source}else if(n(o[0])){let l=o[0];o[0]=()=>l}if(o.length>1&&i(o[o.length-1])&&(o[o.length-1]=o[o.length-1].sink),o.length>2)for(let l=1;l<o.length-1;l++)i(o[l])&&(o[l]=s(o[l]));return r(...o)};t.exports=a,t.exports.pipe=a,t.exports.rawPipe=r,t.exports.isIterable=n,t.exports.isDuplex=i}),ug=A((e,t)=>{"use strict";c();var r=Vs(),n=async function*(i,s){yield*(await r(i)).sort(s)};t.exports=n}),sZ=A((e,t)=>{c(),t.exports=function(r){return r&&typeof r=="object"&&typeof r.copy=="function"&&typeof r.fill=="function"&&typeof r.readUInt8=="function"}}),aZ=A((e,t)=>{c(),typeof Object.create=="function"?t.exports=function(r,n){r.super_=n,r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(r,n){r.super_=n;var i=function(){};i.prototype=n.prototype,r.prototype=new i,r.prototype.constructor=r}}),fZ=A(e=>{c();var t=/%[sdj%]/g;e.format=function(H){if(!m(H)){for(var W=[],de=0;de<arguments.length;de++)W.push(i(arguments[de]));return W.join(" ")}for(var de=1,De=arguments,Pe=De.length,$e=String(H).replace(t,function(Ve){if(Ve==="%%")return"%";if(de>=Pe)return Ve;switch(Ve){case"%s":return String(De[de++]);case"%d":return Number(De[de++]);case"%j":try{return JSON.stringify(De[de++])}catch{return"[Circular]"}default:return Ve}}),Be=De[de];de<Pe;Be=De[++de])g(Be)||!R(Be)?$e+=" "+Be:$e+=" "+i(Be);return $e},e.deprecate=function(H,W){if(D(globalThis.process))return function(){return e.deprecate(H,W).apply(this,arguments)};if(process.noDeprecation===!0)return H;var de=!1;function De(){if(!de){if(process.throwDeprecation)throw new Error(W);process.traceDeprecation?console.trace(W):console.error(W),de=!0}return H.apply(this,arguments)}return De};var r={},n;e.debuglog=function(H){if(D(n)&&(n=process.env.NODE_DEBUG||""),H=H.toUpperCase(),!r[H])if(new RegExp("\\b"+H+"\\b","i").test(n)){var W=process.pid;r[H]=function(){var de=e.format.apply(e,arguments);console.error("%s %d: %s",H,W,de)}}else r[H]=function(){};return r[H]};function i(H,W){var de={seen:[],stylize:a};return arguments.length>=3&&(de.depth=arguments[2]),arguments.length>=4&&(de.colors=arguments[3]),d(W)?de.showHidden=W:W&&e._extend(de,W),D(de.showHidden)&&(de.showHidden=!1),D(de.depth)&&(de.depth=2),D(de.colors)&&(de.colors=!1),D(de.customInspect)&&(de.customInspect=!0),de.colors&&(de.stylize=s),l(de,H,de.depth)}e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function s(H,W){var de=i.styles[W];return de?"\x1B["+i.colors[de][0]+"m"+H+"\x1B["+i.colors[de][1]+"m":H}function a(H,W){return H}function o(H){var W={};return H.forEach(function(de,De){W[de]=!0}),W}function l(H,W,de){if(H.customInspect&&W&&O(W.inspect)&&W.inspect!==e.inspect&&!(W.constructor&&W.constructor.prototype===W)){var De=W.inspect(de,H);return m(De)||(De=l(H,De,de)),De}var Pe=u(H,W);if(Pe)return Pe;var $e=Object.keys(W),Be=o($e);if(H.showHidden&&($e=Object.getOwnPropertyNames(W)),S(W)&&($e.indexOf("message")>=0||$e.indexOf("description")>=0))return h(W);if($e.length===0){if(O(W)){var nt=W.name?": "+W.name:"";return H.stylize("[Function"+nt+"]","special")}if(N(W))return H.stylize(RegExp.prototype.toString.call(W),"regexp");if(T(W))return H.stylize(Date.prototype.toString.call(W),"date");if(S(W))return h(W)}var Ve="",et=!1,ht=["{","}"];if(v(W)&&(et=!0,ht=["[","]"]),O(W)){var Z=W.name?": "+W.name:"";Ve=" [Function"+Z+"]"}if(N(W)&&(Ve=" "+RegExp.prototype.toString.call(W)),T(W)&&(Ve=" "+Date.prototype.toUTCString.call(W)),S(W)&&(Ve=" "+h(W)),$e.length===0&&(!et||W.length==0))return ht[0]+Ve+ht[1];if(de<0)return N(W)?H.stylize(RegExp.prototype.toString.call(W),"regexp"):H.stylize("[Object]","special");H.seen.push(W);var le;return et?le=f(H,W,de,Be,$e):le=$e.map(function(ke){return y(H,W,de,Be,ke,et)}),H.seen.pop(),p(le,Ve,ht)}function u(H,W){if(D(W))return H.stylize("undefined","undefined");if(m(W)){var de="'"+JSON.stringify(W).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return H.stylize(de,"string")}if(_(W))return H.stylize(""+W,"number");if(d(W))return H.stylize(""+W,"boolean");if(g(W))return H.stylize("null","null")}function h(H){return"["+Error.prototype.toString.call(H)+"]"}function f(H,W,de,De,Pe){for(var $e=[],Be=0,nt=W.length;Be<nt;++Be)oe(W,String(Be))?$e.push(y(H,W,de,De,String(Be),!0)):$e.push("");return Pe.forEach(function(Ve){Ve.match(/^\d+$/)||$e.push(y(H,W,de,De,Ve,!0))}),$e}function y(H,W,de,De,Pe,$e){var Be,nt,Ve;if(Ve=Object.getOwnPropertyDescriptor(W,Pe)||{value:W[Pe]},Ve.get?Ve.set?nt=H.stylize("[Getter/Setter]","special"):nt=H.stylize("[Getter]","special"):Ve.set&&(nt=H.stylize("[Setter]","special")),oe(De,Pe)||(Be="["+Pe+"]"),nt||(H.seen.indexOf(Ve.value)<0?(g(de)?nt=l(H,Ve.value,null):nt=l(H,Ve.value,de-1),nt.indexOf(`
`)>-1&&($e?nt=nt.split(`
`).map(function(et){return"  "+et}).join(`
`).substr(2):nt=`
`+nt.split(`
`).map(function(et){return"   "+et}).join(`
`))):nt=H.stylize("[Circular]","special")),D(Be)){if($e&&Pe.match(/^\d+$/))return nt;Be=JSON.stringify(""+Pe),Be.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Be=Be.substr(1,Be.length-2),Be=H.stylize(Be,"name")):(Be=Be.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Be=H.stylize(Be,"string"))}return Be+": "+nt}function p(H,W,de){var De=0,Pe=H.reduce(function($e,Be){return De++,Be.indexOf(`
`)>=0&&De++,$e+Be.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Pe>60?de[0]+(W===""?"":W+`
 `)+" "+H.join(`,
  `)+" "+de[1]:de[0]+W+" "+H.join(", ")+" "+de[1]}function v(H){return Array.isArray(H)}e.isArray=v;function d(H){return typeof H=="boolean"}e.isBoolean=d;function g(H){return H===null}e.isNull=g;function b(H){return H==null}e.isNullOrUndefined=b;function _(H){return typeof H=="number"}e.isNumber=_;function m(H){return typeof H=="string"}e.isString=m;function E(H){return typeof H=="symbol"}e.isSymbol=E;function D(H){return H===void 0}e.isUndefined=D;function N(H){return R(H)&&G(H)==="[object RegExp]"}e.isRegExp=N;function R(H){return typeof H=="object"&&H!==null}e.isObject=R;function T(H){return R(H)&&G(H)==="[object Date]"}e.isDate=T;function S(H){return R(H)&&(G(H)==="[object Error]"||H instanceof Error)}e.isError=S;function O(H){return typeof H=="function"}e.isFunction=O;function F(H){return H===null||typeof H=="boolean"||typeof H=="number"||typeof H=="string"||typeof H=="symbol"||typeof H>"u"}e.isPrimitive=F,e.isBuffer=sZ();function G(H){return Object.prototype.toString.call(H)}function ne(H){return H<10?"0"+H.toString(10):H.toString(10)}var Y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ce(){var H=new Date,W=[ne(H.getHours()),ne(H.getMinutes()),ne(H.getSeconds())].join(":");return[H.getDate(),Y[H.getMonth()],W].join(" ")}e.log=function(){console.log("%s - %s",ce(),e.format.apply(e,arguments))},e.inherits=aZ(),e._extend=function(H,W){if(!W||!R(W))return H;for(var de=Object.keys(W),De=de.length;De--;)H[de[De]]=W[de[De]];return H};function oe(H,W){return Object.prototype.hasOwnProperty.call(H,W)}}),yI=A((e,t)=>{"use strict";c(),t.exports=function(...n){let i=n.reduce((s,a)=>Object.assign(s,a),{});return Object.assign(i,{bufferKeys:i.bufferKeys||!1,snapshots:i.snapshots||!1,permanence:i.permanence||!1,seek:i.seek||!1,clear:i.clear||!1,getMany:i.getMany||!1,keyIterator:i.keyIterator||!1,valueIterator:i.valueIterator||!1,iteratorNextv:i.iteratorNextv||!1,iteratorAll:i.iteratorAll||!1,status:i.status||!1,idempotentOpen:i.idempotentOpen||!1,passiveOpen:i.passiveOpen||!1,serialize:i.serialize||!1,createIfMissing:i.createIfMissing||!1,errorIfExists:i.errorIfExists||!1,deferredOpen:i.deferredOpen||!1,openCallback:i.openCallback||!1,promises:i.promises||!1,streams:i.streams||!1,encodings:r(i.encodings),events:r(i.events),additionalMethods:Object.assign({},i.additionalMethods)})};function r(n){return n?Object.assign({},n):!1}}),mZ=A((e,t)=>{c(),t.exports=function(r){return r!=null&&r.constructor!=null&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}}),gZ=A((e,t)=>{c(),t.exports=typeof queueMicrotask=="function"?queueMicrotask:r=>Promise.resolve().then(r)}),Q8=A(e=>{"use strict";c();var t=gZ();e.fromCallback=function(r,n){if(r===void 0){var i=new Promise(function(s,a){r=function(o,l){o?a(o):s(l)}});r[n!==void 0?n:"promise"]=i}else if(typeof r!="function")throw new TypeError("Callback must be a function");return r},e.fromPromise=function(r,n){if(n===void 0)return r;r.then(function(i){t(()=>n(null,i))}).catch(function(i){t(()=>n(i))})}}),X8=A((e,t)=>{c();var r;t.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:globalThis):n=>(r||(r=Promise.resolve())).then(n).catch(i=>setTimeout(()=>{throw i},0))}),Z8=A((e,t)=>{"use strict";c();var r=X8();t.exports=function(n,...i){i.length===0?r(n):r(()=>n(...i))}}),wI=A((e,t)=>{"use strict";c();function r(n){if(typeof n!="object"||n===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=n,this._ended=!1,this._nexting=!1}r.prototype.next=function(n){let i=this;if(n===void 0)i=new Promise(function(s,a){n=function(o,l,u){o?a(o):l===void 0&&u===void 0?s():s([l,u])}});else if(typeof n!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(n,new Error("cannot call next() after end()")),i):this._nexting?(this._nextTick(n,new Error("cannot call next() before previous next() has completed")),i):(this._nexting=!0,this._next((s,...a)=>{this._nexting=!1,n(s,...a)}),i)},r.prototype._next=function(n){this._nextTick(n)},r.prototype.seek=function(n){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");n=this.db._serializeKey(n),this._seek(n)},r.prototype._seek=function(n){},r.prototype.end=function(n){let i;if(n===void 0)i=new Promise(function(s,a){n=function(o){o?a(o):s()}});else if(typeof n!="function")throw new Error("end() requires a callback argument");return this._ended?(this._nextTick(n,new Error("end() already called on iterator")),i):(this._ended=!0,this._end(n),i)},r.prototype._end=function(n){this._nextTick(n)},r.prototype[Symbol.asyncIterator]=async function*(){try{let n;for(;(n=await this.next())!==void 0;)yield n}finally{this._ended||await this.end()}},r.prototype._nextTick=Z8(),t.exports=r}),EI=A((e,t)=>{"use strict";c();var r=Object.freeze({});function n(i){if(typeof i!="object"||i===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=i,this._operations=[],this._written=!1}n.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},n.prototype.put=function(i,s,a){this._checkWritten();let o=this.db._checkKey(i)||this.db._checkValue(s);if(o)throw o;return i=this.db._serializeKey(i),s=this.db._serializeValue(s),this._put(i,s,a??r),this},n.prototype._put=function(i,s,a){this._operations.push({...a,type:"put",key:i,value:s})},n.prototype.del=function(i,s){this._checkWritten();let a=this.db._checkKey(i);if(a)throw a;return i=this.db._serializeKey(i),this._del(i,s??r),this},n.prototype._del=function(i,s){this._operations.push({...s,type:"del",key:i})},n.prototype.clear=function(){return this._checkWritten(),this._clear(),this},n.prototype._clear=function(){this._operations=[]},n.prototype.write=function(i,s){if(this._checkWritten(),typeof i=="function"&&(s=i),typeof s!="function")throw new Error("write() requires a callback argument");(typeof i!="object"||i===null)&&(i={}),this._written=!0,this._write(i,s)},n.prototype._write=function(i,s){this.db._batch(this._operations,i,s)},n.prototype._nextTick=Z8(),t.exports=n}),_I=A(e=>{"use strict";c(),e.getCallback=function(t,r){return typeof t=="function"?t:r},e.getOptions=function(t){return typeof t=="object"&&t!==null?t:{}}}),IZ=A((e,t)=>{"use strict";c();var r=yI(),n=mZ(),i=Q8(),s=wI(),a=EI(),o=_I().getCallback,l=_I().getOptions,u=Object.prototype.hasOwnProperty,h=["lt","lte","gt","gte"];function f(d){this.status="new",this.supports=r(d,{status:!0})}f.prototype.open=function(d,g){let b=this.status;if(typeof d=="function"&&(g=d),typeof g!="function")throw new Error("open() requires a callback argument");(typeof d!="object"||d===null)&&(d={}),d.createIfMissing=d.createIfMissing!==!1,d.errorIfExists=!!d.errorIfExists,this.status="opening",this._open(d,_=>{if(_)return this.status=b,g(_);this.status="open",g()})},f.prototype._open=function(d,g){this._nextTick(g)},f.prototype.close=function(d){let g=this.status;if(typeof d!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(b=>{if(b)return this.status=g,d(b);this.status="closed",d()})},f.prototype._close=function(d){this._nextTick(d)},f.prototype.get=function(d,g,b){if(typeof g=="function"&&(b=g),typeof b!="function")throw new Error("get() requires a callback argument");let _=this._checkKey(d);if(_)return this._nextTick(b,_);d=this._serializeKey(d),(typeof g!="object"||g===null)&&(g={}),g.asBuffer=g.asBuffer!==!1,this._get(d,g,b)},f.prototype._get=function(d,g,b){this._nextTick(function(){b(new Error("NotFound"))})},f.prototype.getMany=function(d,g,b){if(b=o(g,b),b=i.fromCallback(b),g=l(g),v(this,b))return b.promise;if(!Array.isArray(d))return this._nextTick(b,new Error("getMany() requires an array argument")),b.promise;if(d.length===0)return this._nextTick(b,null,[]),b.promise;typeof g.asBuffer!="boolean"&&(g={...g,asBuffer:!0});let _=new Array(d.length);for(let m=0;m<d.length;m++){let E=d[m],D=this._checkKey(E);if(D)return this._nextTick(b,D),b.promise;_[m]=this._serializeKey(E)}return this._getMany(_,g,b),b.promise},f.prototype._getMany=function(d,g,b){this._nextTick(b,null,new Array(d.length).fill(void 0))},f.prototype.put=function(d,g,b,_){if(typeof b=="function"&&(_=b),typeof _!="function")throw new Error("put() requires a callback argument");let m=this._checkKey(d)||this._checkValue(g);if(m)return this._nextTick(_,m);d=this._serializeKey(d),g=this._serializeValue(g),(typeof b!="object"||b===null)&&(b={}),this._put(d,g,b,_)},f.prototype._put=function(d,g,b,_){this._nextTick(_)},f.prototype.del=function(d,g,b){if(typeof g=="function"&&(b=g),typeof b!="function")throw new Error("del() requires a callback argument");let _=this._checkKey(d);if(_)return this._nextTick(b,_);d=this._serializeKey(d),(typeof g!="object"||g===null)&&(g={}),this._del(d,g,b)},f.prototype._del=function(d,g,b){this._nextTick(b)},f.prototype.batch=function(d,g,b){if(!arguments.length)return this._chainedBatch();if(typeof g=="function"&&(b=g),typeof d=="function"&&(b=d),typeof b!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(d))return this._nextTick(b,new Error("batch(array) requires an array argument"));if(d.length===0)return this._nextTick(b);(typeof g!="object"||g===null)&&(g={});let _=new Array(d.length);for(let m=0;m<d.length;m++){if(typeof d[m]!="object"||d[m]===null)return this._nextTick(b,new Error("batch(array) element must be an object and not `null`"));let E=Object.assign({},d[m]);if(E.type!=="put"&&E.type!=="del")return this._nextTick(b,new Error("`type` must be 'put' or 'del'"));let D=this._checkKey(E.key);if(D)return this._nextTick(b,D);if(E.key=this._serializeKey(E.key),E.type==="put"){let N=this._checkValue(E.value);if(N)return this._nextTick(b,N);E.value=this._serializeValue(E.value)}_[m]=E}this._batch(_,g,b)},f.prototype._batch=function(d,g,b){this._nextTick(b)},f.prototype.clear=function(d,g){if(typeof d=="function")g=d;else if(typeof g!="function")throw new Error("clear() requires a callback argument");d=y(this,d),d.reverse=!!d.reverse,d.limit="limit"in d?d.limit:-1,this._clear(d,g)},f.prototype._clear=function(d,g){d.keys=!0,d.values=!1,d.keyAsBuffer=!0,d.valueAsBuffer=!0;let b=this._iterator(d),_={},m=E=>{if(E)return b.end(function(){g(E)});b.next((D,N)=>{if(D)return m(D);if(N===void 0)return b.end(g);this._del(N,_,m)})};m()},f.prototype._setupIteratorOptions=function(d){return d=y(this,d),d.reverse=!!d.reverse,d.keys=d.keys!==!1,d.values=d.values!==!1,d.limit="limit"in d?d.limit:-1,d.keyAsBuffer=d.keyAsBuffer!==!1,d.valueAsBuffer=d.valueAsBuffer!==!1,d};function y(d,g){let b={};for(let _ in g){if(!u.call(g,_))continue;if(_==="start"||_==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let m=g[_];p(_)&&(m=d._serializeKey(m)),b[_]=m}return b}function p(d){return h.indexOf(d)!==-1}f.prototype.iterator=function(d){return(typeof d!="object"||d===null)&&(d={}),d=this._setupIteratorOptions(d),this._iterator(d)},f.prototype._iterator=function(d){return new s(this)},f.prototype._chainedBatch=function(){return new a(this)},f.prototype._serializeKey=function(d){return d},f.prototype._serializeValue=function(d){return d},f.prototype._checkKey=function(d){if(d==null)return new Error("key cannot be `null` or `undefined`");if(n(d)&&d.length===0)return new Error("key cannot be an empty Buffer");if(d==="")return new Error("key cannot be an empty String");if(Array.isArray(d)&&d.length===0)return new Error("key cannot be an empty Array")},f.prototype._checkValue=function(d){if(d==null)return new Error("value cannot be `null` or `undefined`")},f.prototype.isOperational=function(){return this.status==="open"||this._isOperational()},f.prototype._isOperational=function(){return!1},f.prototype._nextTick=Z8(),t.exports=f;function v(d,g){return d.isOperational()?!1:(d._nextTick(g,new Error("Database is not open")),!0)}}),Zc=A(e=>{"use strict";c(),e.AbstractLevelDOWN=IZ(),e.AbstractIterator=wI(),e.AbstractChainedBatch=EI()}),ni=A((e,t)=>{c(),typeof Object.create=="function"?t.exports=function(r,n){n&&(r.super_=n,r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(r,n){if(n){r.super_=n;var i=function(){};i.prototype=n.prototype,r.prototype=new i,r.prototype.constructor=r}}}),SI=A(e=>{"use strict";c(),e.getCallback=function(t,r,n){let i=t[t.length-1];if(typeof i!="function"){let s=new Promise((a,o)=>{t.push(i=function(l,...u){l?o(l):a(n?n(...u):u[0])})});i[r]=s}return i}}),OZ=A((e,t)=>{"use strict";c();var{AbstractIterator:r}=Zc(),n=ni(),i=SI().getCallback,s=Symbol("options"),a=Symbol("iterator"),o=Symbol("operations"),l=Symbol("promise");function u(h,f){r.call(this,h),this[s]=f,this[a]=null,this[o]=[]}n(u,r),u.prototype.setDb=function(h){this[a]=h.iterator(this[s]);for(let f of this[o].splice(0,this[o].length))this[a][f.method](...f.args)},u.prototype.next=function(...h){if(this.db.status==="open")return this[a].next(...h);let f=i(h,l,function(y,p){if(!(y===void 0&&p===void 0))return[y,p]});return this.db.status==="opening"?this[o].push({method:"next",args:h}):this._nextTick(f,new Error("Database is not open")),f[l]||this},u.prototype.seek=function(...h){if(this.db.status==="open")this[a].seek(...h);else if(this.db.status==="opening")this[o].push({method:"seek",args:h});else throw new Error("Database is not open")},u.prototype.end=function(...h){if(this.db.status==="open")return this[a].end(...h);let f=i(h,l);return this.db.status==="opening"?this[o].push({method:"end",args:h}):this._nextTick(f,new Error("Database is not open")),f[l]||this};for(let h of["next","seek","end"])u.prototype["_"+h]=function(){throw new Error("Did not expect private method to be called: "+h)};t.exports=u}),BZ=A((e,t)=>{"use strict";c();var{AbstractChainedBatch:r}=Zc(),n=Symbol("operations");t.exports=class extends r{constructor(i){super(i),this[n]=[]}_put(i,s,a){this[n].push({...a,type:"put",key:i,value:s})}_del(i,s){this[n].push({...s,type:"del",key:i})}_clear(){this[n]=[]}_write(i,s){this.db.batch(this[n],i,s)}}}),VZ=A((e,t)=>{"use strict";c();var{AbstractLevelDOWN:r}=Zc(),n=ni(),i=OZ(),s=BZ(),a=SI().getCallback,o=["put","get","getMany","del","batch","clear"],l=["approximateSize","compactRange"],u=Symbol("innerDb"),h=Symbol("operations"),f=Symbol("promise");function y(v){r.call(this,v.supports||{});for(let d of l)typeof v[d]=="function"&&!this.supports.additionalMethods[d]&&(this.supports.additionalMethods[d]=!0);this[u]=v,this[h]=[],p(this)}n(y,r),y.prototype.type="deferred-leveldown",Object.defineProperty(y.prototype,"_db",{enumerable:!0,get(){return this[u]}}),y.prototype._open=function(v,d){let g=b=>{if(b||this[u].status!=="open")return d(b||new Error("Database is not open"));let _=this[h];this[h]=[];for(let m of _)m.iterator?m.iterator.setDb(this[u]):this[u][m.method](...m.args);if(this[h].length>0)throw new Error("Did not expect further operations");d()};this[u].status==="new"||this[u].status==="closed"?this[u].open(v,g):this._nextTick(g)},y.prototype._close=function(v){this[u].close(v)},y.prototype._isOperational=function(){return this.status==="opening"};function p(v){let d=Object.keys(v.supports.additionalMethods);for(let g of o.concat(d))v[g]=function(...b){if(g==="batch"&&b.length===0)return new s(this);if(this.status==="open")return this[u][g](...b);let _=a(b,f);return this.status==="opening"?this[h].push({method:g,args:b}):this._nextTick(_,new Error("Database is not open")),_[f]};v.iterator=function(g){if(this.status==="open")return this[u].iterator(g);if(this.status==="opening"){let b=new i(this,g);return this[h].push({iterator:b}),b}else throw new Error("Database is not open")};for(let g of o.concat(["iterator"]))v["_"+g]=function(){throw new Error("Did not expect private method to be called: "+g)}}t.exports=y,t.exports.DeferredIterator=i}),RI=A((e,t)=>{c(),t.exports=In().EventEmitter}),fg=A(()=>{c()}),GZ=A((e,t)=>{"use strict";c();function r(v,d){var g=Object.keys(v);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(v);d&&(b=b.filter(function(_){return Object.getOwnPropertyDescriptor(v,_).enumerable})),g.push.apply(g,b)}return g}function n(v){for(var d=1;d<arguments.length;d++){var g=arguments[d]!=null?arguments[d]:{};d%2?r(Object(g),!0).forEach(function(b){i(v,b,g[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(g)):r(Object(g)).forEach(function(b){Object.defineProperty(v,b,Object.getOwnPropertyDescriptor(g,b))})}return v}function i(v,d,g){return d in v?Object.defineProperty(v,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):v[d]=g,v}function s(v,d){if(!(v instanceof d))throw new TypeError("Cannot call a class as a function")}function a(v,d){for(var g=0;g<d.length;g++){var b=d[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(v,b.key,b)}}function o(v,d,g){return d&&a(v.prototype,d),g&&a(v,g),v}var l=_i(),u=l.Buffer,h=fg(),f=h.inspect,y=f&&f.custom||"inspect";function p(v,d,g){u.prototype.copy.call(v,d,g)}t.exports=function(){function v(){s(this,v),this.head=null,this.tail=null,this.length=0}return o(v,[{key:"push",value:function(d){var g={data:d,next:null};this.length>0?this.tail.next=g:this.head=g,this.tail=g,++this.length}},{key:"unshift",value:function(d){var g={data:d,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}},{key:"shift",value:function(){if(this.length!==0){var d=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,d}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(d){if(this.length===0)return"";for(var g=this.head,b=""+g.data;g=g.next;)b+=d+g.data;return b}},{key:"concat",value:function(d){if(this.length===0)return u.alloc(0);for(var g=u.allocUnsafe(d>>>0),b=this.head,_=0;b;)p(b.data,g,_),_+=b.data.length,b=b.next;return g}},{key:"consume",value:function(d,g){var b;return d<this.head.data.length?(b=this.head.data.slice(0,d),this.head.data=this.head.data.slice(d)):d===this.head.data.length?b=this.shift():b=g?this._getString(d):this._getBuffer(d),b}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(d){var g=this.head,b=1,_=g.data;for(d-=_.length;g=g.next;){var m=g.data,E=d>m.length?m.length:d;if(E===m.length?_+=m:_+=m.slice(0,d),d-=E,d===0){E===m.length?(++b,g.next?this.head=g.next:this.head=this.tail=null):(this.head=g,g.data=m.slice(E));break}++b}return this.length-=b,_}},{key:"_getBuffer",value:function(d){var g=u.allocUnsafe(d),b=this.head,_=1;for(b.data.copy(g),d-=b.data.length;b=b.next;){var m=b.data,E=d>m.length?m.length:d;if(m.copy(g,g.length-d,0,E),d-=E,d===0){E===m.length?(++_,b.next?this.head=b.next:this.head=this.tail=null):(this.head=b,b.data=m.slice(E));break}++_}return this.length-=_,g}},{key:y,value:function(d,g){return f(this,n({},g,{depth:0,customInspect:!1}))}}]),v}()}),II=A((e,t)=>{"use strict";c();function r(l,u){var h=this,f=this._readableState&&this._readableState.destroyed,y=this._writableState&&this._writableState.destroyed;return f||y?(u?u(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(a,this,l)):process.nextTick(a,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(p){!u&&p?h._writableState?h._writableState.errorEmitted?process.nextTick(i,h):(h._writableState.errorEmitted=!0,process.nextTick(n,h,p)):process.nextTick(n,h,p):u?(process.nextTick(i,h),u(p)):process.nextTick(i,h)}),this)}function n(l,u){a(l,u),i(l)}function i(l){l._writableState&&!l._writableState.emitClose||l._readableState&&!l._readableState.emitClose||l.emit("close")}function s(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(l,u){l.emit("error",u)}function o(l,u){var h=l._readableState,f=l._writableState;h&&h.autoDestroy||f&&f.autoDestroy?l.destroy(u):l.emit("error",u)}t.exports={destroy:r,undestroy:s,errorOrDestroy:o}}),ed=A((e,t)=>{"use strict";c();function r(u,h){u.prototype=Object.create(h.prototype),u.prototype.constructor=u,u.__proto__=h}var n={};function i(u,h,f){f||(f=Error);function y(v,d,g){return typeof h=="string"?h:h(v,d,g)}var p=function(v){r(d,v);function d(g,b,_){return v.call(this,y(g,b,_))||this}return d}(f);p.prototype.name=f.name,p.prototype.code=u,n[u]=p}function s(u,h){if(Array.isArray(u)){var f=u.length;return u=u.map(function(y){return String(y)}),f>2?"one of ".concat(h," ").concat(u.slice(0,f-1).join(", "),", or ")+u[f-1]:f===2?"one of ".concat(h," ").concat(u[0]," or ").concat(u[1]):"of ".concat(h," ").concat(u[0])}else return"of ".concat(h," ").concat(String(u))}function a(u,h,f){return u.substr(!f||f<0?0:+f,h.length)===h}function o(u,h,f){return(f===void 0||f>u.length)&&(f=u.length),u.substring(f-h.length,f)===h}function l(u,h,f){return typeof f!="number"&&(f=0),f+h.length>u.length?!1:u.indexOf(h,f)!==-1}i("ERR_INVALID_OPT_VALUE",function(u,h){return'The value "'+h+'" is invalid for option "'+u+'"'},TypeError),i("ERR_INVALID_ARG_TYPE",function(u,h,f){var y;typeof h=="string"&&a(h,"not ")?(y="must not be",h=h.replace(/^not /,"")):y="must be";var p;if(o(u," argument"))p="The ".concat(u," ").concat(y," ").concat(s(h,"type"));else{var v=l(u,".")?"property":"argument";p='The "'.concat(u,'" ').concat(v," ").concat(y," ").concat(s(h,"type"))}return p+=". Received type ".concat(typeof f),p},TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n}),CI=A((e,t)=>{"use strict";c();var r=ed().codes.ERR_INVALID_OPT_VALUE;function n(s,a,o){return s.highWaterMark!=null?s.highWaterMark:a?s[o]:null}function i(s,a,o,l){var u=n(a,l,o);if(u!=null){if(!(isFinite(u)&&Math.floor(u)===u)||u<0){var h=l?o:"highWaterMark";throw new r(h,u)}return Math.floor(u)}return s.objectMode?16:16*1024}t.exports={getHighWaterMark:i}}),DI=A((e,t)=>{c(),t.exports=r;function r(i,s){if(n("noDeprecation"))return i;var a=!1;function o(){if(!a){if(n("throwDeprecation"))throw new Error(s);n("traceDeprecation")?console.trace(s):console.warn(s),a=!0}return i.apply(this,arguments)}return o}function n(i){try{if(!globalThis.localStorage)return!1}catch{return!1}var s=globalThis.localStorage[i];return s==null?!1:String(s).toLowerCase()==="true"}}),OI=A((e,t)=>{"use strict";c(),t.exports=O;function r(Z){var le=this;this.next=null,this.entry=null,this.finish=function(){ht(le,Z)}}var n;O.WritableState=T;var i={deprecate:DI()},s=RI(),a=_i().Buffer,o=globalThis.Uint8Array||function(){};function l(Z){return a.from(Z)}function u(Z){return a.isBuffer(Z)||Z instanceof o}var h=II(),f=CI(),y=f.getHighWaterMark,p=ed().codes,v=p.ERR_INVALID_ARG_TYPE,d=p.ERR_METHOD_NOT_IMPLEMENTED,g=p.ERR_MULTIPLE_CALLBACK,b=p.ERR_STREAM_CANNOT_PIPE,_=p.ERR_STREAM_DESTROYED,m=p.ERR_STREAM_NULL_VALUES,E=p.ERR_STREAM_WRITE_AFTER_END,D=p.ERR_UNKNOWN_ENCODING,N=h.errorOrDestroy;ni()(O,s);function R(){}function T(Z,le,ke){n=n||td(),Z=Z||{},typeof ke!="boolean"&&(ke=le instanceof n),this.objectMode=!!Z.objectMode,ke&&(this.objectMode=this.objectMode||!!Z.writableObjectMode),this.highWaterMark=y(this,Z,"writableHighWaterMark",ke),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Ge=Z.decodeStrings===!1;this.decodeStrings=!Ge,this.defaultEncoding=Z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ft){W(le,ft)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Z.emitClose!==!1,this.autoDestroy=!!Z.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}T.prototype.getBuffer=function(){for(var Z=this.bufferedRequest,le=[];Z;)le.push(Z),Z=Z.next;return le},function(){try{Object.defineProperty(T.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var S;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(S=Function.prototype[Symbol.hasInstance],Object.defineProperty(O,Symbol.hasInstance,{value:function(Z){return S.call(this,Z)?!0:this!==O?!1:Z&&Z._writableState instanceof T}})):S=function(Z){return Z instanceof this};function O(Z){n=n||td();var le=this instanceof n;if(!le&&!S.call(O,this))return new O(Z);this._writableState=new T(Z,this,le),this.writable=!0,Z&&(typeof Z.write=="function"&&(this._write=Z.write),typeof Z.writev=="function"&&(this._writev=Z.writev),typeof Z.destroy=="function"&&(this._destroy=Z.destroy),typeof Z.final=="function"&&(this._final=Z.final)),s.call(this)}O.prototype.pipe=function(){N(this,new b)};function F(Z,le){var ke=new E;N(Z,ke),process.nextTick(le,ke)}function G(Z,le,ke,Ge){var ft;return ke===null?ft=new m:typeof ke!="string"&&!le.objectMode&&(ft=new v("chunk",["string","Buffer"],ke)),ft?(N(Z,ft),process.nextTick(Ge,ft),!1):!0}O.prototype.write=function(Z,le,ke){var Ge=this._writableState,ft=!1,yt=!Ge.objectMode&&u(Z);return yt&&!a.isBuffer(Z)&&(Z=l(Z)),typeof le=="function"&&(ke=le,le=null),yt?le="buffer":le||(le=Ge.defaultEncoding),typeof ke!="function"&&(ke=R),Ge.ending?F(this,ke):(yt||G(this,Ge,Z,ke))&&(Ge.pendingcb++,ft=Y(this,Ge,yt,Z,le,ke)),ft},O.prototype.cork=function(){this._writableState.corked++},O.prototype.uncork=function(){var Z=this._writableState;Z.corked&&(Z.corked--,!Z.writing&&!Z.corked&&!Z.bufferProcessing&&Z.bufferedRequest&&Pe(this,Z))},O.prototype.setDefaultEncoding=function(Z){if(typeof Z=="string"&&(Z=Z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Z+"").toLowerCase())>-1))throw new D(Z);return this._writableState.defaultEncoding=Z,this},Object.defineProperty(O.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ne(Z,le,ke){return!Z.objectMode&&Z.decodeStrings!==!1&&typeof le=="string"&&(le=a.from(le,ke)),le}Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Y(Z,le,ke,Ge,ft,yt){if(!ke){var V=ne(le,Ge,ft);Ge!==V&&(ke=!0,ft="buffer",Ge=V)}var z=le.objectMode?1:Ge.length;le.length+=z;var Oe=le.length<le.highWaterMark;if(Oe||(le.needDrain=!0),le.writing||le.corked){var tt=le.lastBufferedRequest;le.lastBufferedRequest={chunk:Ge,encoding:ft,isBuf:ke,callback:yt,next:null},tt?tt.next=le.lastBufferedRequest:le.bufferedRequest=le.lastBufferedRequest,le.bufferedRequestCount+=1}else ce(Z,le,!1,z,Ge,ft,yt);return Oe}function ce(Z,le,ke,Ge,ft,yt,V){le.writelen=Ge,le.writecb=V,le.writing=!0,le.sync=!0,le.destroyed?le.onwrite(new _("write")):ke?Z._writev(ft,le.onwrite):Z._write(ft,yt,le.onwrite),le.sync=!1}function oe(Z,le,ke,Ge,ft){--le.pendingcb,ke?(process.nextTick(ft,Ge),process.nextTick(Ve,Z,le),Z._writableState.errorEmitted=!0,N(Z,Ge)):(ft(Ge),Z._writableState.errorEmitted=!0,N(Z,Ge),Ve(Z,le))}function H(Z){Z.writing=!1,Z.writecb=null,Z.length-=Z.writelen,Z.writelen=0}function W(Z,le){var ke=Z._writableState,Ge=ke.sync,ft=ke.writecb;if(typeof ft!="function")throw new g;if(H(ke),le)oe(Z,ke,Ge,le,ft);else{var yt=$e(ke)||Z.destroyed;!yt&&!ke.corked&&!ke.bufferProcessing&&ke.bufferedRequest&&Pe(Z,ke),Ge?process.nextTick(de,Z,ke,yt,ft):de(Z,ke,yt,ft)}}function de(Z,le,ke,Ge){ke||De(Z,le),le.pendingcb--,Ge(),Ve(Z,le)}function De(Z,le){le.length===0&&le.needDrain&&(le.needDrain=!1,Z.emit("drain"))}function Pe(Z,le){le.bufferProcessing=!0;var ke=le.bufferedRequest;if(Z._writev&&ke&&ke.next){var Ge=le.bufferedRequestCount,ft=new Array(Ge),yt=le.corkedRequestsFree;yt.entry=ke;for(var V=0,z=!0;ke;)ft[V]=ke,ke.isBuf||(z=!1),ke=ke.next,V+=1;ft.allBuffers=z,ce(Z,le,!0,le.length,ft,"",yt.finish),le.pendingcb++,le.lastBufferedRequest=null,yt.next?(le.corkedRequestsFree=yt.next,yt.next=null):le.corkedRequestsFree=new r(le),le.bufferedRequestCount=0}else{for(;ke;){var Oe=ke.chunk,tt=ke.encoding,Ft=ke.callback,Dt=le.objectMode?1:Oe.length;if(ce(Z,le,!1,Dt,Oe,tt,Ft),ke=ke.next,le.bufferedRequestCount--,le.writing)break}ke===null&&(le.lastBufferedRequest=null)}le.bufferedRequest=ke,le.bufferProcessing=!1}O.prototype._write=function(Z,le,ke){ke(new d("_write()"))},O.prototype._writev=null,O.prototype.end=function(Z,le,ke){var Ge=this._writableState;return typeof Z=="function"?(ke=Z,Z=null,le=null):typeof le=="function"&&(ke=le,le=null),Z!=null&&this.write(Z,le),Ge.corked&&(Ge.corked=1,this.uncork()),Ge.ending||et(this,Ge,ke),this},Object.defineProperty(O.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function $e(Z){return Z.ending&&Z.length===0&&Z.bufferedRequest===null&&!Z.finished&&!Z.writing}function Be(Z,le){Z._final(function(ke){le.pendingcb--,ke&&N(Z,ke),le.prefinished=!0,Z.emit("prefinish"),Ve(Z,le)})}function nt(Z,le){!le.prefinished&&!le.finalCalled&&(typeof Z._final=="function"&&!le.destroyed?(le.pendingcb++,le.finalCalled=!0,process.nextTick(Be,Z,le)):(le.prefinished=!0,Z.emit("prefinish")))}function Ve(Z,le){var ke=$e(le);if(ke&&(nt(Z,le),le.pendingcb===0&&(le.finished=!0,Z.emit("finish"),le.autoDestroy))){var Ge=Z._readableState;(!Ge||Ge.autoDestroy&&Ge.endEmitted)&&Z.destroy()}return ke}function et(Z,le,ke){le.ending=!0,Ve(Z,le),ke&&(le.finished?process.nextTick(ke):Z.once("finish",ke)),le.ended=!0,Z.writable=!1}function ht(Z,le,ke){var Ge=Z.entry;for(Z.entry=null;Ge;){var ft=Ge.callback;le.pendingcb--,ft(ke),Ge=Ge.next}le.corkedRequestsFree.next=Z}Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Z){!this._writableState||(this._writableState.destroyed=Z)}}),O.prototype.destroy=h.destroy,O.prototype._undestroy=h.undestroy,O.prototype._destroy=function(Z,le){le(Z)}}),td=A((e,t)=>{"use strict";c();var r=Object.keys||function(f){var y=[];for(var p in f)y.push(p);return y};t.exports=l;var n=MI(),i=OI();for(ni()(l,n),s=r(i.prototype),o=0;o<s.length;o++)a=s[o],l.prototype[a]||(l.prototype[a]=i.prototype[a]);var s,a,o;function l(f){if(!(this instanceof l))return new l(f);n.call(this,f),i.call(this,f),this.allowHalfOpen=!0,f&&(f.readable===!1&&(this.readable=!1),f.writable===!1&&(this.writable=!1),f.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",u)))}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function u(){this._writableState.ended||process.nextTick(h,this)}function h(f){f.end()}Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(f){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=f,this._writableState.destroyed=f)}})}),lJ=A((e,t)=>{c();var r=_i(),n=r.Buffer;function i(a,o){for(var l in a)o[l]=a[l]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(i(r,e),e.Buffer=s);function s(a,o,l){return n(a,o,l)}i(n,s),s.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return n(a,o,l)},s.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var u=n(a);return o!==void 0?typeof l=="string"?u.fill(o,l):u.fill(o):u.fill(0),u},s.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n(a)},s.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(a)}}),mg=A(e=>{"use strict";c();var t=lJ().Buffer,r=t.isEncoding||function(_){switch(_=""+_,_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(_){if(!_)return"utf8";for(var m;;)switch(_){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return _;default:if(m)return;_=(""+_).toLowerCase(),m=!0}}function i(_){var m=n(_);if(typeof m!="string"&&(t.isEncoding===r||!r(_)))throw new Error("Unknown encoding: "+_);return m||_}e.StringDecoder=s;function s(_){this.encoding=i(_);var m;switch(this.encoding){case"utf16le":this.text=y,this.end=p,m=4;break;case"utf8":this.fillLast=u,m=4;break;case"base64":this.text=v,this.end=d,m=3;break;default:this.write=g,this.end=b;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(m)}s.prototype.write=function(_){if(_.length===0)return"";var m,E;if(this.lastNeed){if(m=this.fillLast(_),m===void 0)return"";E=this.lastNeed,this.lastNeed=0}else E=0;return E<_.length?m?m+this.text(_,E):this.text(_,E):m||""},s.prototype.end=f,s.prototype.text=h,s.prototype.fillLast=function(_){if(this.lastNeed<=_.length)return _.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,this.lastTotal-this.lastNeed,0,_.length),this.lastNeed-=_.length};function a(_){return _<=127?0:_>>5===6?2:_>>4===14?3:_>>3===30?4:_>>6===2?-1:-2}function o(_,m,E){var D=m.length-1;if(D<E)return 0;var N=a(m[D]);return N>=0?(N>0&&(_.lastNeed=N-1),N):--D<E||N===-2?0:(N=a(m[D]),N>=0?(N>0&&(_.lastNeed=N-2),N):--D<E||N===-2?0:(N=a(m[D]),N>=0?(N>0&&(N===2?N=0:_.lastNeed=N-3),N):0))}function l(_,m,E){if((m[0]&192)!==128)return _.lastNeed=0,"\uFFFD";if(_.lastNeed>1&&m.length>1){if((m[1]&192)!==128)return _.lastNeed=1,"\uFFFD";if(_.lastNeed>2&&m.length>2&&(m[2]&192)!==128)return _.lastNeed=2,"\uFFFD"}}function u(_){var m=this.lastTotal-this.lastNeed,E=l(this,_,m);if(E!==void 0)return E;if(this.lastNeed<=_.length)return _.copy(this.lastChar,m,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,m,0,_.length),this.lastNeed-=_.length}function h(_,m){var E=o(this,_,m);if(!this.lastNeed)return _.toString("utf8",m);this.lastTotal=E;var D=_.length-(E-this.lastNeed);return _.copy(this.lastChar,0,D),_.toString("utf8",m,D)}function f(_){var m=_&&_.length?this.write(_):"";return this.lastNeed?m+"\uFFFD":m}function y(_,m){if((_.length-m)%2===0){var E=_.toString("utf16le",m);if(E){var D=E.charCodeAt(E.length-1);if(D>=55296&&D<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1],E.slice(0,-1)}return E}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=_[_.length-1],_.toString("utf16le",m,_.length-1)}function p(_){var m=_&&_.length?this.write(_):"";if(this.lastNeed){var E=this.lastTotal-this.lastNeed;return m+this.lastChar.toString("utf16le",0,E)}return m}function v(_,m){var E=(_.length-m)%3;return E===0?_.toString("base64",m):(this.lastNeed=3-E,this.lastTotal=3,E===1?this.lastChar[0]=_[_.length-1]:(this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1]),_.toString("base64",m,_.length-E))}function d(_){var m=_&&_.length?this.write(_):"";return this.lastNeed?m+this.lastChar.toString("base64",0,3-this.lastNeed):m}function g(_){return _.toString(this.encoding)}function b(_){return _&&_.length?this.write(_):""}}),cE=A((e,t)=>{"use strict";c();var r=ed().codes.ERR_STREAM_PREMATURE_CLOSE;function n(o){var l=!1;return function(){if(!l){l=!0;for(var u=arguments.length,h=new Array(u),f=0;f<u;f++)h[f]=arguments[f];o.apply(this,h)}}}function i(){}function s(o){return o.setHeader&&typeof o.abort=="function"}function a(o,l,u){if(typeof l=="function")return a(o,null,l);l||(l={}),u=n(u||i);var h=l.readable||l.readable!==!1&&o.readable,f=l.writable||l.writable!==!1&&o.writable,y=function(){o.writable||v()},p=o._writableState&&o._writableState.finished,v=function(){f=!1,p=!0,h||u.call(o)},d=o._readableState&&o._readableState.endEmitted,g=function(){h=!1,d=!0,f||u.call(o)},b=function(E){u.call(o,E)},_=function(){var E;if(h&&!d)return(!o._readableState||!o._readableState.ended)&&(E=new r),u.call(o,E);if(f&&!p)return(!o._writableState||!o._writableState.ended)&&(E=new r),u.call(o,E)},m=function(){o.req.on("finish",v)};return s(o)?(o.on("complete",v),o.on("abort",_),o.req?m():o.on("request",m)):f&&!o._writableState&&(o.on("end",y),o.on("close",y)),o.on("end",g),o.on("finish",v),l.error!==!1&&o.on("error",b),o.on("close",_),function(){o.removeListener("complete",v),o.removeListener("abort",_),o.removeListener("request",m),o.req&&o.req.removeListener("finish",v),o.removeListener("end",y),o.removeListener("close",y),o.removeListener("finish",v),o.removeListener("end",g),o.removeListener("error",b),o.removeListener("close",_)}}t.exports=a}),gJ=A((e,t)=>{"use strict";c();var r;function n(m,E,D){return E in m?Object.defineProperty(m,E,{value:D,enumerable:!0,configurable:!0,writable:!0}):m[E]=D,m}var i=cE(),s=Symbol("lastResolve"),a=Symbol("lastReject"),o=Symbol("error"),l=Symbol("ended"),u=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function y(m,E){return{value:m,done:E}}function p(m){var E=m[s];if(E!==null){var D=m[f].read();D!==null&&(m[u]=null,m[s]=null,m[a]=null,E(y(D,!1)))}}function v(m){process.nextTick(p,m)}function d(m,E){return function(D,N){m.then(function(){if(E[l]){D(y(void 0,!0));return}E[h](D,N)},N)}}var g=Object.getPrototypeOf(function(){}),b=Object.setPrototypeOf((r={get stream(){return this[f]},next:function(){var m=this,E=this[o];if(E!==null)return Promise.reject(E);if(this[l])return Promise.resolve(y(void 0,!0));if(this[f].destroyed)return new Promise(function(T,S){process.nextTick(function(){m[o]?S(m[o]):T(y(void 0,!0))})});var D=this[u],N;if(D)N=new Promise(d(D,this));else{var R=this[f].read();if(R!==null)return Promise.resolve(y(R,!1));N=new Promise(this[h])}return this[u]=N,N}},n(r,Symbol.asyncIterator,function(){return this}),n(r,"return",function(){var m=this;return new Promise(function(E,D){m[f].destroy(null,function(N){if(N){D(N);return}E(y(void 0,!0))})})}),r),g),_=function(m){var E,D=Object.create(b,(E={},n(E,f,{value:m,writable:!0}),n(E,s,{value:null,writable:!0}),n(E,a,{value:null,writable:!0}),n(E,o,{value:null,writable:!0}),n(E,l,{value:m._readableState.endEmitted,writable:!0}),n(E,h,{value:function(N,R){var T=D[f].read();T?(D[u]=null,D[s]=null,D[a]=null,N(y(T,!1))):(D[s]=N,D[a]=R)},writable:!0}),E));return D[u]=null,i(m,function(N){if(N&&N.code!=="ERR_STREAM_PREMATURE_CLOSE"){var R=D[a];R!==null&&(D[u]=null,D[s]=null,D[a]=null,R(N)),D[o]=N;return}var T=D[s];T!==null&&(D[u]=null,D[s]=null,D[a]=null,T(y(void 0,!0))),D[l]=!0}),m.on("readable",v.bind(null,D)),D};t.exports=_}),EJ=A((e,t)=>{c(),t.exports=function(){throw new Error("Readable.from is not available in the browser")}}),MI=A((e,t)=>{"use strict";c(),t.exports=G;var r;G.ReadableState=F;var n=In().EventEmitter,i=function(V,z){return V.listeners(z).length},s=RI(),a=_i().Buffer,o=globalThis.Uint8Array||function(){};function l(V){return a.from(V)}function u(V){return a.isBuffer(V)||V instanceof o}var h=fg(),f;h&&h.debuglog?f=h.debuglog("stream"):f=function(){};var y=GZ(),p=II(),v=CI(),d=v.getHighWaterMark,g=ed().codes,b=g.ERR_INVALID_ARG_TYPE,_=g.ERR_STREAM_PUSH_AFTER_EOF,m=g.ERR_METHOD_NOT_IMPLEMENTED,E=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,D,N,R;ni()(G,s);var T=p.errorOrDestroy,S=["error","close","destroy","pause","resume"];function O(V,z,Oe){if(typeof V.prependListener=="function")return V.prependListener(z,Oe);!V._events||!V._events[z]?V.on(z,Oe):Array.isArray(V._events[z])?V._events[z].unshift(Oe):V._events[z]=[Oe,V._events[z]]}function F(V,z,Oe){r=r||td(),V=V||{},typeof Oe!="boolean"&&(Oe=z instanceof r),this.objectMode=!!V.objectMode,Oe&&(this.objectMode=this.objectMode||!!V.readableObjectMode),this.highWaterMark=d(this,V,"readableHighWaterMark",Oe),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=V.emitClose!==!1,this.autoDestroy=!!V.autoDestroy,this.destroyed=!1,this.defaultEncoding=V.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,V.encoding&&(D||(D=mg().StringDecoder),this.decoder=new D(V.encoding),this.encoding=V.encoding)}function G(V){if(r=r||td(),!(this instanceof G))return new G(V);var z=this instanceof r;this._readableState=new F(V,this,z),this.readable=!0,V&&(typeof V.read=="function"&&(this._read=V.read),typeof V.destroy=="function"&&(this._destroy=V.destroy)),s.call(this)}Object.defineProperty(G.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(V){!this._readableState||(this._readableState.destroyed=V)}}),G.prototype.destroy=p.destroy,G.prototype._undestroy=p.undestroy,G.prototype._destroy=function(V,z){z(V)},G.prototype.push=function(V,z){var Oe=this._readableState,tt;return Oe.objectMode?tt=!0:typeof V=="string"&&(z=z||Oe.defaultEncoding,z!==Oe.encoding&&(V=a.from(V,z),z=""),tt=!0),ne(this,V,z,!1,tt)},G.prototype.unshift=function(V){return ne(this,V,null,!0,!1)};function ne(V,z,Oe,tt,Ft){f("readableAddChunk",z);var Dt=V._readableState;if(z===null)Dt.reading=!1,de(V,Dt);else{var Lt;if(Ft||(Lt=ce(Dt,z)),Lt)T(V,Lt);else if(Dt.objectMode||z&&z.length>0)if(typeof z!="string"&&!Dt.objectMode&&Object.getPrototypeOf(z)!==a.prototype&&(z=l(z)),tt)Dt.endEmitted?T(V,new E):Y(V,Dt,z,!0);else if(Dt.ended)T(V,new _);else{if(Dt.destroyed)return!1;Dt.reading=!1,Dt.decoder&&!Oe?(z=Dt.decoder.write(z),Dt.objectMode||z.length!==0?Y(V,Dt,z,!1):$e(V,Dt)):Y(V,Dt,z,!1)}else tt||(Dt.reading=!1,$e(V,Dt))}return!Dt.ended&&(Dt.length<Dt.highWaterMark||Dt.length===0)}function Y(V,z,Oe,tt){z.flowing&&z.length===0&&!z.sync?(z.awaitDrain=0,V.emit("data",Oe)):(z.length+=z.objectMode?1:Oe.length,tt?z.buffer.unshift(Oe):z.buffer.push(Oe),z.needReadable&&De(V)),$e(V,z)}function ce(V,z){var Oe;return!u(z)&&typeof z!="string"&&z!==void 0&&!V.objectMode&&(Oe=new b("chunk",["string","Buffer","Uint8Array"],z)),Oe}G.prototype.isPaused=function(){return this._readableState.flowing===!1},G.prototype.setEncoding=function(V){D||(D=mg().StringDecoder);var z=new D(V);this._readableState.decoder=z,this._readableState.encoding=this._readableState.decoder.encoding;for(var Oe=this._readableState.buffer.head,tt="";Oe!==null;)tt+=z.write(Oe.data),Oe=Oe.next;return this._readableState.buffer.clear(),tt!==""&&this._readableState.buffer.push(tt),this._readableState.length=tt.length,this};var oe=1073741824;function H(V){return V>=oe?V=oe:(V--,V|=V>>>1,V|=V>>>2,V|=V>>>4,V|=V>>>8,V|=V>>>16,V++),V}function W(V,z){return V<=0||z.length===0&&z.ended?0:z.objectMode?1:V!==V?z.flowing&&z.length?z.buffer.head.data.length:z.length:(V>z.highWaterMark&&(z.highWaterMark=H(V)),V<=z.length?V:z.ended?z.length:(z.needReadable=!0,0))}G.prototype.read=function(V){f("read",V),V=parseInt(V,10);var z=this._readableState,Oe=V;if(V!==0&&(z.emittedReadable=!1),V===0&&z.needReadable&&((z.highWaterMark!==0?z.length>=z.highWaterMark:z.length>0)||z.ended))return f("read: emitReadable",z.length,z.ended),z.length===0&&z.ended?Ge(this):De(this),null;if(V=W(V,z),V===0&&z.ended)return z.length===0&&Ge(this),null;var tt=z.needReadable;f("need readable",tt),(z.length===0||z.length-V<z.highWaterMark)&&(tt=!0,f("length less than watermark",tt)),z.ended||z.reading?(tt=!1,f("reading or ended",tt)):tt&&(f("do read"),z.reading=!0,z.sync=!0,z.length===0&&(z.needReadable=!0),this._read(z.highWaterMark),z.sync=!1,z.reading||(V=W(Oe,z)));var Ft;return V>0?Ft=ke(V,z):Ft=null,Ft===null?(z.needReadable=z.length<=z.highWaterMark,V=0):(z.length-=V,z.awaitDrain=0),z.length===0&&(z.ended||(z.needReadable=!0),Oe!==V&&z.ended&&Ge(this)),Ft!==null&&this.emit("data",Ft),Ft};function de(V,z){if(f("onEofChunk"),!z.ended){if(z.decoder){var Oe=z.decoder.end();Oe&&Oe.length&&(z.buffer.push(Oe),z.length+=z.objectMode?1:Oe.length)}z.ended=!0,z.sync?De(V):(z.needReadable=!1,z.emittedReadable||(z.emittedReadable=!0,Pe(V)))}}function De(V){var z=V._readableState;f("emitReadable",z.needReadable,z.emittedReadable),z.needReadable=!1,z.emittedReadable||(f("emitReadable",z.flowing),z.emittedReadable=!0,process.nextTick(Pe,V))}function Pe(V){var z=V._readableState;f("emitReadable_",z.destroyed,z.length,z.ended),!z.destroyed&&(z.length||z.ended)&&(V.emit("readable"),z.emittedReadable=!1),z.needReadable=!z.flowing&&!z.ended&&z.length<=z.highWaterMark,le(V)}function $e(V,z){z.readingMore||(z.readingMore=!0,process.nextTick(Be,V,z))}function Be(V,z){for(;!z.reading&&!z.ended&&(z.length<z.highWaterMark||z.flowing&&z.length===0);){var Oe=z.length;if(f("maybeReadMore read 0"),V.read(0),Oe===z.length)break}z.readingMore=!1}G.prototype._read=function(V){T(this,new m("_read()"))},G.prototype.pipe=function(V,z){var Oe=this,tt=this._readableState;switch(tt.pipesCount){case 0:tt.pipes=V;break;case 1:tt.pipes=[tt.pipes,V];break;default:tt.pipes.push(V);break}tt.pipesCount+=1,f("pipe count=%d opts=%j",tt.pipesCount,z);var Ft=(!z||z.end!==!1)&&V!==process.stdout&&V!==process.stderr,Dt=Ft?$t:J;tt.endEmitted?process.nextTick(Dt):Oe.once("end",Dt),V.on("unpipe",Lt);function Lt(ge,Le){f("onunpipe"),ge===Oe&&Le&&Le.hasUnpiped===!1&&(Le.hasUnpiped=!0,Cr())}function $t(){f("onend"),V.end()}var Wt=nt(Oe);V.on("drain",Wt);var lr=!1;function Cr(){f("cleanup"),V.removeListener("close",x),V.removeListener("finish",$),V.removeListener("drain",Wt),V.removeListener("error",Sr),V.removeListener("unpipe",Lt),Oe.removeListener("end",$t),Oe.removeListener("end",J),Oe.removeListener("data",sr),lr=!0,tt.awaitDrain&&(!V._writableState||V._writableState.needDrain)&&Wt()}Oe.on("data",sr);function sr(ge){f("ondata");var Le=V.write(ge);f("dest.write",Le),Le===!1&&((tt.pipesCount===1&&tt.pipes===V||tt.pipesCount>1&&yt(tt.pipes,V)!==-1)&&!lr&&(f("false write response, pause",tt.awaitDrain),tt.awaitDrain++),Oe.pause())}function Sr(ge){f("onerror",ge),J(),V.removeListener("error",Sr),i(V,"error")===0&&T(V,ge)}O(V,"error",Sr);function x(){V.removeListener("finish",$),J()}V.once("close",x);function $(){f("onfinish"),V.removeListener("close",x),J()}V.once("finish",$);function J(){f("unpipe"),Oe.unpipe(V)}return V.emit("pipe",Oe),tt.flowing||(f("pipe resume"),Oe.resume()),V};function nt(V){return function(){var z=V._readableState;f("pipeOnDrain",z.awaitDrain),z.awaitDrain&&z.awaitDrain--,z.awaitDrain===0&&i(V,"data")&&(z.flowing=!0,le(V))}}G.prototype.unpipe=function(V){var z=this._readableState,Oe={hasUnpiped:!1};if(z.pipesCount===0)return this;if(z.pipesCount===1)return V&&V!==z.pipes?this:(V||(V=z.pipes),z.pipes=null,z.pipesCount=0,z.flowing=!1,V&&V.emit("unpipe",this,Oe),this);if(!V){var tt=z.pipes,Ft=z.pipesCount;z.pipes=null,z.pipesCount=0,z.flowing=!1;for(var Dt=0;Dt<Ft;Dt++)tt[Dt].emit("unpipe",this,{hasUnpiped:!1});return this}var Lt=yt(z.pipes,V);return Lt===-1?this:(z.pipes.splice(Lt,1),z.pipesCount-=1,z.pipesCount===1&&(z.pipes=z.pipes[0]),V.emit("unpipe",this,Oe),this)},G.prototype.on=function(V,z){var Oe=s.prototype.on.call(this,V,z),tt=this._readableState;return V==="data"?(tt.readableListening=this.listenerCount("readable")>0,tt.flowing!==!1&&this.resume()):V==="readable"&&!tt.endEmitted&&!tt.readableListening&&(tt.readableListening=tt.needReadable=!0,tt.flowing=!1,tt.emittedReadable=!1,f("on readable",tt.length,tt.reading),tt.length?De(this):tt.reading||process.nextTick(et,this)),Oe},G.prototype.addListener=G.prototype.on,G.prototype.removeListener=function(V,z){var Oe=s.prototype.removeListener.call(this,V,z);return V==="readable"&&process.nextTick(Ve,this),Oe},G.prototype.removeAllListeners=function(V){var z=s.prototype.removeAllListeners.apply(this,arguments);return(V==="readable"||V===void 0)&&process.nextTick(Ve,this),z};function Ve(V){var z=V._readableState;z.readableListening=V.listenerCount("readable")>0,z.resumeScheduled&&!z.paused?z.flowing=!0:V.listenerCount("data")>0&&V.resume()}function et(V){f("readable nexttick read 0"),V.read(0)}G.prototype.resume=function(){var V=this._readableState;return V.flowing||(f("resume"),V.flowing=!V.readableListening,ht(this,V)),V.paused=!1,this};function ht(V,z){z.resumeScheduled||(z.resumeScheduled=!0,process.nextTick(Z,V,z))}function Z(V,z){f("resume",z.reading),z.reading||V.read(0),z.resumeScheduled=!1,V.emit("resume"),le(V),z.flowing&&!z.reading&&V.read(0)}G.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function le(V){var z=V._readableState;for(f("flow",z.flowing);z.flowing&&V.read()!==null;);}G.prototype.wrap=function(V){var z=this,Oe=this._readableState,tt=!1;V.on("end",function(){if(f("wrapped end"),Oe.decoder&&!Oe.ended){var Lt=Oe.decoder.end();Lt&&Lt.length&&z.push(Lt)}z.push(null)}),V.on("data",function(Lt){if(f("wrapped data"),Oe.decoder&&(Lt=Oe.decoder.write(Lt)),!(Oe.objectMode&&Lt==null)&&!(!Oe.objectMode&&(!Lt||!Lt.length))){var $t=z.push(Lt);$t||(tt=!0,V.pause())}});for(var Ft in V)this[Ft]===void 0&&typeof V[Ft]=="function"&&(this[Ft]=function(Lt){return function(){return V[Lt].apply(V,arguments)}}(Ft));for(var Dt=0;Dt<S.length;Dt++)V.on(S[Dt],this.emit.bind(this,S[Dt]));return this._read=function(Lt){f("wrapped _read",Lt),tt&&(tt=!1,V.resume())},this},typeof Symbol=="function"&&(G.prototype[Symbol.asyncIterator]=function(){return N===void 0&&(N=gJ()),N(this)}),Object.defineProperty(G.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(G.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(G.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(V){this._readableState&&(this._readableState.flowing=V)}}),G._fromList=ke,Object.defineProperty(G.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function ke(V,z){if(z.length===0)return null;var Oe;return z.objectMode?Oe=z.buffer.shift():!V||V>=z.length?(z.decoder?Oe=z.buffer.join(""):z.buffer.length===1?Oe=z.buffer.first():Oe=z.buffer.concat(z.length),z.buffer.clear()):Oe=z.buffer.consume(V,z.decoder),Oe}function Ge(V){var z=V._readableState;f("endReadable",z.endEmitted),z.endEmitted||(z.ended=!0,process.nextTick(ft,z,V))}function ft(V,z){if(f("endReadableNT",V.endEmitted,V.length),!V.endEmitted&&V.length===0&&(V.endEmitted=!0,z.readable=!1,z.emit("end"),V.autoDestroy)){var Oe=z._writableState;(!Oe||Oe.autoDestroy&&Oe.finished)&&z.destroy()}}typeof Symbol=="function"&&(G.from=function(V,z){return R===void 0&&(R=EJ()),R(G,V,z)});function yt(V,z){for(var Oe=0,tt=V.length;Oe<tt;Oe++)if(V[Oe]===z)return Oe;return-1}}),XI=A((e,t)=>{"use strict";c(),t.exports=u;var r=ed().codes,n=r.ERR_METHOD_NOT_IMPLEMENTED,i=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,o=td();ni()(u,o);function l(y,p){var v=this._transformState;v.transforming=!1;var d=v.writecb;if(d===null)return this.emit("error",new i);v.writechunk=null,v.writecb=null,p!=null&&this.push(p),d(y);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function u(y){if(!(this instanceof u))return new u(y);o.call(this,y),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&(typeof y.transform=="function"&&(this._transform=y.transform),typeof y.flush=="function"&&(this._flush=y.flush)),this.on("prefinish",h)}function h(){var y=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(p,v){f(y,p,v)}):f(this,null,null)}u.prototype.push=function(y,p){return this._transformState.needTransform=!1,o.prototype.push.call(this,y,p)},u.prototype._transform=function(y,p,v){v(new n("_transform()"))},u.prototype._write=function(y,p,v){var d=this._transformState;if(d.writecb=v,d.writechunk=y,d.writeencoding=p,!d.transforming){var g=this._readableState;(d.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},u.prototype._read=function(y){var p=this._transformState;p.writechunk!==null&&!p.transforming?(p.transforming=!0,this._transform(p.writechunk,p.writeencoding,p.afterTransform)):p.needTransform=!0},u.prototype._destroy=function(y,p){o.prototype._destroy.call(this,y,function(v){p(v)})};function f(y,p,v){if(p)return y.emit("error",p);if(v!=null&&y.push(v),y._writableState.length)throw new a;if(y._transformState.transforming)throw new s;return y.push(null)}}),OJ=A((e,t)=>{"use strict";c(),t.exports=n;var r=XI();ni()(n,r);function n(i){if(!(this instanceof n))return new n(i);r.call(this,i)}n.prototype._transform=function(i,s,a){a(null,i)}}),FJ=A((e,t)=>{"use strict";c();var r;function n(v){var d=!1;return function(){d||(d=!0,v.apply(void 0,arguments))}}var i=ed().codes,s=i.ERR_MISSING_ARGS,a=i.ERR_STREAM_DESTROYED;function o(v){if(v)throw v}function l(v){return v.setHeader&&typeof v.abort=="function"}function u(v,d,g,b){b=n(b);var _=!1;v.on("close",function(){_=!0}),r===void 0&&(r=cE()),r(v,{readable:d,writable:g},function(E){if(E)return b(E);_=!0,b()});var m=!1;return function(E){if(!_&&!m){if(m=!0,l(v))return v.abort();if(typeof v.destroy=="function")return v.destroy();b(E||new a("pipe"))}}}function h(v){v()}function f(v,d){return v.pipe(d)}function y(v){return!v.length||typeof v[v.length-1]!="function"?o:v.pop()}function p(){for(var v=arguments.length,d=new Array(v),g=0;g<v;g++)d[g]=arguments[g];var b=y(d);if(Array.isArray(d[0])&&(d=d[0]),d.length<2)throw new s("streams");var _,m=d.map(function(E,D){var N=D<d.length-1,R=D>0;return u(E,N,R,function(T){_||(_=T),T&&m.forEach(h),!N&&(m.forEach(h),b(_))})});return d.reduce(f)}t.exports=p}),VJ=A((e,t)=>{c(),e=t.exports=MI(),e.Stream=e,e.Readable=e,e.Writable=OI(),e.Duplex=td(),e.Transform=XI(),e.PassThrough=OJ(),e.finished=cE(),e.pipeline=FJ()}),HJ=A((e,t)=>{"use strict";c();var r=ni(),{Readable:n}=VJ();t.exports=i,r(i,n);function i(s,a){if(!(this instanceof i))return new i(s,a);a=a||{},n.call(this,Object.assign({},a,{objectMode:!0})),this._iterator=s,this._options=a,this.on("end",this.destroy.bind(this,null,null))}i.prototype._read=function(){this.destroyed||this._iterator.next((s,a,o)=>{if(!this.destroyed){if(s)return this.destroy(s);a===void 0&&o===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(a):this._options.keys===!1&&this._options.values!==!1?this.push(o):this.push({key:a,value:o})}})},i.prototype._destroy=function(s,a){this._iterator.end(function(o){a(s||o)})}}),gE=A((e,t)=>{"use strict";c();function r(i,s){let a=function(o,l){if(typeof o=="object"&&o!==null&&(l=l||o,o=o.message||o.name),o=o||"",l=l||void 0,typeof l=="object"&&l.type===i&&l.message===o)return l;Object.defineProperty(this,"type",{value:i,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"name",{value:i,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"cause",{value:l,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"message",{value:o,enumerable:!1,writable:!0,configurable:!0}),Error.call(this),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,a)};return a.prototype=new s,a}var n=r("LevelUPError",Error);t.exports={LevelUPError:n,InitializationError:r("InitializationError",n),OpenError:r("OpenError",n),ReadError:r("ReadError",n),WriteError:r("WriteError",n),NotFoundError:r("NotFoundError",n),EncodingError:r("EncodingError",n)},t.exports.NotFoundError.prototype.notFound=!0,t.exports.NotFoundError.prototype.status=404}),bg=A(e=>{"use strict";c(),e.getCallback=function(t,r){return typeof t=="function"?t:r},e.getOptions=function(t){return typeof t=="object"&&t!==null?t:{}}}),GJ=A((e,t)=>{"use strict";c();var r=gE().WriteError,n=Q8(),i=bg().getCallback,s=bg().getOptions;function a(o){this.db=o,this.batch=o.db.batch(),this.ops=[],this.length=0}a.prototype.put=function(o,l,u){try{this.batch.put(o,l,u)}catch(h){throw new r(h)}return this.ops.push({...u,type:"put",key:o,value:l}),this.length++,this},a.prototype.del=function(o,l){try{this.batch.del(o,l)}catch(u){throw new r(u)}return this.ops.push({...l,type:"del",key:o}),this.length++,this},a.prototype.clear=function(){try{this.batch.clear()}catch(o){throw new r(o)}return this.ops=[],this.length=0,this},a.prototype.write=function(o,l){let u=this.db,h=this.ops;l=i(o,l),l=n.fromCallback(l),o=s(o);try{this.batch.write(o,function(f){if(f)return l(new r(f));u.emit("batch",h),l()})}catch(f){throw new r(f)}return l.promise},t.exports=a}),YJ=A((e,t)=>{"use strict";c();var r=X8();t.exports=function(n,...i){i.length===0?r(n):r(()=>n(...i))}}),ZJ=A((e,t)=>{"use strict";c();var r=In().EventEmitter,n=fZ().inherits,i=VZ(),s=HJ(),a=GJ(),o=gE(),l=yI(),u=Q8(),h=bg().getCallback,f=bg().getOptions,y=YJ(),p=o.WriteError,v=o.ReadError,d=o.NotFoundError,g=o.OpenError,b=o.InitializationError;function _(E,D,N){if(!(this instanceof _))return new _(E,D,N);let R;if(r.call(this),this.setMaxListeners(1/0),typeof D=="function"&&(N=D,D={}),D=D||{},!E||typeof E!="object"){if(R=new b("First argument must be an abstract-leveldown compliant store"),typeof N=="function")return y(N,R);throw R}if(typeof E.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=f(D),this._db=E,this.db=null,this.open(N||(T=>{T&&this.emit("error",T)})),this.supports=l(this.db.supports,{status:!0,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let T of Object.keys(this.supports.additionalMethods))this[T]==null&&(this[T]=function(...S){return this.db[T](...S)})}_.prototype.emit=r.prototype.emit,_.prototype.once=r.prototype.once,n(_,r),Object.defineProperty(_.prototype,"status",{enumerable:!0,get(){return this.db.status}}),_.prototype.isOperational=function(){return this.db.status==="open"||this.db.status==="opening"},_.prototype.open=function(E,D){return typeof E=="function"&&(D=E,E=null),D=u.fromCallback(D),E||(E=this.options),this.db&&this.isOpen()?(y(D,null,this),D.promise):this.db&&this._isOpening()?(this.once("open",()=>{D(null,this)}),D.promise):(this.db=new i(this._db),this.emit("opening"),this.db.open(E,N=>{if(N)return D(new g(N));this.db=this._db,D(null,this),this.emit("open"),this.emit("ready")}),D.promise)},_.prototype.close=function(E){return E=u.fromCallback(E),this.isOpen()?(this.db.close((D,...N)=>{this.emit("closed"),E(D,...N)}),this.emit("closing")):this.isClosed()?y(E):this.db.status==="closing"?this.once("closed",E):this._isOpening()&&this.once("open",()=>{this.close(E)}),E.promise},_.prototype.isOpen=function(){return this.db.status==="open"},_.prototype._isOpening=function(){return this.db.status==="opening"},_.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)},_.prototype.get=function(E,D,N){return N=h(D,N),N=u.fromCallback(N),m(this,N)||(D=f(D),this.db.get(E,D,function(R,T){if(R)return/notfound/i.test(R)||R.notFound?R=new d("Key not found in database ["+E+"]",R):R=new v(R),N(R);N(null,T)})),N.promise},_.prototype.getMany=function(E,D,N){return this.db.getMany(E,D,N)},_.prototype.put=function(E,D,N,R){return R=h(N,R),R=u.fromCallback(R),m(this,R)||(N=f(N),this.db.put(E,D,N,T=>{if(T)return R(new p(T));this.emit("put",E,D),R()})),R.promise},_.prototype.del=function(E,D,N){return N=h(D,N),N=u.fromCallback(N),m(this,N)||(D=f(D),this.db.del(E,D,R=>{if(R)return N(new p(R));this.emit("del",E),N()})),N.promise},_.prototype.batch=function(E,D,N){return arguments.length?(typeof E=="function"?N=E:N=h(D,N),N=u.fromCallback(N),m(this,N)||(D=f(D),this.db.batch(E,D,R=>{if(R)return N(new p(R));this.emit("batch",E),N()})),N.promise):new a(this)},_.prototype.iterator=function(E){return this.db.iterator(E)},_.prototype.clear=function(E,D){return D=h(E,D),E=f(E),D=u.fromCallback(D),m(this,D)||this.db.clear(E,N=>{if(N)return D(new p(N));this.emit("clear",E),D()}),D.promise},_.prototype.readStream=_.prototype.createReadStream=function(E){return E=Object.assign({keys:!0,values:!0},E),typeof E.limit!="number"&&(E.limit=-1),new s(this.db.iterator(E),E)},_.prototype.keyStream=_.prototype.createKeyStream=function(E){return this.createReadStream(Object.assign({},E,{keys:!0,values:!1}))},_.prototype.valueStream=_.prototype.createValueStream=function(E){return this.createReadStream(Object.assign({},E,{keys:!1,values:!0}))},_.prototype.toString=function(){return"LevelUP"},_.prototype.type="levelup",_.prototype._nextTick=y;function m(E,D){return E.isOperational()?!1:(y(D,new v("Database is not open")),!0)}_.errors=o,t.exports=_}),JJ=A(e=>{"use strict";c();var{Buffer:t}=_i();e.utf8=e["utf-8"]={encode:function(s){return i(s)?s:String(s)},decode:n,buffer:!1,type:"utf8"},e.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},e.binary={encode:function(s){return i(s)?s:t.from(s)},decode:n,buffer:!0,type:"binary"},e.none={encode:n,decode:n,buffer:!1,type:"id"},e.id=e.none;var r=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let s of r)e[s]={encode:function(a){return i(a)?a:t.from(a,s)},decode:function(a){return a.toString(s)},buffer:!0,type:s};function n(s){return s}function i(s){return s==null||t.isBuffer(s)}}),tee=A((e,t)=>{"use strict";c();var r=JJ(),n=new Set(["lt","gt","lte","gte"]);t.exports=i;function i(s){if(!(this instanceof i))return new i(s);this.opts=s||{},this.encodings=r}i.prototype._encoding=function(s){return typeof s=="string"&&(s=r[s]),s||(s=r.id),s},i.prototype._keyEncoding=function(s,a){return this._encoding(a&&a.keyEncoding||s&&s.keyEncoding||this.opts.keyEncoding)},i.prototype._valueEncoding=function(s,a){return this._encoding(a&&(a.valueEncoding||a.encoding)||s&&(s.valueEncoding||s.encoding)||this.opts.valueEncoding||this.opts.encoding)},i.prototype.encodeKey=function(s,a,o){return this._keyEncoding(a,o).encode(s)},i.prototype.encodeValue=function(s,a,o){return this._valueEncoding(a,o).encode(s)},i.prototype.decodeKey=function(s,a){return this._keyEncoding(a).decode(s)},i.prototype.decodeValue=function(s,a){return this._valueEncoding(a).decode(s)},i.prototype.encodeBatch=function(s,a){return s.map(o=>{let l={type:o.type,key:this.encodeKey(o.key,a,o)};return this.keyAsBuffer(a,o)&&(l.keyEncoding="binary"),o.prefix&&(l.prefix=o.prefix),"value"in o&&(l.value=this.encodeValue(o.value,a,o),this.valueAsBuffer(a,o)&&(l.valueEncoding="binary")),l})},i.prototype.encodeLtgt=function(s){let a={};for(let o of Object.keys(s)){if(o==="start"||o==="end")throw new Error('Legacy range options ("start" and "end") have been removed');a[o]=n.has(o)?this.encodeKey(s[o],s):s[o]}return a},i.prototype.createStreamDecoder=function(s){return s.keys&&s.values?(a,o)=>({key:this.decodeKey(a,s),value:this.decodeValue(o,s)}):s.keys?a=>this.decodeKey(a,s):s.values?(a,o)=>this.decodeValue(o,s):function(){}},i.prototype.keyAsBuffer=function(s){return this._keyEncoding(s).buffer},i.prototype.valueAsBuffer=function(s){return this._valueEncoding(s).buffer}}),see=A((e,t)=>{"use strict";c();var r=Zc().AbstractLevelDOWN,n=Zc().AbstractChainedBatch,i=Zc().AbstractIterator,s=ni(),a=tee(),o=gE().EncodingError,l=["approximateSize","compactRange"];t.exports=u;function u(y,p){if(!(this instanceof u))return new u(y,p);let v=y.supports||{},d=v.additionalMethods||{};r.call(this,v),this.supports.encodings=!0,this.supports.additionalMethods={},l.forEach(function(g){let b=typeof y[g]=="function";(d[g]||b)&&(this.supports.additionalMethods[g]=!0,this[g]=function(_,m,E,D){return _=this.codec.encodeKey(_,E),m=this.codec.encodeKey(m,E),this.db[g](_,m,E,D)})},this),p=p||{},typeof p.keyEncoding>"u"&&(p.keyEncoding="utf8"),typeof p.valueEncoding>"u"&&(p.valueEncoding="utf8"),this.db=y,this.codec=new a(p)}s(u,r),u.prototype.type="encoding-down",u.prototype._serializeKey=u.prototype._serializeValue=function(y){return y},u.prototype._open=function(y,p){this.db.open(y,p)},u.prototype._close=function(y){this.db.close(y)},u.prototype._put=function(y,p,v,d){y=this.codec.encodeKey(y,v),p=this.codec.encodeValue(p,v),this.db.put(y,p,v,d)},u.prototype._get=function(y,p,v){y=this.codec.encodeKey(y,p),p.asBuffer=this.codec.valueAsBuffer(p),this.db.get(y,p,(d,g)=>{if(d)return v(d);try{g=this.codec.decodeValue(g,p)}catch(b){return v(new o(b))}v(null,g)})},u.prototype._getMany=function(y,p,v){y=y.map(d=>this.codec.encodeKey(d,p)),p.asBuffer=this.codec.valueAsBuffer(p),this.db.getMany(y,p,(d,g)=>{if(d)return v(d);let b=new Array(g.length);for(let _=0;_<g.length;_++){if(g[_]===void 0){b[_]=void 0;continue}try{b[_]=this.codec.decodeValue(g[_],p)}catch(m){return v(new o(m))}}v(null,b)})},u.prototype._del=function(y,p,v){y=this.codec.encodeKey(y,p),this.db.del(y,p,v)},u.prototype._chainedBatch=function(){return new f(this)},u.prototype._batch=function(y,p,v){y=this.codec.encodeBatch(y,p),this.db.batch(y,p,v)},u.prototype._iterator=function(y){return y.keyAsBuffer=this.codec.keyAsBuffer(y),y.valueAsBuffer=this.codec.valueAsBuffer(y),new h(this,y)},u.prototype._clear=function(y,p){y=this.codec.encodeLtgt(y),this.db.clear(y,p)};function h(y,p){i.call(this,y),this.codec=y.codec,this.keys=p.keys,this.values=p.values,this.opts=this.codec.encodeLtgt(p),this.it=y.db.iterator(this.opts)}s(h,i),h.prototype._next=function(y){this.it.next((p,v,d)=>{if(p)return y(p);try{this.keys&&typeof v<"u"?v=this.codec.decodeKey(v,this.opts):v=void 0,this.values&&typeof d<"u"?d=this.codec.decodeValue(d,this.opts):d=void 0}catch(g){return y(new o(g))}y(null,v,d)})},h.prototype._seek=function(y){y=this.codec.encodeKey(y,this.opts),this.it.seek(y)},h.prototype._end=function(y){this.it.end(y)};function f(y,p){n.call(this,y),this.codec=y.codec,this.batch=y.db.batch()}s(f,n),f.prototype._put=function(y,p,v){y=this.codec.encodeKey(y,v),p=this.codec.encodeValue(p,v),this.batch.put(y,p)},f.prototype._del=function(y,p){y=this.codec.encodeKey(y,p),this.batch.del(y)},f.prototype._clear=function(){this.batch.clear()},f.prototype._write=function(y,p){this.batch.write(y,p)}}),uee=A((e,t)=>{"use strict";c();var r=ZJ(),n=see();function i(s){function a(l,u,h){return typeof l=="function"?h=l:typeof u=="function"&&(h=u),o(u)||(u=o(l)?l:{}),r(n(s(l,u),u),u,h)}function o(l){return typeof l=="object"&&l!==null}for(let l of["destroy","repair"])typeof s[l]=="function"&&(a[l]=function(...u){s[l](...u)});return a.errors=r.errors,a}t.exports=i}),fee=A((e,t)=>{c(),t.exports=n;var r=X8();function n(i,s,a){if(typeof s!="number")throw new Error("second argument must be a Number");let o,l,u,h,f,y=!0,p;Array.isArray(i)?(o=[],u=l=i.length):(h=Object.keys(i),o={},u=l=h.length);function v(g){function b(){a&&a(g,o),a=null}y?r(b):b()}function d(g,b,_){if(o[g]=_,b&&(f=!0),--u===0||b)v(b);else if(!f&&p<l){let m;h?(m=h[p],p+=1,i[m](function(E,D){d(m,E,D)})):(m=p,p+=1,i[m](function(E,D){d(m,E,D)}))}}p=s,u?h?h.some(function(g,b){return i[g](function(_,m){d(g,_,m)}),b===s-1}):i.some(function(g,b){return g(function(_,m){d(b,_,m)}),b===s-1}):v(null),y=!1}}),dee=A(e=>{c(),e.compare=function(p,v){if(Buffer.isBuffer(p)){for(var d=Math.min(p.length,v.length),g=0;g<d;g++){var b=p[g]-v[g];if(b)return b}return p.length-v.length}return p<v?-1:p>v?1:0};function t(p){return p!==void 0&&p!==""}function r(p,v){return Object.hasOwnProperty.call(p,v)}function n(p,v){return Object.hasOwnProperty.call(p,v)&&v}var i=e.lowerBoundKey=function(p){return n(p,"gt")||n(p,"gte")||n(p,"min")||(p.reverse?n(p,"end"):n(p,"start"))||void 0},s=e.lowerBound=function(p,v){var d=i(p);return d?p[d]:v},a=e.lowerBoundInclusive=function(p){return!r(p,"gt")},o=e.upperBoundInclusive=function(p){return!r(p,"lt")},l=e.lowerBoundExclusive=function(p){return!a(p)},u=e.upperBoundExclusive=function(p){return!o(p)},h=e.upperBoundKey=function(p){return n(p,"lt")||n(p,"lte")||n(p,"max")||(p.reverse?n(p,"start"):n(p,"end"))||void 0},f=e.upperBound=function(p,v){var d=h(p);return d?p[d]:v};e.start=function(p,v){return p.reverse?f(p,v):s(p,v)},e.end=function(p,v){return p.reverse?s(p,v):f(p,v)},e.startInclusive=function(p){return p.reverse?o(p):a(p)},e.endInclusive=function(p){return p.reverse?a(p):o(p)};function y(p){return p}e.toLtgt=function(p,v,d,g,b){v=v||{},d=d||y;var _=arguments.length>3,m=e.lowerBoundKey(p),E=e.upperBoundKey(p);return m?m==="gt"?v.gt=d(p.gt,!1):v.gte=d(p[m],!1):_&&(v.gte=d(g,!1)),E?E==="lt"?v.lt=d(p.lt,!0):v.lte=d(p[E],!0):_&&(v.lte=d(b,!0)),p.reverse!=null&&(v.reverse=!!p.reverse),r(v,"max")&&delete v.max,r(v,"min")&&delete v.min,r(v,"start")&&delete v.start,r(v,"end")&&delete v.end,v},e.contains=function(p,v,d){d=d||e.compare;var g=s(p);if(t(g)){var b=d(v,g);if(b<0||b===0&&l(p))return!1}var _=f(p);if(t(_)){var b=d(v,_);if(b>0||b===0&&u(p))return!1}return!0},e.filter=function(p,v){return function(d){return e.contains(p,d,v)}}}),uC=A((e,t)=>{"use strict";c();var r=dee(),n=Symbol("none");t.exports=function(i){let s=r.lowerBound(i,n),a=r.upperBound(i,n),o=r.lowerBoundExclusive(i,n),l=r.upperBoundExclusive(i,n);return s!==n&&a!==n?IDBKeyRange.bound(s,a,o,l):s!==n?IDBKeyRange.lowerBound(s,o):a!==n?IDBKeyRange.upperBound(a,l):null}}),lC=A((e,t)=>{"use strict";c();var r=_i().Buffer,n=function(){if(globalThis.TextDecoder){let a=new TextDecoder("utf-8");return a.decode.bind(a)}else return function(a){return s(a).toString()}}(),i=function(){if(globalThis.TextDecoder){let a=new TextDecoder("utf-8");return a.decode.bind(a)}else return function(a){return r.from(a).toString()}}();function s(a){let o=r.from(a.buffer);return a.byteLength===a.buffer.byteLength?o:o.slice(a.byteOffset,a.byteOffset+a.byteLength)}t.exports=function(a,o){return a instanceof Uint8Array?o?s(a):n(a):a instanceof ArrayBuffer?o?r.from(a):i(a):o?r.from(String(a)):String(a)}}),bee=A((e,t)=>{"use strict";c();var r=ni(),n=Zc().AbstractIterator,i=uC(),s=lC(),a=function(){};t.exports=o;function o(l,u,h){if(n.call(this,l),this._limit=h.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=h.keys,this._values=h.values,this._keyAsBuffer=h.keyAsBuffer,this._valueAsBuffer=h.valueAsBuffer,this._limit===0){this._completed=!0;return}let f;try{f=i(h)}catch{this._completed=!0;return}this.createIterator(u,f,h.reverse)}r(o,n),o.prototype.createIterator=function(l,u,h){let f=this.db.db.transaction([l],"readonly"),y=f.objectStore(l).openCursor(u,h?"prev":"next");y.onsuccess=p=>{let v=p.target.result;v&&this.onItem(v)},this._transaction=f,f.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},f.oncomplete=()=>{this.onComplete()}},o.prototype.onItem=function(l){this._cache.push(l.key,l.value),(this._limit<=0||++this._count<this._limit)&&l.continue(),this.maybeNext()},o.prototype.onAbort=function(l){this._aborted=!0,this._error=l,this.maybeNext()},o.prototype.onComplete=function(){this._completed=!0,this.maybeNext()},o.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)},o.prototype._next=function(l){if(this._aborted){let u=this._error;this._error=null,this._nextTick(l,u)}else if(this._cache.length>0){let u=this._cache.shift(),h=this._cache.shift();this._keys&&u!==void 0?u=this._deserializeKey(u,this._keyAsBuffer):u=void 0,this._values&&h!==void 0?h=this._deserializeValue(h,this._valueAsBuffer):h=void 0,this._nextTick(l,null,u,h)}else this._completed?this._nextTick(l):this._callback=l},o.prototype._deserializeKey=s,o.prototype._deserializeValue=s,o.prototype._end=function(l){if(this._aborted||this._completed)return this._nextTick(l,this._error);this.onItem=a,this.onAbort=l,this.onComplete=l}}),See=A((e,t)=>{"use strict";c();var r=_i().Buffer,n=function(){if(globalThis.TextEncoder){let i=new TextEncoder("utf-8");return i.encode.bind(i)}else return r.from}();t.exports=function(i,s){return s?r.isBuffer(i)?i:n(String(i)):String(i)}}),xee=A(e=>{"use strict";c();var t=_i().Buffer;e.test=function(r){return function(n){try{return n.cmp(r,0),!0}catch{return!1}}},e.bufferKeys=e.test(t.alloc(0))}),Aee=A((e,t)=>{"use strict";c(),t.exports=function(r,n,i,s,a){if(s.limit===0)return r._nextTick(a);let o=r.db.transaction([n],"readwrite"),l=o.objectStore(n),u=0;o.oncomplete=function(){a()},o.onabort=function(){a(o.error||new Error("aborted by user"))};let h=l.openKeyCursor?"openKeyCursor":"openCursor",f=s.reverse?"prev":"next";l[h](i,f).onsuccess=function(y){let p=y.target.result;p&&(l.delete(p.key).onsuccess=function(){(s.limit<=0||++u<s.limit)&&p.continue()})}}}),Dee=A((e,t)=>{"use strict";c(),t.exports=y;var r=Zc().AbstractLevelDOWN,n=ni(),i=fee(),s=bee(),a=See(),o=lC(),l=xee(),u=Aee(),h=uC(),f="level-js-";function y(p,v){if(!(this instanceof y))return new y(p,v);if(r.call(this,{bufferKeys:l.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0,getMany:!0}),v=v||{},typeof p!="string")throw new Error("constructor requires a location string argument");this.location=p,this.prefix=v.prefix==null?f:v.prefix,this.version=parseInt(v.version||1,10)}n(y,r),y.prototype.type="level-js",y.prototype._open=function(p,v){let d=indexedDB.open(this.prefix+this.location,this.version);d.onerror=function(){v(d.error||new Error("unknown error"))},d.onsuccess=()=>{this.db=d.result,v()},d.onupgradeneeded=g=>{let b=g.target.result;b.objectStoreNames.contains(this.location)||b.createObjectStore(this.location)}},y.prototype.store=function(p){return this.db.transaction([this.location],p).objectStore(this.location)},y.prototype.await=function(p,v){let d=p.transaction;d.onabort=function(){v(d.error||new Error("aborted by user"))},d.oncomplete=function(){v(null,p.result)}},y.prototype._get=function(p,v,d){let g=this.store("readonly"),b;try{b=g.get(p)}catch(_){return this._nextTick(d,_)}this.await(b,function(_,m){if(_)return d(_);if(m===void 0)return d(new Error("NotFound"));d(null,o(m,v.asBuffer))})},y.prototype._getMany=function(p,v,d){let g=v.asBuffer,b=this.store("readonly"),_=p.map(m=>E=>{let D;try{D=b.get(m)}catch(N){return E(N)}D.onsuccess=()=>{let N=D.result;E(null,N===void 0?N:o(N,g))},D.onerror=N=>{N.stopPropagation(),E(D.error)}});i(_,16,d)},y.prototype._del=function(p,v,d){let g=this.store("readwrite"),b;try{b=g.delete(p)}catch(_){return this._nextTick(d,_)}this.await(b,d)},y.prototype._put=function(p,v,d,g){let b=this.store("readwrite"),_;try{_=b.put(v,p)}catch(m){return this._nextTick(g,m)}this.await(_,g)},y.prototype._serializeKey=function(p){return a(p,this.supports.bufferKeys)},y.prototype._serializeValue=function(p){return a(p,!0)},y.prototype._iterator=function(p){return new s(this,this.location,p)},y.prototype._batch=function(p,v,d){if(p.length===0)return this._nextTick(d);let g=this.store("readwrite"),b=g.transaction,_=0,m;b.onabort=function(){d(m||b.error||new Error("aborted by user"))},b.oncomplete=function(){d()};function E(){let D=p[_++],N=D.key,R;try{R=D.type==="del"?g.delete(N):g.put(D.value,N)}catch(T){m=T,b.abort();return}_<p.length&&(R.onsuccess=E)}E()},y.prototype._clear=function(p,v){let d,g;try{d=h(p)}catch{return this._nextTick(v)}if(p.limit>=0)return u(this,this.location,d,p,v);try{let b=this.store("readwrite");g=d?b.delete(d):b.clear()}catch(b){return this._nextTick(v,b)}this.await(g,v)},y.prototype._close=function(p){this.db.close(),this._nextTick(p)},y.prototype.upgrade=function(p){if(this.status!=="open")return this._nextTick(p,new Error("cannot upgrade() before open()"));let v=this.iterator(),d={},g=this;v._deserializeKey=v._deserializeValue=E,b();function b(D){if(D)return m(D);v.next(_)}function _(D,N,R){if(D||N===void 0)return m(D);let T=g._serializeKey(o(N,!0)),S=g._serializeValue(o(R,!0));g._batch([{type:"del",key:N},{type:"put",key:T,value:S}],d,b)}function m(D){v.end(function(N){p(D||N)})}function E(D){return D}},y.destroy=function(p,v,d){typeof v=="function"&&(d=v,v=f);let g=indexedDB.deleteDatabase(v+p);g.onsuccess=function(){d()},g.onerror=function(b){d(b)}}}),Nee=A((e,t)=>{c(),t.exports=uee()(Dee())}),Mee=A((e,t)=>{c();var r=d0();t.exports=n=>{n=n||{};let i;typeof n=="function"?(i=n,n={}):i=n.onEnd;let s=new r,a,o,l,u=()=>{if(!s.isEmpty()){if(n.writev){let _,m=[];for(;!s.isEmpty();){if(_=s.shift(),_.error)throw _.error;m.push(_.value)}return{done:_.done,value:m}}let b=s.shift();if(b.error)throw b.error;return b}return l?{done:!0}:new Promise((b,_)=>{o=m=>(o=null,m.error?_(m.error):n.writev&&!m.done?b({done:m.done,value:[m.value]}):b(m),a)})},h=b=>o?o(b):(s.push(b),a),f=b=>(s=new r,o?o({error:b}):(s.push({error:b}),a)),y=b=>l?a:h({done:!1,value:b}),p=b=>l?a:(l=!0,b?f(b):h({done:!0})),v=()=>(s=new r,p(),{done:!0}),d=b=>(p(b),{done:!0});if(a={[Symbol.asyncIterator](){return this},next:u,return:v,throw:d,push:y,end:p},!i)return a;let g=a;return a={[Symbol.asyncIterator](){return this},next(){return g.next()},throw(b){return g.throw(b),i&&(i(b),i=null),{done:!0}},return(){return g.return(),i&&(i(),i=null),{done:!0}},push:y,end(b){return g.end(b),i&&(i(b),i=null),a}},a}}),lte=A((e,t)=>{"use strict";c();function r(n,s){var s=s||{};this._head=0,this._tail=0,this._capacity=s.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(n)&&this._fromArray(n)}r.prototype.peekAt=function(n){var i=n;if(i===(i|0)){var s=this.size();if(!(i>=s||i<-s))return i<0&&(i+=s),i=this._head+i&this._capacityMask,this._list[i]}},r.prototype.get=function(n){return this.peekAt(n)},r.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},r.prototype.peekFront=function(){return this.peek()},r.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(r.prototype,"length",{get:function(){return this.size()}}),r.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},r.prototype.unshift=function(n){if(n===void 0)return this.size();var i=this._list.length;return this._head=this._head-1+i&this._capacityMask,this._list[this._head]=n,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},r.prototype.shift=function(){var n=this._head;if(n!==this._tail){var i=this._list[n];return this._list[n]=void 0,this._head=n+1&this._capacityMask,n<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),i}},r.prototype.push=function(n){if(n===void 0)return this.size();var i=this._tail;return this._list[i]=n,this._tail=i+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},r.prototype.pop=function(){var n=this._tail;if(n!==this._head){var i=this._list.length;this._tail=n-1+i&this._capacityMask;var s=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&n>1e4&&n<=i>>>2&&this._shrinkArray(),s}},r.prototype.removeOne=function(n){var i=n;if(i===(i|0)&&this._head!==this._tail){var s=this.size(),a=this._list.length;if(!(i>=s||i<-s)){i<0&&(i+=s),i=this._head+i&this._capacityMask;var o=this._list[i],l;if(n<s/2){for(l=n;l>0;l--)this._list[i]=this._list[i=i-1+a&this._capacityMask];this._list[i]=void 0,this._head=this._head+1+a&this._capacityMask}else{for(l=s-1-n;l>0;l--)this._list[i]=this._list[i=i+1+a&this._capacityMask];this._list[i]=void 0,this._tail=this._tail-1+a&this._capacityMask}return o}}},r.prototype.remove=function(n,i){var s=n,a,o=i;if(s===(s|0)&&this._head!==this._tail){var l=this.size(),u=this._list.length;if(!(s>=l||s<-l||i<1)){if(s<0&&(s+=l),i===1||!i)return a=new Array(1),a[0]=this.removeOne(s),a;if(s===0&&s+i>=l)return a=this.toArray(),this.clear(),a;s+i>l&&(i=l-s);var h;for(a=new Array(i),h=0;h<i;h++)a[h]=this._list[this._head+s+h&this._capacityMask];if(s=this._head+s&this._capacityMask,n+i===l){for(this._tail=this._tail-i+u&this._capacityMask,h=i;h>0;h--)this._list[s=s+1+u&this._capacityMask]=void 0;return a}if(n===0){for(this._head=this._head+i+u&this._capacityMask,h=i-1;h>0;h--)this._list[s=s+1+u&this._capacityMask]=void 0;return a}if(s<l/2){for(this._head=this._head+n+i+u&this._capacityMask,h=n;h>0;h--)this.unshift(this._list[s=s-1+u&this._capacityMask]);for(s=this._head-1+u&this._capacityMask;o>0;)this._list[s=s-1+u&this._capacityMask]=void 0,o--;n<0&&(this._tail=s)}else{for(this._tail=s,s=s+i+u&this._capacityMask,h=l-(i+n);h>0;h--)this.push(this._list[s++]);for(s=this._tail;o>0;)this._list[s=s+1+u&this._capacityMask]=void 0,o--}return this._head<2&&this._tail>1e4&&this._tail<=u>>>2&&this._shrinkArray(),a}}},r.prototype.splice=function(n,i){var s=n;if(s===(s|0)){var a=this.size();if(s<0&&(s+=a),!(s>a))if(arguments.length>2){var o,l,u,h=arguments.length,f=this._list.length,y=2;if(!a||s<a/2){for(l=new Array(s),o=0;o<s;o++)l[o]=this._list[this._head+o&this._capacityMask];for(i===0?(u=[],s>0&&(this._head=this._head+s+f&this._capacityMask)):(u=this.remove(s,i),this._head=this._head+s+f&this._capacityMask);h>y;)this.unshift(arguments[--h]);for(o=s;o>0;o--)this.unshift(l[o-1])}else{l=new Array(a-(s+i));var p=l.length;for(o=0;o<p;o++)l[o]=this._list[this._head+s+i+o&this._capacityMask];for(i===0?(u=[],s!=a&&(this._tail=this._head+s+f&this._capacityMask)):(u=this.remove(s,i),this._tail=this._tail-p+f&this._capacityMask);y<h;)this.push(arguments[y++]);for(o=0;o<p;o++)this.push(l[o])}return u}else return this.remove(s,i)}},r.prototype.clear=function(){this._head=0,this._tail=0},r.prototype.isEmpty=function(){return this._head===this._tail},r.prototype.toArray=function(){return this._copyArray(!1)},r.prototype._fromArray=function(n){for(var i=0;i<n.length;i++)this.push(n[i])},r.prototype._copyArray=function(n){var i=[],s=this._list,a=s.length,o;if(n||this._head>this._tail){for(o=this._head;o<a;o++)i.push(s[o]);for(o=0;o<this._tail;o++)i.push(s[o])}else for(o=this._head;o<this._tail;o++)i.push(s[o]);return i},r.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1},r.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},t.exports=r}),AC=A((e,t)=>{c(),t.exports=In().EventEmitter}),wte=A((e,t)=>{"use strict";c();function r(v,d){var g=Object.keys(v);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(v);d&&(b=b.filter(function(_){return Object.getOwnPropertyDescriptor(v,_).enumerable})),g.push.apply(g,b)}return g}function n(v){for(var d=1;d<arguments.length;d++){var g=arguments[d]!=null?arguments[d]:{};d%2?r(Object(g),!0).forEach(function(b){i(v,b,g[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(g)):r(Object(g)).forEach(function(b){Object.defineProperty(v,b,Object.getOwnPropertyDescriptor(g,b))})}return v}function i(v,d,g){return d in v?Object.defineProperty(v,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):v[d]=g,v}function s(v,d){if(!(v instanceof d))throw new TypeError("Cannot call a class as a function")}function a(v,d){for(var g=0;g<d.length;g++){var b=d[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(v,b.key,b)}}function o(v,d,g){return d&&a(v.prototype,d),g&&a(v,g),v}var l=_i(),u=l.Buffer,h=fg(),f=h.inspect,y=f&&f.custom||"inspect";function p(v,d,g){u.prototype.copy.call(v,d,g)}t.exports=function(){function v(){s(this,v),this.head=null,this.tail=null,this.length=0}return o(v,[{key:"push",value:function(d){var g={data:d,next:null};this.length>0?this.tail.next=g:this.head=g,this.tail=g,++this.length}},{key:"unshift",value:function(d){var g={data:d,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}},{key:"shift",value:function(){if(this.length!==0){var d=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,d}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(d){if(this.length===0)return"";for(var g=this.head,b=""+g.data;g=g.next;)b+=d+g.data;return b}},{key:"concat",value:function(d){if(this.length===0)return u.alloc(0);for(var g=u.allocUnsafe(d>>>0),b=this.head,_=0;b;)p(b.data,g,_),_+=b.data.length,b=b.next;return g}},{key:"consume",value:function(d,g){var b;return d<this.head.data.length?(b=this.head.data.slice(0,d),this.head.data=this.head.data.slice(d)):d===this.head.data.length?b=this.shift():b=g?this._getString(d):this._getBuffer(d),b}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(d){var g=this.head,b=1,_=g.data;for(d-=_.length;g=g.next;){var m=g.data,E=d>m.length?m.length:d;if(E===m.length?_+=m:_+=m.slice(0,d),d-=E,d===0){E===m.length?(++b,g.next?this.head=g.next:this.head=this.tail=null):(this.head=g,g.data=m.slice(E));break}++b}return this.length-=b,_}},{key:"_getBuffer",value:function(d){var g=u.allocUnsafe(d),b=this.head,_=1;for(b.data.copy(g),d-=b.data.length;b=b.next;){var m=b.data,E=d>m.length?m.length:d;if(m.copy(g,g.length-d,0,E),d-=E,d===0){E===m.length?(++_,b.next?this.head=b.next:this.head=this.tail=null):(this.head=b,b.data=m.slice(E));break}++_}return this.length-=_,g}},{key:y,value:function(d,g){return f(this,n({},g,{depth:0,customInspect:!1}))}}]),v}()}),CC=A((e,t)=>{"use strict";c();function r(l,u){var h=this,f=this._readableState&&this._readableState.destroyed,y=this._writableState&&this._writableState.destroyed;return f||y?(u?u(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(a,this,l)):process.nextTick(a,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(p){!u&&p?h._writableState?h._writableState.errorEmitted?process.nextTick(i,h):(h._writableState.errorEmitted=!0,process.nextTick(n,h,p)):process.nextTick(n,h,p):u?(process.nextTick(i,h),u(p)):process.nextTick(i,h)}),this)}function n(l,u){a(l,u),i(l)}function i(l){l._writableState&&!l._writableState.emitClose||l._readableState&&!l._readableState.emitClose||l.emit("close")}function s(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(l,u){l.emit("error",u)}function o(l,u){var h=l._readableState,f=l._writableState;h&&h.autoDestroy||f&&f.autoDestroy?l.destroy(u):l.emit("error",u)}t.exports={destroy:r,undestroy:s,errorOrDestroy:o}}),hd=A((e,t)=>{"use strict";c();function r(u,h){u.prototype=Object.create(h.prototype),u.prototype.constructor=u,u.__proto__=h}var n={};function i(u,h,f){f||(f=Error);function y(v,d,g){return typeof h=="string"?h:h(v,d,g)}var p=function(v){r(d,v);function d(g,b,_){return v.call(this,y(g,b,_))||this}return d}(f);p.prototype.name=f.name,p.prototype.code=u,n[u]=p}function s(u,h){if(Array.isArray(u)){var f=u.length;return u=u.map(function(y){return String(y)}),f>2?"one of ".concat(h," ").concat(u.slice(0,f-1).join(", "),", or ")+u[f-1]:f===2?"one of ".concat(h," ").concat(u[0]," or ").concat(u[1]):"of ".concat(h," ").concat(u[0])}else return"of ".concat(h," ").concat(String(u))}function a(u,h,f){return u.substr(!f||f<0?0:+f,h.length)===h}function o(u,h,f){return(f===void 0||f>u.length)&&(f=u.length),u.substring(f-h.length,f)===h}function l(u,h,f){return typeof f!="number"&&(f=0),f+h.length>u.length?!1:u.indexOf(h,f)!==-1}i("ERR_INVALID_OPT_VALUE",function(u,h){return'The value "'+h+'" is invalid for option "'+u+'"'},TypeError),i("ERR_INVALID_ARG_TYPE",function(u,h,f){var y;typeof h=="string"&&a(h,"not ")?(y="must not be",h=h.replace(/^not /,"")):y="must be";var p;if(o(u," argument"))p="The ".concat(u," ").concat(y," ").concat(s(h,"type"));else{var v=l(u,".")?"property":"argument";p='The "'.concat(u,'" ').concat(v," ").concat(y," ").concat(s(h,"type"))}return p+=". Received type ".concat(typeof f),p},TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n}),PC=A((e,t)=>{"use strict";c();var r=hd().codes.ERR_INVALID_OPT_VALUE;function n(s,a,o){return s.highWaterMark!=null?s.highWaterMark:a?s[o]:null}function i(s,a,o,l){var u=n(a,l,o);if(u!=null){if(!(isFinite(u)&&Math.floor(u)===u)||u<0){var h=l?o:"highWaterMark";throw new r(h,u)}return Math.floor(u)}return s.objectMode?16:16*1024}t.exports={getHighWaterMark:i}}),NC=A((e,t)=>{"use strict";c(),t.exports=O;function r(Z){var le=this;this.next=null,this.entry=null,this.finish=function(){ht(le,Z)}}var n;O.WritableState=T;var i={deprecate:DI()},s=AC(),a=_i().Buffer,o=globalThis.Uint8Array||function(){};function l(Z){return a.from(Z)}function u(Z){return a.isBuffer(Z)||Z instanceof o}var h=CC(),f=PC(),y=f.getHighWaterMark,p=hd().codes,v=p.ERR_INVALID_ARG_TYPE,d=p.ERR_METHOD_NOT_IMPLEMENTED,g=p.ERR_MULTIPLE_CALLBACK,b=p.ERR_STREAM_CANNOT_PIPE,_=p.ERR_STREAM_DESTROYED,m=p.ERR_STREAM_NULL_VALUES,E=p.ERR_STREAM_WRITE_AFTER_END,D=p.ERR_UNKNOWN_ENCODING,N=h.errorOrDestroy;ni()(O,s);function R(){}function T(Z,le,ke){n=n||dd(),Z=Z||{},typeof ke!="boolean"&&(ke=le instanceof n),this.objectMode=!!Z.objectMode,ke&&(this.objectMode=this.objectMode||!!Z.writableObjectMode),this.highWaterMark=y(this,Z,"writableHighWaterMark",ke),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Ge=Z.decodeStrings===!1;this.decodeStrings=!Ge,this.defaultEncoding=Z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ft){W(le,ft)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Z.emitClose!==!1,this.autoDestroy=!!Z.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}T.prototype.getBuffer=function(){for(var Z=this.bufferedRequest,le=[];Z;)le.push(Z),Z=Z.next;return le},function(){try{Object.defineProperty(T.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var S;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(S=Function.prototype[Symbol.hasInstance],Object.defineProperty(O,Symbol.hasInstance,{value:function(Z){return S.call(this,Z)?!0:this!==O?!1:Z&&Z._writableState instanceof T}})):S=function(Z){return Z instanceof this};function O(Z){n=n||dd();var le=this instanceof n;if(!le&&!S.call(O,this))return new O(Z);this._writableState=new T(Z,this,le),this.writable=!0,Z&&(typeof Z.write=="function"&&(this._write=Z.write),typeof Z.writev=="function"&&(this._writev=Z.writev),typeof Z.destroy=="function"&&(this._destroy=Z.destroy),typeof Z.final=="function"&&(this._final=Z.final)),s.call(this)}O.prototype.pipe=function(){N(this,new b)};function F(Z,le){var ke=new E;N(Z,ke),process.nextTick(le,ke)}function G(Z,le,ke,Ge){var ft;return ke===null?ft=new m:typeof ke!="string"&&!le.objectMode&&(ft=new v("chunk",["string","Buffer"],ke)),ft?(N(Z,ft),process.nextTick(Ge,ft),!1):!0}O.prototype.write=function(Z,le,ke){var Ge=this._writableState,ft=!1,yt=!Ge.objectMode&&u(Z);return yt&&!a.isBuffer(Z)&&(Z=l(Z)),typeof le=="function"&&(ke=le,le=null),yt?le="buffer":le||(le=Ge.defaultEncoding),typeof ke!="function"&&(ke=R),Ge.ending?F(this,ke):(yt||G(this,Ge,Z,ke))&&(Ge.pendingcb++,ft=Y(this,Ge,yt,Z,le,ke)),ft},O.prototype.cork=function(){this._writableState.corked++},O.prototype.uncork=function(){var Z=this._writableState;Z.corked&&(Z.corked--,!Z.writing&&!Z.corked&&!Z.bufferProcessing&&Z.bufferedRequest&&Pe(this,Z))},O.prototype.setDefaultEncoding=function(Z){if(typeof Z=="string"&&(Z=Z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Z+"").toLowerCase())>-1))throw new D(Z);return this._writableState.defaultEncoding=Z,this},Object.defineProperty(O.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ne(Z,le,ke){return!Z.objectMode&&Z.decodeStrings!==!1&&typeof le=="string"&&(le=a.from(le,ke)),le}Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Y(Z,le,ke,Ge,ft,yt){if(!ke){var V=ne(le,Ge,ft);Ge!==V&&(ke=!0,ft="buffer",Ge=V)}var z=le.objectMode?1:Ge.length;le.length+=z;var Oe=le.length<le.highWaterMark;if(Oe||(le.needDrain=!0),le.writing||le.corked){var tt=le.lastBufferedRequest;le.lastBufferedRequest={chunk:Ge,encoding:ft,isBuf:ke,callback:yt,next:null},tt?tt.next=le.lastBufferedRequest:le.bufferedRequest=le.lastBufferedRequest,le.bufferedRequestCount+=1}else ce(Z,le,!1,z,Ge,ft,yt);return Oe}function ce(Z,le,ke,Ge,ft,yt,V){le.writelen=Ge,le.writecb=V,le.writing=!0,le.sync=!0,le.destroyed?le.onwrite(new _("write")):ke?Z._writev(ft,le.onwrite):Z._write(ft,yt,le.onwrite),le.sync=!1}function oe(Z,le,ke,Ge,ft){--le.pendingcb,ke?(process.nextTick(ft,Ge),process.nextTick(Ve,Z,le),Z._writableState.errorEmitted=!0,N(Z,Ge)):(ft(Ge),Z._writableState.errorEmitted=!0,N(Z,Ge),Ve(Z,le))}function H(Z){Z.writing=!1,Z.writecb=null,Z.length-=Z.writelen,Z.writelen=0}function W(Z,le){var ke=Z._writableState,Ge=ke.sync,ft=ke.writecb;if(typeof ft!="function")throw new g;if(H(ke),le)oe(Z,ke,Ge,le,ft);else{var yt=$e(ke)||Z.destroyed;!yt&&!ke.corked&&!ke.bufferProcessing&&ke.bufferedRequest&&Pe(Z,ke),Ge?process.nextTick(de,Z,ke,yt,ft):de(Z,ke,yt,ft)}}function de(Z,le,ke,Ge){ke||De(Z,le),le.pendingcb--,Ge(),Ve(Z,le)}function De(Z,le){le.length===0&&le.needDrain&&(le.needDrain=!1,Z.emit("drain"))}function Pe(Z,le){le.bufferProcessing=!0;var ke=le.bufferedRequest;if(Z._writev&&ke&&ke.next){var Ge=le.bufferedRequestCount,ft=new Array(Ge),yt=le.corkedRequestsFree;yt.entry=ke;for(var V=0,z=!0;ke;)ft[V]=ke,ke.isBuf||(z=!1),ke=ke.next,V+=1;ft.allBuffers=z,ce(Z,le,!0,le.length,ft,"",yt.finish),le.pendingcb++,le.lastBufferedRequest=null,yt.next?(le.corkedRequestsFree=yt.next,yt.next=null):le.corkedRequestsFree=new r(le),le.bufferedRequestCount=0}else{for(;ke;){var Oe=ke.chunk,tt=ke.encoding,Ft=ke.callback,Dt=le.objectMode?1:Oe.length;if(ce(Z,le,!1,Dt,Oe,tt,Ft),ke=ke.next,le.bufferedRequestCount--,le.writing)break}ke===null&&(le.lastBufferedRequest=null)}le.bufferedRequest=ke,le.bufferProcessing=!1}O.prototype._write=function(Z,le,ke){ke(new d("_write()"))},O.prototype._writev=null,O.prototype.end=function(Z,le,ke){var Ge=this._writableState;return typeof Z=="function"?(ke=Z,Z=null,le=null):typeof le=="function"&&(ke=le,le=null),Z!=null&&this.write(Z,le),Ge.corked&&(Ge.corked=1,this.uncork()),Ge.ending||et(this,Ge,ke),this},Object.defineProperty(O.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function $e(Z){return Z.ending&&Z.length===0&&Z.bufferedRequest===null&&!Z.finished&&!Z.writing}function Be(Z,le){Z._final(function(ke){le.pendingcb--,ke&&N(Z,ke),le.prefinished=!0,Z.emit("prefinish"),Ve(Z,le)})}function nt(Z,le){!le.prefinished&&!le.finalCalled&&(typeof Z._final=="function"&&!le.destroyed?(le.pendingcb++,le.finalCalled=!0,process.nextTick(Be,Z,le)):(le.prefinished=!0,Z.emit("prefinish")))}function Ve(Z,le){var ke=$e(le);if(ke&&(nt(Z,le),le.pendingcb===0&&(le.finished=!0,Z.emit("finish"),le.autoDestroy))){var Ge=Z._readableState;(!Ge||Ge.autoDestroy&&Ge.endEmitted)&&Z.destroy()}return ke}function et(Z,le,ke){le.ending=!0,Ve(Z,le),ke&&(le.finished?process.nextTick(ke):Z.once("finish",ke)),le.ended=!0,Z.writable=!1}function ht(Z,le,ke){var Ge=Z.entry;for(Z.entry=null;Ge;){var ft=Ge.callback;le.pendingcb--,ft(ke),Ge=Ge.next}le.corkedRequestsFree.next=Z}Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Z){!this._writableState||(this._writableState.destroyed=Z)}}),O.prototype.destroy=h.destroy,O.prototype._undestroy=h.undestroy,O.prototype._destroy=function(Z,le){le(Z)}}),dd=A((e,t)=>{"use strict";c();var r=Object.keys||function(f){var y=[];for(var p in f)y.push(p);return y};t.exports=l;var n=BC(),i=NC();for(ni()(l,n),s=r(i.prototype),o=0;o<s.length;o++)a=s[o],l.prototype[a]||(l.prototype[a]=i.prototype[a]);var s,a,o;function l(f){if(!(this instanceof l))return new l(f);n.call(this,f),i.call(this,f),this.allowHalfOpen=!0,f&&(f.readable===!1&&(this.readable=!1),f.writable===!1&&(this.writable=!1),f.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",u)))}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function u(){this._writableState.ended||process.nextTick(h,this)}function h(f){f.end()}Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(f){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=f,this._writableState.destroyed=f)}})}),VE=A((e,t)=>{"use strict";c();var r=hd().codes.ERR_STREAM_PREMATURE_CLOSE;function n(o){var l=!1;return function(){if(!l){l=!0;for(var u=arguments.length,h=new Array(u),f=0;f<u;f++)h[f]=arguments[f];o.apply(this,h)}}}function i(){}function s(o){return o.setHeader&&typeof o.abort=="function"}function a(o,l,u){if(typeof l=="function")return a(o,null,l);l||(l={}),u=n(u||i);var h=l.readable||l.readable!==!1&&o.readable,f=l.writable||l.writable!==!1&&o.writable,y=function(){o.writable||v()},p=o._writableState&&o._writableState.finished,v=function(){f=!1,p=!0,h||u.call(o)},d=o._readableState&&o._readableState.endEmitted,g=function(){h=!1,d=!0,f||u.call(o)},b=function(E){u.call(o,E)},_=function(){var E;if(h&&!d)return(!o._readableState||!o._readableState.ended)&&(E=new r),u.call(o,E);if(f&&!p)return(!o._writableState||!o._writableState.ended)&&(E=new r),u.call(o,E)},m=function(){o.req.on("finish",v)};return s(o)?(o.on("complete",v),o.on("abort",_),o.req?m():o.on("request",m)):f&&!o._writableState&&(o.on("end",y),o.on("close",y)),o.on("end",g),o.on("finish",v),l.error!==!1&&o.on("error",b),o.on("close",_),function(){o.removeListener("complete",v),o.removeListener("abort",_),o.removeListener("request",m),o.req&&o.req.removeListener("finish",v),o.removeListener("end",y),o.removeListener("close",y),o.removeListener("finish",v),o.removeListener("end",g),o.removeListener("error",b),o.removeListener("close",_)}}t.exports=a}),Mte=A((e,t)=>{"use strict";c();var r;function n(m,E,D){return E in m?Object.defineProperty(m,E,{value:D,enumerable:!0,configurable:!0,writable:!0}):m[E]=D,m}var i=VE(),s=Symbol("lastResolve"),a=Symbol("lastReject"),o=Symbol("error"),l=Symbol("ended"),u=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function y(m,E){return{value:m,done:E}}function p(m){var E=m[s];if(E!==null){var D=m[f].read();D!==null&&(m[u]=null,m[s]=null,m[a]=null,E(y(D,!1)))}}function v(m){process.nextTick(p,m)}function d(m,E){return function(D,N){m.then(function(){if(E[l]){D(y(void 0,!0));return}E[h](D,N)},N)}}var g=Object.getPrototypeOf(function(){}),b=Object.setPrototypeOf((r={get stream(){return this[f]},next:function(){var m=this,E=this[o];if(E!==null)return Promise.reject(E);if(this[l])return Promise.resolve(y(void 0,!0));if(this[f].destroyed)return new Promise(function(T,S){process.nextTick(function(){m[o]?S(m[o]):T(y(void 0,!0))})});var D=this[u],N;if(D)N=new Promise(d(D,this));else{var R=this[f].read();if(R!==null)return Promise.resolve(y(R,!1));N=new Promise(this[h])}return this[u]=N,N}},n(r,Symbol.asyncIterator,function(){return this}),n(r,"return",function(){var m=this;return new Promise(function(E,D){m[f].destroy(null,function(N){if(N){D(N);return}E(y(void 0,!0))})})}),r),g),_=function(m){var E,D=Object.create(b,(E={},n(E,f,{value:m,writable:!0}),n(E,s,{value:null,writable:!0}),n(E,a,{value:null,writable:!0}),n(E,o,{value:null,writable:!0}),n(E,l,{value:m._readableState.endEmitted,writable:!0}),n(E,h,{value:function(N,R){var T=D[f].read();T?(D[u]=null,D[s]=null,D[a]=null,N(y(T,!1))):(D[s]=N,D[a]=R)},writable:!0}),E));return D[u]=null,i(m,function(N){if(N&&N.code!=="ERR_STREAM_PREMATURE_CLOSE"){var R=D[a];R!==null&&(D[u]=null,D[s]=null,D[a]=null,R(N)),D[o]=N;return}var T=D[s];T!==null&&(D[u]=null,D[s]=null,D[a]=null,T(y(void 0,!0))),D[l]=!0}),m.on("readable",v.bind(null,D)),D};t.exports=_}),Fte=A((e,t)=>{c(),t.exports=function(){throw new Error("Readable.from is not available in the browser")}}),BC=A((e,t)=>{"use strict";c(),t.exports=G;var r;G.ReadableState=F;var n=In().EventEmitter,i=function(V,z){return V.listeners(z).length},s=AC(),a=_i().Buffer,o=globalThis.Uint8Array||function(){};function l(V){return a.from(V)}function u(V){return a.isBuffer(V)||V instanceof o}var h=fg(),f;h&&h.debuglog?f=h.debuglog("stream"):f=function(){};var y=wte(),p=CC(),v=PC(),d=v.getHighWaterMark,g=hd().codes,b=g.ERR_INVALID_ARG_TYPE,_=g.ERR_STREAM_PUSH_AFTER_EOF,m=g.ERR_METHOD_NOT_IMPLEMENTED,E=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,D,N,R;ni()(G,s);var T=p.errorOrDestroy,S=["error","close","destroy","pause","resume"];function O(V,z,Oe){if(typeof V.prependListener=="function")return V.prependListener(z,Oe);!V._events||!V._events[z]?V.on(z,Oe):Array.isArray(V._events[z])?V._events[z].unshift(Oe):V._events[z]=[Oe,V._events[z]]}function F(V,z,Oe){r=r||dd(),V=V||{},typeof Oe!="boolean"&&(Oe=z instanceof r),this.objectMode=!!V.objectMode,Oe&&(this.objectMode=this.objectMode||!!V.readableObjectMode),this.highWaterMark=d(this,V,"readableHighWaterMark",Oe),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=V.emitClose!==!1,this.autoDestroy=!!V.autoDestroy,this.destroyed=!1,this.defaultEncoding=V.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,V.encoding&&(D||(D=mg().StringDecoder),this.decoder=new D(V.encoding),this.encoding=V.encoding)}function G(V){if(r=r||dd(),!(this instanceof G))return new G(V);var z=this instanceof r;this._readableState=new F(V,this,z),this.readable=!0,V&&(typeof V.read=="function"&&(this._read=V.read),typeof V.destroy=="function"&&(this._destroy=V.destroy)),s.call(this)}Object.defineProperty(G.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(V){!this._readableState||(this._readableState.destroyed=V)}}),G.prototype.destroy=p.destroy,G.prototype._undestroy=p.undestroy,G.prototype._destroy=function(V,z){z(V)},G.prototype.push=function(V,z){var Oe=this._readableState,tt;return Oe.objectMode?tt=!0:typeof V=="string"&&(z=z||Oe.defaultEncoding,z!==Oe.encoding&&(V=a.from(V,z),z=""),tt=!0),ne(this,V,z,!1,tt)},G.prototype.unshift=function(V){return ne(this,V,null,!0,!1)};function ne(V,z,Oe,tt,Ft){f("readableAddChunk",z);var Dt=V._readableState;if(z===null)Dt.reading=!1,de(V,Dt);else{var Lt;if(Ft||(Lt=ce(Dt,z)),Lt)T(V,Lt);else if(Dt.objectMode||z&&z.length>0)if(typeof z!="string"&&!Dt.objectMode&&Object.getPrototypeOf(z)!==a.prototype&&(z=l(z)),tt)Dt.endEmitted?T(V,new E):Y(V,Dt,z,!0);else if(Dt.ended)T(V,new _);else{if(Dt.destroyed)return!1;Dt.reading=!1,Dt.decoder&&!Oe?(z=Dt.decoder.write(z),Dt.objectMode||z.length!==0?Y(V,Dt,z,!1):$e(V,Dt)):Y(V,Dt,z,!1)}else tt||(Dt.reading=!1,$e(V,Dt))}return!Dt.ended&&(Dt.length<Dt.highWaterMark||Dt.length===0)}function Y(V,z,Oe,tt){z.flowing&&z.length===0&&!z.sync?(z.awaitDrain=0,V.emit("data",Oe)):(z.length+=z.objectMode?1:Oe.length,tt?z.buffer.unshift(Oe):z.buffer.push(Oe),z.needReadable&&De(V)),$e(V,z)}function ce(V,z){var Oe;return!u(z)&&typeof z!="string"&&z!==void 0&&!V.objectMode&&(Oe=new b("chunk",["string","Buffer","Uint8Array"],z)),Oe}G.prototype.isPaused=function(){return this._readableState.flowing===!1},G.prototype.setEncoding=function(V){D||(D=mg().StringDecoder);var z=new D(V);this._readableState.decoder=z,this._readableState.encoding=this._readableState.decoder.encoding;for(var Oe=this._readableState.buffer.head,tt="";Oe!==null;)tt+=z.write(Oe.data),Oe=Oe.next;return this._readableState.buffer.clear(),tt!==""&&this._readableState.buffer.push(tt),this._readableState.length=tt.length,this};var oe=1073741824;function H(V){return V>=oe?V=oe:(V--,V|=V>>>1,V|=V>>>2,V|=V>>>4,V|=V>>>8,V|=V>>>16,V++),V}function W(V,z){return V<=0||z.length===0&&z.ended?0:z.objectMode?1:V!==V?z.flowing&&z.length?z.buffer.head.data.length:z.length:(V>z.highWaterMark&&(z.highWaterMark=H(V)),V<=z.length?V:z.ended?z.length:(z.needReadable=!0,0))}G.prototype.read=function(V){f("read",V),V=parseInt(V,10);var z=this._readableState,Oe=V;if(V!==0&&(z.emittedReadable=!1),V===0&&z.needReadable&&((z.highWaterMark!==0?z.length>=z.highWaterMark:z.length>0)||z.ended))return f("read: emitReadable",z.length,z.ended),z.length===0&&z.ended?Ge(this):De(this),null;if(V=W(V,z),V===0&&z.ended)return z.length===0&&Ge(this),null;var tt=z.needReadable;f("need readable",tt),(z.length===0||z.length-V<z.highWaterMark)&&(tt=!0,f("length less than watermark",tt)),z.ended||z.reading?(tt=!1,f("reading or ended",tt)):tt&&(f("do read"),z.reading=!0,z.sync=!0,z.length===0&&(z.needReadable=!0),this._read(z.highWaterMark),z.sync=!1,z.reading||(V=W(Oe,z)));var Ft;return V>0?Ft=ke(V,z):Ft=null,Ft===null?(z.needReadable=z.length<=z.highWaterMark,V=0):(z.length-=V,z.awaitDrain=0),z.length===0&&(z.ended||(z.needReadable=!0),Oe!==V&&z.ended&&Ge(this)),Ft!==null&&this.emit("data",Ft),Ft};function de(V,z){if(f("onEofChunk"),!z.ended){if(z.decoder){var Oe=z.decoder.end();Oe&&Oe.length&&(z.buffer.push(Oe),z.length+=z.objectMode?1:Oe.length)}z.ended=!0,z.sync?De(V):(z.needReadable=!1,z.emittedReadable||(z.emittedReadable=!0,Pe(V)))}}function De(V){var z=V._readableState;f("emitReadable",z.needReadable,z.emittedReadable),z.needReadable=!1,z.emittedReadable||(f("emitReadable",z.flowing),z.emittedReadable=!0,process.nextTick(Pe,V))}function Pe(V){var z=V._readableState;f("emitReadable_",z.destroyed,z.length,z.ended),!z.destroyed&&(z.length||z.ended)&&(V.emit("readable"),z.emittedReadable=!1),z.needReadable=!z.flowing&&!z.ended&&z.length<=z.highWaterMark,le(V)}function $e(V,z){z.readingMore||(z.readingMore=!0,process.nextTick(Be,V,z))}function Be(V,z){for(;!z.reading&&!z.ended&&(z.length<z.highWaterMark||z.flowing&&z.length===0);){var Oe=z.length;if(f("maybeReadMore read 0"),V.read(0),Oe===z.length)break}z.readingMore=!1}G.prototype._read=function(V){T(this,new m("_read()"))},G.prototype.pipe=function(V,z){var Oe=this,tt=this._readableState;switch(tt.pipesCount){case 0:tt.pipes=V;break;case 1:tt.pipes=[tt.pipes,V];break;default:tt.pipes.push(V);break}tt.pipesCount+=1,f("pipe count=%d opts=%j",tt.pipesCount,z);var Ft=(!z||z.end!==!1)&&V!==process.stdout&&V!==process.stderr,Dt=Ft?$t:J;tt.endEmitted?process.nextTick(Dt):Oe.once("end",Dt),V.on("unpipe",Lt);function Lt(ge,Le){f("onunpipe"),ge===Oe&&Le&&Le.hasUnpiped===!1&&(Le.hasUnpiped=!0,Cr())}function $t(){f("onend"),V.end()}var Wt=nt(Oe);V.on("drain",Wt);var lr=!1;function Cr(){f("cleanup"),V.removeListener("close",x),V.removeListener("finish",$),V.removeListener("drain",Wt),V.removeListener("error",Sr),V.removeListener("unpipe",Lt),Oe.removeListener("end",$t),Oe.removeListener("end",J),Oe.removeListener("data",sr),lr=!0,tt.awaitDrain&&(!V._writableState||V._writableState.needDrain)&&Wt()}Oe.on("data",sr);function sr(ge){f("ondata");var Le=V.write(ge);f("dest.write",Le),Le===!1&&((tt.pipesCount===1&&tt.pipes===V||tt.pipesCount>1&&yt(tt.pipes,V)!==-1)&&!lr&&(f("false write response, pause",tt.awaitDrain),tt.awaitDrain++),Oe.pause())}function Sr(ge){f("onerror",ge),J(),V.removeListener("error",Sr),i(V,"error")===0&&T(V,ge)}O(V,"error",Sr);function x(){V.removeListener("finish",$),J()}V.once("close",x);function $(){f("onfinish"),V.removeListener("close",x),J()}V.once("finish",$);function J(){f("unpipe"),Oe.unpipe(V)}return V.emit("pipe",Oe),tt.flowing||(f("pipe resume"),Oe.resume()),V};function nt(V){return function(){var z=V._readableState;f("pipeOnDrain",z.awaitDrain),z.awaitDrain&&z.awaitDrain--,z.awaitDrain===0&&i(V,"data")&&(z.flowing=!0,le(V))}}G.prototype.unpipe=function(V){var z=this._readableState,Oe={hasUnpiped:!1};if(z.pipesCount===0)return this;if(z.pipesCount===1)return V&&V!==z.pipes?this:(V||(V=z.pipes),z.pipes=null,z.pipesCount=0,z.flowing=!1,V&&V.emit("unpipe",this,Oe),this);if(!V){var tt=z.pipes,Ft=z.pipesCount;z.pipes=null,z.pipesCount=0,z.flowing=!1;for(var Dt=0;Dt<Ft;Dt++)tt[Dt].emit("unpipe",this,{hasUnpiped:!1});return this}var Lt=yt(z.pipes,V);return Lt===-1?this:(z.pipes.splice(Lt,1),z.pipesCount-=1,z.pipesCount===1&&(z.pipes=z.pipes[0]),V.emit("unpipe",this,Oe),this)},G.prototype.on=function(V,z){var Oe=s.prototype.on.call(this,V,z),tt=this._readableState;return V==="data"?(tt.readableListening=this.listenerCount("readable")>0,tt.flowing!==!1&&this.resume()):V==="readable"&&!tt.endEmitted&&!tt.readableListening&&(tt.readableListening=tt.needReadable=!0,tt.flowing=!1,tt.emittedReadable=!1,f("on readable",tt.length,tt.reading),tt.length?De(this):tt.reading||process.nextTick(et,this)),Oe},G.prototype.addListener=G.prototype.on,G.prototype.removeListener=function(V,z){var Oe=s.prototype.removeListener.call(this,V,z);return V==="readable"&&process.nextTick(Ve,this),Oe},G.prototype.removeAllListeners=function(V){var z=s.prototype.removeAllListeners.apply(this,arguments);return(V==="readable"||V===void 0)&&process.nextTick(Ve,this),z};function Ve(V){var z=V._readableState;z.readableListening=V.listenerCount("readable")>0,z.resumeScheduled&&!z.paused?z.flowing=!0:V.listenerCount("data")>0&&V.resume()}function et(V){f("readable nexttick read 0"),V.read(0)}G.prototype.resume=function(){var V=this._readableState;return V.flowing||(f("resume"),V.flowing=!V.readableListening,ht(this,V)),V.paused=!1,this};function ht(V,z){z.resumeScheduled||(z.resumeScheduled=!0,process.nextTick(Z,V,z))}function Z(V,z){f("resume",z.reading),z.reading||V.read(0),z.resumeScheduled=!1,V.emit("resume"),le(V),z.flowing&&!z.reading&&V.read(0)}G.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function le(V){var z=V._readableState;for(f("flow",z.flowing);z.flowing&&V.read()!==null;);}G.prototype.wrap=function(V){var z=this,Oe=this._readableState,tt=!1;V.on("end",function(){if(f("wrapped end"),Oe.decoder&&!Oe.ended){var Lt=Oe.decoder.end();Lt&&Lt.length&&z.push(Lt)}z.push(null)}),V.on("data",function(Lt){if(f("wrapped data"),Oe.decoder&&(Lt=Oe.decoder.write(Lt)),!(Oe.objectMode&&Lt==null)&&!(!Oe.objectMode&&(!Lt||!Lt.length))){var $t=z.push(Lt);$t||(tt=!0,V.pause())}});for(var Ft in V)this[Ft]===void 0&&typeof V[Ft]=="function"&&(this[Ft]=function(Lt){return function(){return V[Lt].apply(V,arguments)}}(Ft));for(var Dt=0;Dt<S.length;Dt++)V.on(S[Dt],this.emit.bind(this,S[Dt]));return this._read=function(Lt){f("wrapped _read",Lt),tt&&(tt=!1,V.resume())},this},typeof Symbol=="function"&&(G.prototype[Symbol.asyncIterator]=function(){return N===void 0&&(N=Mte()),N(this)}),Object.defineProperty(G.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(G.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(G.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(V){this._readableState&&(this._readableState.flowing=V)}}),G._fromList=ke,Object.defineProperty(G.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function ke(V,z){if(z.length===0)return null;var Oe;return z.objectMode?Oe=z.buffer.shift():!V||V>=z.length?(z.decoder?Oe=z.buffer.join(""):z.buffer.length===1?Oe=z.buffer.first():Oe=z.buffer.concat(z.length),z.buffer.clear()):Oe=z.buffer.consume(V,z.decoder),Oe}function Ge(V){var z=V._readableState;f("endReadable",z.endEmitted),z.endEmitted||(z.ended=!0,process.nextTick(ft,z,V))}function ft(V,z){if(f("endReadableNT",V.endEmitted,V.length),!V.endEmitted&&V.length===0&&(V.endEmitted=!0,z.readable=!1,z.emit("end"),V.autoDestroy)){var Oe=z._writableState;(!Oe||Oe.autoDestroy&&Oe.finished)&&z.destroy()}}typeof Symbol=="function"&&(G.from=function(V,z){return R===void 0&&(R=Fte()),R(G,V,z)});function yt(V,z){for(var Oe=0,tt=V.length;Oe<tt;Oe++)if(V[Oe]===z)return Oe;return-1}}),WC=A((e,t)=>{"use strict";c(),t.exports=u;var r=hd().codes,n=r.ERR_METHOD_NOT_IMPLEMENTED,i=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,o=dd();ni()(u,o);function l(y,p){var v=this._transformState;v.transforming=!1;var d=v.writecb;if(d===null)return this.emit("error",new i);v.writechunk=null,v.writecb=null,p!=null&&this.push(p),d(y);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function u(y){if(!(this instanceof u))return new u(y);o.call(this,y),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&(typeof y.transform=="function"&&(this._transform=y.transform),typeof y.flush=="function"&&(this._flush=y.flush)),this.on("prefinish",h)}function h(){var y=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(p,v){f(y,p,v)}):f(this,null,null)}u.prototype.push=function(y,p){return this._transformState.needTransform=!1,o.prototype.push.call(this,y,p)},u.prototype._transform=function(y,p,v){v(new n("_transform()"))},u.prototype._write=function(y,p,v){var d=this._transformState;if(d.writecb=v,d.writechunk=y,d.writeencoding=p,!d.transforming){var g=this._readableState;(d.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},u.prototype._read=function(y){var p=this._transformState;p.writechunk!==null&&!p.transforming?(p.transforming=!0,this._transform(p.writechunk,p.writeencoding,p.afterTransform)):p.needTransform=!0},u.prototype._destroy=function(y,p){o.prototype._destroy.call(this,y,function(v){p(v)})};function f(y,p,v){if(p)return y.emit("error",p);if(v!=null&&y.push(v),y._writableState.length)throw new a;if(y._transformState.transforming)throw new s;return y.push(null)}}),ere=A((e,t)=>{"use strict";c(),t.exports=n;var r=WC();ni()(n,r);function n(i){if(!(this instanceof n))return new n(i);r.call(this,i)}n.prototype._transform=function(i,s,a){a(null,i)}}),ore=A((e,t)=>{"use strict";c();var r;function n(v){var d=!1;return function(){d||(d=!0,v.apply(void 0,arguments))}}var i=hd().codes,s=i.ERR_MISSING_ARGS,a=i.ERR_STREAM_DESTROYED;function o(v){if(v)throw v}function l(v){return v.setHeader&&typeof v.abort=="function"}function u(v,d,g,b){b=n(b);var _=!1;v.on("close",function(){_=!0}),r===void 0&&(r=VE()),r(v,{readable:d,writable:g},function(E){if(E)return b(E);_=!0,b()});var m=!1;return function(E){if(!_&&!m){if(m=!0,l(v))return v.abort();if(typeof v.destroy=="function")return v.destroy();b(E||new a("pipe"))}}}function h(v){v()}function f(v,d){return v.pipe(d)}function y(v){return!v.length||typeof v[v.length-1]!="function"?o:v.pop()}function p(){for(var v=arguments.length,d=new Array(v),g=0;g<v;g++)d[g]=arguments[g];var b=y(d);if(Array.isArray(d[0])&&(d=d[0]),d.length<2)throw new s("streams");var _,m=d.map(function(E,D){var N=D<d.length-1,R=D>0;return u(E,N,R,function(T){_||(_=T),T&&m.forEach(h),!N&&(m.forEach(h),b(_))})});return d.reduce(f)}t.exports=p}),are=A((e,t)=>{c(),e=t.exports=BC(),e.Stream=e,e.Readable=e,e.Writable=NC(),e.Duplex=dd(),e.Transform=WC(),e.PassThrough=ere(),e.finished=VE(),e.pipeline=ore()}),YC=A((e,t)=>{"use strict";c();var{Readable:r}=are(),n=uh(),i=(s=1/0)=>{let a=0;return new r({read(o){if(a>=s)return this.push(null);a+o>=s&&(o=s-a),a+=o,this.push(n(o))}})};t.exports={randomStream:i,randomBytes:n}}),$ne=A((e,t)=>{c(),t.exports=r=>{if(r[Symbol.asyncIterator])return r;if(r.getReader)return async function*(){let n=r.getReader();try{for(;;){let{done:i,value:s}=await n.read();if(i)return;yield s}}finally{n.releaseLock()}}();throw new Error("unknown stream")}}),hP=A(()=>{c()}),dP=A((e,t)=>{"use strict";c();var r=Vp(),n=(s,a)=>({path:decodeURIComponent(new URL(s).pathname.split("/").pop()||""),content:i(s,a)});async function*i(s,a){yield*(await new r().get(s,a)).iterator()}t.exports=n}),AP=A((e,t)=>{"use strict";c();var r=(o,l)=>Math.floor(Math.random()*(l-o+1)+o),n=()=>{let o=new Error("Delay aborted");return o.name="AbortError",o},i=({clearTimeout:o,setTimeout:l,willResolve:u})=>(h,{value:f,signal:y}={})=>{if(y&&y.aborted)return Promise.reject(n());let p,v,d,g=o||clearTimeout,b=()=>{g(p),d(n())},_=()=>{y&&y.removeEventListener("abort",b)},m=new Promise((E,D)=>{v=()=>{_(),u?E(f):D(f)},d=D,p=(l||setTimeout)(v,h)});return y&&y.addEventListener("abort",b,{once:!0}),m.clear=()=>{g(p),p=null,v()},m},s=o=>{let l=i({...o,willResolve:!0});return l.reject=i({...o,willResolve:!1}),l.range=(u,h,f)=>l(r(u,h),f),l},a=s();a.createWithTimers=s,t.exports=a,t.exports.default=a}),OP=A((e,t)=>{"use strict";c();var r=new Map,n=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function i(o,l,u){for(;r.get(u);){try{await o()}catch(h){setTimeout(()=>{throw h},1);break}if(!r.get(u))break;await new Promise(h=>{let f=setTimeout(h,l);r.set(u,f)})}}function s(o,l,u){u=u||l;let h=n(),f=setTimeout(()=>{i(o,l,h)},u);return r.set(h,f),h}function a(o){let l=r.get(o);l&&(clearTimeout(l),r.delete(o))}t.exports={setDelayedInterval:s,clearDelayedInterval:a}}),Vse=A((e,t)=>{"use strict";c();var r=()=>{let n={};return n.promise=new Promise((i,s)=>{n.resolve=i,n.reject=s}),n};t.exports=r}),$se=A((e,t)=>{c();var r=d0(),n=Vse();t.exports=class{constructor(){this._buffer=new r,this._waitingConsumers=new r}push(i){let{promise:s,resolve:a}=n();return this._buffer.push({chunk:i,resolve:a}),this._consume(),s}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let i=this._waitingConsumers.shift(),s=this._buffer.shift();i.resolve(s.chunk),s.resolve()}}shift(){let{promise:i,resolve:s}=n();return this._waitingConsumers.push({resolve:s}),this._consume(),i}isEmpty(){return this._buffer.isEmpty()}}}),Yse=A(e=>{c(),function(){var t,r,n,i,s,a,o,l;l=function(u){var h,f,y,p;return h=(u&255<<24)>>>24,f=(u&255<<16)>>>16,y=(u&255<<8)>>>8,p=u&255,[h,f,y,p].join(".")},o=function(u){var h,f,y,p,v,d;for(h=[],y=p=0;p<=3&&u.length!==0;y=++p){if(y>0){if(u[0]!==".")throw new Error("Invalid IP");u=u.substring(1)}d=r(u),v=d[0],f=d[1],u=u.substring(f),h.push(v)}if(u.length!==0)throw new Error("Invalid IP");switch(h.length){case 1:if(h[0]>4294967295)throw new Error("Invalid IP");return h[0]>>>0;case 2:if(h[0]>255||h[1]>16777215)throw new Error("Invalid IP");return(h[0]<<24|h[1])>>>0;case 3:if(h[0]>255||h[1]>255||h[2]>65535)throw new Error("Invalid IP");return(h[0]<<24|h[1]<<16|h[2])>>>0;case 4:if(h[0]>255||h[1]>255||h[2]>255||h[3]>255)throw new Error("Invalid IP");return(h[0]<<24|h[1]<<16|h[2]<<8|h[3])>>>0;default:throw new Error("Invalid IP")}},n=function(u){return u.charCodeAt(0)},i=n("0"),a=n("a"),s=n("A"),r=function(u){var h,f,y,p,v;for(p=0,h=10,f="9",y=0,u.length>1&&u[y]==="0"&&(u[y+1]==="x"||u[y+1]==="X"?(y+=2,h=16):"0"<=u[y+1]&&u[y+1]<="9"&&(y++,h=8,f="7")),v=y;y<u.length;){if("0"<=u[y]&&u[y]<=f)p=p*h+(n(u[y])-i)>>>0;else if(h===16)if("a"<=u[y]&&u[y]<="f")p=p*h+(10+n(u[y])-a)>>>0;else if("A"<=u[y]&&u[y]<="F")p=p*h+(10+n(u[y])-s)>>>0;else break;else break;if(p>4294967295)throw new Error("too large");y++}if(y===v)throw new Error("empty octet");return[p,y]},t=function(){function u(h,f){var y,p,v,d;if(typeof h!="string")throw new Error("Missing `net' parameter");if(f||(d=h.split("/",2),h=d[0],f=d[1]),f||(f=32),typeof f=="string"&&f.indexOf(".")>-1){try{this.maskLong=o(f)}catch(g){throw y=g,new Error("Invalid mask: "+f)}for(p=v=32;v>=0;p=--v)if(this.maskLong===4294967295<<32-p>>>0){this.bitmask=p;break}}else if(f||f===0)this.bitmask=parseInt(f,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(h)&this.maskLong)>>>0}catch(g){throw y=g,new Error("Invalid net address: "+h)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+f);this.size=Math.pow(2,32-this.bitmask),this.base=l(this.netLong),this.mask=l(this.maskLong),this.hostmask=l(~this.maskLong),this.first=this.bitmask<=30?l(this.netLong+1):this.base,this.last=this.bitmask<=30?l(this.netLong+this.size-2):l(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?l(this.netLong+this.size-1):void 0}return u.prototype.contains=function(h){return typeof h=="string"&&(h.indexOf("/")>0||h.split(".").length!==4)&&(h=new u(h)),h instanceof u?this.contains(h.base)&&this.contains(h.broadcast||h.last):(o(h)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},u.prototype.next=function(h){return h==null&&(h=1),new u(l(this.netLong+this.size*h),this.mask)},u.prototype.forEach=function(h){var f,y,p;for(p=o(this.first),y=o(this.last),f=0;p<=y;)h(l(p),p,f),f++,p++},u.prototype.toString=function(){return this.base+"/"+this.bitmask},u}(),e.ip2long=o,e.long2ip=l,e.Netmask=t}.call(e)}),VP=A((e,t)=>{"use strict";c();var r="[a-fA-F\\d:]",n=f=>f&&f.includeBoundaries?`(?:(?<=\\s|^)(?=${r})|(?<=${r})(?=\\s|$))`:"",i="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",a=`
(?:
(?:${s}:){7}(?:${s}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${s}:){6}(?:${i}|:${s}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${s}:){5}(?::${i}|(?::${s}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${s}:){4}(?:(?::${s}){0,1}:${i}|(?::${s}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${s}:){3}(?:(?::${s}){0,2}:${i}|(?::${s}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${s}:){2}(?:(?::${s}){0,3}:${i}|(?::${s}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${s}:){1}(?:(?::${s}){0,4}:${i}|(?::${s}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${s}){0,5}:${i}|(?::${s}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=new RegExp(`(?:^${i}$)|(?:^${a}$)`),l=new RegExp(`^${i}$`),u=new RegExp(`^${a}$`),h=f=>f&&f.exact?o:new RegExp(`(?:${n(f)}${i}${n(f)})|(?:${n(f)}${a}${n(f)})`,"g");h.v4=f=>f&&f.exact?l:new RegExp(`${n(f)}${i}${n(f)}`,"g"),h.v6=f=>f&&f.exact?u:new RegExp(`${n(f)}${a}${n(f)}`,"g"),t.exports=h}),Jse=A((e,t)=>{"use strict";c();var r=VP(),n=i=>r({exact:!0}).test(i);n.v4=i=>r.v4({exact:!0}).test(i),n.v6=i=>r.v6({exact:!0}).test(i),n.version=i=>n(i)?n.v4(i)?4:6:void 0,t.exports=n}),tae=A((e,t)=>{c(),function(r){"use strict";let n="(0?\\d+|0x[a-f0-9]+)",i={fourOctet:new RegExp(`^${n}\\.${n}\\.${n}\\.${n}$`,"i"),threeOctet:new RegExp(`^${n}\\.${n}\\.${n}$`,"i"),twoOctet:new RegExp(`^${n}\\.${n}$`,"i"),longValue:new RegExp(`^${n}$`,"i")},s=new RegExp("^0[0-7]+$","i"),a=new RegExp("^0x[a-f0-9]+$","i"),o="%[0-9a-z]{1,}",l="(?:[0-9a-f]+::?)+",u={zoneIndex:new RegExp(o,"i"),native:new RegExp(`^(::)?(${l})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${n}\\.${n}\\.${n}\\.${n}(${o})?)$`,"i"),transitional:new RegExp(`^((?:${l})|(?:::)(?:${l})?)${n}\\.${n}\\.${n}\\.${n}(${o})?$`,"i")};function h(d,g){if(d.indexOf("::")!==d.lastIndexOf("::"))return null;let b=0,_=-1,m=(d.match(u.zoneIndex)||[])[0],E,D;for(m&&(m=m.substring(1),d=d.replace(/%.+$/,""));(_=d.indexOf(":",_+1))>=0;)b++;if(d.substr(0,2)==="::"&&b--,d.substr(-2,2)==="::"&&b--,b>g)return null;for(D=g-b,E=":";D--;)E+="0:";return d=d.replace("::",E),d[0]===":"&&(d=d.slice(1)),d[d.length-1]===":"&&(d=d.slice(0,-1)),g=function(){let N=d.split(":"),R=[];for(let T=0;T<N.length;T++)R.push(parseInt(N[T],16));return R}(),{parts:g,zoneId:m}}function f(d,g,b,_){if(d.length!==g.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let m=0,E;for(;_>0;){if(E=b-_,E<0&&(E=0),d[m]>>E!==g[m]>>E)return!1;_-=b,m+=1}return!0}function y(d){if(a.test(d))return parseInt(d,16);if(d[0]==="0"&&!isNaN(parseInt(d[1],10))){if(s.test(d))return parseInt(d,8);throw new Error(`ipaddr: cannot parse ${d} as octal`)}return parseInt(d,10)}function p(d,g){for(;d.length<g;)d=`0${d}`;return d}let v={};v.IPv4=function(){function d(g){if(g.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let b,_;for(b=0;b<g.length;b++)if(_=g[b],!(0<=_&&_<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=g}return d.prototype.SpecialRanges={unspecified:[[new d([0,0,0,0]),8]],broadcast:[[new d([255,255,255,255]),32]],multicast:[[new d([224,0,0,0]),4]],linkLocal:[[new d([169,254,0,0]),16]],loopback:[[new d([127,0,0,0]),8]],carrierGradeNat:[[new d([100,64,0,0]),10]],private:[[new d([10,0,0,0]),8],[new d([172,16,0,0]),12],[new d([192,168,0,0]),16]],reserved:[[new d([192,0,0,0]),24],[new d([192,0,2,0]),24],[new d([192,88,99,0]),24],[new d([198,51,100,0]),24],[new d([203,0,113,0]),24],[new d([240,0,0,0]),4]]},d.prototype.kind=function(){return"ipv4"},d.prototype.match=function(g,b){let _;if(b===void 0&&(_=g,g=_[0],b=_[1]),g.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return f(this.octets,g.octets,8,b)},d.prototype.prefixLengthFromSubnetMask=function(){let g=0,b=!1,_={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},m,E,D;for(m=3;m>=0;m-=1)if(E=this.octets[m],E in _){if(D=_[E],b&&D!==0)return null;D!==8&&(b=!0),g+=D}else return null;return 32-g},d.prototype.range=function(){return v.subnetMatch(this,this.SpecialRanges)},d.prototype.toByteArray=function(){return this.octets.slice(0)},d.prototype.toIPv4MappedAddress=function(){return v.IPv6.parse(`::ffff:${this.toString()}`)},d.prototype.toNormalizedString=function(){return this.toString()},d.prototype.toString=function(){return this.octets.join(".")},d}(),v.IPv4.broadcastAddressFromCIDR=function(d){try{let g=this.parseCIDR(d),b=g[0].toByteArray(),_=this.subnetMaskFromPrefixLength(g[1]).toByteArray(),m=[],E=0;for(;E<4;)m.push(parseInt(b[E],10)|parseInt(_[E],10)^255),E++;return new this(m)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},v.IPv4.isIPv4=function(d){return this.parser(d)!==null},v.IPv4.isValid=function(d){try{return new this(this.parser(d)),!0}catch{return!1}},v.IPv4.isValidFourPartDecimal=function(d){return!!(v.IPv4.isValid(d)&&d.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},v.IPv4.networkAddressFromCIDR=function(d){let g,b,_,m,E;try{for(g=this.parseCIDR(d),_=g[0].toByteArray(),E=this.subnetMaskFromPrefixLength(g[1]).toByteArray(),m=[],b=0;b<4;)m.push(parseInt(_[b],10)&parseInt(E[b],10)),b++;return new this(m)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},v.IPv4.parse=function(d){let g=this.parser(d);if(g===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(g)},v.IPv4.parseCIDR=function(d){let g;if(g=d.match(/^(.+)\/(\d+)$/)){let b=parseInt(g[2]);if(b>=0&&b<=32){let _=[this.parse(g[1]),b];return Object.defineProperty(_,"toString",{value:function(){return this.join("/")}}),_}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},v.IPv4.parser=function(d){let g,b,_;if(g=d.match(i.fourOctet))return function(){let m=g.slice(1,6),E=[];for(let D=0;D<m.length;D++)b=m[D],E.push(y(b));return E}();if(g=d.match(i.longValue)){if(_=y(g[1]),_>4294967295||_<0)throw new Error("ipaddr: address outside defined range");return function(){let m=[],E;for(E=0;E<=24;E+=8)m.push(_>>E&255);return m}().reverse()}else return(g=d.match(i.twoOctet))?function(){let m=g.slice(1,4),E=[];if(_=y(m[1]),_>16777215||_<0)throw new Error("ipaddr: address outside defined range");return E.push(y(m[0])),E.push(_>>16&255),E.push(_>>8&255),E.push(_&255),E}():(g=d.match(i.threeOctet))?function(){let m=g.slice(1,5),E=[];if(_=y(m[2]),_>65535||_<0)throw new Error("ipaddr: address outside defined range");return E.push(y(m[0])),E.push(y(m[1])),E.push(_>>8&255),E.push(_&255),E}():null},v.IPv4.subnetMaskFromPrefixLength=function(d){if(d=parseInt(d),d<0||d>32)throw new Error("ipaddr: invalid IPv4 prefix length");let g=[0,0,0,0],b=0,_=Math.floor(d/8);for(;b<_;)g[b]=255,b++;return _<4&&(g[_]=Math.pow(2,d%8)-1<<8-d%8),new this(g)},v.IPv6=function(){function d(g,b){let _,m;if(g.length===16)for(this.parts=[],_=0;_<=14;_+=2)this.parts.push(g[_]<<8|g[_+1]);else if(g.length===8)this.parts=g;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(_=0;_<this.parts.length;_++)if(m=this.parts[_],!(0<=m&&m<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");b&&(this.zoneId=b)}return d.prototype.SpecialRanges={unspecified:[new d([0,0,0,0,0,0,0,0]),128],linkLocal:[new d([65152,0,0,0,0,0,0,0]),10],multicast:[new d([65280,0,0,0,0,0,0,0]),8],loopback:[new d([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new d([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new d([0,0,0,0,0,65535,0,0]),96],rfc6145:[new d([0,0,0,0,65535,0,0,0]),96],rfc6052:[new d([100,65435,0,0,0,0,0,0]),96],"6to4":[new d([8194,0,0,0,0,0,0,0]),16],teredo:[new d([8193,0,0,0,0,0,0,0]),32],reserved:[[new d([8193,3512,0,0,0,0,0,0]),32]]},d.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},d.prototype.kind=function(){return"ipv6"},d.prototype.match=function(g,b){let _;if(b===void 0&&(_=g,g=_[0],b=_[1]),g.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return f(this.parts,g.parts,16,b)},d.prototype.prefixLengthFromSubnetMask=function(){let g=0,b=!1,_={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},m,E;for(let D=7;D>=0;D-=1)if(m=this.parts[D],m in _){if(E=_[m],b&&E!==0)return null;E!==16&&(b=!0),g+=E}else return null;return 128-g},d.prototype.range=function(){return v.subnetMatch(this,this.SpecialRanges)},d.prototype.toByteArray=function(){let g,b=[],_=this.parts;for(let m=0;m<_.length;m++)g=_[m],b.push(g>>8),b.push(g&255);return b},d.prototype.toFixedLengthString=function(){let g=function(){let _=[];for(let m=0;m<this.parts.length;m++)_.push(p(this.parts[m].toString(16),4));return _}.call(this).join(":"),b="";return this.zoneId&&(b=`%${this.zoneId}`),g+b},d.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let g=this.parts.slice(-2),b=g[0],_=g[1];return new v.IPv4([b>>8,b&255,_>>8,_&255])},d.prototype.toNormalizedString=function(){let g=function(){let _=[];for(let m=0;m<this.parts.length;m++)_.push(this.parts[m].toString(16));return _}.call(this).join(":"),b="";return this.zoneId&&(b=`%${this.zoneId}`),g+b},d.prototype.toRFC5952String=function(){let g=/((^|:)(0(:|$)){2,})/g,b=this.toNormalizedString(),_=0,m=-1,E;for(;E=g.exec(b);)E[0].length>m&&(_=E.index,m=E[0].length);return m<0?b:`${b.substring(0,_)}::${b.substring(_+m)}`},d.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},d}(),v.IPv6.broadcastAddressFromCIDR=function(d){try{let g=this.parseCIDR(d),b=g[0].toByteArray(),_=this.subnetMaskFromPrefixLength(g[1]).toByteArray(),m=[],E=0;for(;E<16;)m.push(parseInt(b[E],10)|parseInt(_[E],10)^255),E++;return new this(m)}catch(g){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${g})`)}},v.IPv6.isIPv6=function(d){return this.parser(d)!==null},v.IPv6.isValid=function(d){if(typeof d=="string"&&d.indexOf(":")===-1)return!1;try{let g=this.parser(d);return new this(g.parts,g.zoneId),!0}catch{return!1}},v.IPv6.networkAddressFromCIDR=function(d){let g,b,_,m,E;try{for(g=this.parseCIDR(d),_=g[0].toByteArray(),E=this.subnetMaskFromPrefixLength(g[1]).toByteArray(),m=[],b=0;b<16;)m.push(parseInt(_[b],10)&parseInt(E[b],10)),b++;return new this(m)}catch(D){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${D})`)}},v.IPv6.parse=function(d){let g=this.parser(d);if(g.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(g.parts,g.zoneId)},v.IPv6.parseCIDR=function(d){let g,b,_;if((b=d.match(/^(.+)\/(\d+)$/))&&(g=parseInt(b[2]),g>=0&&g<=128))return _=[this.parse(b[1]),g],Object.defineProperty(_,"toString",{value:function(){return this.join("/")}}),_;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},v.IPv6.parser=function(d){let g,b,_,m,E,D;if(_=d.match(u.deprecatedTransitional))return this.parser(`::ffff:${_[1]}`);if(u.native.test(d))return h(d,8);if((_=d.match(u.transitional))&&(D=_[6]||"",g=h(_[1].slice(0,-1)+D,6),g.parts)){for(E=[parseInt(_[2]),parseInt(_[3]),parseInt(_[4]),parseInt(_[5])],b=0;b<E.length;b++)if(m=E[b],!(0<=m&&m<=255))return null;return g.parts.push(E[0]<<8|E[1]),g.parts.push(E[2]<<8|E[3]),{parts:g.parts,zoneId:g.zoneId}}return null},v.IPv6.subnetMaskFromPrefixLength=function(d){if(d=parseInt(d),d<0||d>128)throw new Error("ipaddr: invalid IPv6 prefix length");let g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0,_=Math.floor(d/8);for(;b<_;)g[b]=255,b++;return _<16&&(g[_]=Math.pow(2,d%8)-1<<8-d%8),new this(g)},v.fromByteArray=function(d){let g=d.length;if(g===4)return new v.IPv4(d);if(g===16)return new v.IPv6(d);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},v.isValid=function(d){return v.IPv6.isValid(d)||v.IPv4.isValid(d)},v.parse=function(d){if(v.IPv6.isValid(d))return v.IPv6.parse(d);if(v.IPv4.isValid(d))return v.IPv4.parse(d);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},v.parseCIDR=function(d){try{return v.IPv6.parseCIDR(d)}catch{try{return v.IPv4.parseCIDR(d)}catch{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},v.process=function(d){let g=this.parse(d);return g.kind()==="ipv6"&&g.isIPv4MappedAddress()?g.toIPv4Address():g},v.subnetMatch=function(d,g,b){let _,m,E,D;b==null&&(b="unicast");for(m in g)if(Object.prototype.hasOwnProperty.call(g,m)){for(E=g[m],E[0]&&!(E[0]instanceof Array)&&(E=[E]),_=0;_<E.length;_++)if(D=E[_],d.kind()===D[0].kind()&&d.match.apply(d,D))return m}return b},typeof t<"u"&&t.exports?t.exports=v:r.ipaddr=v}(e)}),oae=A(e=>{"use strict";c();var t=e&&e.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(e,"__esModule",{value:!0});var r=Yse(),n=t(VP()),i=t(Jse()),s=tae(),a=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],o=a.map(h=>new r.Netmask(h));function l(h){for(let f of o)if(f.contains(h))return!0;return!1}function u(h){return/^::$/.test(h)||/^::1$/.test(h)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(h)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(h)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(h)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(h)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(h)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(h)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(h)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(h)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(h)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(h)||/^ff([0-9a-fA-F]{2,2}):/i.test(h)}e.default=h=>{if(s.isValid(h)){let f=s.parse(h);if(f.kind()==="ipv4")return l(f.toNormalizedString());if(f.kind()==="ipv6")return u(h)}else if(i.default(h)&&n.default.v6().test(h))return u(h)}}),Jb=A((e,t)=>{"use strict";c(),t.exports=oae().default}),Bae=A((e,t)=>{"use strict";c();function r(i){return i>=55296&&i<=56319}function n(i){return i>=56320&&i<=57343}t.exports=function(i,s,a){if(typeof s!="string")throw new Error("Input must be string");for(var o=s.length,l=0,u,h,f=0;f<o;f+=1){if(u=s.charCodeAt(f),h=s[f],r(u)&&n(s.charCodeAt(f+1))&&(f+=1,h+=s[f]),l+=i(h),l===a)return s.slice(0,f+1);if(l>a)return s.slice(0,f-h.length+1)}return s}}),Uae=A((e,t)=>{"use strict";c();function r(i){return i>=55296&&i<=56319}function n(i){return i>=56320&&i<=57343}t.exports=function(i){if(typeof i!="string")throw new Error("Input must be string");for(var s=i.length,a=0,o=null,l=null,u=0;u<s;u++)o=i.charCodeAt(u),n(o)?l!=null&&r(l)?a+=1:a+=3:o<=127?a+=1:o>=128&&o<=2047?a+=2:o>=2048&&o<=65535&&(a+=3),l=o;return a}}),Kae=A((e,t)=>{"use strict";c();var r=Bae(),n=Uae();t.exports=r.bind(null,n)}),zae=A((e,t)=>{"use strict";c();var r=Kae(),n=/[\/\?<>\\:\*\|"]/g,i=/[\x00-\x1f\x80-\x9f]/g,s=/^\.+$/,a=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,o=/[\. ]+$/;function l(u,h){if(typeof u!="string")throw new Error("Input must be string");var f=u.replace(n,h).replace(i,h).replace(s,h).replace(a,h).replace(o,h);return r(f,255)}t.exports=function(u,h){var f=h&&h.replacement||"",y=l(u,f);return f===""?y:l(y,"")}}),Wae=A((e,t)=>{c();var r=st();Aa(),gr();var n=r.asn1,i=t.exports=r.pkcs7asn1=r.pkcs7asn1||{};r.pkcs7=r.pkcs7||{},r.pkcs7.asn1=i;var s={name:"ContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};i.contentInfoValidator=s;var a={name:"EncryptedContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};i.envelopedDataValidator={name:"EnvelopedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(a)},i.encryptedDataValidator={name:"EncryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"}].concat(a)};var o={name:"SignerInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};i.signedDataValidator={name:"SignedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},s,{name:"SignedData.Certificates",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,capture:"signerInfos",optional:!0,value:[o]}]},i.recipientInfoValidator={name:"RecipientInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}),Yae=A((e,t)=>{c();var r=st();gr(),r.mgf=r.mgf||{};var n=t.exports=r.mgf.mgf1=r.mgf1=r.mgf1||{};n.create=function(i){var s={generate:function(a,o){for(var l=new r.util.ByteBuffer,u=Math.ceil(o/i.digestLength),h=0;h<u;h++){var f=new r.util.ByteBuffer;f.putInt32(h),i.start(),i.update(a+f.getBytes()),l.putBuffer(i.digest())}return l.truncate(l.length()-o),l.getBytes()}};return s}}),Xae=A((e,t)=>{c();var r=st();Yae(),t.exports=r.mgf=r.mgf||{},r.mgf.mgf1=r.mgf1}),Jae=A((e,t)=>{c();var r=st();nh(),gr();var n=t.exports=r.pss=r.pss||{};n.create=function(i){arguments.length===3&&(i={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var s=i.md,a=i.mgf,o=s.digestLength,l=i.salt||null;typeof l=="string"&&(l=r.util.createBuffer(l));var u;if("saltLength"in i)u=i.saltLength;else if(l!==null)u=l.length();else throw new Error("Salt length not specified or specific salt not given.");if(l!==null&&l.length()!==u)throw new Error("Given salt length does not match length of given salt.");var h=i.prng||r.random,f={};return f.encode=function(y,p){var v,d=p-1,g=Math.ceil(d/8),b=y.digest().getBytes();if(g<o+u+2)throw new Error("Message is too long to encrypt.");var _;l===null?_=h.getBytesSync(u):_=l.bytes();var m=new r.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(b),m.putBytes(_),s.start(),s.update(m.getBytes());var E=s.digest().getBytes(),D=new r.util.ByteBuffer;D.fillWithByte(0,g-u-o-2),D.putByte(1),D.putBytes(_);var N=D.getBytes(),R=g-o-1,T=a.generate(E,R),S="";for(v=0;v<R;v++)S+=String.fromCharCode(N.charCodeAt(v)^T.charCodeAt(v));var O=65280>>8*g-d&255;return S=String.fromCharCode(S.charCodeAt(0)&~O)+S.substr(1),S+E+String.fromCharCode(188)},f.verify=function(y,p,v){var d,g=v-1,b=Math.ceil(g/8);if(p=p.substr(-b),b<o+u+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(p.charCodeAt(b-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var _=b-o-1,m=p.substr(0,_),E=p.substr(_,o),D=65280>>8*b-g&255;if((m.charCodeAt(0)&D)!==0)throw new Error("Bits beyond keysize not zero as expected.");var N=a.generate(E,_),R="";for(d=0;d<_;d++)R+=String.fromCharCode(m.charCodeAt(d)^N.charCodeAt(d));R=String.fromCharCode(R.charCodeAt(0)&~D)+R.substr(1);var T=b-o-u-2;for(d=0;d<T;d++)if(R.charCodeAt(d)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(T)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var S=R.substr(-u),O=new r.util.ByteBuffer;O.fillWithByte(0,8),O.putBytes(y),O.putBytes(S),s.start(),s.update(O.getBytes());var F=s.digest().getBytes();return E===F},f}}),tD=A((e,t)=>{c();var r=st();jp(),Aa(),jw(),sl(),Xae(),$p(),Zw(),Jae(),sh(),gr();var n=r.asn1,i=t.exports=r.pki=r.pki||{},s=i.oids,a={};a.CN=s.commonName,a.commonName="CN",a.C=s.countryName,a.countryName="C",a.L=s.localityName,a.localityName="L",a.ST=s.stateOrProvinceName,a.stateOrProvinceName="ST",a.O=s.organizationName,a.organizationName="O",a.OU=s.organizationalUnitName,a.organizationalUnitName="OU",a.E=s.emailAddress,a.emailAddress="E";var o=r.pki.rsa.publicKeyValidator,l={name:"Certificate",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:n.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:n.Class.UNIVERSAL,type:n.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:n.Class.UNIVERSAL,type:n.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:n.Class.UNIVERSAL,type:n.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:n.Class.UNIVERSAL,type:n.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},o,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:n.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:n.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:n.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},u={name:"rsapss",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:n.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:n.Class.UNIVERSAL,type:n.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:n.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:n.Class.UNIVERSAL,type:n.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},o,{name:"CertificationRequestInfo.attributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0}]}]}]},f={name:"CertificationRequest",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:n.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};i.RDNAttributesAsArray=function(T,S){for(var O=[],F,G,ne,Y=0;Y<T.value.length;++Y){F=T.value[Y];for(var ce=0;ce<F.value.length;++ce)ne={},G=F.value[ce],ne.type=n.derToOid(G.value[0].value),ne.value=G.value[1].value,ne.valueTagClass=G.value[1].type,ne.type in s&&(ne.name=s[ne.type],ne.name in a&&(ne.shortName=a[ne.name])),S&&(S.update(ne.type),S.update(ne.value)),O.push(ne)}return O},i.CRIAttributesAsArray=function(T){for(var S=[],O=0;O<T.length;++O)for(var F=T[O],G=n.derToOid(F.value[0].value),ne=F.value[1].value,Y=0;Y<ne.length;++Y){var ce={};if(ce.type=G,ce.value=ne[Y].value,ce.valueTagClass=ne[Y].type,ce.type in s&&(ce.name=s[ce.type],ce.name in a&&(ce.shortName=a[ce.name])),ce.type===s.extensionRequest){ce.extensions=[];for(var oe=0;oe<ce.value.length;++oe)ce.extensions.push(i.certificateExtensionFromAsn1(ce.value[oe]))}S.push(ce)}return S};function y(T,S){typeof S=="string"&&(S={shortName:S});for(var O=null,F,G=0;O===null&&G<T.attributes.length;++G)F=T.attributes[G],(S.type&&S.type===F.type||S.name&&S.name===F.name||S.shortName&&S.shortName===F.shortName)&&(O=F);return O}var p=function(T,S,O){var F={};if(T!==s["RSASSA-PSS"])return F;O&&(F={hash:{algorithmOid:s.sha1},mgf:{algorithmOid:s.mgf1,hash:{algorithmOid:s.sha1}},saltLength:20});var G={},ne=[];if(!n.validate(S,u,G,ne)){var Y=new Error("Cannot read RSASSA-PSS parameter block.");throw Y.errors=ne,Y}return G.hashOid!==void 0&&(F.hash=F.hash||{},F.hash.algorithmOid=n.derToOid(G.hashOid)),G.maskGenOid!==void 0&&(F.mgf=F.mgf||{},F.mgf.algorithmOid=n.derToOid(G.maskGenOid),F.mgf.hash=F.mgf.hash||{},F.mgf.hash.algorithmOid=n.derToOid(G.maskGenHashOid)),G.saltLength!==void 0&&(F.saltLength=G.saltLength.charCodeAt(0)),F},v=function(T){switch(s[T.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return r.md.sha1.create();case"md5WithRSAEncryption":return r.md.md5.create();case"sha256WithRSAEncryption":return r.md.sha256.create();case"sha384WithRSAEncryption":return r.md.sha384.create();case"sha512WithRSAEncryption":return r.md.sha512.create();case"RSASSA-PSS":return r.md.sha256.create();default:var S=new Error("Could not compute "+T.type+" digest. Unknown signature OID.");throw S.signatureOid=T.signatureOid,S}},d=function(T){var S=T.certificate,O;switch(S.signatureOid){case s.sha1WithRSAEncryption:case s.sha1WithRSASignature:break;case s["RSASSA-PSS"]:var F,G;if(F=s[S.signatureParameters.mgf.hash.algorithmOid],F===void 0||r.md[F]===void 0){var ne=new Error("Unsupported MGF hash function.");throw ne.oid=S.signatureParameters.mgf.hash.algorithmOid,ne.name=F,ne}if(G=s[S.signatureParameters.mgf.algorithmOid],G===void 0||r.mgf[G]===void 0){var ne=new Error("Unsupported MGF function.");throw ne.oid=S.signatureParameters.mgf.algorithmOid,ne.name=G,ne}if(G=r.mgf[G].create(r.md[F].create()),F=s[S.signatureParameters.hash.algorithmOid],F===void 0||r.md[F]===void 0){var ne=new Error("Unsupported RSASSA-PSS hash function.");throw ne.oid=S.signatureParameters.hash.algorithmOid,ne.name=F,ne}O=r.pss.create(r.md[F].create(),G,S.signatureParameters.saltLength);break}return S.publicKey.verify(T.md.digest().getBytes(),T.signature,O)};i.certificateFromPem=function(T,S,O){var F=r.pem.decode(T)[0];if(F.type!=="CERTIFICATE"&&F.type!=="X509 CERTIFICATE"&&F.type!=="TRUSTED CERTIFICATE"){var G=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw G.headerType=F.type,G}if(F.procType&&F.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ne=n.fromDer(F.body,O);return i.certificateFromAsn1(ne,S)},i.certificateToPem=function(T,S){var O={type:"CERTIFICATE",body:n.toDer(i.certificateToAsn1(T)).getBytes()};return r.pem.encode(O,{maxline:S})},i.publicKeyFromPem=function(T){var S=r.pem.decode(T)[0];if(S.type!=="PUBLIC KEY"&&S.type!=="RSA PUBLIC KEY"){var O=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw O.headerType=S.type,O}if(S.procType&&S.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var F=n.fromDer(S.body);return i.publicKeyFromAsn1(F)},i.publicKeyToPem=function(T,S){var O={type:"PUBLIC KEY",body:n.toDer(i.publicKeyToAsn1(T)).getBytes()};return r.pem.encode(O,{maxline:S})},i.publicKeyToRSAPublicKeyPem=function(T,S){var O={type:"RSA PUBLIC KEY",body:n.toDer(i.publicKeyToRSAPublicKey(T)).getBytes()};return r.pem.encode(O,{maxline:S})},i.getPublicKeyFingerprint=function(T,S){S=S||{};var O=S.md||r.md.sha1.create(),F=S.type||"RSAPublicKey",G;switch(F){case"RSAPublicKey":G=n.toDer(i.publicKeyToRSAPublicKey(T)).getBytes();break;case"SubjectPublicKeyInfo":G=n.toDer(i.publicKeyToAsn1(T)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+S.type+'".')}O.start(),O.update(G);var ne=O.digest();if(S.encoding==="hex"){var Y=ne.toHex();return S.delimiter?Y.match(/.{2}/g).join(S.delimiter):Y}else{if(S.encoding==="binary")return ne.getBytes();if(S.encoding)throw new Error('Unknown encoding "'+S.encoding+'".')}return ne},i.certificationRequestFromPem=function(T,S,O){var F=r.pem.decode(T)[0];if(F.type!=="CERTIFICATE REQUEST"){var G=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw G.headerType=F.type,G}if(F.procType&&F.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var ne=n.fromDer(F.body,O);return i.certificationRequestFromAsn1(ne,S)},i.certificationRequestToPem=function(T,S){var O={type:"CERTIFICATE REQUEST",body:n.toDer(i.certificationRequestToAsn1(T)).getBytes()};return r.pem.encode(O,{maxline:S})},i.createCertificate=function(){var T={};return T.version=2,T.serialNumber="00",T.signatureOid=null,T.signature=null,T.siginfo={},T.siginfo.algorithmOid=null,T.validity={},T.validity.notBefore=new Date,T.validity.notAfter=new Date,T.issuer={},T.issuer.getField=function(S){return y(T.issuer,S)},T.issuer.addField=function(S){b([S]),T.issuer.attributes.push(S)},T.issuer.attributes=[],T.issuer.hash=null,T.subject={},T.subject.getField=function(S){return y(T.subject,S)},T.subject.addField=function(S){b([S]),T.subject.attributes.push(S)},T.subject.attributes=[],T.subject.hash=null,T.extensions=[],T.publicKey=null,T.md=null,T.setSubject=function(S,O){b(S),T.subject.attributes=S,delete T.subject.uniqueId,O&&(T.subject.uniqueId=O),T.subject.hash=null},T.setIssuer=function(S,O){b(S),T.issuer.attributes=S,delete T.issuer.uniqueId,O&&(T.issuer.uniqueId=O),T.issuer.hash=null},T.setExtensions=function(S){for(var O=0;O<S.length;++O)_(S[O],{cert:T});T.extensions=S},T.getExtension=function(S){typeof S=="string"&&(S={name:S});for(var O=null,F,G=0;O===null&&G<T.extensions.length;++G)F=T.extensions[G],(S.id&&F.id===S.id||S.name&&F.name===S.name)&&(O=F);return O},T.sign=function(S,O){T.md=O||r.md.sha1.create();var F=s[T.md.algorithm+"WithRSAEncryption"];if(!F){var G=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw G.algorithm=T.md.algorithm,G}T.signatureOid=T.siginfo.algorithmOid=F,T.tbsCertificate=i.getTBSCertificate(T);var ne=n.toDer(T.tbsCertificate);T.md.update(ne.getBytes()),T.signature=S.sign(T.md)},T.verify=function(S){var O=!1;if(!T.issued(S)){var F=S.issuer,G=T.subject,ne=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw ne.expectedIssuer=G.attributes,ne.actualIssuer=F.attributes,ne}var Y=S.md;if(Y===null){Y=v({signatureOid:S.signatureOid,type:"certificate"});var ce=S.tbsCertificate||i.getTBSCertificate(S),oe=n.toDer(ce);Y.update(oe.getBytes())}return Y!==null&&(O=d({certificate:T,md:Y,signature:S.signature})),O},T.isIssuer=function(S){var O=!1,F=T.issuer,G=S.subject;if(F.hash&&G.hash)O=F.hash===G.hash;else if(F.attributes.length===G.attributes.length){O=!0;for(var ne,Y,ce=0;O&&ce<F.attributes.length;++ce)ne=F.attributes[ce],Y=G.attributes[ce],(ne.type!==Y.type||ne.value!==Y.value)&&(O=!1)}return O},T.issued=function(S){return S.isIssuer(T)},T.generateSubjectKeyIdentifier=function(){return i.getPublicKeyFingerprint(T.publicKey,{type:"RSAPublicKey"})},T.verifySubjectKeyIdentifier=function(){for(var S=s.subjectKeyIdentifier,O=0;O<T.extensions.length;++O){var F=T.extensions[O];if(F.id===S){var G=T.generateSubjectKeyIdentifier().getBytes();return r.util.hexToBytes(F.subjectKeyIdentifier)===G}}return!1},T},i.certificateFromAsn1=function(T,S){var O={},F=[];if(!n.validate(T,l,O,F)){var G=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw G.errors=F,G}var ne=n.derToOid(O.publicKeyOid);if(ne!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var Y=i.createCertificate();Y.version=O.certVersion?O.certVersion.charCodeAt(0):0;var ce=r.util.createBuffer(O.certSerialNumber);Y.serialNumber=ce.toHex(),Y.signatureOid=r.asn1.derToOid(O.certSignatureOid),Y.signatureParameters=p(Y.signatureOid,O.certSignatureParams,!0),Y.siginfo.algorithmOid=r.asn1.derToOid(O.certinfoSignatureOid),Y.siginfo.parameters=p(Y.siginfo.algorithmOid,O.certinfoSignatureParams,!1),Y.signature=O.certSignature;var oe=[];if(O.certValidity1UTCTime!==void 0&&oe.push(n.utcTimeToDate(O.certValidity1UTCTime)),O.certValidity2GeneralizedTime!==void 0&&oe.push(n.generalizedTimeToDate(O.certValidity2GeneralizedTime)),O.certValidity3UTCTime!==void 0&&oe.push(n.utcTimeToDate(O.certValidity3UTCTime)),O.certValidity4GeneralizedTime!==void 0&&oe.push(n.generalizedTimeToDate(O.certValidity4GeneralizedTime)),oe.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(oe.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(Y.validity.notBefore=oe[0],Y.validity.notAfter=oe[1],Y.tbsCertificate=O.tbsCertificate,S){Y.md=v({signatureOid:Y.signatureOid,type:"certificate"});var H=n.toDer(Y.tbsCertificate);Y.md.update(H.getBytes())}var W=r.md.sha1.create(),de=n.toDer(O.certIssuer);W.update(de.getBytes()),Y.issuer.getField=function($e){return y(Y.issuer,$e)},Y.issuer.addField=function($e){b([$e]),Y.issuer.attributes.push($e)},Y.issuer.attributes=i.RDNAttributesAsArray(O.certIssuer),O.certIssuerUniqueId&&(Y.issuer.uniqueId=O.certIssuerUniqueId),Y.issuer.hash=W.digest().toHex();var De=r.md.sha1.create(),Pe=n.toDer(O.certSubject);return De.update(Pe.getBytes()),Y.subject.getField=function($e){return y(Y.subject,$e)},Y.subject.addField=function($e){b([$e]),Y.subject.attributes.push($e)},Y.subject.attributes=i.RDNAttributesAsArray(O.certSubject),O.certSubjectUniqueId&&(Y.subject.uniqueId=O.certSubjectUniqueId),Y.subject.hash=De.digest().toHex(),O.certExtensions?Y.extensions=i.certificateExtensionsFromAsn1(O.certExtensions):Y.extensions=[],Y.publicKey=i.publicKeyFromAsn1(O.subjectPublicKeyInfo),Y},i.certificateExtensionsFromAsn1=function(T){for(var S=[],O=0;O<T.value.length;++O)for(var F=T.value[O],G=0;G<F.value.length;++G)S.push(i.certificateExtensionFromAsn1(F.value[G]));return S},i.certificateExtensionFromAsn1=function(T){var S={};if(S.id=n.derToOid(T.value[0].value),S.critical=!1,T.value[1].type===n.Type.BOOLEAN?(S.critical=T.value[1].value.charCodeAt(0)!==0,S.value=T.value[2].value):S.value=T.value[1].value,S.id in s){if(S.name=s[S.id],S.name==="keyUsage"){var O=n.fromDer(S.value),F=0,G=0;O.value.length>1&&(F=O.value.charCodeAt(1),G=O.value.length>2?O.value.charCodeAt(2):0),S.digitalSignature=(F&128)===128,S.nonRepudiation=(F&64)===64,S.keyEncipherment=(F&32)===32,S.dataEncipherment=(F&16)===16,S.keyAgreement=(F&8)===8,S.keyCertSign=(F&4)===4,S.cRLSign=(F&2)===2,S.encipherOnly=(F&1)===1,S.decipherOnly=(G&128)===128}else if(S.name==="basicConstraints"){var O=n.fromDer(S.value);O.value.length>0&&O.value[0].type===n.Type.BOOLEAN?S.cA=O.value[0].value.charCodeAt(0)!==0:S.cA=!1;var ne=null;O.value.length>0&&O.value[0].type===n.Type.INTEGER?ne=O.value[0].value:O.value.length>1&&(ne=O.value[1].value),ne!==null&&(S.pathLenConstraint=n.derToInteger(ne))}else if(S.name==="extKeyUsage")for(var O=n.fromDer(S.value),Y=0;Y<O.value.length;++Y){var ce=n.derToOid(O.value[Y].value);ce in s?S[s[ce]]=!0:S[ce]=!0}else if(S.name==="nsCertType"){var O=n.fromDer(S.value),F=0;O.value.length>1&&(F=O.value.charCodeAt(1)),S.client=(F&128)===128,S.server=(F&64)===64,S.email=(F&32)===32,S.objsign=(F&16)===16,S.reserved=(F&8)===8,S.sslCA=(F&4)===4,S.emailCA=(F&2)===2,S.objCA=(F&1)===1}else if(S.name==="subjectAltName"||S.name==="issuerAltName"){S.altNames=[];for(var oe,O=n.fromDer(S.value),H=0;H<O.value.length;++H){oe=O.value[H];var W={type:oe.type,value:oe.value};switch(S.altNames.push(W),oe.type){case 1:case 2:case 6:break;case 7:W.ip=r.util.bytesToIP(oe.value);break;case 8:W.oid=n.derToOid(oe.value);break;default:}}}else if(S.name==="subjectKeyIdentifier"){var O=n.fromDer(S.value);S.subjectKeyIdentifier=r.util.bytesToHex(O.value)}}return S},i.certificationRequestFromAsn1=function(T,S){var O={},F=[];if(!n.validate(T,f,O,F)){var G=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw G.errors=F,G}var ne=n.derToOid(O.publicKeyOid);if(ne!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var Y=i.createCertificationRequest();if(Y.version=O.csrVersion?O.csrVersion.charCodeAt(0):0,Y.signatureOid=r.asn1.derToOid(O.csrSignatureOid),Y.signatureParameters=p(Y.signatureOid,O.csrSignatureParams,!0),Y.siginfo.algorithmOid=r.asn1.derToOid(O.csrSignatureOid),Y.siginfo.parameters=p(Y.siginfo.algorithmOid,O.csrSignatureParams,!1),Y.signature=O.csrSignature,Y.certificationRequestInfo=O.certificationRequestInfo,S){Y.md=v({signatureOid:Y.signatureOid,type:"certification request"});var ce=n.toDer(Y.certificationRequestInfo);Y.md.update(ce.getBytes())}var oe=r.md.sha1.create();return Y.subject.getField=function(H){return y(Y.subject,H)},Y.subject.addField=function(H){b([H]),Y.subject.attributes.push(H)},Y.subject.attributes=i.RDNAttributesAsArray(O.certificationRequestInfoSubject,oe),Y.subject.hash=oe.digest().toHex(),Y.publicKey=i.publicKeyFromAsn1(O.subjectPublicKeyInfo),Y.getAttribute=function(H){return y(Y,H)},Y.addAttribute=function(H){b([H]),Y.attributes.push(H)},Y.attributes=i.CRIAttributesAsArray(O.certificationRequestInfoAttributes||[]),Y},i.createCertificationRequest=function(){var T={};return T.version=0,T.signatureOid=null,T.signature=null,T.siginfo={},T.siginfo.algorithmOid=null,T.subject={},T.subject.getField=function(S){return y(T.subject,S)},T.subject.addField=function(S){b([S]),T.subject.attributes.push(S)},T.subject.attributes=[],T.subject.hash=null,T.publicKey=null,T.attributes=[],T.getAttribute=function(S){return y(T,S)},T.addAttribute=function(S){b([S]),T.attributes.push(S)},T.md=null,T.setSubject=function(S){b(S),T.subject.attributes=S,T.subject.hash=null},T.setAttributes=function(S){b(S),T.attributes=S},T.sign=function(S,O){T.md=O||r.md.sha1.create();var F=s[T.md.algorithm+"WithRSAEncryption"];if(!F){var G=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw G.algorithm=T.md.algorithm,G}T.signatureOid=T.siginfo.algorithmOid=F,T.certificationRequestInfo=i.getCertificationRequestInfo(T);var ne=n.toDer(T.certificationRequestInfo);T.md.update(ne.getBytes()),T.signature=S.sign(T.md)},T.verify=function(){var S=!1,O=T.md;if(O===null){O=v({signatureOid:T.signatureOid,type:"certification request"});var F=T.certificationRequestInfo||i.getCertificationRequestInfo(T),G=n.toDer(F);O.update(G.getBytes())}return O!==null&&(S=d({certificate:T,md:O,signature:T.signature})),S},T};function g(T){for(var S=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),O,F,G=T.attributes,ne=0;ne<G.length;++ne){O=G[ne];var Y=O.value,ce=n.Type.PRINTABLESTRING;"valueTagClass"in O&&(ce=O.valueTagClass,ce===n.Type.UTF8&&(Y=r.util.encodeUtf8(Y))),F=n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(O.type).getBytes()),n.create(n.Class.UNIVERSAL,ce,!1,Y)])]),S.value.push(F)}return S}function b(T){for(var S,O=0;O<T.length;++O){if(S=T[O],typeof S.name>"u"&&(S.type&&S.type in i.oids?S.name=i.oids[S.type]:S.shortName&&S.shortName in a&&(S.name=i.oids[a[S.shortName]])),typeof S.type>"u")if(S.name&&S.name in i.oids)S.type=i.oids[S.name];else{var F=new Error("Attribute type not specified.");throw F.attribute=S,F}if(typeof S.shortName>"u"&&S.name&&S.name in a&&(S.shortName=a[S.name]),S.type===s.extensionRequest&&(S.valueConstructed=!0,S.valueTagClass=n.Type.SEQUENCE,!S.value&&S.extensions)){S.value=[];for(var G=0;G<S.extensions.length;++G)S.value.push(i.certificateExtensionToAsn1(_(S.extensions[G])))}if(typeof S.value>"u"){var F=new Error("Attribute value not specified.");throw F.attribute=S,F}}}function _(T,S){if(S=S||{},typeof T.name>"u"&&T.id&&T.id in i.oids&&(T.name=i.oids[T.id]),typeof T.id>"u")if(T.name&&T.name in i.oids)T.id=i.oids[T.name];else{var O=new Error("Extension ID not specified.");throw O.extension=T,O}if(typeof T.value<"u")return T;if(T.name==="keyUsage"){var F=0,G=0,ne=0;T.digitalSignature&&(G|=128,F=7),T.nonRepudiation&&(G|=64,F=6),T.keyEncipherment&&(G|=32,F=5),T.dataEncipherment&&(G|=16,F=4),T.keyAgreement&&(G|=8,F=3),T.keyCertSign&&(G|=4,F=2),T.cRLSign&&(G|=2,F=1),T.encipherOnly&&(G|=1,F=0),T.decipherOnly&&(ne|=128,F=7);var Y=String.fromCharCode(F);ne!==0?Y+=String.fromCharCode(G)+String.fromCharCode(ne):G!==0&&(Y+=String.fromCharCode(G)),T.value=n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,Y)}else if(T.name==="basicConstraints")T.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),T.cA&&T.value.value.push(n.create(n.Class.UNIVERSAL,n.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in T&&T.value.value.push(n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(T.pathLenConstraint).getBytes()));else if(T.name==="extKeyUsage"){T.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);var ce=T.value.value;for(var oe in T)T[oe]===!0&&(oe in s?ce.push(n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s[oe]).getBytes())):oe.indexOf(".")!==-1&&ce.push(n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(oe).getBytes())))}else if(T.name==="nsCertType"){var F=0,G=0;T.client&&(G|=128,F=7),T.server&&(G|=64,F=6),T.email&&(G|=32,F=5),T.objsign&&(G|=16,F=4),T.reserved&&(G|=8,F=3),T.sslCA&&(G|=4,F=2),T.emailCA&&(G|=2,F=1),T.objCA&&(G|=1,F=0);var Y=String.fromCharCode(F);G!==0&&(Y+=String.fromCharCode(G)),T.value=n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,Y)}else if(T.name==="subjectAltName"||T.name==="issuerAltName"){T.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);for(var H,W=0;W<T.altNames.length;++W){H=T.altNames[W];var Y=H.value;if(H.type===7&&H.ip){if(Y=r.util.bytesFromIP(H.ip),Y===null){var O=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw O.extension=T,O}}else H.type===8&&(H.oid?Y=n.oidToDer(n.oidToDer(H.oid)):Y=n.oidToDer(Y));T.value.value.push(n.create(n.Class.CONTEXT_SPECIFIC,H.type,!1,Y))}}else if(T.name==="nsComment"&&S.cert){if(!/^[\x00-\x7F]*$/.test(T.comment)||T.comment.length<1||T.comment.length>128)throw new Error('Invalid "nsComment" content.');T.value=n.create(n.Class.UNIVERSAL,n.Type.IA5STRING,!1,T.comment)}else if(T.name==="subjectKeyIdentifier"&&S.cert){var de=S.cert.generateSubjectKeyIdentifier();T.subjectKeyIdentifier=de.toHex(),T.value=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,de.getBytes())}else if(T.name==="authorityKeyIdentifier"&&S.cert){T.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);var ce=T.value.value;if(T.keyIdentifier){var De=T.keyIdentifier===!0?S.cert.generateSubjectKeyIdentifier().getBytes():T.keyIdentifier;ce.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!1,De))}if(T.authorityCertIssuer){var Pe=[n.create(n.Class.CONTEXT_SPECIFIC,4,!0,[g(T.authorityCertIssuer===!0?S.cert.issuer:T.authorityCertIssuer)])];ce.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!0,Pe))}if(T.serialNumber){var $e=r.util.hexToBytes(T.serialNumber===!0?S.cert.serialNumber:T.serialNumber);ce.push(n.create(n.Class.CONTEXT_SPECIFIC,2,!1,$e))}}else if(T.name==="cRLDistributionPoints"){T.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);for(var ce=T.value.value,Be=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),nt=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[]),H,W=0;W<T.altNames.length;++W){H=T.altNames[W];var Y=H.value;if(H.type===7&&H.ip){if(Y=r.util.bytesFromIP(H.ip),Y===null){var O=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw O.extension=T,O}}else H.type===8&&(H.oid?Y=n.oidToDer(n.oidToDer(H.oid)):Y=n.oidToDer(Y));nt.value.push(n.create(n.Class.CONTEXT_SPECIFIC,H.type,!1,Y))}Be.value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[nt])),ce.push(Be)}if(typeof T.value>"u"){var O=new Error("Extension value not specified.");throw O.extension=T,O}return T}function m(T,S){switch(T){case s["RSASSA-PSS"]:var O=[];return S.hash.algorithmOid!==void 0&&O.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(S.hash.algorithmOid).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])])),S.mgf.algorithmOid!==void 0&&O.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(S.mgf.algorithmOid).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(S.mgf.hash.algorithmOid).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])])])),S.saltLength!==void 0&&O.push(n.create(n.Class.CONTEXT_SPECIFIC,2,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(S.saltLength).getBytes())])),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,O);default:return n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")}}function E(T){var S=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[]);if(T.attributes.length===0)return S;for(var O=T.attributes,F=0;F<O.length;++F){var G=O[F],ne=G.value,Y=n.Type.UTF8;"valueTagClass"in G&&(Y=G.valueTagClass),Y===n.Type.UTF8&&(ne=r.util.encodeUtf8(ne));var ce=!1;"valueConstructed"in G&&(ce=G.valueConstructed);var oe=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(G.type).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[n.create(n.Class.UNIVERSAL,Y,ce,ne)])]);S.value.push(oe)}return S}var D=new Date("1950-01-01T00:00:00Z"),N=new Date("2050-01-01T00:00:00Z");function R(T){return T>=D&&T<N?n.create(n.Class.UNIVERSAL,n.Type.UTCTIME,!1,n.dateToUtcTime(T)):n.create(n.Class.UNIVERSAL,n.Type.GENERALIZEDTIME,!1,n.dateToGeneralizedTime(T))}i.getTBSCertificate=function(T){var S=R(T.validity.notBefore),O=R(T.validity.notAfter),F=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(T.version).getBytes())]),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,r.util.hexToBytes(T.serialNumber)),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(T.siginfo.algorithmOid).getBytes()),m(T.siginfo.algorithmOid,T.siginfo.parameters)]),g(T.issuer),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[S,O]),g(T.subject),i.publicKeyToAsn1(T.publicKey)]);return T.issuer.uniqueId&&F.value.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!0,[n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+T.issuer.uniqueId)])),T.subject.uniqueId&&F.value.push(n.create(n.Class.CONTEXT_SPECIFIC,2,!0,[n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+T.subject.uniqueId)])),T.extensions.length>0&&F.value.push(i.certificateExtensionsToAsn1(T.extensions)),F},i.getCertificationRequestInfo=function(T){var S=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(T.version).getBytes()),g(T.subject),i.publicKeyToAsn1(T.publicKey),E(T)]);return S},i.distinguishedNameToAsn1=function(T){return g(T)},i.certificateToAsn1=function(T){var S=T.tbsCertificate||i.getTBSCertificate(T);return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[S,n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(T.signatureOid).getBytes()),m(T.signatureOid,T.signatureParameters)]),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+T.signature)])},i.certificateExtensionsToAsn1=function(T){var S=n.create(n.Class.CONTEXT_SPECIFIC,3,!0,[]),O=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);S.value.push(O);for(var F=0;F<T.length;++F)O.value.push(i.certificateExtensionToAsn1(T[F]));return S},i.certificateExtensionToAsn1=function(T){var S=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);S.value.push(n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(T.id).getBytes())),T.critical&&S.value.push(n.create(n.Class.UNIVERSAL,n.Type.BOOLEAN,!1,String.fromCharCode(255)));var O=T.value;return typeof T.value!="string"&&(O=n.toDer(O).getBytes()),S.value.push(n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,O)),S},i.certificationRequestToAsn1=function(T){var S=T.certificationRequestInfo||i.getCertificationRequestInfo(T);return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[S,n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(T.signatureOid).getBytes()),m(T.signatureOid,T.signatureParameters)]),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+T.signature)])},i.createCaStore=function(T){var S={certs:{}};S.getIssuer=function(Y){var ce=O(Y.issuer);return ce},S.addCertificate=function(Y){if(typeof Y=="string"&&(Y=r.pki.certificateFromPem(Y)),F(Y.subject),!S.hasCertificate(Y))if(Y.subject.hash in S.certs){var ce=S.certs[Y.subject.hash];r.util.isArray(ce)||(ce=[ce]),ce.push(Y),S.certs[Y.subject.hash]=ce}else S.certs[Y.subject.hash]=Y},S.hasCertificate=function(Y){typeof Y=="string"&&(Y=r.pki.certificateFromPem(Y));var ce=O(Y.subject);if(!ce)return!1;r.util.isArray(ce)||(ce=[ce]);for(var oe=n.toDer(i.certificateToAsn1(Y)).getBytes(),H=0;H<ce.length;++H){var W=n.toDer(i.certificateToAsn1(ce[H])).getBytes();if(oe===W)return!0}return!1},S.listAllCertificates=function(){var Y=[];for(var ce in S.certs)if(S.certs.hasOwnProperty(ce)){var oe=S.certs[ce];if(!r.util.isArray(oe))Y.push(oe);else for(var H=0;H<oe.length;++H)Y.push(oe[H])}return Y},S.removeCertificate=function(Y){var ce;if(typeof Y=="string"&&(Y=r.pki.certificateFromPem(Y)),F(Y.subject),!S.hasCertificate(Y))return null;var oe=O(Y.subject);if(!r.util.isArray(oe))return ce=S.certs[Y.subject.hash],delete S.certs[Y.subject.hash],ce;for(var H=n.toDer(i.certificateToAsn1(Y)).getBytes(),W=0;W<oe.length;++W){var de=n.toDer(i.certificateToAsn1(oe[W])).getBytes();H===de&&(ce=oe[W],oe.splice(W,1))}return oe.length===0&&delete S.certs[Y.subject.hash],ce};function O(Y){return F(Y),S.certs[Y.hash]||null}function F(Y){if(!Y.hash){var ce=r.md.sha1.create();Y.attributes=i.RDNAttributesAsArray(g(Y),ce),Y.hash=ce.digest().toHex()}}if(T)for(var G=0;G<T.length;++G){var ne=T[G];S.addCertificate(ne)}return S},i.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},i.verifyCertificateChain=function(T,S,O){typeof O=="function"&&(O={verify:O}),O=O||{},S=S.slice(0);var F=S.slice(0),G=O.validityCheckDate;typeof G>"u"&&(G=new Date);var ne=!0,Y=null,ce=0;do{var oe=S.shift(),H=null,W=!1;if(G&&(G<oe.validity.notBefore||G>oe.validity.notAfter)&&(Y={message:"Certificate is not valid yet or has expired.",error:i.certificateError.certificate_expired,notBefore:oe.validity.notBefore,notAfter:oe.validity.notAfter,now:G}),Y===null){if(H=S[0]||T.getIssuer(oe),H===null&&oe.isIssuer(oe)&&(W=!0,H=oe),H){var de=H;r.util.isArray(de)||(de=[de]);for(var De=!1;!De&&de.length>0;){H=de.shift();try{De=H.verify(oe)}catch{}}De||(Y={message:"Certificate signature is invalid.",error:i.certificateError.bad_certificate})}Y===null&&(!H||W)&&!T.hasCertificate(oe)&&(Y={message:"Certificate is not trusted.",error:i.certificateError.unknown_ca})}if(Y===null&&H&&!oe.isIssuer(H)&&(Y={message:"Certificate issuer is invalid.",error:i.certificateError.bad_certificate}),Y===null)for(var Pe={keyUsage:!0,basicConstraints:!0},$e=0;Y===null&&$e<oe.extensions.length;++$e){var Be=oe.extensions[$e];Be.critical&&!(Be.name in Pe)&&(Y={message:"Certificate has an unsupported critical extension.",error:i.certificateError.unsupported_certificate})}if(Y===null&&(!ne||S.length===0&&(!H||W))){var nt=oe.getExtension("basicConstraints"),Ve=oe.getExtension("keyUsage");if(Ve!==null&&(!Ve.keyCertSign||nt===null)&&(Y={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:i.certificateError.bad_certificate}),Y===null&&nt!==null&&!nt.cA&&(Y={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:i.certificateError.bad_certificate}),Y===null&&Ve!==null&&"pathLenConstraint"in nt){var et=ce-1;et>nt.pathLenConstraint&&(Y={message:"Certificate basicConstraints pathLenConstraint violated.",error:i.certificateError.bad_certificate})}}var ht=Y===null?!0:Y.error,Z=O.verify?O.verify(ht,ce,F):ht;if(Z===!0)Y=null;else throw ht===!0&&(Y={message:"The application rejected the certificate.",error:i.certificateError.bad_certificate}),(Z||Z===0)&&(typeof Z=="object"&&!r.util.isArray(Z)?(Z.message&&(Y.message=Z.message),Z.error&&(Y.error=Z.error)):typeof Z=="string"&&(Y.error=Z)),Y;ne=!1,++ce}while(S.length>0);return!0}}),ace=A((e,t)=>{c();var r=st();jp(),Aa(),jw(),$p(),Zw(),Wae(),nh(),gr(),tD();var n=r.asn1,i=t.exports=r.pkcs7=r.pkcs7||{};i.messageFromPem=function(d){var g=r.pem.decode(d)[0];if(g.type!=="PKCS7"){var b=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw b.headerType=g.type,b}if(g.procType&&g.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var _=n.fromDer(g.body);return i.messageFromAsn1(_)},i.messageToPem=function(d,g){var b={type:"PKCS7",body:n.toDer(d.toAsn1()).getBytes()};return r.pem.encode(b,{maxline:g})},i.messageFromAsn1=function(d){var g={},b=[];if(!n.validate(d,i.asn1.contentInfoValidator,g,b)){var _=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw _.errors=b,_}var m=n.derToOid(g.contentType),E;switch(m){case r.pki.oids.envelopedData:E=i.createEnvelopedData();break;case r.pki.oids.encryptedData:E=i.createEncryptedData();break;case r.pki.oids.signedData:E=i.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+m+" is not (yet) supported.")}return E.fromAsn1(g.content.value[0]),E},i.createSignedData=function(){var d=null;return d={type:r.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(_){if(p(d,_,i.asn1.signedDataValidator),d.certificates=[],d.crls=[],d.digestAlgorithmIdentifiers=[],d.contentInfo=null,d.signerInfos=[],d.rawCapture.certificates)for(var m=d.rawCapture.certificates.value,E=0;E<m.length;++E)d.certificates.push(r.pki.certificateFromAsn1(m[E]))},toAsn1:function(){d.contentInfo||d.sign();for(var _=[],m=0;m<d.certificates.length;++m)_.push(r.pki.certificateToAsn1(d.certificates[m]));var E=[],D=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(d.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,d.digestAlgorithmIdentifiers),d.contentInfo])]);return _.length>0&&D.value[0].value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,_)),E.length>0&&D.value[0].value.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!0,E)),D.value[0].value.push(n.create(n.Class.UNIVERSAL,n.Type.SET,!0,d.signerInfos)),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(d.type).getBytes()),D])},addSigner:function(_){var m=_.issuer,E=_.serialNumber;if(_.certificate){var D=_.certificate;typeof D=="string"&&(D=r.pki.certificateFromPem(D)),m=D.issuer.attributes,E=D.serialNumber}var N=_.key;if(!N)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof N=="string"&&(N=r.pki.privateKeyFromPem(N));var R=_.digestAlgorithm||r.pki.oids.sha1;switch(R){case r.pki.oids.sha1:case r.pki.oids.sha256:case r.pki.oids.sha384:case r.pki.oids.sha512:case r.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+R)}var T=_.authenticatedAttributes||[];if(T.length>0){for(var S=!1,O=!1,F=0;F<T.length;++F){var G=T[F];if(!S&&G.type===r.pki.oids.contentType){if(S=!0,O)break;continue}if(!O&&G.type===r.pki.oids.messageDigest){if(O=!0,S)break;continue}}if(!S||!O)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}d.signers.push({key:N,version:1,issuer:m,serialNumber:E,digestAlgorithm:R,signatureAlgorithm:r.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:T,unauthenticatedAttributes:[]})},sign:function(_){if(_=_||{},(typeof d.content!="object"||d.contentInfo===null)&&(d.contentInfo=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(r.pki.oids.data).getBytes())]),"content"in d)){var m;d.content instanceof r.util.ByteBuffer?m=d.content.bytes():typeof d.content=="string"&&(m=r.util.encodeUtf8(d.content)),_.detached?d.detachedContent=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,m):d.contentInfo.value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,m)]))}if(d.signers.length!==0){var E=g();b(E)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(_){typeof _=="string"&&(_=r.pki.certificateFromPem(_)),d.certificates.push(_)},addCertificateRevokationList:function(_){throw new Error("PKCS#7 CRL support not yet implemented.")}},d;function g(){for(var _={},m=0;m<d.signers.length;++m){var E=d.signers[m],D=E.digestAlgorithm;D in _||(_[D]=r.md[r.pki.oids[D]].create()),E.authenticatedAttributes.length===0?E.md=_[D]:E.md=r.md[r.pki.oids[D]].create()}d.digestAlgorithmIdentifiers=[];for(var D in _)d.digestAlgorithmIdentifiers.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(D).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]));return _}function b(_){var m;if(d.detachedContent?m=d.detachedContent:(m=d.contentInfo.value[1],m=m.value[0]),!m)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var E=n.derToOid(d.contentInfo.value[0].value),D=n.toDer(m);D.getByte(),n.getBerValueLength(D),D=D.getBytes();for(var N in _)_[N].start().update(D);for(var R=new Date,T=0;T<d.signers.length;++T){var S=d.signers[T];if(S.authenticatedAttributes.length===0){if(E!==r.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{S.authenticatedAttributesAsn1=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var O=n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[]),F=0;F<S.authenticatedAttributes.length;++F){var G=S.authenticatedAttributes[F];G.type===r.pki.oids.messageDigest?G.value=_[S.digestAlgorithm].digest():G.type===r.pki.oids.signingTime&&(G.value||(G.value=R)),O.value.push(f(G)),S.authenticatedAttributesAsn1.value.push(f(G))}D=n.toDer(O).getBytes(),S.md.start().update(D)}S.signature=S.key.sign(S.md,"RSASSA-PKCS1-V1_5")}d.signerInfos=h(d.signers)}},i.createEncryptedData=function(){var d=null;return d={type:r.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(g){p(d,g,i.asn1.encryptedDataValidator)},decrypt:function(g){g!==void 0&&(d.encryptedContent.key=g),v(d)}},d},i.createEnvelopedData=function(){var d=null;return d={type:r.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(g){var b=p(d,g,i.asn1.envelopedDataValidator);d.recipients=o(b.recipientInfos.value)},toAsn1:function(){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(d.type).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(d.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,l(d.recipients)),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,y(d.encryptedContent))])])])},findRecipient:function(g){for(var b=g.issuer.attributes,_=0;_<d.recipients.length;++_){var m=d.recipients[_],E=m.issuer;if(m.serialNumber===g.serialNumber&&E.length===b.length){for(var D=!0,N=0;N<b.length;++N)if(E[N].type!==b[N].type||E[N].value!==b[N].value){D=!1;break}if(D)return m}}return null},decrypt:function(g,b){if(d.encryptedContent.key===void 0&&g!==void 0&&b!==void 0)switch(g.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:case r.pki.oids.desCBC:var _=b.decrypt(g.encryptedContent.content);d.encryptedContent.key=r.util.createBuffer(_);break;default:throw new Error("Unsupported asymmetric cipher, OID "+g.encryptedContent.algorithm)}v(d)},addRecipient:function(g){d.recipients.push({version:0,issuer:g.issuer.attributes,serialNumber:g.serialNumber,encryptedContent:{algorithm:r.pki.oids.rsaEncryption,key:g.publicKey}})},encrypt:function(g,b){if(d.encryptedContent.content===void 0){b=b||d.encryptedContent.algorithm,g=g||d.encryptedContent.key;var _,m,E;switch(b){case r.pki.oids["aes128-CBC"]:_=16,m=16,E=r.aes.createEncryptionCipher;break;case r.pki.oids["aes192-CBC"]:_=24,m=16,E=r.aes.createEncryptionCipher;break;case r.pki.oids["aes256-CBC"]:_=32,m=16,E=r.aes.createEncryptionCipher;break;case r.pki.oids["des-EDE3-CBC"]:_=24,m=8,E=r.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+b)}if(g===void 0)g=r.util.createBuffer(r.random.getBytes(_));else if(g.length()!=_)throw new Error("Symmetric key has wrong length; got "+g.length()+" bytes, expected "+_+".");d.encryptedContent.algorithm=b,d.encryptedContent.key=g,d.encryptedContent.parameter=r.util.createBuffer(r.random.getBytes(m));var D=E(g);if(D.start(d.encryptedContent.parameter.copy()),D.update(d.content),!D.finish())throw new Error("Symmetric encryption failed.");d.encryptedContent.content=D.output}for(var N=0;N<d.recipients.length;++N){var R=d.recipients[N];if(R.encryptedContent.content===void 0)switch(R.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:R.encryptedContent.content=R.encryptedContent.key.encrypt(d.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+R.encryptedContent.algorithm)}}}},d};function s(d){var g={},b=[];if(!n.validate(d,i.asn1.recipientInfoValidator,g,b)){var _=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw _.errors=b,_}return{version:g.version.charCodeAt(0),issuer:r.pki.RDNAttributesAsArray(g.issuer),serialNumber:r.util.createBuffer(g.serial).toHex(),encryptedContent:{algorithm:n.derToOid(g.encAlgorithm),parameter:g.encParameter?g.encParameter.value:void 0,content:g.encKey}}}function a(d){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(d.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[r.pki.distinguishedNameToAsn1({attributes:d.issuer}),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,r.util.hexToBytes(d.serialNumber))]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(d.encryptedContent.algorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,d.encryptedContent.content)])}function o(d){for(var g=[],b=0;b<d.length;++b)g.push(s(d[b]));return g}function l(d){for(var g=[],b=0;b<d.length;++b)g.push(a(d[b]));return g}function u(d){var g=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(d.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[r.pki.distinguishedNameToAsn1({attributes:d.issuer}),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,r.util.hexToBytes(d.serialNumber))]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(d.digestAlgorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])]);if(d.authenticatedAttributesAsn1&&g.value.push(d.authenticatedAttributesAsn1),g.value.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(d.signatureAlgorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])),g.value.push(n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,d.signature)),d.unauthenticatedAttributes.length>0){for(var b=n.create(n.Class.CONTEXT_SPECIFIC,1,!0,[]),_=0;_<d.unauthenticatedAttributes.length;++_){var m=d.unauthenticatedAttributes[_];b.values.push(f(m))}g.value.push(b)}return g}function h(d){for(var g=[],b=0;b<d.length;++b)g.push(u(d[b]));return g}function f(d){var g;if(d.type===r.pki.oids.contentType)g=n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(d.value).getBytes());else if(d.type===r.pki.oids.messageDigest)g=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,d.value.bytes());else if(d.type===r.pki.oids.signingTime){var b=new Date("1950-01-01T00:00:00Z"),_=new Date("2050-01-01T00:00:00Z"),m=d.value;if(typeof m=="string"){var E=Date.parse(m);isNaN(E)?m.length===13?m=n.utcTimeToDate(m):m=n.generalizedTimeToDate(m):m=new Date(E)}m>=b&&m<_?g=n.create(n.Class.UNIVERSAL,n.Type.UTCTIME,!1,n.dateToUtcTime(m)):g=n.create(n.Class.UNIVERSAL,n.Type.GENERALIZEDTIME,!1,n.dateToGeneralizedTime(m))}return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(d.type).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[g])])}function y(d){return[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(r.pki.oids.data).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(d.algorithm).getBytes()),d.parameter?n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,d.parameter.getBytes()):void 0]),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,d.content.getBytes())])]}function p(d,g,b){var _={},m=[];if(!n.validate(g,b,_,m)){var E=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw E.errors=E,E}var D=n.derToOid(_.contentType);if(D!==r.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(_.encryptedContent){var N="";if(r.util.isArray(_.encryptedContent))for(var R=0;R<_.encryptedContent.length;++R){if(_.encryptedContent[R].type!==n.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");N+=_.encryptedContent[R].value}else N=_.encryptedContent;d.encryptedContent={algorithm:n.derToOid(_.encAlgorithm),parameter:r.util.createBuffer(_.encParameter.value),content:r.util.createBuffer(N)}}if(_.content){var N="";if(r.util.isArray(_.content))for(var R=0;R<_.content.length;++R){if(_.content[R].type!==n.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");N+=_.content[R].value}else N=_.content;d.content=r.util.createBuffer(N)}return d.version=_.version.charCodeAt(0),d.rawCapture=_,_}function v(d){if(d.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(d.content===void 0){var g;switch(d.encryptedContent.algorithm){case r.pki.oids["aes128-CBC"]:case r.pki.oids["aes192-CBC"]:case r.pki.oids["aes256-CBC"]:g=r.aes.createDecryptionCipher(d.encryptedContent.key);break;case r.pki.oids.desCBC:case r.pki.oids["des-EDE3-CBC"]:g=r.des.createDecryptionCipher(d.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+d.encryptedContent.algorithm)}if(g.start(d.encryptedContent.parameter),g.update(d.encryptedContent.content),!g.finish())throw new Error("Symmetric decryption failed.");d.content=g.output}}}),sD=A((e,t)=>{"use strict";c();var r=async function*(n,i){for await(let s of n)await i(s),yield s};t.exports=r}),Ice=A((e,t)=>{"use strict";c();function r(n){if(Array.isArray(n)){for(var i=0,s=Array(n.length);i<n.length;i++)s[i]=n[i];return s}else return Array.from(n)}t.exports=function(n){var i=void 0,s=void 0;function a(u){if(!(u instanceof Object))throw new Error('Target "'+u+'" is not an object');s=u}function o(u){Object.keys(u).forEach(function(h){var f=u[h];if(typeof f!="function")throw new Error('Trap "'+h+": "+f+'" is not a function');if(!Reflect[h])throw new Error('Trap "'+h+": "+f+'" is not a valid trap')}),i=u}a(function(){}),n&&a(n),o(Reflect);var l=new Proxy({},{get:function(u,h){return function(){for(var f=arguments.length,y=Array(f),p=0;p<f;p++)y[p]=arguments[p];return i[h].apply(null,[s].concat(r(y.slice(1))))}}});return{setTarget:a,setHandler:o,getTarget:function(){return s},getHandler:function(){return i},proxy:new Proxy(s,l)}}}),xD=A((e,t)=>{"use strict";c();var r=H7(),n=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,i=r(),s=n&&!i,a=i&&!n,o=i&&n,l=typeof jd=="function"&&typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!i,u=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,h=typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"]==="test",f=typeof navigator<"u"&&navigator.product==="ReactNative";t.exports={isTest:h,isElectron:i,isElectronMain:a,isElectronRenderer:o,isNode:l,isBrowser:s,isWebWorker:u,isEnvWithDom:n,isReactNative:f}}),xue=A((e,t)=>{"use strict";c(),t.exports=a;var r=G7(),n=a.prototype,i=new Date%1e9;function s(){return(Math.random()*1e9>>>0)+i++}function a(o){o=o||{},this.id=o.id||s(),this.max=o.max||1/0,this.items=o.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(o.lastModified||new Date);for(var l,u,h=this.items.length;h--;)l=this.items[h],u=new Date(l.expires)-new Date,this._lookup[l.key]=l,u>0?this.expire(l.key,u):u<=0&&this.delete(l.key)}n.has=function(o){return o in this._lookup},n.get=function(o){if(!this.has(o))return null;var l=this._lookup[o];return l.refresh&&this.expire(o,l.refresh),this.items.splice(this.items.indexOf(l),1),this.items.push(l),l.value},n.meta=function(o){if(!this.has(o))return null;var l=this._lookup[o];return"meta"in l?l.meta:null},n.set=function(o,l,u){var h=this._lookup[o],f=this._lookup[o]={key:o,value:l};return this.lastModified=new Date,h?(clearTimeout(h.timeout),this.items.splice(this.items.indexOf(h),1,f)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(f),this.size++),u&&("ttl"in u&&this.expire(o,u.ttl),"meta"in u&&(f.meta=u.meta),u.refresh&&(f.refresh=u.ttl)),this},n.delete=function(o){var l=this._lookup[o];return l?(this.lastModified=new Date,this.items.splice(this.items.indexOf(l),1),clearTimeout(l.timeout),delete this._lookup[o],this.size--,this):!1},n.expire=function(o,l){var u=l||0,h=this._lookup[o];if(!h)return this;if(typeof u=="string"&&(u=r(l)),typeof u!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(h.timeout),h.timeout=setTimeout(this.delete.bind(this,h.key),u),h.expires=Number(new Date)+u,this},n.clear=function(){for(var o=this.items.length;o--;)this.delete(this.items[o].key);return this},n.toJSON=function(){for(var o=new Array(this.items.length),l,u=o.length;u--;)l=this.items[u],o[u]={key:l.key,meta:l.meta,value:l.value,expires:l.expires,refresh:l.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:o}}}),gle=A((e,t)=>{c();var r=_i(),n=r.Buffer;function i(a,o){for(var l in a)o[l]=a[l]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(i(r,e),e.Buffer=s);function s(a,o,l){return n(a,o,l)}s.prototype=Object.create(n.prototype),i(n,s),s.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return n(a,o,l)},s.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var u=n(a);return o!==void 0?typeof l=="string"?u.fill(o,l):u.fill(o):u.fill(0),u},s.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n(a)},s.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(a)}}),wle=A((e,t)=>{"use strict";c();var r=65536,n=4294967295;function i(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var s=gle().Buffer,a=globalThis.crypto||globalThis.msCrypto;a&&a.getRandomValues?t.exports=o:t.exports=i;function o(l,u){if(l>n)throw new RangeError("requested too many random bytes");var h=s.allocUnsafe(l);if(l>0)if(l>r)for(var f=0;f<l;f+=r)a.getRandomValues(h.slice(f,f+r));else a.getRandomValues(h);return typeof u=="function"?process.nextTick(function(){u(null,h)}):h}}),_le=A((e,t)=>{"use strict";c();var r=wle(),{EventEmitter:n}=In();function i(l,u){if(l===u)return!0;if(l.length!==u.length)return!1;for(let h=0,f=l.length;h<f;++h)if(l[h]!==u[h])return!1;return!0}function s(){return{contacts:[],dontSplit:!1,left:null,right:null}}function a(l,u){if(!(u instanceof Uint8Array))throw new TypeError(l+" is not a Uint8Array")}var o=class extends n{constructor(l={}){super(),this.localNodeId=l.localNodeId||r(20),this.numberOfNodesPerKBucket=l.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=l.numberOfNodesToPing||3,this.distance=l.distance||o.distance,this.arbiter=l.arbiter||o.arbiter,this.metadata=Object.assign({},l.metadata),a("option.localNodeId as parameter 1",this.localNodeId),this.root=s()}static arbiter(l,u){return l.vectorClock>u.vectorClock?l:u}static distance(l,u){let h=0,f=0,y=Math.min(l.length,u.length),p=Math.max(l.length,u.length);for(;f<y;++f)h=h*256+(l[f]^u[f]);for(;f<p;++f)h=h*256+255;return h}add(l){a("contact.id",(l||{}).id);let u=0,h=this.root;for(;h.contacts===null;)h=this._determineNode(h,l.id,u++);let f=this._indexOf(h,l.id);return f>=0?(this._update(h,f,l),this):h.contacts.length<this.numberOfNodesPerKBucket?(h.contacts.push(l),this.emit("added",l),this):h.dontSplit?(this.emit("ping",h.contacts.slice(0,this.numberOfNodesToPing),l),this):(this._split(h,u),this.add(l))}closest(l,u=1/0){if(a("id",l),!Number.isInteger(u)&&u!==1/0||u<=0)throw new TypeError("n is not positive number");let h=[];for(let f=[this.root],y=0;f.length>0&&h.length<u;){let p=f.pop();if(p.contacts===null){let v=this._determineNode(p,l,y++);f.push(p.left===v?p.right:p.left),f.push(v)}else h=h.concat(p.contacts)}return h.map(f=>[this.distance(f.id,l),f]).sort((f,y)=>f[0]-y[0]).slice(0,u).map(f=>f[1])}count(){let l=0;for(let u=[this.root];u.length>0;){let h=u.pop();h.contacts===null?u.push(h.right,h.left):l+=h.contacts.length}return l}_determineNode(l,u,h){let f=h>>3,y=h%8;return u.length<=f&&y!==0?l.left:u[f]&1<<7-y?l.right:l.left}get(l){a("id",l);let u=0,h=this.root;for(;h.contacts===null;)h=this._determineNode(h,l,u++);let f=this._indexOf(h,l);return f>=0?h.contacts[f]:null}_indexOf(l,u){for(let h=0;h<l.contacts.length;++h)if(i(l.contacts[h].id,u))return h;return-1}remove(l){a("the id as parameter 1",l);let u=0,h=this.root;for(;h.contacts===null;)h=this._determineNode(h,l,u++);let f=this._indexOf(h,l);if(f>=0){let y=h.contacts.splice(f,1)[0];this.emit("removed",y)}return this}_split(l,u){l.left=s(),l.right=s();for(let y of l.contacts)this._determineNode(l,y.id,u).contacts.push(y);l.contacts=null;let h=this._determineNode(l,this.localNodeId,u),f=l.left===h?l.right:l.left;f.dontSplit=!0}toArray(){let l=[];for(let u=[this.root];u.length>0;){let h=u.pop();h.contacts===null?u.push(h.right,h.left):l=l.concat(h.contacts)}return l}*toIterable(){for(let l=[this.root];l.length>0;){let u=l.pop();u.contacts===null?l.push(u.right,u.left):yield*u.contacts}}_update(l,u,h){if(!i(l.contacts[u].id,h.id))throw new Error("wrong index for _update");let f=l.contacts[u],y=this.arbiter(f,h);y===f&&f!==h||(l.contacts.splice(u,1),l.contacts.push(y),this.emit("updated",f,y))}};t.exports=o}),Afe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(n){if(this.isStopped)return;let i={value:n,done:!1};if(this.pullQueue.length){let s=this.pullQueue.shift();s&&s.resolve(i)}else this.pushQueue.push(Promise.resolve(i)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let n of this.pullQueue)n.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(n){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let i of this.pullQueue)i.reject(n);this.pullQueue.length=0}else{let i=Promise.reject(n);i.catch(()=>{}),this.pushQueue.push(i)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:n=>{let i=this.pushQueue.shift();return i?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),i):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((s,a)=>{this.pullQueue.push({resolve:s,reject:a})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},r=class{constructor(n,{highWaterMark:i=100,lowWaterMark:s=1}={}){let a=new t;a.highWaterMark=i,a.lowWaterMark=s,a.removeCallback=n({push:o=>a.push(o),stop:()=>a.stop(),fail:o=>a.fail(o),on:(o,l)=>{a.eventHandlers[o]=l}})||(()=>{}),this[Symbol.asyncIterator]=()=>a[Symbol.asyncIterator](),Object.freeze(this)}};e.EventIterator=r,e.default=r}),Tfe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=Afe();e.EventIterator=t.EventIterator;function r(n,i,s){return new t.EventIterator(({push:a})=>(this.addEventListener(n,a,i),()=>this.removeEventListener(n,a,i)),s)}e.subscribe=r,e.default=t.EventIterator}),she=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});function t(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}e.isSerializableHash=t}),Gv=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});function t(s,a,o){return~(s-1)&a|s-1&o}e.select=t;function r(s,a){return(s|0)-(a|0)-1>>>31&1}e.lessOrEqual=r;function n(s,a){if(s.length!==a.length)return 0;for(var o=0,l=0;l<s.length;l++)o|=s[l]^a[l];return 1&o-1>>>8}e.compare=n;function i(s,a){return s.length===0||a.length===0?!1:n(s,a)!==0}e.equal=i}),lc=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});function t(r){for(var n=0;n<r.length;n++)r[n]=0;return r}e.wipe=t}),uhe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=she(),r=Gv(),n=lc(),i=function(){function a(o,l){this._finished=!1,this._inner=new o,this._outer=new o,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var u=new Uint8Array(this.blockSize);l.length>this.blockSize?this._inner.update(l).finish(u).clean():u.set(l);for(var h=0;h<u.length;h++)u[h]^=54;this._inner.update(u);for(var h=0;h<u.length;h++)u[h]^=106;this._outer.update(u),t.isSerializableHash(this._inner)&&t.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),n.wipe(u)}return a.prototype.reset=function(){if(!t.isSerializableHash(this._inner)||!t.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},a.prototype.clean=function(){t.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),t.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},a.prototype.update=function(o){return this._inner.update(o),this},a.prototype.finish=function(o){return this._finished?(this._outer.finish(o),this):(this._inner.finish(o),this._outer.update(o.subarray(0,this.digestLength)).finish(o),this._finished=!0,this)},a.prototype.digest=function(){var o=new Uint8Array(this.digestLength);return this.finish(o),o},a.prototype.saveState=function(){if(!t.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},a.prototype.restoreState=function(o){if(!t.isSerializableHash(this._inner)||!t.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(o),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},a.prototype.cleanSavedState=function(o){if(!t.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(o)},a}();e.HMAC=i;function s(a,o,l){var u=new i(a,o);u.update(l);var h=u.digest();return u.clean(),h}e.hmac=s,e.equal=r.equal}),hhe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=uhe(),r=lc(),n=function(){function i(s,a,o,l){o===void 0&&(o=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=s,this._info=l;var u=t.hmac(this._hash,o,a);this._hmac=new t.HMAC(s,u),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var s=this._counter[0];if(s===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),s>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(s){for(var a=new Uint8Array(s),o=0;o<a.length;o++)this._bufpos===this._buffer.length&&this._fillBuffer(),a[o]=this._buffer[this._bufpos++];return a},i.prototype.clean=function(){this._hmac.clean(),r.wipe(this._buffer),r.wipe(this._counter),this._bufpos=0},i}();e.HKDF=n}),phe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=65536,r=function(){function n(){this.isAvailable=!1,this.isInstantiated=!1;var i=typeof self<"u"?self.crypto||self.msCrypto:null;i&&i.getRandomValues&&(this._crypto=i,this.isAvailable=!0,this.isInstantiated=!0)}return n.prototype.randomBytes=function(i){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var s=new Uint8Array(i),a=0;a<s.length;a+=t)this._crypto.getRandomValues(s.subarray(a,a+Math.min(s.length-a,t)));return s},n}();e.BrowserRandomSource=r}),mhe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=lc(),r=function(){function n(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof jd<"u"){var i=rh();i&&i.randomBytes&&(this._crypto=i,this.isAvailable=!0,this.isInstantiated=!0)}}return n.prototype.randomBytes=function(i){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var s=this._crypto.randomBytes(i);if(s.length!==i)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var a=new Uint8Array(i),o=0;o<a.length;o++)a[o]=s[o];return t.wipe(s),a},n}();e.NodeRandomSource=r}),yhe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=phe(),r=mhe(),n=function(){function i(){if(this.isAvailable=!1,this.name="",this._source=new t.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new r.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return i.prototype.randomBytes=function(s){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(s)},i}();e.SystemRandomSource=n}),ghe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});function t(o,l){var u=o>>>16&65535,h=o&65535,f=l>>>16&65535,y=l&65535;return h*y+(u*y+h*f<<16>>>0)|0}e.mul=Math.imul||t;function r(o,l){return o+l|0}e.add=r;function n(o,l){return o-l|0}e.sub=n;function i(o,l){return o<<l|o>>>32-l}e.rotl=i;function s(o,l){return o<<32-l|o>>>l}e.rotr=s;function a(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o}e.isInteger=Number.isInteger||a,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(o){return e.isInteger(o)&&o>=-e.MAX_SAFE_INTEGER&&o<=e.MAX_SAFE_INTEGER}}),s4=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=ghe();function r(oe,H){return H===void 0&&(H=0),(oe[H+0]<<8|oe[H+1])<<16>>16}e.readInt16BE=r;function n(oe,H){return H===void 0&&(H=0),(oe[H+0]<<8|oe[H+1])>>>0}e.readUint16BE=n;function i(oe,H){return H===void 0&&(H=0),(oe[H+1]<<8|oe[H])<<16>>16}e.readInt16LE=i;function s(oe,H){return H===void 0&&(H=0),(oe[H+1]<<8|oe[H])>>>0}e.readUint16LE=s;function a(oe,H,W){return H===void 0&&(H=new Uint8Array(2)),W===void 0&&(W=0),H[W+0]=oe>>>8,H[W+1]=oe>>>0,H}e.writeUint16BE=a,e.writeInt16BE=a;function o(oe,H,W){return H===void 0&&(H=new Uint8Array(2)),W===void 0&&(W=0),H[W+0]=oe>>>0,H[W+1]=oe>>>8,H}e.writeUint16LE=o,e.writeInt16LE=o;function l(oe,H){return H===void 0&&(H=0),oe[H]<<24|oe[H+1]<<16|oe[H+2]<<8|oe[H+3]}e.readInt32BE=l;function u(oe,H){return H===void 0&&(H=0),(oe[H]<<24|oe[H+1]<<16|oe[H+2]<<8|oe[H+3])>>>0}e.readUint32BE=u;function h(oe,H){return H===void 0&&(H=0),oe[H+3]<<24|oe[H+2]<<16|oe[H+1]<<8|oe[H]}e.readInt32LE=h;function f(oe,H){return H===void 0&&(H=0),(oe[H+3]<<24|oe[H+2]<<16|oe[H+1]<<8|oe[H])>>>0}e.readUint32LE=f;function y(oe,H,W){return H===void 0&&(H=new Uint8Array(4)),W===void 0&&(W=0),H[W+0]=oe>>>24,H[W+1]=oe>>>16,H[W+2]=oe>>>8,H[W+3]=oe>>>0,H}e.writeUint32BE=y,e.writeInt32BE=y;function p(oe,H,W){return H===void 0&&(H=new Uint8Array(4)),W===void 0&&(W=0),H[W+0]=oe>>>0,H[W+1]=oe>>>8,H[W+2]=oe>>>16,H[W+3]=oe>>>24,H}e.writeUint32LE=p,e.writeInt32LE=p;function v(oe,H){H===void 0&&(H=0);var W=l(oe,H),de=l(oe,H+4);return W*4294967296+de-(de>>31)*4294967296}e.readInt64BE=v;function d(oe,H){H===void 0&&(H=0);var W=u(oe,H),de=u(oe,H+4);return W*4294967296+de}e.readUint64BE=d;function g(oe,H){H===void 0&&(H=0);var W=h(oe,H),de=h(oe,H+4);return de*4294967296+W-(W>>31)*4294967296}e.readInt64LE=g;function b(oe,H){H===void 0&&(H=0);var W=f(oe,H),de=f(oe,H+4);return de*4294967296+W}e.readUint64LE=b;function _(oe,H,W){return H===void 0&&(H=new Uint8Array(8)),W===void 0&&(W=0),y(oe/4294967296>>>0,H,W),y(oe>>>0,H,W+4),H}e.writeUint64BE=_,e.writeInt64BE=_;function m(oe,H,W){return H===void 0&&(H=new Uint8Array(8)),W===void 0&&(W=0),p(oe>>>0,H,W),p(oe/4294967296>>>0,H,W+4),H}e.writeUint64LE=m,e.writeInt64LE=m;function E(oe,H,W){if(W===void 0&&(W=0),oe%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(oe/8>H.length-W)throw new Error("readUintBE: array is too short for the given bitLength");for(var de=0,De=1,Pe=oe/8+W-1;Pe>=W;Pe--)de+=H[Pe]*De,De*=256;return de}e.readUintBE=E;function D(oe,H,W){if(W===void 0&&(W=0),oe%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(oe/8>H.length-W)throw new Error("readUintLE: array is too short for the given bitLength");for(var de=0,De=1,Pe=W;Pe<W+oe/8;Pe++)de+=H[Pe]*De,De*=256;return de}e.readUintLE=D;function N(oe,H,W,de){if(W===void 0&&(W=new Uint8Array(oe/8)),de===void 0&&(de=0),oe%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!t.isSafeInteger(H))throw new Error("writeUintBE value must be an integer");for(var De=1,Pe=oe/8+de-1;Pe>=de;Pe--)W[Pe]=H/De&255,De*=256;return W}e.writeUintBE=N;function R(oe,H,W,de){if(W===void 0&&(W=new Uint8Array(oe/8)),de===void 0&&(de=0),oe%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!t.isSafeInteger(H))throw new Error("writeUintLE value must be an integer");for(var De=1,Pe=de;Pe<de+oe/8;Pe++)W[Pe]=H/De&255,De*=256;return W}e.writeUintLE=R;function T(oe,H){H===void 0&&(H=0);var W=new DataView(oe.buffer,oe.byteOffset,oe.byteLength);return W.getFloat32(H)}e.readFloat32BE=T;function S(oe,H){H===void 0&&(H=0);var W=new DataView(oe.buffer,oe.byteOffset,oe.byteLength);return W.getFloat32(H,!0)}e.readFloat32LE=S;function O(oe,H){H===void 0&&(H=0);var W=new DataView(oe.buffer,oe.byteOffset,oe.byteLength);return W.getFloat64(H)}e.readFloat64BE=O;function F(oe,H){H===void 0&&(H=0);var W=new DataView(oe.buffer,oe.byteOffset,oe.byteLength);return W.getFloat64(H,!0)}e.readFloat64LE=F;function G(oe,H,W){H===void 0&&(H=new Uint8Array(4)),W===void 0&&(W=0);var de=new DataView(H.buffer,H.byteOffset,H.byteLength);return de.setFloat32(W,oe),H}e.writeFloat32BE=G;function ne(oe,H,W){H===void 0&&(H=new Uint8Array(4)),W===void 0&&(W=0);var de=new DataView(H.buffer,H.byteOffset,H.byteLength);return de.setFloat32(W,oe,!0),H}e.writeFloat32LE=ne;function Y(oe,H,W){H===void 0&&(H=new Uint8Array(8)),W===void 0&&(W=0);var de=new DataView(H.buffer,H.byteOffset,H.byteLength);return de.setFloat64(W,oe),H}e.writeFloat64BE=Y;function ce(oe,H,W){H===void 0&&(H=new Uint8Array(8)),W===void 0&&(W=0);var de=new DataView(H.buffer,H.byteOffset,H.byteLength);return de.setFloat64(W,oe,!0),H}e.writeFloat64LE=ce}),Ahe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=yhe(),r=s4(),n=lc();e.defaultRandomSource=new t.SystemRandomSource;function i(u,h){return h===void 0&&(h=e.defaultRandomSource),h.randomBytes(u)}e.randomBytes=i;function s(u){u===void 0&&(u=e.defaultRandomSource);var h=i(4,u),f=r.readUint32LE(h);return n.wipe(h),f}e.randomUint32=s;var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function o(u,h,f){if(h===void 0&&(h=a),f===void 0&&(f=e.defaultRandomSource),h.length<2)throw new Error("randomString charset is too short");if(h.length>256)throw new Error("randomString charset is too long");for(var y="",p=h.length,v=256-256%p;u>0;){for(var d=i(Math.ceil(u*256/v),f),g=0;g<d.length&&u>0;g++){var b=d[g];b<v&&(y+=h.charAt(b%p),u--)}n.wipe(d)}return y}e.randomString=o;function l(u,h,f){h===void 0&&(h=a),f===void 0&&(f=e.defaultRandomSource);var y=Math.ceil(u/(Math.log(h.length)/Math.LN2));return o(y,h,f)}e.randomStringForEntropy=l}),Phe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=Ahe(),r=lc();e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;function n(E){var D=new Float64Array(16);if(E)for(var N=0;N<E.length;N++)D[N]=E[N];return D}var i=new Uint8Array(32);i[0]=9;var s=n([56129,1]);function a(E){for(var D=1,N=0;N<16;N++){var R=E[N]+D+65535;D=Math.floor(R/65536),E[N]=R-D*65536}E[0]+=D-1+37*(D-1)}function o(E,D,N){for(var R=~(N-1),T=0;T<16;T++){var S=R&(E[T]^D[T]);E[T]^=S,D[T]^=S}}function l(E,D){for(var N=n(),R=n(),T=0;T<16;T++)R[T]=D[T];a(R),a(R),a(R);for(var S=0;S<2;S++){N[0]=R[0]-65517;for(var T=1;T<15;T++)N[T]=R[T]-65535-(N[T-1]>>16&1),N[T-1]&=65535;N[15]=R[15]-32767-(N[14]>>16&1);var O=N[15]>>16&1;N[14]&=65535,o(R,N,1-O)}for(var T=0;T<16;T++)E[2*T]=R[T]&255,E[2*T+1]=R[T]>>8}function u(E,D){for(var N=0;N<16;N++)E[N]=D[2*N]+(D[2*N+1]<<8);E[15]&=32767}function h(E,D,N){for(var R=0;R<16;R++)E[R]=D[R]+N[R]}function f(E,D,N){for(var R=0;R<16;R++)E[R]=D[R]-N[R]}function y(E,D,N){var R,T,S=0,O=0,F=0,G=0,ne=0,Y=0,ce=0,oe=0,H=0,W=0,de=0,De=0,Pe=0,$e=0,Be=0,nt=0,Ve=0,et=0,ht=0,Z=0,le=0,ke=0,Ge=0,ft=0,yt=0,V=0,z=0,Oe=0,tt=0,Ft=0,Dt=0,Lt=N[0],$t=N[1],Wt=N[2],lr=N[3],Cr=N[4],sr=N[5],Sr=N[6],x=N[7],$=N[8],J=N[9],ge=N[10],Le=N[11],it=N[12],bt=N[13],Kt=N[14],ar=N[15];R=D[0],S+=R*Lt,O+=R*$t,F+=R*Wt,G+=R*lr,ne+=R*Cr,Y+=R*sr,ce+=R*Sr,oe+=R*x,H+=R*$,W+=R*J,de+=R*ge,De+=R*Le,Pe+=R*it,$e+=R*bt,Be+=R*Kt,nt+=R*ar,R=D[1],O+=R*Lt,F+=R*$t,G+=R*Wt,ne+=R*lr,Y+=R*Cr,ce+=R*sr,oe+=R*Sr,H+=R*x,W+=R*$,de+=R*J,De+=R*ge,Pe+=R*Le,$e+=R*it,Be+=R*bt,nt+=R*Kt,Ve+=R*ar,R=D[2],F+=R*Lt,G+=R*$t,ne+=R*Wt,Y+=R*lr,ce+=R*Cr,oe+=R*sr,H+=R*Sr,W+=R*x,de+=R*$,De+=R*J,Pe+=R*ge,$e+=R*Le,Be+=R*it,nt+=R*bt,Ve+=R*Kt,et+=R*ar,R=D[3],G+=R*Lt,ne+=R*$t,Y+=R*Wt,ce+=R*lr,oe+=R*Cr,H+=R*sr,W+=R*Sr,de+=R*x,De+=R*$,Pe+=R*J,$e+=R*ge,Be+=R*Le,nt+=R*it,Ve+=R*bt,et+=R*Kt,ht+=R*ar,R=D[4],ne+=R*Lt,Y+=R*$t,ce+=R*Wt,oe+=R*lr,H+=R*Cr,W+=R*sr,de+=R*Sr,De+=R*x,Pe+=R*$,$e+=R*J,Be+=R*ge,nt+=R*Le,Ve+=R*it,et+=R*bt,ht+=R*Kt,Z+=R*ar,R=D[5],Y+=R*Lt,ce+=R*$t,oe+=R*Wt,H+=R*lr,W+=R*Cr,de+=R*sr,De+=R*Sr,Pe+=R*x,$e+=R*$,Be+=R*J,nt+=R*ge,Ve+=R*Le,et+=R*it,ht+=R*bt,Z+=R*Kt,le+=R*ar,R=D[6],ce+=R*Lt,oe+=R*$t,H+=R*Wt,W+=R*lr,de+=R*Cr,De+=R*sr,Pe+=R*Sr,$e+=R*x,Be+=R*$,nt+=R*J,Ve+=R*ge,et+=R*Le,ht+=R*it,Z+=R*bt,le+=R*Kt,ke+=R*ar,R=D[7],oe+=R*Lt,H+=R*$t,W+=R*Wt,de+=R*lr,De+=R*Cr,Pe+=R*sr,$e+=R*Sr,Be+=R*x,nt+=R*$,Ve+=R*J,et+=R*ge,ht+=R*Le,Z+=R*it,le+=R*bt,ke+=R*Kt,Ge+=R*ar,R=D[8],H+=R*Lt,W+=R*$t,de+=R*Wt,De+=R*lr,Pe+=R*Cr,$e+=R*sr,Be+=R*Sr,nt+=R*x,Ve+=R*$,et+=R*J,ht+=R*ge,Z+=R*Le,le+=R*it,ke+=R*bt,Ge+=R*Kt,ft+=R*ar,R=D[9],W+=R*Lt,de+=R*$t,De+=R*Wt,Pe+=R*lr,$e+=R*Cr,Be+=R*sr,nt+=R*Sr,Ve+=R*x,et+=R*$,ht+=R*J,Z+=R*ge,le+=R*Le,ke+=R*it,Ge+=R*bt,ft+=R*Kt,yt+=R*ar,R=D[10],de+=R*Lt,De+=R*$t,Pe+=R*Wt,$e+=R*lr,Be+=R*Cr,nt+=R*sr,Ve+=R*Sr,et+=R*x,ht+=R*$,Z+=R*J,le+=R*ge,ke+=R*Le,Ge+=R*it,ft+=R*bt,yt+=R*Kt,V+=R*ar,R=D[11],De+=R*Lt,Pe+=R*$t,$e+=R*Wt,Be+=R*lr,nt+=R*Cr,Ve+=R*sr,et+=R*Sr,ht+=R*x,Z+=R*$,le+=R*J,ke+=R*ge,Ge+=R*Le,ft+=R*it,yt+=R*bt,V+=R*Kt,z+=R*ar,R=D[12],Pe+=R*Lt,$e+=R*$t,Be+=R*Wt,nt+=R*lr,Ve+=R*Cr,et+=R*sr,ht+=R*Sr,Z+=R*x,le+=R*$,ke+=R*J,Ge+=R*ge,ft+=R*Le,yt+=R*it,V+=R*bt,z+=R*Kt,Oe+=R*ar,R=D[13],$e+=R*Lt,Be+=R*$t,nt+=R*Wt,Ve+=R*lr,et+=R*Cr,ht+=R*sr,Z+=R*Sr,le+=R*x,ke+=R*$,Ge+=R*J,ft+=R*ge,yt+=R*Le,V+=R*it,z+=R*bt,Oe+=R*Kt,tt+=R*ar,R=D[14],Be+=R*Lt,nt+=R*$t,Ve+=R*Wt,et+=R*lr,ht+=R*Cr,Z+=R*sr,le+=R*Sr,ke+=R*x,Ge+=R*$,ft+=R*J,yt+=R*ge,V+=R*Le,z+=R*it,Oe+=R*bt,tt+=R*Kt,Ft+=R*ar,R=D[15],nt+=R*Lt,Ve+=R*$t,et+=R*Wt,ht+=R*lr,Z+=R*Cr,le+=R*sr,ke+=R*Sr,Ge+=R*x,ft+=R*$,yt+=R*J,V+=R*ge,z+=R*Le,Oe+=R*it,tt+=R*bt,Ft+=R*Kt,Dt+=R*ar,S+=38*Ve,O+=38*et,F+=38*ht,G+=38*Z,ne+=38*le,Y+=38*ke,ce+=38*Ge,oe+=38*ft,H+=38*yt,W+=38*V,de+=38*z,De+=38*Oe,Pe+=38*tt,$e+=38*Ft,Be+=38*Dt,T=1,R=S+T+65535,T=Math.floor(R/65536),S=R-T*65536,R=O+T+65535,T=Math.floor(R/65536),O=R-T*65536,R=F+T+65535,T=Math.floor(R/65536),F=R-T*65536,R=G+T+65535,T=Math.floor(R/65536),G=R-T*65536,R=ne+T+65535,T=Math.floor(R/65536),ne=R-T*65536,R=Y+T+65535,T=Math.floor(R/65536),Y=R-T*65536,R=ce+T+65535,T=Math.floor(R/65536),ce=R-T*65536,R=oe+T+65535,T=Math.floor(R/65536),oe=R-T*65536,R=H+T+65535,T=Math.floor(R/65536),H=R-T*65536,R=W+T+65535,T=Math.floor(R/65536),W=R-T*65536,R=de+T+65535,T=Math.floor(R/65536),de=R-T*65536,R=De+T+65535,T=Math.floor(R/65536),De=R-T*65536,R=Pe+T+65535,T=Math.floor(R/65536),Pe=R-T*65536,R=$e+T+65535,T=Math.floor(R/65536),$e=R-T*65536,R=Be+T+65535,T=Math.floor(R/65536),Be=R-T*65536,R=nt+T+65535,T=Math.floor(R/65536),nt=R-T*65536,S+=T-1+37*(T-1),T=1,R=S+T+65535,T=Math.floor(R/65536),S=R-T*65536,R=O+T+65535,T=Math.floor(R/65536),O=R-T*65536,R=F+T+65535,T=Math.floor(R/65536),F=R-T*65536,R=G+T+65535,T=Math.floor(R/65536),G=R-T*65536,R=ne+T+65535,T=Math.floor(R/65536),ne=R-T*65536,R=Y+T+65535,T=Math.floor(R/65536),Y=R-T*65536,R=ce+T+65535,T=Math.floor(R/65536),ce=R-T*65536,R=oe+T+65535,T=Math.floor(R/65536),oe=R-T*65536,R=H+T+65535,T=Math.floor(R/65536),H=R-T*65536,R=W+T+65535,T=Math.floor(R/65536),W=R-T*65536,R=de+T+65535,T=Math.floor(R/65536),de=R-T*65536,R=De+T+65535,T=Math.floor(R/65536),De=R-T*65536,R=Pe+T+65535,T=Math.floor(R/65536),Pe=R-T*65536,R=$e+T+65535,T=Math.floor(R/65536),$e=R-T*65536,R=Be+T+65535,T=Math.floor(R/65536),Be=R-T*65536,R=nt+T+65535,T=Math.floor(R/65536),nt=R-T*65536,S+=T-1+37*(T-1),E[0]=S,E[1]=O,E[2]=F,E[3]=G,E[4]=ne,E[5]=Y,E[6]=ce,E[7]=oe,E[8]=H,E[9]=W,E[10]=de,E[11]=De,E[12]=Pe,E[13]=$e,E[14]=Be,E[15]=nt}function p(E,D){y(E,D,D)}function v(E,D){for(var N=n(),R=0;R<16;R++)N[R]=D[R];for(var R=253;R>=0;R--)p(N,N),R!==2&&R!==4&&y(N,N,D);for(var R=0;R<16;R++)E[R]=N[R]}function d(E,D){for(var N=new Uint8Array(32),R=new Float64Array(80),T=n(),S=n(),O=n(),F=n(),G=n(),ne=n(),Y=0;Y<31;Y++)N[Y]=E[Y];N[31]=E[31]&127|64,N[0]&=248,u(R,D);for(var Y=0;Y<16;Y++)S[Y]=R[Y];T[0]=F[0]=1;for(var Y=254;Y>=0;--Y){var ce=N[Y>>>3]>>>(Y&7)&1;o(T,S,ce),o(O,F,ce),h(G,T,O),f(T,T,O),h(O,S,F),f(S,S,F),p(F,G),p(ne,T),y(T,O,T),y(O,S,G),h(G,T,O),f(T,T,O),p(S,T),f(O,F,ne),y(T,O,s),h(T,T,F),y(O,O,T),y(T,F,ne),y(F,S,R),p(S,G),o(T,S,ce),o(O,F,ce)}for(var Y=0;Y<16;Y++)R[Y+16]=T[Y],R[Y+32]=O[Y],R[Y+48]=S[Y],R[Y+64]=F[Y];var oe=R.subarray(32),H=R.subarray(16);v(oe,oe),y(H,H,oe);var W=new Uint8Array(32);return l(W,H),W}e.scalarMult=d;function g(E){return d(E,i)}e.scalarMultBase=g;function b(E){if(E.length!==e.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+e.SECRET_KEY_LENGTH+" bytes");var D=new Uint8Array(E),N=g(D);return{publicKey:N,secretKey:D}}e.generateKeyPairFromSeed=b;function _(E){var D=t.randomBytes(32,E),N=b(D);return r.wipe(D),N}e.generateKeyPair=_;function m(E,D,N){if(N===void 0&&(N=!1),E.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(D.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var R=d(E,D);if(N){for(var T=0,S=0;S<R.length;S++)T|=R[S];if(T===0)throw new Error("X25519: invalid shared key")}return R}e.sharedKey=m}),khe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=s4(),r=lc();e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var n=function(){function o(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return o.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},o.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},o.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},o.prototype.update=function(l,u){if(u===void 0&&(u=l.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var h=0;if(this._bytesHashed+=u,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&u>0;)this._buffer[this._bufferLength++]=l[h++],u--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(u>=this.blockSize&&(h=s(this._temp,this._state,l,h,u),u%=this.blockSize);u>0;)this._buffer[this._bufferLength++]=l[h++],u--;return this},o.prototype.finish=function(l){if(!this._finished){var u=this._bytesHashed,h=this._bufferLength,f=u/536870912|0,y=u<<3,p=u%64<56?64:128;this._buffer[h]=128;for(var v=h+1;v<p-8;v++)this._buffer[v]=0;t.writeUint32BE(f,this._buffer,p-8),t.writeUint32BE(y,this._buffer,p-4),s(this._temp,this._state,this._buffer,0,p),this._finished=!0}for(var v=0;v<this.digestLength/4;v++)t.writeUint32BE(this._state[v],l,v*4);return this},o.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},o.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},o.prototype.restoreState=function(l){return this._state.set(l.state),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},o.prototype.cleanSavedState=function(l){r.wipe(l.state),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},o}();e.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(o,l,u,h,f){for(;f>=64;){for(var y=l[0],p=l[1],v=l[2],d=l[3],g=l[4],b=l[5],_=l[6],m=l[7],E=0;E<16;E++){var D=h+E*4;o[E]=t.readUint32BE(u,D)}for(var E=16;E<64;E++){var N=o[E-2],R=(N>>>17|N<<32-17)^(N>>>19|N<<32-19)^N>>>10;N=o[E-15];var T=(N>>>7|N<<32-7)^(N>>>18|N<<32-18)^N>>>3;o[E]=(R+o[E-7]|0)+(T+o[E-16]|0)}for(var E=0;E<64;E++){var R=(((g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&b^~g&_)|0)+(m+(i[E]+o[E]|0)|0)|0,T=((y>>>2|y<<32-2)^(y>>>13|y<<32-13)^(y>>>22|y<<32-22))+(y&p^y&v^p&v)|0;m=_,_=b,b=g,g=d+R|0,d=v,v=p,p=y,y=R+T|0}l[0]+=y,l[1]+=p,l[2]+=v,l[3]+=d,l[4]+=g,l[5]+=b,l[6]+=_,l[7]+=m,h+=64,f-=64}return h}function a(o){var l=new n;l.update(o);var u=l.digest();return l.clean(),u}e.hash=a}),Ohe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=s4(),r=lc(),n=20;function i(l,u,h){for(var f=1634760805,y=857760878,p=2036477234,v=1797285236,d=h[3]<<24|h[2]<<16|h[1]<<8|h[0],g=h[7]<<24|h[6]<<16|h[5]<<8|h[4],b=h[11]<<24|h[10]<<16|h[9]<<8|h[8],_=h[15]<<24|h[14]<<16|h[13]<<8|h[12],m=h[19]<<24|h[18]<<16|h[17]<<8|h[16],E=h[23]<<24|h[22]<<16|h[21]<<8|h[20],D=h[27]<<24|h[26]<<16|h[25]<<8|h[24],N=h[31]<<24|h[30]<<16|h[29]<<8|h[28],R=u[3]<<24|u[2]<<16|u[1]<<8|u[0],T=u[7]<<24|u[6]<<16|u[5]<<8|u[4],S=u[11]<<24|u[10]<<16|u[9]<<8|u[8],O=u[15]<<24|u[14]<<16|u[13]<<8|u[12],F=f,G=y,ne=p,Y=v,ce=d,oe=g,H=b,W=_,de=m,De=E,Pe=D,$e=N,Be=R,nt=T,Ve=S,et=O,ht=0;ht<n;ht+=2)F=F+ce|0,Be^=F,Be=Be>>>32-16|Be<<16,de=de+Be|0,ce^=de,ce=ce>>>32-12|ce<<12,G=G+oe|0,nt^=G,nt=nt>>>32-16|nt<<16,De=De+nt|0,oe^=De,oe=oe>>>32-12|oe<<12,ne=ne+H|0,Ve^=ne,Ve=Ve>>>32-16|Ve<<16,Pe=Pe+Ve|0,H^=Pe,H=H>>>32-12|H<<12,Y=Y+W|0,et^=Y,et=et>>>32-16|et<<16,$e=$e+et|0,W^=$e,W=W>>>32-12|W<<12,ne=ne+H|0,Ve^=ne,Ve=Ve>>>32-8|Ve<<8,Pe=Pe+Ve|0,H^=Pe,H=H>>>32-7|H<<7,Y=Y+W|0,et^=Y,et=et>>>32-8|et<<8,$e=$e+et|0,W^=$e,W=W>>>32-7|W<<7,G=G+oe|0,nt^=G,nt=nt>>>32-8|nt<<8,De=De+nt|0,oe^=De,oe=oe>>>32-7|oe<<7,F=F+ce|0,Be^=F,Be=Be>>>32-8|Be<<8,de=de+Be|0,ce^=de,ce=ce>>>32-7|ce<<7,F=F+oe|0,et^=F,et=et>>>32-16|et<<16,Pe=Pe+et|0,oe^=Pe,oe=oe>>>32-12|oe<<12,G=G+H|0,Be^=G,Be=Be>>>32-16|Be<<16,$e=$e+Be|0,H^=$e,H=H>>>32-12|H<<12,ne=ne+W|0,nt^=ne,nt=nt>>>32-16|nt<<16,de=de+nt|0,W^=de,W=W>>>32-12|W<<12,Y=Y+ce|0,Ve^=Y,Ve=Ve>>>32-16|Ve<<16,De=De+Ve|0,ce^=De,ce=ce>>>32-12|ce<<12,ne=ne+W|0,nt^=ne,nt=nt>>>32-8|nt<<8,de=de+nt|0,W^=de,W=W>>>32-7|W<<7,Y=Y+ce|0,Ve^=Y,Ve=Ve>>>32-8|Ve<<8,De=De+Ve|0,ce^=De,ce=ce>>>32-7|ce<<7,G=G+H|0,Be^=G,Be=Be>>>32-8|Be<<8,$e=$e+Be|0,H^=$e,H=H>>>32-7|H<<7,F=F+oe|0,et^=F,et=et>>>32-8|et<<8,Pe=Pe+et|0,oe^=Pe,oe=oe>>>32-7|oe<<7;t.writeUint32LE(F+f|0,l,0),t.writeUint32LE(G+y|0,l,4),t.writeUint32LE(ne+p|0,l,8),t.writeUint32LE(Y+v|0,l,12),t.writeUint32LE(ce+d|0,l,16),t.writeUint32LE(oe+g|0,l,20),t.writeUint32LE(H+b|0,l,24),t.writeUint32LE(W+_|0,l,28),t.writeUint32LE(de+m|0,l,32),t.writeUint32LE(De+E|0,l,36),t.writeUint32LE(Pe+D|0,l,40),t.writeUint32LE($e+N|0,l,44),t.writeUint32LE(Be+R|0,l,48),t.writeUint32LE(nt+T|0,l,52),t.writeUint32LE(Ve+S|0,l,56),t.writeUint32LE(et+O|0,l,60)}function s(l,u,h,f,y){if(y===void 0&&(y=0),l.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(f.length<h.length)throw new Error("ChaCha: destination is shorter than source");var p,v;if(y===0){if(u.length!==8&&u.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");p=new Uint8Array(16),v=p.length-u.length,p.set(u,v)}else{if(u.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");p=u,v=y}for(var d=new Uint8Array(64),g=0;g<h.length;g+=64){i(d,p,l);for(var b=g;b<g+64&&b<h.length;b++)f[b]=h[b]^d[b-g];o(p,0,v)}return r.wipe(d),y===0&&r.wipe(p),f}e.streamXOR=s;function a(l,u,h,f){return f===void 0&&(f=0),r.wipe(h),s(l,u,h,h,f)}e.stream=a;function o(l,u,h){for(var f=1;h--;)f=f+(l[u]&255)|0,l[u]=f&255,f>>>=8,u++;if(f>0)throw new Error("ChaCha: counter overflow")}}),Bhe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=Gv(),r=lc();e.DIGEST_LENGTH=16;var n=function(){function a(o){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var l=o[0]|o[1]<<8;this._r[0]=l&8191;var u=o[2]|o[3]<<8;this._r[1]=(l>>>13|u<<3)&8191;var h=o[4]|o[5]<<8;this._r[2]=(u>>>10|h<<6)&7939;var f=o[6]|o[7]<<8;this._r[3]=(h>>>7|f<<9)&8191;var y=o[8]|o[9]<<8;this._r[4]=(f>>>4|y<<12)&255,this._r[5]=y>>>1&8190;var p=o[10]|o[11]<<8;this._r[6]=(y>>>14|p<<2)&8191;var v=o[12]|o[13]<<8;this._r[7]=(p>>>11|v<<5)&8065;var d=o[14]|o[15]<<8;this._r[8]=(v>>>8|d<<8)&8191,this._r[9]=d>>>5&127,this._pad[0]=o[16]|o[17]<<8,this._pad[1]=o[18]|o[19]<<8,this._pad[2]=o[20]|o[21]<<8,this._pad[3]=o[22]|o[23]<<8,this._pad[4]=o[24]|o[25]<<8,this._pad[5]=o[26]|o[27]<<8,this._pad[6]=o[28]|o[29]<<8,this._pad[7]=o[30]|o[31]<<8}return a.prototype._blocks=function(o,l,u){for(var h=this._fin?0:2048,f=this._h[0],y=this._h[1],p=this._h[2],v=this._h[3],d=this._h[4],g=this._h[5],b=this._h[6],_=this._h[7],m=this._h[8],E=this._h[9],D=this._r[0],N=this._r[1],R=this._r[2],T=this._r[3],S=this._r[4],O=this._r[5],F=this._r[6],G=this._r[7],ne=this._r[8],Y=this._r[9];u>=16;){var ce=o[l+0]|o[l+1]<<8;f+=ce&8191;var oe=o[l+2]|o[l+3]<<8;y+=(ce>>>13|oe<<3)&8191;var H=o[l+4]|o[l+5]<<8;p+=(oe>>>10|H<<6)&8191;var W=o[l+6]|o[l+7]<<8;v+=(H>>>7|W<<9)&8191;var de=o[l+8]|o[l+9]<<8;d+=(W>>>4|de<<12)&8191,g+=de>>>1&8191;var De=o[l+10]|o[l+11]<<8;b+=(de>>>14|De<<2)&8191;var Pe=o[l+12]|o[l+13]<<8;_+=(De>>>11|Pe<<5)&8191;var $e=o[l+14]|o[l+15]<<8;m+=(Pe>>>8|$e<<8)&8191,E+=$e>>>5|h;var Be=0,nt=Be;nt+=f*D,nt+=y*(5*Y),nt+=p*(5*ne),nt+=v*(5*G),nt+=d*(5*F),Be=nt>>>13,nt&=8191,nt+=g*(5*O),nt+=b*(5*S),nt+=_*(5*T),nt+=m*(5*R),nt+=E*(5*N),Be+=nt>>>13,nt&=8191;var Ve=Be;Ve+=f*N,Ve+=y*D,Ve+=p*(5*Y),Ve+=v*(5*ne),Ve+=d*(5*G),Be=Ve>>>13,Ve&=8191,Ve+=g*(5*F),Ve+=b*(5*O),Ve+=_*(5*S),Ve+=m*(5*T),Ve+=E*(5*R),Be+=Ve>>>13,Ve&=8191;var et=Be;et+=f*R,et+=y*N,et+=p*D,et+=v*(5*Y),et+=d*(5*ne),Be=et>>>13,et&=8191,et+=g*(5*G),et+=b*(5*F),et+=_*(5*O),et+=m*(5*S),et+=E*(5*T),Be+=et>>>13,et&=8191;var ht=Be;ht+=f*T,ht+=y*R,ht+=p*N,ht+=v*D,ht+=d*(5*Y),Be=ht>>>13,ht&=8191,ht+=g*(5*ne),ht+=b*(5*G),ht+=_*(5*F),ht+=m*(5*O),ht+=E*(5*S),Be+=ht>>>13,ht&=8191;var Z=Be;Z+=f*S,Z+=y*T,Z+=p*R,Z+=v*N,Z+=d*D,Be=Z>>>13,Z&=8191,Z+=g*(5*Y),Z+=b*(5*ne),Z+=_*(5*G),Z+=m*(5*F),Z+=E*(5*O),Be+=Z>>>13,Z&=8191;var le=Be;le+=f*O,le+=y*S,le+=p*T,le+=v*R,le+=d*N,Be=le>>>13,le&=8191,le+=g*D,le+=b*(5*Y),le+=_*(5*ne),le+=m*(5*G),le+=E*(5*F),Be+=le>>>13,le&=8191;var ke=Be;ke+=f*F,ke+=y*O,ke+=p*S,ke+=v*T,ke+=d*R,Be=ke>>>13,ke&=8191,ke+=g*N,ke+=b*D,ke+=_*(5*Y),ke+=m*(5*ne),ke+=E*(5*G),Be+=ke>>>13,ke&=8191;var Ge=Be;Ge+=f*G,Ge+=y*F,Ge+=p*O,Ge+=v*S,Ge+=d*T,Be=Ge>>>13,Ge&=8191,Ge+=g*R,Ge+=b*N,Ge+=_*D,Ge+=m*(5*Y),Ge+=E*(5*ne),Be+=Ge>>>13,Ge&=8191;var ft=Be;ft+=f*ne,ft+=y*G,ft+=p*F,ft+=v*O,ft+=d*S,Be=ft>>>13,ft&=8191,ft+=g*T,ft+=b*R,ft+=_*N,ft+=m*D,ft+=E*(5*Y),Be+=ft>>>13,ft&=8191;var yt=Be;yt+=f*Y,yt+=y*ne,yt+=p*G,yt+=v*F,yt+=d*O,Be=yt>>>13,yt&=8191,yt+=g*S,yt+=b*T,yt+=_*R,yt+=m*N,yt+=E*D,Be+=yt>>>13,yt&=8191,Be=(Be<<2)+Be|0,Be=Be+nt|0,nt=Be&8191,Be=Be>>>13,Ve+=Be,f=nt,y=Ve,p=et,v=ht,d=Z,g=le,b=ke,_=Ge,m=ft,E=yt,l+=16,u-=16}this._h[0]=f,this._h[1]=y,this._h[2]=p,this._h[3]=v,this._h[4]=d,this._h[5]=g,this._h[6]=b,this._h[7]=_,this._h[8]=m,this._h[9]=E},a.prototype.finish=function(o,l){l===void 0&&(l=0);var u=new Uint16Array(10),h,f,y,p;if(this._leftover){for(p=this._leftover,this._buffer[p++]=1;p<16;p++)this._buffer[p]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(h=this._h[1]>>>13,this._h[1]&=8191,p=2;p<10;p++)this._h[p]+=h,h=this._h[p]>>>13,this._h[p]&=8191;for(this._h[0]+=h*5,h=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=h,h=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=h,u[0]=this._h[0]+5,h=u[0]>>>13,u[0]&=8191,p=1;p<10;p++)u[p]=this._h[p]+h,h=u[p]>>>13,u[p]&=8191;for(u[9]-=1<<13,f=(h^1)-1,p=0;p<10;p++)u[p]&=f;for(f=~f,p=0;p<10;p++)this._h[p]=this._h[p]&f|u[p];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,y=this._h[0]+this._pad[0],this._h[0]=y&65535,p=1;p<8;p++)y=(this._h[p]+this._pad[p]|0)+(y>>>16)|0,this._h[p]=y&65535;return o[l+0]=this._h[0]>>>0,o[l+1]=this._h[0]>>>8,o[l+2]=this._h[1]>>>0,o[l+3]=this._h[1]>>>8,o[l+4]=this._h[2]>>>0,o[l+5]=this._h[2]>>>8,o[l+6]=this._h[3]>>>0,o[l+7]=this._h[3]>>>8,o[l+8]=this._h[4]>>>0,o[l+9]=this._h[4]>>>8,o[l+10]=this._h[5]>>>0,o[l+11]=this._h[5]>>>8,o[l+12]=this._h[6]>>>0,o[l+13]=this._h[6]>>>8,o[l+14]=this._h[7]>>>0,o[l+15]=this._h[7]>>>8,this._finished=!0,this},a.prototype.update=function(o){var l=0,u=o.length,h;if(this._leftover){h=16-this._leftover,h>u&&(h=u);for(var f=0;f<h;f++)this._buffer[this._leftover+f]=o[l+f];if(u-=h,l+=h,this._leftover+=h,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(u>=16&&(h=u-u%16,this._blocks(o,l,h),l+=h,u-=h),u){for(var f=0;f<u;f++)this._buffer[this._leftover+f]=o[l+f];this._leftover+=u}return this},a.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var o=new Uint8Array(16);return this.finish(o),o},a.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},a}();e.Poly1305=n;function i(a,o){var l=new n(a);l.update(o);var u=l.digest();return l.clean(),u}e.oneTimeAuth=i;function s(a,o){return a.length!==e.DIGEST_LENGTH||o.length!==e.DIGEST_LENGTH?!1:t.equal(a,o)}e.equal=s}),Fhe=A(e=>{"use strict";c(),Object.defineProperty(e,"__esModule",{value:!0});var t=Ohe(),r=Bhe(),n=lc(),i=s4(),s=Gv();e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var a=new Uint8Array(16),o=function(){function l(u){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,u.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(u)}return l.prototype.seal=function(u,h,f,y){if(u.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var p=new Uint8Array(16);p.set(u,p.length-u.length);var v=new Uint8Array(32);t.stream(this._key,p,v,4);var d=h.length+this.tagLength,g;if(y){if(y.length!==d)throw new Error("ChaCha20Poly1305: incorrect destination length");g=y}else g=new Uint8Array(d);return t.streamXOR(this._key,p,h,g,4),this._authenticate(g.subarray(g.length-this.tagLength,g.length),v,g.subarray(0,g.length-this.tagLength),f),n.wipe(p),g},l.prototype.open=function(u,h,f,y){if(u.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(h.length<this.tagLength)return null;var p=new Uint8Array(16);p.set(u,p.length-u.length);var v=new Uint8Array(32);t.stream(this._key,p,v,4);var d=new Uint8Array(this.tagLength);if(this._authenticate(d,v,h.subarray(0,h.length-this.tagLength),f),!s.equal(d,h.subarray(h.length-this.tagLength,h.length)))return null;var g=h.length-this.tagLength,b;if(y){if(y.length!==g)throw new Error("ChaCha20Poly1305: incorrect destination length");b=y}else b=new Uint8Array(g);return t.streamXOR(this._key,p,h.subarray(0,h.length-this.tagLength),b,4),n.wipe(p),b},l.prototype.clean=function(){return n.wipe(this._key),this},l.prototype._authenticate=function(u,h,f,y){var p=new r.Poly1305(h);y&&(p.update(y),y.length%16>0&&p.update(a.subarray(y.length%16))),p.update(f),f.length%16>0&&p.update(a.subarray(f.length%16));var v=new Uint8Array(8);y&&i.writeUint64LE(y.length,v),p.update(v),i.writeUint64LE(f.length,v),p.update(v);for(var d=p.digest(),g=0;g<d.length;g++)u[g]=d[g];p.clean(),n.wipe(d),n.wipe(v)},l}();e.ChaCha20Poly1305=o}),sde=A((e,t)=>{c(),t.exports=a;var r=128,n=127,i=~n,s=Math.pow(2,31);function a(o,l,u){l=l||[],u=u||0;for(var h=u;o>=s;)l[u++]=o&255|r,o/=128;for(;o&i;)l[u++]=o&255|r,o>>>=7;return l[u]=o|0,a.bytes=u-h+1,l}}),ude=A((e,t)=>{c(),t.exports=i;var r=128,n=127;function i(s,l){var o=0,l=l||0,u=0,h=l,f,y=s.length;do{if(h>=y)throw i.bytes=0,new RangeError("Could not decode varint");f=s[h++],o+=u<28?(f&n)<<u:(f&n)*Math.pow(2,u),u+=7}while(f>=r);return i.bytes=h-l,o}}),fde=A((e,t)=>{c();var r=Math.pow(2,7),n=Math.pow(2,14),i=Math.pow(2,21),s=Math.pow(2,28),a=Math.pow(2,35),o=Math.pow(2,42),l=Math.pow(2,49),u=Math.pow(2,56),h=Math.pow(2,63);t.exports=function(f){return f<r?1:f<n?2:f<i?3:f<s?4:f<a?5:f<o?6:f<l?7:f<u?8:f<h?9:10}}),dde=A((e,t)=>{c(),t.exports={encode:sde(),decode:ude(),encodingLength:fde()}}),yde=A((e,t)=>{"use strict";c();var r=dde();t.exports=n=>{if(!(n instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let i=[];for(;n.length>0;){let s=r.decode(n);i.push(s),n=n.slice(r.decode.bytes)}return i}}),kde=A((e,t)=>{"use strict";c();var r=Math.exp;e=t.exports=function(n){if(typeof n!="number")throw new Error("must provide a timespan to the moving average constructor");if(n<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let i,s=0,a=0,o=0,l,u={};function h(f,y){return 1-r(-(f-y)/n)}return u.push=function(f,y){if(l){let p=h(f,l),v=y-i,d=p*v;i=p*y+(1-p)*i,s=(1-p)*(s+v*d),a=Math.sqrt(s),o=i+p*v}else i=y;l=f},u.movingAverage=function(){return i},u.variance=function(){return s},u.deviation=function(){return a},u.forecast=function(){return o},u}}),FLe={};ct(FLe,{create:()=>BLe,globSource:()=>MLe,urlSource:()=>ULe}),c(),c(),c();var tO=w(z7(),1),Ze=tO.default,Jde=w($7(),1);c();var ya=w(Mi(),1);Hr(),si(),ma(),ya.default.formatters.b=e=>e==null?"undefined":Ne.baseEncode(e),ya.default.formatters.t=e=>e==null?"undefined":xt.baseEncode(e),ya.default.formatters.m=e=>e==null?"undefined":to.baseEncode(e),ya.default.formatters.p=e=>e==null?"undefined":e.toString(),ya.default.formatters.c=e=>e==null?"undefined":e.toString(),ya.default.formatters.k=e=>e==null?"undefined":e.toString();function C(e){return Object.assign((0,ya.default)(e),{error:(0,ya.default)(`${e}:error`),trace:(0,ya.default)(`${e}:trace`)})}var I7=w(K(),1);c();var U4=w(K(),1);c();var gc=w(Ea(),1),up=gc.default.Reader,m9=gc.default.Writer,Ke=gc.default.util,Xn=gc.default.roots["ipfs-unixfs"]||(gc.default.roots["ipfs-unixfs"]={}),uL=Xn.Data=(()=>{function e(t){if(this.blocksizes=[],t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.Type=0,e.prototype.Data=Ke.newBuffer([]),e.prototype.filesize=Ke.Long?Ke.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=Ke.emptyArray,e.prototype.hashType=Ke.Long?Ke.Long.fromBits(0,0,!0):0,e.prototype.fanout=Ke.Long?Ke.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(t,r){if(r||(r=m9.create()),r.uint32(8).int32(t.Type),t.Data!=null&&Object.hasOwnProperty.call(t,"Data")&&r.uint32(18).bytes(t.Data),t.filesize!=null&&Object.hasOwnProperty.call(t,"filesize")&&r.uint32(24).uint64(t.filesize),t.blocksizes!=null&&t.blocksizes.length)for(var n=0;n<t.blocksizes.length;++n)r.uint32(32).uint64(t.blocksizes[n]);return t.hashType!=null&&Object.hasOwnProperty.call(t,"hashType")&&r.uint32(40).uint64(t.hashType),t.fanout!=null&&Object.hasOwnProperty.call(t,"fanout")&&r.uint32(48).uint64(t.fanout),t.mode!=null&&Object.hasOwnProperty.call(t,"mode")&&r.uint32(56).uint32(t.mode),t.mtime!=null&&Object.hasOwnProperty.call(t,"mtime")&&Xn.UnixTime.encode(t.mtime,r.uint32(66).fork()).ldelim(),r},e.decode=function(t,r){t instanceof up||(t=up.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new Xn.Data;t.pos<n;){var s=t.uint32();switch(s>>>3){case 1:i.Type=t.int32();break;case 2:i.Data=t.bytes();break;case 3:i.filesize=t.uint64();break;case 4:if(i.blocksizes&&i.blocksizes.length||(i.blocksizes=[]),(s&7)===2)for(var a=t.uint32()+t.pos;t.pos<a;)i.blocksizes.push(t.uint64());else i.blocksizes.push(t.uint64());break;case 5:i.hashType=t.uint64();break;case 6:i.fanout=t.uint64();break;case 7:i.mode=t.uint32();break;case 8:i.mtime=Xn.UnixTime.decode(t,t.uint32());break;default:t.skipType(s&7);break}}if(!i.hasOwnProperty("Type"))throw Ke.ProtocolError("missing required 'Type'",{instance:i});return i},e.fromObject=function(t){if(t instanceof Xn.Data)return t;var r=new Xn.Data;switch(t.Type){case"Raw":case 0:r.Type=0;break;case"Directory":case 1:r.Type=1;break;case"File":case 2:r.Type=2;break;case"Metadata":case 3:r.Type=3;break;case"Symlink":case 4:r.Type=4;break;case"HAMTShard":case 5:r.Type=5;break}if(t.Data!=null&&(typeof t.Data=="string"?Ke.base64.decode(t.Data,r.Data=Ke.newBuffer(Ke.base64.length(t.Data)),0):t.Data.length&&(r.Data=t.Data)),t.filesize!=null&&(Ke.Long?(r.filesize=Ke.Long.fromValue(t.filesize)).unsigned=!0:typeof t.filesize=="string"?r.filesize=parseInt(t.filesize,10):typeof t.filesize=="number"?r.filesize=t.filesize:typeof t.filesize=="object"&&(r.filesize=new Ke.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0))),t.blocksizes){if(!Array.isArray(t.blocksizes))throw TypeError(".Data.blocksizes: array expected");r.blocksizes=[];for(var n=0;n<t.blocksizes.length;++n)Ke.Long?(r.blocksizes[n]=Ke.Long.fromValue(t.blocksizes[n])).unsigned=!0:typeof t.blocksizes[n]=="string"?r.blocksizes[n]=parseInt(t.blocksizes[n],10):typeof t.blocksizes[n]=="number"?r.blocksizes[n]=t.blocksizes[n]:typeof t.blocksizes[n]=="object"&&(r.blocksizes[n]=new Ke.LongBits(t.blocksizes[n].low>>>0,t.blocksizes[n].high>>>0).toNumber(!0))}if(t.hashType!=null&&(Ke.Long?(r.hashType=Ke.Long.fromValue(t.hashType)).unsigned=!0:typeof t.hashType=="string"?r.hashType=parseInt(t.hashType,10):typeof t.hashType=="number"?r.hashType=t.hashType:typeof t.hashType=="object"&&(r.hashType=new Ke.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0))),t.fanout!=null&&(Ke.Long?(r.fanout=Ke.Long.fromValue(t.fanout)).unsigned=!0:typeof t.fanout=="string"?r.fanout=parseInt(t.fanout,10):typeof t.fanout=="number"?r.fanout=t.fanout:typeof t.fanout=="object"&&(r.fanout=new Ke.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0))),t.mode!=null&&(r.mode=t.mode>>>0),t.mtime!=null){if(typeof t.mtime!="object")throw TypeError(".Data.mtime: object expected");r.mtime=Xn.UnixTime.fromObject(t.mtime)}return r},e.toObject=function(t,r){r||(r={});var n={};if((r.arrays||r.defaults)&&(n.blocksizes=[]),r.defaults){if(n.Type=r.enums===String?"Raw":0,r.bytes===String?n.Data="":(n.Data=[],r.bytes!==Array&&(n.Data=Ke.newBuffer(n.Data))),Ke.Long){var i=new Ke.Long(0,0,!0);n.filesize=r.longs===String?i.toString():r.longs===Number?i.toNumber():i}else n.filesize=r.longs===String?"0":0;if(Ke.Long){var i=new Ke.Long(0,0,!0);n.hashType=r.longs===String?i.toString():r.longs===Number?i.toNumber():i}else n.hashType=r.longs===String?"0":0;if(Ke.Long){var i=new Ke.Long(0,0,!0);n.fanout=r.longs===String?i.toString():r.longs===Number?i.toNumber():i}else n.fanout=r.longs===String?"0":0;n.mode=0,n.mtime=null}if(t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=r.enums===String?Xn.Data.DataType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=r.bytes===String?Ke.base64.encode(t.Data,0,t.Data.length):r.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),t.filesize!=null&&t.hasOwnProperty("filesize")&&(typeof t.filesize=="number"?n.filesize=r.longs===String?String(t.filesize):t.filesize:n.filesize=r.longs===String?Ke.Long.prototype.toString.call(t.filesize):r.longs===Number?new Ke.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0):t.filesize),t.blocksizes&&t.blocksizes.length){n.blocksizes=[];for(var s=0;s<t.blocksizes.length;++s)typeof t.blocksizes[s]=="number"?n.blocksizes[s]=r.longs===String?String(t.blocksizes[s]):t.blocksizes[s]:n.blocksizes[s]=r.longs===String?Ke.Long.prototype.toString.call(t.blocksizes[s]):r.longs===Number?new Ke.LongBits(t.blocksizes[s].low>>>0,t.blocksizes[s].high>>>0).toNumber(!0):t.blocksizes[s]}return t.hashType!=null&&t.hasOwnProperty("hashType")&&(typeof t.hashType=="number"?n.hashType=r.longs===String?String(t.hashType):t.hashType:n.hashType=r.longs===String?Ke.Long.prototype.toString.call(t.hashType):r.longs===Number?new Ke.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0):t.hashType),t.fanout!=null&&t.hasOwnProperty("fanout")&&(typeof t.fanout=="number"?n.fanout=r.longs===String?String(t.fanout):t.fanout:n.fanout=r.longs===String?Ke.Long.prototype.toString.call(t.fanout):r.longs===Number?new Ke.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0):t.fanout),t.mode!=null&&t.hasOwnProperty("mode")&&(n.mode=t.mode),t.mtime!=null&&t.hasOwnProperty("mtime")&&(n.mtime=Xn.UnixTime.toObject(t.mtime,r)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,gc.default.util.toJSONOptions)},e.DataType=function(){let t={},r=Object.create(t);return r[t[0]="Raw"]=0,r[t[1]="Directory"]=1,r[t[2]="File"]=2,r[t[3]="Metadata"]=3,r[t[4]="Symlink"]=4,r[t[5]="HAMTShard"]=5,r}(),e})(),IBe=Xn.UnixTime=(()=>{function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.Seconds=Ke.Long?Ke.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(t,r){return r||(r=m9.create()),r.uint32(8).int64(t.Seconds),t.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(t,"FractionalNanoseconds")&&r.uint32(21).fixed32(t.FractionalNanoseconds),r},e.decode=function(t,r){t instanceof up||(t=up.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new Xn.UnixTime;t.pos<n;){var s=t.uint32();switch(s>>>3){case 1:i.Seconds=t.int64();break;case 2:i.FractionalNanoseconds=t.fixed32();break;default:t.skipType(s&7);break}}if(!i.hasOwnProperty("Seconds"))throw Ke.ProtocolError("missing required 'Seconds'",{instance:i});return i},e.fromObject=function(t){if(t instanceof Xn.UnixTime)return t;var r=new Xn.UnixTime;return t.Seconds!=null&&(Ke.Long?(r.Seconds=Ke.Long.fromValue(t.Seconds)).unsigned=!1:typeof t.Seconds=="string"?r.Seconds=parseInt(t.Seconds,10):typeof t.Seconds=="number"?r.Seconds=t.Seconds:typeof t.Seconds=="object"&&(r.Seconds=new Ke.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber())),t.FractionalNanoseconds!=null&&(r.FractionalNanoseconds=t.FractionalNanoseconds>>>0),r},e.toObject=function(t,r){r||(r={});var n={};if(r.defaults){if(Ke.Long){var i=new Ke.Long(0,0,!1);n.Seconds=r.longs===String?i.toString():r.longs===Number?i.toNumber():i}else n.Seconds=r.longs===String?"0":0;n.FractionalNanoseconds=0}return t.Seconds!=null&&t.hasOwnProperty("Seconds")&&(typeof t.Seconds=="number"?n.Seconds=r.longs===String?String(t.Seconds):t.Seconds:n.Seconds=r.longs===String?Ke.Long.prototype.toString.call(t.Seconds):r.longs===Number?new Ke.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber():t.Seconds),t.FractionalNanoseconds!=null&&t.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=t.FractionalNanoseconds),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,gc.default.util.toJSONOptions)},e})(),CBe=Xn.Metadata=(()=>{function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.MimeType="",e.encode=function(t,r){return r||(r=m9.create()),t.MimeType!=null&&Object.hasOwnProperty.call(t,"MimeType")&&r.uint32(10).string(t.MimeType),r},e.decode=function(t,r){t instanceof up||(t=up.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new Xn.Metadata;t.pos<n;){var s=t.uint32();switch(s>>>3){case 1:i.MimeType=t.string();break;default:t.skipType(s&7);break}}return i},e.fromObject=function(t){if(t instanceof Xn.Metadata)return t;var r=new Xn.Metadata;return t.MimeType!=null&&(r.MimeType=String(t.MimeType)),r},e.toObject=function(t,r){r||(r={});var n={};return r.defaults&&(n.MimeType=""),t.MimeType!=null&&t.hasOwnProperty("MimeType")&&(n.MimeType=t.MimeType),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,gc.default.util.toJSONOptions)},e})(),wc=uL,lL=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],q0e=["directory","hamt-sharded-directory"],fL=parseInt("0644",8),hL=parseInt("0755",8);function Ec(e){if(e!=null)return typeof e=="number"?e&4095:(e=e.toString(),e.substring(0,1)==="0"?parseInt(e,8)&4095:parseInt(e,10)&4095)}function qu(e){if(e==null)return;let t;if(e.secs!=null&&(t={secs:e.secs,nsecs:e.nsecs}),e.Seconds!=null&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){let r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:(r-n*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(t!=null&&t.nsecs!=null&&(t.nsecs<0||t.nsecs>999999999))throw(0,U4.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}var Je=class{static unmarshal(e){let t=wc.decode(e),r=wc.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new Je({type:lL[r.Type],data:r.Data,blockSizes:r.blocksizes,mode:r.mode,mtime:r.mtime?{secs:r.mtime.Seconds,nsecs:r.mtime.FractionalNanoseconds}:void 0});return n._originalMode=r.mode||0,n}constructor(e={type:"file"}){let{type:t,data:r,blockSizes:n,hashType:i,fanout:s,mtime:a,mode:o}=e;if(t&&!lL.includes(t))throw(0,U4.default)(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=r,this.hashType=i,this.fanout=s,this.blockSizes=n||[],this._originalMode=0,this.mode=Ec(o),a&&(this.mtime=qu(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?hL:fL;let t=Ec(e);t!==void 0&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&q0e.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(t=>{e+=t}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=wc.DataType.Raw;break;case"directory":e=wc.DataType.Directory;break;case"file":e=wc.DataType.File;break;case"metadata":e=wc.DataType.Metadata;break;case"symlink":e=wc.DataType.Symlink;break;case"hamt-sharded-directory":e=wc.DataType.HAMTShard;break;default:throw(0,U4.default)(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t=this.data;(!this.data||!this.data.length)&&(t=void 0);let r;this.mode!=null&&(r=this._originalMode&4294963200|(Ec(this.mode)||0),r===fL&&!this.isDirectory()&&(r=void 0),r===hL&&this.isDirectory()&&(r=void 0));let n;if(this.mtime!=null){let s=qu(this.mtime);s&&(n={Seconds:s.secs,FractionalNanoseconds:s.nsecs},n.FractionalNanoseconds===0&&delete n.FractionalNanoseconds)}let i={Type:e,Data:t,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:r,mtime:n};return wc.encode(i).finish()}},At={};ct(At,{code:()=>pt,createLink:()=>IL,createNode:()=>TL,decode:()=>Rt,encode:()=>je,name:()=>x1e,prepare:()=>Ln,validate:()=>b9}),c(),te(),c();var p1e=new TextDecoder;function w9(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");let i=e[t++];if(r+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[r,t]}function z4(e,t){let r;[r,t]=w9(e,t);let n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function EL(e,t){let r;return[r,t]=w9(e,t),[r&7,r>>3,t]}function m1e(e){let t={},r=e.length,n=0;for(;n<r;){let i,s;if([i,s,n]=EL(e,n),s===1){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(t.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=z4(e,n)}else if(s===2){if(t.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let a;[a,n]=z4(e,n),t.Name=p1e.decode(a)}else if(s===3){if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[t.Tsize,n]=w9(e,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}function bL(e){let t=e.length,r=0,n,i=!1,s;for(;r<t;){let o,l;if([o,l,r]=EL(e,r),o!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${o}`);if(l===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,r]=z4(e,r),n&&(i=!0)}else if(l===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let u;[u,r]=z4(e,r),n.push(m1e(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${l}`)}if(r>t)throw new Error("protobuf: (PBNode) unexpected end of data");let a={};return s&&(a.Data=s),a.Links=n||[],a}c();var vL=new TextEncoder,_L=2**32,y1e=2**31;function g1e(e,t){let r=t.length;if(typeof e.Tsize=="number"){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=Qm(t,r,e.Tsize)-1,t[r]=24}if(typeof e.Name=="string"){let n=vL.encode(e.Name);r-=n.length,t.set(n,r),r=Qm(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=Qm(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function SL(e){let t=E1e(e),r=new Uint8Array(t),n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=Qm(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let i=e.Links.length-1;i>=0;i--){let s=g1e(e.Links[i],r.subarray(0,n));n-=s,n=Qm(r,n,s)-1,r[n]=18}return r}function w1e(e){let t=0;if(e.Hash){let r=e.Hash.length;t+=1+r+hp(r)}if(typeof e.Name=="string"){let r=vL.encode(e.Name).length;t+=1+r+hp(r)}return typeof e.Tsize=="number"&&(t+=1+hp(e.Tsize)),t}function E1e(e){let t=0;if(e.Data){let r=e.Data.length;t+=1+r+hp(r)}if(e.Links)for(let r of e.Links){let n=w1e(r);t+=1+n+hp(n)}return t}function Qm(e,t,r){t-=hp(r);let n=t;for(;r>=y1e;)e[t++]=r&127|128,r/=128;for(;r>=128;)e[t++]=r&127|128,r>>>=7;return e[t]=r,n}function hp(e){return e%2===0&&e++,Math.floor((b1e(e)+6)/7)}function b1e(e){let t=0;return e>=_L&&(e=Math.floor(e/_L),t=32),e>=65536&&(e>>>=16,t+=16),e>=256&&(e>>>=8,t+=8),t+_1e[e]}var _1e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];c(),te();var v1e=["Data","Links"],S1e=["Hash","Name","Tsize"],E9=new TextEncoder;function RL(e,t){if(e===t)return 0;let r=e.Name?E9.encode(e.Name):[],n=t.Name?E9.encode(t.Name):[],i=r.length,s=n.length;for(let a=0,o=Math.min(i,s);a<o;++a)if(r[a]!==n[a]){i=r[a],s=n[a];break}return i<s?-1:s<i?1:0}function xL(e,t){return!Object.keys(e).some(r=>!t.includes(r))}function AL(e){if(typeof e.asCID=="object"){let r=I.asCID(e);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if(typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");let t={};if(e.Hash){let r=I.asCID(e.Hash);try{r||(typeof e.Hash=="string"?r=I.parse(e.Hash):e.Hash instanceof Uint8Array&&(r=I.decode(e.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}r&&(t.Hash=r)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return typeof e.Name=="string"&&(t.Name=e.Name),typeof e.Tsize=="number"&&(t.Tsize=e.Tsize),t}function Ln(e){if((e instanceof Uint8Array||typeof e=="string")&&(e={Data:e}),typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");let t={};if(e.Data!==void 0)if(typeof e.Data=="string")t.Data=E9.encode(e.Data);else if(e.Data instanceof Uint8Array)t.Data=e.Data;else throw new TypeError("Invalid DAG-PB form");if(e.Links!==void 0)if(Array.isArray(e.Links))t.Links=e.Links.map(AL),t.Links.sort(RL);else throw new TypeError("Invalid DAG-PB form");else t.Links=[];return t}function b9(e){if(!e||typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");if(!xL(e,v1e))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(e.Data!==void 0&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let t=0;t<e.Links.length;t++){let r=e.Links[t];if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!xL(r,S1e))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash.asCID!==r.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0&&(typeof r.Tsize!="number"||r.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t>0&&RL(r,e.Links[t-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function TL(e,t=[]){return Ln({Data:e,Links:t})}function IL(e,t,r){return AL({Hash:r,Name:e,Tsize:t})}var x1e="dag-pb",pt=112;function je(e){b9(e);let t={};return e.Links&&(t.Links=e.Links.map(r=>{let n={};return r.Hash&&(n.Hash=r.Hash.bytes),r.Name!==void 0&&(n.Name=r.Name),r.Tsize!==void 0&&(n.Tsize=r.Tsize),n})),e.Data&&(t.Data=e.Data),SL(t)}function Rt(e){let t=bL(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map(n=>{let i={};try{i.Hash=I.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),r}var vc={};ct(vc,{code:()=>qf,decode:()=>zf,encode:()=>U9,name:()=>nme}),c(),Vf(),te();var OB=42;function Z1e(e){if(e.asCID!==e)return null;let t=I.asCID(e);if(!t)return null;let r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new Q(L.tag,OB),new Q(L.bytes,r)]}function J1e(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function eme(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var tme={float64:!0,typeEncoders:{Object:Z1e,undefined:J1e,number:eme}};function rme(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return I.decode(e.subarray(1))}var LB={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};LB.tags[OB]=rme;var nme="dag-cbor",qf=113,U9=e=>ao(e,tme),zf=e=>Mn(e,LB),vp={};ct(vp,{code:()=>$9,decode:()=>dme,encode:()=>hme,name:()=>fme}),c(),bp(),ma(),Vf(),c(),c(),vi(),L9(),ro(),zu();var K9=class extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){let t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===L.array&&(t.elements++,t.elements!==1&&e.push([44])),t.type===L.map&&(t.elements++,t.elements!==1&&(t.elements%2===1?e.push([44]):e.push([58]))))}[L.uint.major](e,t){this.prefix(e);let r=String(t.value),n=[];for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);e.push(n)}[L.negint.major](e,t){this[L.uint.major](e,t)}[L.bytes.major](e,t){throw new Error(`${bc} unsupported type: Uint8Array`)}[L.string.major](e,t){this.prefix(e);let r=$4(JSON.stringify(t.value));e.push(r.length>32?Xm(r):r)}[L.array.major](e,t){this.prefix(e),this.inRecursive.push({type:L.array,elements:0}),e.push([91])}[L.map.major](e,t){this.prefix(e),this.inRecursive.push({type:L.map,elements:0}),e.push([123])}[L.tag.major](e,t){}[L.float.major](e,t){if(t.type.name==="break"){let s=this.inRecursive.pop();if(s){if(s.type===L.array)e.push([93]);else if(s.type===L.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(t.value===void 0)throw new Error(`${bc} unsupported type: undefined`);if(this.prefix(e),t.type.name==="true"){e.push([116,114,117,101]);return}else if(t.type.name==="false"){e.push([102,97,108,115,101]);return}else if(t.type.name==="null"){e.push([110,117,108,108]);return}let r=String(t.value),n=[],i=!1;for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s),!i&&(n[s]===46||n[s]===101||n[s]===69)&&(i=!0);i||(n.push(46),n.push(48)),e.push(n)}};function ime(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error(`${bc} complex map keys are not supported`);let r=e[0],n=t[0];if(r.type!==L.string||n.type!==L.string)throw new Error(`${bc} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${bc} unexpected duplicate map keys, this is not supported`)}var ome={addBreakTokens:!0,mapSorter:ime};function V9(e,t){return t=Object.assign({},ome,t),O9(e,new K9,t)}c(),M9(),vi(),zu(),ro();var _p=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${Ie} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${Ie} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){let e=this.pos,t=!1,r=!1,n=a=>{for(;!this.done();){let o=this.ch();if(a.includes(o))this.pos++;else break}};if(this.ch()===45&&(t=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,r=!0;else return new Q(L.uint,0,this.pos-e);if(n([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${Ie} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(r)throw new Error(`${Ie} unexpected token at position ${this.pos}`);r=!0,this.pos++,n([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(r=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,n([48,49,50,51,52,53,54,55,56,57]));let i=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),s=parseFloat(i);return r?new Q(L.float,s,this.pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(s)?new Q(s>=0?L.uint:L.negint,s,this.pos-e):new Q(s>=0?L.uint:L.negint,BigInt(i),this.pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${Ie} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let i=this.pos,s=0;i<this.data.length&&s<65536;i++,s++){let a=this.data[i];if(a===92||a<32||a>=128)break;if(a===34){let o=String.fromCharCode.apply(null,this.data.subarray(this.pos,i));return this.pos=i+1,new Q(L.string,o,s)}}let e=this.pos,t=[],r=()=>{if(this.pos+4>=this.data.length)throw new Error(`${Ie} unexpected end of unicode escape sequence at position ${this.pos}`);let i=0;for(let s=0;s<4;s++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${Ie} unexpected unicode escape character at position ${this.pos}`);i=i*16+a,this.pos++}return i},n=()=>{let i=this.ch(),s=null,a=i>239?4:i>223?3:i>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${Ie} unexpected unicode sequence at position ${this.pos}`);let o,l,u,h;switch(a){case 1:i<128&&(s=i);break;case 2:o=this.data[this.pos+1],(o&192)===128&&(h=(i&31)<<6|o&63,h>127&&(s=h));break;case 3:o=this.data[this.pos+1],l=this.data[this.pos+2],(o&192)===128&&(l&192)===128&&(h=(i&15)<<12|(o&63)<<6|l&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:o=this.data[this.pos+1],l=this.data[this.pos+2],u=this.data[this.pos+3],(o&192)===128&&(l&192)===128&&(u&192)===128&&(h=(i&15)<<18|(o&63)<<12|(l&63)<<6|u&63,h>65535&&h<1114112&&(s=h))}s===null?(s=65533,a=1):s>65535&&(s-=65536,t.push(s>>>10&1023|55296),s=56320|s&1023),t.push(s),this.pos+=a};for(;!this.done();){let i=this.ch(),s;switch(i){case 92:if(this.pos++,this.done())throw new Error(`${Ie} unexpected string termination at position ${this.pos}`);switch(s=this.ch(),this.pos++,s){case 34:case 39:case 92:case 47:t.push(s);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(r());break;default:throw new Error(`${Ie} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new Q(L.string,_9(t),this.pos-e);default:if(i<32)throw new Error(`${Ie} invalid control character at position ${this.pos}`);i<128?(t.push(i),this.pos++):n()}}throw new Error(`${Ie} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new Q(L.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new Q(L.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Q(L.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Q(L.false,!1,5);case 116:return this.expect([116,114,117,101]),new Q(L.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${Ie} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new Q(L.break,void 0,1);if(this.ch()!==44)throw new Error(`${Ie} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new Q(L.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new Q(L.break,void 0,1);if(this.ch()!==44)throw new Error(`${Ie} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new Q(L.break,void 0,1);let e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${Ie} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${Ie} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}};function q9(e,t){return t=Object.assign({tokenizer:new _p(e,t)},t),Mn(e,t)}function ame(e){if(e.asCID!==e)return null;let t=I.asCID(e);if(!t)return null;let r=t.toString();return[new Q(L.map,1/0,1),new Q(L.string,"/",1),new Q(L.string,r,r.length),new Q(L.break,void 0,1)]}function MB(e){let t=to.encode(e).slice(1);return[new Q(L.map,1/0,1),new Q(L.string,"/",1),new Q(L.map,1/0,1),new Q(L.string,"bytes",5),new Q(L.string,t,t.length),new Q(L.break,void 0,1),new Q(L.break,void 0,1)]}function cme(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function ume(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var lme={typeEncoders:{Object:ame,Uint8Array:MB,Buffer:MB,undefined:cme,number:ume}},z9=class extends _p{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let e=this._next();if(e.type===L.map){let t=this._next();if(t.type===L.string&&t.value==="/"){let r=this._next();if(r.type===L.string){if(this._next().type!==L.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(r),new Q(L.tag,42,0)}if(r.type===L.map){let n=this._next();if(n.type===L.string&&n.value==="bytes"){let i=this._next();if(i.type===L.string){for(let a=0;a<2;a++)if(this._next().type!==L.break)throw new Error("Invalid encoded Bytes form");let s=to.decode(`m${i.value}`);return new Q(L.bytes,s,i.value.length)}this.tokenBuffer.push(i)}this.tokenBuffer.push(n)}this.tokenBuffer.push(r)}this.tokenBuffer.push(t)}return e}},H9={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};H9.tags[42]=I.parse;var fme="dag-json",$9=297,hme=e=>V9(e,lme),dme=e=>{let t=Object.assign(H9,{tokenizer:new z9(e,H9)});return q9(e,t)},kLe=w(Z9(),1);va(),o2(),c(),c();var Sc=class extends Error{constructor(e="not initialized"){super(e),this.name="NotInitializedError",this.code=Sc.code}};Sc.code="ERR_NOT_INITIALIZED";var lS=class extends Error{constructor(e="cannot initialize an initializing node"){super(e),this.name="AlreadyInitializingError",this.code=Ts.code}};lS.code="ERR_ALREADY_INITIALIZING";var Ts=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e),this.name="AlreadyInitializedError",this.code=Ts.code}};Ts.code="ERR_ALREADY_INITIALIZED";var xc=class extends Error{constructor(e="not started"){super(e),this.name="NotStartedError",this.code=xc.code}};xc.code="ERR_NOT_STARTED";var $f=class extends Error{constructor(e="cannot start, already startin"){super(e),this.name="AlreadyStartingError",this.code=$f.code}};$f.code="ERR_ALREADY_STARTING";var Gf=class extends Error{constructor(e="cannot start, already started"){super(e),this.name="AlreadyStartedError",this.code=Gf.code}};Gf.code="ERR_ALREADY_STARTED";var Is=class extends Error{constructor(e="not enabled"){super(e),this.name="NotEnabledError",this.code=Is.code}};Is.code="ERR_NOT_ENABLED",Re(),c(),c(),c();var HU=w(m2(),1);te(),c(),Lp(),me(),Re();var Rc="/",NU=new TextEncoder().encode(Rc),bw=NU[0],ae=class{constructor(e,t){if(typeof e=="string")this._buf=U(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==bw)throw new Error("Invalid key")}toString(e="utf8"){return M(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new ae(e.join(Rc))}static random(){return new ae(jf().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new ae(e):e.uint8Array?new ae(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=NU),this._buf[0]!==bw){let e=new Uint8Array(this._buf.byteLength+1);e.fill(bw,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===bw;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),r=e.list();for(let n=0;n<t.length;n++){if(r.length<n+1)return!1;let i=t[n],s=r[n];if(i<s)return!0;if(i>s)return!1}return t.length<r.length}reverse(){return ae.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Rc).slice(1)}type(){return wye(this.baseNamespace())}name(){return Eye(this.baseNamespace())}instance(e){return new ae(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Rc)||(e+=Rc),e+=this.type(),new ae(e)}parent(){let e=this.list();return e.length===1?new ae(Rc):new ae(e.slice(0,-1).join(Rc))}child(e){return this.toString()===Rc?e:e.toString()===Rc?this:new ae(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return ae.withNamespaces([...this.namespaces(),...bye(e.map(t=>t.namespaces()))])}};function wye(e){let t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function Eye(e){let t=e.split(":");return t[t.length-1]}function bye(e){return[].concat(...e)}var vw=w(K(),1);c();var VU=w($o(),1),qU=w(Vi(),1);c();var Sye=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;mt.nanosecond=mt.ns=1e-6,mt.\u00B5s=mt.\u03BCs=mt.us=mt.microsecond=.001,mt.millisecond=mt.ms=mt[""]=1,mt.second=mt.sec=mt.s=mt.ms*1e3,mt.minute=mt.min=mt.m=mt.s*60,mt.hour=mt.hr=mt.h=mt.m*60,mt.day=mt.d=mt.h*24,mt.week=mt.wk=mt.w=mt.d*7,mt.month=mt.b=mt.d*30.4375,mt.year=mt.yr=mt.y=mt.d*365.25;function mt(e="",t="ms"){var r=null;return e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2"),e.replace(Sye,function(n,i,s){s=KU(s),s&&(r=(r||0)+parseFloat(i,10)*s)}),r&&r/(KU(t)||1)}function KU(e){return mt[e]||mt[e.toLowerCase().replace(/s$/,"")]}var ju=mt;c();var Ac=class extends Error{constructor(e="request timed out"){super(e),this.name="TimeoutError",this.code=Ac.code}};Ac.code="ERR_TIMEOUT";function B(e,t){return(...r)=>{let n=r[t??r.length-1];if(!n||!n.timeout)return e(...r);let i=typeof n.timeout=="string"?ju(n.timeout):n.timeout,s=new VU.TimeoutController(i);n.signal=(0,qU.anySignal)([n.signal,s.signal]);let a=e(...r),o=new Promise((h,f)=>{s.signal.addEventListener("abort",()=>{f(new Ac)})}),l=Date.now(),u=()=>{if(s.signal.aborted)throw new Ac;if(Date.now()-l>i)throw s.abort(),new Ac};return a[Symbol.asyncIterator]?async function*(){let h=a[Symbol.asyncIterator]();try{for(;;){let{value:f,done:y}=await Promise.race([h.next(),o]);if(y)break;u(),yield f}}catch(f){throw u(),f}finally{s.clear(),h.return&&h.return()}}():(async()=>{try{let h=await Promise.race([a,o]);return u(),h}catch(h){throw u(),h}finally{s.clear()}})()}}c(),te();var KS=w(K(),1),zU="/ipfs/";function Tc(e){if(e instanceof Uint8Array)try{e=I.decode(e)}catch(i){throw(0,KS.default)(i,"ERR_INVALID_CID")}let t=I.asCID(e);if(t)return{cid:t,path:void 0};e=e.toString(),e.startsWith(zU)&&(e=e.substring(zU.length));let r=e.split("/"),n;try{t=I.parse(r.shift()||"")}catch(i){throw(0,KS.default)(i,"ERR_INVALID_CID")}return r.length&&(n=`/${r.join("/")}`),{cid:t,path:n}}var xye="ERR_BAD_PATH",Sw="This command must be run in online mode. Try running 'ipfs daemon' first.",w2=new ae("/local/filesroot"),E2=262144,$U=e=>{if(I.asCID(e))return`/ipfs/${e}`;let t=e.toString();try{return`/ipfs/${I.parse(t)}`}catch{}if(HU.default.path(t))return t;throw(0,vw.default)(new Error(`invalid path: ${e}`),xye)},Bp=e=>e instanceof Uint8Array?I.decode(e).toString():(e=e.toString(),e.indexOf("/ipfs/")===0&&(e=e.substring(6)),e.charAt(e.length-1)==="/"&&(e=e.substring(0,e.length-1)),e),Yu=async function(e,t,r,n={}){let{cid:i,path:s}=Tc(r);s&&(n.path=s);let a=i,o=n.path||"";if(o.startsWith("/")&&(o=o.substring(1)),n.path)try{for await(let{value:l,remainderPath:u}of Qu(i,n.path,t,e,{signal:n.signal})){if(!I.asCID(l))break;o=u,a=l}}catch(l){throw l.message.startsWith("Object has no property")&&(l.message=`no link named "${o.split("/")[0]}" under ${a}`,l.code="ERR_NO_LINK"),l}return{cid:a,remainderPath:o||""}},VS=e=>{if(e.type!=="file"&&e.type!=="directory"&&e.type!=="raw")throw new Error(`Unknown node type '${e.type}'`);let t={cid:e.cid,path:e.path,name:e.name,size:e.size,type:"file"};return e.type==="directory"&&(t.type="dir"),e.type==="file"&&(t.size=e.unixfs.fileSize()),(e.type==="file"||e.type==="directory")&&(t.mode=e.unixfs.mode,e.unixfs.mtime!==void 0&&(t.mtime=e.unixfs.mtime)),t},GU=B(async(e,t)=>await e),Qu=async function*(e,t,r,n,i){let s=async u=>{let h=await r.getCodec(u.code),f=await n.blocks.get(u,i);return h.decode(f)},a=t.split("/").filter(Boolean),o=await s(e),l=e;for(;a.length;){let u=a.shift();if(!u)throw(0,vw.default)(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(e.code===pt&&Array.isArray(o.Links)){let h=o.Links.find(f=>f.Name===u);if(h){yield{value:h.Hash,remainderPath:a.join("/")},o=await s(h.Hash),l=h.Hash;continue}}if(Object.prototype.hasOwnProperty.call(o,u))o=o[u],yield{value:o,remainderPath:a.join("/")};else throw(0,vw.default)(new Error(`no link named "${u}" under ${l}`),"ERR_NO_LINK");I.asCID(o)&&(l=o,o=await s(o))}yield{value:o,remainderPath:""}},li=class{static create({start:e,stop:t}){return new li(e,t)}static async start(e,t){let{state:r,activate:n}=e;switch(r.status){case"stopped":try{let i=n(t);e.state={status:"starting",ready:i};let s=await i;return e.state={status:"started",value:s},s}catch(i){throw e.state={status:"stopped"},i}case"starting":throw new $f;case"started":throw new Gf;case"stopping":return await r.ready,await li.start(e,t);default:return li.panic(e)}}static async stop(e){let{state:t,deactivate:r}=e;switch(t.status){case"stopped":break;case"starting":{try{await t.ready}catch{}return await li.stop(e)}case"stopping":return await t.ready;case"started":{r&&await r(t.value),e.state={status:"stopped"};break}default:li.panic(t)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},t){switch(e.status){case"started":return e.value;case"starting":return await GU(e.ready,t);default:throw new xc}}static panic({state:e}){let t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}async use(e){return await li.use(this,e)}try(){return li.try(this)}};function WU({network:e,preload:t,peerId:r,keychain:n,repo:i,ipns:s,mfsPreload:a,print:o,hashers:l,options:u}){return async()=>{let{libp2p:h}=await li.start(e,{peerId:r,repo:i,print:o,hashers:l,options:u});await Promise.all([s.startOnline({keychain:n,libp2p:h,peerId:r,repo:i}),t.start(),a.start()])}}c();function jU({network:e,preload:t,ipns:r,repo:n,mfsPreload:i}){return async()=>{await Promise.all([t.stop(),r.stop(),i.stop()]),await li.stop(e),await n.close()}}c(),c(),c();var QU=w(Mp(),1),xw=class{constructor(e){this.lru=(0,QU.default)(e)}get(e){let t=this.lru.get(e);if(t){if(t.expire&&t.expire<Date.now()){this.lru.remove(e);return}return t.value}}set(e,t,r){this.lru.set(e,{value:t,expire:Date.now()+r})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};c();var sF=w(Xu(),1);c();var hi=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},zS=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},ZU=e=>globalThis.DOMException===void 0?new zS(e):new DOMException(e),JU=e=>{let t=e.reason===void 0?ZU("This operation was aborted."):e.reason;return t instanceof Error?t:ZU(t)};function nn(e,t,r,n){let i,s=new Promise((a,o)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){a(e);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:l}=n;l.aborted&&o(JU(l)),l.addEventListener("abort",()=>{o(JU(l))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{a(r())}catch(h){o(h)}return}let l=typeof r=="string"?r:`Promise timed out after ${t} milliseconds`,u=r instanceof Error?r:new hi(l);typeof e.cancel=="function"&&e.cancel(),o(u)},t),(async()=>{try{a(await e)}catch(l){o(l)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return s.clear=()=>{clearTimeout(i),i=void 0},s}c(),c();function HS(e,t,r){let n=0,i=e.length;for(;i>0;){let s=Math.trunc(i/2),a=n+s;r(e[a],t)<=0?(n=++a,i-=s+1):i=s}return n}var Yf=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Ic,_2=class{constructor(){Ic.set(this,[])}enqueue(e,t){t={priority:0,...t};let r={priority:t.priority,run:e};if(this.size&&Yf(this,Ic,"f")[this.size-1].priority>=t.priority){Yf(this,Ic,"f").push(r);return}let n=HS(Yf(this,Ic,"f"),r,(i,s)=>s.priority-i.priority);Yf(this,Ic,"f").splice(n,0,r)}dequeue(){return Yf(this,Ic,"f").shift()?.run}filter(e){return Yf(this,Ic,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return Yf(this,Ic,"f").length}};Ic=new WeakMap;var Zt=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},we=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Fn,S2,x2,Ju,Pw,R2,Aw,Ds,v2,co,Tw,uo,A2,Zu,Up,Fp,Qf,Iw,eF,tF,oF,rF,nF,iF,Cw,$S,GS,Dw,kw=()=>{},Tye=new hi,WS=class extends Error{},ks=class extends sF.default{constructor(e){var t,r,n,i;if(super(),Fn.add(this),S2.set(this,void 0),x2.set(this,void 0),Ju.set(this,0),Pw.set(this,void 0),R2.set(this,void 0),Aw.set(this,0),Ds.set(this,void 0),v2.set(this,void 0),co.set(this,void 0),Tw.set(this,void 0),uo.set(this,0),A2.set(this,void 0),Zu.set(this,void 0),Up.set(this,kw),Fp.set(this,kw),Qf.set(this,void 0),Iw.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:_2,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);Zt(this,S2,e.carryoverConcurrencyCount,"f"),Zt(this,x2,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),Zt(this,Pw,e.intervalCap,"f"),Zt(this,R2,e.interval,"f"),Zt(this,co,new e.queueClass,"f"),Zt(this,Tw,e.queueClass,"f"),this.concurrency=e.concurrency,Zt(this,Qf,e.timeout,"f"),Zt(this,Iw,e.throwOnTimeout===!0,"f"),Zt(this,Zu,e.autoStart===!1,"f")}get concurrency(){return we(this,A2,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);Zt(this,A2,e,"f"),we(this,Fn,"m",Dw).call(this)}async add(e,t={}){return new Promise((r,n)=>{let i=async()=>{var s,a,o;Zt(this,uo,(a=we(this,uo,"f"),a++,a),"f"),Zt(this,Ju,(o=we(this,Ju,"f"),o++,o),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){n(new WS("The task was aborted."));return}let l=await(we(this,Qf,"f")===void 0&&t.timeout===void 0?e({signal:t.signal}):nn(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?we(this,Qf,"f"):t.timeout,()=>{(t.throwOnTimeout===void 0?we(this,Iw,"f"):t.throwOnTimeout)&&n(Tye)}));r(l),this.emit("completed",l)}catch(l){n(l),this.emit("error",l)}we(this,Fn,"m",oF).call(this)};we(this,co,"f").enqueue(i,t),we(this,Fn,"m",Cw).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return we(this,Zu,"f")?(Zt(this,Zu,!1,"f"),we(this,Fn,"m",Dw).call(this),this):this}pause(){Zt(this,Zu,!0,"f")}clear(){Zt(this,co,new(we(this,Tw,"f")),"f")}async onEmpty(){if(we(this,co,"f").size!==0)return new Promise(e=>{let t=we(this,Up,"f");Zt(this,Up,()=>{t(),e()},"f")})}async onSizeLessThan(e){if(!(we(this,co,"f").size<e))return new Promise(t=>{let r=()=>{we(this,co,"f").size<e&&(this.removeListener("next",r),t())};this.on("next",r)})}async onIdle(){if(!(we(this,uo,"f")===0&&we(this,co,"f").size===0))return new Promise(e=>{let t=we(this,Fp,"f");Zt(this,Fp,()=>{t(),e()},"f")})}get size(){return we(this,co,"f").size}sizeBy(e){return we(this,co,"f").filter(e).length}get pending(){return we(this,uo,"f")}get isPaused(){return we(this,Zu,"f")}get timeout(){return we(this,Qf,"f")}set timeout(e){Zt(this,Qf,e,"f")}};S2=new WeakMap,x2=new WeakMap,Ju=new WeakMap,Pw=new WeakMap,R2=new WeakMap,Aw=new WeakMap,Ds=new WeakMap,v2=new WeakMap,co=new WeakMap,Tw=new WeakMap,uo=new WeakMap,A2=new WeakMap,Zu=new WeakMap,Up=new WeakMap,Fp=new WeakMap,Qf=new WeakMap,Iw=new WeakMap,Fn=new WeakSet,eF=function(){return we(this,x2,"f")||we(this,Ju,"f")<we(this,Pw,"f")},tF=function(){return we(this,uo,"f")<we(this,A2,"f")},oF=function(){var e;Zt(this,uo,(e=we(this,uo,"f"),e--,e),"f"),we(this,Fn,"m",Cw).call(this),this.emit("next")},rF=function(){we(this,Up,"f").call(this),Zt(this,Up,kw,"f"),we(this,uo,"f")===0&&(we(this,Fp,"f").call(this),Zt(this,Fp,kw,"f"),this.emit("idle"))},nF=function(){we(this,Fn,"m",GS).call(this),we(this,Fn,"m",$S).call(this),Zt(this,v2,void 0,"f")},iF=function(){let e=Date.now();if(we(this,Ds,"f")===void 0){let t=we(this,Aw,"f")-e;if(t<0)Zt(this,Ju,we(this,S2,"f")?we(this,uo,"f"):0,"f");else return we(this,v2,"f")===void 0&&Zt(this,v2,setTimeout(()=>{we(this,Fn,"m",nF).call(this)},t),"f"),!0}return!1},Cw=function(){if(we(this,co,"f").size===0)return we(this,Ds,"f")&&clearInterval(we(this,Ds,"f")),Zt(this,Ds,void 0,"f"),we(this,Fn,"m",rF).call(this),!1;if(!we(this,Zu,"f")){let e=!we(this,Fn,"m",iF).call(this);if(we(this,Fn,"a",eF)&&we(this,Fn,"a",tF)){let t=we(this,co,"f").dequeue();return t?(this.emit("active"),t(),e&&we(this,Fn,"m",$S).call(this),!0):!1}}return!1},$S=function(){we(this,x2,"f")||we(this,Ds,"f")!==void 0||(Zt(this,Ds,setInterval(()=>{we(this,Fn,"m",GS).call(this)},we(this,R2,"f")),"f"),Zt(this,Aw,Date.now()+we(this,R2,"f"),"f"))},GS=function(){we(this,Ju,"f")===0&&we(this,uo,"f")===0&&we(this,Ds,"f")&&(clearInterval(we(this,Ds,"f")),Zt(this,Ds,void 0,"f")),Zt(this,Ju,we(this,S2,"f")?we(this,uo,"f"):0,"f"),we(this,Fn,"m",Dw).call(this)},Dw=function(){for(;we(this,Fn,"m",Cw).call(this););};var _F=w(Vp(),1),rx=new xw(1e3),Wye=60*1e3,jye=ks.default?ks.default:ks,Yye=new jye({concurrency:4}),bF=e=>{if(e.Path)return e.Path;throw new Error(e.Message)};async function vF(e,t){return(async(r,n={})=>{let i=new URLSearchParams(n);i.set("arg",r);let s=i.toString();if(!n.nocache&&rx.has(s)){let o=rx.get(s);return bF(o)}let a=await Yye.add(async()=>{let o=await _F.default.get("https://ipfs.io/api/v0/dns",{searchParams:i}),l=new URL(o.url).search.slice(1),u=await o.json();return rx.set(l,u,Wye),u});return bF(a)})(e,t)}function Qye(e){return e.endsWith(".eth")&&(e=e.replace(/.eth$/,".eth.link")),e}function SF(){return B(async(e,t={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=Qye(e),vF(e,t)})}c();function xF({network:e}){return()=>{let t=e.try();return t!=null&&Boolean(t.libp2p.isStarted())}}c();var ox=w(m2(),1);te(),c(),te(),o2(),Hr(),On(),va(),yr(),vr();var TF=w(K(),1);c();var RF=Symbol.for("@libp2p/peer-id"),AF=Object.values(Sa).map(e=>e.decoder).reduce((e,t)=>e.or(t),Sa.identity.decoder),IF=114,nx=36,ix=37,I2=class{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[RF](){return!0}toString(){return this.string==null&&(this.string=Ne.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return I.createV1(IF,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Ce(this.multihash.bytes,e);if(typeof e=="string")return ue(e).equals(this);if(e?.multihash?.bytes!=null)return Ce(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}},Xf=class extends I2{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}},Zf=class extends I2{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}},Jf=class extends I2{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}};function on(e){let t=(0,TF.default)(new Error("Not a PeerId"),"ERR_INVALID_PARAMETERS");if(e.type==="RSA")return new Xf(e);if(e.type==="Ed25519")return new Zf(e);if(e.type==="secp256k1")return new Jf(e);throw t}function ue(e,t){if(t=t??AF,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=_r(Ne.decode(`z${e}`));return e.startsWith("12D")?new Zf({multihash:r}):e.startsWith("16U")?new Jf({multihash:r}):new Xf({multihash:r})}return Ir(AF.decode(e))}function Ir(e){try{let t=_r(e);if(t.code===$r.code){if(t.digest.length===nx)return new Zf({multihash:t});if(t.digest.length===ix)return new Jf({multihash:t})}if(t.code===xe.code)return new Xf({multihash:t})}catch{return Xye(I.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function Xye(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==IF)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===xe.code)return new Xf({multihash:e.multihash});if(t.code===$r.code){if(t.digest.length===nx)return new Zf({multihash:e.multihash});if(t.digest.length===ix)return new Jf({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function sn(e,t){return e.length===nx?new Zf({multihash:xs($r.code,e),privateKey:t}):e.length===ix?new Jf({multihash:xs($r.code,e),privateKey:t}):new Xf({multihash:await xe.digest(e),publicKey:e,privateKey:t})}function CF({repo:e,codecs:t,bases:r,name:n}){async function i(s,a={}){if(!ox.default.path(s))throw new Error("invalid argument "+s);if(ox.default.ipnsPath(s))for await(let g of n.resolve(s,a))s=g;let[,o,l,...u]=s.split("/"),h=a.cidBase?await r.getBase(a.cidBase):void 0,f=Zye(l);if(u.length===0){let g=h?h.encoder.encode(f):l;return`/${o}/${g}`}let y=I.decode(f);s=u.join("/");let p=Qu(y,s,t,e,a),v=y,d=s;for await(let g of p)I.asCID(g.value)&&(v=g.value,d=g.remainderPath);return`/ipfs/${v.toString(h&&h.encoder)}${d?"/"+d:""}`}return B(i)}function Zye(e){try{return ue(e).toBytes()}catch{return I.parse(e).bytes}}c(),c();var DF=w(qi(),1);te();function kF({addAll:e}){return(t,r={})=>{let n,i=I.asCID(t);return i?n=e([{cid:i,...r}],r):n=e([{path:t.toString(),...r}],r),(0,DF.default)(n)}}c(),c();var qp=w(K(),1);te();async function*xa(e){if(e==null)throw(0,qp.default)(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");let t=I.asCID(e);if(t){yield Ns({cid:t});return}if(e instanceof String||typeof e=="string"){yield Ns({path:e});return}if(e.cid!=null||e.path!=null)return yield Ns(e);if(Symbol.iterator in e){let r=e[Symbol.iterator](),n=r.next();if(n.done)return r;if(I.asCID(n.value)||n.value instanceof String||typeof n.value=="string"){yield Ns({cid:n.value});for(let i of r)yield Ns({cid:i});return}if(n.value.cid!=null||n.value.path!=null){yield Ns(n.value);for(let i of r)yield Ns(i);return}throw(0,qp.default)(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in e){let r=e[Symbol.asyncIterator](),n=await r.next();if(n.done)return r;if(I.asCID(n.value)||n.value instanceof String||typeof n.value=="string"){yield Ns({cid:n.value});for await(let i of r)yield Ns({cid:i});return}if(n.value.cid!=null||n.value.path!=null){yield Ns(n.value);for await(let i of r)yield Ns(i);return}throw(0,qp.default)(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw(0,qp.default)(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}function Ns(e){let t=e.cid||`${e.path}`;if(!t)throw(0,qp.default)(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let r={path:t,recursive:e.recursive!==!1};return e.metadata!=null&&(r.metadata=e.metadata),r}c();var vt={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function NF({repo:e,codecs:t}){async function*r(n,i={}){let s=async function*(){for await(let{path:o,recursive:l,metadata:u}of xa(n)){let{cid:h}=await Yu(e,t,o),{reason:f}=await e.pins.isPinnedWithType(h,[vt.recursive,vt.direct]);if(f==="recursive"&&!l)throw new Error(`${h} already pinned recursively`);l?await e.pins.pinRecursively(h,{metadata:u}):await e.pins.pinDirectly(h,{metadata:u}),yield h}};if(!Boolean(i.lock)){yield*s();return}let a=await e.gcLock.readLock();try{yield*s()}finally{a()}}return B(r)}c();var sx=w(K(),1);function C2(e,t,r){let n={type:e,cid:t};return r&&(n.metadata=r),n}function OF({repo:e,codecs:t}){async function*r(n={}){let i=vt.all;if(n.type&&(i=n.type,!Object.keys(vt).includes(i)))throw(0,sx.default)(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(n.paths){let s=!1;for await(let{path:a}of xa(n.paths)){let{cid:o}=await Yu(e,t,a),{reason:l,pinned:u,parent:h,metadata:f}=await e.pins.isPinnedWithType(o,i);if(!u)throw(0,sx.default)(new Error(`path '${a}' is not pinned`),"ERR_NOT_PINNED");switch(l){case vt.direct:case vt.recursive:s=!0,yield C2(l,o,f);break;default:s=!0,yield C2(`${vt.indirect} through ${h}`,o,f)}}if(!s)throw new Error("No match found");return}if(i===vt.recursive||i===vt.all)for await(let{cid:s,metadata:a}of e.pins.recursiveKeys())yield C2(vt.recursive,s,a);if(i===vt.indirect||i===vt.all)for await(let s of e.pins.indirectKeys(n))yield C2(vt.indirect,s);if(i===vt.direct||i===vt.all)for await(let{cid:s,metadata:a}of e.pins.directKeys())yield C2(vt.direct,s,a)}return B(r)}c();var LF=w(qi(),1);function BF({rmAll:e}){async function t(r,n={}){let i=await(0,LF.default)(e([{path:r,...n}],n));if(!i)throw new Error("CID expected");return i}return t}c();function MF({repo:e,codecs:t}){async function*r(n,i={}){let s=await e.gcLock.readLock();try{for await(let{path:a,recursive:o}of xa(n)){let{cid:l}=await Yu(e,t,a),{pinned:u,reason:h}=await e.pins.isPinnedWithType(l,vt.all);if(!u)throw new Error(`${l} is not pinned`);switch(h){case vt.recursive:if(!o)throw new Error(`${l} is pinned recursively`);await e.pins.unpin(l),yield l;break;case vt.direct:await e.pins.unpin(l),yield l;break;default:throw new Error(`${l} is pinned indirectly under ${h}`)}}}finally{s()}}return B(r)}var Ow=class{constructor({codecs:e,repo:t}){let r=NF({codecs:e,repo:t});this.addAll=r,this.add=kF({addAll:r});let n=MF({codecs:e,repo:t});this.rmAll=n,this.rm=BF({rmAll:n}),this.ls=OF({codecs:e,repo:t}),this.remote={add:(i,s={})=>Promise.reject(new Error("Not implemented")),ls:async function*(i,s={}){return Promise.reject(new Error("Not implemented"))},rm:(i,s={})=>Promise.reject(new Error("Not implemented")),rmAll:(i,s={})=>Promise.reject(new Error("Not implemented")),service:{add:(i,s)=>Promise.reject(new Error("Not implemented")),rm:(i,s={})=>Promise.reject(new Error("Not implemented")),ls:(i={})=>Promise.reject(new Error("Not implemented"))}}}};c(),c();var zq=w(K(),1);c(),c();var ege=Symbol.for("@libp2p/peer-id");function Go(e){return e!=null&&Boolean(e[ege])}var el={};ct(el,{abortedError:()=>tge,dbDeleteFailedError:()=>Bw,dbOpenFailedError:()=>Lw,dbWriteFailedError:()=>Mw,notFoundError:()=>Rn}),c();var zp=w(K(),1);function Lw(e){return e=e||new Error("Cannot open database"),(0,zp.default)(e,"ERR_DB_OPEN_FAILED")}function Bw(e){return e=e||new Error("Delete failed"),(0,zp.default)(e,"ERR_DB_DELETE_FAILED")}function Mw(e){return e=e||new Error("Write failed"),(0,zp.default)(e,"ERR_DB_WRITE_FAILED")}function Rn(e){return e=e||new Error("Not Found"),(0,zp.default)(e,"ERR_NOT_FOUND")}function tge(e){return e=e||new Error("Aborted"),(0,zp.default)(e,"ERR_ABORTED")}var Zo=w(K(),1);me(),yr(),c();var Nq=w(UF(),1),v6={};ct(v6,{generateEphemeralKeyPair:()=>SV,generateKeyPair:()=>sR,generateKeyPairFromSeed:()=>_6e,importKey:()=>Mc,keyStretcher:()=>gV,keysPBM:()=>Hp,marshalPrivateKey:()=>S6e,marshalPublicKey:()=>v6e,supportedKeys:()=>La,unmarshalPrivateKey:()=>Jn,unmarshalPublicKey:()=>ho}),c();var Hp={};ct(Hp,{KeyType:()=>Fr,PrivateKey:()=>Ls,PublicKey:()=>Os}),c(),c(),c(),c(),c(),c();function eh(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}ur(),yr(),Re(),me(),c();function Pc(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}var KF=Symbol.for("@achingbrain/uint8arraylist");function FF(e,t,r){if(t==null||t<0||t>=r)throw new RangeError("index is out of bounds");let n=0;for(let i of e){let s=n+i.byteLength;if(t<s)return{buf:i,index:t-n};n=s}throw new RangeError("index is out of bounds")}function tl(e){return Boolean(e?.[KF])}var qe=class{constructor(...e){Object.defineProperty(this,KF,{value:!0}),this.bufs=[],this.length=0,this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(let r of e)if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.push(r);else if(tl(r))t+=r.length,this.bufs=this.bufs.concat(r.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=t}get(e){let t=FF(this.bufs,e,this.length);return t.buf[t.index]}set(e,t){let r=FF(this.bufs,e,this.length);r.buf[r.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let r=0;r<e.length;r++)this.set(t+r,e[r]);else if(tl(e))for(let r=0;r<e.length;r++)this.set(t+r,e.get(r));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0))for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}slice(e,t){let{bufs:r,length:n}=this._subList(e,t);return Ae(r,n)}subarray(e,t){let{bufs:r}=this._subList(e,t),n=new qe;return n.appendAll(r),n}_subList(e,t){if(e==null&&t==null)return{bufs:this.bufs,length:this.length};if(e=e??0,t=t??(this.length>0?this.length:0),e<0||t>this.length)throw new RangeError("index out of bounds");if(e===t)return{bufs:[],length:0};let r=[],n=0;for(let i of this.bufs){let s=n,a=s+i.byteLength,o=e>=s&&e<a,l=t>s&&t<=a,u=e<s&&t>=a;n=a;let h,f;if(o&&(h=e-s,f=i.byteLength),l&&(f=t-s,h==null&&(h=0)),u&&(h=0,f=i.byteLength),h!=null&&f!=null&&r.push(i.subarray(h,f)),l)break}return{bufs:r,length:t-e}}getInt8(e){let t=this.slice(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){let r=new Uint8Array(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt8(0,t),this.write(r,e)}getInt16(e,t){let r=this.slice(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt16(0,t)}setInt16(e,t,r){let n=new Uint8Array(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt16(0,t,r),this.write(n,e)}getInt32(e,t){let r=this.slice(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt32(0,t)}setInt32(e,t,r){let n=new Uint8Array(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt32(0,t,r),this.write(n,e)}getBigInt64(e,t){let r=this.slice(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigInt64(0,t)}setBigInt64(e,t,r){let n=new Uint8Array(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigInt64(0,t,r),this.write(n,e)}getUint8(e){let t=this.slice(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){let r=new Uint8Array(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint8(0,t),this.write(r,e)}getUint16(e,t){let r=this.slice(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,t)}setUint16(e,t,r){let n=new Uint8Array(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint16(0,t,r),this.write(n,e)}getUint32(e,t){let r=this.slice(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint32(0,t)}setUint32(e,t,r){let n=new Uint8Array(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,t,r),this.write(n,e)}getBigUint64(e,t){let r=this.slice(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigUint64(0,t)}setBigUint64(e,t,r){let n=new Uint8Array(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigUint64(0,t,r),this.write(n,e)}getFloat32(e,t){let r=this.slice(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat32(0,t)}setFloat32(e,t,r){let n=new Uint8Array(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat32(0,t,r),this.write(n,e)}getFloat64(e,t){let r=this.slice(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat64(0,t)}setFloat64(e,t,r){let n=new Uint8Array(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat64(0,t,r),this.write(n,e)}};c(),c();function Ra(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}c();var VF=4294967296,Kn=class{constructor(e=0,t=0){this.hi=e,this.lo=t}toBigInt(e){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){let t=~this.lo+1>>>0,r=~this.hi>>>0;return t===0&&(r=r+1>>>0),-(BigInt(t)+(BigInt(r)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}zzDecode(){let e=-(this.lo&1),t=((this.lo>>>1|this.hi<<31)^e)>>>0,r=(this.hi>>>1^e)>>>0;return new Kn(r,t)}zzEncode(){let e=this.hi>>31,t=((this.hi<<1|this.lo>>>31)^e)>>>0,r=(this.lo<<1^e)>>>0;return new Kn(t,r)}toBytes(e,t=0){let r=Ra(e);for(;this.hi>0;)r.set(t++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)r.set(t++,this.lo&127|128),this.lo=this.lo>>>7;r.set(t++,this.lo)}static fromBigInt(e){if(e===0n)return new Kn;let t=e<0;t&&(e=-e);let r=Number(e>>32n)|0,n=Number(e-(BigInt(r)<<32n))|0;return t&&(r=~r>>>0,n=~n>>>0,++n>VF&&(n=0,++r>VF&&(r=0))),new Kn(r,n)}static fromNumber(e){if(e===0)return new Kn;let t=e<0;t&&(e=-e);let r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new Kn(n,r)}static fromBytes(e,t){let r=Ra(e),n=new Kn,i=0;if(e.length-t>4){for(;i<4;++i)if(n.lo=(n.lo|(r.get(t)&127)<<i*7)>>>0,r.get(t++)<128)return n;if(n.lo=(n.lo|(r.get(t)&127)<<28)>>>0,n.hi=(n.hi|(r.get(t)&127)>>4)>>>0,r.get(t++)<128)return n;i=0}else{for(;i<3;++i){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(n.lo=(n.lo|(r.get(t)&127)<<i*7)>>>0,r.get(t++)<128)return n}return n.lo=(n.lo|(r.get(t++)&127)<<i*7)>>>0,n}if(e.length-t>4){for(;i<5;++i)if(n.hi=(n.hi|(r.get(t)&127)<<i*7+3)>>>0,r.get(t++)<128)return n}else for(;i<5;++i){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(n.hi=(n.hi|(r.get(t)&127)<<i*7+3)>>>0,r.get(t++)<128)return n}throw Error("invalid varint encoding")}},qF=128,rge=127,nge=~rge,ige=Math.pow(2,31),oge=Math.pow(2,7),sge=Math.pow(2,14),age=Math.pow(2,21),cge=Math.pow(2,28),uge=Math.pow(2,35),lge=Math.pow(2,42),fge=Math.pow(2,49),hge=Math.pow(2,56),dge=Math.pow(2,63),We={encodingLength(e){return e<oge?1:e<sge?2:e<age?3:e<cge?4:e<uge?5:e<lge?6:e<fge?7:e<hge?8:e<dge?9:10},encode(e,t){let r=0,n=Ra(t);for(;e>=ige;)n.set(r++,e&255|qF),e/=128;for(;(e&nge)>0;)n.set(r++,e&255|qF),e>>>=7;n.set(r,e|0)},decode(e,t=0){let r=Ra(e),n=4294967295;if(n=(r.get(t)&127)>>>0,r.get(t++)<128||(n=(n|(r.get(t)&127)<<7)>>>0,r.get(t++)<128)||(n=(n|(r.get(t)&127)<<14)>>>0,r.get(t++)<128)||(n=(n|(r.get(t)&127)<<21)>>>0,r.get(t++)<128)||(n=(n|(r.get(t)&15)<<28)>>>0,r.get(t++)<128))return n;if((t+=5)>e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);return n}},Uw={encodingLength(e){return e<0?10:We.encodingLength(e)},encode(e,t){if(e<0){let r=0,n=Ra(t),i=Kn.fromNumber(e);for(;i.hi>0;)n.set(r++,i.lo&127|128),i.lo=(i.lo>>>7|i.hi<<25)>>>0,i.hi>>>=7;for(;i.lo>127;)n.set(r++,i.lo&127|128),i.lo=i.lo>>>7;n.set(r++,i.lo);return}We.encode(e,t)},decode(e,t=0){return We.decode(e,t)|0}},Fw={encodingLength(e){return e=(e<<1^e>>31)>>>0,We.encodingLength(e)},encode(e,t,r=0){return e=(e<<1^e>>31)>>>0,We.encode(e,t)},decode(e,t=0){let r=We.decode(e,t);return r>>>1^-(r&1)|0}};function Ye(e,t){let r=new Uint8Array(We.encodingLength(e.length));return We.encode(e.length,r),t.decode(new qe(r,e),0)}c();function Qe(e,t){let r=t.encode(e),n=We.encodingLength(We.decode(r));return r.slice(n)}c(),c();var ot;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(ot||(ot={}));function Pt(e,t,r,n,i){return{name:e,type:t,encode:r,decode:n,encodingLength:i}}var pge=function(){return 1},mge=function(e){return Uint8Array.from([e?1:0])},yge=function(e,t){return e.get(t)>0},P2=Pt("bool",ot.VARINT,mge,yge,pge);c();var gge=function(e){let t=e.byteLength;return We.encodingLength(t)+t},wge=function(e){let t=new Uint8Array(We.encodingLength(e.byteLength));return We.encode(e.byteLength,t),new qe(t,e)},Ege=function(e,t){let r=We.decode(e,t);return t+=We.encodingLength(r),e.slice(t,t+r)},ye=Pt("bytes",ot.LENGTH_DELIMITED,wge,Ege,gge);c();var zF=function(){return 8},bge=function(e){let t=new qe(new Uint8Array(zF(e)));return t.setFloat64(0,e,!0),t},_ge=function(e,t){return e.getFloat64(t,!0)},vge=Pt("double",ot.BIT64,bge,_ge,zF);c();function xi(e){function t(s){if(e[s.toString()]==null)throw new Error("Invalid enum value");return typeof s=="number"?s:e[s]}let r=function(s){return We.encodingLength(t(s))},n=function(s){let a=t(s),o=new Uint8Array(We.encodingLength(a));return We.encode(a,o),o},i=function(s,a){let o=We.decode(s,a).toString();if(e[o]==null)throw new Error("Invalid enum value");return e[o]};return Pt("enum",ot.VARINT,n,i,r)}c();var HF=function(){return 4},Sge=function(e){let t=new qe(new Uint8Array(HF(e)));return t.setInt32(0,e,!0),t},xge=function(e,t){return e.getInt32(t,!0)},Rge=Pt("fixed32",ot.BIT32,Sge,xge,HF);c();var $F=function(e){return 8},Age=function(e){let t=new qe(new Uint8Array($F(e)));return t.setBigInt64(0,e,!0),t},Tge=function(e,t){return e.getBigInt64(t,!0)},Ige=Pt("fixed64",ot.BIT64,Age,Tge,$F);c();var GF=function(){return 4},Cge=function(e){let t=new qe(new Uint8Array(GF(1)));return t.setFloat32(0,e,!0),t},Pge=function(e,t){return e.getFloat32(t,!0)},Dge=Pt("float",ot.BIT32,Cge,Pge,GF);c();var WF=function(e){return Uw.encodingLength(e)},kge=function(e){let t=new Uint8Array(WF(e));return Uw.encode(e,t),t},Nge=function(e,t){return Uw.decode(e,t)},cx=Pt("int32",ot.VARINT,kge,Nge,WF);c(),c();var jF=0x7fn,rl={encodingLength(e){let t=0;for(;e>=0x80n;t++)e>>=7n;return t+1},encode(e,t){let r=Ra(t),n=0;for(;jF<e;)r.set(n++,Number(e&jF)|128),e>>=7n;r.set(n,Number(e))},decode(e,t=0){return Kn.fromBytes(e,t).toBigInt(!0)}},Kw={encodingLength(e){return e<0n?10:rl.encodingLength(e)},encode(e,t,r=0){if(e<0n){Kn.fromBigInt(e).toBytes(t,r);return}return rl.encode(e,t)},decode(e,t=0){return Kn.fromBytes(e,t).toBigInt(!1)}},Vw={encodingLength(e){return rl.encodingLength(e>=0?e*2n:e*-2n-1n)},encode(e,t,r=0){Kn.fromBigInt(e).zzEncode().toBytes(t,r)},decode(e,t=0){return Kn.fromBytes(e,t).zzDecode().toBigInt(!1)}},YF=function(e){return Kw.encodingLength(e)},Oge=function(e){let t=new Uint8Array(YF(e));return Kw.encode(e,t),t},Lge=function(e,t){return Kw.decode(e,t)|0n},Bge=Pt("int64",ot.VARINT,Oge,Lge,YF);c();function Xe(e){let t=function(i){let s=0;for(let a of Object.values(e))s+=a.codec.encodingLength(i[a.name]);return We.encodingLength(s)+s},r=function(i){let s=new qe;function a(l,u,h){if(l==null){if(h.optional===!0)return;throw new Error(`Non optional field "${h.name}" was ${l===null?"null":"undefined"}`)}let f=u<<3|h.codec.type,y=new Uint8Array(We.encodingLength(f));We.encode(f,y);let p=h.codec.encode(l);s.append(y),s.append(p)}for(let[l,u]of Object.entries(e)){let h=parseInt(l);if(u.repeats===!0){if(!Array.isArray(i[u.name]))throw new Error(`Repeating field "${u.name}" was not an array`);for(let f of i[u.name])a(f,h,u)}else a(i[u.name],h,u)}let o=new Uint8Array(We.encodingLength(s.length));return We.encode(s.length,o),new qe(o,s)},n=function(i,s){let a=We.decode(i,s);s+=We.encodingLength(a);let o=s+a,l={};for(;s<o;){let u=We.decode(i,s);s+=We.encodingLength(u);let h=u&7,f=u>>3,y=e[f],p=0;if(h===ot.VARINT)if(y!=null){let v=y.codec.decode(i,s);p=y.codec.encodingLength(v)}else{let v=We.decode(i,s);p=We.encodingLength(v)}else if(h===ot.BIT64)p=8;else if(h===ot.LENGTH_DELIMITED){let v=We.decode(i,s);p=v+We.encodingLength(v)}else if(h===ot.BIT32)p=4;else{if(h===ot.START_GROUP)throw new Error("Unsupported wire type START_GROUP");if(h===ot.END_GROUP)throw new Error("Unsupported wire type END_GROUP")}if(y!=null){let v=y.codec.decode(i,s);y.repeats===!0?(l[y.name]==null&&(l[y.name]=[]),l[y.name].push(v)):l[y.name]=v}s+=p}for(let u of Object.values(e))u.repeats===!0&&l[u.name]==null&&(l[u.name]=[]);return l};return Pt("message",ot.LENGTH_DELIMITED,r,n,t)}c();var QF=function(){return 4},Mge=function(e){let t=new qe(new Uint8Array(QF(e)));return t.setInt32(0,e,!0),t},Uge=function(e,t){return e.getInt32(t,!0)},Fge=Pt("sfixed32",ot.BIT32,Mge,Uge,QF);c();var XF=function(){return 8},Kge=function(e){let t=new qe(new Uint8Array(XF(e)));return t.setBigInt64(0,e,!0),t},Vge=function(e,t){return e.getBigInt64(t,!0)},qge=Pt("sfixed64",ot.BIT64,Kge,Vge,XF);c();var ZF=function(e){return Fw.encodingLength(e)},zge=function(e){let t=new Uint8Array(ZF(e));return Fw.encode(e,t),t},Hge=function(e,t){return Fw.decode(e,t)},$ge=Pt("sint32",ot.VARINT,zge,Hge,ZF);c();var JF=function(e){return Vw.encodingLength(e)},Gge=function(e){let t=new Uint8Array(JF(e));return Vw.encode(e,t),t},Wge=function(e,t){return Vw.decode(e,t)},jge=Pt("sint64",ot.VARINT,Gge,Wge,JF);c(),Re(),me();var Yge=function(e){let t=U(e).byteLength;return We.encodingLength(t)+t},Qge=function(e){let t=U(e),r=new Uint8Array(We.encodingLength(t.byteLength));return We.encode(t.length,r),new qe(r,t)},Xge=function(e,t){let r=We.decode(e,t);return t+=We.encodingLength(r),M(e.slice(t,t+r))},pn=Pt("string",ot.LENGTH_DELIMITED,Qge,Xge,Yge);c();var eK=function(e){return We.encodingLength(e)},Zge=function(e){let t=new Uint8Array(eK(e));return We.encode(e,t),t},Jge=function(e,t){return We.decode(e,t)},e3e=Pt("uint32",ot.VARINT,Zge,Jge,eK);c();var t3e=function(e){return rl.encodingLength(e)},r3e=function(e){let t=new Uint8Array(rl.encodingLength(e));return rl.encode(e,t),t},n3e=function(e,t){return rl.decode(e,t)},nl=Pt("uint64",ot.VARINT,r3e,n3e,t3e),Fr;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(Fr||(Fr={}));var ux;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(ux||(ux={})),function(e){e.codec=()=>xi(ux)}(Fr||(Fr={}));var Os;(function(e){e.codec=()=>Xe({1:{name:"Type",codec:Fr.codec()},2:{name:"Data",codec:ye}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(Os||(Os={}));var Ls;(function(e){e.codec=()=>Xe({1:{name:"Type",codec:Fr.codec()},2:{name:"Data",codec:ye}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(Ls||(Ls={}));var oHe=w(Aa(),1),sHe=w(i6(),1),b6=w(st(),1),_6=w(K(),1);Re(),c();var kx=w(K(),1);ur(),Re(),c(),c();var an={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};c();var dV={SHA1:20,SHA256:32,SHA512:64},Iwe={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},Cwe=async(e,t)=>{let r=await an.get().subtle.sign({name:"HMAC"},e,t);return new Uint8Array(r,0,r.byteLength)};async function pV(e,t){let r=Iwe[e],n=await an.get().subtle.importKey("raw",t,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return await Cwe(n,i)},length:dV[e]}}var yV={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function gV(e,t,r){let n=yV[e];if(n==null){let _=Object.keys(yV).join(" / ");throw(0,kx.default)(new Error(`unknown cipher type '${e}'. Must be ${_}`),"ERR_INVALID_CIPHER_TYPE")}if(t==null)throw(0,kx.default)(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,s=n.ivSize,a=20,o=U("key expansion"),l=2*(s+i+a),u=await pV(t,r),h=await u.digest(o),f=[],y=0;for(;y<l;){let _=await u.digest(Ae([h,o])),m=_.length;y+m>l&&(m=l-y),f.push(_),y+=m,h=await u.digest(h)}let p=l/2,v=Ae(f),d=v.slice(0,p),g=v.slice(p,l),b=_=>({iv:_.slice(0,s),cipherKey:_.slice(s,s+i),macKey:_.slice(s+i)});return{k1:b(d),k2:b(g)}}c(),c();var Xp=w(K(),1);c();var sze=w(gr(),1),aze=w(L2(),1),wV=w(st(),1);Re(),me(),ur();function Us(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Ae([new Uint8Array(t-r.length),r])}return M(r,"base64url")}function lo(e){let t=o6(e);return new wV.default.jsbn.BigInteger(M(t,"base16"),16)}function o6(e,t){let r=U(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Ae([new Uint8Array(t-r.length),r])}return r}me(),ur(),yr();var EV={"P-256":256,"P-384":384,"P-521":521},Pwe=Object.keys(EV),Nx=Pwe.join(" / ");async function bV(e){if(e!=="P-256"&&e!=="P-384"&&e!=="P-521")throw(0,Xp.default)(new Error(`Unknown curve: ${e}. Must be ${Nx}`),"ERR_INVALID_CURVE");let t=await an.get().subtle.generateKey({name:"ECDH",namedCurve:e},!0,["deriveBits"]),r=async(i,s)=>{let a;s!=null?a=await an.get().subtle.importKey("jwk",kwe(e,s),{name:"ECDH",namedCurve:e},!1,["deriveBits"]):a=t.privateKey;let o=await an.get().subtle.importKey("jwk",vV(e,i),{name:"ECDH",namedCurve:e},!1,[]),l=await an.get().subtle.deriveBits({name:"ECDH",namedCurve:e,public:o},a,EV[e]);return new Uint8Array(l,0,l.byteLength)},n=await an.get().subtle.exportKey("jwk",t.publicKey);return{key:Dwe(n),genSharedKey:r}}var _V={"P-256":32,"P-384":48,"P-521":66};function Dwe(e){if(e.crv==null||e.x==null||e.y==null)throw(0,Xp.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");if(e.crv!=="P-256"&&e.crv!=="P-384"&&e.crv!=="P-521")throw(0,Xp.default)(new Error(`Unknown curve: ${e.crv}. Must be ${Nx}`),"ERR_INVALID_CURVE");let t=_V[e.crv];return Ae([Uint8Array.from([4]),o6(e.x,t),o6(e.y,t)],1+t*2)}function vV(e,t){if(e!=="P-256"&&e!=="P-384"&&e!=="P-521")throw(0,Xp.default)(new Error(`Unknown curve: ${e}. Must be ${Nx}`),"ERR_INVALID_CURVE");let r=_V[e];if(!Ce(t.slice(0,1),Uint8Array.from([4])))throw(0,Xp.default)(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:e,x:M(t.slice(1,r+1),"base64url"),y:M(t.slice(1+r),"base64url"),ext:!0}}var kwe=(e,t)=>({...vV(e,t.public),d:M(t.private,"base64url")}),SV=bV;c(),ma(),c(),ur(),Re();function s6(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,a=e?.iterations??32767,o=an.get();r*=8;async function l(h,f){let y=o.getRandomValues(new Uint8Array(s)),p=o.getRandomValues(new Uint8Array(n)),v={name:t,iv:p};typeof f=="string"&&(f=U(f));let d={name:"PBKDF2",salt:y,iterations:a,hash:{name:i}},g=await o.subtle.importKey("raw",f,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(d,g,{name:t,length:r},!0,["encrypt"]),_=await o.subtle.encrypt(v,b,h);return Ae([y,v.iv,new Uint8Array(_)])}async function u(h,f){let y=h.slice(0,s),p=h.slice(s,s+n),v=h.slice(s+n),d={name:t,iv:p};typeof f=="string"&&(f=U(f));let g={name:"PBKDF2",salt:y,iterations:a,hash:{name:i}},b=await o.subtle.importKey("raw",f,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),_=await o.subtle.deriveKey(g,b,{name:t,length:r},!0,["decrypt"]),m=await o.subtle.decrypt(d,_,v);return new Uint8Array(m)}return{encrypt:l,decrypt:u}}async function RV(e,t){let r=to.decode(e);return await s6().decrypt(r,t)}var Vx={};ct(Vx,{RsaPrivateKey:()=>Jp,RsaPublicKey:()=>U2,fromJwk:()=>zwe,generateKeyPair:()=>Hwe,unmarshalRsaPrivateKey:()=>Vwe,unmarshalRsaPublicKey:()=>qwe}),c(),vr();var Kx=w(K(),1);yr(),me();var Gze=w(Bx(),1),M2=w(st(),1);c(),c();var DV=w(uh(),1),kV=w(K(),1);function Fs(e){if(isNaN(e)||e<=0)throw(0,kV.default)(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return(0,DV.default)(e)}me(),Re();var lh={};ct(lh,{jwkToPkcs1:()=>Bwe,jwkToPkix:()=>Uwe,pkcs1ToJwk:()=>Lwe,pkixToJwk:()=>Mwe}),c();var Ize=w(Aa(),1),Cze=w(sh(),1),Oc=w(st(),1);Re(),me();var Mx=w(K(),1);function Lwe(e){let t=Oc.default.asn1.fromDer(M(e,"ascii")),r=Oc.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Us(r.n),e:Us(r.e),d:Us(r.d),p:Us(r.p),q:Us(r.q),dp:Us(r.dP),dq:Us(r.dQ),qi:Us(r.qInv),alg:"RS256"}}function Bwe(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw(0,Mx.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let t=Oc.default.pki.privateKeyToAsn1({n:lo(e.n),e:lo(e.e),d:lo(e.d),p:lo(e.p),q:lo(e.q),dP:lo(e.dp),dQ:lo(e.dq),qInv:lo(e.qi)});return U(Oc.default.asn1.toDer(t).getBytes(),"ascii")}function Mwe(e){let t=Oc.default.asn1.fromDer(M(e,"ascii")),r=Oc.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Us(r.n),e:Us(r.e)}}function Uwe(e){if(e.n==null||e.e==null)throw(0,Mx.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let t=Oc.default.pki.publicKeyToAsn1({n:lo(e.n),e:lo(e.e)});return U(Oc.default.asn1.toDer(t).getBytes(),"ascii")}c();var Nze=w(sh(),1),Ux=w(st(),1);function NV(e,t){return t.map(r=>lo(e[r]))}function OV(e){return Ux.default.pki.setRsaPrivateKey(...NV(e,["n","e","d","p","q","dp","dq","qi"]))}function LV(e){return Ux.default.pki.setRsaPublicKey(...NV(e,["n","e"]))}var BV=w(K(),1);async function MV(e){let t=await an.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await KV(t);return{privateKey:r[0],publicKey:r[1]}}async function Fx(e){let t=[await an.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Fwe(e)],r=await KV({privateKey:t[0],publicKey:t[1]});return{privateKey:r[0],publicKey:r[1]}}async function UV(e,t){let r=await an.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await an.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function FV(e,t,r){let n=await an.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await an.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function KV(e){if(e.privateKey==null||e.publicKey==null)throw(0,BV.default)(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([an.get().subtle.exportKey("jwk",e.privateKey),an.get().subtle.exportKey("jwk",e.publicKey)])}async function Fwe(e){return await an.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function VV(e,t,r,n){let i=t?LV(e):OV(e),s=M(Uint8Array.from(r),"ascii"),a=n(s,i);return U(a,"ascii")}function qV(e,t){return VV(e,!0,t,(r,n)=>n.encrypt(r))}function zV(e,t){return VV(e,!1,t,(r,n)=>n.decrypt(r))}c(),ma();async function Zp(e,t){let r=await s6().encrypt(e,t);return to.encode(r)}var U2=class{constructor(e){this._key=e}async verify(e,t){return await FV(this._key,t,e)}marshal(){return lh.jwkToPkix(this._key)}get bytes(){return Os.encode({Type:Fr.RSA,Data:this.marshal()})}encrypt(e){return qV(this._key,e)}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}},Jp=class{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return Fs(16)}async sign(e){return await UV(this._key,e)}get public(){if(this._publicKey==null)throw(0,Kx.default)(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new U2(this._publicKey)}decrypt(e){return zV(this._key,e)}marshal(){return lh.jwkToPkcs1(this._key)}get bytes(){return Ls.encode({Type:Fr.RSA,Data:this.marshal()})}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}async id(){let e=await this.public.hash();return M(e,"base58btc")}async export(e,t="pkcs-8"){if(t==="pkcs-8"){let r=new M2.default.util.ByteBuffer(this.marshal()),n=M2.default.asn1.fromDer(r),i=M2.default.pki.privateKeyFromAsn1(n),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return M2.default.pki.encryptRsaPrivateKey(i,e,s)}else{if(t==="libp2p-key")return await Zp(this.bytes,e);throw(0,Kx.default)(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function Vwe(e){let t=lh.pkcs1ToJwk(e),r=await Fx(t);return new Jp(r.privateKey,r.publicKey)}function qwe(e){let t=lh.pkixToJwk(e);return new U2(t)}async function zwe(e){let t=await Fx(e);return new Jp(t.privateKey,t.publicKey)}async function Hwe(e){let t=await MV(e);return new Jp(t.privateKey,t.publicKey)}var Qx={};ct(Qx,{Ed25519PrivateKey:()=>dh,Ed25519PublicKey:()=>q2,generateKeyPair:()=>i6e,generateKeyPairFromSeed:()=>Yx,unmarshalEd25519PrivateKey:()=>r6e,unmarshalEd25519PublicKey:()=>n6e}),c();var jx=w(K(),1);yr(),vr(),Hr(),va(),c(),c();var WV=w(rh(),1),An=BigInt(0),Nt=BigInt(1),Ti=BigInt(2),jV=BigInt(255),HV=Ti**BigInt(252)+BigInt("27742317777372353535851937790883648493"),Dr={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:Ti**jV-BigInt(19),l:HV,n:HV,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")},YV=Ti**BigInt(256),F2=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),jze=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),$we=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Gwe=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Wwe=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),jwe=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),kt=class{constructor(e,t,r,n){this.x=e,this.y=t,this.z=r,this.t=n}static fromAffine(e){if(!(e instanceof Kr))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Kr.ZERO)?kt.ZERO:new kt(e.x,e.y,Nt,X(e.x*e.y))}static toAffineBatch(e){let t=Xwe(e.map(r=>r.z));return e.map((r,n)=>r.toAffine(t[n]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){$V(e);let{x:t,y:r,z:n}=this,{x:i,y:s,z:a}=e,o=X(t*a),l=X(i*n),u=X(r*a),h=X(s*n);return o===l&&u===h}negate(){return new kt(X(-this.x),this.y,this.z,X(-this.t))}double(){let{x:e,y:t,z:r}=this,{a:n}=Dr,i=X(e**Ti),s=X(t**Ti),a=X(Ti*X(r**Ti)),o=X(n*i),l=X(X((e+t)**Ti)-i-s),u=o+s,h=u-a,f=o-s,y=X(l*h),p=X(u*f),v=X(l*f),d=X(h*u);return new kt(y,p,d,v)}add(e){$V(e);let{x:t,y:r,z:n,t:i}=this,{x:s,y:a,z:o,t:l}=e,u=X((r-t)*(a+s)),h=X((r+t)*(a-s)),f=X(h-u);if(f===An)return this.double();let y=X(n*Ti*l),p=X(i*Ti*o),v=p+y,d=h+u,g=p-y,b=X(v*f),_=X(d*g),m=X(v*g),E=X(f*d);return new kt(b,_,E,m)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let t=1+256/e,r=[],n=this,i=n;for(let s=0;s<t;s++){i=n,r.push(i);for(let a=1;a<2**(e-1);a++)i=i.add(n),r.push(i);n=i.double()}return r}wNAF(e,t){!t&&this.equals(kt.BASE)&&(t=Kr.BASE);let r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&$x.get(t);n||(n=this.precomputeWindow(r),t&&r!==1&&(n=kt.normalizeZ(n),$x.set(t,n)));let i=kt.ZERO,s=kt.ZERO,a=1+256/r,o=2**(r-1),l=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let f=0;f<a;f++){let y=f*o,p=Number(e&l);if(e>>=h,p>o&&(p-=u,e+=Nt),p===0){let v=n[y];f%2&&(v=v.negate()),s=s.add(v)}else{let v=n[y+Math.abs(p)-1];p<0&&(v=v.negate()),i=i.add(v)}}return kt.normalizeZ([i,s])[0]}multiply(e,t){return this.wNAF(a6(e,Dr.l),t)}multiplyUnsafe(e){let t=a6(e,Dr.l,!1),r=kt.BASE,n=kt.ZERO;if(t===An)return n;if(this.equals(n)||t===Nt)return this;if(this.equals(r))return this.wNAF(t);let i=n,s=this;for(;t>An;)t&Nt&&(i=i.add(s)),s=s.double(),t>>=Nt;return i}isSmallOrder(){return this.multiplyUnsafe(Dr.h).equals(kt.ZERO)}isTorsionFree(){return this.multiplyUnsafe(Dr.l).equals(kt.ZERO)}toAffine(e=c6(this.z)){let{x:t,y:r,z:n}=this,i=X(t*e),s=X(r*e);if(X(n*e)!==Nt)throw new Error("invZ was invalid");return new Kr(i,s)}fromRistrettoBytes(){zx()}toRistrettoBytes(){zx()}fromRistrettoHash(){zx()}};kt.BASE=new kt(Dr.Gx,Dr.Gy,Nt,X(Dr.Gx*Dr.Gy)),kt.ZERO=new kt(An,Nt,Nt,An);function $V(e){if(!(e instanceof kt))throw new TypeError("ExtendedPoint expected")}function qx(e){if(!(e instanceof Hi))throw new TypeError("RistrettoPoint expected")}function zx(){throw new Error("Legacy method: switch to RistrettoPoint")}var Hi=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:t}=Dr,r=X(F2*e*e),n=X((r+Nt)*Wwe),i=BigInt(-1),s=X((i-t*r)*X(r+t)),{isValid:a,value:o}=Wx(n,s),l=X(o*e);ll(l)||(l=X(-l)),a||(o=l),a||(i=r);let u=X(i*(r-Nt)*jwe-s),h=o*o,f=X((o+o)*s),y=X(u*$we),p=X(Nt-h),v=X(Nt+h);return new kt(X(f*v),X(p*y),X(y*v),X(f*p))}static hashToCurve(e){e=fl(e,64);let t=Hx(e.slice(0,32)),r=this.calcElligatorRistrettoMap(t),n=Hx(e.slice(32,64)),i=this.calcElligatorRistrettoMap(n);return new Hi(r.add(i))}static fromHex(e){e=fl(e,32);let{a:t,d:r}=Dr,n="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=Hx(e);if(!Jwe(K2(i),e)||ll(i))throw new Error(n);let s=X(i*i),a=X(Nt+t*s),o=X(Nt-t*s),l=X(a*a),u=X(o*o),h=X(t*r*l-u),{isValid:f,value:y}=GV(X(h*u)),p=X(y*o),v=X(y*p*h),d=X((i+i)*p);ll(d)&&(d=X(-d));let g=X(a*v),b=X(d*g);if(!f||ll(b)||g===An)throw new Error(n);return new Hi(new kt(d,g,Nt,b))}toRawBytes(){let{x:e,y:t,z:r,t:n}=this.ep,i=X(X(r+t)*X(r-t)),s=X(e*t),{value:a}=GV(X(i*s**Ti)),o=X(a*i),l=X(a*s),u=X(o*l*n),h;if(ll(n*u)){let y=X(t*F2),p=X(e*F2);e=y,t=p,h=X(o*Gwe)}else h=l;ll(e*u)&&(t=X(-t));let f=X((r-t)*h);return ll(f)&&(f=X(-f)),K2(f)}toHex(){return V2(this.toRawBytes())}toString(){return this.toHex()}equals(e){qx(e);let t=this.ep,r=e.ep,n=X(t.x*r.y)===X(t.y*r.x),i=X(t.y*r.y)===X(t.x*r.x);return n||i}add(e){return qx(e),new Hi(this.ep.add(e.ep))}subtract(e){return qx(e),new Hi(this.ep.subtract(e.ep))}multiply(e){return new Hi(this.ep.multiply(e))}multiplyUnsafe(e){return new Hi(this.ep.multiplyUnsafe(e))}};Hi.BASE=new Hi(kt.BASE),Hi.ZERO=new Hi(kt.ZERO);var $x=new WeakMap,Kr=class{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,$x.delete(this)}static fromHex(e,t=!0){let{d:r,P:n}=Dr;e=fl(e,32);let i=e.slice();i[31]=e[31]&-129;let s=e0(i);if(t&&s>=n)throw new Error("Expected 0 < hex < P");if(!t&&s>=YV)throw new Error("Expected 0 < hex < 2**256");let a=X(s*s),o=X(a-Nt),l=X(r*a+Nt),{isValid:u,value:h}=Wx(o,l);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let f=(h&Nt)===Nt;return(e[31]&128)!==0!==f&&(h=X(-h)),new Kr(h,s)}static async fromPrivateKey(e){return(await u6(e)).point}toRawBytes(){let e=K2(this.y);return e[31]|=this.x&Nt?128:0,e}toHex(){return V2(this.toRawBytes())}toX25519(){let{y:e}=this,t=X((Nt+e)*c6(Nt-e));return K2(t)}isTorsionFree(){return kt.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Kr(X(-this.x),this.y)}add(e){return kt.fromAffine(this).add(kt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return kt.fromAffine(this).multiply(e,this).toAffine()}};Kr.BASE=new Kr(Dr.Gx,Dr.Gy),Kr.ZERO=new Kr(An,Nt);var fh=class{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){let t=fl(e,64),r=Kr.fromHex(t.slice(0,32),!1),n=e0(t.slice(32,64));return new fh(r,n)}assertValidity(){let{r:e,s:t}=this;if(!(e instanceof Kr))throw new Error("Expected Point instance");return a6(t,Dr.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(K2(this.s),32),e}toHex(){return V2(this.toRawBytes())}};function Ywe(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var Qwe=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function V2(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=Qwe[e[r]];return t}function QV(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function XV(e){let t=e.toString(16).padStart(64,"0");return QV(t)}function K2(e){return XV(e).reverse()}function ll(e){return(X(e)&Nt)===Nt}function e0(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+V2(Uint8Array.from(e).reverse()))}function Hx(e){return X(e0(e)&Ti**jV-Nt)}function X(e,t=Dr.P){let r=e%t;return r>=An?r:t+r}function c6(e,t=Dr.P){if(e===An||t<=An)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=X(e,t),n=t,i=An,s=Nt,a=Nt,o=An;for(;r!==An;){let l=n/r,u=n%r,h=i-a*l,f=s-o*l;n=r,r=u,i=a,s=o,a=h,o=f}if(n!==Nt)throw new Error("invert: does not exist");return X(i,t)}function Xwe(e,t=Dr.P){let r=new Array(e.length),n=e.reduce((s,a,o)=>a===An?s:(r[o]=s,X(s*a,t)),Nt),i=c6(n,t);return e.reduceRight((s,a,o)=>a===An?s:(r[o]=X(s*r[o],t),X(s*a,t)),i),r}function Na(e,t){let{P:r}=Dr,n=e;for(;t-- >An;)n*=n,n%=r;return n}function Zwe(e){let{P:t}=Dr,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),a=BigInt(80),o=e*e%t*e%t,l=Na(o,Ti)*o%t,u=Na(l,Nt)*e%t,h=Na(u,r)*u%t,f=Na(h,n)*h%t,y=Na(f,i)*f%t,p=Na(y,s)*y%t,v=Na(p,a)*p%t,d=Na(v,a)*p%t,g=Na(d,n)*h%t;return{pow_p_5_8:Na(g,Ti)*e%t,b2:o}}function Wx(e,t){let r=X(t*t*t),n=X(r*r*t),i=Zwe(e*n).pow_p_5_8,s=X(e*r*i),a=X(t*s*s),o=s,l=X(s*F2),u=a===e,h=a===X(-e),f=a===X(-e*F2);return u&&(s=o),(h||f)&&(s=l),ll(s)&&(s=X(-s)),{isValid:u||h,value:s}}function GV(e){return Wx(Nt,e)}async function Gx(...e){let t=await hh.sha512(Ywe(...e)),r=e0(t);return X(r,Dr.l)}function Jwe(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function fl(e,t){let r=e instanceof Uint8Array?Uint8Array.from(e):QV(e);if(typeof t=="number"&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function a6(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if(typeof e=="number"&&Number.isSafeInteger(e)&&(e=BigInt(e)),typeof e=="bigint"&&e<t){if(r){if(An<e)return e}else if(An<=e)return e}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function e6e(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}async function u6(e){if(e=typeof e=="bigint"||typeof e=="number"?XV(a6(e,YV)):fl(e),e.length!==32)throw new Error("Expected 32 bytes");let t=await hh.sha512(e),r=e6e(t.slice(0,32)),n=t.slice(32,64),i=X(e0(r),Dr.l),s=Kr.BASE.multiply(i),a=s.toRawBytes();return{head:r,prefix:n,scalar:i,point:s,pointBytes:a}}async function t0(e){return(await u6(e)).pointBytes}async function l6(e,t){e=fl(e);let{prefix:r,scalar:n,pointBytes:i}=await u6(t),s=await Gx(r,e),a=Kr.BASE.multiply(s),o=await Gx(a.toRawBytes(),i,e),l=X(s+o*n,Dr.l);return new fh(a,l).toRawBytes()}async function f6(e,t,r){t=fl(t),r instanceof Kr||(r=Kr.fromHex(r,!1));let{r:n,s:i}=e instanceof fh?e.assertValidity():fh.fromHex(e),s=kt.BASE.multiplyUnsafe(i),a=await Gx(n.toRawBytes(),r.toRawBytes(),t),o=kt.fromAffine(r).multiplyUnsafe(a);return kt.fromAffine(n).add(o).subtract(s).multiplyUnsafe(Dr.h).equals(kt.ZERO)}Kr.BASE._setWindowSize(8);var ul={node:WV.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},hh={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:V2,getExtendedPublicKey:u6,mod:X,invert:c6,hashToPrivateScalar:e=>{if(e=fl(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let t=X(e0(e),Dr.l);if(t===An||t===Nt)throw new Error("Invalid private key");return t},randomBytes:(e=32)=>{if(ul.web)return ul.web.getRandomValues(new Uint8Array(e));if(ul.node){let{randomBytes:t}=ul.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>hh.randomBytes(32),sha512:async e=>{if(ul.web){let t=await ul.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(t)}else{if(ul.node)return Uint8Array.from(ul.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=Kr.BASE){let r=t.equals(Kr.BASE)?t:new Kr(t.x,t.y);return r._setWindowSize(e),r.multiply(Ti),r}},r0=32,Lc=64,h6=32;async function JV(){let e=hh.randomPrivateKey(),t=await t0(e);return{privateKey:nq(e,t),publicKey:t}}async function eq(e){if(e.length!==h6)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await t0(t);return{privateKey:nq(t,r),publicKey:r}}async function tq(e,t){let r=e.slice(0,h6);return await l6(t,r)}async function rq(e,t,r){return await f6(t,r,e)}function nq(e,t){let r=new Uint8Array(Lc);for(let n=0;n<h6;n++)r[n]=e[n],r[h6+n]=t[n];return r}var q2=class{constructor(e){this._key=n0(e,r0)}async verify(e,t){return await rq(this._key,t,e)}marshal(){return this._key}get bytes(){return Os.encode({Type:Fr.Ed25519,Data:this.marshal()})}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}},dh=class{constructor(e,t){this._key=n0(e,Lc),this._publicKey=n0(t,r0)}async sign(e){return await tq(this._key,e)}get public(){return new q2(this._publicKey)}marshal(){return this._key}get bytes(){return Ls.encode({Type:Fr.Ed25519,Data:this.marshal()})}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}async id(){let e=await $r.digest(this.public.bytes);return Ne.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if(t==="libp2p-key")return await Zp(this.bytes,e);throw(0,jx.default)(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function r6e(e){if(e.length>Lc){e=n0(e,Lc+r0);let n=e.slice(0,Lc),i=e.slice(Lc,e.length);return new dh(n,i)}e=n0(e,Lc);let t=e.slice(0,Lc),r=e.slice(r0);return new dh(t,r)}function n6e(e){return e=n0(e,r0),new q2(e)}async function i6e(){let{privateKey:e,publicKey:t}=await JV();return new dh(e,t)}async function Yx(e){let{privateKey:t,publicKey:r}=await eq(e);return new dh(t,r)}function n0(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw(0,jx.default)(new Error(`Key must be a Uint8Array of length ${t}, got ${e.length}`),"ERR_INVALID_KEY_TYPE");return e}var nR={};ct(nR,{Secp256k1PrivateKey:()=>j2,Secp256k1PublicKey:()=>W2,generateKeyPair:()=>b6e,unmarshalSecp256k1PrivateKey:()=>w6e,unmarshalSecp256k1PublicKey:()=>E6e}),c(),vr();var _q=w(K(),1);yr(),me(),c();var c0=w(K(),1);c();var o6e=w(rh(),1),Ot=BigInt(0),wr=BigInt(1),cn=BigInt(2),H2=BigInt(3),s6e=BigInt(8),Jx=cn**BigInt(256),xr={a:Ot,b:BigInt(7),P:Jx-cn**BigInt(32)-BigInt(977),n:Jx-BigInt("432420386565659656852420866394968145599"),h:wr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};function iq(e){let{a:t,b:r}=xr,n=pe(e*e),i=pe(n*e);return pe(i+t*e+r)}var d6=xr.a===Ot,qt=class{constructor(e,t,r){this.x=e,this.y=t,this.z=r}static fromAffine(e){if(!(e instanceof Tt))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new qt(e.x,e.y,wr)}static toAffineBatch(e){let t=l6e(e.map(r=>r.z));return e.map((r,n)=>r.toAffine(t[n]))}static normalizeZ(e){return qt.toAffineBatch(e).map(qt.fromAffine)}equals(e){if(!(e instanceof qt))throw new TypeError("JacobianPoint expected");let{x:t,y:r,z:n}=this,{x:i,y:s,z:a}=e,o=pe(n**cn),l=pe(a**cn),u=pe(t*l),h=pe(i*o),f=pe(pe(r*a)*l),y=pe(pe(s*n)*o);return u===h&&f===y}negate(){return new qt(this.x,pe(-this.y),this.z)}double(){let{x:e,y:t,z:r}=this,n=pe(e**cn),i=pe(t**cn),s=pe(i**cn),a=pe(cn*(pe((e+i)**cn)-n-s)),o=pe(H2*n),l=pe(o**cn),u=pe(l-cn*a),h=pe(o*(a-u)-s6e*s),f=pe(cn*t*r);return new qt(u,h,f)}add(e){if(!(e instanceof qt))throw new TypeError("JacobianPoint expected");let{x:t,y:r,z:n}=this,{x:i,y:s,z:a}=e;if(i===Ot||s===Ot)return this;if(t===Ot||r===Ot)return e;let o=pe(n**cn),l=pe(a**cn),u=pe(t*l),h=pe(i*o),f=pe(pe(r*a)*l),y=pe(pe(s*n)*o),p=pe(h-u),v=pe(y-f);if(p===Ot)return v===Ot?this.double():qt.ZERO;let d=pe(p**cn),g=pe(p*d),b=pe(u*d),_=pe(v**cn-g-cn*b),m=pe(v*(b-_)-f*g),E=pe(n*a*p);return new qt(_,m,E)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let t=aq(e),r=qt.BASE,n=qt.ZERO;if(t===Ot)return n;if(t===wr)return this;if(!d6){let f=n,y=this;for(;t>Ot;)t&wr&&(f=f.add(y)),y=y.double(),t>>=wr;return f}let{k1neg:i,k1:s,k2neg:a,k2:o}=uq(t),l=n,u=n,h=this;for(;s>Ot||o>Ot;)s&wr&&(l=l.add(h)),o&wr&&(u=u.add(h)),h=h.double(),s>>=wr,o>>=wr;return i&&(l=l.negate()),a&&(u=u.negate()),u=new qt(pe(u.x*xr.beta),u.y,u.z),l.add(u)}precomputeWindow(e){let t=d6?128/e+1:256/e+1,r=[],n=this,i=n;for(let s=0;s<t;s++){i=n,r.push(i);for(let a=1;a<2**(e-1);a++)i=i.add(n),r.push(i);n=i.double()}return r}wNAF(e,t){!t&&this.equals(qt.BASE)&&(t=Tt.BASE);let r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&eR.get(t);n||(n=this.precomputeWindow(r),t&&r!==1&&(n=qt.normalizeZ(n),eR.set(t,n)));let i=qt.ZERO,s=qt.ZERO,a=1+(d6?128/r:256/r),o=2**(r-1),l=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let f=0;f<a;f++){let y=f*o,p=Number(e&l);if(e>>=h,p>o&&(p-=u,e+=wr),p===0){let v=n[y];f%2&&(v=v.negate()),s=s.add(v)}else{let v=n[y+Math.abs(p)-1];p<0&&(v=v.negate()),i=i.add(v)}}return{p:i,f:s}}multiply(e,t){let r=aq(e),n,i;if(d6){let{k1neg:s,k1:a,k2neg:o,k2:l}=uq(r),{p:u,f:h}=this.wNAF(a,t),{p:f,f:y}=this.wNAF(l,t);s&&(u=u.negate()),o&&(f=f.negate()),f=new qt(pe(f.x*xr.beta),f.y,f.z),n=u.add(f),i=h.add(y)}else{let{p:s,f:a}=this.wNAF(r,t);n=s,i=a}return qt.normalizeZ([n,i])[0]}toAffine(e=s0(this.z)){let{x:t,y:r,z:n}=this,i=e,s=pe(i*i),a=pe(s*i),o=pe(t*s),l=pe(r*a);if(pe(n*i)!==wr)throw new Error("invZ was invalid");return new Tt(o,l)}};qt.BASE=new qt(xr.Gx,xr.Gy,wr),qt.ZERO=new qt(Ot,wr,Ot);var eR=new WeakMap,Tt=class{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,eR.delete(this)}static fromCompressedHex(e){let t=e.length===32,r=Qo(t?e:e.subarray(1));if(!Zx(r))throw new Error("Point is not on curve");let n=iq(r),i=u6e(n),s=(i&wr)===wr;t?s&&(i=pe(-i)):(e[0]&1)===1!==s&&(i=pe(-i));let a=new Tt(r,i);return a.assertValidity(),a}static fromUncompressedHex(e){let t=Qo(e.subarray(1,33)),r=Qo(e.subarray(33,65)),n=new Tt(t,r);return n.assertValidity(),n}static fromHex(e){let t=Bc(e),r=t.length,n=t[0];if(r===32||r===33&&(n===2||n===3))return this.fromCompressedHex(t);if(r===65&&n===4)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r}`)}static fromPrivateKey(e){return Tt.BASE.multiply($2(e))}static fromSignature(e,t,r){e=Bc(e);let n=lq(e),{r:i,s}=fq(t);if(r!==0&&r!==1)throw new Error("Cannot recover signature: invalid recovery bit");if(n===Ot)throw new Error("Cannot recover signature: msgHash cannot be 0");let a=r&1?"03":"02",o=Tt.fromHex(a+ph(i)),{n:l}=xr,u=s0(i,l),h=pe(-n*u,l),f=pe(s*u,l),y=Tt.BASE.multiplyAndAddUnsafe(o,h,f);if(!y)throw new Error("Cannot recover signature: point at infinify");return y.assertValidity(),y}toRawBytes(e=!1){return hl(this.toHex(e))}toHex(e=!1){let t=ph(this.x);return e?`${this.y&wr?"03":"02"}${t}`:`04${t}${ph(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:t,y:r}=this;if(!Zx(t)||!Zx(r))throw new Error(e);let n=pe(r*r),i=iq(t);if(pe(n-i)!==Ot)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Tt(this.x,pe(-this.y))}double(){return qt.fromAffine(this).double().toAffine()}add(e){return qt.fromAffine(this).add(qt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return qt.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,r){let n=qt.fromAffine(this),i=t===Ot||t===wr||this!==Tt.BASE?n.multiplyUnsafe(t):n.multiply(t),s=qt.fromAffine(e).multiplyUnsafe(r),a=i.add(s);return a.equals(qt.ZERO)?void 0:a.toAffine()}};Tt.BASE=new Tt(xr.Gx,xr.Gy),Tt.ZERO=new Tt(Ot,Ot);function oq(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function sq(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${o0(e)}`);let t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Qo(r),left:e.subarray(t+2)}}function a6e(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${o0(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");let{data:t,left:r}=sq(e.subarray(2)),{data:n,left:i}=sq(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${o0(i)}`);return{r:t,s:n}}var Oa=class{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){let t=y6(e),r="Signature.fromCompact";if(typeof e!="string"&&!t)throw new TypeError(`${r}: Expected string or Uint8Array`);let n=t?o0(e):e;if(n.length!==128)throw new Error(`${r}: Expected 64-byte hex`);return new Oa(g6(n.slice(0,64)),g6(n.slice(64,128)))}static fromDER(e){let t=y6(e);if(typeof e!="string"&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r,s:n}=a6e(t?e:hl(e));return new Oa(r,n)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:t}=this;if(!G2(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!G2(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=xr.n>>wr;return this.s>e}normalizeS(){return this.hasHighS()?new Oa(this.r,xr.n-this.s):this}toDERRawBytes(e=!1){return hl(this.toDERHex(e))}toDERHex(e=!1){let t=oq(z2(this.s));if(e)return t;let r=oq(z2(this.r)),n=z2(r.length/2),i=z2(t.length/2);return`30${z2(r.length/2+t.length/2+4)}02${n}${r}02${i}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return hl(this.toCompactHex())}toCompactHex(){return ph(this.r)+ph(this.s)}};function i0(...e){if(!e.every(y6))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}function y6(e){return e instanceof Uint8Array}var c6e=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function o0(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=c6e[e[r]];return t}function ph(e){if(e>Jx)throw new Error("Expected number < 2^256");return e.toString(16).padStart(64,"0")}function Xx(e){return hl(ph(e))}function z2(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function g6(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function hl(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function Qo(e){return g6(o0(e))}function Bc(e){return e instanceof Uint8Array?Uint8Array.from(e):hl(e)}function aq(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&G2(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function pe(e,t=xr.P){let r=e%t;return r>=Ot?r:t+r}function Yo(e,t){let{P:r}=xr,n=e;for(;t-- >Ot;)n*=n,n%=r;return n}function u6e(e){let{P:t}=xr,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),o=BigInt(88),l=e*e*e%t,u=l*l*e%t,h=Yo(u,H2)*u%t,f=Yo(h,H2)*u%t,y=Yo(f,cn)*l%t,p=Yo(y,n)*y%t,v=Yo(p,i)*p%t,d=Yo(v,a)*v%t,g=Yo(d,o)*d%t,b=Yo(g,a)*v%t,_=Yo(b,H2)*u%t,m=Yo(_,s)*p%t,E=Yo(m,r)*l%t;return Yo(E,cn)}function s0(e,t=xr.P){if(e===Ot||t<=Ot)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=pe(e,t),n=t,i=Ot,s=wr,a=wr,o=Ot;for(;r!==Ot;){let l=n/r,u=n%r,h=i-a*l,f=s-o*l;n=r,r=u,i=a,s=o,a=h,o=f}if(n!==wr)throw new Error("invert: does not exist");return pe(i,t)}function l6e(e,t=xr.P){let r=new Array(e.length),n=e.reduce((s,a,o)=>a===Ot?s:(r[o]=s,pe(s*a,t)),wr),i=s0(n,t);return e.reduceRight((s,a,o)=>a===Ot?s:(r[o]=pe(s*r[o],t),pe(s*a,t)),i),r}var cq=(e,t)=>(e+t/cn)/t,p6=cn**BigInt(128);function uq(e){let{n:t}=xr,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-wr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=cq(s*e,t),o=cq(-n*e,t),l=pe(e-a*r-o*i,t),u=pe(-a*n-o*s,t),h=l>p6,f=u>p6;if(h&&(l=t-l),f&&(u=t-u),l>p6||u>p6)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:h,k1:l,k2neg:f,k2:u}}function lq(e){let{n:t}=xr,r=e.length*8-256,n=Qo(e);return r>0&&(n=n>>BigInt(r)),n>=t&&(n-=t),n}var tR=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return Ii.hmacSha256(this.k,...e)}hmacSync(...e){if(typeof Ii.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let t=Ii.hmacSha256Sync(this.k,...e);if(t instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return t}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function G2(e){return Ot<e&&e<xr.n}function Zx(e){return Ot<e&&e<xr.P}function f6e(e,t,r){let n=Qo(e);if(!G2(n))return;let{n:i}=xr,s=Tt.BASE.multiply(n),a=pe(s.x,i);if(a===Ot)return;let o=pe(s0(n,i)*pe(t+r*a,i),i);if(o===Ot)return;let l=new Oa(a,o),u=(s.x===l.r?0:2)|Number(s.y&wr);return{sig:l,recovery:u}}function $2(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==64)throw new Error("Expected 32 bytes of private key");t=g6(e)}else if(y6(e)){if(e.length!==32)throw new Error("Expected 32 bytes of private key");t=Qo(e)}else throw new TypeError("Expected valid private key");if(!G2(t))throw new Error("Expected private key: 0 < key < n");return t}function h6e(e){return e instanceof Tt?(e.assertValidity(),e):Tt.fromHex(e)}function fq(e){if(e instanceof Oa)return e.assertValidity(),e;try{return Oa.fromDER(e)}catch{return Oa.fromCompact(e)}}function a0(e,t=!1){return Tt.fromPrivateKey(e).toRawBytes(t)}function hq(e){let t=e.length>32?e.slice(0,32):e;return Qo(t)}function d6e(e){let t=hq(e),r=pe(t,xr.n);return dq(r<Ot?t:r)}function dq(e){if(typeof e!="bigint")throw new Error("Expected bigint");let t=ph(e);return hl(t)}function p6e(e,t,r){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);let n=Bc(e),i=$2(t),s=[dq(i),d6e(n)];if(r!=null){r===!0&&(r=Ii.randomBytes(32));let l=Bc(r);if(l.length!==32)throw new Error("sign: Expected 32 bytes of extra data");s.push(l)}let a=i0(...s),o=hq(n);return{seed:a,m:o,d:i}}function m6e(e,t){let{sig:r,recovery:n}=e,{canonical:i,der:s,recovered:a}=Object.assign({canonical:!0,der:!0},t);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let o=s?r.toDERRawBytes():r.toCompactRawBytes();return a?[o,n]:o}async function w6(e,t,r={}){let{seed:n,m:i,d:s}=p6e(e,t,r.extraEntropy),a,o=new tR;for(await o.reseed(n);!(a=f6e(await o.generate(),i,s));)await o.reseed();return m6e(a,r)}var y6e={strict:!0};function E6(e,t,r,n=y6e){let i;try{i=fq(e),t=Bc(t)}catch{return!1}let{r:s,s:a}=i;if(n.strict&&i.hasHighS())return!1;let o=lq(t);if(o===Ot)return!1;let l;try{l=h6e(r)}catch{return!1}let{n:u}=xr,h=s0(a,u),f=pe(o*h,u),y=pe(s*h,u),p=Tt.BASE.multiplyAndAddUnsafe(l,f,y);return p?pe(p.x,u)===s:!1}Tt.BASE._setWindowSize(8);var fo={node:o6e,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},m6={},Ii={isValidPrivateKey(e){try{return $2(e),!0}catch{return!1}},privateAdd:(e,t)=>{let r=$2(e),n=Qo(Bc(t));return Xx(pe(r+n,xr.n))},privateNegate:e=>{let t=$2(e);return Xx(xr.n-t)},pointAddScalar:(e,t,r)=>{let n=Tt.fromHex(e),i=Qo(Bc(t)),s=Tt.BASE.multiplyAndAddUnsafe(n,i,wr);if(!s)throw new Error("Tweaked point at infinity");return s.toRawBytes(r)},pointMultiply:(e,t,r)=>{let n=Tt.fromHex(e),i=Qo(Bc(t));return n.multiply(i).toRawBytes(r)},hashToPrivateKey:e=>{if(e=Bc(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let t=pe(Qo(e),xr.n-wr)+wr;return Xx(t)},randomBytes:(e=32)=>{if(fo.web)return fo.web.getRandomValues(new Uint8Array(e));if(fo.node){let{randomBytes:t}=fo.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ii.hashToPrivateKey(Ii.randomBytes(40)),bytesToHex:o0,hexToBytes:hl,concatBytes:i0,mod:pe,invert:s0,sha256:async(...e)=>{if(fo.web){let t=await fo.web.subtle.digest("SHA-256",i0(...e));return new Uint8Array(t)}else if(fo.node){let{createHash:t}=fo.node,r=t("sha256");return e.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(fo.web){let r=await fo.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=i0(...t),i=await fo.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(fo.node){let{createHmac:r}=fo.node,n=r("sha256",e);return t.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=m6[e];if(r===void 0){let n=await Ii.sha256(Uint8Array.from(e,i=>i.charCodeAt(0)));r=i0(n,n),m6[e]=r}return Ii.sha256(r,...t)},taggedHashSync:(e,...t)=>{if(typeof Ii.sha256Sync!="function")throw new Error("utils.sha256Sync is undefined, you need to set it");let r=m6[e];if(r===void 0){let n=Ii.sha256Sync(Uint8Array.from(e,i=>i.charCodeAt(0)));r=i0(n,n),m6[e]=r}return Ii.sha256Sync(r,...t)},precompute(e=8,t=Tt.BASE){let r=t===Tt.BASE?t:new Tt(t.x,t.y);return r._setWindowSize(e),r.multiply(H2),r}};vr();function mq(){return Ii.randomPrivateKey()}async function yq(e,t){let{digest:r}=await xe.digest(t);try{return await w6(r,e)}catch(n){throw(0,c0.default)(n,"ERR_INVALID_INPUT")}}async function gq(e,t,r){try{let{digest:n}=await xe.digest(r);return E6(t,n,e)}catch(n){throw(0,c0.default)(n,"ERR_INVALID_INPUT")}}function wq(e){return Tt.fromHex(e).toRawBytes(!0)}function Eq(e){try{a0(e,!0)}catch(t){throw(0,c0.default)(t,"ERR_INVALID_PRIVATE_KEY")}}function rR(e){try{Tt.fromHex(e)}catch(t){throw(0,c0.default)(t,"ERR_INVALID_PUBLIC_KEY")}}function bq(e){try{return a0(e,!0)}catch(t){throw(0,c0.default)(t,"ERR_INVALID_PRIVATE_KEY")}}var W2=class{constructor(e){rR(e),this._key=e}async verify(e,t){return await gq(this._key,t,e)}marshal(){return wq(this._key)}get bytes(){return Os.encode({Type:Fr.Secp256k1,Data:this.marshal()})}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}},j2=class{constructor(e,t){this._key=e,this._publicKey=t??bq(e),Eq(this._key),rR(this._publicKey)}async sign(e){return await yq(this._key,e)}get public(){return new W2(this._publicKey)}marshal(){return this._key}get bytes(){return Ls.encode({Type:Fr.Secp256k1,Data:this.marshal()})}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}async id(){let e=await this.public.hash();return M(e,"base58btc")}async export(e,t="libp2p-key"){if(t==="libp2p-key")return await Zp(this.bytes,e);throw(0,_q.default)(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function w6e(e){return new j2(e)}function E6e(e){return new W2(e)}async function b6e(){let e=await mq();return new j2(e)}var La={rsa:Vx,ed25519:Qx,secp256k1:nR};function iR(e){let t=Object.keys(La).join(" / ");return(0,_6.default)(new Error(`invalid or unsupported key type ${e}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}function oR(e){if(e=e.toLowerCase(),e==="rsa"||e==="ed25519"||e==="secp256k1")return La[e];throw iR(e)}async function sR(e,t){return await oR(e).generateKeyPair(t??2048)}async function _6e(e,t,r){if(e.toLowerCase()!=="ed25519")throw(0,_6.default)(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return await Yx(t)}function ho(e){let t=Os.decode(e),r=t.Data;switch(t.Type){case Fr.RSA:return La.rsa.unmarshalRsaPublicKey(r);case Fr.Ed25519:return La.ed25519.unmarshalEd25519PublicKey(r);case Fr.Secp256k1:return La.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw iR(t.Type)}}function v6e(e,t){return t=(t??"rsa").toLowerCase(),oR(t),e.bytes}async function Jn(e){let t=Ls.decode(e),r=t.Data;switch(t.Type){case Fr.RSA:return await La.rsa.unmarshalRsaPrivateKey(r);case Fr.Ed25519:return La.ed25519.unmarshalEd25519PrivateKey(r);case Fr.Secp256k1:return La.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw iR(t.Type)}}function S6e(e,t){return t=(t??"rsa").toLowerCase(),oR(t),e.bytes}async function Mc(e,t){try{let i=await RV(e,t);return await Jn(i)}catch{}let r=b6.default.pki.decryptRsaPrivateKey(e,t);if(r===null)throw(0,_6.default)(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=b6.default.asn1.toDer(b6.default.pki.privateKeyToAsn1(r));return n=U(n.getBytes(),"ascii"),await La.rsa.unmarshalRsaPrivateKey(n)}var fR=w(K(),1);si(),Re(),c();var u0=w(K(),1);c();var vq="ERR_IPNS_EXPIRED_RECORD",Y2="ERR_UNRECOGNIZED_VALIDITY",Sq="ERR_SIGNATURE_CREATION",mh="ERR_SIGNATURE_VERIFICATION",xq="ERR_UNRECOGNIZED_FORMAT",aR="ERR_UNDEFINED_PARAMETER",Rq="ERR_INVALID_RECORD_DATA",Aq="ERR_INVALID_EMBEDDED_KEY",Tq="ERR_MISSING_PRIVATE_KEY";c();var $i;(function(e){let t;(function(n){n.EOL="EOL"})(t=e.ValidityType||(e.ValidityType={}));let r;(function(n){n[n.EOL=0]="EOL"})(r||(r={})),function(n){n.codec=()=>xi(r)}(t=e.ValidityType||(e.ValidityType={})),e.codec=()=>Xe({1:{name:"value",codec:ye,optional:!0},2:{name:"signature",codec:ye,optional:!0},3:{name:"validityType",codec:e.ValidityType.codec(),optional:!0},4:{name:"validity",codec:ye,optional:!0},5:{name:"sequence",codec:nl,optional:!0},6:{name:"ttl",codec:nl,optional:!0},7:{name:"pubKey",codec:ye,optional:!0},8:{name:"signatureV2",codec:ye,optional:!0},9:{name:"data",codec:ye,optional:!0}}),e.encode=n=>Qe(n,e.codec()),e.decode=n=>Ye(n,e.codec())})($i||($i={})),Re(),ur(),Vf();var Iq=C("ipns:utils"),Cq=U("/ipns/");function Q2(e){let t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(r==null)throw new Error("Invalid format");let n=parseInt(r[1],10),i=parseInt(r[2],10)-1,s=parseInt(r[3],10),a=parseInt(r[4],10),o=parseInt(r[5],10),l=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,i,s,a,o,l,u))}var Pq=async(e,t)=>{if(t==null||e==null){let n=new Error("one or more of the provided parameters are not defined");throw Iq.error(n),(0,u0.default)(n,aR)}let r;if(t.pubKey!=null){try{r=ho(t.pubKey)}catch(n){throw Iq.error(n),n}if(!(await sn(t.pubKey)).equals(e))throw(0,u0.default)(new Error("Embedded public key did not match PeerID"),Aq)}else e.publicKey!=null&&(r=ho(e.publicKey));if(r!=null)return r;throw(0,u0.default)(new Error("no public key is available"),aR)},S6=(e,t,r)=>{let n=U(t);return Ae([e,r,n])},x6=e=>{let t=U("ipns-signature:");return Ae([t,e])},uR=e=>$i.encode(e),Uc=e=>{let t=$i.decode(e);return{value:t.value??new Uint8Array(0),signature:t.signature??new Uint8Array(0),validityType:t.validityType??$i.ValidityType.EOL,validity:t.validity??new Uint8Array(0),sequence:t.sequence??0n,pubKey:t.pubKey,ttl:t.ttl??void 0,signatureV2:t.signatureV2,data:t.data}},dl=e=>Ae([Cq,e.toBytes()]),lR=e=>Ir(e.slice(Cq.length)),Dq=(e,t,r,n,i)=>{let s;if(r===$i.ValidityType.EOL)s=0;else throw(0,u0.default)(new Error("Unknown validity type"),Y2);return ao({Value:e,Validity:t,ValidityType:s,Sequence:n,TTL:i})},kq=e=>{let t=Mn(e);if(t.ValidityType===0)t.ValidityType=$i.ValidityType.EOL;else throw(0,u0.default)(new Error("Unknown validity type"),Y2);return Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t};yr(),On(),va();var Oq=C("ipns"),x6e=$r.code,X2="/ipns/",R6=X2.length,Lq=async(e,t,r,n)=>{let i=new Nq.default(Date.now()+Number(n)),s=$i.ValidityType.EOL,[a,o]=n.toString().split("."),l=BigInt(a)*BigInt(1e5)+BigInt(o??"0");return await R6e(e,t,r,s,i,l)},R6e=async(e,t,r,n,i,s)=>{r=BigInt(r);let a=U(i.toString());if(e.privateKey==null)throw(0,fR.default)(new Error("Missing private key"),Tq);let o=await Jn(e.privateKey),l=await T6e(o,t,n,a),u=Dq(t,a,n,r,s),h=x6(u),f=await o.sign(h),y={value:t,signature:l,validityType:n,validity:a,sequence:r,ttl:s,signatureV2:f,data:u};if(e.publicKey!=null){let p=_r(e.toBytes());(p.code!==x6e||!Ce(e.publicKey,p.digest))&&(y.pubKey=e.publicKey)}return Oq("ipns entry for %b created",t),y},A6e=e=>e9.encode(e).slice(1),Z2=e=>new ae(`/ipns/${A6e(e)}`),T6e=async(e,t,r,n)=>{try{let i=S6(t,r,n);return await e.sign(i)}catch(i){throw Oq.error("record signature creation failed",i),(0,fR.default)(new Error("record signature creation failed"),Sq)}},Xo=C("ipfs:ipns:publisher"),Bq=Rn().code,Mq=60*60*1e3,yh=class{constructor(e,t){this._routing=e,this._datastore=t}async publishWithEOL(e,t,r){let n=await this._updateOrCreateRecord(e,t,r);return this._putRecordToRouting(n,e)}publish(e,t){return this.publishWithEOL(e,t,Mq)}async _putRecordToRouting(e,t){if(!Go(t)){let n="peerId received is not valid";throw Xo.error(n),(0,Zo.default)(new Error(n),"ERR_INVALID_PEER_ID")}if(t.publicKey==null)throw(0,Zo.default)(new Error("Public key was missing"),"ERR_MISSING_PUBLIC_KEY");let r=dl(t);return await this._publishEntry(r,e),e}async _publishEntry(e,t){try{let r=await this._routing.put(e,t);return Xo(`ipns record for ${M(e,"base32")} was stored in the routing`),r}catch(r){let n=`ipns record for ${M(e,"base32")} could not be stored in the routing - ${r.stack}`;throw Xo.error(n),Xo.error(r),(0,Zo.default)(new Error(n),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,t={}){if(!Go(e)){let n="peerId received is not valid";throw Xo.error(n),(0,Zo.default)(new Error(n),"ERR_INVALID_PEER_ID")}let r=t.checkRouting!==!1;try{let n=await this._datastore.get(Z2(e.toBytes()));return this._unmarshalData(n)}catch(n){if(n.code!==Bq){let i=`unexpected error getting the ipns record ${e.toString()} from datastore`;throw Xo.error(i),(0,Zo.default)(new Error(i),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!r)throw(0,Zo.default)(n,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let i=dl(e),s=await this._routing.get(i);return this._unmarshalData(s)}catch(i){throw Xo.error(i),i}}}_unmarshalData(e){try{return Uc(e)}catch(t){throw(0,Zo.default)(t,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,t,r){if(!Go(e)){let o="peerId received is not valid";throw Xo.error(o),(0,Zo.default)(new Error(o),"ERR_INVALID_PEER_ID")}let n={checkRouting:!0},i;try{i=await this._getPublished(e,n)}catch(o){if(o.code!==Bq){let l=`unexpected error when determining the last published IPNS record for ${e.toString()} ${o.stack}`;throw Xo.error(l),(0,Zo.default)(new Error(l),"ERR_DETERMINING_PUBLISHED_RECORD")}}let s=0n;i&&i.sequence!==void 0&&(s=Ce(i.value,t)?i.sequence:i.sequence+BigInt(1));let a;try{a=await Lq(e,t,s,r)}catch(o){let l=`ipns record for ${t} could not be created`;throw Xo.error(o),(0,Zo.default)(new Error(l),"ERR_CREATING_IPNS_RECORD")}try{let o=uR(a);return await this._datastore.put(Z2(e.toBytes()),o),Xo(`ipns record for ${M(t,"base32")} was stored in the datastore`),o}catch{let o=`ipns record for ${t} could not be stored in the datastore`;throw Xo.error(o),(0,Zo.default)(new Error(o),"ERR_STORING_IN_DATASTORE")}}};yh.defaultRecordLifetime=Mq,c();var gh=w(K(),1),A6=C("ipfs:ipns:republisher"),Uq=60*1e3,Fq=60*Uq,I6e=4*Fq,C6e=24*Fq,T6=class{constructor(e,t,r,n,i={pass:""}){this._publisher=e,this._datastore=t,this._peerId=r,this._keychain=n,this._options=i,this._republishHandle=null}async start(){if(this._republishHandle)throw(0,gh.default)(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:n=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(n)}catch(i){A6.error(i)}},n())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{pass:t}=this._options,r=!0;e._task=()=>this._republishEntries(this._peerId,t),e.runPeriodically(()=>r?(r=!1,this._options.initialBroadcastInterval||Uq):this._options.broadcastInterval||I6e),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw(0,gh.default)(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,t){try{await this._republishEntry(e)}catch{let r="cannot republish entry for the node's private key";A6.error(r);return}if(t)try{let r=await this._keychain.listKeys();for(let n of r){if(n.name==="self")continue;let i=await this._keychain.exportKey(n.name,t),s=await Mc(i,t),a=await sn(s.public.bytes,s.bytes);await this._republishEntry(a)}}catch(r){A6.error(r)}}async _republishEntry(e){try{let t=await this._getPreviousValue(e);await this._publisher.publishWithEOL(e,t,C6e)}catch(t){if(t.code==="ERR_NO_ENTRY_FOUND")return;throw t}}async _getPreviousValue(e){if(!Go(e))throw(0,gh.default)(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let t=await this._datastore.get(Z2(e.toBytes()));if(!(t instanceof Uint8Array))throw(0,gh.default)(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return Uc(t).value}catch(r){throw A6.error(r),(0,gh.default)(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(t){throw t&&t.notFound?(0,gh.default)(new Error(`no previous entry for record with id: ${e.toString()}`),"ERR_NO_ENTRY_FOUND"):t}}};c();var f0=w(K(),1);me(),Re(),ur(),c();var Ks=w(K(),1);me(),yr();var J2=C("ipns:validator"),P6e=async(e,t)=>{let{value:r,validityType:n,validity:i}=t,s,a;t.signatureV2!=null&&t.data!=null?(a=t.signatureV2,s=x6(t.data),D6e(t)):(a=t.signature??new Uint8Array(0),s=S6(r,n,i));let o;try{o=await e.verify(s,a)}catch{o=!1}if(!o)throw J2.error("record signature verification failed"),(0,Ks.default)(new Error("record signature verification failed"),mh);if(i!=null&&n===$i.ValidityType.EOL){let l;try{l=Q2(M(i))}catch{throw J2.error("unrecognized validity format (not an rfc3339 format)"),(0,Ks.default)(new Error("unrecognized validity format (not an rfc3339 format)"),xq)}if(l.getTime()<Date.now())throw J2.error("record has expired"),(0,Ks.default)(new Error("record has expired"),vq)}else if(n!=null)throw J2.error("unrecognized validity type"),(0,Ks.default)(new Error("unrecognized validity type"),Y2);J2("ipns entry for %b is valid",r)},D6e=e=>{if(e.data==null)throw(0,Ks.default)(new Error("Record data is missing"),Rq);let t=kq(e.data);if(!Ce(t.Value,e.value))throw(0,Ks.default)(new Error('Field "value" did not match between protobuf and CBOR'),mh);if(!Ce(t.Validity,e.validity))throw(0,Ks.default)(new Error('Field "validity" did not match between protobuf and CBOR'),mh);if(t.ValidityType!==e.validityType)throw(0,Ks.default)(new Error('Field "validityType" did not match between protobuf and CBOR'),mh);if(t.Sequence!==e.sequence)throw(0,Ks.default)(new Error('Field "sequence" did not match between protobuf and CBOR'),mh);if(t.TTL!==e.ttl)throw(0,Ks.default)(new Error('Field "ttl" did not match between protobuf and CBOR'),mh)},l0=async(e,t)=>{let r=lR(e),n=Uc(t),i=await Pq(r,n);await P6e(i,n)},dR=C("ipfs:ipns:resolver"),k6e=Rn().code,Kq=32,I6=class{constructor(e){this._routing=e}async resolve(e,t={}){if(typeof e!="string")throw(0,f0.default)(new Error("invalid name"),"ERR_INVALID_NAME");let r=t.recursive&&t.recursive.toString()==="true",n=e.split("/");if(n.length!==3||n[0]!=="")throw(0,f0.default)(new Error("invalid name"),"ERR_INVALID_NAME");let i=n[2],s=1/0;r&&(s=Kq);let a=await this.resolver(i,s);return dR(`${e} was locally resolved correctly`),a}async resolver(e,t){if(t===0){let i=`could not resolve name (recursion limit of ${Kq} exceeded)`;throw dR.error(i),(0,f0.default)(new Error(i),"ERR_RESOLVE_RECURSION_LIMIT")}let r=await this._resolveName(e),n=r.split("/");return n[1]==="ipfs"||!t?r:this.resolver(n[2],t-1)}async _resolveName(e){let t=ue(e),r=dl(t),n;try{n=await this._routing.get(r)}catch(i){throw dR.error("could not get record from routing",i),i.code===k6e?(0,f0.default)(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):(0,f0.default)(new Error(`unexpected error getting the ipns record ${t.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}return this._validateRecord(t,n)}async _validateRecord(e,t){await l0(Ae([U("/ipns/"),e.toBytes()]),t);let r=Uc(t);return M(r.value)}};c();var Vq=w(Mp(),1),C6=class{constructor(e){this.lru=(0,Vq.default)(e)}get(e){let t=this.lru.get(e);if(t){if(t.expire&&t.expire<Date.now()){this.lru.remove(e);return}return t.value}}set(e,t,r){this.lru.set(e,{value:t,expire:Date.now()+r})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};me();var ey=C("ipfs:ipns"),qq=60*1e3,ty=class{constructor(e,t,r,n,i){this.publisher=new yh(e,t),this.republisher=new T6(this.publisher,t,r,n,i),this.resolver=new I6(e),this.cache=new C6(1e3),this.routing=e}async publish(e,t,r=yh.defaultRecordLifetime){try{await this.publisher.publishWithEOL(e,t,r),ey(`IPNS value ${M(t,"base32")} was published correctly`);let n=e.toString(),i=parseFloat(r),s=i<qq?i:qq;return this.cache.set(n,t,s),ey(`IPNS value ${M(t,"base32")} was cached correctly`),{name:n,value:t}}catch(n){throw ey.error(n),n}}async resolve(e,t={}){if(typeof e!="string")throw(0,zq.default)(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){let r=e.split("/")[2],n=this.cache.get(r);if(n)return n}try{let r=await this.resolver.resolve(e,t);return ey(`IPNS record from ${e} was resolved correctly`),r}catch(r){throw ey.error(r),r}}async initializeKeyspace(e,t){return this.publish(e,t,yh.defaultRecordLifetime)}};c(),c(),c(),c();var $q=w(Vs(),1),P6=(e,t)=>async function*(){yield*(await(0,$q.default)(e)).sort(t)}(),pR=w(Ci(),1),wh=w(Gi(),1),mR=w(h0(),1),Wi=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(let r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(let r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(r,n){e.push({key:r,value:n})},delete(r){t.push(r)},commit:async r=>{await(0,pR.default)(this.putMany(e,r)),e=[],await(0,pR.default)(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(e.prefix!=null&&(r=(0,wh.default)(r,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(r=e.filters.reduce((n,i)=>(0,wh.default)(n,i),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((n,i)=>P6(n,i),r)),e.offset!=null){let n=0;r=(0,wh.default)(r,()=>n++>=e.offset)}return e.limit!=null&&(r=(0,mR.default)(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(e.prefix!=null&&(r=(0,wh.default)(r,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(r=e.filters.reduce((n,i)=>(0,wh.default)(n,i),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((n,i)=>P6(n,i),r)),e.offset!=null){let n=0;r=(0,wh.default)(r,()=>n++>=e.offset)}return e.limit!=null&&(r=(0,mR.default)(r,e.limit)),r}},tz=w(Mi(),1),gR=w(ez(),1),wR=w(Ci(),1),M6e=(0,tz.default)("datastore:core:tiered"),ry=class extends Wi{constructor(e){super(),this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch{throw Lw()}}async put(e,t){try{await Promise.all(this.stores.map(r=>r.put(e,t)))}catch{throw Mw()}}async get(e,t){for(let r of this.stores)try{let n=await r.get(e,t);if(n)return n}catch(n){M6e(n)}throw Rn()}async has(e,t){for(let r of this.stores)if(await r.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map(r=>r.delete(e,t)))}catch{throw Bw()}}async*putMany(e,t={}){let r,n=this.stores.map(i=>{let s=(0,gR.default)();return(0,wR.default)(i.putMany(s,t)).catch(a=>{r=a}),s});try{for await(let i of e){if(r)throw r;n.forEach(s=>s.push(i)),yield i}}finally{n.forEach(i=>i.end())}}async*deleteMany(e,t={}){let r,n=this.stores.map(i=>{let s=(0,gR.default)();return(0,wR.default)(i.deleteMany(s,t)).catch(a=>{r=a}),s});try{for await(let i of e){if(r)throw r;n.forEach(s=>s.push(i)),yield i}}finally{n.forEach(i=>i.end())}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(t=>t.batch());return{put:(t,r)=>{e.forEach(n=>n.put(t,r))},delete:t=>{e.forEach(r=>r.delete(t))},commit:async t=>{for(let r of e)await r.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}},sy=w(D6(),1);c(),c(),me();var k6=(e,t)=>{let r=t.map((n,i)=>({entry:$i.decode(n),index:i}));return r.sort((n,i)=>{if(n.entry.signatureV2!=null&&i.entry.signatureV2==null)return-1;if(n.entry.signatureV2==null&&i.entry.signatureV2!=null)return 1;let s=n.entry.sequence??0n,a=i.entry.sequence??0n;if(s>a)return-1;if(s<a)return 1;let o=n.entry.validity??new Uint8Array(0),l=i.entry.validity??new Uint8Array(0),u=Q2(M(o)),h=Q2(M(l));return u.getTime()>h.getTime()?-1:u.getTime()<h.getTime()?1:0}),r[0].index};Hr(),c(),c(),c(),c(),c();var rz="SHARDING",nz="_README";c();var ny=class extends Wi{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw Rn();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new ae(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new ae(e))}};c();var q6e=w(ei(),1),z6e=w(az(),1);c();var j$e=new ae(rz),Y$e=new ae(nz);c();var G6e=w(Gi(),1),W6e=w(h0(),1),j6e=w(Fc(),1);c();var m0=el;c();var hz=w(K(),1);me(),Re();var O6="/record/";function SR(e){return M(e,"base32")}function iy(e){(typeof e=="string"||e instanceof String)&&(e=U(e.toString()));let t=M(e,"base64url");return`${O6}${t}`}function dz(e){if(e.substring(0,O6.length)!==O6)throw(0,hz.default)(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let t=e.substring(O6.length);return U(t,"base64url")}yr();var po=w(K(),1),pi=C("datastore-pubsub:publisher"),L6=class extends Wi{constructor(e,t,r,n,i,s){if(super(),!n)throw(0,po.default)(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw(0,po.default)(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw(0,po.default)(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw(0,po.default)(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=r,this._validator=n,this._selector=i,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}async put(e,t){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw pi.error(n),(0,po.default)(new Error(n),"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){let n="received value is not a Uint8Array";throw pi.error(n),(0,po.default)(new Error(n),"ERR_INVALID_VALUE_RECEIVED")}let r=iy(e);pi(`publish value for topic ${r}`),await this._pubsub.publish(r,t)}async get(e){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw pi.error(n),(0,po.default)(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let t=iy(e),r=await this._pubsub.getTopics();if(r&&Array.isArray(r)&&r.indexOf(t)>-1)return this._getLocal(e);try{await this._pubsub.subscribe(t)}catch{let n=`cannot subscribe topic ${t}`;throw pi.error(n),(0,po.default)(new Error(n),"ERR_SUBSCRIBING_TOPIC")}return pi(`subscribed values for key ${t}`),this._getLocal(e)}unsubscribe(e){let t=iy(e);return this._pubsub.unsubscribe(t)}async _getLocal(e){let t=new ae("/"+SR(e),!1),r;try{r=await this._datastore.get(t)}catch(n){if(n.code!=="ERR_NOT_FOUND"){let s=`unexpected error getting the ipns record for ${t.toString()}`;throw pi.error(s),(0,po.default)(new Error(s),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let i=`local record requested was not found for ${t.toString()}`;throw pi.error(i),(0,po.default)(new Error(i),"ERR_NOT_FOUND")}if(!(r instanceof Uint8Array)){let n="found record that we couldn't convert to a value";throw pi.error(n),(0,po.default)(new Error(n),"ERR_INVALID_RECORD_RECEIVED")}return r}async _onMessage(e){let t=e.detail,{data:r,from:n,topic:i}=t,s;try{s=dz(i)}catch(a){pi.error(a);return}if(pi(`message received for topic ${i}`),this._peerId.equals(n)){pi("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let a;try{a=await this._handleSubscriptionKeyFn(s)}catch{pi.error("message discarded by the subscriptionKeyFn");return}s=a}try{await this._storeIfSubscriptionIsBetter(s,r)}catch(a){pi.error(a)}}async _storeIfSubscriptionIsBetter(e,t){let r=!1;try{r=await this._isBetter(e,t)}catch(n){if(n.code!=="ERR_NOT_VALID_RECORD")throw n}r&&await this._storeRecord(e,t)}async _validateRecord(e,t){return this._validator(e,t)}async _selectRecord(e,t){return await this._selector(e,t)===0}async _isBetter(e,t){try{await this._validateRecord(e,t)}catch{let i="record received through pubsub is not valid";throw pi.error(i),(0,po.default)(new Error(i),"ERR_NOT_VALID_RECORD")}let r=new ae(e),n;try{n=await this._getLocal(r.uint8Array())}catch{return!0}return Ce(n,t)?!1:this._selectRecord(e,[n,t])}async _storeRecord(e,t){let r=new ae("/"+SR(e),!1);await this._datastore.put(r,t),pi(`record for ${iy(e)} was stored in the datastore`)}};Re(),me();var xR=w(K(),1),B6=C("ipfs:ipns:pubsub"),Eh=class{constructor(e,t,r){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new L6(e,t,r,l0,k6,this._handleSubscriptionKey)}async put(e,t){try{await this._pubsubDs.put(e,t)}catch(r){throw B6.error(r),r}}async get(e){let t,r;try{t=await this._pubsubDs.get(e)}catch(i){r=i}let n=e.slice(0,R6);if(M(n)===X2){let i=Ne.encode(e).substring(1),s=Ne.encode(e.slice(R6)).substring(1);this._subscriptions[i]=s,B6(`subscribed to pubsub topic ${i}, id ${s}`)}if(r)throw r;return t}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=M(e,"base58btc"));let t=this._subscriptions[e];if(!t)throw(0,xR.default)(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");try{return dl(ue(t))}catch(r){throw B6.error(r),r}}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(e=>`${X2}${e}`)}async cancel(e){if(typeof e!="string")throw(0,xR.default)(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(X2)&&(e=e.substring(R6));let t=Object.keys(this._subscriptions).find(n=>this._subscriptions[n]===e);if(!t)return{canceled:!1};let r=U(t);return this._pubsubDs.unsubscribe(r),delete this._subscriptions[t],B6(`unsubscribed pubsub ${t}: ${e}`),{canceled:!0}}};c(),c(),c();var oy;(function(e){e.codec=()=>Xe({1:{name:"key",codec:ye},2:{name:"value",codec:ye},5:{name:"timeReceived",codec:pn}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(oy||(oy={})),c();function pz(e){let t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0"),i=String(e.getUTCHours()).padStart(2,"0"),s=String(e.getUTCMinutes()).padStart(2,"0"),a=String(e.getUTCSeconds()).padStart(2,"0"),o=e.getUTCMilliseconds(),l=String(o*1e3*1e3).padStart(9,"0");return`${t}-${r}-${n}T${i}:${s}:${a}.${l}Z`}function mz(e){let t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(r==null)throw new Error("Invalid format");let n=parseInt(r[1],10),i=parseInt(r[2],10)-1,s=parseInt(r[3],10),a=parseInt(r[4],10),o=parseInt(r[5],10),l=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,i,s,a,o,l,u))}var Vr=class{constructor(e,t,r){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=r}serialize(){return oy.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:pz(this.timeReceived)}}static deserialize(e){let t=oy.decode(e);return new Vr(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){let t=mz(e.timeReceived);if(e.key==null)throw new Error("key missing from deserialized object");if(e.value==null)throw new Error("value missing from deserialized object");return new Vr(e.key,e.value,t)}},y0=w(K(),1);me();var RR=C("ipfs:ipns:offline-datastore"),g0=class{constructor(e){this._datastore=e,this.stores=[]}async put(e,t){if(!(e instanceof Uint8Array))throw(0,y0.default)(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw(0,y0.default)(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let r;try{r=this._routingKey(e)}catch(i){throw RR.error(i),(0,y0.default)(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=new Vr(e,t,new Date);await this._datastore.put(r,n.serialize())}async get(e){if(!(e instanceof Uint8Array))throw(0,y0.default)(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let t;try{t=this._routingKey(e)}catch(i){throw RR.error(i),(0,y0.default)(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let r=await this._datastore.get(t),n;try{n=Vr.deserialize(r)}catch(i){throw RR.error(i),i}return n.value}_routingKey(e){return new ae("/dht/record/"+M(e,"base32"),!1)}};c();var yz=w(Ci(),1),Q6e=C("ipfs:ipns:dht-datastore"),M6=class{constructor(e){this._dht=e}async put(e,t){try{await(0,yz.default)(this._dht.put(e,t))}catch(r){throw Q6e.error(r),r}}async get(e){for await(let t of this._dht.get(e))if(t.name==="VALUE")return t.value;throw Rn()}};function gz({libp2p:e,repo:t,peerId:r,options:n}){let i=[],s;if((0,sy.default)(n,"EXPERIMENTAL.ipnsPubsub",!1)&&(s=new Eh(e.pubsub,t.datastore,r),i.push(s)),(0,sy.default)(n,"offline",!1)!==!0&&["dht","dhtclient","dhtserver"].includes((0,sy.default)(n,"config.Routing.Type","none"))&&i.push(new M6(e.dht)),(0,sy.default)(n,"offline",!1)||i.length===0){let a=new g0(t.datastore);i.push(a)}return new ry(i)}var X6e=C("ipfs:components:ipns"),U6=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new Sc}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:r}){if(this.offline!=null)throw new Ts;X6e("initializing IPNS keyspace (offline)");let n=new g0(e.datastore),i=new ty(n,e.datastore,t,r,this.options);this.offline=i}async startOnline({libp2p:e,repo:t,peerId:r,keychain:n}){if(this.online!=null)throw new Ts;let i=gz({libp2p:e,repo:t,peerId:r,options:this.options}),s=new ty(i,t.datastore,r,n,this.options);await s.republisher.start(),this.online=s}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,t,r){return this.getIPNS().publish(e,t,r)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t){return this.getIPNS().initializeKeyspace(e,t)}};c(),c();var TR=w(K(),1);Re(),me(),c();var wz=w(m2(),1),Ez=w(Ci(),1);async function bz({ipns:e,repo:t,codecs:r},n,i){if(wz.default.ipnsPath(n))return e.resolve(n);let{cid:s,path:a}=Tc(n);await(0,Ez.default)(Qu(s,a||"",r,t,i))}var AR=C("ipfs:name:publish");function _z({ipns:e,repo:t,codecs:r,peerId:n,isOnline:i,keychain:s}){let a=async l=>{let u;if(l==="self"&&n.privateKey!=null)u=await Jn(n.privateKey);else try{let h=await s.exportKey(l,"temp");u=await Mc(h,"temp")}catch(h){throw AR.error(h),(0,TR.default)(h,"ERR_CANNOT_GET_KEY")}return sn(u.public.bytes,u.bytes)};async function o(l,u={}){let h=u.resolve!==!1,f=u.lifetime||"24h",y=u.key||"self";if(!i())throw(0,TR.default)(new Error(Sw),"OFFLINE_ERROR");try{l=$U(l)}catch(b){throw AR.error(b),b}let p=0;try{p=ju(f)||0,p=parseFloat(p.toFixed(6))}catch(b){throw AR.error(b),b}let v=await Promise.all([a(y),h?bz({ipns:e,repo:t,codecs:r},l):Promise.resolve()]),d=U(l),g=await e.publish(v[0],d,p);return{name:g.name,value:M(g.value)}}return B(o)}c();var F6=w(K(),1);te(),On(),nw();var Rz=w(Sz(),1);me();var J6e=Ze.bind({ignoreUndefined:!0}),e5e=C("ipfs:name:resolve"),xz=(e,t)=>t.length>0?e+"/"+t.join("/"):e;function Az({dns:e,ipns:t,isOnline:r,options:{offline:n}}){async function*i(s,a={}){if(a=J6e({nocache:!1,recursive:!0},a),n&&a&&a.nocache)throw(0,F6.default)(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!r()&&!n)throw(0,F6.default)(new Error(Sw),"OFFLINE_ERROR");let o=s.toString();o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[l,u,...h]=o.slice(1).split("/");try{if(u.substring(0,1)==="1"){let y=ue(u),p=_r(y.toBytes());u=I.createV1(114,p).toString(xp)}else{let y=I.parse(u);y.version===1&&(u=y.toString(xp))}}catch(y){if((0,Rz.default)(u)){yield xz(await e(u,a),h);return}throw e5e.error(y),(0,F6.default)(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}let f=await t.resolve(`/${l}/${u}`,a);yield xz(f instanceof Uint8Array?M(f):f,h)}return B(i)}c(),c(),c();var IR=w(K(),1);function w0(e,t){if(!e||!(t&&t.ipnsPubsub))throw(0,IR.default)(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(e.routing instanceof Eh)return e.routing;let r=(e.routing.stores||[]).find(n=>n instanceof Eh);if(!r)throw(0,IR.default)(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return r}function Tz({ipns:e,options:t}){let r=t.EXPERIMENTAL;async function n(i,s={}){return w0(e,r).cancel(i,s)}return B(n)}c();function Iz({ipns:e,options:t}){let r=t.EXPERIMENTAL;async function n(i={}){try{return{enabled:Boolean(w0(e,r))}}catch{return{enabled:!1}}}return B(n)}c();function Cz({ipns:e,options:t}){let r=t.EXPERIMENTAL;async function n(i={}){return w0(e,r).getSubscriptions(i)}return B(n)}var K6=class{constructor({ipns:e,options:t}){this.cancel=Tz({ipns:e,options:t}),this.state=Iz({ipns:e,options:t}),this.subs=Cz({ipns:e,options:t})}},V6=class{constructor({dns:e,ipns:t,repo:r,codecs:n,peerId:i,isOnline:s,keychain:a,options:o}){this.publish=_z({ipns:t,repo:r,codecs:n,peerId:i,isOnline:s,keychain:a}),this.resolve=Az({dns:e,ipns:t,isOnline:s,options:o}),this.pubsub=new K6({ipns:t,options:o})}};c(),te();var Pz=w($o(),1),Dz=w(Vi(),1),t5e=Rn().code,CR={default:"<dst>",edges:"<src> -> <dst>"};function kz({repo:e,codecs:t,resolve:r,preload:n}){async function*i(s,a={}){if(a.maxDepth===0)return;if(a.edges&&a.format&&a.format!==CR.default)throw new Error("Cannot set edges to true and also specify format");if(a.format=a.edges?CR.edges:a.format,typeof a.maxDepth!="number"&&(a.maxDepth=a.recursive?1/0:1),a.timeout){let l=[new Pz.TimeoutController(a.timeout).signal];a.signal&&l.push(a.signal),a.signal=(0,Dz.anySignal)(l)}let o=(Array.isArray(s)?s:[s]).map(l=>r5e(n,l,a));for(let l of o)try{yield*n5e(r,e,t,l,a)}catch(u){yield{ref:"",err:u.message}}}return i}function r5e(e,t,r){let{cid:n,path:i}=Tc(t);return r.preload!==!1&&e(n),`/ipfs/${n}${i||""}`}async function*n5e(e,t,r,n,i){let s=await e(n,i),{cid:a}=Tc(s),o=i.maxDepth!=null?i.maxDepth:1/0,l=i.unique||!1;for await(let u of o5e(t,r,a,o,l,i))!u.parent||u.isDuplicate||(yield{ref:i5e(u.parent.cid,u.node.cid,u.node.name,i.format)})}function i5e(e,t,r="",n=CR.default){let i=n.replace(/<src>/g,e.toString());return i=i.replace(/<dst>/g,t.toString()),i=i.replace(/<linkname>/g,r),i}async function*o5e(e,t,r,n,i,s){let a=new Set;async function*o(l,u){let h=u+1;if(!(h>n))try{for await(let f of s5e(e,t,l.cid,s))yield{parent:l,node:f,isDuplicate:i&&a.has(f.cid.toString())},i&&a.add(f.cid.toString()),yield*o(f,h)}catch(f){throw f.code===t5e&&(f.message=`Could not find object with CID: ${l.cid}`),f}}yield*o({cid:r},0)}async function*s5e(e,t,r,n){let i=await e.blocks.get(r,n),s=(await t.getCodec(r.code)).decode(i),a=r.code===pt,o=[];for(let[l,u]of PR(s,o)){if(a){let h=l.match(/^Links\/(\d+)\/Hash$/);if(h){let f=Number(h[1]);if(f<s.Links.length){yield{name:s.Links[f].Name,cid:u};continue}}}yield{name:l,cid:u}}}var PR=function*(e,t){if(e!=null&&!(e instanceof Uint8Array)){for(let[r,n]of Object.entries(e)){let i=[...t,r];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[s,a]of n.entries()){let o=[...i,s],l=I.asCID(a);l?yield[o.join("/"),l]:typeof a=="object"&&(yield*PR(a,o))}else{let s=I.asCID(n);s?yield[i.join("/"),s]:yield*PR(n,i)}}return[]}};c();function Nz({repo:e}){async function*t(r={}){for await(let n of e.blocks.queryKeys({},{signal:r.signal}))yield{ref:n.toString()}}return B(t)}c(),c();function Oz({network:e}){async function t(r={}){let{bitswap:n}=await e.use(r),i=n.getWantlist();return Array.from(i).map(s=>s[1].cid)}return B(t)}c();function Lz({network:e}){async function t(r,n={}){let{bitswap:i}=await e.use(n),s=i.wantlistForPeer(r);return Array.from(s).map(a=>a[1].cid)}return B(t)}c();function Bz({network:e}){async function t(r,n={}){let{bitswap:i}=await e.use(n);return Array.isArray(r)||(r=[r]),i.unwant(r)}return B(t)}c();function q6({network:e}){async function t(r={}){let n=(await e.use(r)).bitswap,i=n.stat().snapshot;return{provideBufLen:parseInt(i.providesBufferLength.toString()),blocksReceived:BigInt(i.blocksReceived.toString()),wantlist:Array.from(n.getWantlist()).map(s=>s[1].cid),peers:n.peers(),dupBlksReceived:BigInt(i.dupBlksReceived.toString()),dupDataReceived:BigInt(i.dupDataReceived.toString()),dataReceived:BigInt(i.dataReceived.toString()),blocksSent:BigInt(i.blocksSent.toString()),dataSent:BigInt(i.dataSent.toString())}}return B(t)}var z6=class{constructor({network:e}){this.wantlist=Oz({network:e}),this.wantlistForPeer=Lz({network:e}),this.unwant=Bz({network:e}),this.stat=q6({network:e})}};c(),c(),c(),c(),c(),c(),c(),c(),c(),c();var Mz="[a-fA-F\\d:]",pl=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${Mz})|(?<=${Mz})(?=\\s|$))`:"",qs="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",mn="[a-fA-F\\d]{1,4}",H6=`
(?:
(?:${mn}:){7}(?:${mn}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${mn}:){6}(?:${qs}|:${mn}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${mn}:){5}(?::${qs}|(?::${mn}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${mn}:){4}(?:(?::${mn}){0,1}:${qs}|(?::${mn}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${mn}:){3}(?:(?::${mn}){0,2}:${qs}|(?::${mn}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${mn}:){2}(?:(?::${mn}){0,3}:${qs}|(?::${mn}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${mn}:){1}(?:(?::${mn}){0,4}:${qs}|(?::${mn}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${mn}){0,5}:${qs}|(?::${mn}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),a5e=new RegExp(`(?:^${qs}$)|(?:^${H6}$)`),c5e=new RegExp(`^${qs}$`),u5e=new RegExp(`^${H6}$`),DR=e=>e&&e.exact?a5e:new RegExp(`(?:${pl(e)}${qs}${pl(e)})|(?:${pl(e)}${H6}${pl(e)})`,"g");DR.v4=e=>e&&e.exact?c5e:new RegExp(`${pl(e)}${qs}${pl(e)}`,"g"),DR.v6=e=>e&&e.exact?u5e:new RegExp(`${pl(e)}${H6}${pl(e)}`,"g");var $6=DR;function G6(e){return $6({exact:!0}).test(e)}function Uz(e){return $6.v6({exact:!0}).test(e)}function Fz(e){return $6.v4({exact:!0}).test(e)}me();var Kz=Fz,l5e=Uz,kR=function(e){let t=0,r;if(Kz(e))r=new Uint8Array(t+4),e.split(/\./g).forEach(n=>{r[t++]=parseInt(n,10)&255});else if(l5e(e)){let n=e.split(":",8),i;for(i=0;i<n.length;i++){let s=Kz(n[i]),a;s&&(a=kR(n[i]),n[i]=M(a.slice(0,2),"base16")),a!=null&&++i<8&&n.splice(i,0,M(a.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(i=0;i<n.length&&n[i]!=="";i++);let s=[i,1];for(i=9-n.length;i>0;i--)s.push("0");n.splice.apply(n,s)}for(r=new Uint8Array(t+16),i=0;i<n.length;i++){let s=parseInt(n[i],16);r[t++]=s>>8&255,r[t++]=s&255}}if(r==null)throw Error("Invalid ip address: "+e);return r},Vz=function(e,t,r){t=~~t,r=r??e.length-t;let n=[],i="",s=new DataView(e.buffer);if(r===4){for(let a=0;a<r;a++)n.push(e[t+a]);i=n.join(".")}else if(r===16){for(let a=0;a<r;a+=2)n.push(s.getUint16(t+a).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};c();var ay={},NR={},h5e=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];h5e.forEach(e=>{let t=d5e(...e);NR[t.code]=t,ay[t.name]=t});function d5e(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}function Tn(e){if(typeof e=="number"){if(NR[e]!=null)return NR[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(ay[e]!=null)return ay[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}te(),si(),Hr(),On();var bh=w(ai(),1);me(),Re(),ur();function Hz(e,t){switch(Tn(e).code){case 4:case 41:return p5e(t);case 6:case 273:case 33:case 132:return Gz(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return y5e(t);case 421:return w5e(t);case 444:return zz(t);case 445:return zz(t);default:return M(t,"base16")}}function $z(e,t){switch(Tn(e).code){case 4:return qz(t);case 41:return qz(t);case 6:case 273:case 33:case 132:return OR(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return m5e(t);case 421:return g5e(t);case 444:return E5e(t);case 445:return b5e(t);default:return U(t,"base16")}}function qz(e){if(!G6(e))throw new Error("invalid ip address");return kR(e)}function p5e(e){let t=Vz(e,0,e.length);if(t==null||!G6(t))throw new Error("invalid ip address");return t}function OR(e){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function Gz(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function m5e(e){let t=U(e),r=Uint8Array.from(bh.default.encode(t.length));return Ae([r,t],r.length+t.length)}function y5e(e){let t=bh.default.decode(e);if(e=e.slice(bh.default.decode.bytes),e.length!==t)throw new Error("inconsistent lengths");return M(e)}function g5e(e){let t;e[0]==="Q"||e[0]==="1"?t=_r(Ne.decode(`z${e}`)).bytes:t=I.parse(e).multihash.bytes;let r=Uint8Array.from(bh.default.encode(t.length));return Ae([r,t],r.length+t.length)}function w5e(e){let t=bh.default.decode(e),r=e.slice(bh.default.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return M(r,"base58btc")}function E5e(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let r=xt.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=OR(n);return Ae([r,i],r.length+i.length)}function b5e(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let r=xt.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=OR(n);return Ae([r,i],r.length+i.length)}function zz(e){let t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=M(t,"base32"),i=Gz(r);return`${n}:${i}`}var E0=w(ai(),1);ur(),me();function _5e(e){let t=[],r=e.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=Tn(i);if(s.size===0){t.push([i]);continue}if(n++,n>=r.length)throw jz("invalid address: "+e);if(s.path===!0){t.push([i,UR(r.slice(n).join("/"))]);break}t.push([i,r[n]])}return t}function v5e(e){let t=[];return e.map(r=>{let n=Y6(r);return t.push(n.name),r.length>1&&r[1]!=null&&t.push(r[1]),null}),UR(t.join("/"))}function S5e(e){return e.map(t=>{Array.isArray(t)||(t=[t]);let r=Y6(t);return t.length>1?[r.code,$z(r.code,t[1])]:[r.code]})}function LR(e){return e.map(t=>{let r=Y6(t);return t[1]!=null?[r.code,Hz(r.code,t[1])]:[r.code]})}function BR(e){return j6(Ae(e.map(t=>{let r=Y6(t),n=Uint8Array.from(E0.default.encode(r.code));return t.length>1&&t[1]!=null&&(n=Ae([n,t[1]])),n})))}function MR(e,t){return e.size>0?e.size/8:e.size===0?0:E0.default.decode(t)+E0.default.decode.bytes}function cy(e){let t=[],r=0;for(;r<e.length;){let n=E0.default.decode(e,r),i=E0.default.decode.bytes,s=Tn(n),a=MR(s,e.slice(r+i));if(a===0){t.push([n]),r+=i;continue}let o=e.slice(r+i,r+i+a);if(r+=a+i,r>e.length)throw jz("Invalid address Uint8Array: "+M(e,"base16"));t.push([n,o])}return t}function W6(e){let t=cy(e),r=LR(t);return v5e(r)}function x5e(e){e=UR(e);let t=_5e(e),r=S5e(t);return BR(r)}function Wz(e){return x5e(e)}function j6(e){let t=R5e(e);if(t!=null)throw t;return Uint8Array.from(e)}function R5e(e){try{cy(e)}catch(t){return t}}function UR(e){return"/"+e.trim().split("/").filter(t=>t).join("/")}function jz(e){return new Error("Error parsing address: "+e)}function Y6(e){return Tn(e[0])}var FR=w(ai(),1);te(),Hr();var Qz=w(K(),1);me(),yr();var T5e=Symbol.for("nodejs.util.inspect.custom"),Xz=new Map,Yz=Symbol.for("@multiformats/js-multiaddr/multiaddr"),j=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,Yz,{value:!0}),e instanceof Uint8Array)this.bytes=j6(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Wz(e)}else if(j.isMultiaddr(e))this.bytes=j6(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return W6(this.bytes)}toJSON(){return this.toString()}toOptions(){let e=this.toString().split("/");return{family:e[1]==="ip4"?4:6,host:e[2],transport:e[3],port:parseInt(e[4])}}protos(){return this.protoCodes().map(e=>Object.assign({},Tn(e)))}protoCodes(){let e=[],t=this.bytes,r=0;for(;r<t.length;){let n=FR.default.decode(t,r),i=FR.default.decode.bytes,s=Tn(n);r+=MR(s,t.slice(r+i))+i,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return cy(this.bytes)}stringTuples(){let e=cy(this.bytes);return LR(e)}encapsulate(e){return e=new j(e),new j(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),r=this.toString(),n=r.lastIndexOf(t);if(n<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new j(r.slice(0,n))}decapsulateCode(e){let t=this.tuples();for(let r=t.length-1;r>=0;r--)if(t[r][0]===e)return new j(BR(t.slice(0,r)));return this}getPeerId(){try{let e=this.stringTuples().filter(t=>t[0]===ay.ipfs.code).pop();if(e?.[1]!=null){let t=e[1];return t[0]==="Q"||t[0]==="1"?M(Ne.decode(`z${t}`),"base58btc"):M(I.parse(t).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>Tn(t[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return Ce(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(r=>r.resolvable);if(e==null)return[this];let t=Xz.get(e.name);if(t==null)throw(0,Qz.default)(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await t(this)).map(r=>new j(r))}nodeAddress(){let e=this.protoCodes(),t=this.protoNames(),r=this.toString().split("/").slice(1);if(r.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(r[2]!=="tcp"&&r[2]!=="udp")throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:r[1],port:parseInt(r[3])}}isThinWaistAddress(e){let t=(e??this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}static fromNodeAddress(e,t){if(e==null)throw new Error("requires node address object");if(t==null)throw new Error("requires transport protocol");let r;switch(e.family){case 4:r="ip4";break;case 6:r="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new j("/"+[r,e.address,t,e.port].join("/"))}static isName(e){return j.isMultiaddr(e)?e.protos().some(t=>t.resolvable):!1}static isMultiaddr(e){return Boolean(e?.[Yz])}[T5e](){return"<Multiaddr "+M(this.bytes,"base16")+" - "+W6(this.bytes)+">"}inspect(){return"<Multiaddr "+M(this.bytes,"base16")+" - "+W6(this.bytes)+">"}};j.resolvers=Xz;var I5e=ze("dns4"),C5e=ze("dns6"),P5e=ze("dnsaddr"),gl=mi(ze("dns"),P5e,I5e,C5e),Q6=mi(ze("ip4"),ze("ip6")),ly=mi(dt(Q6,ze("tcp")),dt(gl,ze("tcp"))),Jz=dt(Q6,ze("udp")),D5e=dt(Jz,ze("utp")),k5e=dt(Jz,ze("quic")),vh=mi(dt(ly,ze("ws")),dt(gl,ze("ws"))),yl=mi(dt(ly,ze("wss")),dt(gl,ze("wss"))),KR=mi(dt(ly,ze("http")),dt(Q6,ze("http")),dt(gl,ze("http"))),VR=mi(dt(ly,ze("https")),dt(Q6,ze("https")),dt(gl,ze("https"))),X6=mi(dt(vh,ze("p2p-webrtc-star"),ze("p2p")),dt(yl,ze("p2p-webrtc-star"),ze("p2p")),dt(vh,ze("p2p-webrtc-star")),dt(yl,ze("p2p-webrtc-star"))),Mje=mi(dt(vh,ze("p2p-websocket-star"),ze("p2p")),dt(yl,ze("p2p-websocket-star"),ze("p2p")),dt(vh,ze("p2p-websocket-star")),dt(yl,ze("p2p-websocket-star"))),eH=mi(dt(KR,ze("p2p-webrtc-direct"),ze("p2p")),dt(VR,ze("p2p-webrtc-direct"),ze("p2p")),dt(KR,ze("p2p-webrtc-direct")),dt(VR,ze("p2p-webrtc-direct"))),uy=mi(vh,yl,KR,VR,X6,eH,ly,D5e,k5e,gl),Uje=mi(dt(uy,ze("p2p-stardust"),ze("p2p")),dt(uy,ze("p2p-stardust"))),ml=mi(dt(uy,ze("p2p")),X6,eH,ze("p2p")),Zz=mi(dt(ml,ze("p2p-circuit"),ml),dt(ml,ze("p2p-circuit")),dt(ze("p2p-circuit"),ml),dt(uy,ze("p2p-circuit")),dt(ze("p2p-circuit"),uy),ze("p2p-circuit")),tH=()=>mi(dt(Zz,tH),Zz),_h=tH(),qR=mi(dt(_h,ml,_h),dt(ml,_h),dt(_h,ml),_h,ml),rH=qR;function nH(e){function t(r){let n;try{n=new j(r)}catch{return!1}let i=e(n.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return t}function dt(...e){function t(r){if(r.length<e.length)return null;let n=r;return e.some(i=>(n=typeof i=="function"?i().partialMatch(r):i.partialMatch(r),Array.isArray(n)&&(r=n),n===null)),n}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:nH(t),partialMatch:t}}function mi(...e){function t(r){let n=null;return e.some(i=>{let s=typeof i=="function"?i().partialMatch(r):i.partialMatch(r);return s!=null?(n=s,!0):!1}),n}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:nH(t),partialMatch:t}}function ze(e){let t=e;function r(i){let s;try{s=new j(i)}catch{return!1}let a=s.protoNames();return a.length===1&&a[0]===t}function n(i){return i.length===0?null:i[0]===t?i.slice(1):null}return{toString:function(){return t},matches:r,partialMatch:n}}function Z6(e){try{return rH.matches(e)}catch{return!1}}function iH({repo:e}){async function t(r,n={}){if(!Z6(r))throw new Error(`${r} is not a valid Multiaddr`);let i=await e.config.getAll(n),s=i.Bootstrap||[];return s.push(r.toString()),i.Bootstrap=Array.from(new Set(s)).sort((a,o)=>a.localeCompare(o)),await e.config.replace(i),{Peers:[r]}}return B(t)}c();function oH({repo:e}){async function t(r={}){let n=await e.config.getAll(r),i=n.Bootstrap||[];return n.Bootstrap=[],await e.config.replace(n),{Peers:i.map(s=>new j(s))}}return B(t)}c();function sH({repo:e}){async function t(r={}){return{Peers:(await e.config.get("Bootstrap",r)||[]).map(n=>new j(n))}}return B(t)}c(),c();var Kc=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}});function aH({repo:e}){async function t(r={}){let n=await e.config.getAll(r);return n.Bootstrap=Kc().Bootstrap,await e.config.replace(n),{Peers:Kc().Bootstrap.map(i=>new j(i))}}return B(t)}c();function cH({repo:e}){async function t(r,n={}){if(!Z6(r))throw new Error(`${r} is not a valid Multiaddr`);let i=await e.config.getAll(n);return i.Bootstrap=(i.Bootstrap||[]).filter(s=>s.toString()!==r.toString()),await e.config.replace(i),{Peers:[r]}}return B(t)}var J6=class{constructor({repo:e}){this.add=iH({repo:e}),this.list=sH({repo:e}),this.rm=cH({repo:e}),this.clear=oH({repo:e}),this.reset=aH({repo:e})}};c(),c();function uH({preload:e,repo:t}){async function r(n,i={}){return i.preload!==!1&&e(n),t.blocks.get(n,i)}return B(r)}c(),te();function lH({codecs:e,hashers:t,repo:r,preload:n}){async function i(s,a={}){let o=a.pin?await r.gcLock.readLock():null;try{let l=a.version!=null?a.version:0,u=a.format||(l===0?"dag-pb":"raw"),h=await(await t.getHasher(a.mhtype||"sha2-256")).digest(s),f=await e.getCodec(u),y=I.create(l,f.code,h);return await r.blocks.put(y,s,{signal:a.signal}),a.preload!==!1&&n(y),a.pin===!0&&await r.pins.pinRecursively(y,{signal:a.signal}),y}finally{o&&o()}}return B(i)}c();var AH=w(K(),1),TH=w(n5(),1),IH=w(ei(),1),CH=w(Gi(),1);c(),c(),c();var i5=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},_0=class{constructor(e){this.hwm=e??16,this.head=new i5(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new i5(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}};function zs(e){return q5e(t=>{let r=t.shift();if(r==null)return{done:!0};if(r.error!=null)throw r.error;return{done:r.done===!0,value:r.value}},e)}function q5e(e,t){t=t??{};let r=t.onEnd,n=new _0,i,s,a,o=async()=>n.isEmpty()?a?{done:!0}:await new Promise((d,g)=>{s=b=>{s=null,n.push(b);try{d(e(n))}catch(_){g(_)}return i}}):e(n),l=d=>s!=null?s(d):(n.push(d),i),u=d=>(n=new _0,s!=null?s({error:d}):(n.push({error:d}),i)),h=d=>a?i:l({done:!1,value:d}),f=d=>a?i:(a=!0,d!=null?u(d):l({done:!0})),y=()=>(n=new _0,f(),{done:!0}),p=d=>(f(d),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:y,throw:p,push:h,end:f},r==null)return i;let v=i;return i={[Symbol.asyncIterator](){return this},next(){return v.next()},throw(d){return v.throw(d),r!=null&&(r(d),r=void 0),{done:!0}},return(){return v.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(d){return v.end(d),r!=null&&(r(d),r=void 0),i}},i}var xH=w(Fc(),1),z5e=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},RH=e=>e!=null&&(typeof e[Symbol.asyncIterator]=="function"||typeof e[Symbol.iterator]=="function"||typeof e.next=="function"),$R=e=>e!=null&&typeof e.sink=="function"&&RH(e.source),H5e=e=>t=>{let r=e.sink(t);if(r.then!=null){let n=zs();return r.then(()=>{n.end()},i=>{n.end(i)}),(0,xH.default)(n,async function*(){yield*e.source,n.end()}())}return e.source};function Te(e,...t){if($R(e)){let n=e;e=()=>n.source}else if(RH(e)){let n=e;e=()=>n}let r=[e,...t];if(r.length>1&&$R(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)$R(r[n])&&(r[n]=H5e(r[n]));return z5e(...r)}c(),te();function o5(e){return e instanceof Uint8Array?I.decode(e):I.parse(e.toString())}var $5e=8;function PH({repo:e}){async function*t(r,n={}){Array.isArray(r)||(r=[r]);let i=await e.gcLock.writeLock();try{yield*Te(r,s=>(0,IH.default)(s,a=>async()=>{a=o5(a);let o={cid:a};try{if(!await e.blocks.has(a))throw(0,AH.default)(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await e.blocks.delete(a)}catch(l){n.force||(l.message=`cannot remove ${a}: ${l.message}`,o.error=l)}return o}),s=>(0,TH.default)(s,{concurrency:$5e}),s=>(0,CH.default)(s,()=>!n.quiet))}finally{i()}}return B(t)}c();function DH({repo:e,preload:t}){async function r(n,i={}){n=o5(n),i.preload!==!1&&t(n);let s=await e.blocks.get(n);return{cid:n,size:s.length}}return B(r)}var s5=class{constructor({codecs:e,hashers:t,preload:r,repo:n}){this.get=uH({preload:r,repo:n}),this.put=lH({codecs:e,hashers:t,preload:r,repo:n}),this.rm=PH({repo:n}),this.stat=DH({preload:r,repo:n})}};c(),c();var GH=w(qi(),1);c(),c();var MH=w(K(),1);Re();var UH=w(v0(),1),FH=w(LH(),1),KH=w(S0(),1),VH=w(Vs(),1),qH=w(ei(),1);c();function Jo(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function Vc(e){return e.constructor&&(e.constructor.name==="Blob"||e.constructor.name==="File")&&typeof e.stream=="function"}function fy(e){return typeof e=="object"&&(e.path||e.content)}var qc=e=>e&&typeof e.getReader=="function";async function*a5(e){yield e}async function c5(e){if(Jo(e))return a5(GR(e));if(typeof e=="string"||e instanceof String)return a5(GR(e.toString()));if(Vc(e))return(0,FH.default)(e);if(qc(e)&&(e=(0,UH.default)(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let t=(0,KH.default)(e),{value:r,done:n}=await t.peek();if(n)return a5(new Uint8Array(0));if(t.push(r),Number.isInteger(r))return a5(Uint8Array.from(await(0,VH.default)(t)));if(Jo(r)||typeof r=="string"||r instanceof String)return(0,qH.default)(t,GR)}throw(0,MH.default)(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}function GR(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):U(e.toString())}c();var l5=w(K(),1),zH=w(v0(),1),HH=w(S0(),1);async function*$H(e,t){if(e==null)throw(0,l5.default)(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(typeof e=="string"||e instanceof String){yield u5(e.toString(),t);return}if(Jo(e)||Vc(e)){yield u5(e,t);return}if(qc(e)&&(e=(0,zH.default)(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let r=(0,HH.default)(e),{value:n,done:i}=await r.peek();if(i){yield{content:[]};return}if(r.push(n),Number.isInteger(n)||Jo(n)||typeof n=="string"||n instanceof String){yield u5(r,t);return}throw(0,l5.default)(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(fy(e)){yield u5(e,t);return}throw(0,l5.default)(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function u5(e,t){let{path:r,mode:n,mtime:i,content:s}=e,a={path:r||"",mode:Ec(n),mtime:qu(i)};return s?a.content=await t(s):r||(a.content=await t(e)),a}function f5(e){return $H(e,c5)}function WH({addAll:e}){async function t(r,n={}){let i=await(0,GH.default)(e(f5(r),n));if(i==null)throw Error("Failed to add a file, if you see this please report a bug");return i}return t}c(),c();var X$=w(d5(),1);c(),vr(),c(),rw(),bp();var WR=w(ZH(),1);function Z5e(e){let t=new Array(4);for(let r=0;r<4;r++)t[r]=e&255,e=e>>8;return new Uint8Array(t)}var nQe=Ep({name:"murmur3-32",code:35,encode:e=>Z5e(WR.default.x86.hash32(e))}),Sh=Ep({name:"murmur3-128",code:34,encode:e=>op.fromHex(WR.default.x64.hash128(e))});async function J5e(e){return(await Sh.encode(e)).slice(0,8).reverse()}var e8e={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:xe,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:J5e,hamtHashCode:34,hamtBucketBits:8},JH=(e={})=>Ze.bind({ignoreUndefined:!0})(e8e,e);c(),c(),c(),te(),vr();var t8e=async(e,t,r)=>{r.codec||(r.codec=At),r.hasher||(r.hasher=xe),r.cidVersion===void 0&&(r.cidVersion=1),r.codec===At&&r.hasher!==xe&&(r.cidVersion=1);let n=await r.hasher.digest(e),i=I.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await t.put(i,e,{signal:r.signal}),i},Hs=t8e,r8e=async(e,t,r)=>{let n=new Je({type:"directory",mtime:e.mtime,mode:e.mode}),i=je(Ln({Data:n.marshal()})),s=await Hs(i,t,r),a=e.path;return{cid:s,path:a,unixfs:n,size:i.length}},e$=r8e;c();var u$=w(K(),1),l$=w(d5(),1);zo(),c();var t$=w(Vs(),1);async function n8e(e,t){return t(await(0,t$.default)(e))}var r$=n8e;c();var n$=w(h5(),1);function i8e(e,t,r){return i$(e,t,r)}async function i$(e,t,r){let n=[];for await(let i of(0,n$.default)(e,r.maxChildrenPerNode))n.push(await t(i));return n.length>1?i$(n,t,r):n[0]}var o$=i8e;c();var s$=w(h5(),1);async function o8e(e,t,r){let n=new jR(r.layerRepeat),i=0,s=1,a=n;for await(let o of(0,s$.default)(e,r.maxChildrenPerNode))a.isFull()&&(a!==n&&n.addChild(await a.reduce(t)),i&&i%r.layerRepeat===0&&s++,a=new m5(s,r.layerRepeat,i),i++),a.append(o);return a&&a!==n&&n.addChild(await a.reduce(t)),n.reduce(t)}var a$=o8e,m5=class{constructor(e,t,r=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=r,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let r=[];return e.children.length&&(r=await Promise.all(e.children.filter(n=>n.data).map(n=>this._reduce(n,t)))),t((e.data||[]).concat(r))}_findParent(e,t){let r=e.parent;if(!(!r||r.depth===0))return r.children.length===r.maxChildren||!r.maxChildren?this._findParent(r,t):r}},jR=class extends m5{constructor(e){super(0,e),this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}};c(),zo();async function*s8e(e,t,r){for await(let n of e.content)yield async()=>{r.progress(n.length,e.path);let i,s={codec:At,cidVersion:r.cidVersion,hasher:r.hasher,onlyHash:r.onlyHash};return r.rawLeaves?(s.codec=Fi,s.cidVersion=1):(i=new Je({type:r.leafType,data:n}),n=je({Data:i.marshal(),Links:[]})),{cid:await Hs(n,t,s),unixfs:i,size:n.length}}}var c$=s8e,a8e={flat:r$,balanced:o$,trickle:a$};async function*c8e(e,t,r){let n=-1,i,s;typeof r.bufferImporter=="function"?s=r.bufferImporter:s=c$;for await(let a of(0,l$.default)(s(e,t,r),r.blockWriteConcurrency)){if(n++,n===0){i=a;continue}else n===1&&i&&(yield i,i=null);yield a}i&&(i.single=!0,yield i)}var u8e=(e,t,r)=>{async function n(i){if(i.length===1&&i[0].single&&r.reduceSingleLeafToSelf){let u=i[0];if(e.mtime!==void 0||e.mode!==void 0){let h=await t.get(u.cid);u.unixfs=new Je({type:"file",mtime:e.mtime,mode:e.mode,data:h}),h=je(Ln({Data:u.unixfs.marshal()})),u.cid=await Hs(h,t,{...r,codec:At,hasher:r.hasher,cidVersion:r.cidVersion}),u.size=h.length}return{cid:u.cid,path:e.path,unixfs:u.unixfs,size:u.size}}let s=new Je({type:"file",mtime:e.mtime,mode:e.mode}),a=i.filter(u=>u.cid.code===Un&&u.size||u.unixfs&&!u.unixfs.data&&u.unixfs.fileSize()?!0:Boolean(u.unixfs&&u.unixfs.data&&u.unixfs.data.length)).map(u=>u.cid.code===Un?(s.addBlockSize(u.size),{Name:"",Tsize:u.size,Hash:u.cid}):(!u.unixfs||!u.unixfs.data?s.addBlockSize(u.unixfs&&u.unixfs.fileSize()||0):s.addBlockSize(u.unixfs.data.length),{Name:"",Tsize:u.size,Hash:u.cid})),o={Data:s.marshal(),Links:a},l=je(Ln(o));return{cid:await Hs(l,t,r),path:e.path,unixfs:s,size:l.length+o.Links.reduce((u,h)=>u+h.Tsize,0)}}return n};function l8e(e,t,r){let n=a8e[r.strategy];if(!n)throw(0,u$.default)(new Error(`Unknown importer build strategy name: ${r.strategy}`),"ERR_BAD_STRATEGY");return n(c8e(e,t,r),u8e(e,t,r),r)}var f$=l8e,rA=w(K(),1);c();var T$=w(YR(),1),I$=w(A$(),1),eA=w(K(),1);async function*y8e(e,t){let r,n,i;if(t.minChunkSize&&t.maxChunkSize&&t.avgChunkSize)i=t.avgChunkSize,r=t.minChunkSize,n=t.maxChunkSize;else if(t.avgChunkSize)i=t.avgChunkSize,r=i/3,n=i+i/2;else throw(0,eA.default)(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(r<16)throw(0,eA.default)(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<r&&(n=r),i<r&&(i=r);let s=Math.floor(Math.log2(i));for await(let a of g8e(e,{min:r,max:n,bits:s,window:t.window,polynomial:t.polynomial}))yield a}var C$=y8e;async function*g8e(e,t){let r=await(0,I$.create)(t.bits,t.min,t.max,t.window),n=new T$.default;for await(let i of e){n.append(i);let s=r.fingerprint(i);for(let a=0;a<s.length;a++){let o=s[a],l=n.slice(0,o);n.consume(o),yield l}}n.length&&(yield n.slice(0))}c();var y5=w(YR(),1);async function*w8e(e,t){let r=new y5.default,n=0,i=!1,s=t.maxChunkSize;for await(let a of e)for(r.append(a),n+=a.length;n>=s;)if(yield r.slice(0,s),i=!0,s===r.length)r=new y5.default,n=0;else{let o=new y5.default;o.append(r.shallowSlice(s)),r=o,n-=s}(!i||n)&&(yield r.slice(0,n))}var P$=w8e;c();var tA=w(K(),1);Re();async function*E8e(e){for await(let t of e){if(t.length===void 0)throw(0,tA.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof t=="string"||t instanceof String)yield U(t.toString());else if(Array.isArray(t))yield Uint8Array.from(t);else if(t instanceof Uint8Array)yield t;else throw(0,tA.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}var D$=E8e;function b8e(e){return Symbol.iterator in e}function _8e(e){return Symbol.asyncIterator in e}function v8e(e){try{if(e instanceof Uint8Array)return async function*(){yield e}();if(b8e(e))return async function*(){yield*e}();if(_8e(e))return e}catch{throw(0,rA.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,rA.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*S8e(e,t,r){for await(let n of e)if(n.path&&(n.path.substring(0,2)==="./"&&(r.wrapWithDirectory=!0),n.path=n.path.split("/").filter(i=>i&&i!==".").join("/")),n.content){let i;typeof r.chunker=="function"?i=r.chunker:r.chunker==="rabin"?i=C$:i=P$;let s;typeof r.chunkValidator=="function"?s=r.chunkValidator:s=D$;let a={path:n.path,mtime:n.mtime,mode:n.mode,content:i(s(v8e(n.content),r),r)};yield()=>f$(a,t,r)}else if(n.path){let i={path:n.path,mtime:n.mtime,mode:n.mode};yield()=>e$(i,t,r)}else throw new Error("Import candidate must have content or path or both")}var k$=S8e;c(),c(),c();var nA=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},wl=nA,iA=class extends wl{constructor(e,t){super(e,t),this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let t=0;t<e.length;t++){let r=e[t];yield{key:r,child:this._children[r]}}}async*flush(e){let t=Object.keys(this._children),r=[];for(let l=0;l<t.length;l++){let u=this._children[t[l]];if(u instanceof wl)for await(let h of u.flush(e))u=h,yield u;u.size!=null&&u.cid&&r.push({Name:t[l],Tsize:u.size,Hash:u.cid})}let n=new Je({type:"directory",mtime:this.mtime,mode:this.mode}),i={Data:n.marshal(),Links:r},s=je(Ln(i)),a=await Hs(s,e,this.options),o=s.length+i.Links.reduce((l,u)=>l+(u.Tsize==null?0:u.Tsize),0);this.cid=a,this.size=o,yield{cid:a,unixfs:n,path:this.path,size:o}}},yy=iA;c(),c();var g5=w(wy(),1),sA=class extends wl{constructor(e,t){super(e,t),this._bucket=(0,g5.createHAMT)({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(let t of $$(this._bucket,e,this,this.options))yield{...t,path:this.path}}},H$=sA;async function*$$(e,t,r,n){let i=e._children,s=[],a=0;for(let p=0;p<i.length;p++){let v=i.get(p);if(!v)continue;let d=p.toString(16).toUpperCase().padStart(2,"0");if(v instanceof g5.Bucket){let g;for await(let b of await $$(v,t,null,n))g=b;if(!g)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:d,Tsize:g.size,Hash:g.cid}),a+=g.size}else if(typeof v.value.flush=="function"){let g=v.value,b;for await(let m of g.flush(t))b=m,yield b;let _=d+v.key;s.push({Name:_,Tsize:b.size,Hash:b.cid}),a+=b.size}else{let g=v.value;if(!g.cid)continue;let b=d+v.key,_=g.size;s.push({Name:b,Tsize:_,Hash:g.cid}),a+=_}}let o=Uint8Array.from(i.bitField().reverse()),l=new Je({type:"hamt-sharded-directory",data:o,fanout:e.tableSize(),hashType:n.hamtHashCode,mtime:r&&r.mtime,mode:r&&r.mode}),u={Data:l.marshal(),Links:s},h=je(Ln(u)),f=await Hs(h,t,n),y=h.length+a;yield{cid:f,unixfs:l,size:y}}async function G$(e,t,r,n){let i=t;t instanceof yy&&t.directChildrenCount()>=r&&(i=await V8e(t,n));let s=i.parent;if(s){if(i!==t){if(e&&(e.parent=i),!i.parentKey)throw new Error("No parent key found");await s.put(i.parentKey,i)}return G$(i,s,r,n)}return i}async function V8e(e,t){let r=new H$({root:e.root,dir:!0,parent:e.parent,parentKey:e.parentKey,path:e.path,dirty:e.dirty,flat:!1,mtime:e.mtime,mode:e.mode},t);for await(let{key:n,child:i}of e.eachChildSeries())await r.put(n,i);return r}var W$=G$;c();var q8e=(e="")=>(e.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean),j$=q8e;async function z8e(e,t,r){let n=j$(e.path||""),i=n.length-1,s=t,a="";for(let o=0;o<n.length;o++){let l=n[o];a+=`${a?"/":""}${l}`;let u=o===i;if(s.dirty=!0,s.cid=void 0,s.size=void 0,u)await s.put(l,e),t=await W$(null,s,r.shardSplitThreshold,r);else{let h=await s.get(l);(!h||!(h instanceof wl))&&(h=new yy({root:!1,dir:!0,parent:s,parentKey:l,path:a,dirty:!0,flat:!0,mtime:h&&h.unixfs&&h.unixfs.mtime,mode:h&&h.unixfs&&h.unixfs.mode},r)),await s.put(l,h),s=h}}return t}async function*Y$(e,t){if(!(e instanceof wl)){e&&e.unixfs&&e.unixfs.isDirectory()&&(yield e);return}yield*e.flush(t)}async function*H8e(e,t,r){let n=new yy({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r);for await(let i of e)!i||(n=await z8e(i,n,r),(!i.unixfs||!i.unixfs.isDirectory())&&(yield i));if(r.wrapWithDirectory)yield*Y$(n,t);else for await(let i of n.eachChildSeries())!i||(yield*Y$(i.child,t))}var Q$=H8e;async function*x0(e,t,r={}){let n=JH(r),i;typeof r.dagBuilder=="function"?i=r.dagBuilder:i=k$;let s;typeof r.treeBuilder=="function"?s=r.treeBuilder:s=Q$;let a;Symbol.asyncIterator in e||Symbol.iterator in e?a=e:a=[e];for await(let o of s((0,X$.default)(i(a,t,n),n.fileImportConcurrency),t,n))yield{cid:o.cid,path:o.path,unixfs:o.unixfs,size:o.size}}c(),c();var Ey=w(K(),1),Z$=w(v0(),1),J$=w(S0(),1),cA=w(ei(),1);async function*w5(e,t){if(typeof e=="string"||e instanceof String||Jo(e)||Vc(e)||e._readableState)throw(0,Ey.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(qc(e)&&(e=(0,Z$.default)(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let r=(0,J$.default)(e),{value:n,done:i}=await r.peek();if(i){yield*[];return}if(r.push(n),Number.isInteger(n))throw(0,Ey.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState){yield*(0,cA.default)(r,s=>aA({content:s},t));return}if(Jo(n)){yield aA({content:r},t);return}if(fy(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||qc(n)||Vc(n)){yield*(0,cA.default)(r,s=>aA(s,t));return}}throw fy(e)?(0,Ey.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):(0,Ey.default)(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function aA(e,t){let{path:r,mode:n,mtime:i,content:s}=e,a={path:r||"",mode:Ec(n),mtime:qu(i)};return s?a.content=await t(s):r||(a.content=await t(e)),a}function eG(e){return w5(e,c5)}c();var tG=e=>{if(e)if(e.startsWith("size-")){let t=e.split("-")[1],r=parseInt(t);if(isNaN(r))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:r}}else{if(e.startsWith("rabin"))return{chunker:"rabin",...$8e(e)};throw new Error(`Unrecognized chunker option: ${e}`)}else return{chunker:"fixed"}},$8e=e=>{let t={},r=e.split("-");switch(r.length){case 1:t.avgChunkSize=262144;break;case 2:t.avgChunkSize=E5(r[1],"avg");break;case 4:t.minChunkSize=E5(r[1],"min"),t.avgChunkSize=E5(r[2],"avg"),t.maxChunkSize=E5(r[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return t},E5=(e,t)=>{let r=parseInt(e);if(isNaN(r))throw new Error(`Chunker parameter ${t} must be an integer`);return r},G8e=Ze.bind({ignoreUndefined:!0});function rG({repo:e,preload:t,hashers:r,options:n}){let i=n&&n.sharding;async function*s(a,o={}){let l=G8e({shardSplitThreshold:i?1e3:1/0,strategy:"balanced"},o,{...tG(o.chunker)});l.hashAlg&&l.hashAlg!=="sha2-256"&&l.cidVersion!==1&&(l.cidVersion=1),l.trickle&&(l.strategy="trickle"),l.strategy==="trickle"&&(l.leafType="raw",l.reduceSingleLeafToSelf=!1),l.cidVersion>0&&l.rawLeaves===void 0&&(l.rawLeaves=!0),l.hashAlg!==void 0&&l.rawLeaves===void 0&&(l.rawLeaves=!0),delete l.trickle;let u={};if(l.progress){let p=l.progress;l.progress=(v,d)=>{u[d]||(u[d]=0),u[d]+=v,p(u[d],d)}}let h;l.hashAlg!=null&&(h=await r.getHasher(l.hashAlg));let f=Te(eG(a),p=>x0(p,e.blocks,{...l,hasher:h,pin:!1}),W8e(l),j8e(t,l),Y8e(e,l)),y=await e.gcLock.readLock();try{for await(let p of f){let v=p.path??p.cid.toString();delete u[v],yield{...p,path:v}}}finally{y()}}return B(s)}function W8e(e){async function*t(r){for await(let n of r){let i=n.cid;e.cidVersion===1&&(i=i.toV1());let s=n.path?n.path:i.toString();e.wrapWithDirectory&&!n.path&&(s=""),yield{path:s,cid:i,size:n.size,mode:n.unixfs&&n.unixfs.mode,mtime:n.unixfs&&n.unixfs.mtime}}}return t}function j8e(e,t){async function*r(n){for await(let i of n)(!i.path||t.wrapWithDirectory?i.path==="":!i.path.includes("/"))&&!t.onlyHash&&t.preload!==!1&&e(i.cid),yield i}return r}function Y8e(e,t){async function*r(n){for await(let i of n){let s=!(i.path&&i.path.includes("/"));(t.pin==null?!0:t.pin)&&s&&!t.onlyHash&&await e.pins.pinRecursively(i.cid),yield i}}return r}c(),c();var S5=w(K(),1);te(),c();var gG=w(K(),1);zo(),va(),c();var v5=w(K(),1);c();var b5=w(wy(),1),Q8e=async function(e){return(await Sh.encode(e)).slice(0,8).reverse()},X8e=(e,t,r)=>Promise.all(e.map(n=>{if(n.Name==null)throw new Error("Unexpected Link without a Name");if(n.Name.length===2){let i=parseInt(n.Name,16);return t._putObjectAt(i,new b5.Bucket({hash:r._options.hash,bits:r._options.bits},t,i))}return r.put(n.Name.substring(2),!0)})),nG=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),Z8e=e=>{let t=e.bucket,r=[];for(;t._parent;)r.push(t),t=t._parent;return r.push(t),r.reverse()},iG=async(e,t,r,n,i)=>{if(!n){let h=(0,b5.createHAMT)({hashFn:Q8e});n={rootBucket:h,hamtDepth:1,lastBucket:h}}await X8e(e.Links,n.lastBucket,n.rootBucket);let s=await n.rootBucket._findNewBucketAndPos(t),a=nG(s.pos),o=Z8e(s);o.length>n.hamtDepth&&(n.lastBucket=o[n.hamtDepth],a=nG(n.lastBucket._posAtParent));let l=e.Links.find(h=>{if(h.Name==null)return!1;let f=h.Name.substring(0,2),y=h.Name.substring(2);return!(f!==a||y&&y!==t)});if(!l)return null;if(l.Name!=null&&l.Name.substring(2)===t)return l.Hash;n.hamtDepth++;let u=await r.get(l.Hash,i);return e=Rt(u),iG(e,t,r,n,i)},oG=iG;c(),c();function J8e(e,t,r,n){let i=e.length,s=t+i;return r>=s||n<t?new Uint8Array(0):(n>=t&&n<s&&(e=e.slice(0,n-t)),r>=t&&r<s&&(e=e.slice(r-t)),e)}var xh=J8e;c();var _5=w(K(),1),eEe=(e,t,r)=>{if(t||(t=0),t<0)throw(0,_5.default)(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(t>e)throw(0,_5.default)(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!r&&r!==0&&(r=e-t),r<0)throw(0,_5.default)(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return t+r>e&&(r=e-t),{offset:t,length:r}},R0=eEe,uA=w(K(),1);zo();async function*sG(e,t,r,n,i=0,s){if(t instanceof Uint8Array){let l=xh(t,i,r,n);return l.length&&(yield l),i+=l.length,i}if(t.Data==null)throw(0,uA.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let a;try{a=Je.unmarshal(t.Data)}catch(l){throw(0,uA.default)(l,"ERR_NOT_UNIXFS")}if(a.data&&a.data.length){let l=xh(a.data,i,r,n);l.length&&(yield l),i+=a.data.length}let o=i;for(let l=0;l<t.Links.length;l++){let u=t.Links[l],h=i+a.blockSizes[l];if(r>=o&&r<h||n>o&&n<=h||r<o&&n>h){let f=await e.get(u.Hash,{signal:s.signal}),y;switch(u.Hash.code){case pt:y=await Rt(f);break;case Un:y=f;break;case qf:y=await zf(f);break;default:throw Error(`Unsupported codec: ${u.Hash.code}`)}for await(let p of sG(e,y,r,n,i,s))i+=p.length,yield p}i=h,o=h+1}}var tEe=(e,t,r,n,i,s,a)=>{function o(l={}){let u=r.fileSize();if(u===void 0)throw new Error("File was a directory");let{offset:h,length:f}=R0(u,l.offset,l.length),y=h,p=h+f;return sG(a,t,y,p,0,l)}return o},lA=tEe;c();var rEe=(e,t,r,n,i,s,a)=>{async function*o(l={}){let u=l.offset||0,h=l.length||t.Links.length,f=t.Links.slice(u,h);for(let y of f){let p=await i(y.Hash,y.Name||"",`${n}/${y.Name||""}`,[],s+1,a,l);p.entry&&(yield p.entry)}}return o},aG=rEe;c();var nEe=(e,t,r,n,i,s,a)=>{function o(l={}){return cG(t,n,i,s,a,l)}return o};async function*cG(e,t,r,n,i,s){let a=e.Links;for(let o of a){let l=o.Name!=null?o.Name.substring(2):null;if(l)yield(await r(o.Hash,l,`${t}/${l}`,[],n+1,i,s)).entry;else{let u=await i.get(o.Hash);e=Rt(u);for await(let h of cG(e,t,r,n,i,s))yield h}}}var uG=nEe,iEe=(e,t)=>{let r=e.Links.find(n=>n.Name===t);return r&&r.Hash},oEe={raw:lA,file:lA,directory:aG,"hamt-sharded-directory":uG,metadata:(e,t,r,n,i,s,a)=>()=>[],symlink:(e,t,r,n,i,s,a)=>()=>[]},sEe=async(e,t,r,n,i,s,a,o)=>{let l=await a.get(e,o),u=Rt(l),h,f;if(t||(t=e.toString()),u.Data==null)throw(0,v5.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{h=Je.unmarshal(u.Data)}catch(y){throw(0,v5.default)(y,"ERR_NOT_UNIXFS")}if(r||(r=t),n.length){let y;if(h&&h.type==="hamt-sharded-directory"?y=await oG(u,n[0],a):y=iEe(u,n[0]),!y)throw(0,v5.default)(new Error("file does not exist"),"ERR_NOT_FOUND");let p=n.shift(),v=`${r}/${p}`;f={cid:y,toResolve:n,name:p||"",path:v}}return{entry:{type:h.isDirectory()?"directory":"file",name:t,path:r,cid:e,content:oEe[h.type](e,u,h,r,i,s,a),unixfs:h,depth:s,node:u,size:h.fileSize()},next:f}},lG=sEe;c();var fG=w(K(),1),aEe=e=>{async function*t(r={}){let{offset:n,length:i}=R0(e.length,r.offset,r.length);yield xh(e,0,n,n+i)}return t},cEe=async(e,t,r,n,i,s,a,o)=>{if(n.length)throw(0,fG.default)(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");let l=await a.get(e,o);return{entry:{type:"raw",name:t,path:r,cid:e,content:aEe(l),depth:s,size:l.length,node:l}}},hG=cEe;c(),te();var dG=w(K(),1),uEe=async(e,t,r,n,i,s,a,o)=>{let l=await a.get(e),u=zf(l),h=u,f=r;for(;n.length;){let y=n[0];if(y in h){n.shift(),f=`${f}/${y}`;let p=I.asCID(h[y]);if(p)return{entry:{type:"object",name:t,path:r,cid:e,node:l,depth:s,size:l.length,content:async function*(){yield u}},next:{cid:p,name:y,path:f,toResolve:n}};h=h[y]}else throw(0,dG.default)(new Error(`No property named ${y} found in cbor node ${e}`),"ERR_NO_PROP")}return{entry:{type:"object",name:t,path:r,cid:e,node:l,depth:s,size:l.length,content:async function*(){yield u}}}},pG=uEe;c();var mG=w(K(),1);On();var lEe=e=>{async function*t(r={}){let{offset:n,length:i}=R0(e.length,r.offset,r.length);yield xh(e,0,n,n+i)}return t},fEe=async(e,t,r,n,i,s,a,o)=>{if(n.length)throw(0,mG.default)(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");let l=await _r(e.multihash.bytes);return{entry:{type:"identity",name:t,path:r,cid:e,content:lEe(l.digest),depth:s,size:l.digest.length,node:l.digest}}},yG=fEe,hEe={[pt]:lG,[Un]:hG,[qf]:pG,[$r.code]:yG};function wG(e,t,r,n,i,s,a){let o=hEe[e.code];if(!o)throw(0,gG.default)(new Error(`No resolver for code ${e.code}`),"ERR_NO_RESOLVER");return o(e,t,r,n,wG,i,s,a)}var EG=wG,bG=w(qi(),1),dEe=(e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),pEe=e=>{if(e instanceof Uint8Array)return{cid:I.decode(e),toResolve:[]};let t=I.asCID(e);if(t)return{cid:t,toResolve:[]};if(typeof e=="string"){e.indexOf("/ipfs/")===0&&(e=e.substring(6));let r=dEe(e);return{cid:I.parse(r[0]),toResolve:r.slice(1)}}throw(0,S5.default)(new Error(`Unknown path type ${e}`),"ERR_BAD_PATH")};async function*fA(e,t,r={}){let{cid:n,toResolve:i}=pEe(e),s=n.toString(),a=s,o=i.length;for(;;){let l=await EG(n,s,a,i,o,t,r);if(!l.entry&&!l.next)throw(0,S5.default)(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");if(l.entry&&(yield l.entry),!l.next)return;i=l.next.toResolve,n=l.next.cid,s=l.next.name,a=l.next.path}}async function ti(e,t,r={}){let n=await(0,bG.default)(fA(e,t,r));if(!n)throw(0,S5.default)(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");return n}async function*x5(e,t,r={}){let n=await ti(e,t,r);if(!n)return;if(yield n,n.type==="directory")for await(let s of i(n,r))yield s;async function*i(s,a){for await(let o of s.content(a))yield o,!(o instanceof Uint8Array)&&o.type==="directory"&&(yield*i(o,a))}}te();function _G({repo:e,preload:t}){async function*r(n,i={}){if(n=Bp(n),i.preload!==!1){let a=n.split("/");t(I.parse(a[0]))}let s=await ti(n,e.blocks,i);if(s.type==="directory")throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(i)}return B(r)}c();var D0=w(K(),1);te(),c(),c(),c();function Ar(){let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}c(),me(),Re();var IZe="0".charCodeAt(0),CZe=U("ustar\0","binary"),PZe=U("ustar ","binary"),DZe=U(" \0","binary");c(),c();function by(e){let t=async function*(){let r=yield,n=new qe;for await(let i of e){if(r==null){n.append(i),r=yield n,n=new qe;continue}for(n.append(i);n.length>=r;){let s=n.subarray(0,r);if(n.consume(r),r=yield s,r==null){n.length>0&&(r=yield n,n=new qe);break}}}if(r!=null)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return t.next(),t}c();var AG=w(SG(),1),TG=w(hA(),1);c(),Re();var wEe="0000000000000000000",EEe="7777777777777777777",bEe="0".charCodeAt(0),_Ee=U("ustar\0","binary"),vEe=U("00","binary"),SEe=parseInt("7777",8),xEe=257,REe=263,AEe=function(e){switch(e){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72;default:return 0}},TEe=function(e){let t=256;for(let r=0;r<148;r++)t+=e[r];for(let r=156;r<512;r++)t+=e[r];return t},El=function(e,t){let r=e.toString(8);return r.length>t?U(EEe.slice(0,t)+" "):U(wEe.slice(0,t-r.length)+r+" ")},dA=function(e){let t=U(e).byteLength,r=Math.floor(Math.log(t)/Math.log(10))+1;return t+r>=Math.pow(10,r)&&r++,`${t+r}${e}`};function RG(e){let t="";e.name!=null&&(t+=dA(" path="+e.name+`
`)),e.linkname!=null&&(t+=dA(" linkpath="+e.linkname+`
`));let r=e.pax;if(r!=null)for(let n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t+=dA(" "+n+"="+r[n]+`
`));return U(t)}function R5(e){let t=new Uint8Array(512),r=e.name,n="";if(e.typeflag===5&&r[r.length-1]!=="/"&&(r+="/"),U(r).byteLength!==r.length)return null;for(;U(r).byteLength>100;){let i=r.indexOf("/");if(i===-1)return null;n+=n!==""?"/"+r.slice(0,i):r.slice(0,i),r=r.slice(i+1)}return U(r).byteLength>100||U(n).byteLength>155||e.linkname!=null&&U(e.linkname).byteLength>100?null:(t.set(U(r),0),t.set(El(e.mode&SEe,6),100),t.set(El(e.uid,6),108),t.set(El(e.gid,6),116),t.set(El(e.size,11),124),t.set(El(e.mtime.getTime()/1e3|0,11),136),t[156]=bEe+AEe(e.type),e.linkname!=null&&t.set(U(e.linkname),157),t.set(_Ee,xEe),t.set(vEe,REe),e.uname!=null&&t.set(U(e.uname),265),e.gname!=null&&t.set(U(e.gname),297),t.set(El(e.devmajor??0,6),329),t.set(El(e.devminor??0,6),337),n!=null&&t.set(U(n),345),t.set(El(TEe(t),6),148),t)}Re(),me();var{S_IFMT:CEe,S_IFBLK:PEe,S_IFCHR:DEe,S_IFDIR:kEe,S_IFIFO:NEe,S_IFLNK:OEe}=AG.default,LEe=parseInt("755",8),BEe=parseInt("644",8),IG=new Uint8Array(1024);function MEe(e=0){switch(e&CEe){case PEe:return"block-device";case DEe:return"character-device";case kEe:return"directory";case NEe:return"fifo";case OEe:return"symlink";default:return"file"}}function mA(e){return e&=511,e!==0?IG.slice(0,512-e):new Uint8Array(0)}function pA(e){if(e.pax==null){let t=R5(e);if(t!=null)return t}return UEe(e)}function UEe(e){let t=RG(e),r={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.length,mtime:e.mtime,type:"pax-header",linkname:e.linkname,uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};return new qe(R5(r)??new Uint8Array(0),t,mA(t.length),R5({...r,size:e.size,type:e.type})??new Uint8Array(0)).slice()}function A5(){return async function*(e){for await(let{header:t,body:r}of e){let n={...t,size:t.type==="symlink"?0:t.size??0,type:t.type??MEe(t.mode),mode:t.mode??(t.type==="directory"?LEe:BEe),uid:t.uid??0,gid:t.gid??0,mtime:t.mtime??new Date};if(typeof r=="string"&&(r=U(r)),r instanceof Uint8Array||tl(r)){n.size=r.length,yield pA(n),yield tl(r)?r.slice():r,yield mA(n.size);continue}if(n.type==="symlink"&&n.linkname==null){if(r==null)throw new Error("type was symlink but no linkname or body specified");n.linkname=M(await(0,TG.default)(r)),yield pA(n);continue}if(yield pA(n),n.type!=="file"&&n.type!=="contiguous-file")continue;let i=0;for await(let s of r??[])i+=s.length,yield tl(s)?s.slice():s;if(i!==n.size)throw new Error(`size mismatch, wrote ${i} of ${n.size} bytes`);yield mA(n.size)}yield IG}}c();function C0(e){let t=e.length;for(;--t>=0;)e[t]=0}var FEe=0,dW=1,KEe=2,VEe=3,qEe=258,OA=29,Ly=256,Ty=Ly+1+OA,I0=30,LA=19,pW=2*Ty+1,Rh=15,yA=16,zEe=7,BA=256,mW=16,yW=17,gW=18,PA=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),k5=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),HEe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),wW=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$Ee=512,Hc=new Array((Ty+2)*2);C0(Hc);var xy=new Array(I0*2);C0(xy);var Iy=new Array($Ee);C0(Iy);var Cy=new Array(qEe-VEe+1);C0(Cy);var MA=new Array(OA);C0(MA);var B5=new Array(I0);C0(B5);function gA(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}var EW,bW,_W;function wA(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}var vW=e=>e<256?Iy[e]:Iy[256+(e>>>7)],Py=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},ji=(e,t,r)=>{e.bi_valid>yA-r?(e.bi_buf|=t<<e.bi_valid&65535,Py(e,e.bi_buf),e.bi_buf=t>>yA-e.bi_valid,e.bi_valid+=r-yA):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Ma=(e,t,r)=>{ji(e,r[t*2],r[t*2+1])},SW=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},GEe=e=>{e.bi_valid===16?(Py(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},WEe=(e,t)=>{let r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length,u,h,f,y,p,v,d=0;for(y=0;y<=Rh;y++)e.bl_count[y]=0;for(r[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<pW;u++)h=e.heap[u],y=r[r[h*2+1]*2+1]+1,y>l&&(y=l,d++),r[h*2+1]=y,!(h>n)&&(e.bl_count[y]++,p=0,h>=o&&(p=a[h-o]),v=r[h*2],e.opt_len+=v*(y+p),s&&(e.static_len+=v*(i[h*2+1]+p)));if(d!==0){do{for(y=l-1;e.bl_count[y]===0;)y--;e.bl_count[y]--,e.bl_count[y+1]+=2,e.bl_count[l]--,d-=2}while(d>0);for(y=l;y!==0;y--)for(h=e.bl_count[y];h!==0;)f=e.heap[--u],!(f>n)&&(r[f*2+1]!==y&&(e.opt_len+=(y-r[f*2+1])*r[f*2],r[f*2+1]=y),h--)}},xW=(e,t,r)=>{let n=new Array(Rh+1),i=0,s,a;for(s=1;s<=Rh;s++)n[s]=i=i+r[s-1]<<1;for(a=0;a<=t;a++){let o=e[a*2+1];o!==0&&(e[a*2]=SW(n[o]++,o))}},jEe=()=>{let e,t,r,n,i,s=new Array(Rh+1);for(r=0,n=0;n<OA-1;n++)for(MA[n]=r,e=0;e<1<<PA[n];e++)Cy[r++]=n;for(Cy[r-1]=n,i=0,n=0;n<16;n++)for(B5[n]=i,e=0;e<1<<k5[n];e++)Iy[i++]=n;for(i>>=7;n<I0;n++)for(B5[n]=i<<7,e=0;e<1<<k5[n]-7;e++)Iy[256+i++]=n;for(t=0;t<=Rh;t++)s[t]=0;for(e=0;e<=143;)Hc[e*2+1]=8,e++,s[8]++;for(;e<=255;)Hc[e*2+1]=9,e++,s[9]++;for(;e<=279;)Hc[e*2+1]=7,e++,s[7]++;for(;e<=287;)Hc[e*2+1]=8,e++,s[8]++;for(xW(Hc,Ty+1,s),e=0;e<I0;e++)xy[e*2+1]=5,xy[e*2]=SW(e,5);EW=new gA(Hc,PA,Ly+1,Ty,Rh),bW=new gA(xy,k5,0,I0,Rh),_W=new gA(new Array(0),HEe,0,LA,zEe)},RW=e=>{let t;for(t=0;t<Ty;t++)e.dyn_ltree[t*2]=0;for(t=0;t<I0;t++)e.dyn_dtree[t*2]=0;for(t=0;t<LA;t++)e.bl_tree[t*2]=0;e.dyn_ltree[BA*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},AW=e=>{e.bi_valid>8?Py(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},YEe=(e,t,r,n)=>{AW(e),n&&(Py(e,r),Py(e,~r)),e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},CG=(e,t,r,n)=>{let i=t*2,s=r*2;return e[i]<e[s]||e[i]===e[s]&&n[t]<=n[r]},EA=(e,t,r)=>{let n=e.heap[r],i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&CG(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!CG(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},PG=(e,t,r)=>{let n,i,s=0,a,o;if(e.last_lit!==0)do n=e.pending_buf[e.d_buf+s*2]<<8|e.pending_buf[e.d_buf+s*2+1],i=e.pending_buf[e.l_buf+s],s++,n===0?Ma(e,i,t):(a=Cy[i],Ma(e,a+Ly+1,t),o=PA[a],o!==0&&(i-=MA[a],ji(e,i,o)),n--,a=vW(n),Ma(e,a,r),o=k5[a],o!==0&&(n-=B5[a],ji(e,n,o)));while(s<e.last_lit);Ma(e,BA,t)},DA=(e,t)=>{let r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems,a,o,l=-1,u;for(e.heap_len=0,e.heap_max=pW,a=0;a<s;a++)r[a*2]!==0?(e.heap[++e.heap_len]=l=a,e.depth[a]=0):r[a*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=l<2?++l:0,r[u*2]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=n[u*2+1]);for(t.max_code=l,a=e.heap_len>>1;a>=1;a--)EA(e,r,a);u=s;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],EA(e,r,1),o=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=o,r[u*2]=r[a*2]+r[o*2],e.depth[u]=(e.depth[a]>=e.depth[o]?e.depth[a]:e.depth[o])+1,r[a*2+1]=r[o*2+1]=u,e.heap[1]=u++,EA(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],WEe(e,t),xW(r,l,e.bl_count)},DG=(e,t,r)=>{let n,i=-1,s,a=t[0*2+1],o=0,l=7,u=4;for(a===0&&(l=138,u=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)s=a,a=t[(n+1)*2+1],!(++o<l&&s===a)&&(o<u?e.bl_tree[s*2]+=o:s!==0?(s!==i&&e.bl_tree[s*2]++,e.bl_tree[mW*2]++):o<=10?e.bl_tree[yW*2]++:e.bl_tree[gW*2]++,o=0,i=s,a===0?(l=138,u=3):s===a?(l=6,u=3):(l=7,u=4))},kG=(e,t,r)=>{let n,i=-1,s,a=t[0*2+1],o=0,l=7,u=4;for(a===0&&(l=138,u=3),n=0;n<=r;n++)if(s=a,a=t[(n+1)*2+1],!(++o<l&&s===a)){if(o<u)do Ma(e,s,e.bl_tree);while(--o!==0);else s!==0?(s!==i&&(Ma(e,s,e.bl_tree),o--),Ma(e,mW,e.bl_tree),ji(e,o-3,2)):o<=10?(Ma(e,yW,e.bl_tree),ji(e,o-3,3)):(Ma(e,gW,e.bl_tree),ji(e,o-11,7));o=0,i=s,a===0?(l=138,u=3):s===a?(l=6,u=3):(l=7,u=4)}},QEe=e=>{let t;for(DG(e,e.dyn_ltree,e.l_desc.max_code),DG(e,e.dyn_dtree,e.d_desc.max_code),DA(e,e.bl_desc),t=LA-1;t>=3&&e.bl_tree[wW[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},XEe=(e,t,r,n)=>{let i;for(ji(e,t-257,5),ji(e,r-1,5),ji(e,n-4,4),i=0;i<n;i++)ji(e,e.bl_tree[wW[i]*2+1],3);kG(e,e.dyn_ltree,t-1),kG(e,e.dyn_dtree,r-1)},ZEe=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return 0;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return 1;for(r=32;r<Ly;r++)if(e.dyn_ltree[r*2]!==0)return 1;return 0},NG=!1,JEe=e=>{NG||(jEe(),NG=!0),e.l_desc=new wA(e.dyn_ltree,EW),e.d_desc=new wA(e.dyn_dtree,bW),e.bl_desc=new wA(e.bl_tree,_W),e.bi_buf=0,e.bi_valid=0,RW(e)},TW=(e,t,r,n)=>{ji(e,(FEe<<1)+(n?1:0),3),YEe(e,t,r,!0)},ebe=e=>{ji(e,dW<<1,3),Ma(e,BA,Hc),GEe(e)},tbe=(e,t,r,n)=>{let i,s,a=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=ZEe(e)),DA(e,e.l_desc),DA(e,e.d_desc),a=QEe(e),i=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=i&&(i=s)):i=s=r+5,r+4<=i&&t!==-1?TW(e,t,r,n):e.strategy===4||s===i?(ji(e,(dW<<1)+(n?1:0),3),PG(e,Hc,xy)):(ji(e,(KEe<<1)+(n?1:0),3),XEe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),PG(e,e.dyn_ltree,e.dyn_dtree)),RW(e),n&&AW(e)},rbe=(e,t,r)=>(e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=r&255,e.last_lit++,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(Cy[r]+Ly+1)*2]++,e.dyn_dtree[vW(t)*2]++),e.last_lit===e.lit_bufsize-1),nbe=JEe,ibe=TW,obe=tbe,sbe=rbe,abe=ebe,cbe={_tr_init:nbe,_tr_stored_block:ibe,_tr_flush_block:obe,_tr_tally:sbe,_tr_align:abe},ube=(e,t,r,n)=>{let i=e&65535|0,s=e>>>16&65535|0,a=0;for(;r!==0;){a=r>2e3?2e3:r,r-=a;do i=i+t[n++]|0,s=s+i|0;while(--a);i%=65521,s%=65521}return i|s<<16|0},Dy=ube,lbe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},fbe=new Uint32Array(lbe()),hbe=(e,t,r,n)=>{let i=fbe,s=n+r;e^=-1;for(let a=n;a<s;a++)e=e>>>8^i[(e^t[a])&255];return e^-1},Hn=hbe,Th={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Dh={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:dbe,_tr_stored_block:pbe,_tr_flush_block:mbe,_tr_tally:xl,_tr_align:ybe}=cbe,{Z_NO_FLUSH:kh,Z_PARTIAL_FLUSH:gbe,Z_FULL_FLUSH:wbe,Z_FINISH:Rl,Z_BLOCK:OG,Z_OK:Ua,Z_STREAM_END:LG,Z_STREAM_ERROR:ts,Z_DATA_ERROR:Ebe,Z_BUF_ERROR:bA,Z_DEFAULT_COMPRESSION:bbe,Z_FILTERED:_be,Z_HUFFMAN_ONLY:T5,Z_RLE:vbe,Z_FIXED:Sbe,Z_DEFAULT_STRATEGY:xbe,Z_UNKNOWN:Rbe,Z_DEFLATED:F5}=Dh,Abe=9,Tbe=15,Ibe=8,Cbe=29,Pbe=256,kA=Pbe+1+Cbe,Dbe=30,kbe=19,Nbe=2*kA+1,Obe=15,It=3,vl=258,Gs=vl+It+1,Lbe=32,K5=42,NA=69,N5=73,O5=91,L5=103,Ah=113,vy=666,Cn=1,By=2,Ih=3,P0=4,Bbe=3,Sl=(e,t)=>(e.msg=Th[t],t),BG=e=>(e<<1)-(e>4?9:0),_l=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Mbe=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,Al=Mbe,bl=e=>{let t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},ri=(e,t)=>{mbe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,bl(e.strm)},zt=(e,t)=>{e.pending_buf[e.pending++]=t},_y=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},Ube=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),e.state.wrap===1?e.adler=Dy(e.adler,t,i,r):e.state.wrap===2&&(e.adler=Hn(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},IW=(e,t)=>{let r=e.max_chain_length,n=e.strstart,i,s,a=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-Gs?e.strstart-(e.w_size-Gs):0,u=e.window,h=e.w_mask,f=e.prev,y=e.strstart+vl,p=u[n+a-1],v=u[n+a];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do if(i=t,!(u[i+a]!==v||u[i+a-1]!==p||u[i]!==u[n]||u[++i]!==u[n+1])){n+=2,i++;do;while(u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&n<y);if(s=vl-(y-n),n=y-vl,s>a){if(e.match_start=t,a=s,s>=o)break;p=u[n+a-1],v=u[n+a]}}while((t=f[t&h])>l&&--r!==0);return a<=e.lookahead?a:e.lookahead},Ch=e=>{let t=e.w_size,r,n,i,s,a;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Gs)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,n=e.hash_size,r=n;do i=e.head[--r],e.head[r]=i>=t?i-t:0;while(--n);n=t,r=n;do i=e.prev[--r],e.prev[r]=i>=t?i-t:0;while(--n);s+=t}if(e.strm.avail_in===0)break;if(n=Ube(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=n,e.lookahead+e.insert>=It)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=Al(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=Al(e,e.ins_h,e.window[a+It-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<It)););}while(e.lookahead<Gs&&e.strm.avail_in!==0)},Fbe=(e,t)=>{let r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Ch(e),e.lookahead===0&&t===kh)return Cn;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;let n=e.block_start+r;if((e.strstart===0||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,ri(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-Gs&&(ri(e,!1),e.strm.avail_out===0))return Cn}return e.insert=0,t===Rl?(ri(e,!0),e.strm.avail_out===0?Ih:P0):(e.strstart>e.block_start&&(ri(e,!1),e.strm.avail_out),Cn)},_A=(e,t)=>{let r,n;for(;;){if(e.lookahead<Gs){if(Ch(e),e.lookahead<Gs&&t===kh)return Cn;if(e.lookahead===0)break}if(r=0,e.lookahead>=It&&(e.ins_h=Al(e,e.ins_h,e.window[e.strstart+It-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Gs&&(e.match_length=IW(e,r)),e.match_length>=It)if(n=xl(e,e.strstart-e.match_start,e.match_length-It),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=It){e.match_length--;do e.strstart++,e.ins_h=Al(e,e.ins_h,e.window[e.strstart+It-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Al(e,e.ins_h,e.window[e.strstart+1]);else n=xl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(ri(e,!1),e.strm.avail_out===0))return Cn}return e.insert=e.strstart<It-1?e.strstart:It-1,t===Rl?(ri(e,!0),e.strm.avail_out===0?Ih:P0):e.last_lit&&(ri(e,!1),e.strm.avail_out===0)?Cn:By},A0=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<Gs){if(Ch(e),e.lookahead<Gs&&t===kh)return Cn;if(e.lookahead===0)break}if(r=0,e.lookahead>=It&&(e.ins_h=Al(e,e.ins_h,e.window[e.strstart+It-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=It-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Gs&&(e.match_length=IW(e,r),e.match_length<=5&&(e.strategy===_be||e.match_length===It&&e.strstart-e.match_start>4096)&&(e.match_length=It-1)),e.prev_length>=It&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-It,n=xl(e,e.strstart-1-e.prev_match,e.prev_length-It),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=Al(e,e.ins_h,e.window[e.strstart+It-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=It-1,e.strstart++,n&&(ri(e,!1),e.strm.avail_out===0))return Cn}else if(e.match_available){if(n=xl(e,0,e.window[e.strstart-1]),n&&ri(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Cn}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=xl(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<It-1?e.strstart:It-1,t===Rl?(ri(e,!0),e.strm.avail_out===0?Ih:P0):e.last_lit&&(ri(e,!1),e.strm.avail_out===0)?Cn:By},Kbe=(e,t)=>{let r,n,i,s,a=e.window;for(;;){if(e.lookahead<=vl){if(Ch(e),e.lookahead<=vl&&t===kh)return Cn;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=It&&e.strstart>0&&(i=e.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){s=e.strstart+vl;do;while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<s);e.match_length=vl-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=It?(r=xl(e,1,e.match_length-It),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=xl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(ri(e,!1),e.strm.avail_out===0))return Cn}return e.insert=0,t===Rl?(ri(e,!0),e.strm.avail_out===0?Ih:P0):e.last_lit&&(ri(e,!1),e.strm.avail_out===0)?Cn:By},Vbe=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(Ch(e),e.lookahead===0)){if(t===kh)return Cn;break}if(e.match_length=0,r=xl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(ri(e,!1),e.strm.avail_out===0))return Cn}return e.insert=0,t===Rl?(ri(e,!0),e.strm.avail_out===0?Ih:P0):e.last_lit&&(ri(e,!1),e.strm.avail_out===0)?Cn:By};function Ba(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}var Sy=[new Ba(0,0,0,0,Fbe),new Ba(4,4,8,4,_A),new Ba(4,5,16,8,_A),new Ba(4,6,32,32,_A),new Ba(4,4,16,16,A0),new Ba(8,16,32,32,A0),new Ba(8,16,128,128,A0),new Ba(8,32,128,256,A0),new Ba(32,128,258,1024,A0),new Ba(32,258,258,4096,A0)],qbe=e=>{e.window_size=2*e.w_size,_l(e.head),e.max_lazy_match=Sy[e.level].max_lazy,e.good_match=Sy[e.level].good_length,e.nice_match=Sy[e.level].nice_length,e.max_chain_length=Sy[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=It-1,e.match_available=0,e.ins_h=0};function zbe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=F5,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Nbe*2),this.dyn_dtree=new Uint16Array((2*Dbe+1)*2),this.bl_tree=new Uint16Array((2*kbe+1)*2),_l(this.dyn_ltree),_l(this.dyn_dtree),_l(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Obe+1),this.heap=new Uint16Array(2*kA+1),_l(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*kA+1),_l(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var CW=e=>{if(!e||!e.state)return Sl(e,ts);e.total_in=e.total_out=0,e.data_type=Rbe;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?K5:Ah,e.adler=t.wrap===2?0:1,t.last_flush=kh,dbe(t),Ua},PW=e=>{let t=CW(e);return t===Ua&&qbe(e.state),t},Hbe=(e,t)=>!e||!e.state||e.state.wrap!==2?ts:(e.state.gzhead=t,Ua),DW=(e,t,r,n,i,s)=>{if(!e)return ts;let a=1;if(t===bbe&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>Abe||r!==F5||n<8||n>15||t<0||t>9||s<0||s>Sbe)return Sl(e,ts);n===8&&(n=9);let o=new zbe;return e.state=o,o.strm=e,o.wrap=a,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+It-1)/It),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=(1+2)*o.lit_bufsize,o.level=t,o.strategy=s,o.method=r,PW(e)},$be=(e,t)=>DW(e,t,F5,Tbe,Ibe,xbe),Gbe=(e,t)=>{let r,n;if(!e||!e.state||t>OG||t<0)return e?Sl(e,ts):ts;let i=e.state;if(!e.output||!e.input&&e.avail_in!==0||i.status===vy&&t!==Rl)return Sl(e,e.avail_out===0?bA:ts);i.strm=e;let s=i.last_flush;if(i.last_flush=t,i.status===K5)if(i.wrap===2)e.adler=0,zt(i,31),zt(i,139),zt(i,8),i.gzhead?(zt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),zt(i,i.gzhead.time&255),zt(i,i.gzhead.time>>8&255),zt(i,i.gzhead.time>>16&255),zt(i,i.gzhead.time>>24&255),zt(i,i.level===9?2:i.strategy>=T5||i.level<2?4:0),zt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(zt(i,i.gzhead.extra.length&255),zt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=Hn(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=NA):(zt(i,0),zt(i,0),zt(i,0),zt(i,0),zt(i,0),zt(i,i.level===9?2:i.strategy>=T5||i.level<2?4:0),zt(i,Bbe),i.status=Ah);else{let a=F5+(i.w_bits-8<<4)<<8,o=-1;i.strategy>=T5||i.level<2?o=0:i.level<6?o=1:i.level===6?o=2:o=3,a|=o<<6,i.strstart!==0&&(a|=Lbe),a+=31-a%31,i.status=Ah,_y(i,a),i.strstart!==0&&(_y(i,e.adler>>>16),_y(i,e.adler&65535)),e.adler=1}if(i.status===NA)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=Hn(e.adler,i.pending_buf,i.pending-r,r)),bl(e),r=i.pending,i.pending===i.pending_buf_size));)zt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(e.adler=Hn(e.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=N5)}else i.status=N5;if(i.status===N5)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=Hn(e.adler,i.pending_buf,i.pending-r,r)),bl(e),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,zt(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(e.adler=Hn(e.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.gzindex=0,i.status=O5)}else i.status=O5;if(i.status===O5)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=Hn(e.adler,i.pending_buf,i.pending-r,r)),bl(e),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,zt(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(e.adler=Hn(e.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.status=L5)}else i.status=L5;if(i.status===L5&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&bl(e),i.pending+2<=i.pending_buf_size&&(zt(i,e.adler&255),zt(i,e.adler>>8&255),e.adler=0,i.status=Ah)):i.status=Ah),i.pending!==0){if(bl(e),e.avail_out===0)return i.last_flush=-1,Ua}else if(e.avail_in===0&&BG(t)<=BG(s)&&t!==Rl)return Sl(e,bA);if(i.status===vy&&e.avail_in!==0)return Sl(e,bA);if(e.avail_in!==0||i.lookahead!==0||t!==kh&&i.status!==vy){let a=i.strategy===T5?Vbe(i,t):i.strategy===vbe?Kbe(i,t):Sy[i.level].func(i,t);if((a===Ih||a===P0)&&(i.status=vy),a===Cn||a===Ih)return e.avail_out===0&&(i.last_flush=-1),Ua;if(a===By&&(t===gbe?ybe(i):t!==OG&&(pbe(i,0,0,!1),t===wbe&&(_l(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),bl(e),e.avail_out===0))return i.last_flush=-1,Ua}return t!==Rl?Ua:i.wrap<=0?LG:(i.wrap===2?(zt(i,e.adler&255),zt(i,e.adler>>8&255),zt(i,e.adler>>16&255),zt(i,e.adler>>24&255),zt(i,e.total_in&255),zt(i,e.total_in>>8&255),zt(i,e.total_in>>16&255),zt(i,e.total_in>>24&255)):(_y(i,e.adler>>>16),_y(i,e.adler&65535)),bl(e),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Ua:LG)},Wbe=e=>{if(!e||!e.state)return ts;let t=e.state.status;return t!==K5&&t!==NA&&t!==N5&&t!==O5&&t!==L5&&t!==Ah&&t!==vy?Sl(e,ts):(e.state=null,t===Ah?Sl(e,Ebe):Ua)},jbe=(e,t)=>{let r=t.length;if(!e||!e.state)return ts;let n=e.state,i=n.wrap;if(i===2||i===1&&n.status!==K5||n.lookahead)return ts;if(i===1&&(e.adler=Dy(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){i===0&&(_l(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(t.subarray(r-n.w_size,r),0),t=l,r=n.w_size}let s=e.avail_in,a=e.next_in,o=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Ch(n);n.lookahead>=It;){let l=n.strstart,u=n.lookahead-(It-1);do n.ins_h=Al(n,n.ins_h,n.window[l+It-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--u);n.strstart=l,n.lookahead=It-1,Ch(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=It-1,n.match_available=0,e.next_in=a,e.input=o,e.avail_in=s,n.wrap=i,Ua},Ybe=$be,Qbe=DW,Xbe=PW,Zbe=CW,Jbe=Hbe,e_e=Gbe,t_e=Wbe,r_e=jbe,n_e="pako deflate (from Nodeca project)",Ry={deflateInit:Ybe,deflateInit2:Qbe,deflateReset:Xbe,deflateResetKeep:Zbe,deflateSetHeader:Jbe,deflate:e_e,deflateEnd:t_e,deflateSetDictionary:r_e,deflateInfo:n_e},i_e=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o_e=function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(let n in r)i_e(r,n)&&(e[n]=r[n])}}return e},s_e=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;let r=new Uint8Array(t);for(let n=0,i=0,s=e.length;n<s;n++){let a=e[n];r.set(a,i),i+=a.length}return r},V5={assign:o_e,flattenChunks:s_e},kW=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{kW=!1}var ky=new Uint8Array(256);for(let e=0;e<256;e++)ky[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;ky[254]=ky[254]=1;var a_e=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,s,a=e.length,o=0;for(i=0;i<a;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<a&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),s=0,i=0;s<o;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<a&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t},c_e=(e,t)=>{if(t<65534&&e.subarray&&kW)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r},u_e=(e,t)=>{let r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i,s=new Array(r*2);for(i=0,n=0;n<r;){let a=e[n++];if(a<128){s[i++]=a;continue}let o=ky[a];if(o>4){s[i++]=65533,n+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&n<r;)a=a<<6|e[n++]&63,o--;if(o>1){s[i++]=65533;continue}a<65536?s[i++]=a:(a-=65536,s[i++]=55296|a>>10&1023,s[i++]=56320|a&1023)}return c_e(s,i)},l_e=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+ky[e[r]]>t?r:t},Ny={string2buf:a_e,buf2string:u_e,utf8border:l_e};function f_e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var NW=f_e,OW=Object.prototype.toString,{Z_NO_FLUSH:h_e,Z_SYNC_FLUSH:d_e,Z_FULL_FLUSH:p_e,Z_FINISH:m_e,Z_OK:M5,Z_STREAM_END:y_e,Z_DEFAULT_COMPRESSION:g_e,Z_DEFAULT_STRATEGY:w_e,Z_DEFLATED:E_e}=Dh;function My(e){this.options=V5.assign({level:g_e,method:E_e,chunkSize:16384,windowBits:15,memLevel:8,strategy:w_e},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new NW,this.strm.avail_out=0;let r=Ry.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==M5)throw new Error(Th[r]);if(t.header&&Ry.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=Ny.string2buf(t.dictionary):OW.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=Ry.deflateSetDictionary(this.strm,n),r!==M5)throw new Error(Th[r]);this._dict_set=!0}}My.prototype.push=function(e,t){let r=this.strm,n=this.options.chunkSize,i,s;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?m_e:h_e,typeof e=="string"?r.input=Ny.string2buf(e):OW.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(s===d_e||s===p_e)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=Ry.deflate(r,s),i===y_e)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=Ry.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===M5;if(r.avail_out===0){this.onData(r.output);continue}if(s>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0},My.prototype.onData=function(e){this.chunks.push(e)},My.prototype.onEnd=function(e){e===M5&&(this.result=V5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function UA(e,t){let r=new My(t);if(r.push(e,!0),r.err)throw r.msg||Th[r.err];return r.result}function b_e(e,t){return t=t||{},t.raw=!0,UA(e,t)}function __e(e,t){return t=t||{},t.gzip=!0,UA(e,t)}var v_e=My,S_e=UA,x_e=b_e,R_e=__e,A_e=Dh,T_e={Deflate:v_e,deflate:S_e,deflateRaw:x_e,gzip:R_e,constants:A_e},I5=30,I_e=12,C_e=function(e,t){let r,n,i,s,a,o,l,u,h,f,y,p,v,d,g,b,_,m,E,D,N,R,T,S,O=e.state;r=e.next_in,T=e.input,n=r+(e.avail_in-5),i=e.next_out,S=e.output,s=i-(t-e.avail_out),a=i+(e.avail_out-257),o=O.dmax,l=O.wsize,u=O.whave,h=O.wnext,f=O.window,y=O.hold,p=O.bits,v=O.lencode,d=O.distcode,g=(1<<O.lenbits)-1,b=(1<<O.distbits)-1;e:do{p<15&&(y+=T[r++]<<p,p+=8,y+=T[r++]<<p,p+=8),_=v[y&g];t:for(;;){if(m=_>>>24,y>>>=m,p-=m,m=_>>>16&255,m===0)S[i++]=_&65535;else if(m&16){E=_&65535,m&=15,m&&(p<m&&(y+=T[r++]<<p,p+=8),E+=y&(1<<m)-1,y>>>=m,p-=m),p<15&&(y+=T[r++]<<p,p+=8,y+=T[r++]<<p,p+=8),_=d[y&b];r:for(;;){if(m=_>>>24,y>>>=m,p-=m,m=_>>>16&255,m&16){if(D=_&65535,m&=15,p<m&&(y+=T[r++]<<p,p+=8,p<m&&(y+=T[r++]<<p,p+=8)),D+=y&(1<<m)-1,D>o){e.msg="invalid distance too far back",O.mode=I5;break e}if(y>>>=m,p-=m,m=i-s,D>m){if(m=D-m,m>u&&O.sane){e.msg="invalid distance too far back",O.mode=I5;break e}if(N=0,R=f,h===0){if(N+=l-m,m<E){E-=m;do S[i++]=f[N++];while(--m);N=i-D,R=S}}else if(h<m){if(N+=l+h-m,m-=h,m<E){E-=m;do S[i++]=f[N++];while(--m);if(N=0,h<E){m=h,E-=m;do S[i++]=f[N++];while(--m);N=i-D,R=S}}}else if(N+=h-m,m<E){E-=m;do S[i++]=f[N++];while(--m);N=i-D,R=S}for(;E>2;)S[i++]=R[N++],S[i++]=R[N++],S[i++]=R[N++],E-=3;E&&(S[i++]=R[N++],E>1&&(S[i++]=R[N++]))}else{N=i-D;do S[i++]=S[N++],S[i++]=S[N++],S[i++]=S[N++],E-=3;while(E>2);E&&(S[i++]=S[N++],E>1&&(S[i++]=S[N++]))}}else if((m&64)===0){_=d[(_&65535)+(y&(1<<m)-1)];continue r}else{e.msg="invalid distance code",O.mode=I5;break e}break}}else if((m&64)===0){_=v[(_&65535)+(y&(1<<m)-1)];continue t}else if(m&32){O.mode=I_e;break e}else{e.msg="invalid literal/length code",O.mode=I5;break e}break}}while(r<n&&i<a);E=p>>3,r-=E,p-=E<<3,y&=(1<<p)-1,e.next_in=r,e.next_out=i,e.avail_in=r<n?5+(n-r):5-(r-n),e.avail_out=i<a?257+(a-i):257-(i-a),O.hold=y,O.bits=p},T0=15,MG=852,UG=592,FG=0,vA=1,KG=2,P_e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),D_e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),k_e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),N_e=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),O_e=(e,t,r,n,i,s,a,o)=>{let l=o.bits,u=0,h=0,f=0,y=0,p=0,v=0,d=0,g=0,b=0,_=0,m,E,D,N,R,T=null,S=0,O,F=new Uint16Array(T0+1),G=new Uint16Array(T0+1),ne=null,Y=0,ce,oe,H;for(u=0;u<=T0;u++)F[u]=0;for(h=0;h<n;h++)F[t[r+h]]++;for(p=l,y=T0;y>=1&&F[y]===0;y--);if(p>y&&(p=y),y===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,o.bits=1,0;for(f=1;f<y&&F[f]===0;f++);for(p<f&&(p=f),g=1,u=1;u<=T0;u++)if(g<<=1,g-=F[u],g<0)return-1;if(g>0&&(e===FG||y!==1))return-1;for(G[1]=0,u=1;u<T0;u++)G[u+1]=G[u]+F[u];for(h=0;h<n;h++)t[r+h]!==0&&(a[G[t[r+h]]++]=h);if(e===FG?(T=ne=a,O=19):e===vA?(T=P_e,S-=257,ne=D_e,Y-=257,O=256):(T=k_e,ne=N_e,O=-1),_=0,h=0,u=f,R=s,v=p,d=0,D=-1,b=1<<p,N=b-1,e===vA&&b>MG||e===KG&&b>UG)return 1;for(;;){ce=u-d,a[h]<O?(oe=0,H=a[h]):a[h]>O?(oe=ne[Y+a[h]],H=T[S+a[h]]):(oe=32+64,H=0),m=1<<u-d,E=1<<v,f=E;do E-=m,i[R+(_>>d)+E]=ce<<24|oe<<16|H|0;while(E!==0);for(m=1<<u-1;_&m;)m>>=1;if(m!==0?(_&=m-1,_+=m):_=0,h++,--F[u]===0){if(u===y)break;u=t[r+a[h]]}if(u>p&&(_&N)!==D){for(d===0&&(d=p),R+=f,v=u-d,g=1<<v;v+d<y&&(g-=F[v+d],!(g<=0));)v++,g<<=1;if(b+=1<<v,e===vA&&b>MG||e===KG&&b>UG)return 1;D=_&N,i[D]=p<<24|v<<16|R-s|0}}return _!==0&&(i[R+_]=u-d<<24|64<<16|0),o.bits=p,0},Ay=O_e,L_e=0,LW=1,BW=2,{Z_FINISH:VG,Z_BLOCK:B_e,Z_TREES:C5,Z_OK:Ph,Z_STREAM_END:M_e,Z_NEED_DICT:U_e,Z_STREAM_ERROR:rs,Z_DATA_ERROR:MW,Z_MEM_ERROR:UW,Z_BUF_ERROR:F_e,Z_DEFLATED:qG}=Dh,FW=1,zG=2,HG=3,$G=4,GG=5,WG=6,jG=7,YG=8,QG=9,XG=10,U5=11,zc=12,SA=13,ZG=14,xA=15,JG=16,eW=17,tW=18,rW=19,P5=20,D5=21,nW=22,iW=23,oW=24,sW=25,aW=26,RA=27,cW=28,uW=29,Or=30,KW=31,K_e=32,V_e=852,q_e=592,z_e=15,H_e=z_e,lW=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function $_e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var VW=e=>{if(!e||!e.state)return rs;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=FW,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(V_e),t.distcode=t.distdyn=new Int32Array(q_e),t.sane=1,t.back=-1,Ph},qW=e=>{if(!e||!e.state)return rs;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,VW(e)},zW=(e,t)=>{let r;if(!e||!e.state)return rs;let n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?rs:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,qW(e))},HW=(e,t)=>{if(!e)return rs;let r=new $_e;e.state=r,r.window=null;let n=zW(e,t);return n!==Ph&&(e.state=null),n},G_e=e=>HW(e,H_e),fW=!0,AA,TA,W_e=e=>{if(fW){AA=new Int32Array(512),TA=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ay(LW,e.lens,0,288,AA,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ay(BW,e.lens,0,32,TA,0,e.work,{bits:5}),fW=!1}e.lencode=AA,e.lenbits=9,e.distcode=TA,e.distbits=5},$W=(e,t,r,n)=>{let i,s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>n&&(i=n),s.window.set(t.subarray(r-n,r-n+i),s.wnext),n-=i,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},j_e=(e,t)=>{let r,n,i,s,a,o,l,u,h,f,y,p,v,d,g=0,b,_,m,E,D,N,R,T,S=new Uint8Array(4),O,F,G=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return rs;r=e.state,r.mode===zc&&(r.mode=SA),a=e.next_out,i=e.output,l=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,u=r.hold,h=r.bits,f=o,y=l,T=Ph;e:for(;;)switch(r.mode){case FW:if(r.wrap===0){r.mode=SA;break}for(;h<16;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}if(r.wrap&2&&u===35615){r.check=0,S[0]=u&255,S[1]=u>>>8&255,r.check=Hn(r.check,S,2,0),u=0,h=0,r.mode=zG;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=Or;break}if((u&15)!==qG){e.msg="unknown compression method",r.mode=Or;break}if(u>>>=4,h-=4,R=(u&15)+8,r.wbits===0)r.wbits=R;else if(R>r.wbits){e.msg="invalid window size",r.mode=Or;break}r.dmax=1<<r.wbits,e.adler=r.check=1,r.mode=u&512?XG:zc,u=0,h=0;break;case zG:for(;h<16;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}if(r.flags=u,(r.flags&255)!==qG){e.msg="unknown compression method",r.mode=Or;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Or;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&(S[0]=u&255,S[1]=u>>>8&255,r.check=Hn(r.check,S,2,0)),u=0,h=0,r.mode=HG;case HG:for(;h<32;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}r.head&&(r.head.time=u),r.flags&512&&(S[0]=u&255,S[1]=u>>>8&255,S[2]=u>>>16&255,S[3]=u>>>24&255,r.check=Hn(r.check,S,4,0)),u=0,h=0,r.mode=$G;case $G:for(;h<16;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&(S[0]=u&255,S[1]=u>>>8&255,r.check=Hn(r.check,S,2,0)),u=0,h=0,r.mode=GG;case GG:if(r.flags&1024){for(;h<16;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&(S[0]=u&255,S[1]=u>>>8&255,r.check=Hn(r.check,S,2,0)),u=0,h=0}else r.head&&(r.head.extra=null);r.mode=WG;case WG:if(r.flags&1024&&(p=r.length,p>o&&(p=o),p&&(r.head&&(R=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+p),R)),r.flags&512&&(r.check=Hn(r.check,n,p,s)),o-=p,s+=p,r.length-=p),r.length))break e;r.length=0,r.mode=jG;case jG:if(r.flags&2048){if(o===0)break e;p=0;do R=n[s+p++],r.head&&R&&r.length<65536&&(r.head.name+=String.fromCharCode(R));while(R&&p<o);if(r.flags&512&&(r.check=Hn(r.check,n,p,s)),o-=p,s+=p,R)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=YG;case YG:if(r.flags&4096){if(o===0)break e;p=0;do R=n[s+p++],r.head&&R&&r.length<65536&&(r.head.comment+=String.fromCharCode(R));while(R&&p<o);if(r.flags&512&&(r.check=Hn(r.check,n,p,s)),o-=p,s+=p,R)break e}else r.head&&(r.head.comment=null);r.mode=QG;case QG:if(r.flags&512){for(;h<16;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}if(u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Or;break}u=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=zc;break;case XG:for(;h<32;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}e.adler=r.check=lW(u),u=0,h=0,r.mode=U5;case U5:if(r.havedict===0)return e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=o,r.hold=u,r.bits=h,U_e;e.adler=r.check=1,r.mode=zc;case zc:if(t===B_e||t===C5)break e;case SA:if(r.last){u>>>=h&7,h-=h&7,r.mode=RA;break}for(;h<3;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}switch(r.last=u&1,u>>>=1,h-=1,u&3){case 0:r.mode=ZG;break;case 1:if(W_e(r),r.mode=P5,t===C5){u>>>=2,h-=2;break e}break;case 2:r.mode=eW;break;case 3:e.msg="invalid block type",r.mode=Or}u>>>=2,h-=2;break;case ZG:for(u>>>=h&7,h-=h&7;h<32;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Or;break}if(r.length=u&65535,u=0,h=0,r.mode=xA,t===C5)break e;case xA:r.mode=JG;case JG:if(p=r.length,p){if(p>o&&(p=o),p>l&&(p=l),p===0)break e;i.set(n.subarray(s,s+p),a),o-=p,s+=p,l-=p,a+=p,r.length-=p;break}r.mode=zc;break;case eW:for(;h<14;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}if(r.nlen=(u&31)+257,u>>>=5,h-=5,r.ndist=(u&31)+1,u>>>=5,h-=5,r.ncode=(u&15)+4,u>>>=4,h-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Or;break}r.have=0,r.mode=tW;case tW:for(;r.have<r.ncode;){for(;h<3;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}r.lens[G[r.have++]]=u&7,u>>>=3,h-=3}for(;r.have<19;)r.lens[G[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,O={bits:r.lenbits},T=Ay(L_e,r.lens,0,19,r.lencode,0,r.work,O),r.lenbits=O.bits,T){e.msg="invalid code lengths set",r.mode=Or;break}r.have=0,r.mode=rW;case rW:for(;r.have<r.nlen+r.ndist;){for(;g=r.lencode[u&(1<<r.lenbits)-1],b=g>>>24,_=g>>>16&255,m=g&65535,!(b<=h);){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}if(m<16)u>>>=b,h-=b,r.lens[r.have++]=m;else{if(m===16){for(F=b+2;h<F;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}if(u>>>=b,h-=b,r.have===0){e.msg="invalid bit length repeat",r.mode=Or;break}R=r.lens[r.have-1],p=3+(u&3),u>>>=2,h-=2}else if(m===17){for(F=b+3;h<F;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}u>>>=b,h-=b,R=0,p=3+(u&7),u>>>=3,h-=3}else{for(F=b+7;h<F;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}u>>>=b,h-=b,R=0,p=11+(u&127),u>>>=7,h-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Or;break}for(;p--;)r.lens[r.have++]=R}}if(r.mode===Or)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Or;break}if(r.lenbits=9,O={bits:r.lenbits},T=Ay(LW,r.lens,0,r.nlen,r.lencode,0,r.work,O),r.lenbits=O.bits,T){e.msg="invalid literal/lengths set",r.mode=Or;break}if(r.distbits=6,r.distcode=r.distdyn,O={bits:r.distbits},T=Ay(BW,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,O),r.distbits=O.bits,T){e.msg="invalid distances set",r.mode=Or;break}if(r.mode=P5,t===C5)break e;case P5:r.mode=D5;case D5:if(o>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=o,r.hold=u,r.bits=h,C_e(e,y),a=e.next_out,i=e.output,l=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,u=r.hold,h=r.bits,r.mode===zc&&(r.back=-1);break}for(r.back=0;g=r.lencode[u&(1<<r.lenbits)-1],b=g>>>24,_=g>>>16&255,m=g&65535,!(b<=h);){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}if(_&&(_&240)===0){for(E=b,D=_,N=m;g=r.lencode[N+((u&(1<<E+D)-1)>>E)],b=g>>>24,_=g>>>16&255,m=g&65535,!(E+b<=h);){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}u>>>=E,h-=E,r.back+=E}if(u>>>=b,h-=b,r.back+=b,r.length=m,_===0){r.mode=aW;break}if(_&32){r.back=-1,r.mode=zc;break}if(_&64){e.msg="invalid literal/length code",r.mode=Or;break}r.extra=_&15,r.mode=nW;case nW:if(r.extra){for(F=r.extra;h<F;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=iW;case iW:for(;g=r.distcode[u&(1<<r.distbits)-1],b=g>>>24,_=g>>>16&255,m=g&65535,!(b<=h);){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}if((_&240)===0){for(E=b,D=_,N=m;g=r.distcode[N+((u&(1<<E+D)-1)>>E)],b=g>>>24,_=g>>>16&255,m=g&65535,!(E+b<=h);){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}u>>>=E,h-=E,r.back+=E}if(u>>>=b,h-=b,r.back+=b,_&64){e.msg="invalid distance code",r.mode=Or;break}r.offset=m,r.extra=_&15,r.mode=oW;case oW:if(r.extra){for(F=r.extra;h<F;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Or;break}r.mode=sW;case sW:if(l===0)break e;if(p=y-l,r.offset>p){if(p=r.offset-p,p>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Or;break}p>r.wnext?(p-=r.wnext,v=r.wsize-p):v=r.wnext-p,p>r.length&&(p=r.length),d=r.window}else d=i,v=a-r.offset,p=r.length;p>l&&(p=l),l-=p,r.length-=p;do i[a++]=d[v++];while(--p);r.length===0&&(r.mode=D5);break;case aW:if(l===0)break e;i[a++]=r.length,l--,r.mode=D5;break;case RA:if(r.wrap){for(;h<32;){if(o===0)break e;o--,u|=n[s++]<<h,h+=8}if(y-=l,e.total_out+=y,r.total+=y,y&&(e.adler=r.check=r.flags?Hn(r.check,i,y,a-y):Dy(r.check,i,y,a-y)),y=l,(r.flags?u:lW(u))!==r.check){e.msg="incorrect data check",r.mode=Or;break}u=0,h=0}r.mode=cW;case cW:if(r.wrap&&r.flags){for(;h<32;){if(o===0)break e;o--,u+=n[s++]<<h,h+=8}if(u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Or;break}u=0,h=0}r.mode=uW;case uW:T=M_e;break e;case Or:T=MW;break e;case KW:return UW;case K_e:default:return rs}return e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=o,r.hold=u,r.bits=h,(r.wsize||y!==e.avail_out&&r.mode<Or&&(r.mode<RA||t!==VG))&&$W(e,e.output,e.next_out,y-e.avail_out),f-=e.avail_in,y-=e.avail_out,e.total_in+=f,e.total_out+=y,r.total+=y,r.wrap&&y&&(e.adler=r.check=r.flags?Hn(r.check,i,y,e.next_out-y):Dy(r.check,i,y,e.next_out-y)),e.data_type=r.bits+(r.last?64:0)+(r.mode===zc?128:0)+(r.mode===P5||r.mode===xA?256:0),(f===0&&y===0||t===VG)&&T===Ph&&(T=F_e),T},Y_e=e=>{if(!e||!e.state)return rs;let t=e.state;return t.window&&(t.window=null),e.state=null,Ph},Q_e=(e,t)=>{if(!e||!e.state)return rs;let r=e.state;return(r.wrap&2)===0?rs:(r.head=t,t.done=!1,Ph)},X_e=(e,t)=>{let r=t.length,n,i,s;return!e||!e.state||(n=e.state,n.wrap!==0&&n.mode!==U5)?rs:n.mode===U5&&(i=1,i=Dy(i,t,r,0),i!==n.check)?MW:(s=$W(e,t,r,r),s?(n.mode=KW,UW):(n.havedict=1,Ph))},Z_e=qW,J_e=zW,eve=VW,tve=G_e,rve=HW,nve=j_e,ive=Y_e,ove=Q_e,sve=X_e,ave="pako inflate (from Nodeca project)",$c={inflateReset:Z_e,inflateReset2:J_e,inflateResetKeep:eve,inflateInit:tve,inflateInit2:rve,inflate:nve,inflateEnd:ive,inflateGetHeader:ove,inflateSetDictionary:sve,inflateInfo:ave};function cve(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var uve=cve,GW=Object.prototype.toString,{Z_NO_FLUSH:lve,Z_FINISH:fve,Z_OK:Oy,Z_STREAM_END:IA,Z_NEED_DICT:CA,Z_STREAM_ERROR:hve,Z_DATA_ERROR:hW,Z_MEM_ERROR:dve}=Dh;function Uy(e){this.options=V5.assign({chunkSize:65536,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new NW,this.strm.avail_out=0;let r=$c.inflateInit2(this.strm,t.windowBits);if(r!==Oy)throw new Error(Th[r]);if(this.header=new uve,$c.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Ny.string2buf(t.dictionary):GW.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=$c.inflateSetDictionary(this.strm,t.dictionary),r!==Oy)))throw new Error(Th[r])}Uy.prototype.push=function(e,t){let r=this.strm,n=this.options.chunkSize,i=this.options.dictionary,s,a,o;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?fve:lve,GW.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=$c.inflate(r,a),s===CA&&i&&(s=$c.inflateSetDictionary(r,i),s===Oy?s=$c.inflate(r,a):s===hW&&(s=CA));r.avail_in>0&&s===IA&&r.state.wrap>0&&e[r.next_in]!==0;)$c.inflateReset(r),s=$c.inflate(r,a);switch(s){case hve:case hW:case CA:case dve:return this.onEnd(s),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||s===IA))if(this.options.to==="string"){let l=Ny.utf8border(r.output,r.next_out),u=r.next_out-l,h=Ny.buf2string(r.output,l);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(l,l+u),0),this.onData(h)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===Oy&&o===0)){if(s===IA)return s=$c.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},Uy.prototype.onData=function(e){this.chunks.push(e)},Uy.prototype.onEnd=function(e){e===Oy&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=V5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function FA(e,t){let r=new Uy(t);if(r.push(e),r.err)throw r.msg||Th[r.err];return r.result}function pve(e,t){return t=t||{},t.raw=!0,FA(e,t)}var mve=Uy,yve=FA,gve=pve,wve=FA,Eve=Dh,bve={Inflate:mve,inflate:yve,inflateRaw:gve,ungzip:wve,constants:Eve},{Deflate:_ve,deflate:vve,deflateRaw:Sve,gzip:xve}=T_e,{Inflate:Rve,inflate:Ave,inflateRaw:Tve,ungzip:Ive}=bve,Cve=_ve,Pve=vve,Dve=Sve,kve=xve,Nve=Rve,Ove=Ave,Lve=Tve,Bve=Ive,Mve=Dh,KA={Deflate:Cve,deflate:Pve,deflateRaw:Dve,gzip:kve,Inflate:Nve,inflate:Ove,inflateRaw:Lve,ungzip:Bve,constants:Mve},VA=w(ei(),1),qA=w(hA(),1),WW=6;function jW({repo:e,preload:t}){async function*r(n,i={}){if(i.compressionLevel!=null&&(i.compressionLevel<-1||i.compressionLevel>9))throw(0,D0.default)(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(i.preload!==!1){let o;try{o=Bp(n).split("/")}catch(l){throw(0,D0.default)(l,"ERR_INVALID_PATH")}t(I.parse(o[0]))}let s=I.asCID(n)||n,a=await ti(s,e.blocks,i);if(a.type==="file"||a.type==="raw"){let o=[];!i.compress||i.archive===!0?o.push([{header:{name:a.path,mode:a.type==="file"&&a.unixfs.mode,mtime:a.type==="file"&&a.unixfs.mtime?new Date(a.unixfs.mtime.secs*1e3):void 0,size:a.size,type:"file"},body:a.content()}],A5(),l=>(0,VA.default)(l,u=>u.slice())):o.push(a.content),i.compress&&o.push(async function*(l){let u=await(0,qA.default)(l);yield KA.gzip(u,{level:i.compressionLevel||WW})}),yield*Te(...o);return}if(a.type==="directory"){let o=[x5(s,e.blocks,i),async function*(l){for await(let u of l){let h={header:{name:u.path,size:u.size}};if(u.type==="file")h.header.type="file",h.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,h.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0,h.body=u.content();else if(u.type==="raw")h.header.type="file",h.body=u.content();else if(u.type==="directory")h.header.type="directory",h.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,h.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0;else throw(0,D0.default)(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield h}},A5(),l=>(0,VA.default)(l,u=>u.slice())];if(i.compress){if(!i.archive)throw(0,D0.default)(new Error("file is not regular"),"ERR_INVALID_PATH");i.compress&&o.push(async function*(l){let u=await(0,qA.default)(l);yield KA.gzip(u,{level:i.compressionLevel||WW})})}yield*Te(...o);return}throw(0,D0.default)(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return B(r)}c();var YW=w(K(),1);te();function QW({repo:e,preload:t}){async function*r(n,i={}){let s=Bp(n),a=s.split("/");i.preload!==!1&&t(I.parse(a[0]));let o=I.asCID(s)||s,l=await ti(o,e.blocks,i);if(l.type==="file"){yield VS(l);return}if(l.type==="directory"){for await(let u of l.content())yield VS(u);return}throw(0,YW.default)(new Error(`Unknown UnixFS type ${l.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return B(r)}var q5=class{constructor({preload:e,repo:t,hashers:r,options:n}){let i=rG({preload:e,repo:t,options:n,hashers:r});this.addAll=i,this.add=WH({addAll:i}),this.cat=_G({repo:t,preload:e}),this.get=jW({repo:t,preload:e}),this.ls=QW({repo:t,preload:e})}};c(),c();var Nh="",XW="",ZW="";function JW({repo:e}){async function t(r={}){let n=await e.version.get();return{version:Nh,commit:XW,repo:`${n}`,"ipfs-core":Nh,"interface-ipfs-core":ZW}}return B(t)}c(),me();var z5=w(K(),1),Uve=C("ipfs:components:id");function ej({peerId:e,network:t}){async function r(n={}){let i=t.try();if(!i){if(n.peerId)throw new xc;if(e.publicKey==null)throw(0,z5.default)(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");return{id:e,publicKey:M(e.publicKey,"base64pad"),addresses:[],agentVersion:`js-ipfs/${Nh}`,protocolVersion:"9000",protocols:[]}}let{libp2p:s}=i,a=n.peerId?n.peerId:e,o=await Fve(a,s,n),l=M(o.metadata.get("AgentVersion")||new Uint8Array),u=M(o.metadata.get("ProtocolVersion")||new Uint8Array),h=o.id.toString(),f=o.publicKey?M(o.publicKey,"base64pad"):"";return{id:a,publicKey:f,addresses:(o.addresses||[]).map(y=>{let p=y.toString();return p.endsWith(`/p2p/${h}`)?p:`${p}/p2p/${h}`}).sort().map(y=>new j(y)),agentVersion:l,protocolVersion:u,protocols:(o.protocols||[]).sort()}}return B(r)}async function Fve(e,t,r){let n=await t.peerStore.get(e);n||(n=await Kve(e,t,r));let i=e.publicKey?e.publicKey:await t.peerStore.keyBook.get(e);if(i==null)try{i=await t.getPublicKey(e,r)}catch(s){Uve.error("Could not load public key for",e.toString(),s)}return{...n,publicKey:i,metadata:n.metadata||new Map,addresses:n.addresses.map(s=>s.multiaddr)}}async function Kve(e,t,r){if(t.dht==null)throw(0,z5.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");for await(let i of t.dht.findPeer(e,r))if(i.name==="FINAL_PEER")break;let n=await t.peerStore.get(e);if(!n)throw(0,z5.default)(new Error("Could not find peer"),"ERR_NOT_FOUND");return n}c(),c(),c();var Gr=Vve;function Vve(e,t,r){var n,i;if(Array.isArray(t)&&(n=t.slice(0)),typeof t=="string"&&(n=t.split(".")),typeof t=="symbol"&&(n=[t]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(i=n.pop(),!i)return!1;tj(i);for(var s;s=n.shift();)if(tj(s),typeof e[s]>"u"&&(e[s]={}),e=e[s],!e||typeof e!="object")return!1;return e[i]=r,!0}function tj(e){if(e=="__proto__"||e=="constructor"||e=="prototype")throw new Error("setting of prototype values not supported")}var k0={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:e=>(Gr(e,"Discovery.MDNS.Enabled",!1),Gr(e,"Discovery.webRTCStar.Enabled",!1),e.Swarm={...e.Swarm||{},DisableNatPortMap:!0},e)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:e=>(Gr(e,"Discovery.MDNS.Enabled",!0),Gr(e,"Discovery.webRTCStar.Enabled",!0),Gr(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!1}),e)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:e=>{let t=Kc();return Gr(e,"Addresses.API",t.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),Gr(e,"Addresses.Gateway",t.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),Gr(e,"Addresses.Swarm",t.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),Gr(e,"Addresses.Delegates",[]),Gr(e,"Bootstrap",[]),Gr(e,"Discovery.MDNS.Enabled",!1),Gr(e,"Discovery.webRTCStar.Enabled",!1),Gr(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!0}),e}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:e=>{let t=Kc();return Gr(e,"Addresses.API",t.Addresses.API),Gr(e,"Addresses.Gateway",t.Addresses.Gateway),Gr(e,"Addresses.Swarm",t.Addresses.Swarm),Gr(e,"Addresses.Delegates",t.Addresses.Delegates),Gr(e,"Bootstrap",t.Bootstrap),Gr(e,"Discovery.MDNS.Enabled",t.Discovery.MDNS.Enabled),Gr(e,"Discovery.webRTCStar.Enabled",t.Discovery.webRTCStar.Enabled),Gr(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!1}),e}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:e=>{let t=e.Swarm||{},r=t.ConnMgr||{};return r.LowWater=20,r.HighWater=40,t.ConnMgr=r,e.Swarm=t,e}},"default-power":{description:'Inverse of "lowpower" profile.',transform:e=>{let t=Kc();return e.Swarm=t.Swarm,e}}},qve=C("ipfs:core:config");function rj({repo:e}){return{getAll:B(t),get:B(r),set:B(n),replace:B(i),profiles:{apply:B(s),list:B(zve)}};async function t(a={}){return e.config.getAll(a)}async function r(a,o){return a?e.config.get(a,o):Promise.reject(new Error("key argument is required"))}async function n(a,o,l){return e.config.set(a,o,l)}async function i(a,o){return e.config.replace(a,o)}async function s(a,o={dryRun:!1}){let{dryRun:l}=o,u=k0[a];if(!u)throw new Error(`No profile with name '${a}' exists`);try{let h=await e.config.getAll(o),f=JSON.parse(JSON.stringify(h));return f=u.transform(f),l||await e.config.replace(f,o),delete h.Identity.PrivKey,delete f.Identity.PrivKey,{original:h,updated:f}}catch(h){throw qve(h),new Error(`Could not apply profile '${a}' to config: ${h.message}`)}}}async function zve(e){return Object.keys(k0).map(t=>({name:t,description:k0[t].description}))}c(),c(),te(),c(),bp();var H5=({enumerable:e=!0,configurable:t=!1}={})=>({enumerable:e,configurable:t,writable:!1}),zA=function*(e,t){if(e!=null&&!(e instanceof Uint8Array))for(let[r,n]of Object.entries(e)){let i=[...t,r];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[s,a]of n.entries()){let o=[...i,s],l=I.asCID(a);l?yield[o.join("/"),l]:typeof a=="object"&&(yield*zA(a,o))}else{let s=I.asCID(n);s?yield[i.join("/"),s]:yield*zA(n,i)}}},HA=function*(e,t){if(e!=null)for(let[r,n]of Object.entries(e)){let i=[...t,r];if(yield i.join("/"),n!=null&&!(n instanceof Uint8Array)&&typeof n=="object"&&!I.asCID(n))if(Array.isArray(n))for(let[s,a]of n.entries()){let o=[...i,s];yield o.join("/"),typeof a=="object"&&!I.asCID(a)&&(yield*HA(a,o))}else yield*HA(n,i)}},Hve=(e,t)=>{let r=e;for(let[n,i]of t.entries()){if(r=r[i],r==null)throw new Error(`Object has no property at ${t.slice(0,n+1).map(a=>`[${JSON.stringify(a)}]`).join("")}`);let s=I.asCID(r);if(s)return{value:s,remaining:t.slice(n+1).join("/")}}return{value:r}},$A=class{constructor({cid:e,bytes:t,value:r}){if(!e||!t||typeof r>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:H5(),bytes:H5(),value:H5(),asBlock:H5()})}links(){return zA(this.value,[])}tree(){return HA(this.value,[])}get(e="/"){return Hve(this.value,e.split("/").filter(Boolean))}},N0=({bytes:e,cid:t,value:r,codec:n})=>{let i=r!==void 0?r:n&&n.decode(e);if(i===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new $A({cid:t,bytes:e,value:i})};c(),te(),c();var GA=w(ai(),1);function WA(e){let t=U9({version:1,roots:e}),r=GA.default.encode(t.length),n=new Uint8Array(r.length+t.length);return n.set(r,0),n.set(t,r.length),n}function nj(e){return{async setRoots(t){let r=WA(t);await e.write(r)},async writeBlock(t){let{cid:r,bytes:n}=t;await e.write(new Uint8Array(GA.default.encode(r.bytes.length+n.length))),await e.write(r.bytes),n.length&&await e.write(n)},async close(){await e.end()}}}c();function $5(){}function ij(){let e=[],t=null,r=$5,n=!1,i=null,s=$5,a=()=>(t||(t=new Promise(u=>{r=()=>{t=null,r=$5,u()}})),t),o={write(u){e.push(u);let h=a();return s(),h},async end(){n=!0;let u=a();s(),await u}},l={async next(){let u=e.shift();return u?(e.length===0&&r(),{done:!1,value:u}):n?(r(),{done:!0,value:void 0}):(i||(i=new Promise(h=>{s=()=>(i=null,s=$5,h(l.next()))})),i)}};return{writer:o,iterator:l}}c();var Il=w(ai(),1);te(),On(),c();var Tl={Null:e=>e===null,Int:e=>Number.isInteger(e),Float:e=>typeof e=="number"&&Number.isFinite(e),String:e=>typeof e=="string",Bool:e=>typeof e=="boolean",Bytes:e=>e instanceof Uint8Array,Link:e=>!Tl.Null(e)&&typeof e=="object"&&e.asCID===e,List:e=>Array.isArray(e),Map:e=>!Tl.Null(e)&&typeof e=="object"&&e.asCID!==e&&!Tl.List(e)&&!Tl.Bytes(e)},O0={Int:Tl.Int,"CarHeader > version":e=>O0.Int(e),"CarHeader > roots (anon) > valueType (anon)":Tl.Link,"CarHeader > roots (anon)":e=>Tl.List(e)&&Array.prototype.every.call(e,O0["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":e=>O0["CarHeader > roots (anon)"](e),CarHeader:e=>{let t=e&&Object.keys(e);return Tl.Map(e)&&["version"].every(r=>t.includes(r))&&Object.entries(e).every(([r,n])=>O0["CarHeader > "+r]&&O0["CarHeader > "+r](n))}},oj=O0.CarHeader,jA={SHA2_256:18,LENGTH:32,DAG_PB:112},sj=16+8+8+8;async function G5(e){let t=await e.upTo(8);if(!t.length)throw new Error("Unexpected end of data");let r=Il.default.decode(t);return e.seek(Il.default.decode.bytes),r}async function $ve(e){let t=await e.exactly(sj),r=new DataView(t.buffer,t.byteOffset,t.byteLength),n=0,i={version:2,characteristics:[r.getBigUint64(n,!0),r.getBigUint64(n+=8,!0)],dataOffset:Number(r.getBigUint64(n+=8,!0)),dataSize:Number(r.getBigUint64(n+=8,!0)),indexOffset:Number(r.getBigUint64(n+=8,!0))};return e.seek(sj),i}async function W5(e,t){let r=await G5(e);if(r===0)throw new Error("Invalid CAR header (zero length)");let n=await e.exactly(r);e.seek(r);let i=zf(n);if(!oj(i))throw new Error("Invalid CAR header format");if(i.version!==1&&i.version!==2||t!==void 0&&i.version!==t)throw new Error(`Invalid CAR version: ${i.version}${t!==void 0?` (expected ${t})`:""}`);let s=Array.isArray(i.roots);if(i.version===1&&!s||i.version===2&&s)throw new Error("Invalid CAR header format");if(i.version===1)return i;let a=await $ve(e);e.seek(a.dataOffset-e.pos);let o=await W5(e,1);return Object.assign(o,a)}async function Gve(e){let t=await e.upTo(8);Il.default.decode(t);let r=Il.default.decode.bytes,n=Il.default.decode(t.subarray(Il.default.decode.bytes)),i=Il.default.decode.bytes,s=r+i+n,a=await e.exactly(s);return e.seek(s),a}async function Wve(e){let t=await e.exactly(2);if(t[0]===jA.SHA2_256&&t[1]===jA.LENGTH){let a=await e.exactly(34);e.seek(34);let o=_r(a);return I.create(0,jA.DAG_PB,o)}let r=await G5(e);if(r!==1)throw new Error(`Unexpected CID version (${r})`);let n=await G5(e),i=await Gve(e),s=_r(i);return I.create(r,n,s)}async function aj(e){let t=e.pos,r=await G5(e);if(r===0)throw new Error("Invalid CAR section (zero length)");r+=e.pos-t;let n=await Wve(e),i=r-Number(e.pos-t);return{cid:n,length:r,blockLength:i}}async function jve(e){let{cid:t,blockLength:r}=await aj(e),n=await e.exactly(r);return e.seek(r),{bytes:n,cid:t}}async function Yve(e){let t=e.pos,{cid:r,length:n,blockLength:i}=await aj(e),s={cid:r,length:n,blockLength:i,offset:t,blockOffset:e.pos};return e.seek(s.blockLength),s}function cj(e){let t=(async()=>{let r=await W5(e);if(r.version===2){let n=e.pos-r.dataOffset;e=Xve(e,r.dataSize-n)}return r})();return{header:()=>t,async*blocks(){for(await t;(await e.upTo(8)).length>0;)yield await jve(e)},async*blocksIndex(){for(await t;(await e.upTo(8)).length>0;)yield await Yve(e)}}}function j5(e){let t=0;return{async upTo(r){return e.subarray(t,t+Math.min(r,e.length-t))},async exactly(r){if(r>e.length-t)throw new Error("Unexpected end of data");return e.subarray(t,t+r)},seek(r){t+=r},get pos(){return t}}}function Qve(e){let t=0,r=0,n=0,i=new Uint8Array(0),s=async a=>{r=i.length-n;let o=[i.subarray(n)];for(;r<a;){let u=await e();if(u==null)break;r<0?u.length>r&&o.push(u.subarray(-r)):o.push(u),r+=u.length}i=new Uint8Array(o.reduce((u,h)=>u+h.length,0));let l=0;for(let u of o)i.set(u,l),l+=u.length;n=0};return{async upTo(a){return i.length-n<a&&await s(a),i.subarray(n,n+Math.min(i.length-n,a))},async exactly(a){if(i.length-n<a&&await s(a),i.length-n<a)throw new Error("Unexpected end of data");return i.subarray(n,n+a)},seek(a){t+=a,n+=a},get pos(){return t}}}function uj(e){let t=e[Symbol.asyncIterator]();async function r(){let n=await t.next();return n.done?null:n.value}return Qve(r)}function Xve(e,t){let r=0;return{async upTo(n){let i=await e.upTo(n);return i.length+r>t&&(i=i.subarray(0,t-r)),i},async exactly(n){let i=await e.exactly(n);if(i.length+r>t)throw new Error("Unexpected end of data");return i},seek(n){r+=n,e.seek(n)},get pos(){return e.pos}}}var Oh=class{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let t=I.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:t,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=Zve(e);let{encoder:t,iterator:r}=lj(),n=new Oh(e,t),i=new Y5(r);return{writer:n,out:i}}static createAppender(){let{encoder:e,iterator:t}=lj();e.setRoots=()=>Promise.resolve();let r=new Oh([],e),n=new Y5(t);return{writer:r,out:n}}static async updateRootsInBytes(e,t){let r=j5(e);await W5(r);let n=WA(t);if(Number(r.pos)!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${r.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}},Y5=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};function lj(){let e=ij(),{writer:t,iterator:r}=e;return{encoder:nj(t),iterator:r}}function Zve(e){if(e===void 0)return[];if(!Array.isArray(e)){let r=I.asCID(e);if(!r)throw new TypeError("roots must be a single CID or an array of CIDs");return[r]}let t=[];for(let r of e){let n=I.asCID(r);if(!n)throw new TypeError("roots must be a single CID or an array of CIDs");t.push(n)}return t}zo(),uS(),c(),Hr();var YA=async({cid:e,load:t,seen:r})=>{r=r||new Set;let n=e.toString(Ne);if(r.has(n))return;let i=await t(e);if(r.add(n),i!==null)for(let[,s]of i.links())await YA({cid:s,load:t,seen:r})},fj=C("ipfs:components:dag:import"),Jve=[Un,cS];function hj({repo:e,preload:t,codecs:r}){async function*n(i,s={}){s.preload!==!1&&t(i);let a=I.asCID(i);if(!a)throw new Error(`Unexpected error converting CID type: ${i}`);fj(`Exporting ${a} as car`);let{writer:o,out:l}=await Oh.create([a]),u=null;(async()=>{try{let h=e7e(e,o,{signal:s.signal,timeout:s.timeout},r);await YA({cid:a,load:h})}catch(h){u=h}finally{o.close()}})();for await(let h of l){if(u)break;yield h}if(u)throw u}return B(n)}function e7e(e,t,r,n){return async i=>{let s=await n.getCodec(i.code);if(!s)throw new Error(`Can't decode links in block with codec 0x${i.code.toString(16)} to form complete DAG`);let a=await e.blocks.get(i,r);return fj(`Adding block ${i} to car`),await t.put({cid:i,bytes:a}),Jve.includes(i.code)?null:N0({bytes:a,cid:i,codec:s})}}c();var pj=w(Gc(),1),mj=w(qi(),1),yj=w(K(),1);function gj({codecs:e,repo:t,preload:r}){return B(async function(n,i={}){if(i.preload!==!1&&r(n),i.path){let o=i.localResolve?await(0,pj.default)(Qu(n,i.path,e,t,i)):await(0,mj.default)(Qu(n,i.path,e,t,i));if(!o)throw(0,yj.default)(new Error("Not found"),"ERR_NOT_FOUND");return o}let s=await e.getCodec(n.code),a=await t.blocks.get(n,i);return{value:s.decode(a),remainderPath:""}})}c(),c();var Q5=class{constructor(e,t,r){this._version=e,this._roots=t,this._iterable=r,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},Lh=class extends Q5{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:t,roots:r,iterator:n}=await wj(e);return new Lh(t,r,n)}static async fromIterable(e){let{version:t,roots:r,iterator:n}=await Ej(e);return new Lh(t,r,n)}},Fy=class extends Q5{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let t=await e.next();return t.done?t:{done:!1,value:t.value.cid}}}}static async fromBytes(e){let{version:t,roots:r,iterator:n}=await wj(e);return new Fy(t,r,n)}static async fromIterable(e){let{version:t,roots:r,iterator:n}=await Ej(e);return new Fy(t,r,n)}};async function wj(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return bj(j5(e))}async function Ej(e){if(!e||typeof e[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return bj(uj(e))}async function bj(e){let t=cj(e),{version:r,roots:n}=await t.header();return{version:r,roots:n,iterator:t.blocks()}}var _j=w(S0(),1),vj=w(Ci(),1),Sj=w(ei(),1),xj=C("ipfs:components:dag:import");function Rj({repo:e}){async function*t(r,n={}){let i=await e.gcLock.readLock();try{let s={signal:n.signal,timeout:n.timeout},a=(0,_j.default)(r),{value:o,done:l}=await a.peek();if(l)return;o&&a.push(o);let u;o instanceof Uint8Array?u=[a]:u=a;for await(let h of u){let f=await r7e(e,s,h);if(n.pinRoots!==!1)for(let y of f){let p="";try{await e.blocks.has(y)?(xj(`Pinning root ${y}`),await e.pins.pinRecursively(y)):p="blockstore: block not found"}catch(v){p=v.message}yield{root:{cid:y,pinErrorMsg:p}}}}}finally{i()}}return B(t)}async function r7e(e,t,r){let n=await Lh.fromIterable(r),i=await n.getRoots();return await(0,vj.default)(e.blocks.putMany((0,Sj.default)(n,({cid:s,bytes:a})=>(xj(`Import block ${s}`),{key:s,value:a})),{signal:t.signal})),i}c(),te();function Aj({repo:e,codecs:t,hashers:r,preload:n}){async function i(s,a={}){let o=a.pin?await e.gcLock.readLock():null;try{let l=await t.getCodec(a.storeCodec||"dag-cbor");if(!l)throw new Error(`Unknown storeCodec ${a.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(a.inputCodec){if(!(s instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");let v=await t.getCodec(a.inputCodec);if(!v)throw new Error(`Unknown inputCodec ${a.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);s=v.decode(s)}let u=a.version!=null?a.version:1,h=await r.getHasher(a.hashAlg||"sha2-256");if(!h)throw new Error(`Unknown hash algorithm ${a.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let f=l.encode(s),y=await h.digest(f),p=I.create(u,l.code,y);return await e.blocks.put(p,f,{signal:a.signal}),a.pin&&await e.pins.pinRecursively(p),a.preload!==!1&&n(p),p}finally{o&&o()}}return B(i)}c();function Tj({repo:e,codecs:t,preload:r}){async function n(i,s={}){let{cid:a}=Tc(i);return s.preload!==!1&&r(a),Yu(e,t,i,s)}return B(n)}var X5=class{constructor({repo:e,codecs:t,hashers:r,preload:n}){this.export=hj({repo:e,preload:n,codecs:t}),this.get=gj({codecs:t,repo:e,preload:n}),this.import=Rj({repo:e}),this.resolve=Tj({repo:e,codecs:t,preload:n}),this.put=Aj({repo:e,codecs:t,hashers:r,preload:n})}};c(),c();var Z5=(e,t)=>t,n7e=(e,t,r,n)=>{if(n!=null&&n.assumeHttp===!1)return`tcp://${e}:${t}`;let i="tcp",s=`:${t}`;return r[r.length-1].protocol==="tcp"&&(i=t==="443"?"https":"http",s=t==="443"||t==="80"?"":s),`${i}://${e}${s}`},i7e={ip4:Z5,ip6:(e,t,r,n)=>n.length===1&&n[0].protocol==="ip6"?t:`[${t}]`,tcp:(e,t,r,n,i)=>n.some(s=>["http","https","ws","wss"].includes(s.protocol))?`${e}:${t}`:n7e(e,t,n,i),udp:(e,t)=>`udp://${e}:${t}`,dnsaddr:Z5,dns4:Z5,dns6:Z5,ipfs:(e,t)=>`${e}/ipfs/${t}`,p2p:(e,t)=>`${e}/p2p/${t}`,http:e=>`http://${e}`,https:e=>`https://${e}`,ws:e=>`ws://${e}`,wss:e=>`wss://${e}`,"p2p-websocket-star":e=>`${e}/p2p-websocket-star`,"p2p-webrtc-star":e=>`${e}/p2p-webrtc-star`,"p2p-webrtc-direct":e=>`${e}/p2p-webrtc-direct`};function L0(e,t){let r=new j(e),n=e.toString().split("/").slice(1);return r.tuples().map(i=>({protocol:n.shift()??"",content:i[1]!=null?n.shift()??"":""})).reduce((i,s,a,o)=>{let l=i7e[s.protocol];if(l==null)throw new Error(`Unsupported protocol ${s.protocol}`);return l(i,s.content,a,o,t)},"")}c();function QA(e){if(!Array.isArray(e))throw new TypeError(`Expected an array, got ${typeof e}`);e=[...e];for(let t=e.length-1;t>0;t--){let r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}c();var Ij=w(Vp(),1),o7e=C("ipfs:preload"),s7e=ks.default?ks.default:ks,a7e=new s7e({concurrency:4});function Cj(e,t={}){return o7e(e),a7e.add(async()=>{let r=(await Ij.default.post(e,{signal:t.signal})).body.getReader();try{for(;;){let{done:n}=await r.read();if(n)return}}finally{r.releaseLock()}})}var Pj=w(Mp(),1),Ky=C("ipfs:preload");function Dj(e={}){if(e.enabled=Boolean(e.enabled),e.addresses=e.addresses||[],e.cache=e.cache||1e3,!e.enabled||!e.addresses.length)return Ky("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let t=!0,r=[],n=e.addresses.map(a=>L0(a)),i=(0,Pj.default)(e.cache),s=async a=>{try{if(t)throw new Error(`preload ${a} but preloader is not started`);let o=a.toString();if(i.has(o))return;i.set(o,!0);let l=QA(n),u=!1,h=Date.now();for(let f of l){if(t)throw new Error(`preload aborted for ${o}`);let y;try{y=new AbortController,r=r.concat(y),await Cj(`${f}/api/v0/refs?r=true&arg=${encodeURIComponent(o)}`,{signal:y.signal}),u=!0}catch(p){p.type!=="aborted"&&Ky.error(p)}finally{r=r.filter(p=>p!==y)}if(u)break}Ky(`${u?"":"un"}successfully preloaded ${o} in ${Date.now()-h}ms`)}catch(o){Ky.error(o)}};return s.start=()=>{t=!1},s.stop=()=>{t=!0,Ky(`aborting ${r.length} pending preload request(s)`),r.forEach(a=>a.abort()),r=[]},s}c();var J5=C("ipfs:mfs-preload");function kj({preload:e,files:t,options:r={}}){if(r.interval=r.interval||3e4,!r.enabled){J5("MFS preload disabled");let a=async()=>{};return{start:a,stop:a}}let n="",i,s=async()=>{try{let a=await t.stat("/"),o=a.cid.toString();n!==o&&(J5(`preloading updated MFS root ${n} -> ${a.cid}`),await e(a.cid),n=o)}catch(a){J5.error("failed to preload MFS root",a)}finally{i=setTimeout(s,r.interval)}};return{async start(){let a=await t.stat("/");n=a.cid.toString(),J5(`monitoring MFS root ${a.cid}`),i=setTimeout(s,r.interval)},stop(){clearTimeout(i)}}}c(),c(),c(),c();var Fj=w(Xu(),1);c(),c();function XA(e,t,r){let n=0,i=e.length;for(;i>0;){let s=Math.trunc(i/2),a=n+s;r(e[a],t)<=0?(n=++a,i-=s+1):i=s}return n}var Bh=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Wc,Vy=class{constructor(){Wc.set(this,[])}enqueue(e,t){t={priority:0,...t};let r={priority:t.priority,run:e};if(this.size&&Bh(this,Wc,"f")[this.size-1].priority>=t.priority){Bh(this,Wc,"f").push(r);return}let n=XA(Bh(this,Wc,"f"),r,(i,s)=>s.priority-i.priority);Bh(this,Wc,"f").splice(n,0,r)}dequeue(){return Bh(this,Wc,"f").shift()?.run}filter(e){return Bh(this,Wc,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return Bh(this,Wc,"f").length}};Wc=new WeakMap;var Jt=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},Ee=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},$n,zy,Hy,Pl,i8,$y,e8,Ws,qy,mo,t8,yo,Gy,Cl,B0,M0,Mh,r8,Nj,Oj,Uj,Lj,Bj,Mj,n8,ZA,JA,o8,s8=()=>{},c7e=new hi,eT=class extends Error{},U0=class extends Fj.default{constructor(e){var t,r,n,i;if(super(),$n.add(this),zy.set(this,void 0),Hy.set(this,void 0),Pl.set(this,0),i8.set(this,void 0),$y.set(this,void 0),e8.set(this,0),Ws.set(this,void 0),qy.set(this,void 0),mo.set(this,void 0),t8.set(this,void 0),yo.set(this,0),Gy.set(this,void 0),Cl.set(this,void 0),B0.set(this,s8),M0.set(this,s8),Mh.set(this,void 0),r8.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Vy,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);Jt(this,zy,e.carryoverConcurrencyCount,"f"),Jt(this,Hy,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),Jt(this,i8,e.intervalCap,"f"),Jt(this,$y,e.interval,"f"),Jt(this,mo,new e.queueClass,"f"),Jt(this,t8,e.queueClass,"f"),this.concurrency=e.concurrency,Jt(this,Mh,e.timeout,"f"),Jt(this,r8,e.throwOnTimeout===!0,"f"),Jt(this,Cl,e.autoStart===!1,"f")}get concurrency(){return Ee(this,Gy,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);Jt(this,Gy,e,"f"),Ee(this,$n,"m",o8).call(this)}async add(e,t={}){return new Promise((r,n)=>{let i=async()=>{var s,a,o;Jt(this,yo,(a=Ee(this,yo,"f"),a++,a),"f"),Jt(this,Pl,(o=Ee(this,Pl,"f"),o++,o),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){n(new eT("The task was aborted."));return}let l=await(Ee(this,Mh,"f")===void 0&&t.timeout===void 0?e({signal:t.signal}):nn(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?Ee(this,Mh,"f"):t.timeout,()=>{(t.throwOnTimeout===void 0?Ee(this,r8,"f"):t.throwOnTimeout)&&n(c7e)}));r(l),this.emit("completed",l)}catch(l){n(l),this.emit("error",l)}Ee(this,$n,"m",Uj).call(this)};Ee(this,mo,"f").enqueue(i,t),Ee(this,$n,"m",n8).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return Ee(this,Cl,"f")?(Jt(this,Cl,!1,"f"),Ee(this,$n,"m",o8).call(this),this):this}pause(){Jt(this,Cl,!0,"f")}clear(){Jt(this,mo,new(Ee(this,t8,"f")),"f")}async onEmpty(){if(Ee(this,mo,"f").size!==0)return new Promise(e=>{let t=Ee(this,B0,"f");Jt(this,B0,()=>{t(),e()},"f")})}async onSizeLessThan(e){if(!(Ee(this,mo,"f").size<e))return new Promise(t=>{let r=()=>{Ee(this,mo,"f").size<e&&(this.removeListener("next",r),t())};this.on("next",r)})}async onIdle(){if(!(Ee(this,yo,"f")===0&&Ee(this,mo,"f").size===0))return new Promise(e=>{let t=Ee(this,M0,"f");Jt(this,M0,()=>{t(),e()},"f")})}get size(){return Ee(this,mo,"f").size}sizeBy(e){return Ee(this,mo,"f").filter(e).length}get pending(){return Ee(this,yo,"f")}get isPaused(){return Ee(this,Cl,"f")}get timeout(){return Ee(this,Mh,"f")}set timeout(e){Jt(this,Mh,e,"f")}};zy=new WeakMap,Hy=new WeakMap,Pl=new WeakMap,i8=new WeakMap,$y=new WeakMap,e8=new WeakMap,Ws=new WeakMap,qy=new WeakMap,mo=new WeakMap,t8=new WeakMap,yo=new WeakMap,Gy=new WeakMap,Cl=new WeakMap,B0=new WeakMap,M0=new WeakMap,Mh=new WeakMap,r8=new WeakMap,$n=new WeakSet,Nj=function(){return Ee(this,Hy,"f")||Ee(this,Pl,"f")<Ee(this,i8,"f")},Oj=function(){return Ee(this,yo,"f")<Ee(this,Gy,"f")},Uj=function(){var e;Jt(this,yo,(e=Ee(this,yo,"f"),e--,e),"f"),Ee(this,$n,"m",n8).call(this),this.emit("next")},Lj=function(){Ee(this,B0,"f").call(this),Jt(this,B0,s8,"f"),Ee(this,yo,"f")===0&&(Ee(this,M0,"f").call(this),Jt(this,M0,s8,"f"),this.emit("idle"))},Bj=function(){Ee(this,$n,"m",JA).call(this),Ee(this,$n,"m",ZA).call(this),Jt(this,qy,void 0,"f")},Mj=function(){let e=Date.now();if(Ee(this,Ws,"f")===void 0){let t=Ee(this,e8,"f")-e;if(t<0)Jt(this,Pl,Ee(this,zy,"f")?Ee(this,yo,"f"):0,"f");else return Ee(this,qy,"f")===void 0&&Jt(this,qy,setTimeout(()=>{Ee(this,$n,"m",Bj).call(this)},t),"f"),!0}return!1},n8=function(){if(Ee(this,mo,"f").size===0)return Ee(this,Ws,"f")&&clearInterval(Ee(this,Ws,"f")),Jt(this,Ws,void 0,"f"),Ee(this,$n,"m",Lj).call(this),!1;if(!Ee(this,Cl,"f")){let e=!Ee(this,$n,"m",Mj).call(this);if(Ee(this,$n,"a",Nj)&&Ee(this,$n,"a",Oj)){let t=Ee(this,mo,"f").dequeue();return t?(this.emit("active"),t(),e&&Ee(this,$n,"m",ZA).call(this),!0):!1}}return!1},ZA=function(){Ee(this,Hy,"f")||Ee(this,Ws,"f")!==void 0||(Jt(this,Ws,setInterval(()=>{Ee(this,$n,"m",JA).call(this)},Ee(this,$y,"f")),"f"),Jt(this,e8,Date.now()+Ee(this,$y,"f"),"f"))},JA=function(){Ee(this,Pl,"f")===0&&Ee(this,yo,"f")===0&&Ee(this,Ws,"f")&&(clearInterval(Ee(this,Ws,"f")),Jt(this,Ws,void 0,"f")),Jt(this,Pl,Ee(this,zy,"f")?Ee(this,yo,"f"):0,"f"),Ee(this,$n,"m",o8).call(this)},o8=function(){for(;Ee(this,$n,"m",n8).call(this););},c(),Lp(),c();var tT="lock:worker:request-read",rT="lock:worker:release-read",nT="lock:master:grant-read",iT="lock:worker:request-write",oT="lock:worker:release-write",sT="lock:master:grant-write";c();var Dl={},F0=e=>{e.addEventListener("message",t=>{F0.dispatchEvent("message",e,t)}),e.port!=null&&e.port.addEventListener("message",t=>{F0.dispatchEvent("message",e,t)})};F0.addEventListener=(e,t)=>{Dl[e]==null&&(Dl[e]=[]),Dl[e].push(t)},F0.removeEventListener=(e,t)=>{Dl[e]!=null&&(Dl[e]=Dl[e].filter(r=>r===t))},F0.dispatchEvent=function(e,t,r){Dl[e]!=null&&Dl[e].forEach(n=>n(t,r))};var aT=F0,Kj=(e,t,r,n,i)=>(s,a)=>{if(a.data.type!==r)return;let o={type:a.data.type,name:a.data.name,identifier:a.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:o.name,handler:async()=>(s.postMessage({type:i,name:o.name,identifier:o.identifier}),await new Promise(l=>{let u=h=>{if(h==null||h.data==null)return;let f={type:h.data.type,name:h.data.name,identifier:h.data.identifier};f.type===n&&f.identifier===o.identifier&&(s.removeEventListener("message",u),l())};s.addEventListener("message",u)}))}}))},Vj=(e,t,r,n)=>async()=>{let i=jf();return globalThis.postMessage({type:t,identifier:i,name:e}),await new Promise(s=>{let a=o=>{if(o==null||o.data==null)return;let l={type:o.data.type,identifier:o.data.identifier};l.type===r&&l.identifier===i&&(globalThis.removeEventListener("message",a),s(()=>{globalThis.postMessage({type:n,identifier:i,name:e})}))};globalThis.addEventListener("message",a)})},u7e={singleProcess:!1},qj=e=>{if(e=Object.assign({},u7e,e),Boolean(globalThis.document)||e.singleProcess){let t=new EventTarget;return aT.addEventListener("message",Kj(t,"requestReadLock",tT,rT,nT)),aT.addEventListener("message",Kj(t,"requestWriteLock",iT,oT,sT)),t}return{isWorker:!0,readLock:t=>Vj(t,tT,nT,rT),writeLock:t=>Vj(t,iT,sT,oT)}},Uh={},kl;async function cT(e,t){let r,n=new Promise(i=>{r=i});return e.add(async()=>await nn((async()=>await new Promise(i=>{r(()=>{i()})}))(),t.timeout)),await n}var l7e=(e,t)=>{if(kl.isWorker===!0)return{readLock:kl.readLock(e,t),writeLock:kl.writeLock(e,t)};let r=new U0({concurrency:1}),n;return{async readLock(){if(n!=null)return await cT(n,t);n=new U0({concurrency:t.concurrency,autoStart:!1});let i=n,s=cT(n,t);return r.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await s},async writeLock(){return n=null,await cT(r,t)}}},f7e={name:"lock",concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};function uT(e){let t=Object.assign({},f7e,e);return kl==null&&(kl=qj(t),kl.isWorker!==!0&&(kl.addEventListener("requestReadLock",r=>{Uh[r.data.name]!=null&&Uh[r.data.name].readLock().then(async n=>await r.data.handler().finally(()=>n()))}),kl.addEventListener("requestWriteLock",async r=>{Uh[r.data.name]!=null&&Uh[r.data.name].writeLock().then(async n=>await r.data.handler().finally(()=>n()))}))),Uh[t.name]==null&&(Uh[t.name]=l7e(t.name,t)),Uh[t.name]}var a8;function Wy(e=!1){if(a8)return a8;let t=uT({singleProcess:e});return a8={readLock:r=>async(...n)=>{let i=await t.readLock();try{return await r.apply(null,n)}finally{i()}},writeLock:r=>async(...n)=>{let i=await t.writeLock();try{return await r.apply(null,n)}finally{i()}}},a8}var ET=w(m2(),1);c(),c(),c(),te(),vr();var lT=w(K(),1),zj=C("ipfs:mfs:utils:with-mfs-root");async function K0(e,t){if(t&&t.signal&&t.signal.aborted)throw(0,lT.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await e.repo.datastore.open();let r;try{let n=await e.repo.datastore.get(w2);r=I.decode(n)}catch(n){if(n.code!=="ERR_NOT_FOUND")throw n;zj("Creating new MFS root");let i=je({Data:new Je({type:"directory"}).marshal(),Links:[]}),s=await xe.digest(i);if(r=I.createV0(s),await e.repo.blocks.put(r,i),t&&t.signal&&t.signal.aborted)throw(0,lT.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await e.repo.datastore.put(w2,r.bytes)}return zj(`Loaded MFS root /ipfs/${r}`),r}c();function V0(e=""){return(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}var hT=w(K(),1);te();var fT="ipfs",Wr=async(e,t,r)=>{let n=await K0(e,r),i={entryType:"file"},s="";if(I.asCID(t)?s=`/ipfs/${t}`:s=t.toString(),s=s.trim(),s=s.replace(/(\/\/+)/g,"/"),s.endsWith("/")&&s.length>1&&(s=s.substring(0,s.length-1)),!s)throw(0,hT.default)(new Error("paths must not be empty"),"ERR_NO_PATH");if(s.substring(0,1)!=="/")throw(0,hT.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");s.substring(s.length-1)==="/"&&(s=s.substring(0,s.length-1));let a=V0(s);if(a[0]===fT){let l;a.length===2?l=`/${a.join("/")}`:l=`/${a.slice(0,a.length-1).join("/")}`,i={type:"ipfs",depth:a.length-2,entryType:"file",mfsPath:`/${a.join("/")}`,mfsDirectory:l,parts:a,path:`/${a.join("/")}`,name:a[a.length-1]}}else{let l=`/${fT}/${n}${a.length?"/"+a.join("/"):""}`,u=`/${fT}/${n}/${a.slice(0,a.length-1).join("/")}`;i={type:"mfs",depth:a.length,entryType:"file",mfsDirectory:u,mfsPath:l,parts:a,path:`/${a.join("/")}`,name:a[a.length-1]}}let o=i.type==="mfs"?i.mfsPath:i.path;try{let l=await ti(o,e.repo.blocks,r);i.cid=l.cid,i.mfsPath=`/ipfs/${l.path}`,i.entryType=l.type,i.content=l.content,(i.entryType==="file"||i.entryType==="directory")&&(l.type==="file"||l.type==="directory")&&(i.unixfs=l.unixfs)}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}return i.exists=Boolean(i.cid),i},$j=w(K(),1),h7e=Ze.bind({ignoreUndefined:!0}),d7e=C("ipfs:mfs:stat"),p7e={withLocal:!1};function Nl(e){async function t(r,n={}){n=h7e(p7e,n),d7e(`Fetching stats for ${r}`);let{type:i,cid:s,mfsPath:a}=await Wr(e,r,n),o=i==="ipfs"&&s?s:a,l;try{l=await ti(o,e.repo.blocks)}catch(u){throw u.code==="ERR_NOT_FOUND"?(0,$j.default)(new Error(`${r} does not exist`),"ERR_NOT_FOUND"):u}if(!Hj[l.type])throw new Error(`Cannot stat codec ${l.cid.code}`);return Hj[l.type](l)}return B(t)}var Hj={raw:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:e=>{let t={cid:e.cid,type:"file",size:e.unixfs.fileSize(),cumulativeSize:je(e.node).length+(e.node.Links||[]).reduce((r,n)=>r+(n.Tsize||0),0),blocks:e.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:e.unixfs.mode};return e.unixfs.mtime&&(t.mtime=e.unixfs.mtime),t},directory:e=>{let t={cid:e.cid,type:"directory",size:0,cumulativeSize:je(e.node).length+(e.node.Links||[]).reduce((r,n)=>r+(n.Tsize||0),0),blocks:e.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:e.unixfs.mode};return e.unixfs.mtime&&(t.mtime=e.unixfs.mtime),t},object:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})};c();var W0=w(K(),1);c();var m7e=C("ipfs:mfs:utils:to-trail");async function Fa(e,t){m7e(`Creating trail for path ${t}`);let r=[];for await(let n of fA(t,e.repo.blocks))r.push({name:n.name,cid:n.cid,size:n.size,type:n.type});return r}c(),te(),c(),c(),te(),vr();var c8=async(e,t,r)=>{r.codec||(r.codec=At),r.hasher||(r.hasher=xe),r.cidVersion===void 0&&(r.cidVersion=1),r.codec===At&&r.hasher!==xe&&(r.cidVersion=1);let n=await r.hasher.digest(e),i=I.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await t.put(i,e,{signal:r.signal}),i},h8=w(wy(),1);c();var u8=Sh.code,l8=8;async function f8(e){return(await Sh.encode(e)).slice(0,8).reverse()}var dT=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},q0=class extends dT{constructor(e,t){super(e,t),this._bucket=(0,h8.createHAMT)({hashFn:f8,bits:l8})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){yield*Gj(this._bucket,e,this,this.options)}};async function*Gj(e,t,r,n){let i=e._children,s=[],a=0;for(let y=0;y<i.length;y++){let p=i.get(y);if(!p)continue;let v=y.toString(16).toUpperCase().padStart(2,"0");if(p instanceof h8.Bucket){let d;for await(let g of await Gj(p,t,null,n))d=g;if(!d)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:v,Tsize:d.size,Hash:d.cid}),a+=d.size}else if(typeof p.value.flush=="function"){let d=p.value,g;for await(let _ of d.flush(t))g=_,yield g;let b=v+p.key;s.push({Name:b,Tsize:g.size,Hash:g.cid}),a+=g.size}else{let d=p.value;if(!d.cid)continue;let g=v+p.key,b=d.size;s.push({Name:g,Tsize:b,Hash:d.cid}),a+=b}}let o=Uint8Array.from(i.bitField().reverse()),l={Data:new Je({type:"hamt-sharded-directory",data:o,fanout:e.tableSize(),hashType:u8,mtime:r&&r.mtime,mode:r&&r.mode}).marshal(),Links:s},u=je(Ln(l)),h=await c8(u,t,n),f=u.length+a;yield{cid:h,node:l,size:f}}c();var z0=w(wy(),1),Wj=w(qi(),1);te();var jy=C("ipfs:mfs:core:utils:hamt-utils"),H0=async(e,t,r,n)=>{if(!n.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");let i=Uint8Array.from(r._children.bitField().reverse()),s=Je.unmarshal(n.parent.Data),a=new Je({type:"hamt-sharded-directory",data:i,fanout:r.tableSize(),hashType:u8,mode:s.mode,mtime:s.mtime}),o=await e.hashers.getHasher(n.hashAlg),l={Data:a.marshal(),Links:t.sort((y,p)=>(y.Name||"").localeCompare(p.Name||""))},u=je(l),h=await o.digest(u),f=I.create(n.cidVersion,pt,h);return n.flush&&await e.repo.blocks.put(f,u),{node:l,cid:f,size:t.reduce((y,p)=>y+(p.Tsize||0),u.length)}},pT=async(e,t,r,n,i)=>{let s=new z0.Bucket({hash:r._options.hash,bits:r._options.bits},n,i);return n._putObjectAt(i,s),await Yy(e,t,s,r),s},mT=async e=>{let t=(0,z0.createHAMT)({hashFn:f8,bits:l8});return await Promise.all(e.map(async r=>{let n=r.Name||"";if(n.length===2){let i=parseInt(n,16),s=new z0.Bucket({hash:t._options.hash,bits:t._options.bits},t,i);return t._putObjectAt(i,s),Promise.resolve()}return t.put(n.substring(2),{size:r.Tsize,cid:r.Hash})})),t},Yy=async(e,t,r,n)=>{await Promise.all(t.map(async i=>{let s=i.Name||"";if(s.length===2){jy("Populating sub bucket",s);let a=parseInt(s,16),o=await e.repo.blocks.get(i.Hash),l=Rt(o),u=new z0.Bucket({hash:n._options.hash,bits:n._options.bits},r,a);return r._putObjectAt(a,u),await Yy(e,l.Links,u,n),Promise.resolve()}return n.put(s.substring(2),{size:i.Tsize,cid:i.Hash})}))},Fh=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),jj=async(e,t,r)=>{let n=await mT(r.Links),i=await n._findNewBucketAndPos(t),s=[{bucket:i.bucket,prefix:Fh(i.pos)}],a=i.bucket;for(;a!==n;)s.push({bucket:a,prefix:Fh(a._posAtParent)}),a=a._parent;s.reverse(),s[0].node=r;for(let o=0;o<s.length;o++){let l=s[o];if(!l.node)throw new Error("Could not generate HAMT path");let u=l.node.Links.filter(p=>(p.Name||"").substring(0,2)===l.prefix).pop();if(!u){jy(`Link ${l.prefix}${t} will be added`);continue}if(u.Name===`${l.prefix}${t}`){jy(`Link ${l.prefix}${t} will be replaced`);continue}jy(`Found subshard ${l.prefix}`);let h=await e.repo.blocks.get(u.Hash),f=Rt(h);if(!s[o+1]){jy(`Loaded new subshard ${l.prefix}`),await pT(e,f.Links,n,l.bucket,parseInt(l.prefix,16));let p=await n._findNewBucketAndPos(t);s.push({bucket:p.bucket,prefix:Fh(p.pos),node:f});continue}let y=s[o+1];await Yy(e,f.Links,y.bucket,n),y.node=f}return await n.put(t,!0),s.reverse(),{rootBucket:n,path:s}},Yj=async(e,t,r={})=>{let n=new q0({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},r);for(let s=0;s<t.length;s++)await n._bucket.put(t[s].name,{size:t[s].size,cid:t[s].cid});let i=await(0,Wj.default)(n.flush(e.repo.blocks));if(!i)throw new Error("Flushing shard yielded no result");return i},Ka=w(K(),1),Qj=w(qi(),1),Va=C("ipfs:mfs:core:utils:add-link");async function ns(e,t){let r=t.parent;if(t.parentCid){let i=I.asCID(t.parentCid);if(i===null)throw(0,Ka.default)(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(i.code!==pt)throw(0,Ka.default)(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");Va(`Loading parent node ${i}`);let s=await e.repo.blocks.get(i);r=Rt(s)}if(!r)throw(0,Ka.default)(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!t.cid)throw(0,Ka.default)(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!t.name)throw(0,Ka.default)(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!t.size&&t.size!==0)throw(0,Ka.default)(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!r.Data)throw(0,Ka.default)(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let n=Je.unmarshal(r.Data);return n.type==="hamt-sharded-directory"?(Va("Adding link to sharded directory"),w7e(e,{...t,parent:r})):r.Links.length>=t.shardSplitThreshold?(Va("Converting directory to sharded directory"),y7e(e,{...t,parent:r,mtime:n.mtime,mode:n.mode})):(Va(`Adding ${t.name} (${t.cid}) to regular directory`),g7e(e,{...t,parent:r}))}var y7e=async(e,t)=>{let r=await Yj(e,t.parent.Links.map(n=>({name:n.Name||"",size:n.Tsize||0,cid:n.Hash})).concat({name:t.name,size:t.size,cid:t.cid}),t);return Va(`Converted directory to sharded directory ${r.cid}`),r},g7e=async(e,t)=>{let r=t.parent.Links.filter(u=>u.Name!==t.name);if(r.push({Name:t.name,Tsize:t.size,Hash:t.cid}),!t.parent.Data)throw(0,Ka.default)(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let n=Je.unmarshal(t.parent.Data),i;if(n.mtime){let u=Date.now(),h=Math.floor(u/1e3);n.mtime={secs:h,nsecs:(u-h*1e3)*1e3},i=n.marshal()}else i=t.parent.Data;t.parent=Ln({Data:i,Links:r});let s=await e.hashers.getHasher(t.hashAlg),a=je(t.parent),o=await s.digest(a),l=I.create(t.cidVersion,pt,o);return t.flush&&await e.repo.blocks.put(l,a),{node:t.parent,cid:l,size:a.length}},w7e=async(e,t)=>{let{shard:r,path:n}=await E7e(e,t),i=await(0,Qj.default)(r.flush(e.repo.blocks));if(!i)throw new Error("No result from flushing shard");let s=await e.repo.blocks.get(i.cid),a=Rt(s),o=t.parent.Links.filter(u=>(u.Name||"").substring(0,2)!==n[0].prefix),l=a.Links.find(u=>(u.Name||"").substring(0,2)===n[0].prefix);if(!l)throw new Error(`No link found with prefix ${n[0].prefix}`);return o.push(l),H0(e,o,n[0].bucket,t)},E7e=async(e,t)=>{let r={name:t.name,cid:t.cid,size:t.size};if(!t.parent.Data)throw(0,Ka.default)(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let n=await mT(t.parent.Links),i=Je.unmarshal(t.parent.Data),s=new q0({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:i.mode},t);s._bucket=n,i.mtime&&(s.mtime={secs:Math.round(Date.now()/1e3)});let a=await n._findNewBucketAndPos(r.name),o=b7e(a);o[0].node=t.parent;let l=0;for(;l<o.length;){let u=o[l];l++;let h=u.node;if(!h)throw new Error("Segment had no node");let f=h.Links.find(d=>(d.Name||"").substring(0,2)===u.prefix);if(!f){Va(`Link ${u.prefix}${r.name} will be added`),l=o.length;break}if(f.Name===`${u.prefix}${r.name}`){Va(`Link ${u.prefix}${r.name} will be replaced`),l=o.length;break}if((f.Name||"").length>2){Va(`Link ${f.Name} ${f.Hash} will be replaced with a subshard`),l=o.length;break}Va(`Found subshard ${u.prefix}`);let y=await e.repo.blocks.get(f.Hash),p=Rt(y);if(!o[l]){Va(`Loaded new subshard ${u.prefix}`),await pT(e,p.Links,n,u.bucket,parseInt(u.prefix,16));let d=await n._findNewBucketAndPos(r.name);o.push({bucket:d.bucket,prefix:Fh(d.pos),node:p});break}let v=o[l];await Yy(e,p.Links,v.bucket,n),v.node=p}return await s._bucket.put(r.name,{size:r.size,cid:r.cid}),{shard:s,path:o}},b7e=e=>{let t=[{bucket:e.bucket,prefix:Fh(e.pos)}],r=e.bucket._parent,n=e.bucket._posAtParent;for(;r;)t.push({bucket:r,prefix:Fh(n)}),n=r._posAtParent,r=r._parent;return t.reverse(),t};c();var Xj=C("ipfs:mfs:utils:update-tree"),_7e={shardSplitThreshold:1e3};async function go(e,t,r){r=Object.assign({},_7e,r),Xj("Trail",t),t=t.slice().reverse();let n=0,i;for await(let a of e.repo.blocks.getMany(t.map(o=>o.cid))){let o=Rt(a),l=t[n].cid,u=t[n].name;if(n++,!i){i={cid:l,name:u,size:a.length};continue}let h=await ns(e,{parent:o,name:i.name,cid:i.cid,size:i.size,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold,hashAlg:r.hashAlg,cidVersion:r.cidVersion});i={cid:h.cid,name:u,size:h.size}}let{cid:s}=i;return Xj(`Final CID ${s}`),s}c();var Zj=w(K(),1),v7e=C("ipfs:mfs:utils:update-mfs-root");async function wo(e,t,r){if(r&&r.signal&&r.signal.aborted)throw(0,Zj.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return v7e(`New MFS root will be ${t}`),await e.repo.datastore.put(w2,t.bytes),t}te();var aY=w(qi(),1);c(),c();var Kh=w(K(),1);c(),te();async function Jj(e,t,r){let n=new Je({type:t,mode:r.mode,mtime:r.mtime}),i=await e.hashers.getHasher(r.hashAlg),s={Data:n.marshal(),Links:[]},a=je(s),o=await i.digest(a),l=I.create(r.cidVersion,pt,o);return r.flush&&await e.repo.blocks.put(l,a),{cid:l,node:s}}var S7e=Ze.bind({ignoreUndefined:!0}),eY=C("ipfs:mfs:mkdir"),x7e={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function Vh(e){async function t(r,n={}){let i=S7e(x7e,n);if(!r)throw new Error("no path given to Mkdir");if(r=r.trim(),r==="/"){if(i.parents)return;throw(0,Kh.default)(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(r.substring(0,1)!=="/")throw(0,Kh.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");eY(`Creating ${r}`);let s=V0(r);if(s[0]==="ipfs")throw(0,Kh.default)(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let a=await K0(e,i),o,l=[],u=await Jj(e,"directory",i);for(let f=0;f<=s.length;f++){let y=s.slice(0,f),p=`/ipfs/${a}/${y.join("/")}`;try{if(o=await ti(p,e.repo.blocks),o.type!=="file"&&o.type!=="directory")throw(0,Kh.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(f===s.length){if(i.parents)return;throw(0,Kh.default)(new Error("file already exists"),"ERR_ALREADY_EXISTS")}l.push({name:o.name,cid:o.cid})}catch(v){if(v.code==="ERR_NOT_FOUND"){if(f<s.length&&!i.parents)throw(0,Kh.default)(new Error(`Intermediate directory path ${p} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await R7e(e,y[y.length-1],u,l[l.length-1],l,i)}else throw v}}let h=await go(e,l,i);await wo(e,h,i)}return B(t)}var R7e=async(e,t,r,n,i,s)=>{eY(`Adding empty dir called ${t} to ${n.cid}`);let a=await ns(e,{parent:n.node,parentCid:n.cid,size:0,cid:r.cid,name:t,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});i[i.length-1].cid=a.cid,i.push({name:t,cid:r.cid})},Ol=w(K(),1),A7e=Ze.bind({ignoreUndefined:!0}),d8=C("ipfs:mfs:cp"),T7e={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function $0(e){async function t(r,n,i={}){let s=A7e(T7e,i);Array.isArray(r)||(r=[r]);let a=await Promise.all(r.map(y=>Wr(e,y,s))),o=await Wr(e,n,s);if(!a.length||!o)throw(0,Ol.default)(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let l=a.find(y=>!y.exists);if(l)throw(0,Ol.default)(new Error(`${l.path} does not exist`),"ERR_INVALID_PARAMS");let u=tY(o);if(o.exists){if(d8("Destination exists"),a.length===1&&!u)throw(0,Ol.default)(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(d8("Destination does not exist"),a.length>1){if(!s.parents)throw(0,Ol.default)(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await Vh(e)(o.path,s),o=await Wr(e,o.path,s)}else if(o.parts.length>1){let y=`/${o.parts.slice(0,-1).join("/")}`;try{await Nl(e)(y,s)}catch(p){if(p.code!=="ERR_NOT_FOUND")throw p;if(!s.parents)throw(0,Ol.default)(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await Vh(e)(y,s),o=await Wr(e,o.path,s)}}let h=tY(o)?o.mfsPath:o.mfsDirectory,f=await Fa(e,h);if(a.length===1){let y=a.pop();if(!y)throw(0,Ol.default)(new Error("could not find source"),"ERR_INVALID_PARAMS");let p=u?y.name:o.name;return d8(`Only one source, copying to destination ${u?"directory":"file"} ${p}`),I7e(e,y,p,f,s)}return d8("Multiple sources, wrapping in a directory"),C7e(e,a,o,f,s)}return B(t)}var tY=e=>e.unixfs&&e.unixfs.type&&e.unixfs.type.includes("directory"),I7e=async(e,t,r,n,i)=>{let s=n.pop();if(!s)throw(0,Ol.default)(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await rY(e,t,r,s,i),n.push(s);let a=await go(e,n,i);await wo(e,a,i)},C7e=async(e,t,r,n,i)=>{for(let a=0;a<t.length;a++){let o=t[a];r=await rY(e,o,o.name,r,i)}n[n.length-1]=r;let s=await go(e,n,i);await wo(e,s,i)},rY=async(e,t,r,n,i)=>{let s=await e.repo.blocks.get(t.cid),{node:a,cid:o,size:l}=await ns(e,{parentCid:n.cid,size:s.length,cid:t.cid,name:r,hashAlg:i.hashAlg,cidVersion:i.cidVersion,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold});return n.node=a,n.cid=o,n.size=l,n};c();var Qy=w(K(),1);c(),te();var Ll=w(K(),1),Bl=C("ipfs:mfs:core:utils:remove-link");async function nY(e,t){let r=t.parent;if(t.parentCid){let n=I.asCID(t.parentCid);if(n===null)throw(0,Ll.default)(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");Bl(`Loading parent node ${n}`);let i=await e.repo.blocks.get(n);r=Rt(i)}if(!r)throw(0,Ll.default)(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!t.name)throw(0,Ll.default)(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!r.Data)throw(0,Ll.default)(new Error("Parent node had no data"),"ERR_INVALID_NODE");return Je.unmarshal(r.Data).type==="hamt-sharded-directory"?(Bl(`Removing ${t.name} from sharded directory`),D7e(e,{...t,parent:r})):(Bl(`Removing link ${t.name} regular directory`),P7e(e,{...t,parent:r}))}var P7e=async(e,t)=>{t.parent.Links=t.parent.Links.filter(s=>s.Name!==t.name);let r=await je(t.parent),n=await(await e.hashers.getHasher(t.hashAlg)).digest(r),i=I.create(t.cidVersion,pt,n);return await e.repo.blocks.put(i,r),Bl(`Updated regular directory ${i}`),{node:t.parent,cid:i}},D7e=async(e,t)=>{let{rootBucket:r,path:n}=await jj(e,t.name,t.parent);await r.del(t.name);let{node:i}=await iY(e,n,t.name,t);return H0(e,i.Links,r,t)},iY=async(e,t,r,n)=>{let i=t.pop();if(!i)throw(0,Ll.default)(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:s,prefix:a,node:o}=i;if(!o)throw(0,Ll.default)(new Error("Could not find parent"),"EINVALIDPARENT");let l=o.Links.find(p=>(p.Name||"").substring(0,2)===a);if(!l)throw(0,Ll.default)(new Error(`No link found with prefix ${a} for file ${r}`),"ERR_NOT_FOUND");if(l.Name===`${a}${r}`){Bl(`Removing existing link ${l.Name}`);let p=o.Links.filter(v=>v.Name!==l.Name);return await s.del(r),H0(e,p,s,n)}Bl(`Descending into sub-shard ${l.Name} for ${a}${r}`);let u=await iY(e,t,r,n),h=u.cid,f=u.size,y=a;if(u.node.Links.length===1){Bl(`Removing subshard for ${a}`);let p=u.node.Links[0];y=`${a}${(p.Name||"").substring(2)}`,h=p.Hash,f=p.Tsize||0}return Bl(`Updating shard ${a} with name ${y}`),k7e(e,s,o,a,y,f,h,n)},k7e=(e,t,r,n,i,s,a,o)=>{let l=r.Links.filter(u=>u.Name!==n);return l.push({Name:i,Tsize:s,Hash:a}),H0(e,l,t,o)},N7e=Ze.bind({ignoreUndefined:!0}),O7e={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function G0(e){async function t(r,n={}){let i=N7e(O7e,n);Array.isArray(r)||(r=[r]);let s=await Promise.all(r.map(a=>Wr(e,a,i)));if(!s.length)throw(0,Qy.default)(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach(a=>{if(a.path==="/")throw(0,Qy.default)(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let a of s)await L7e(e,a.path,i)}return B(t)}var L7e=async(e,t,r)=>{let n=await Wr(e,t,r),i=await Fa(e,n.mfsPath),s=i[i.length-1];i.pop();let a=i[i.length-1];if(!a)throw(0,Qy.default)(new Error(`${t} does not exist`),"ERR_NOT_FOUND");if(s.type==="directory"&&!r.recursive)throw(0,Qy.default)(new Error(`${t} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:o}=await nY(e,{parentCid:a.cid,name:s.name,hashAlg:r.hashAlg,cidVersion:r.cidVersion,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold});a.cid=o;let l=await go(e,i,r);await wo(e,l,r)},B7e=Ze.bind({ignoreUndefined:!0}),M7e=C("ipfs:mfs:touch"),oY={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function U7e(e,t,r){let n=0;return(e.includes("x")||e.includes("X")&&(r||t&1||t&8||t&64))&&(n+=1),e.includes("w")&&(n+=2),e.includes("r")&&(n+=4),n}function F7e(e,t){let r=0;return e.includes("u")&&(r+=t<<6),e.includes("g")&&(r+=t<<3),e.includes("o")&&(r+=t),r}function K7e(e,t,r){return t.includes("t")&&(r+=parseInt("1000",8)),t.includes("s")&&(e.includes("u")&&(r+=parseInt("4000",8)),e.includes("g")&&(r+=parseInt("2000",8))),r}function V7e(e,t,r){t||(t=0);let n=e.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!n)throw new Error(`Invalid file mode: ${e}`);let[,i,s,a]=n;(i==="a"||!i)&&(i="ugo");let o=U7e(a,t,r);return o=F7e(i,o),o=K7e(i,a,o),s==="="?(i.includes("u")&&(t=t&parseInt("7077",8),t=t|o),i.includes("g")&&(t=t&parseInt("7707",8),t=t|o),i.includes("o")&&(t=t&parseInt("7770",8),t=t|o),t):s==="+"?o|t:s==="-"?o^t:t}function sY(e,t){if(e instanceof String||typeof e=="string"){let r=`${e}`;r.match(/^\d+$/g)?e=parseInt(r,8):e=0+r.split(",").reduce((n,i)=>V7e(i,n,t.isDirectory()),t.mode||0)}return e}function cY(e){async function t(r,n,i={}){let s=B7e(oY,i);M7e(`Fetching stats for ${r}`);let{cid:a,mfsDirectory:o,name:l}=await Wr(e,r,s);if(a.code!==pt)throw(0,W0.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){let R=await Te(async function*(){for await(let T of x5(a,e.repo.blocks)){if(T.type!=="file"&&T.type!=="directory")throw(0,W0.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");T.unixfs.mode=sY(n,T.unixfs);let S=Ln({Data:T.unixfs.marshal(),Links:T.node.Links});yield{path:T.path,content:S}}},T=>x0(T,e.repo.blocks,{...s,pin:!1,dagBuilder:async function*(S,O,F){for await(let G of S)yield async function(){let ne=G.content,Y=je(ne),ce=await c8(Y,O,F);if(!ne.Data)throw(0,W0.default)(new Error(`${ce} had no data`),"ERR_INVALID_NODE");let oe=Je.unmarshal(ne.Data);return{cid:ce,size:Y.length,path:G.path,unixfs:oe}}}}),T=>(0,aY.default)(T));if(!R)throw(0,W0.default)(new Error(`Could not chmod ${r}`),"ERR_COULD_NOT_CHMOD");await G0(e)(r,s),await $0(e)(`/ipfs/${R.cid}`,r,s);return}let u=await e.repo.blocks.get(a),h=Rt(u);if(!h.Data)throw(0,W0.default)(new Error(`${a} had no data`),"ERR_INVALID_NODE");let f=Je.unmarshal(h.Data);f.mode=sY(n,f);let y=je({Data:f.marshal(),Links:h.Links}),p=s.hashAlg||oY.hashAlg,v=await(await e.hashers.getHasher(p)).digest(y),d=I.create(s.cidVersion,pt,v);s.flush&&await e.repo.blocks.put(d,y);let g=await Fa(e,o),b=g[g.length-1],_=I.decode(b.cid.bytes),m=await e.repo.blocks.get(_),E=Rt(m),D=await ns(e,{parent:E,name:l,cid:d,size:y.length,flush:s.flush,hashAlg:p,cidVersion:a.version,shardSplitThreshold:1/0});b.cid=D.cid;let N=await go(e,g,s);await wo(e,N,s)}return B(t)}c();var q7e=Ze.bind({ignoreUndefined:!0}),z7e={};function uY(e){async function t(r,n={}){n=q7e(z7e,n);let{cid:i}=await Nl(e)(r,n);return i}return B(t)}c();var H7e=Ze.bind({ignoreUndefined:!0}),$7e={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};function lY(e){async function t(r,n,i={}){let s=H7e($7e,i);await $0(e)(r,n,s),await G0(e)(r,{...s,recursive:!0})}return B(t)}c();var yT=w(K(),1);te();var G7e=Ze.bind({ignoreUndefined:!0}),W7e=C("ipfs:mfs:touch"),fY={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};function hY(e){async function t(r,n={}){let i=G7e(fY,n);i.mtime=i.mtime||new Date,W7e(`Touching ${r} mtime: ${i.mtime}`);let{cid:s,mfsDirectory:a,name:o,exists:l}=await Wr(e,r,i),u=n.hashAlg||fY.hashAlg,h=await e.hashers.getHasher(u),f,y,p=i.cidVersion;if(l){if(s.code!==pt)throw(0,yT.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");p=s.version;let D=await e.repo.blocks.get(s),N=Rt(D);if(!N.Data)throw(0,yT.default)(new Error(`${r} had no data`),"ERR_INVALID_NODE");let R=Je.unmarshal(N.Data);R.mtime=i.mtime,f=je({Data:R.marshal(),Links:N.Links});let T=await h.digest(f);y=I.create(i.cidVersion,pt,T),i.flush&&await e.repo.blocks.put(y,f)}else{let D=new Je({type:"file",mtime:i.mtime});f=je({Data:D.marshal(),Links:[]});let N=await h.digest(f);y=I.create(i.cidVersion,pt,N),i.flush&&await e.repo.blocks.put(y,f)}let v=await Fa(e,a),d=v[v.length-1],g=d.cid,b=await e.repo.blocks.get(g),_=Rt(b),m=await ns(e,{parent:_,name:o,cid:y,size:f.length,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold,hashAlg:i.hashAlg,cidVersion:p});d.cid=m.cid;let E=await go(e,v,i);await wo(e,E,i)}return B(t)}c();var gT=w(K(),1),j7e=Ze.bind({ignoreUndefined:!0}),Y7e={offset:0,length:1/0};function dY(e){function t(r,n={}){return n=j7e(Y7e,n),{[Symbol.asyncIterator]:async function*(){let i=await Wr(e,r,n),s=await ti(i.mfsPath,e.repo.blocks);if(s.type!=="file")throw(0,gT.default)(new Error(`${r} was not a file`),"ERR_NOT_FILE");if(!s.content)throw(0,gT.default)(new Error(`Could not load content stream from ${r}`),"ERR_NO_CONTENT");for await(let a of s.content({offset:n.offset,length:n.length}))yield a}}}return B(t)}c(),c();var wT=w(K(),1);Re();var Xy=C("ipfs:mfs:utils:to-async-iterator");function pY(e){if(!e)throw(0,wT.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof e=="string"||e instanceof String)&&(Xy("Content was a string"),e=U(e.toString())),e.length)return Xy("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield e}};if(e[Symbol.asyncIterator])return Xy("Content was an async iterator"),e;if(e[Symbol.iterator])return Xy("Content was an iterator"),e;if(globalThis.Blob&&e instanceof globalThis.Blob){Xy("Content was an HTML5 Blob");let t=0,r={next:()=>t>e.size?{done:!0}:new Promise((n,i)=>{let s=e.slice(t,E2);t+=E2;let a=new globalThis.FileReader,o=l=>{if(a.removeEventListener("loadend",o,!1),l.error)return i(l.error);n({done:!1,value:new Uint8Array(a.result)})};a.addEventListener("loadend",o),a.readAsArrayBuffer(s)})};return{[Symbol.asyncIterator]:()=>r}}throw(0,wT.default)(new Error(`Don't know how to convert ${e} into an async iterator`),"ERR_INVALID_PARAMS")}var za=w(K(),1),yY=w(qi(),1),Q7e=Ze.bind({ignoreUndefined:!0}),qa=C("ipfs:mfs:write"),X7e={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(e,t)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};function gY(e){async function t(r,n,i={}){let s=Q7e(X7e,i),a,o,l;if(qa("Reading source, destination and parent"),await Wy().readLock(async()=>{a=await pY(n),o=await Wr(e,r,s),l=await Wr(e,o.mfsDirectory,s)})(),qa("Read source, destination and parent"),!s.parents&&!l.exists)throw(0,za.default)(new Error("directory does not exist"),"ERR_NO_EXIST");if(a==null)throw(0,za.default)(new Error("could not create source"),"ERR_NO_SOURCE");if(o==null)throw(0,za.default)(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!o.exists)throw(0,za.default)(new Error("file does not exist"),"ERR_NO_EXIST");if(o.entryType!=="file")throw(0,za.default)(new Error("not a file"),"ERR_NOT_A_FILE");return Z7e(e,r,a,o,s)}return B(t)}var Z7e=async(e,t,r,n,i)=>{let s=await J7e(e,r,n,i);await Wy().writeLock(async()=>{let a=V0(t),o=a.pop();if(o==null)throw(0,za.default)(new Error("source does not exist"),"ERR_NO_EXIST");let l=!1;try{await Nl(e)(`/${a.join("/")}`,i),l=!0}catch(g){if(g.code!=="ERR_NOT_FOUND")throw g}l||await Vh(e)(`/${a.join("/")}`,i);let u=await Wr(e,t,i),h=await Fa(e,u.mfsDirectory),f=h[h.length-1];if(!f)throw(0,za.default)(new Error("directory does not exist"),"ERR_NO_EXIST");if(!f.type||!f.type.includes("directory"))throw(0,za.default)(new Error(`cannot write to ${f.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let y=await e.repo.blocks.get(f.cid),p=Rt(y),v=await ns(e,{parent:p,name:o,cid:s.cid,size:s.size,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold,hashAlg:i.hashAlg,cidVersion:i.cidVersion});f.cid=v.cid;let d=await go(e,h,i);await wo(e,d,i)})()},J7e=async(e,t,r,n)=>{r.exists?qa(`Overwriting file ${r.cid} offset ${n.offset} length ${n.length}`):qa(`Writing file offset ${n.offset} length ${n.length}`);let i=[];if(n.offset>0)if(r.unixfs){if(qa(`Writing first ${n.offset} bytes of original file`),i.push(()=>r.content({offset:0,length:n.offset})),r.unixfs.fileSize()<n.offset){let h=n.offset-r.unixfs.fileSize();qa(`Writing zeros for extra ${h} bytes`),i.push(mY(h))}}else qa(`Writing zeros for first ${n.offset} bytes`),i.push(mY(n.offset));i.push(wY(t,n.length));let s=t9e(e9e(i),h=>{if(r.unixfs&&!n.truncate){let f=r.unixfs.fileSize();if(f>h)return qa(`Writing last ${f-h} of ${f} bytes from original file starting at offset ${h}`),r.content({offset:h});qa("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),a;n.mode!==void 0&&n.mode!==null?a=Ec(n.mode):r&&r.unixfs&&(a=r.unixfs.mode);let o;n.mtime!=null?o=qu(n.mtime):r&&r.unixfs&&(o=r.unixfs.mtime);let l=await e.hashers.getHasher(n.hashAlg),u=await(0,yY.default)(x0([{content:s,mode:a,mtime:o}],e.repo.blocks,{progress:n.progress,hasher:l,cidVersion:n.cidVersion,strategy:n.strategy,rawLeaves:n.rawLeaves,reduceSingleLeafToSelf:n.reduceSingleLeafToSelf,leafType:n.leafType}));if(!u)throw(0,za.default)(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return qa(`Wrote ${u.cid}`),{cid:u.cid,size:u.size}},wY=(e,t)=>async function*(){let r=0;for await(let n of e){if(r+=n.length,r>t){yield n.slice(0,t-r);return}yield n}},mY=(e,t=E2)=>{let r=new Uint8Array(t);async function*n(){for(;;)yield r.slice()}return wY(n(),e)},e9e=async function*(e){for(let t=0;t<e.length;t++)yield*e[t]()},t9e=async function*(e,t){let r=0;for await(let n of e)r+=n.length,yield n;for await(let n of t(r))r+=n.length,yield n};c();var bY=w(ei(),1),EY=e=>{let t={cid:e.cid,name:e.name,type:e.type==="directory"?"directory":"file",size:e.size};return(e.type==="file"||e.type==="directory")&&(t.mode=e.unixfs.mode,t.mtime=e.unixfs.mtime),t};function _Y(e){async function*t(r,n={}){let i=await Wr(e,r,n),s=await ti(i.mfsPath,e.repo.blocks);if(s.type==="directory"){yield*(0,bY.default)(s.content(n),EY);return}yield EY(s)}return B(t)}var r9e={stat:Nl},n9e={chmod:cY,cp:$0,flush:uY,mkdir:Vh,mv:lY,rm:G0,touch:hY},vY={write:gY,read:dY,ls:_Y},SY=({options:e,mfs:t,operations:r,lock:n})=>{Object.keys(r).forEach(i=>{t[i]=n(r[i](e))})},i9e={repoOwner:!0,repo:null};function o9e(e){let{repoOwner:t}=Object.assign({},i9e||{},e),r=Wy(t),n=a=>r.readLock(a),i=a=>r.writeLock(a),s={};return SY({options:e,mfs:s,operations:r9e,lock:n}),SY({options:e,mfs:s,operations:n9e,lock:i}),Object.keys(vY).forEach(a=>{s[a]=vY[a](e)}),s}function xY({repo:e,preload:t,hashers:r,options:n}){let i=o9e({repo:e,repoOwner:n.repoOwner!==!1,hashers:r}),s=a=>(...o)=>{let l=o.filter(u=>ET.default.ipfsPath(u)||ET.default.cid(u));if(l.length){let u=o[o.length-1];u&&u.preload!==!1&&l.forEach(h=>t(h))}return a(...o)};return{...i,chmod:i.chmod,cp:s(i.cp),mkdir:i.mkdir,stat:s(i.stat),rm:i.rm,read:s(i.read),touch:i.touch,write:i.write,mv:s(i.mv),flush:i.flush,ls:s(async function*(...a){for await(let o of i.ls(...a))yield{...o,size:o.size||0}})}}c(),c();function RY({keychain:e}){return B((t,r)=>e.exportKey(t,r))}c();var AY="Ed25519",TY=2048;function IY({keychain:e}){return B((t,r={type:AY,size:TY})=>e.createKey(t,r.type||AY,r.size||TY))}c();function CY({keychain:e}){return B((t,r,n)=>e.importKey(t,r,n))}c();function PY({keychain:e}){return B(t=>e.findKeyByName(t))}c();function DY({keychain:e}){return B(()=>e.listKeys())}c();function kY({keychain:e}){return B(async(t,r)=>{let n=await e.renameKey(t,r);return{was:t,now:n.name,id:n.id,overwrite:!1}})}c();function NY({keychain:e}){return B(t=>e.removeKey(t))}var p8=class{constructor({keychain:e}){this.gen=IY({keychain:e}),this.list=DY({keychain:e}),this.rm=NY({keychain:e}),this.rename=kY({keychain:e}),this.export=RY({keychain:e}),this.import=CY({keychain:e}),this.info=PY({keychain:e})}};c(),c(),c();function Yi({repo:e,preload:t}){async function r(n,i={}){i.preload!==!1&&t(n);let s=await e.blocks.get(n,i);return Rt(s)}return B(r)}function OY({repo:e,preload:t}){let r=Yi({repo:e,preload:t});async function n(i,s={}){return(await r(i,s)).Data||new Uint8Array(0)}return B(n)}c(),zo(),te();function bT(e,t=[]){for(let r in e){let n=e[r];if(r==="/"&&Object.keys(e).length===1)try{t.push({Name:"",Tsize:0,Hash:I.parse(n)});continue}catch{}let i=I.asCID(n);if(i){t.push({Name:"",Tsize:0,Hash:i});continue}Array.isArray(n)&&bT(n,t),n&&typeof n=="object"&&bT(n,t)}return t}function LY({repo:e,codecs:t}){async function r(n,i={}){let s=await t.getCodec(n.code),a=await e.blocks.get(n,i),o=s.decode(a);switch(n.code){case Un:return[];case pt:return o.Links;case qf:case $9:return bT(o);default:throw new Error(`Cannot resolve links from codec ${n.code}`)}}return B(r)}c(),vr(),te();function BY({repo:e,preload:t}){async function r(n={}){let i;if(n.template)if(n.template==="unixfs-dir")i=new Je({type:"directory"}).marshal();else throw new Error("unknown template");let s=je({Data:i,Links:[]}),a=await xe.digest(s),o=I.createV0(a);return await e.blocks.put(o,s,{signal:n.signal}),n.preload!==!1&&t(o),o}return B(r)}c(),te(),vr();function Ha({repo:e,preload:t}){async function r(n,i={}){let s=await e.gcLock.readLock();try{let a=je(n),o=await xe.digest(a),l=I.createV1(pt,o);return await e.blocks.put(l,a,{signal:i.signal}),i.preload!==!1&&t(l),i.pin&&await e.pins.pinRecursively(l,{signal:i.signal}),l}finally{s()}}return B(r)}c();function MY({repo:e,preload:t}){let r=Yi({repo:e,preload:t});async function n(i,s={}){let a=await r(i,s),o=je(a).length,l=a.Links.reduce((u,h)=>u+(h.Tsize||0),0);return{Hash:i,NumLinks:a.Links.length,BlockSize:o,LinksSize:o-(a.Data||[]).length,DataSize:(a.Data||[]).length,CumulativeSize:o+l}}return B(n)}c(),c();function UY({repo:e,preload:t}){let r=Yi({repo:e,preload:t}),n=Ha({repo:e,preload:t});async function i(s,a,o={}){let l=await r(s,o);return n({...l,Links:l.Links.concat([a])},o)}return B(i)}c(),ur();function FY({repo:e,preload:t}){let r=Yi({repo:e,preload:t}),n=Ha({repo:e,preload:t});async function i(s,a,o={}){let l=await r(s,o),u=Ae([l.Data||[],a]);return n({...l,Data:u},o)}return B(i)}c();function KY({repo:e,preload:t}){let r=Yi({repo:e,preload:t}),n=Ha({repo:e,preload:t});async function i(s,a,o={}){let l=await r(s,o),u=(typeof a=="string"?a:a.Name)||"";return l.Links=l.Links.filter(h=>h.Name!==u),n(l,o)}return B(i)}c();function VY({repo:e,preload:t}){let r=Yi({repo:e,preload:t}),n=Ha({repo:e,preload:t});async function i(s,a,o={}){let l=await r(s,o);return n({...l,Data:a},o)}return B(i)}var m8=class{constructor({repo:e,preload:t}){this.addLink=UY({repo:e,preload:t}),this.appendData=FY({repo:e,preload:t}),this.rmLink=KY({repo:e,preload:t}),this.setData=VY({repo:e,preload:t})}},y8=class{constructor({repo:e,codecs:t,preload:r}){this.data=OY({repo:e,preload:r}),this.get=Yi({repo:e,preload:r}),this.links=LY({repo:e,codecs:t}),this.new=BY({repo:e,preload:r}),this.put=Ha({repo:e,preload:r}),this.stat=MY({repo:e,preload:r}),this.patch=new m8({repo:e,preload:r})}};c(),c();var s9e=C("ipfs:repo:gc");function qY({repo:e,hashers:t}){async function*r(n={}){let i=Date.now(),s;try{s=await K0({repo:e,hashers:t},n),await e.pins.pinRecursively(s),yield*e.gc()}finally{s&&await e.pins.unpin(s)}s9e(`Complete (${Date.now()-i}ms)`)}return B(r)}c();function g8({repo:e}){async function t(r={}){let n=await e.stat();return{numObjects:BigInt(n.numObjects.toString()),repoSize:BigInt(n.repoSize.toString()),repoPath:n.repoPath,version:`${n.version}`,storageMax:BigInt(n.storageMax.toString())}}return B(t)}c(),c();function zY({repo:e}){async function t(r={}){try{await e._checkInitialized(r)}catch(n){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(i=>i.test(n.message)))return 12;throw n}return e.version.get()}return B(t)}var w8=class{constructor({repo:e,hashers:t}){this.gc=qY({repo:e,hashers:t}),this.stat=g8({repo:e}),this.version=zY({repo:e}),this.setApiAddr=r=>e.apiAddr.set(r)}};c(),c();var $Y=w(K(),1);function HY(e,t){let r;if(e.metrics?t.peer?r=e.metrics.forPeer(t.peer):t.proto?r=e.metrics.forProtocol(t.proto):r=e.metrics.getGlobal():r=void 0,!r)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};let n=r.getMovingAverages(),i=r.getSnapshot();return{totalIn:i.dataReceived,totalOut:i.dataSent,rateIn:n.dataReceived[6e4].movingAverage/60,rateOut:n.dataSent[6e4].movingAverage/60}}function GY({network:e}){return B(async function*(t={}){let{libp2p:r}=await e.use(t);if(!t.poll){yield HY(r,t);return}let n=t.interval||1e3,i=-1;try{if(i=typeof n=="string"?ju(n)||-1:n,!i||i<0)throw new Error("invalid duration")}catch(a){throw(0,$Y.default)(a,"ERR_INVALID_POLL_INTERVAL")}let s;try{for(;;)yield HY(r,t),await new Promise(a=>{s=setTimeout(a,i)})}finally{clearTimeout(s)}})}var E8=class{constructor({repo:e,network:t}){this.repo=g8({repo:e}),this.bw=GY({network:t}),this.bitswap=q6({network:t})}};c(),c(),c();var aI=w(_T(),1),eZ=w(Mi(),1),Xh=w(K(),1);c(),c(),c(),te();var QY=w(Mi(),1),XY=w(Jy(),1);si(),zo(),On();var l9e=(0,QY.default)("ipfs:repo:migrator:migration-8");function ZY(e){return e.child?ZY(e.child):e}function f9e(e){try{let t=xt.decode(`b${e.toString().toLowerCase().slice(1)}`),r=I.decode(t).multihash.bytes,n=xt.encode(r).slice(1).toUpperCase();return new ae(`/${n}`,!1)}catch{return e}}function h9e(e){try{let t=xt.decode(`b${e.toString().toLowerCase().slice(1)}`),r=_r(t),n=xt.encode(I.createV1(Un,r).bytes).slice(1);return new ae(`/${n.toUpperCase()}`,!1)}catch{return e}}async function YY(e,t,r){let n=e.blocks;await n.open();let i=ZY(n),s=await(0,XY.default)(i.queryKeys({filters:[a=>r(a).toString()!==a.toString()]}));try{let a=0;for await(let o of i.query({})){let l=r(o.key);l.toString()!==o.key.toString()&&(a+=1,l9e(`Migrating Block from ${o.key} to ${l}`,await i.has(o.key)),await i.delete(o.key),await i.put(l,o.value),t(a/s*100,`Migrated Block from ${o.key} to ${l}`))}}finally{await n.close()}}var JY={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(e,t=()=>{})=>YY(e,t,f9e),revert:(e,t=()=>{})=>YY(e,t,h9e)};c(),te(),Vf(),c(),te(),c();var qh=w(Ea(),1),eQ=qh.default.Reader,d9e=qh.default.Writer,ust=qh.default.util,b8=qh.default.roots.default||(qh.default.roots.default={}),tQ=b8.ipfs=(()=>{let e={};return e.pin=function(){let t={};return t.Set=function(){function r(n){if(n)for(var i=Object.keys(n),s=0;s<i.length;++s)n[i[s]]!=null&&(this[i[s]]=n[i[s]])}return r.prototype.version=0,r.prototype.fanout=0,r.prototype.seed=0,r.encode=function(n,i){return i||(i=d9e.create()),n.version!=null&&Object.hasOwnProperty.call(n,"version")&&i.uint32(8).uint32(n.version),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&i.uint32(16).uint32(n.fanout),n.seed!=null&&Object.hasOwnProperty.call(n,"seed")&&i.uint32(29).fixed32(n.seed),i},r.decode=function(n,i){n instanceof eQ||(n=eQ.create(n));for(var s=i===void 0?n.len:n.pos+i,a=new b8.ipfs.pin.Set;n.pos<s;){var o=n.uint32();switch(o>>>3){case 1:a.version=n.uint32();break;case 2:a.fanout=n.uint32();break;case 3:a.seed=n.fixed32();break;default:n.skipType(o&7);break}}return a},r.fromObject=function(n){if(n instanceof b8.ipfs.pin.Set)return n;var i=new b8.ipfs.pin.Set;return n.version!=null&&(i.version=n.version>>>0),n.fanout!=null&&(i.fanout=n.fanout>>>0),n.seed!=null&&(i.seed=n.seed>>>0),i},r.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(s.version=0,s.fanout=0,s.seed=0),n.version!=null&&n.hasOwnProperty("version")&&(s.version=n.version),n.fanout!=null&&n.hasOwnProperty("fanout")&&(s.fanout=n.fanout),n.seed!=null&&n.hasOwnProperty("seed")&&(s.seed=n.seed),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,qh.default.util.toJSONOptions)},r}(),t}(),e})(),oQ=w(nQ(),1),S8=w(ai(),1);c(),si(),te();var eg=new ae("/local/pins"),v8=256,iQ=8192,ST=I.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),zh={direct:"direct",recursive:"recursive"};function xT(e){return new ae(`/${xt.encode(e.multihash.bytes).toUpperCase().substring(1)}`)}ur(),me(),Re(),vr();var RT=tQ.pin.Set;function p9e(e){let t=e.Data;if(!t)throw new Error("No data present");let r=S8.default.decode(t),n=S8.default.decode.bytes;if(n<=0)throw new Error("Invalid Set header length");if(n+r>t.length)throw new Error("Impossibly large set header length");let i=t.slice(n,r+n),s=RT.toObject(RT.decode(i),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(s.version!==1)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>e.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:t.slice(r+n)}}function m9e(e,t){let r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,e,!0);let n=U(t.toString()),i=Ae([r,n],r.byteLength+n.byteLength);return(0,oQ.default)(M(i))}async function*sQ(e,t){let r=p9e(t),n=0;for(let i of t.Links){if(n<r.header.fanout){let s=i.Hash;if(!ST.equals(s)){let a=await e.get(s),o=Rt(a);yield*sQ(e,o)}}else yield i.Hash;n++}}async function*tg(e,t,r){let n=t.Links.find(a=>a.Name===r);if(!n)throw new Error("No link found with name "+r);let i=await e.get(n.Hash),s=Rt(i);yield*sQ(e,s)}function y9e(e,t){return r(t,0);async function r(n,i){let s=RT.encode({version:1,fanout:v8,seed:i}).finish(),a=S8.default.encode(s.length),o=Ae([a,s]),l=[];for(let h=0;h<v8;h++)l.push({Name:"",Tsize:1,Hash:ST});if(n.length<=iQ){let h=n.map(y=>({link:{Name:"",Tsize:1,Hash:y.key},data:y.data||new Uint8Array})).sort((y,p)=>eh(y.link.Hash.bytes,p.link.Hash.bytes)),f=l.concat(h.map(y=>y.link));return{Data:Ae([o,...h.map(y=>y.data)]),Links:f}}else{let h=n.reduce((y,p)=>{let v=m9e(i,p.key)%v8;return y[v]=v in y?y[v].concat([p]):[p],y},[]),f=0;for(let y of h){let p=await r(y,i+1);await u(p,f),f++}return{Data:o,Links:l}}async function u(h,f){let y=je(h),p=await xe.digest(y),v=I.createV0(p);await e.put(v,y);let d=h.Links.reduce((g,b)=>g+(b.Tsize||0),0)+y.length;l[f]={Name:"",Tsize:d,Hash:v}}}}async function AT(e,t,r){let n=await y9e(e,r.map(l=>({key:l}))),i=je(n),s=await xe.digest(i),a=I.createV0(s);await e.put(a,i);let o=n.Links.reduce((l,u)=>l+u.Tsize,0)+i.length;return{Name:t,Tsize:o,Hash:a}}var x8=w(Jy(),1);vr(),On(),si();async function w9e(e,t,r,n){if(!await t.has(eg))return;let i=await t.get(eg),s=I.decode(i),a=await e.get(s),o=Rt(a),l=0,u=await(0,x8.default)(tg(e,o,zh.recursive))+await(0,x8.default)(tg(e,o,zh.direct));for await(let h of tg(e,o,zh.recursive)){l++;let f={depth:1/0};h.version!==0&&(f.version=h.version),h.code!==pt&&(f.codec=h.code),await r.put(xT(h),ao(f)),n(l/u*100,`Migrated recursive pin ${h}`)}for await(let h of tg(e,o,zh.direct)){l++;let f={depth:0};h.version!==0&&(f.version=h.version),h.code!==pt&&(f.codec=h.code),await r.put(xT(h),ao(f)),n(l/u*100,`Migrated direct pin ${h}`)}await e.delete(s),await t.delete(eg)}async function E9e(e,t,r,n){let i=[],s=[],a=0,o=await(0,x8.default)(r.queryKeys({}));for await(let{key:y,value:p}of r.query({})){a++;let v=Mn(p),d=I.create(v.version||0,v.codec||pt,_r(xt.decode("b"+y.toString().toLowerCase().split("/").pop())));v.depth===0?(n(a/o*100,`Reverted direct pin ${d}`),s.push(d)):(n(a/o*100,`Reverted recursive pin ${d}`),i.push(d))}n(100,"Updating pin root");let l={Links:[await AT(e,zh.direct,s),await AT(e,zh.recursive,i)]},u=je(l),h=await xe.digest(u),f=I.createV0(h);await e.put(f,u),await t.put(eg,f.bytes)}async function aQ(e,t,r){let n=e.blocks,i=e.datastore,s=e.pins;await n.open(),await i.open(),await s.open();try{await r(n,i,s,t)}finally{await s.close(),await i.close(),await n.close()}}var cQ={version:9,description:"Migrates pins to datastore",migrate:(e,t=()=>{})=>aQ(e,t,w9e),revert:(e,t=()=>{})=>aQ(e,t,E9e)};c(),c();var uQ=new ae("/config"),rg=new ae("/version");function ng(e){let t=e;for(;t.db||t.child;)if(t=t.db||t.child,t.type==="level-js"||t.constructor.name==="Level")return t}async function b9e(e,t,r){let n=await t(e);if(n)return n;let i=ng(r);return i?new Promise((s,a)=>{let o=i.store("readonly").get(e.toString());o.transaction.onabort=()=>{a(o.transaction.error)},o.transaction.oncomplete=()=>{s(Boolean(o.result))}}):!1}async function _9e(e,t,r,n){if(await r(e))return t(e);let i=ng(n);if(!i)throw Rn();return new Promise((s,a)=>{let o=i.store("readonly").get(e.toString());o.transaction.onabort=()=>{a(o.transaction.error)},o.transaction.oncomplete=()=>{if(o.result)return s(o.result);a(Rn())}})}function R8(e){let t=e.get.bind(e),r=e.has.bind(e);return e.get=n=>_9e(n,t,r,e),e.has=n=>b9e(n,r,e),e}function TT(e){return{...e,root:R8(e.root),datastore:R8(e.datastore),pins:R8(e.pins),keys:R8(e.keys)}}Re(),me();async function v9e(e,t,r=()=>{}){let n=ng(t);if(!n){r(`${e} did not need an upgrade`);return}r(`Upgrading ${e}`),await dQ(n,(i,s)=>[{type:"del",key:i},{type:"put",key:U(i),value:s}])}async function S9e(e,t,r=()=>{}){let n=ng(t);if(!n){r(`${e} did not need a downgrade`);return}r(`Downgrading ${e}`),await dQ(n,(i,s)=>[{type:"del",key:i},{type:"put",key:M(i),value:s}])}function fQ(e){return e.child?fQ(e.child):e}async function lQ(e,t,r){let n=Object.entries(e).map(([a,o])=>({key:a,backend:fQ(o)})).filter(({key:a,backend:o})=>o.constructor.name==="LevelDatastore").map(({key:a,backend:o})=>({name:a,store:o}));t(0,`Migrating ${n.length} dbs`);let i=0,s=a=>{t(Math.round(i/n.length*100),a)};for(let{name:a,store:o}of n){await o.open();try{await r(a,o,s)}finally{i++,await o.close()}}t(100,`Migrated ${n.length} dbs`)}var hQ={version:10,description:"Migrates datastore-level keys to binary",migrate:(e,t=()=>{})=>lQ(e,t,v9e),revert:(e,t=()=>{})=>lQ(e,t,S9e)};function dQ(e,t){function r(n,i){let s=e.store("readwrite"),a=s.transaction,o=0,l;a.onabort=()=>i(l||a.error||new Error("aborted by user")),a.oncomplete=()=>i();function u(){let h=n[o++],f=h.key,y;try{y=h.type==="del"?s.delete(f):s.put(h.value,f)}catch(p){l=p,a.abort();return}o<n.length&&(y.onsuccess=u)}u()}return new Promise((n,i)=>{let s=e.iterator(),a=l=>l;s._deserializeKey=s._deserializeValue=a,o();function o(){let l=(u,h,f)=>{if(u||h===void 0){let y=p=>{if(p){i(p);return}n()};s.end(y);return}r(t(h,f),o)};s.next(l)}})}c();var Ml=new ae("/local/filesroot");async function x9e(e,t=()=>{}){if(t(100,"Migrating MFS root to repo datastore"),await e.root.open(),await e.datastore.open(),await e.root.has(Ml)){let r=await e.root.get(Ml);await e.datastore.put(Ml,r),await e.root.delete(Ml)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo datastore")}async function R9e(e,t=()=>{}){if(t(100,"Migrating MFS root to repo root datastore"),await e.root.open(),await e.datastore.open(),await e.datastore.has(Ml)){let r=await e.datastore.get(Ml);await e.root.put(Ml,r),await e.datastore.delete(Ml)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo root datastore")}var pQ={version:11,description:"Store mfs root in the datastore",migrate:x9e,revert:R9e};c();var OT=w(Ea(),1);c();var Hh=w(Ea(),1),mQ=Hh.default.Reader,A9e=Hh.default.Writer,T9e=Hh.default.util,A8=Hh.default.roots.default||(Hh.default.roots.default={}),IT=A8.Protocols=(()=>{function e(t){if(this.protocols=[],t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.protocols=T9e.emptyArray,e.encode=function(t,r){if(r||(r=A9e.create()),t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)r.uint32(10).string(t.protocols[n]);return r},e.decode=function(t,r){t instanceof mQ||(t=mQ.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new A8.Protocols;t.pos<n;){var s=t.uint32();switch(s>>>3){case 1:i.protocols&&i.protocols.length||(i.protocols=[]),i.protocols.push(t.string());break;default:t.skipType(s&7);break}}return i},e.fromObject=function(t){if(t instanceof A8.Protocols)return t;var r=new A8.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");r.protocols=[];for(var n=0;n<t.protocols.length;++n)r.protocols[n]=String(t.protocols[n])}return r},e.toObject=function(t,r){r||(r={});var n={};if((r.arrays||r.defaults)&&(n.protocols=[]),t.protocols&&t.protocols.length){n.protocols=[];for(var i=0;i<t.protocols.length;++i)n.protocols[i]=t.protocols[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Hh.default.util.toJSONOptions)},e})();c();var jc=w(Ea(),1),j0=jc.default.Reader,CT=jc.default.Writer,Lr=jc.default.util,Gn=jc.default.roots.default||(jc.default.roots.default={}),PT=Gn.Addresses=(()=>{function e(t){if(this.addrs=[],t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.addrs=Lr.emptyArray,e.prototype.certifiedRecord=null,e.encode=function(t,r){if(r||(r=CT.create()),t.addrs!=null&&t.addrs.length)for(var n=0;n<t.addrs.length;++n)Gn.Addresses.Address.encode(t.addrs[n],r.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&Gn.Addresses.CertifiedRecord.encode(t.certifiedRecord,r.uint32(18).fork()).ldelim(),r},e.decode=function(t,r){t instanceof j0||(t=j0.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new Gn.Addresses;t.pos<n;){var s=t.uint32();switch(s>>>3){case 1:i.addrs&&i.addrs.length||(i.addrs=[]),i.addrs.push(Gn.Addresses.Address.decode(t,t.uint32()));break;case 2:i.certifiedRecord=Gn.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(s&7);break}}return i},e.fromObject=function(t){if(t instanceof Gn.Addresses)return t;var r=new Gn.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");r.addrs=[];for(var n=0;n<t.addrs.length;++n){if(typeof t.addrs[n]!="object")throw TypeError(".Addresses.addrs: object expected");r.addrs[n]=Gn.Addresses.Address.fromObject(t.addrs[n])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");r.certifiedRecord=Gn.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return r},e.toObject=function(t,r){r||(r={});var n={};if((r.arrays||r.defaults)&&(n.addrs=[]),r.defaults&&(n.certifiedRecord=null),t.addrs&&t.addrs.length){n.addrs=[];for(var i=0;i<t.addrs.length;++i)n.addrs[i]=Gn.Addresses.Address.toObject(t.addrs[i],r)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=Gn.Addresses.CertifiedRecord.toObject(t.certifiedRecord,r)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,jc.default.util.toJSONOptions)},e.Address=function(){function t(n){if(n)for(var i=Object.keys(n),s=0;s<i.length;++s)n[i[s]]!=null&&(this[i[s]]=n[i[s]])}t.prototype.multiaddr=Lr.newBuffer([]),t.prototype.isCertified=null;let r;return Object.defineProperty(t.prototype,"_isCertified",{get:Lr.oneOfGetter(r=["isCertified"]),set:Lr.oneOfSetter(r)}),t.encode=function(n,i){return i||(i=CT.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&i.uint32(16).bool(n.isCertified),i},t.decode=function(n,i){n instanceof j0||(n=j0.create(n));for(var s=i===void 0?n.len:n.pos+i,a=new Gn.Addresses.Address;n.pos<s;){var o=n.uint32();switch(o>>>3){case 1:a.multiaddr=n.bytes();break;case 2:a.isCertified=n.bool();break;default:n.skipType(o&7);break}}return a},t.fromObject=function(n){if(n instanceof Gn.Addresses.Address)return n;var i=new Gn.Addresses.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?Lr.base64.decode(n.multiaddr,i.multiaddr=Lr.newBuffer(Lr.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),n.isCertified!=null&&(i.isCertified=Boolean(n.isCertified)),i},t.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=Lr.newBuffer(s.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?Lr.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(s.isCertified=n.isCertified,i.oneofs&&(s._isCertified="isCertified")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,jc.default.util.toJSONOptions)},t}(),e.CertifiedRecord=function(){function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return t.prototype.seq=Lr.Long?Lr.Long.fromBits(0,0,!0):0,t.prototype.raw=Lr.newBuffer([]),t.encode=function(r,n){return n||(n=CT.create()),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&n.uint32(8).uint64(r.seq),r.raw!=null&&Object.hasOwnProperty.call(r,"raw")&&n.uint32(18).bytes(r.raw),n},t.decode=function(r,n){r instanceof j0||(r=j0.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Gn.Addresses.CertifiedRecord;r.pos<i;){var a=r.uint32();switch(a>>>3){case 1:s.seq=r.uint64();break;case 2:s.raw=r.bytes();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof Gn.Addresses.CertifiedRecord)return r;var n=new Gn.Addresses.CertifiedRecord;return r.seq!=null&&(Lr.Long?(n.seq=Lr.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?n.seq=parseInt(r.seq,10):typeof r.seq=="number"?n.seq=r.seq:typeof r.seq=="object"&&(n.seq=new Lr.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.raw!=null&&(typeof r.raw=="string"?Lr.base64.decode(r.raw,n.raw=Lr.newBuffer(Lr.base64.length(r.raw)),0):r.raw.length&&(n.raw=r.raw)),n},t.toObject=function(r,n){n||(n={});var i={};if(n.defaults){if(Lr.Long){var s=new Lr.Long(0,0,!0);i.seq=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.seq=n.longs===String?"0":0;n.bytes===String?i.raw="":(i.raw=[],n.bytes!==Array&&(i.raw=Lr.newBuffer(i.raw)))}return r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?i.seq=n.longs===String?String(r.seq):r.seq:i.seq=n.longs===String?Lr.Long.prototype.toString.call(r.seq):n.longs===Number?new Lr.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.raw!=null&&r.hasOwnProperty("raw")&&(i.raw=n.bytes===String?Lr.base64.encode(r.raw,0,r.raw.length):n.bytes===Array?Array.prototype.slice.call(r.raw):r.raw),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,jc.default.util.toJSONOptions)},t}(),e})();c();var Yc=w(Ea(),1),Y0=Yc.default.Reader,DT=Yc.default.Writer,er=Yc.default.util,yn=Yc.default.roots.default||(Yc.default.roots.default={}),kT=yn.Peer=(()=>{function e(r){if(this.addresses=[],this.protocols=[],this.metadata=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}e.prototype.addresses=er.emptyArray,e.prototype.protocols=er.emptyArray,e.prototype.metadata=er.emptyArray,e.prototype.pubKey=null,e.prototype.peerRecordEnvelope=null;let t;return Object.defineProperty(e.prototype,"_pubKey",{get:er.oneOfGetter(t=["pubKey"]),set:er.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_peerRecordEnvelope",{get:er.oneOfGetter(t=["peerRecordEnvelope"]),set:er.oneOfSetter(t)}),e.encode=function(r,n){if(n||(n=DT.create()),r.addresses!=null&&r.addresses.length)for(var i=0;i<r.addresses.length;++i)yn.Address.encode(r.addresses[i],n.uint32(10).fork()).ldelim();if(r.protocols!=null&&r.protocols.length)for(var i=0;i<r.protocols.length;++i)n.uint32(18).string(r.protocols[i]);if(r.metadata!=null&&r.metadata.length)for(var i=0;i<r.metadata.length;++i)yn.Metadata.encode(r.metadata[i],n.uint32(26).fork()).ldelim();return r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&n.uint32(34).bytes(r.pubKey),r.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(r,"peerRecordEnvelope")&&n.uint32(42).bytes(r.peerRecordEnvelope),n},e.decode=function(r,n){r instanceof Y0||(r=Y0.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new yn.Peer;r.pos<i;){var a=r.uint32();switch(a>>>3){case 1:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(yn.Address.decode(r,r.uint32()));break;case 2:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;case 3:s.metadata&&s.metadata.length||(s.metadata=[]),s.metadata.push(yn.Metadata.decode(r,r.uint32()));break;case 4:s.pubKey=r.bytes();break;case 5:s.peerRecordEnvelope=r.bytes();break;default:r.skipType(a&7);break}}return s},e.fromObject=function(r){if(r instanceof yn.Peer)return r;var n=new yn.Peer;if(r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".Peer.addresses: array expected");n.addresses=[];for(var i=0;i<r.addresses.length;++i){if(typeof r.addresses[i]!="object")throw TypeError(".Peer.addresses: object expected");n.addresses[i]=yn.Address.fromObject(r.addresses[i])}}if(r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Peer.protocols: array expected");n.protocols=[];for(var i=0;i<r.protocols.length;++i)n.protocols[i]=String(r.protocols[i])}if(r.metadata){if(!Array.isArray(r.metadata))throw TypeError(".Peer.metadata: array expected");n.metadata=[];for(var i=0;i<r.metadata.length;++i){if(typeof r.metadata[i]!="object")throw TypeError(".Peer.metadata: object expected");n.metadata[i]=yn.Metadata.fromObject(r.metadata[i])}}return r.pubKey!=null&&(typeof r.pubKey=="string"?er.base64.decode(r.pubKey,n.pubKey=er.newBuffer(er.base64.length(r.pubKey)),0):r.pubKey.length&&(n.pubKey=r.pubKey)),r.peerRecordEnvelope!=null&&(typeof r.peerRecordEnvelope=="string"?er.base64.decode(r.peerRecordEnvelope,n.peerRecordEnvelope=er.newBuffer(er.base64.length(r.peerRecordEnvelope)),0):r.peerRecordEnvelope.length&&(n.peerRecordEnvelope=r.peerRecordEnvelope)),n},e.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addresses=[],i.protocols=[],i.metadata=[]),r.addresses&&r.addresses.length){i.addresses=[];for(var s=0;s<r.addresses.length;++s)i.addresses[s]=yn.Address.toObject(r.addresses[s],n)}if(r.protocols&&r.protocols.length){i.protocols=[];for(var s=0;s<r.protocols.length;++s)i.protocols[s]=r.protocols[s]}if(r.metadata&&r.metadata.length){i.metadata=[];for(var s=0;s<r.metadata.length;++s)i.metadata[s]=yn.Metadata.toObject(r.metadata[s],n)}return r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(i.pubKey=n.bytes===String?er.base64.encode(r.pubKey,0,r.pubKey.length):n.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey,n.oneofs&&(i._pubKey="pubKey")),r.peerRecordEnvelope!=null&&r.hasOwnProperty("peerRecordEnvelope")&&(i.peerRecordEnvelope=n.bytes===String?er.base64.encode(r.peerRecordEnvelope,0,r.peerRecordEnvelope.length):n.bytes===Array?Array.prototype.slice.call(r.peerRecordEnvelope):r.peerRecordEnvelope,n.oneofs&&(i._peerRecordEnvelope="peerRecordEnvelope")),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Yc.default.util.toJSONOptions)},e})(),Fst=yn.Address=(()=>{function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}e.prototype.multiaddr=er.newBuffer([]),e.prototype.isCertified=null;let t;return Object.defineProperty(e.prototype,"_isCertified",{get:er.oneOfGetter(t=["isCertified"]),set:er.oneOfSetter(t)}),e.encode=function(r,n){return n||(n=DT.create()),r.multiaddr!=null&&Object.hasOwnProperty.call(r,"multiaddr")&&n.uint32(10).bytes(r.multiaddr),r.isCertified!=null&&Object.hasOwnProperty.call(r,"isCertified")&&n.uint32(16).bool(r.isCertified),n},e.decode=function(r,n){r instanceof Y0||(r=Y0.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new yn.Address;r.pos<i;){var a=r.uint32();switch(a>>>3){case 1:s.multiaddr=r.bytes();break;case 2:s.isCertified=r.bool();break;default:r.skipType(a&7);break}}return s},e.fromObject=function(r){if(r instanceof yn.Address)return r;var n=new yn.Address;return r.multiaddr!=null&&(typeof r.multiaddr=="string"?er.base64.decode(r.multiaddr,n.multiaddr=er.newBuffer(er.base64.length(r.multiaddr)),0):r.multiaddr.length&&(n.multiaddr=r.multiaddr)),r.isCertified!=null&&(n.isCertified=Boolean(r.isCertified)),n},e.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.multiaddr="":(i.multiaddr=[],n.bytes!==Array&&(i.multiaddr=er.newBuffer(i.multiaddr)))),r.multiaddr!=null&&r.hasOwnProperty("multiaddr")&&(i.multiaddr=n.bytes===String?er.base64.encode(r.multiaddr,0,r.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(r.multiaddr):r.multiaddr),r.isCertified!=null&&r.hasOwnProperty("isCertified")&&(i.isCertified=r.isCertified,n.oneofs&&(i._isCertified="isCertified")),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Yc.default.util.toJSONOptions)},e})(),Kst=yn.Metadata=(()=>{function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.key="",e.prototype.value=er.newBuffer([]),e.encode=function(t,r){return r||(r=DT.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&r.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&r.uint32(18).bytes(t.value),r},e.decode=function(t,r){t instanceof Y0||(t=Y0.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new yn.Metadata;t.pos<n;){var s=t.uint32();switch(s>>>3){case 1:i.key=t.string();break;case 2:i.value=t.bytes();break;default:t.skipType(s&7);break}}return i},e.fromObject=function(t){if(t instanceof yn.Metadata)return t;var r=new yn.Metadata;return t.key!=null&&(r.key=String(t.key)),t.value!=null&&(typeof t.value=="string"?er.base64.decode(t.value,r.value=er.newBuffer(er.base64.length(t.value)),0):t.value.length&&(r.value=t.value)),r},e.toObject=function(t,r){r||(r={});var n={};return r.defaults&&(n.key="",r.bytes===String?n.value="":(n.value=[],r.bytes!==Array&&(n.value=er.newBuffer(n.value)))),t.key!=null&&t.hasOwnProperty("key")&&(n.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=r.bytes===String?er.base64.encode(t.value,0,t.value.length):r.bytes===Array?Array.prototype.slice.call(t.value):t.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Yc.default.util.toJSONOptions)},e})();c();var $h=w(Ea(),1),yQ=$h.default.Reader,I9e=$h.default.Writer,Br=$h.default.util,T8=$h.default.roots.default||($h.default.roots.default={}),gQ=T8.Envelope=(()=>{function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.publicKey=Br.newBuffer([]),e.prototype.payloadType=Br.newBuffer([]),e.prototype.payload=Br.newBuffer([]),e.prototype.signature=Br.newBuffer([]),e.encode=function(t,r){return r||(r=I9e.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&r.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&r.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&r.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&r.uint32(42).bytes(t.signature),r},e.decode=function(t,r){t instanceof yQ||(t=yQ.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new T8.Envelope;t.pos<n;){var s=t.uint32();switch(s>>>3){case 1:i.publicKey=t.bytes();break;case 2:i.payloadType=t.bytes();break;case 3:i.payload=t.bytes();break;case 5:i.signature=t.bytes();break;default:t.skipType(s&7);break}}return i},e.fromObject=function(t){if(t instanceof T8.Envelope)return t;var r=new T8.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?Br.base64.decode(t.publicKey,r.publicKey=Br.newBuffer(Br.base64.length(t.publicKey)),0):t.publicKey.length&&(r.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?Br.base64.decode(t.payloadType,r.payloadType=Br.newBuffer(Br.base64.length(t.payloadType)),0):t.payloadType.length&&(r.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?Br.base64.decode(t.payload,r.payload=Br.newBuffer(Br.base64.length(t.payload)),0):t.payload.length&&(r.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?Br.base64.decode(t.signature,r.signature=Br.newBuffer(Br.base64.length(t.signature)),0):t.signature.length&&(r.signature=t.signature)),r},e.toObject=function(t,r){r||(r={});var n={};return r.defaults&&(r.bytes===String?n.publicKey="":(n.publicKey=[],r.bytes!==Array&&(n.publicKey=Br.newBuffer(n.publicKey))),r.bytes===String?n.payloadType="":(n.payloadType=[],r.bytes!==Array&&(n.payloadType=Br.newBuffer(n.payloadType))),r.bytes===String?n.payload="":(n.payload=[],r.bytes!==Array&&(n.payload=Br.newBuffer(n.payload))),r.bytes===String?n.signature="":(n.signature=[],r.bytes!==Array&&(n.signature=Br.newBuffer(n.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=r.bytes===String?Br.base64.encode(t.publicKey,0,t.publicKey.length):r.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(n.payloadType=r.bytes===String?Br.base64.encode(t.payloadType,0,t.payloadType.length):r.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(n.payload=r.bytes===String?Br.base64.encode(t.payload,0,t.payload.length):r.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=r.bytes===String?Br.base64.encode(t.signature,0,t.signature.length):r.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,$h.default.util.toJSONOptions)},e})();c();var Ul=w(Ea(),1),I8=Ul.default.Reader,wQ=Ul.default.Writer,jr=Ul.default.util,js=Ul.default.roots.default||(Ul.default.roots.default={}),EQ=js.PeerRecord=(()=>{function e(t){if(this.addresses=[],t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.peerId=jr.newBuffer([]),e.prototype.seq=jr.Long?jr.Long.fromBits(0,0,!0):0,e.prototype.addresses=jr.emptyArray,e.encode=function(t,r){if(r||(r=wQ.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&r.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&r.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var n=0;n<t.addresses.length;++n)js.PeerRecord.AddressInfo.encode(t.addresses[n],r.uint32(26).fork()).ldelim();return r},e.decode=function(t,r){t instanceof I8||(t=I8.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new js.PeerRecord;t.pos<n;){var s=t.uint32();switch(s>>>3){case 1:i.peerId=t.bytes();break;case 2:i.seq=t.uint64();break;case 3:i.addresses&&i.addresses.length||(i.addresses=[]),i.addresses.push(js.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(s&7);break}}return i},e.fromObject=function(t){if(t instanceof js.PeerRecord)return t;var r=new js.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?jr.base64.decode(t.peerId,r.peerId=jr.newBuffer(jr.base64.length(t.peerId)),0):t.peerId.length&&(r.peerId=t.peerId)),t.seq!=null&&(jr.Long?(r.seq=jr.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?r.seq=parseInt(t.seq,10):typeof t.seq=="number"?r.seq=t.seq:typeof t.seq=="object"&&(r.seq=new jr.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");r.addresses=[];for(var n=0;n<t.addresses.length;++n){if(typeof t.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");r.addresses[n]=js.PeerRecord.AddressInfo.fromObject(t.addresses[n])}}return r},e.toObject=function(t,r){r||(r={});var n={};if((r.arrays||r.defaults)&&(n.addresses=[]),r.defaults)if(r.bytes===String?n.peerId="":(n.peerId=[],r.bytes!==Array&&(n.peerId=jr.newBuffer(n.peerId))),jr.Long){var i=new jr.Long(0,0,!0);n.seq=r.longs===String?i.toString():r.longs===Number?i.toNumber():i}else n.seq=r.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(n.peerId=r.bytes===String?jr.base64.encode(t.peerId,0,t.peerId.length):r.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?n.seq=r.longs===String?String(t.seq):t.seq:n.seq=r.longs===String?jr.Long.prototype.toString.call(t.seq):r.longs===Number?new jr.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){n.addresses=[];for(var s=0;s<t.addresses.length;++s)n.addresses[s]=js.PeerRecord.AddressInfo.toObject(t.addresses[s],r)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ul.default.util.toJSONOptions)},e.AddressInfo=function(){function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return t.prototype.multiaddr=jr.newBuffer([]),t.encode=function(r,n){return n||(n=wQ.create()),r.multiaddr!=null&&Object.hasOwnProperty.call(r,"multiaddr")&&n.uint32(10).bytes(r.multiaddr),n},t.decode=function(r,n){r instanceof I8||(r=I8.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new js.PeerRecord.AddressInfo;r.pos<i;){var a=r.uint32();switch(a>>>3){case 1:s.multiaddr=r.bytes();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof js.PeerRecord.AddressInfo)return r;var n=new js.PeerRecord.AddressInfo;return r.multiaddr!=null&&(typeof r.multiaddr=="string"?jr.base64.decode(r.multiaddr,n.multiaddr=jr.newBuffer(jr.base64.length(r.multiaddr)),0):r.multiaddr.length&&(n.multiaddr=r.multiaddr)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.multiaddr="":(i.multiaddr=[],n.bytes!==Array&&(i.multiaddr=jr.newBuffer(i.multiaddr)))),r.multiaddr!=null&&r.hasOwnProperty("multiaddr")&&(i.multiaddr=n.bytes===String?jr.base64.encode(r.multiaddr,0,r.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(r.multiaddr):r.multiaddr),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ul.default.util.toJSONOptions)},t}(),e})(),NT=w(mw(),1);OT.default.util.Long=void 0,OT.default.configure();async function C9e(e,t=()=>{}){t(0,"Storing each peerstore key under a single datastore key"),await e.datastore.open();let r={},n=[];for await(let{key:i,value:s}of e.datastore.query({prefix:"/peers"})){n.push(i);let a=i.toString(),[o,l,u,h,f]=a.split("/");if(l==="peers"&&!!["protos","addrs","metadata","keys"].includes(u)&&!!h)if(r[h]=r[h]||{addresses:[],protocols:[],metadata:[]},u==="protos"){let y=IT.decode(s);r[h].protocols=y.protocols.sort()}else if(u==="addrs"){let y=PT.decode(s);r[h].addresses=y.addrs.sort((p,v)=>new NT.Multiaddr(p.multiaddr).toString().localeCompare(new NT.Multiaddr(v.multiaddr).toString())),y.certifiedRecord&&y.certifiedRecord.raw&&(r[h].peerRecordEnvelope=y.certifiedRecord.raw)}else u==="metadata"?r[h].metadata.push({key:f,value:s}):u==="keys"&&(r[h].pubKey=s)}t(33,"Read peer data from store");for(let i of n)await e.datastore.delete(i);t(66,"Removed existing peer data from store");for(let i of Object.keys(r)){let s=r[i];s.metadata=s.metadata.sort((o,l)=>o.key.localeCompare(l.key));let a=kT.encode(s).finish();await e.datastore.put(new ae(`/peers/${i}`),a)}await e.datastore.close(),t(100,"Stored each peerstore key under a single datastore key")}async function P9e(e,t=()=>{}){t(0,"Storing each peerstore key under a multiple datastore keys"),await e.datastore.open();let r={},n=[];for await(let{key:i,value:s}of e.datastore.query({prefix:"/peers"})){n.push(i);let a=i.toString(),[o,l,u]=a.split("/");r[u]=kT.decode(s)}t(33,"Read peer data from store");for(let i of n)await e.datastore.delete(i);t(66,"Removed existing peer data from store");for(let[i,s]of Object.entries(r)){if(s.protocols&&s.protocols.length>0&&await e.datastore.put(new ae(`/peers/protos/${i}`),IT.encode({protocols:s.protocols}).finish()),s.addresses&&s.addresses.length>0){let a=s.peerRecordEnvelope,o;if(a){let l=gQ.decode(a),u=EQ.decode(l.payload);o={raw:a,seq:u.seq}}await e.datastore.put(new ae(`/peers/addrs/${i}`),PT.encode({addrs:s.addresses,certifiedRecord:o}).finish())}if(s.metadata&&s.metadata.length>0)for(let{key:a,value:o}of s.metadata)await e.datastore.put(new ae(`/peers/metadata/${i}/${a}`),o);s.pubKey&&await e.datastore.put(new ae(`/peers/keys/${i}`),s.pubKey)}await e.datastore.close(),t(100,"Stored each peerstore key under multiple datastore keys")}var bQ={version:12,description:"Store each peerstore peer under a single datastore key",migrate:C9e,revert:P9e},Gh={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},C8=[Object.assign({version:1},Gh),Object.assign({version:2},Gh),Object.assign({version:3},Gh),Object.assign({version:4},Gh),Object.assign({version:5},Gh),Object.assign({version:6},Gh),Object.assign({version:7},Gh),JY,cQ,hQ,pQ,bQ];c(),c();var _Q=w(Mi(),1),LT={};ct(LT,{InvalidValueError:()=>Z0,MissingRepoOptionsError:()=>$a,NonReversibleMigrationError:()=>Q0,NotInitializedRepoError:()=>Fl,RequiredParameterError:()=>X0}),c();var Q0=class extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=Q0.code,this.message=e}};Q0.code="ERR_NON_REVERSIBLE_MIGRATION";var Fl=class extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=Fl.code,this.message=e}};Fl.code="ERR_NOT_INITIALIZED_REPO";var X0=class extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=X0.code,this.message=e}};X0.code="ERR_REQUIRED_PARAMETER";var Z0=class extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=Z0.code,this.message=e}};Z0.code="ERR_INVALID_VALUE";var $a=class extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=$a.code,this.message=e}};$a.code="ERR_MISSING_REPO_OPTIONS";var BT=(0,_Q.default)("ipfs:repo:migrator:repo:init");async function vQ(e){if(!e)throw new $a("Please pass repo options when trying to open a repo");let t=e.root;try{await t.open();let r=await t.has(rg),n=await t.has(uQ);return!r||!n?(BT(`Version entry present: ${r}`),BT(`Config entry present: ${n}`),!1):!0}catch(r){return BT("While checking if repo is initialized error was thrown: "+r.message),!1}finally{if(t!==void 0)try{await t.close()}catch{}}}Re(),me();async function MT(e){if(!await vQ(e))throw new Fl("Repo is not initialized!");let t=e.root;await t.open();try{return parseInt(M(await t.get(rg)))}finally{await t.close()}}async function ig(e,t){if(!t)throw new $a("Please pass repo options when trying to open a repo");let r=t.root;await r.open(),await r.put(rg,U(String(e))),await r.close()}var SQ=w(Mi(),1),Ys=(0,SQ.default)("ipfs:repo:migrator");function k9e(e){return e=e||C8,!Array.isArray(e)||e.length===0?0:e[e.length-1].version}async function xQ(e,t,r,n,{ignoreLock:i=!1,onProgress:s,isDryRun:a=!1,migrations:o}){if(o=o||C8,!e)throw new is.RequiredParameterError("Path argument is required!");if(!r)throw new is.RequiredParameterError("repoOptions argument is required!");if(!n)throw new is.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new is.InvalidValueError("Version has to be positive integer!");t=TT(t);let l=await MT(t);if(l===n){Ys("Nothing to migrate.");return}if(l>n)throw new is.InvalidValueError(`Current repo's version (${l}) is higher then toVersion (${n}), you probably wanted to revert it?`);AQ(o,l,n);let u;!a&&!i&&(u=await r.repoLock.lock(e));try{for(let h of o){if(n!==void 0&&h.version>n)break;if(!(h.version<=l)){Ys(`Migrating version ${h.version}`);try{if(!a){let f=()=>{};s&&(f=(y,p)=>s(h.version,y.toFixed(2),p)),await h.migrate(t,f)}}catch(f){let y=h.version-1;throw Ys(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${y}`),await ig(y,t),new Error(`During migration to version ${h.version} exception was raised: ${f.stack||f.message||f}`)}Ys(`Migrating to version ${h.version} finished`)}}a||await ig(n||k9e(o),t),Ys("Repo successfully migrated",n!==void 0?`to version ${n}!`:"to latest version!")}finally{!a&&!i&&u&&await u.close()}}async function RQ(e,t,r,n,{ignoreLock:i=!1,onProgress:s,isDryRun:a=!1,migrations:o}){if(o=o||C8,!e)throw new is.RequiredParameterError("Path argument is required!");if(!r)throw new is.RequiredParameterError("repoOptions argument is required!");if(!n)throw new is.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new is.InvalidValueError("Version has to be positive integer!");t=TT(t);let l=await MT(t);if(l===n){Ys("Nothing to revert.");return}if(l<n)throw new is.InvalidValueError(`Current repo's version (${l}) is lower then toVersion (${n}), you probably wanted to migrate it?`);AQ(o,n,l,!0);let u;!a&&!i&&(u=await r.repoLock.lock(e)),Ys(`Reverting from version ${l} to ${n}`);try{let h=o.slice().reverse();for(let f of h){if(f.version<=n)break;if(!(f.version>l)){Ys(`Reverting migration version ${f.version}`);try{if(!a){let y=()=>{};s&&(y=(p,v)=>s(f.version,p.toFixed(2),v)),await f.revert(t,y)}}catch(y){let p=f.version;throw Ys(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${p}`),await ig(p,t),y.message=`During reversion to version ${f.version} exception was raised: ${y.message}`,y}Ys(`Reverting to version ${f.version} finished`)}}a||await ig(n,t),Ys(`All migrations successfully reverted to version ${n}!`)}finally{!a&&!i&&u&&await u.close()}}function AQ(e,t,r,n=!1){let i=0;for(let s of e){if(s.version>r)break;if(s.version>t){if(n&&!s.revert)throw new is.NonReversibleMigrationError(`It is not possible to revert to version ${t} because migration version ${s.version} is not reversible. Cancelling reversion.`);i++}}if(i!==r-t)throw new is.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${t} to ${r}`)}var is=LT,tZ=w(CQ(),1);c();var NQ=w(Mi(),1);me(),Re(),c(),c();var Wh=class extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=Wh.code}};Wh.code="ERR_LOCK_EXISTS";var Eo=class extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=Eo.code}};Eo.code="ERR_NOT_FOUND";var jh=class extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=jh.code}};jh.code="ERR_INVALID_REPO_VERSION";var Yh="ERR_REPO_NOT_INITIALIZED",PQ="ERR_REPO_ALREADY_OPEN",DQ="ERR_REPO_ALREADY_CLOSED";async function D8(e,t,r){let n=await t(e);if(n)return n;let i=kQ(r);return i?new Promise((s,a)=>{let o=i.store("readonly").get(e.toString());o.transaction.onabort=()=>{a(o.transaction.error)},o.transaction.oncomplete=()=>{s(Boolean(o.result))}}):!1}async function k8(e,t,r,n){if(await r(e))return t(e);let i=kQ(n);if(!i)throw new Eo;return new Promise((s,a)=>{let o=i.store("readonly").get(e.toString());o.transaction.onabort=()=>{a(o.transaction.error)},o.transaction.oncomplete=()=>{if(o.result)return s(o.result);a(new Eo)}})}function kQ(e){let t=e;for(;t.db||t.child;)if(t=t.db||t.child,t.type==="level-js"||t.constructor.name==="Level")return t}var F9e=(0,NQ.default)("ipfs:repo:version"),UT=new ae("version");function OQ(e){return{async exists(){return D8(UT,e.has.bind(e),e)},async get(){let t=await k8(UT,e.get.bind(e),e.has.bind(e),e);return parseInt(M(t),10)},set(t){return e.put(UT,U(String(t)))},async check(t){let r=await this.get();return F9e("comparing version: %s and %s",r,t),r===t||r===6&&t===7||t===6&&r===7}}}c();var B8=w(HT(),1),$Q=w(_T(),1),GQ=w(HQ(),1),M8=w(K(),1);me(),Re();var W9e=B8.default.default?B8.default.default:B8.default,$T=new ae("config");function WQ(e){let t=new W9e({concurrency:1}),r={async getAll(s={}){let a=await k8($T,e.get.bind(e),e.has.bind(e),e);return JSON.parse(M(a))},async get(s,a={}){if(s==null)throw new Eo(`Key ${s} does not exist in config`);let o=await this.getAll(a),l=(0,$Q.default)(o,s);if(l===void 0)throw new Eo(`Key ${s} does not exist in config`);return l},set(s,a,o={}){if(typeof s!="string"&&!(s instanceof String))throw(0,M8.default)(new Error("Invalid key type: "+typeof s),"ERR_INVALID_KEY");if(a===void 0||a instanceof Uint8Array)throw(0,M8.default)(new Error("Invalid value type: "+typeof a),"ERR_INVALID_VALUE");return t.add(()=>n({key:s,value:a},o.signal))},replace(s,a={}){if(!s||s instanceof Uint8Array)throw(0,M8.default)(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return t.add(()=>n({key:void 0,value:s},a.signal))},async exists(){return D8($T,e.has.bind(e),e)}};return r;async function n(s,a){if(a&&a.aborted)return;let o=s.key,l=s.value;if(o){let u=await r.getAll();return typeof u=="object"&&u!==null&&(0,GQ.default)(u,o,l),i(u)}return i(l)}function i(s){let a=U(JSON.stringify(s,null,2));return e.put($T,a)}}c();var QQ=w(YQ(),1);me(),Re();var WT=new ae("datastore_spec");function XQ(e){return{exists(){return e.has(WT)},async get(){let t=await e.get(WT);return JSON.parse(M(t))},async set(t){return e.put(WT,U(JSON.stringify((0,QQ.default)(t,{deep:!0}))))}}}c(),Re();var jT=new ae("api");function ZQ(e){return{async get(){let t=await e.get(jT);return t&&t.toString()},set(t){return e.put(jT,U(t.toString()))},delete(){return e.delete(jT)}}}c();var tX=w(Gi(),1),rX=w(eX(),1),nX=w(Ci(),1);te();var iX=w(K(),1);va();function oX(e){return{open(){return e.open()},close(){return e.close()},query(t,r){return e.query(t,r)},queryKeys(t,r){return e.queryKeys(t,r)},async get(t,r){let n=Vl(t);return n.isIdentity?Promise.resolve(n.digest):e.get(t,r)},async*getMany(t,r){for await(let n of t)yield this.get(n,r)},async put(t,r,n){let{isIdentity:i}=Vl(t);i||await e.put(t,r,n)},async*putMany(t,r){let n=(0,rX.default)();(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await(0,nX.default)(e.putMany(async function*(){for await(let{key:i,value:s}of t)Vl(i).isIdentity||(yield{key:i,value:s}),n.push({key:i,value:s})}())),n.end()}catch(i){n.end(i)}}),yield*n},has(t,r){let{isIdentity:n}=Vl(t);return n?Promise.resolve(!0):e.has(t,r)},delete(t,r){let{isIdentity:n}=Vl(t);return n?Promise.resolve():e.delete(t,r)},deleteMany(t,r){return e.deleteMany((0,tX.default)(t,n=>!Vl(n).isIdentity),r)},batch(){let t=e.batch();return{put(r,n){let{isIdentity:i}=Vl(r);i||t.put(r,n)},delete(r){let{isIdentity:n}=Vl(r);n||t.delete(r)},commit:r=>t.commit(r)}}}}function Vl(e){let t=I.asCID(e);if(t==null)throw(0,iX.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return t.multihash.code!==$r.code?{isIdentity:!1}:{isIdentity:!0,digest:t.multihash.digest}}c(),c();var sX=w(Mi(),1),aX=(0,sX.default)("ipfs:repo:lock:memory"),cX="repo.lock",og={};async function j9e(e){let t=e+"/"+cX;if(aX("locking %s",t),og[t]===!0)throw new Wh(`Lock already being held for file: ${t}`);return og[t]=!0,{async close(){og[t]&&delete og[t]}}}async function Y9e(e){let t=e+"/"+cX;return aX(`checking lock: ${t}`),Boolean(og[t])}var U8={lock:j9e,locked:Y9e},uX={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:U8};c();var QT={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};c(),te();var hX=w(K(),1),dX=w(Mi(),1),ZT=w(Gc(),1);Vf(),c(),bp(),zo();var lX=w(K(),1);si(),On();function sg(e){let t=I.asCID(e);if(t==null)throw(0,lX.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");let r=xt.encode(t.multihash.bytes);return new ae("/"+r.slice(1).toUpperCase(),!1)}function XT(e){return _r(xt.decode(`b${e.toString().toLowerCase().substring(1)}`))}c();var fX=w(Mi(),1),Q9e=(0,fX.default)("ipfs:repo:utils:walk-dag");async function*J0(e,t,r,n){try{let i=await t.get(e,n),s=await r(e.code),a=N0({bytes:i,cid:e,codec:s});for(let[,o]of a.links())yield o,yield*J0(o,t,r,n)}catch(i){throw Q9e("Could not walk DAG for CID",e.toString(),i),i}}function X9e(e){let t=`Invalid type '${e}', must be one of {direct, indirect, recursive, all}`;return(0,hX.default)(new Error(t),"ERR_INVALID_PIN_TYPE")}var F8=class{constructor({pinstore:e,blockstore:t,loadCodec:r}){this.pinstore=e,this.blockstore=t,this.loadCodec=r,this.log=(0,dX.default)("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);let r={depth:0};return e.version!==0&&(r.version=e.version),e.code!==pt&&(r.codec=e.code),t.metadata&&(r.metadata=t.metadata),this.pinstore.put(sg(e),ao(r))}unpin(e,t){return this.pinstore.delete(sg(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);let r={depth:1/0};e.version!==0&&(r.version=e.version),e.code!==pt&&(r.codec=e.code),t.metadata&&(r.metadata=t.metadata),await this.pinstore.put(sg(e),ao(r))}async*directKeys(e){for await(let t of this.pinstore.query({filters:[r=>Mn(r.value).depth===0]})){let r=Mn(t.value),n=r.version||0,i=r.codec!=null?r.codec:pt,s=XT(t.key);yield{cid:I.create(n,i,s),metadata:r.metadata}}}async*recursiveKeys(e){for await(let t of this.pinstore.query({filters:[r=>Mn(r.value).depth===1/0]})){let r=Mn(t.value),n=r.version||0,i=r.codec!=null?r.codec:pt,s=XT(t.key);yield{cid:I.create(n,i,s),metadata:r.metadata}}}async*indirectKeys(e){for await(let{cid:t}of this.recursiveKeys())for await(let r of J0(t,this.blockstore,this.loadCodec,e)){let n=[vt.recursive];(await this.isPinnedWithType(r,n)).pinned||(yield r)}}async isPinnedWithType(e,t,r){Array.isArray(t)||(t=[t]);let n=t.includes(vt.all),i=t.includes(vt.direct),s=t.includes(vt.recursive),a=t.includes(vt.indirect);if(s||i||n){let u=await(0,ZT.default)(this.pinstore.query({prefix:sg(e).toString(),filters:[h=>{if(n)return!0;let f=Mn(h.value);return t.includes(f.depth===0?vt.direct:vt.recursive)}],limit:1}));if(u){let h=Mn(u.value);return{cid:e,pinned:!0,reason:h.depth===0?vt.direct:vt.recursive,metadata:h.metadata}}}let o=this;async function*l(u,h){for await(let{cid:f}of h)for await(let y of J0(f,o.blockstore,o.loadCodec))if(y.equals(u)){yield f;return}}if(n||a){let u=await(0,ZT.default)(l(e,this.recursiveKeys()));if(u)return{cid:e,pinned:!0,reason:vt.indirect,parent:u}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t){let r=new Set,n=async(i,s)=>{if(r.has(i.toString()))return;r.add(i.toString());let a=await this.blockstore.get(i,s),o=await this.loadCodec(i.code),l=N0({bytes:a,cid:i,codec:o});await Promise.all([...l.links()].map(([,u])=>n(u,s)))};await n(e,t)}static checkPinType(e){if(typeof e!="string"||!Object.keys(vt).includes(e))throw X9e(e);return!0}};c();var mX=w(ei(),1),yX=w(K(),1);function gX(e,t){return{open(){return t.open()},close(){return t.close()},query(r,n){return t.query(r,n)},queryKeys(r,n){return t.queryKeys(r,n)},async get(r,n){return t.get(r,n)},async*getMany(r,n){yield*t.getMany(r,n)},async put(r,n,i){await t.put(r,n,i)},async*putMany(r,n){yield*t.putMany(r,n)},has(r,n){return t.has(r,n)},async delete(r,n){return await pX(r,e),t.delete(r,n)},deleteMany(r,n){return t.deleteMany((0,mX.default)(r,async i=>(await pX(i,e),i)),n)},batch(){return t.batch()}}}async function pX(e,t){let{pinned:r,reason:n}=await t.isPinnedWithType(e,vt.all);if(r)throw(0,yX.default)(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}var rZ=w(HX(),1);c(),te();var jX=w(Mi(),1),YX=w(d5(),1),QX=w(WX(),1),oI=w(Fc(),1),q8=w(ei(),1),XX=w(Gi(),1);si();var cg=(0,jX.default)("ipfs:repo:gc"),lSe=Rn().code,fSe=256,hSe=new ae("/local/filesroot");function ZX({gcLock:e,pins:t,blockstore:r,root:n,loadCodec:i}){async function*s(){let a=Date.now();cg("Creating set of marked blocks");let o=await e.writeLock();try{let l=await dSe({pins:t,blockstore:r,root:n,loadCodec:i}),u=r.queryKeys({});yield*pSe({blockstore:r},l,u),cg(`Complete (${Date.now()-a}ms)`)}finally{o()}}return s}async function dSe({pins:e,blockstore:t,loadCodec:r,root:n}){let i=async function*(){let o;try{o=await n.get(hSe)}catch(u){if(u.code===lSe){cg("No blocks in MFS");return}throw u}let l=I.decode(o);yield l,yield*J0(l,t,r)}(),s=(0,oI.default)((0,q8.default)(e.recursiveKeys(),({cid:o})=>o),e.indirectKeys(),(0,q8.default)(e.directKeys(),({cid:o})=>o),i),a=new Set;for await(let o of(0,oI.default)(s,i))a.add(xt.encode(o.multihash.bytes));return a}async function*pSe({blockstore:e},t,r){let n=0,i=0;yield*(0,QX.pipe)((0,YX.default)((0,q8.default)(r,async s=>async function(){n++;try{let a=xt.encode(s.multihash.bytes);if(t.has(a))return null;try{await e.delete(s),i++}catch(o){return{err:new Error(`Could not delete block with CID ${s}: ${o.message}`)}}return{cid:s}}catch(a){let o=`Could delete block with CID ${s}`;return cg(o,a),{err:new Error(o+`: ${a.message}`)}}}),fSe),s=>(0,XX.default)(s,Boolean)),cg(`Marked set has ${t.size} unique blocks. Blockstore has ${n} blocks. Deleted ${i} blocks.`)}var Qi=(0,eZ.default)("ipfs:repo"),mSe=Number.MAX_SAFE_INTEGER,ySe="repoAutoMigrate",sI=class{constructor(e,t,r,n){if(typeof e!="string")throw new Error("missing repo path");if(typeof t!="function")throw new Error("missing codec loader");this.options=Ze(uX,n),this.closed=!0,this.path=e,this.root=r.root,this.datastore=r.datastore,this.keys=r.keys;let i=r.blocks,s=r.pins;this.pins=new F8({pinstore:s,blockstore:i,loadCodec:t});let a=gX(this.pins,i);this.blocks=oX(a),this.version=OQ(this.root),this.config=WQ(this.root),this.spec=XQ(this.root),this.apiAddr=ZQ(this.root),this.gcLock=(0,rZ.default)(e,{singleProcess:this.options.repoOwner!==!1}),this.gc=ZX({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){Qi("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(gSe(e)),await this.spec.set(wSe(e)),await this.version.set(12)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw(0,Xh.default)(new Error("repo is already open"),PQ);Qi("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),Qi("acquired repo.lock"),!await this.version.check(12))if(await this._isAutoMigrationEnabled())await this._migrate(12,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new jh("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");Qi("creating datastore"),await this.datastore.open(),Qi("creating blocks"),await this.blocks.open(),Qi("creating keystore"),await this.keys.open(),Qi("creating pins"),await this.pins.pinstore.open(),this.closed=!1,Qi("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(t){Qi("error removing lock",t)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw(0,Xh.default)(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){Qi("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?(0,Xh.default)(new Error("repo is not initialized yet"),Yh,{path:this.path}):t}if(!e)throw(0,Xh.default)(new Error("repo is not initialized yet"),Yh,{path:this.path})}async close(){if(this.closed)throw(0,Xh.default)(new Error("repo is already closed"),DQ);Qi("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Yh&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),Qi("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,t,r,n,i]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),JX(this.datastore),JX(this.keys)]),s=t.size+n+i;return{repoPath:this.path,storageMax:e,version:r,numObjects:t.count,repoSize:s}}throw(0,Xh.default)(new Error("repo is not initialized yet"),Yh,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(ySe)}catch(t){if(t.code===Eo.code)e=!0;else throw t}return e}async _migrate(e,t){return await this.version.get()>e?(Qi(`reverting to version ${e}`),RQ(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(Qi(`migrating to version ${e}`),xQ(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt((0,tZ.default)(e))}catch{return BigInt(mSe)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(let{key:r,value:n}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(n.byteLength),t+=BigInt(r.bytes.byteLength);return{count:e,size:t}}};async function JX(e){let t=BigInt(0);for await(let r of e.query({}))t+=BigInt(r.value.byteLength),t+=BigInt(r.key.uint8Array().byteLength);return t}function nZ(e,t,r,n){return new sI(e,t,r,n)}function gSe(e){return e.Datastore=Object.assign({},QT,(0,aI.default)(e,"datastore")),e}function wSe(e){let t={...QT.Spec,...(0,aI.default)(e,"Datastore.Spec")};return{type:t.type,mounts:t.mounts.map(r=>({mountpoint:r.mountpoint,type:r.child.type,path:r.child.path,shardFunc:r.child.shardFunc}))}}c();var Tg=w(Gi(),1),Oee=w(ei(),1),fC=w(h0(),1),hC=w(ug(),1),Lee=w(Nee(),1),Ql=class extends Wi{constructor(e,t){super(),this.path=e,this.opts=t,t&&t.db?(this.database=t.db,delete t.db):this.database=Lee.default}_initDb(){return new Promise((e,t)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},r=>{if(r)return t(r);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw m0.dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(r){throw m0.dbWriteFailedError(r)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(r){throw r.notFound?m0.notFoundError(r):m0.dbWriteFailedError(r)}return t}async has(e){try{await this.db.get(e.toString())}catch(t){if(t.notFound)return!1;throw t}return!0}async delete(e){try{await this.db.del(e.toString())}catch(t){throw m0.dbDeleteFailedError(t)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(t,r)=>{e.push({type:"put",key:t.toString(),value:r})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((i,s)=>(0,Tg.default)(i,s),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((i,s)=>(0,hC.default)(i,s),t));let{offset:r,limit:n}=e;if(r){let i=0;t=(0,Tg.default)(t,()=>i++>=r)}return n&&(t=(0,fC.default)(t,n)),t}queryKeys(e){let t=(0,Oee.default)(this._query({values:!1,prefix:e.prefix}),({key:i})=>i);Array.isArray(e.filters)&&(t=e.filters.reduce((i,s)=>(0,Tg.default)(i,s),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((i,s)=>(0,hC.default)(i,s),t));let{offset:r,limit:n}=e;if(r){let i=0;t=(0,Tg.default)(t,()=>i++>=r)}return n&&(t=(0,fC.default)(t,n)),t}_query(e){let t={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let r=e.prefix.toString();t.gte=r,t.lt=r+"\xFF"}return NAe(this.db.iterator(t))}};function NAe(e){return{[Symbol.asyncIterator](){return{next:()=>new Promise((t,r)=>{e.next((n,i,s)=>{if(n)return r(n);if(i==null)return e.end(a=>{if(a)return r(a);t({done:!0,value:void 0})});t({done:!1,value:{key:new ae(i,!1),value:s}})})}),return:()=>new Promise((t,r)=>{e.end(n=>{if(n)return r(n);t({done:!0,value:void 0})})})}}}}c();var yC=w(Ci(),1),gC=w(Mee(),1);te(),zo(),On(),si(),Hr();var Kee=w(K(),1);c();var pC=w(Ci(),1),cd=w(Gi(),1),mC=w(h0(),1),Fee=w(Vs(),1),Uee=(e,t)=>async function*(){yield*(await(0,Fee.default)(e)).sort(t)}(),ja=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(let r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(let r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(r,n){e.push({key:r,value:n})},delete(r){t.push(r)},commit:async r=>{await(0,pC.default)(this.putMany(e,r)),e=[],await(0,pC.default)(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(e.prefix!=null&&(r=(0,cd.default)(r,n=>n.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(r=e.filters.reduce((n,i)=>(0,cd.default)(n,i),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((n,i)=>Uee(n,i),r)),e.offset!=null){let n=0;r=(0,cd.default)(r,()=>n++>=(e.offset||0))}return e.limit!=null&&(r=(0,mC.default)(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(e.prefix!=null&&(r=(0,cd.default)(r,n=>n.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(r=e.filters.reduce((n,i)=>(0,cd.default)(n,i),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((n,i)=>Uee(n,i),r)),e.offset!=null){let n=0;r=(0,cd.default)(r,()=>n++>=e.offset)}return e.limit!=null&&(r=(0,mC.default)(r,e.limit)),r}};function y1(e){let t=I.asCID(e);if(!t)throw(0,Kee.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return new ae("/"+xt.encode(t.multihash.bytes).slice(1).toUpperCase(),!1)}function Xl(e){return I.createV1(Un,_r(xt.decode("b"+e.toString().slice(1).toLowerCase())))}function wC(e){let t=e.substring(0,1);if(t==="/")return wC(e.substring(1));let r;t.toLowerCase()==="b"?r=s=>xt.decode(s.toLowerCase()).subarray(2):t.toLowerCase()==="c"?r=s=>t9.decode(s.toLowerCase()).subarray(2):t==="z"?r=s=>Ne.decode(s).subarray(2):t==="Q"?r=s=>Ne.decode("z"+s):r=s=>xt.decode("b"+s.toLowerCase()).subarray(2);let n;for(let s=1;s<e.length;s++)try{n=r(e.substring(0,s))}catch(a){if(a.message!=="Unexpected end of data")throw a}let i="/C";return n&&(i=`/${xt.encode(n).slice(1,-1).toUpperCase()||"C"}`),i}function OAe(e){return{...e,prefix:e.prefix?wC(e.prefix):void 0,filters:e.filters?e.filters.map(t=>r=>t({key:Xl(r.key),value:r.value})):void 0,orders:e.orders?e.orders.map(t=>(r,n)=>t({key:Xl(r.key),value:r.value},{key:Xl(n.key),value:n.value})):void 0}}function LAe(e){return{...e,prefix:e.prefix?wC(e.prefix):void 0,filters:e.filters?e.filters.map(t=>r=>t(Xl(r))):void 0,orders:e.orders?e.orders.map(t=>(r,n)=>t(Xl(r),Xl(n))):void 0}}var RE=class extends ja{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(let{key:r,value:n}of this.child.query(OAe(e),t))yield{key:Xl(r),value:n}}async*queryKeys(e,t){for await(let r of this.child.queryKeys(LAe(e),t))yield Xl(r)}async get(e,t){return this.child.get(y1(e),t)}async*getMany(e,t){for await(let r of e)yield this.get(r,t)}async put(e,t,r){await this.child.put(y1(e),t,r)}async*putMany(e,t){let r=(0,gC.default)();(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{let n=this.child;await(0,yC.default)(this.child.putMany(async function*(){for await(let i of e){let s=y1(i.key);await n.has(s,t)||(yield{key:s,value:i.value}),r.push(i)}}())),r.end()}catch(n){r.end(n)}}),yield*r}has(e,t){return this.child.has(y1(e),t)}delete(e,t){return this.child.delete(y1(e),t)}deleteMany(e,t){let r=(0,gC.default)();return(0,yC.default)(this.child.deleteMany(async function*(){for await(let n of e)yield y1(n),r.push(n);r.end()}(),t)).catch(n=>{r.end(n)}),r}};function Vee(e,t,r){let n=r.path||"ipfs";return nZ(n,i=>t.getCodec(i),{root:new Ql(n,{prefix:"",version:2}),blocks:new RE(new Ql(`${n}/blocks`,{prefix:"",version:2})),datastore:new Ql(`${n}/datastore`,{prefix:"",version:2}),keys:new Ql(`${n}/keys`,{prefix:"",version:2}),pins:new Ql(`${n}/pins`,{prefix:"",version:2})},{autoMigrate:r.autoMigrate,onMigrationProgress:r.onMigrationProgress||e,repoLock:U8})}Re(),me(),c();var Qt=w(D6(),1),Jhe=w(K(),1);c(),c(),c(),c();var zee=w(K(),1);ur(),Re();var AE=w(ai(),1);yr(),c();var qee={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};c();var Ig;(function(e){e.codec=()=>Xe({1:{name:"publicKey",codec:ye},2:{name:"payloadType",codec:ye},3:{name:"payload",codec:ye},5:{name:"signature",codec:ye}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(Ig||(Ig={}));var BAe,ln=class{constructor(e){let{peerId:t,payloadType:r,payload:n,signature:i}=e;this.peerId=t,this.payloadType=r,this.payload=n,this.signature=i}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=Ig.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload,signature:this.signature})),this.marshaled}equals(e){return Ce(this.marshal(),e.marshal())}async validate(e){let t=Hee(e,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return await ho(this.peerId.publicKey).verify(t,this.signature)}};BAe=ln,ln.createFromProtobuf=async e=>{let t=Ig.decode(e),r=await sn(t.publicKey);return new ln({peerId:r,payloadType:t.payloadType,payload:t.payload,signature:t.signature})},ln.seal=async(e,t)=>{let r=e.domain,n=e.codec,i=e.marshal(),s=Hee(r,n,i);if(t.privateKey==null)throw new Error("Missing private key");let a=await(await Jn(t.privateKey)).sign(s);return new ln({peerId:t,payloadType:n,payload:i,signature:a})},ln.openAndCertify=async(e,t)=>{let r=await ln.createFromProtobuf(e);if(!await r.validate(t))throw(0,zee.default)(new Error("envelope signature is not valid for the given domain"),qee.ERR_SIGNATURE_NOT_VALID);return r};var Hee=(e,t,r)=>{let n=U(e),i=AE.default.encode(n.byteLength),s=AE.default.encode(t.length),a=AE.default.encode(r.length);return Ae([new Uint8Array(i),n,new Uint8Array(s),t,new Uint8Array(a),r])};c(),c();function $ee(e,t){let r=(n,i)=>n.toString().localeCompare(i.toString());return e.length===t.length&&t.sort(r)&&e.sort(r).every((n,i)=>t[i].equals(n))}c();var Cg;(function(e){let t;(function(r){r.codec=()=>Xe({1:{name:"multiaddr",codec:ye}}),r.encode=n=>Qe(n,r.codec()),r.decode=n=>Ye(n,r.codec())})(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>Xe({1:{name:"peerId",codec:ye},2:{name:"seq",codec:nl},3:{name:"addresses",codec:e.AddressInfo.codec(),repeats:!0}}),e.encode=r=>Qe(r,e.codec()),e.decode=r=>Ye(r,e.codec())})(Cg||(Cg={})),c();var Gee="libp2p-peer-record",Wee=Uint8Array.from([3,1]),wn=class{constructor(e){this.domain=wn.DOMAIN,this.codec=wn.CODEC;let{peerId:t,multiaddrs:r,seqNumber:n}=e;this.peerId=t,this.multiaddrs=r??[],this.seqNumber=n??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=Cg.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))})),this.marshaled}equals(e){return!(!(e instanceof wn)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!$ee(this.multiaddrs,e.multiaddrs))}};wn.createFromProtobuf=e=>{let t=Cg.decode(e),r=Ir(t.peerId),n=(t.addresses??[]).map(s=>new j(s.multiaddr)),i=t.seq;return new wn({peerId:r,multiaddrs:n,seqNumber:i})},wn.DOMAIN=Gee,wn.CODEC=Wee,c(),c();var TE=Symbol.for("@libp2p/topology");function jee(e){return e!=null&&Boolean(e[TE])}var Yee=()=>{},EC=class{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??Yee,this.onDisconnect=e.onDisconnect??Yee}get[Symbol.toStringTag](){return TE.toString()}get[TE](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}};function g1(e){return new EC(e)}c(),c();var ud=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},ru,Ue=class extends EventTarget{constructor(){super(...arguments),ru.set(this,new Map)}listenerCount(e){let t=ud(this,ru,"f").get(e);return t==null?0:t.length}addEventListener(e,t,r){super.addEventListener(e,t,r);let n=ud(this,ru,"f").get(e);n==null&&(n=[],ud(this,ru,"f").set(e,n)),n.push({callback:t,once:(r!==!0&&r!==!1&&r?.once)??!1})}removeEventListener(e,t,r){super.removeEventListener(e.toString(),t??null,r);let n=ud(this,ru,"f").get(e);n!=null&&(n=n.filter(({callback:i})=>i!==t),ud(this,ru,"f").set(e,n))}dispatchEvent(e){let t=super.dispatchEvent(e),r=ud(this,ru,"f").get(e.type);return r==null||(r=r.filter(({once:n})=>!n),ud(this,ru,"f").set(e.type,r)),t}};ru=new WeakMap;var bC=class extends Event{constructor(e,t){super(e,t),this.detail=t?.detail}},ee=globalThis.CustomEvent??bC;c(),c(),c();var _C=w(ai(),1),w1=(e,t,r)=>{let n=_C.default.encode(e,t,r);return w1.bytes=_C.default.encode.bytes,t??Uint8Array.from(n)};w1.bytes=0;var Qee=8,MAe=10*1024;function kr(e){e=e??{};let t=Math.max(e.poolSize??MAe,e.minPoolSize??Qee),r=e.lengthEncoder??w1;return async function*(n){let i=new Uint8Array(t),s=0;for await(let a of n){r(a.length,i,s);let o=i.slice(s,s+r.bytes);s+=r.bytes,i.length-s<Qee&&(i=new Uint8Array(t),s=0),yield Ae([o,a.slice()],o.length+a.length)}}}kr.single=(e,t)=>{t=t??{};let r=t.lengthEncoder??w1;return new qe(r(e.length),e.slice())},c(),c();var vC=w(ai(),1),Pg=e=>{let t=vC.default.decode(e);return Pg.bytes=vC.default.decode.bytes,t};Pg.bytes=0;var IE=w(K(),1),UAe=8,FAe=1024*1024*4,KAe=new qe,Zl={LENGTH:"readLength",DATA:"readData"},VAe={[Zl.LENGTH]:(e,t,r,n)=>{let i=n?.lengthDecoder??Pg,s=n?.maxLengthLength??UAe,a=n?.maxDataLength??FAe;t.append(e);let o;try{o=i(t.slice())}catch(l){if(t.length>s)throw(0,IE.default)(new Error("message length too long"),"ERR_MSG_LENGTH_TOO_LONG");if(l instanceof RangeError)return{mode:Zl.LENGTH,buffer:t,chunk:void 0,state:void 0,data:void 0};throw l}if(o>a)throw(0,IE.default)(new Error("message data too long"),"ERR_MSG_DATA_TOO_LONG");return e=t.subarray(i.bytes),t=new qe,n?.onLength!=null&&n.onLength(o),o<=0?{mode:Zl.LENGTH,chunk:e,buffer:t,data:KAe}:{mode:Zl.DATA,chunk:e,buffer:t,state:{dataLength:o},data:void 0}},[Zl.DATA]:(e,t,r,n)=>{if(t.append(e),r==null)throw new Error("state is required");if(t.length<r.dataLength)return{mode:Zl.DATA,buffer:t,state:r,chunk:void 0,data:void 0};let{dataLength:i}=r,s=t.subarray(0,i),a=t.length>i?t.subarray(i):void 0;return t=new qe,{mode:Zl.LENGTH,chunk:a,buffer:t,state:void 0,data:s}}};function Er(e){return async function*(t){let r=new qe,n=Zl.LENGTH,i;for await(let s of t){let a=new qe(s);for(;a!=null;){let o=VAe[n](a,r,i,e);if(n=o.mode,a=o.chunk,r=o.buffer,i=o.state,o.data!=null){let l=o.data.slice();e?.onData!=null&&e.onData(l),yield l}}}if(r.length>0)throw(0,IE.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}Er.fromReader=(e,t)=>{let r=1,n=async function*(){for(;;)try{let{done:i,value:s}=await e.next(r);if(i===!0)return;s!=null&&(yield s)}catch(i){if(i.code==="ERR_UNDER_READ")return{done:!0,value:null};throw i}finally{r=1}}();return Er({...t??{},onLength:i=>{r=i}})(n)},c(),c();function Xee(e){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}var Zee=(e,t,r)=>(t=t??Xee(4),new DataView(t.buffer,t.byteOffset,t.byteLength).setInt32(r??0,e,!1),t);Zee.bytes=4,c();var Jee=e=>{if(e.length<4)throw RangeError("Could not decode int32BE");return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(0,!1)};Jee.bytes=4,c(),c();var Jl=class extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}};c();function ete(e){if(e!=null){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}function Pn(e,t,r){let n=r??{},i=ete(e);async function*s(){let a,o=()=>{a?.()};for(t.addEventListener("abort",o);;){let l;try{if(t.aborted){let{abortMessage:h,abortCode:f}=n;throw new Jl(h,f)}let u=new Promise((h,f)=>{a=()=>{let{abortMessage:y,abortCode:p}=n;f(new Jl(y,p))}});l=await Promise.race([u,i.next()]),a=null}catch(u){t.removeEventListener("abort",o);let h=u.type==="aborted"&&t.aborted;if(h&&n.onAbort!=null&&await n.onAbort(e),typeof i.return=="function")try{let f=i.return();f instanceof Promise&&f.catch(y=>{n.onReturnError!=null&&n.onReturnError(y)})}catch(f){n.onReturnError!=null&&n.onReturnError(f)}if(h&&n.returnOnAbort===!0)return;throw u}if(l.done===!0)break;yield l.value}t.removeEventListener("abort",o)}return s()}function qAe(e,t,r){return n=>e(Pn(n,t,r))}function as(e,t,r){return{sink:qAe(e.sink,t,{...r,onAbort:void 0}),source:Pn(e.source,t,r)}}var zAe=C("libp2p-pubsub:peer-streams"),CE=class extends Ue{constructor(e){super(),this.id=e.id,this.protocol=e.protocol,this._inboundAbortController=new AbortController,this.closed=!1}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(this.outboundStream==null){let t=this.id.toString();throw new Error("No writable connection to "+t)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=Pn(Te(this._rawInboundStream,Er()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.dispatchEvent(new ee("stream:inbound")),this.inboundStream}async attachOutboundStream(e){let t=this.outboundStream;return this.outboundStream!=null&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=zs({onEnd:r=>{this._rawOutboundStream!=null&&this._rawOutboundStream.reset!=null&&this._rawOutboundStream.reset(),this._rawOutboundStream=void 0,this.outboundStream=void 0,r!=null&&this.dispatchEvent(new ee("close"))}}),Te(this.outboundStream,kr(),this._rawOutboundStream).catch(r=>{zAe.error(r)}),t==null&&this.dispatchEvent(new ee("stream:outbound")),this.outboundStream}close(){this.closed||(this.closed=!0,this.outboundStream!=null&&this.outboundStream.end(),this.inboundStream!=null&&this._inboundAbortController.abort(),this._rawOutboundStream=void 0,this.outboundStream=void 0,this._rawInboundStream=void 0,this.inboundStream=void 0,this.dispatchEvent(new ee("close")))}};me(),c();var PE=class{constructor(e,t,r){this.gossip=e,this.msgs=new Map,this.history=[],this.msgIdToStrFn=r;for(let n=0;n<t;n++)this.history[n]=[]}get size(){return this.msgs.size}put(e,t,r=!1){let{msgIdStr:n}=e;return this.msgs.has(n)?!1:(this.msgs.set(n,{message:t,validated:r,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:t.topic}),!0)}observeDuplicate(e,t){let r=this.msgs.get(e);r&&!r.validated&&r.originatingPeers.add(t)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,t){let r=this.msgs.get(e);if(!r)return null;let n=(r.iwantCounts.get(t)??0)+1;return r.iwantCounts.set(t,n),{msg:r.message,count:n}}getGossipIDs(e){let t=new Map;for(let r=0;r<this.gossip;r++)this.history[r].forEach(n=>{let i=this.msgs.get(n.msgIdStr);if(i&&i.validated&&e.has(n.topic)){let s=t.get(n.topic);s||(s=[],t.set(n.topic,s)),s.push(n.msgId)}});return t}validate(e){let t=this.msgs.get(e);if(!t)return null;let{message:r,originatingPeers:n}=t;return t.validated=!0,t.originatingPeers=new Set,{message:r,originatingPeers:n}}shift(){this.history[this.history.length-1].forEach(e=>{this.msgs.delete(e.msgIdStr)}),this.history.pop(),this.history.unshift([])}remove(e){let t=this.msgs.get(e);return t?(this.msgs.delete(e),t):null}};c();var ef;(function(e){let t;(function(u){u.codec=()=>Xe({1:{name:"subscribe",codec:P2,optional:!0},2:{name:"topic",codec:pn,optional:!0}}),u.encode=h=>Qe(h,u.codec()),u.decode=h=>Ye(h,u.codec())})(t=e.SubOpts||(e.SubOpts={}));let r;(function(u){u.codec=()=>Xe({1:{name:"from",codec:ye,optional:!0},2:{name:"data",codec:ye,optional:!0},3:{name:"seqno",codec:ye,optional:!0},4:{name:"topic",codec:pn},5:{name:"signature",codec:ye,optional:!0},6:{name:"key",codec:ye,optional:!0}}),u.encode=h=>Qe(h,u.codec()),u.decode=h=>Ye(h,u.codec())})(r=e.Message||(e.Message={}));let n;(function(u){u.codec=()=>Xe({1:{name:"ihave",codec:e.ControlIHave.codec(),repeats:!0},2:{name:"iwant",codec:e.ControlIWant.codec(),repeats:!0},3:{name:"graft",codec:e.ControlGraft.codec(),repeats:!0},4:{name:"prune",codec:e.ControlPrune.codec(),repeats:!0}}),u.encode=h=>Qe(h,u.codec()),u.decode=h=>Ye(h,u.codec())})(n=e.ControlMessage||(e.ControlMessage={}));let i;(function(u){u.codec=()=>Xe({1:{name:"topicID",codec:pn,optional:!0},2:{name:"messageIDs",codec:ye,repeats:!0}}),u.encode=h=>Qe(h,u.codec()),u.decode=h=>Ye(h,u.codec())})(i=e.ControlIHave||(e.ControlIHave={}));let s;(function(u){u.codec=()=>Xe({1:{name:"messageIDs",codec:ye,repeats:!0}}),u.encode=h=>Qe(h,u.codec()),u.decode=h=>Ye(h,u.codec())})(s=e.ControlIWant||(e.ControlIWant={}));let a;(function(u){u.codec=()=>Xe({1:{name:"topicID",codec:pn,optional:!0}}),u.encode=h=>Qe(h,u.codec()),u.decode=h=>Ye(h,u.codec())})(a=e.ControlGraft||(e.ControlGraft={}));let o;(function(u){u.codec=()=>Xe({1:{name:"topicID",codec:pn,optional:!0},2:{name:"peers",codec:e.PeerInfo.codec(),repeats:!0},3:{name:"backoff",codec:nl,optional:!0}}),u.encode=h=>Qe(h,u.codec()),u.decode=h=>Ye(h,u.codec())})(o=e.ControlPrune||(e.ControlPrune={}));let l;(function(u){u.codec=()=>Xe({1:{name:"peerID",codec:ye,optional:!0},2:{name:"signedPeerRecord",codec:ye,optional:!0}}),u.encode=h=>Qe(h,u.codec()),u.decode=h=>Ye(h,u.codec())})(l=e.PeerInfo||(e.PeerInfo={})),e.codec=()=>Xe({1:{name:"subscriptions",codec:e.SubOpts.codec(),repeats:!0},2:{name:"messages",codec:e.Message.codec(),repeats:!0},3:{name:"control",codec:e.ControlMessage.codec(),optional:!0}}),e.encode=u=>Qe(u,e.codec()),e.decode=u=>Ye(u,e.codec())})(ef||(ef={})),c();var SC="/floodsub/1.0.0",Dg="/meshsub/1.0.0",kg="/meshsub/1.1.0",tte="ERR_TOPIC_VALIDATOR_REJECT",rte="ERR_TOPIC_VALIDATOR_IGNORE";c(),c();function Qa(e=[],t){return{subscriptions:[],messages:e,control:t?{graft:t.graft||[],prune:t.prune||[],ihave:t.ihave||[],iwant:t.iwant||[]}:void 0}}c();function Xa(e){if(e.length<=1)return e;let t=()=>Math.floor(Math.random()*Math.floor(e.length));for(let r=0;r<e.length;r++){let n=t(),i=e[r];e[r]=e[n],e[n]=i}return e}c();function DE(e){return e===Dg||e===kg}c(),me();function nte(e){return M(e,"base64")}c(),c();var ld="StrictSign",E1="StrictNoSign";c();var ite;(function(e){e.StrictSign="StrictSign",e.StrictNoSign="StrictNoSign"})(ite||(ite={}));var nu;(function(e){e[e.Signing=0]="Signing",e[e.Author=1]="Author",e[e.Anonymous=2]="Anonymous"})(nu||(nu={}));var Za;(function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"})(Za||(Za={}));var yi;(function(e){e.Error="error",e.Ignore="ignore",e.Reject="reject",e.Blacklisted="blacklisted"})(yi||(yi={}));var oi;(function(e){e.InvalidSignature="invalid_signature",e.InvalidSeqno="invalid_seqno",e.InvalidPeerId="invalid_peerid",e.SignaturePresent="signature_present",e.SeqnoPresent="seqno_present",e.FromPresent="from_present",e.TransformFailed="transform_failed"})(oi||(oi={}));var bo;(function(e){e.duplicate="duplicate",e.invalid="invalid",e.valid="valid"})(bo||(bo={}));function xC(e){switch(e){case Za.Ignore:return yi.Ignore;case Za.Reject:return yi.Reject}}async function RC(e,t){switch(e){case ld:{if(!t)throw Error("Must provide PeerId");if(t.privateKey==null)throw Error("Cannot sign message, no private key present");if(t.publicKey==null)throw Error("Cannot sign message, no public key present");let r=await Jn(t.privateKey);return{type:nu.Signing,author:t,key:t.publicKey,privateKey:r}}case E1:return{type:nu.Anonymous};default:throw new Error(`Unknown signature policy "${e}"`)}}c(),c(),c();var hr="ERR_INVALID_PEER_SCORE_PARAMS",dr=w(K(),1),$Ae={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},GAe={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function ote(e={}){return{...$Ae,...e,topics:e.topics?Object.entries(e.topics).reduce((t,[r,n])=>(t[r]=WAe(n),t),{}):{}}}function WAe(e={}){return{...GAe,...e}}function ste(e){for(let[t,r]of Object.entries(e.topics))try{jAe(r)}catch(n){throw(0,dr.default)(new Error(`invalid score parameters for topic ${t}: ${n.message}`),hr)}if(e.topicScoreCap<0)throw(0,dr.default)(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),hr);if(e.appSpecificScore===null||e.appSpecificScore===void 0)throw(0,dr.default)(new Error("missing application specific score function"),hr);if(e.IPColocationFactorWeight>0)throw(0,dr.default)(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),hr);if(e.IPColocationFactorWeight!==0&&e.IPColocationFactorThreshold<1)throw(0,dr.default)(new Error("invalid IPColocationFactorThreshold; must be at least 1"),hr);if(e.behaviourPenaltyWeight>0)throw(0,dr.default)(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),hr);if(e.behaviourPenaltyWeight!==0&&(e.behaviourPenaltyDecay<=0||e.behaviourPenaltyDecay>=1))throw(0,dr.default)(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),hr);if(e.decayInterval<1e3)throw(0,dr.default)(new Error("invalid DecayInterval; must be at least 1s"),hr);if(e.decayToZero<=0||e.decayToZero>=1)throw(0,dr.default)(new Error("invalid DecayToZero; must be between 0 and 1"),hr)}function jAe(e){if(e.topicWeight<0)throw(0,dr.default)(new Error("invalid topic weight; must be >= 0"),hr);if(e.timeInMeshQuantum===0)throw(0,dr.default)(new Error("invalid TimeInMeshQuantum; must be non zero"),hr);if(e.timeInMeshWeight<0)throw(0,dr.default)(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),hr);if(e.timeInMeshWeight!==0&&e.timeInMeshQuantum<=0)throw(0,dr.default)(new Error("invalid TimeInMeshQuantum; must be positive"),hr);if(e.timeInMeshWeight!==0&&e.timeInMeshCap<=0)throw(0,dr.default)(new Error("invalid TimeInMeshCap; must be positive"),hr);if(e.firstMessageDeliveriesWeight<0)throw(0,dr.default)(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),hr);if(e.firstMessageDeliveriesWeight!==0&&(e.firstMessageDeliveriesDecay<=0||e.firstMessageDeliveriesDecay>=1))throw(0,dr.default)(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),hr);if(e.firstMessageDeliveriesWeight!==0&&e.firstMessageDeliveriesCap<=0)throw(0,dr.default)(new Error("invalid FirstMessageDeliveriesCap; must be positive"),hr);if(e.meshMessageDeliveriesWeight>0)throw(0,dr.default)(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),hr);if(e.meshMessageDeliveriesWeight!==0&&(e.meshMessageDeliveriesDecay<=0||e.meshMessageDeliveriesDecay>=1))throw(0,dr.default)(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),hr);if(e.meshMessageDeliveriesWeight!==0&&e.meshMessageDeliveriesCap<=0)throw(0,dr.default)(new Error("invalid MeshMessageDeliveriesCap; must be positive"),hr);if(e.meshMessageDeliveriesWeight!==0&&e.meshMessageDeliveriesThreshold<=0)throw(0,dr.default)(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),hr);if(e.meshMessageDeliveriesWindow<0)throw(0,dr.default)(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),hr);if(e.meshMessageDeliveriesWeight!==0&&e.meshMessageDeliveriesActivation<1e3)throw(0,dr.default)(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),hr);if(e.meshFailurePenaltyWeight>0)throw(0,dr.default)(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),hr);if(e.meshFailurePenaltyWeight!==0&&(e.meshFailurePenaltyDecay<=0||e.meshFailurePenaltyDecay>=1))throw(0,dr.default)(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),hr);if(e.invalidMessageDeliveriesWeight>0)throw(0,dr.default)(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),hr);if(e.invalidMessageDeliveriesDecay<=0||e.invalidMessageDeliveriesDecay>=1)throw(0,dr.default)(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),hr)}c();var YAe=w(K(),1),QAe={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function ate(e={}){return{...QAe,...e}}c(),c();function cte(e,t,r,n){let i=0;if(Object.entries(t.topics).forEach(([s,a])=>{let o=r.topics[s];if(o===void 0)return;let l=0;if(a.inMesh){let h=a.meshTime/o.timeInMeshQuantum;h>o.timeInMeshCap&&(h=o.timeInMeshCap),l+=h*o.timeInMeshWeight}let u=a.firstMessageDeliveries;if(u>o.firstMessageDeliveriesCap&&(u=o.firstMessageDeliveriesCap),l+=u*o.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<o.meshMessageDeliveriesThreshold){let h=o.meshMessageDeliveriesThreshold-a.meshMessageDeliveries;l+=h*h*o.meshMessageDeliveriesWeight}l+=a.meshFailurePenalty*o.meshFailurePenaltyWeight,l+=a.invalidMessageDeliveries*a.invalidMessageDeliveries*o.invalidMessageDeliveriesWeight,i+=l*o.topicWeight}),r.topicScoreCap>0&&i>r.topicScoreCap&&(i=r.topicScoreCap),i+=r.appSpecificScore(e)*r.appSpecificWeight,t.ips.forEach(s=>{if(r.IPColocationFactorWhitelist.has(s))return;let a=n.get(s),o=a?a.size:0;if(o>r.IPColocationFactorThreshold){let l=o-r.IPColocationFactorThreshold;i+=l*l*r.IPColocationFactorWeight}}),t.behaviourPenalty>r.behaviourPenaltyThreshold){let s=t.behaviourPenalty-r.behaviourPenaltyThreshold;i+=s*s*r.behaviourPenaltyWeight}return i}c();var fte=w(lte(),1),Di;(function(e){e[e.unknown=0]="unknown",e[e.valid=1]="valid",e[e.invalid=2]="invalid",e[e.ignored=3]="ignored"})(Di||(Di={}));var kE=class{constructor(){this.records=new Map,this.queue=new fte.default}ensureRecord(e){let t=this.records.get(e);if(t)return t;t={status:Di.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,t);let r={msgId:e,expire:Date.now()+12e4};return this.queue.push(r),t}gc(){let e=Date.now(),t=this.queue.peekFront();for(;t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};c();var Xi=w(K(),1);c();function iu(e){return e!=null&&typeof e.start=="function"&&typeof e.stop=="function"}function gi(e){return e!=null&&typeof e.init=="function"}var He=class{constructor(e={}){this.started=!1,e.peerId!=null&&this.setPeerId(e.peerId),e.addressManager!=null&&this.setAddressManager(e.addressManager),e.peerStore!=null&&this.setPeerStore(e.peerStore),e.upgrader!=null&&this.setUpgrader(e.upgrader),e.metrics!=null&&this.setMetrics(e.metrics),e.registrar!=null&&this.setRegistrar(e.registrar),e.connectionManager!=null&&this.setConnectionManager(e.connectionManager),e.transportManager!=null&&this.setTransportManager(e.transportManager),e.connectionGater!=null&&this.setConnectionGater(e.connectionGater),e.contentRouting!=null&&this.setContentRouting(e.contentRouting),e.peerRouting!=null&&this.setPeerRouting(e.peerRouting),e.datastore!=null&&this.setDatastore(e.datastore),e.connectionProtector!=null&&this.setConnectionProtector(e.connectionProtector),e.dht!=null&&this.setDHT(e.dht),e.pubsub!=null&&this.setPubSub(e.pubsub)}isStarted(){return this.started}async beforeStart(){await Promise.all(Object.values(this).filter(e=>iu(e)).map(async e=>{e.beforeStart!=null&&await e.beforeStart()}))}async start(){await Promise.all(Object.values(this).filter(e=>iu(e)).map(async e=>{await e.start()})),this.started=!0}async afterStart(){await Promise.all(Object.values(this).filter(e=>iu(e)).map(async e=>{e.afterStart!=null&&await e.afterStart()}))}async beforeStop(){await Promise.all(Object.values(this).filter(e=>iu(e)).map(async e=>{e.beforeStop!=null&&await e.beforeStop()}))}async stop(){await Promise.all(Object.values(this).filter(e=>iu(e)).map(async e=>{await e.stop()})),this.started=!1}async afterStop(){await Promise.all(Object.values(this).filter(e=>iu(e)).map(async e=>{e.afterStop!=null&&await e.afterStop()}))}setPeerId(e){return this.peerId=e,e}getPeerId(){if(this.peerId==null)throw(0,Xi.default)(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this.peerId}setMetrics(e){return this.metrics=e,gi(e)&&e.init(this),e}getMetrics(){return this.metrics}setAddressManager(e){return this.addressManager=e,gi(e)&&e.init(this),e}getAddressManager(){if(this.addressManager==null)throw(0,Xi.default)(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this.addressManager}setPeerStore(e){return this.peerStore=e,gi(e)&&e.init(this),e}getPeerStore(){if(this.peerStore==null)throw(0,Xi.default)(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this.peerStore}setUpgrader(e){return this.upgrader=e,gi(e)&&e.init(this),e}getUpgrader(){if(this.upgrader==null)throw(0,Xi.default)(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this.upgrader}setRegistrar(e){return this.registrar=e,gi(e)&&e.init(this),e}getRegistrar(){if(this.registrar==null)throw(0,Xi.default)(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this.registrar}setConnectionManager(e){return this.connectionManager=e,gi(e)&&e.init(this),e}getConnectionManager(){if(this.connectionManager==null)throw(0,Xi.default)(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this.connectionManager}setTransportManager(e){return this.transportManager=e,gi(e)&&e.init(this),e}getTransportManager(){if(this.transportManager==null)throw(0,Xi.default)(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this.transportManager}setConnectionGater(e){return this.connectionGater=e,gi(e)&&e.init(this),e}getConnectionGater(){if(this.connectionGater==null)throw(0,Xi.default)(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this.connectionGater}setContentRouting(e){return this.contentRouting=e,gi(e)&&e.init(this),e}getContentRouting(){if(this.contentRouting==null)throw(0,Xi.default)(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this.contentRouting}setPeerRouting(e){return this.peerRouting=e,gi(e)&&e.init(this),e}getPeerRouting(){if(this.peerRouting==null)throw(0,Xi.default)(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this.peerRouting}setDatastore(e){return this.datastore=e,gi(e)&&e.init(this),e}getDatastore(){if(this.datastore==null)throw(0,Xi.default)(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this.datastore}setConnectionProtector(e){return this.connectionProtector=e,gi(e)&&e.init(this),e}getConnectionProtector(){return this.connectionProtector}setDHT(e){return this.dht=e,gi(e)&&e.init(this),e}getDHT(){if(this.dht==null)throw(0,Xi.default)(new Error("dht not set"),"ERR_SERVICE_MISSING");return this.dht}setPubSub(e){return this.pubsub=e,gi(e)&&e.init(this),e}getPubSub(){if(this.pubsub==null)throw(0,Xi.default)(new Error("pubsub not set"),"ERR_SERVICE_MISSING");return this.pubsub}},b1=C("libp2p:gossipsub:score"),NE=class{constructor(e,t,r){this.params=e,this.metrics=t,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new kE,this.components=new He,ste(e),this.scoreCacheValidityMs=r.scoreCacheValidityMs,this.computeScore=r.computeScore??cte}init(e){this.components=e}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){b1("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),b1("started")}stop(){if(!this._backgroundInterval){b1("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),b1("stopped")}background(){this.refreshScores(),this.updateIPs(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([e,t])=>[e,t]))}refreshScores(){let e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach((r,n)=>{if(!r.connected){e>r.expire&&(this.removeIPs(n,r.ips),this.peerStats.delete(n),this.scoreCache.delete(n));return}Object.entries(r.topics).forEach(([i,s])=>{let a=this.params.topics[i];a!==void 0&&(s.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,s.firstMessageDeliveries<t&&(s.firstMessageDeliveries=0),s.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,s.meshMessageDeliveries<t&&(s.meshMessageDeliveries=0),s.meshFailurePenalty*=a.meshFailurePenaltyDecay,s.meshFailurePenalty<t&&(s.meshFailurePenalty=0),s.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,s.invalidMessageDeliveries<t&&(s.invalidMessageDeliveries=0),s.inMesh&&(s.meshTime=e-s.graftTime,s.meshTime>a.meshMessageDeliveriesActivation&&(s.meshMessageDeliveriesActive=!0)))}),r.behaviourPenalty*=this.params.behaviourPenaltyDecay,r.behaviourPenalty<t&&(r.behaviourPenalty=0)})}score(e){this.metrics?.scoreFnCalls.inc();let t=this.peerStats.get(e);if(!t)return 0;let r=Date.now(),n=this.scoreCache.get(e);if(n&&n.cacheUntil>r)return n.score;this.metrics?.scoreFnRuns.inc();let i=this.computeScore(e,t,this.params,this.peerIPs),s=r+this.scoreCacheValidityMs;return n?(this.metrics?.scoreCachedDelta.observe(Math.abs(i-n.score)),n.score=i,n.cacheUntil=s):this.scoreCache.set(e,{score:i,cacheUntil:s}),i}addPenalty(e,t,r){let n=this.peerStats.get(e);n&&(n.behaviourPenalty+=t,this.metrics?.onScorePenalty(r))}addPeer(e){let t={connected:!0,expire:0,topics:{},ips:[],behaviourPenalty:0};this.peerStats.set(e,t);let r=this.getIPs(e);this.setIPs(e,r,t.ips),t.ips=r}removePeer(e){let t=this.peerStats.get(e);if(t){if(this.score(e)>0){this.removeIPs(e,t.ips),this.peerStats.delete(e);return}Object.entries(t.topics).forEach(([r,n])=>{n.firstMessageDeliveries=0;let i=this.params.topics[r].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<i){let s=i-n.meshMessageDeliveries;n.meshFailurePenalty+=s*s}n.inMesh=!1,n.meshMessageDeliveriesActive=!1}),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){let r=this.peerStats.get(e);if(r){let n=this.getPtopicStats(r,t);n&&(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1)}}prune(e,t){let r=this.peerStats.get(e);if(r){let n=this.getPtopicStats(r,t);if(n){let i=this.params.topics[t].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<i){let s=i-n.meshMessageDeliveries;n.meshFailurePenalty+=s*s}n.meshMessageDeliveriesActive=!1,n.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,t,r){this.markFirstMessageDelivery(e,r);let n=this.deliveryRecords.ensureRecord(t),i=Date.now();if(n.status!==Di.unknown){b1("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",e,i-n.firstSeen,Di[n.status]);return}n.status=Di.valid,n.validated=i,n.peers.forEach(s=>{s!==e.toString()&&this.markDuplicateMessageDelivery(s,r)})}rejectInvalidMessage(e,t){this.markInvalidMessageDelivery(e,t)}rejectMessage(e,t,r,n){switch(n){case yi.Error:this.markInvalidMessageDelivery(e,r);return;case yi.Blacklisted:return}let i=this.deliveryRecords.ensureRecord(t);if(i.status!==Di.unknown){b1("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-i.firstSeen,Di[i.status]);return}if(n===yi.Ignore){i.status=Di.ignored,i.peers.clear();return}i.status=Di.invalid,this.markInvalidMessageDelivery(e,r),i.peers.forEach(s=>{this.markInvalidMessageDelivery(s,r)}),i.peers.clear()}duplicateMessage(e,t,r){let n=this.deliveryRecords.ensureRecord(t);if(!n.peers.has(e))switch(n.status){case Di.unknown:n.peers.add(e);break;case Di.valid:n.peers.add(e),this.markDuplicateMessageDelivery(e,r,n.validated);break;case Di.invalid:this.markInvalidMessageDelivery(e,r);break;case Di.ignored:break}}markInvalidMessageDelivery(e,t){let r=this.peerStats.get(e);if(r){let n=this.getPtopicStats(r,t);n&&(n.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,t){let r=this.peerStats.get(e);if(r){let n=this.getPtopicStats(r,t);if(n){let i=this.params.topics[t].firstMessageDeliveriesCap;n.firstMessageDeliveries=Math.min(i,n.firstMessageDeliveries+1),n.inMesh&&(i=this.params.topics[t].meshMessageDeliveriesCap,n.meshMessageDeliveries=Math.min(i,n.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,t,r){let n=this.peerStats.get(e);if(n){let i=r!==void 0?Date.now():0,s=this.getPtopicStats(n,t);if(s&&s.inMesh){let a=this.params.topics[t];if(r!==void 0){let l=i-r,u=l>a.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(t,l,u),u)return}let o=a.meshMessageDeliveriesCap;s.meshMessageDeliveries=Math.min(o,s.meshMessageDeliveries+1)}}}getIPs(e){return this.components.getConnectionManager().getConnections(ue(e)).map(t=>t.remoteAddr.toOptions().host)}setIPs(e,t,r){e:for(let n of t){for(let s of r)if(n===s)continue e;let i=this.peerIPs.get(n);i||(i=new Set,this.peerIPs.set(n,i)),i.add(e)}e:for(let n of r){for(let s of t)if(n===s)continue e;let i=this.peerIPs.get(n);!i||(i.delete(e),i.size||this.peerIPs.delete(n))}}removeIPs(e,t){t.forEach(r=>{let n=this.peerIPs.get(r);!n||(n.delete(e),n.size||this.peerIPs.delete(r))})}updateIPs(){this.peerStats.forEach((e,t)=>{let r=this.getIPs(t);this.setIPs(t,r,e.ips),e.ips=r})}getPtopicStats(e,t){let r=e.topics[t];return r!==void 0?r:this.params.topics[t]!==void 0?(r={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[t]=r,r):null}};c();var OE=class{constructor(e,t,r){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=t,this.metrics=r,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,t){let r=Math.floor(Math.random()*t.length),n=t[r],i=this.msgIdToStrFn(n),s=this.promises.get(i);s||(s=new Map,this.promises.set(i,s));let a=Date.now();s.has(e)||(s.set(e,a+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(i)||this.requestMsByMsg.set(i,a)))}getBrokenPromises(){let e=Date.now(),t=new Map,r=0;return this.promises.forEach((n,i)=>{n.forEach((s,a)=>{s<e&&(t.set(a,(t.get(a)??0)+1),n.delete(a),r++)}),n.size||this.promises.delete(i)}),this.metrics?.iwantPromiseBroken.inc(r),t}deliverMessage(e){this.trackMessage(e);let t=this.promises.get(e);t&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(t.size)))}rejectMessage(e,t){switch(this.trackMessage(e),t){case yi.Error:return}this.promises.delete(e)}clear(){this.promises.clear()}prune(){let e=Date.now()-this.requestMsByMsgExpire;for(let[t,r]of this.requestMsByMsg.entries())if(r<e)this.requestMsByMsg.delete(t);else break}trackMessage(e){if(this.metrics){let t=this.requestMsByMsg.get(e);t!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-t)/1e3),this.requestMsByMsg.delete(e))}}};c();var _1=class{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,t){this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs})}prune(){let e=Date.now();for(let[t,r]of this.entries.entries())if(r.validUntilMs<e)this.entries.delete(t);else break}has(e){return this.entries.has(e)}get(e){let t=this.entries.get(e);return t&&t.validUntilMs>=Date.now()?t.value:void 0}clear(){this.entries.clear()}};c();var hte;(function(e){e.forward="forward",e.publish="publish"})(hte||(hte={}));var ou;(function(e){e.Fanout="fanout",e.Random="random",e.Subscribed="subscribed",e.Outbound="outbound",e.NotEnough="not_enough",e.Opportunistic="opportunistic"})(ou||(ou={}));var fd;(function(e){e.Dc="disconnected",e.BadScore="bad_score",e.Prune="prune",e.Unsub="unsubscribed",e.Excess="excess"})(fd||(fd={}));var S1;(function(e){e.GraftBackoff="graft_backoff",e.BrokenPromise="broken_promise",e.MessageDeficit="message_deficit",e.IPColocation="IP_colocation"})(S1||(S1={}));var x1;(function(e){e.LowScore="low_score",e.MaxIhave="max_ihave",e.MaxIasked="max_iasked"})(x1||(x1={}));var v1;(function(e){e.graylist="graylist",e.publish="publish",e.gossip="gossip",e.mesh="mesh"})(v1||(v1={}));function dte(e,t,r){return{protocolsEnabled:e.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:e.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:e.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:e.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:e.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:e.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:e.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:e.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:e.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:e.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:e.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:e.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:e.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:e.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:e.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:e.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:e.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:e.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:e.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:e.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:e.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:e.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:e.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:e.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:e.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:e.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:e.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:e.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:e.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:e.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:e.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:e.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:e.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:e.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:e.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:e.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:e.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:e.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:e.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:e.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:e.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:e.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:e.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:e.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:e.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:e.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:e.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:e.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:e.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:e.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:e.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:e.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:e.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:e.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:e.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:e.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:e.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:e.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:e.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),cacheSize:e.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:e.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),topicStrToLabel:t,toTopic(n){return this.topicStrToLabel.get(n)??n},onJoin(n){this.topicSubscriptionStatus.set({topicStr:n},1),this.meshPeerCounts.set({topicStr:n},0)},onLeave(n){this.topicSubscriptionStatus.set({topicStr:n},0),this.meshPeerCounts.set({topicStr:n},0)},onAddToMesh(n,i,s){let a=this.toTopic(n);this.meshPeerInclusionEvents.inc({topic:a,reason:i},s)},onRemoveFromMesh(n,i,s){let a=this.toTopic(n);this.meshPeerChurnEvents.inc({topic:a,reason:i},s)},onReportValidationMcacheHit(n){this.asyncValidationMcacheHit.inc({hit:n?"hit":"miss"})},onReportValidation(n,i){let s=this.toTopic(n);this.asyncValidationResult.inc({topic:s,acceptance:i})},onScorePenalty(n){this.scoringPenalties.inc({penalty:n},1)},onIhaveRcv(n,i,s){let a=this.toTopic(n);this.ihaveRcvMsgids.inc({topic:a},i),this.ihaveRcvNotSeenMsgids.inc({topic:a},s)},onIwantRcv(n,i){for(let[s,a]of n){let o=this.toTopic(s);this.iwantRcvMsgids.inc({topic:o},a)}this.iwantRcvDonthaveMsgids.inc(i)},onForwardMsg(n,i){let s=this.toTopic(n);this.msgForwardCount.inc({topic:s},1),this.msgForwardPeers.inc({topic:s},i)},onPublishMsg(n,i,s,a){let o=this.toTopic(n);this.msgPublishCount.inc({topic:o},1),this.msgPublishBytes.inc({topic:o},s*a),this.msgPublishPeers.inc({topic:o},s),this.msgPublishPeersByGroup.inc({topic:o,peerGroup:"direct"},i.direct),this.msgPublishPeersByGroup.inc({topic:o,peerGroup:"floodsub"},i.floodsub),this.msgPublishPeersByGroup.inc({topic:o,peerGroup:"mesh"},i.mesh),this.msgPublishPeersByGroup.inc({topic:o,peerGroup:"fanout"},i.fanout)},onMsgRecvPreValidation(n){let i=this.toTopic(n);this.msgReceivedPreValidation.inc({topic:i},1)},onMsgRecvResult(n,i){let s=this.toTopic(n);this.msgReceivedStatus.inc({topic:s,status:i})},onMsgRecvInvalid(n,i){let s=this.toTopic(n),a=i.reason===yi.Error?i.error:i.reason;this.msgReceivedInvalid.inc({topic:s,error:a},1)},onDuplicateMsgDelivery(n,i,s){if(this.duplicateMsgDeliveryDelay.observe(i/1e3),s){let a=this.toTopic(n);this.duplicateMsgLateDelivery.inc({topic:a},1)}},onRpcRecv(n,i){this.rpcRecvBytes.inc(i),this.rpcRecvCount.inc(1),this.rpcRecvSubscription.inc(n.subscriptions.length),this.rpcRecvMessage.inc(n.messages.length),n.control&&(this.rpcRecvControl.inc(1),this.rpcRecvIHave.inc(n.control.ihave.length),this.rpcRecvIWant.inc(n.control.iwant.length),this.rpcRecvGraft.inc(n.control.graft.length),this.rpcRecvPrune.inc(n.control.prune.length))},onRpcSent(n,i){if(this.rpcSentBytes.inc(i),this.rpcSentCount.inc(1),this.rpcSentSubscription.inc(n.subscriptions.length),this.rpcSentMessage.inc(n.messages.length),n.control){let s=n.control.ihave.length,a=n.control.iwant.length,o=n.control.graft.length,l=n.control.prune.length;s>0&&this.rpcSentIHave.inc(s),a>0&&this.rpcSentIWant.inc(a),o>0&&this.rpcSentGraft.inc(o),l>0&&this.rpcSentPrune.inc(l),(s>0||a>0||o>0||l>0)&&this.rpcSentControl.inc(1)}},registerScores(n,i){let s=0,a=0,o=0,l=0;for(let u of n)u>=i.graylistThreshold&&s++,u>=i.publishThreshold&&a++,u>=i.gossipThreshold&&o++,u>=0&&l++;this.peersByScoreThreshold.set({threshold:v1.graylist},s),this.peersByScoreThreshold.set({threshold:v1.publish},a),this.peersByScoreThreshold.set({threshold:v1.gossip},o),this.peersByScoreThreshold.set({threshold:v1.mesh},l),this.score.set(n)},registerScoreWeights(n){for(let[i,s]of n.byTopic)this.scoreWeights.set({topic:i,p:"p1"},s.p1w),this.scoreWeights.set({topic:i,p:"p2"},s.p2w),this.scoreWeights.set({topic:i,p:"p3"},s.p3w),this.scoreWeights.set({topic:i,p:"p3b"},s.p3bw),this.scoreWeights.set({topic:i,p:"p4"},s.p4w);this.scoreWeights.set({p:"p5"},n.p5w),this.scoreWeights.set({p:"p6"},n.p6w),this.scoreWeights.set({p:"p7"},n.p7w)},registerScorePerMesh(n,i){let s=new Map;n.forEach((a,o)=>{let l=this.topicStrToLabel.get(o)??"unknown",u=s.get(l);u||(u=new Set,s.set(l,u)),a.forEach(h=>u?.add(h))});for(let[a,o]of s){let l=[];o.forEach(u=>{l.push(i.get(u)??0)}),this.scorePerMesh.set({topic:a},l)}}}}c();var QC=w(YC(),1);ur(),Re(),yr();var lre=U("libp2p-pubsub:");async function fre(e,t,r){switch(e.type){case nu.Signing:{let n={from:e.author.toBytes(),data:r,seqno:(0,QC.randomBytes)(8),topic:t,signature:void 0,key:void 0},i=Ae([lre,ef.Message.encode(n)]);return n.signature=await e.privateKey.sign(i),n.key=e.key,n}case nu.Author:return{from:e.author.toBytes(),data:r,seqno:(0,QC.randomBytes)(8),topic:t,signature:void 0,key:void 0};case nu.Anonymous:return{from:void 0,data:r,seqno:void 0,topic:t,signature:void 0,key:void 0}}}async function hre(e,t){switch(e){case E1:return t.signature!=null?{valid:!1,error:oi.SignaturePresent}:t.seqno!=null?{valid:!1,error:oi.SeqnoPresent}:t.key!=null?{valid:!1,error:oi.FromPresent}:{valid:!0,fromPeerId:null};case ld:{if(t.seqno==null)return{valid:!1,error:oi.InvalidSeqno};if(t.seqno.length!==8)return{valid:!1,error:oi.InvalidSeqno};if(t.signature==null)return{valid:!1,error:oi.InvalidSignature};if(t.from==null)return{valid:!1,error:oi.InvalidPeerId};let r;try{r=Ir(t.from)}catch{return{valid:!1,error:oi.InvalidPeerId}}let n;if(t.key){if(n=ho(t.key),r.publicKey!==void 0&&!Ce(n.bytes,r.publicKey))return{valid:!1,error:oi.InvalidPeerId}}else{if(r.publicKey==null)return{valid:!1,error:oi.InvalidPeerId};n=ho(r.publicKey)}let i={from:t.from,data:t.data,seqno:t.seqno,topic:t.topic,signature:void 0,key:void 0},s=Ae([lre,ef.Message.encode(i)]);return await n.verify(s,t.signature)?{valid:!0,fromPeerId:r}:{valid:!1,error:oi.InvalidSignature}}}}c(),vr(),c();var UIe=w(YC(),1);Re(),me(),vr(),c();var FIe=w(K(),1),dre=(e,t)=>{let r=U(t.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(e.length+r.length);return n.set(e,0),n.set(r,e.length),n};function pre(e){if(e.sequenceNumber==null)throw Error("missing seqno field");return dre(e.from.toBytes(),e.sequenceNumber)}async function mre(e){return await xe.encode(e.data)}c();function KIe(e,t,r,n,i){let s=0,a=new Map;if(Object.entries(t.topics).forEach(([h,f])=>{let y=i.get(h)??"unknown",p=r.topics[h];if(p===void 0)return;let v=a.get(y);v||(v={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},a.set(y,v));let d=0,g=0,b=0,_=0,m=0;f.inMesh&&(d+=Math.max(f.meshTime/p.timeInMeshQuantum,p.timeInMeshCap)*p.timeInMeshWeight);let E=f.firstMessageDeliveries;if(E>p.firstMessageDeliveriesCap&&(E=p.firstMessageDeliveriesCap),g+=E*p.firstMessageDeliveriesWeight,f.meshMessageDeliveriesActive&&f.meshMessageDeliveries<p.meshMessageDeliveriesThreshold){let D=p.meshMessageDeliveriesThreshold-f.meshMessageDeliveries;b+=D*D*p.meshMessageDeliveriesWeight}_+=f.meshFailurePenalty*p.meshFailurePenaltyWeight,m+=f.invalidMessageDeliveries*f.invalidMessageDeliveries*p.invalidMessageDeliveriesWeight,s+=(d+g+b+_+m)*p.topicWeight,v.p1w+=d,v.p2w+=g,v.p3w+=b,v.p3bw+=_,v.p4w+=m}),r.topicScoreCap>0&&s>r.topicScoreCap){s=r.topicScoreCap;let h=r.topicScoreCap/s;for(let f of a.values())f.p1w*=h,f.p2w*=h,f.p3w*=h,f.p3bw*=h,f.p4w*=h}let o=0,l=0,u=0;return o+=r.appSpecificScore(e)*r.appSpecificWeight,t.ips.forEach(h=>{if(r.IPColocationFactorWhitelist.has(h))return;let f=n.get(h),y=f?f.size:0;if(y>r.IPColocationFactorThreshold){let p=y-r.IPColocationFactorThreshold;l+=p*p*r.IPColocationFactorWeight}}),u+=t.behaviourPenalty*t.behaviourPenalty*r.behaviourPenaltyWeight,s+=o+l+u,{byTopic:a,p5w:o,p6w:l,p7w:u,score:s}}function yre(e,t,r,n,i){let s={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(let a of e){let o=t.get(a);if(o){let l=KIe(a,o,r,n,i);for(let[u,h]of l.byTopic){let f=s.byTopic.get(u);f||(f={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},s.byTopic.set(u,f)),f.p1w.push(h.p1w),f.p2w.push(h.p2w),f.p3w.push(h.p3w),f.p3bw.push(h.p3bw),f.p4w.push(h.p4w)}s.p5w.push(l.p5w),s.p6w.push(l.p6w),s.p7w.push(l.p7w),s.score.push(l.score)}else s.p5w.push(0),s.p6w.push(0),s.p7w.push(0),s.score.push(0)}return s}c();function YE(e,t,r=()=>!0){let n=new Set;if(t<=0)return n;for(let i of e){if(n.size>=t)break;r(i)&&(n.add(i),e.delete(i))}return n}function gre(e,t){return YE(e,t,()=>!0)}var _o;(function(e){e[e.started=0]="started",e[e.stopped=1]="stopped"})(_o||(_o={}));var Fg=class extends Ue{constructor(e={}){super(),this.multicodecs=[kg,Dg],this.peers=new Map,this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.components=new He,this.directPeerInitial=null,this.status={code:_o.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{let r=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(n=>{this.log("Error running heartbeat",n)}).finally(()=>{if(r?.(),this.status.code===_o.started){clearTimeout(this.status.heartbeatTimeout);let n=(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;n<this.opts.heartbeatInterval*.25&&(n+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,n)}})};let t={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...e,scoreParams:ote(e.scoreParams),scoreThresholds:ate(e.scoreThresholds)};if(this.globalSignaturePolicy=t.globalSignaturePolicy??ld,t.fallbackToFloodsub&&this.multicodecs.push(SC),this.log=C(t.debugName??"libp2p:gossipsub"),this.opts=t,this.direct=new Set(t.directPeers.map(r=>r.id.toString())),this.seenCache=new _1({validityMs:t.seenTTL}),this.publishedMessageIds=new _1({validityMs:t.seenTTL}),e.msgIdFn)this.msgIdFn=e.msgIdFn;else switch(this.globalSignaturePolicy){case ld:this.msgIdFn=pre;break;case E1:this.msgIdFn=mre;break}if(e.fastMsgIdFn&&(this.fastMsgIdFn=e.fastMsgIdFn,this.fastMsgIdCache=new _1({validityMs:t.seenTTL})),this.msgIdToStrFn=e.msgIdToStrFn??nte,this.mcache=e.messageCache||new PE(t.mcacheGossip,t.mcacheLength,this.msgIdToStrFn),e.dataTransform&&(this.dataTransform=e.dataTransform),e.metricsRegister){if(!e.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");let r=Math.max(...Object.values(t.scoreParams.topics).map(i=>i.meshMessageDeliveriesWindow),1e3),n=dte(e.metricsRegister,e.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:t.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:r/1e3});n.mcacheSize.addCollect(()=>this.onScrapeMetrics(n));for(let i of this.multicodecs)n.protocolsEnabled.set({protocol:i},1);this.metrics=n}else this.metrics=null;this.gossipTracer=new OE(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new NE(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:t.heartbeatInterval})}getPeers(){return[...this.peers.keys()].map(e=>ue(e))}isStarted(){return this.status.code===_o.started}async init(e){this.components=e,this.score.init(e)}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await RC(this.globalSignaturePolicy,this.components.getPeerId()),await Promise.all(this.opts.directPeers.map(async n=>{await this.components.getPeerStore().addressBook.add(n.id,n.addrs)})),await this.components.getRegistrar().handle(this.multicodecs,this.onIncomingStream.bind(this));let e=g1({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),t=await this.components.getRegistrar().register(this.multicodecs,e),r=setTimeout(this.runHeartbeat,100);this.status={code:_o.started,registrarTopologyId:t,heartbeatTimeout:r,hearbeatStartMs:Date.now()+100},this.log("started"),this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async n=>await this.connect(n)))}).catch(n=>{this.log(n)})},1e3)}async stop(){if(this.log("stopping"),this.status.code!==_o.started)return;let{registrarTopologyId:e}=this.status;this.status={code:_o.stopped},this.components.getRegistrar().unregister(e);for(let t of this.peers.values())t.close();this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({protocol:e,stream:t,connection:r}){if(!this.isStarted())return;let n=r.remotePeer,i=this.addPeer(n,e,r.stat.direction).attachInboundStream(t);this.pipePeerReadStream(n,i).catch(s=>this.log(s))}onPeerConnected(e,t){!this.isStarted()||(this.log("topology peer connected %p %s",e,t.stat.direction),Promise.resolve().then(async()=>{try{let{stream:r,protocol:n}=await t.newStream(this.multicodecs);await this.addPeer(e,n,t.stat.direction).attachOutboundStream(r)}catch(r){this.log(r)}this.subscriptions.size>0&&this.sendSubscriptions(e.toString(),Array.from(this.subscriptions),!0)}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}addPeer(e,t,r){let n=e.toString(),i=this.peers.get(n);return i===void 0&&(this.log("new peer %p",e),i=new CE({id:e,protocol:t}),this.peers.set(n,i),i.addEventListener("close",()=>this.removePeer(e))),this.score.addPeer(n),t===SC&&this.floodsubPeers.add(n),this.metrics?.peersPerProtocol.inc({protocol:t},1),this.outbound.get(n)||this.outbound.set(n,r==="outbound"),i}removePeer(e){let t=e.toString(),r=this.peers.get(t);if(r!=null){this.metrics?.peersPerProtocol.inc({protocol:r.protocol},-1),this.log("delete peer %p",e),this.peers.delete(t),r.close();for(let n of this.topics.values())n.delete(t)}for(let[n,i]of this.mesh)i.delete(t)===!0&&this.metrics?.onRemoveFromMesh(n,fd.Dc,1);for(let n of this.fanout.values())n.delete(t);return this.floodsubPeers.delete(t),this.gossip.delete(t),this.control.delete(t),this.outbound.delete(t),this.score.removePeer(t),this.acceptFromWhitelist.delete(t),r}get started(){return this.status.code===_o.started}getMeshPeers(e){let t=this.mesh.get(e);return t?Array.from(t):[]}getSubscribers(e){let t=this.topics.get(e);return(t?Array.from(t):[]).map(r=>ue(r))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,t){try{await Te(t,async r=>{for await(let n of r)try{let i=n instanceof Uint8Array?n:n.slice(),s=ef.decode(i);this.metrics?.onRpcRecv(s,i.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(e,s):this.handleReceivedRpc(e,s).catch(a=>this.log(a))}catch(i){this.log(i)}})}catch(r){this.log.error(r),this.onPeerDisconnected(e)}}async handleReceivedRpc(e,t){if(!this.acceptFrom(e.toString())){this.log("received message from unacceptable peer %p",e),this.metrics?.rpcRecvNotAccepted.inc();return}this.log("rpc from %p",e),t.subscriptions.length>0&&(t.subscriptions.forEach(r=>{this.handleReceivedSubscription(e,r)}),this.dispatchEvent(new ee("subscription-change",{detail:{peerId:e,subscriptions:t.subscriptions.filter(r=>r.topic!==null).map(r=>({topic:r.topic??"",subscribe:Boolean(r.subscribe)}))}})));for(let r of t.messages){let n=this.handleReceivedMessage(e,r).catch(i=>this.log(i));this.opts.awaitRpcMessageHandler&&await n}t.control&&await this.handleControlMessage(e.toString(),t.control)}handleReceivedSubscription(e,t){if(t.topic==null)return;this.log("subscription update from %p topic %s",e,t.topic);let r=this.topics.get(t.topic);r==null&&(r=new Set,this.topics.set(t.topic,r)),t.subscribe?r.add(e.toString()):r.delete(e.toString())}async handleReceivedMessage(e,t){this.metrics?.onMsgRecvPreValidation(t.topic);let r=await this.validateReceivedMessage(e,t);switch(this.metrics?.onMsgRecvResult(t.topic,r.code),r.code){case bo.duplicate:this.score.duplicateMessage(e.toString(),r.msgIdStr,t.topic),this.mcache.observeDuplicate(r.msgIdStr,e.toString());return;case bo.invalid:if(r.msgIdStr){let n=r.msgIdStr;this.score.rejectMessage(e.toString(),n,t.topic,r.reason),this.gossipTracer.rejectMessage(n,r.reason)}else this.score.rejectInvalidMessage(e.toString(),t.topic);this.metrics?.onMsgRecvInvalid(t.topic,r);return;case bo.valid:this.score.validateMessage(r.messageId.msgIdStr),this.gossipTracer.deliverMessage(r.messageId.msgIdStr),this.mcache.put(r.messageId,t,!this.opts.asyncValidation),this.subscriptions.has(t.topic)&&(!this.components.getPeerId().equals(e)||this.opts.emitSelf)&&(super.dispatchEvent(new ee("gossipsub:message",{detail:{propagationSource:e,msgId:r.messageId.msgIdStr,msg:r.msg}})),super.dispatchEvent(new ee("message",{detail:r.msg}))),this.opts.asyncValidation||this.forwardMessage(r.messageId.msgIdStr,t,e.toString())}}async validateReceivedMessage(e,t){let r=this.fastMsgIdFn?.(t),n=r?this.fastMsgIdCache?.get(r):void 0;if(n)return{code:bo.duplicate,msgIdStr:n};let i=await hre(this.globalSignaturePolicy,t);if(!i.valid)return{code:bo.invalid,reason:yi.Error,error:i.error};let s;try{let f=t.data??new Uint8Array(0);s=this.dataTransform?this.dataTransform.inboundTransform(t.topic,f):f}catch(f){return this.log("Invalid message, transform failed",f),{code:bo.invalid,reason:yi.Error,error:oi.TransformFailed}}if(t.from==null)return this.log("Invalid message, transform failed"),{code:bo.invalid,reason:yi.Error,error:oi.TransformFailed};let a={from:Ir(t.from),data:s,sequenceNumber:t.seqno==null?void 0:BigInt(`0x${M(t.seqno,"base16")}`),topic:t.topic},o=await this.msgIdFn(a),l=this.msgIdToStrFn(o),u={msgId:o,msgIdStr:l};if(r&&this.fastMsgIdCache?.put(r,l),this.seenCache.has(l))return{code:bo.duplicate,msgIdStr:l};this.seenCache.put(l);let h=this.topicValidators.get(t.topic);if(h!=null){let f;try{f=await h(a.topic,a,e)}catch(y){let p=y.code;p===rte&&(f=Za.Ignore),p===tte?f=Za.Reject:f=Za.Ignore}if(f!==Za.Accept)return{code:bo.invalid,reason:xC(f),msgIdStr:l}}return{code:bo.valid,messageId:u,msg:a}}getScore(e){return this.score.score(e)}sendSubscriptions(e,t,r){this.sendRpc(e,{subscriptions:t.map(n=>({topic:n,subscribe:r})),messages:[]})}async handleControlMessage(e,t){if(t===void 0)return;let r=this.handleIHave(e,t.ihave),n=this.handleIWant(e,t.iwant),i=await this.handleGraft(e,t.graft);await this.handlePrune(e,t.prune),!(!r.length&&!n.length&&!i.length)&&this.sendRpc(e,Qa(n,{iwant:r,prune:i}))}acceptFrom(e){if(this.direct.has(e))return!0;let t=Date.now(),r=this.acceptFromWhitelist.get(e);if(r&&r.messagesAccepted<128&&r.acceptUntil>=t)return r.messagesAccepted+=1,!0;let n=this.score.score(e);return n>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+1e3}):this.acceptFromWhitelist.delete(e),n>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,t){if(!t.length)return[];let r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,r),this.metrics?.ihaveRcvIgnored.inc({reason:x1.LowScore}),[];let n=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,n),n>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:x1.MaxIhave}),[];let i=this.iasked.get(e)??0;if(i>=5e3)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,i),this.metrics?.ihaveRcvIgnored.inc({reason:x1.MaxIasked}),[];let s=new Map;if(t.forEach(({topicID:l,messageIDs:u})=>{if(!l||!this.mesh.has(l))return;let h=0;u.forEach(f=>{let y=this.msgIdToStrFn(f);this.seenCache.has(y)||(s.set(y,f),h++)}),this.metrics?.onIhaveRcv(l,u.length,h)}),!s.size)return[];let a=s.size;a+i>5e3&&(a=5e3-i),this.log("IHAVE: Asking for %d out of %d messages from %s",a,s.size,e);let o=Array.from(s.values());return Xa(o),o=o.slice(0,a),this.iasked.set(e,i+a),this.gossipTracer.addPromise(e,o),[{messageIDs:o}]}handleIWant(e,t){if(!t.length)return[];let r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,r),[];let n=new Map,i=new Map,s=0;return t.forEach(({messageIDs:a})=>{a.forEach(o=>{let l=this.msgIdToStrFn(o),u=this.mcache.getWithIWantCount(l,e);if(u==null){s++;return}if(i.set(u.msg.topic,1+(i.get(u.msg.topic)??0)),u.count>3){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}n.set(l,u.msg)})}),this.metrics?.onIwantRcv(i,s),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,t){let r=[],n=this.score.score(e),i=Date.now(),s=this.opts.doPX;return t.forEach(({topicID:a})=>{if(!a)return;let o=this.mesh.get(a);if(!o){s=!1;return}if(o.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),r.push(a),s=!1;return}let l=this.backoff.get(a)?.get(e);if(typeof l=="number"&&i<l){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,S1.GraftBackoff),s=!1;let u=l+this.opts.graftFloodThreshold-this.opts.pruneBackoff;i<u&&this.score.addPenalty(e,1,S1.GraftBackoff),this.addBackoff(e,a),r.push(a);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,a),r.push(a),s=!1,this.addBackoff(e,a);return}if(o.size>=this.opts.Dhi&&!this.outbound.get(e)){r.push(a),this.addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),o.add(e),this.metrics?.onAddToMesh(a,ou.Subscribed,1)}),r.length?await Promise.all(r.map(a=>this.makePrune(e,a,s))):[]}async handlePrune(e,t){let r=this.score.score(e);for(let{topicID:n,backoff:i,peers:s}of t){if(n==null)continue;let a=this.mesh.get(n);if(!a)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),a.has(e)&&(a.delete(e),this.metrics?.onRemoveFromMesh(n,fd.Unsub,1)),typeof i=="number"&&i>0?this.doAddBackoff(e,n,i*1e3):this.addBackoff(e,n),s.length){if(r<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,r,n);continue}await this.pxConnect(s)}}}addBackoff(e,t){this.doAddBackoff(e,t,this.opts.pruneBackoff)}doAddBackoff(e,t,r){let n=this.backoff.get(t);n||(n=new Map,this.backoff.set(t,n));let i=Date.now()+r;(n.get(e)??0)<i&&n.set(e,i)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e,S1.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%15!==0)return;let e=Date.now();this.backoff.forEach((t,r)=>{t.forEach((n,i)=>{n<e&&t.delete(i)}),t.size===0&&this.backoff.delete(r)})}async directConnect(){let e=[];this.direct.forEach(t=>{let r=this.peers.get(t);(!r||!r.isWritable)&&e.push(t)}),await Promise.all(e.map(async t=>await this.connect(t)))}async pxConnect(e){e.length>this.opts.prunePeers&&(Xa(e),e=e.slice(0,this.opts.prunePeers));let t=[];await Promise.all(e.map(async r=>{if(!r.peerID)return;let n=Ir(r.peerID).toString();if(!this.peers.has(n)){if(!r.signedPeerRecord){t.push(n);return}try{let i=await ln.openAndCertify(r.signedPeerRecord,"libp2p-peer-record"),s=i.peerId;if(!i.peerId.equals(n)){this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",s,n);return}if(!await this.components.getPeerStore().addressBook.consumePeerRecord(i)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}t.push(n)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),t.length&&await Promise.all(t.map(async r=>await this.connect(r)))}async connect(e){this.log("Initiating connection with %s",e),await(await this.components.getConnectionManager().openConnection(ue(e))).newStream(this.multicodecs)}subscribe(e){if(this.status.code!==_o.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(let t of this.peers.keys())this.sendSubscriptions(t,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==_o.started)throw new Error("Pubsub is not started");let t=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,t),t)for(let r of this.peers.keys())this.sendSubscriptions(r,[e],!1);this.leave(e).catch(r=>{this.log(r)})}join(e){if(this.status.code!==_o.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);let t=new Set,r=this.fanout.get(e);if(r&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),r.forEach(n=>{!this.direct.has(n)&&this.score.score(n)>=0&&t.add(n)}),this.metrics?.onAddToMesh(e,ou.Fanout,t.size)),t.size<this.opts.D){let n=t.size;this.getRandomGossipPeers(e,this.opts.D,i=>!t.has(i)&&!this.direct.has(i)&&this.score.score(i)>=0).forEach(i=>{t.add(i)}),this.metrics?.onAddToMesh(e,ou.Random,t.size-n)}this.mesh.set(e,t),t.forEach(n=>{this.log("JOIN: Add mesh link to %s in %s",n,e),this.sendGraft(n,e)})}async leave(e){if(this.status.code!==_o.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);let t=this.mesh.get(e);t&&(await Promise.all(Array.from(t).map(async r=>(this.log("LEAVE: Remove mesh link to %s in %s",r,e),await this.sendPrune(r,e)))),this.mesh.delete(e))}selectPeersToForward(e,t,r){let n=new Set,i=this.topics.get(e);i&&(this.direct.forEach(a=>{i.has(a)&&t!==a&&!r?.has(a)&&n.add(a)}),this.floodsubPeers.forEach(a=>{i.has(a)&&t!==a&&!r?.has(a)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&n.add(a)}));let s=this.mesh.get(e);return s&&s.size>0&&s.forEach(a=>{t!==a&&!r?.has(a)&&n.add(a)}),n}selectPeersToPublish(e){let t=new Set,r={direct:0,floodsub:0,mesh:0,fanout:0},n=this.topics.get(e);if(n)if(this.opts.floodPublish)n.forEach(i=>{this.direct.has(i)?(t.add(i),r.direct++):this.score.score(i)>=this.opts.scoreThresholds.publishThreshold&&(t.add(i),r.floodsub++)});else{this.direct.forEach(s=>{n.has(s)&&(t.add(s),r.direct++)}),this.floodsubPeers.forEach(s=>{n.has(s)&&this.score.score(s)>=this.opts.scoreThresholds.publishThreshold&&(t.add(s),r.floodsub++)});let i=this.mesh.get(e);if(i&&i.size>0)i.forEach(s=>{t.add(s),r.mesh++});else{let s=this.fanout.get(e);if(s&&s.size>0)s.forEach(a=>{t.add(a),r.fanout++});else{let a=this.getRandomGossipPeers(e,this.opts.D,o=>this.score.score(o)>=this.opts.scoreThresholds.publishThreshold);a.size>0&&(this.fanout.set(e,a),a.forEach(o=>{t.add(o),r.fanout++}))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:t,tosendCount:r}}forwardMessage(e,t,r,n){r&&this.score.deliverMessage(r,e,t.topic);let i=this.selectPeersToForward(t.topic,r,n),s=Qa([t]);i.forEach(a=>{this.sendRpc(a,s)}),this.metrics?.onForwardMsg(t.topic,i.size)}async publish(e,t){let r=this.dataTransform?this.dataTransform.outboundTransform(e,t):t;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");let n=await fre(this.publishConfig,e,r);if(n.from==null)throw Error("PublishError.InvalidMessage");let i={from:Ir(n.from),data:t,sequenceNumber:n.seqno==null?void 0:BigInt(`0x${M(n.seqno,"base16")}`),topic:e,signature:n.signature,key:n.key},s=await this.msgIdFn(i),a=this.msgIdToStrFn(s);if(this.seenCache.has(a))throw Error("PublishError.Duplicate");let{tosend:o,tosendCount:l}=this.selectPeersToPublish(n.topic),u=this.opts.emitSelf===!0&&this.subscriptions.has(e);if(o.size===0&&!this.opts.allowPublishToZeroPeers&&!u)throw Error("PublishError.InsufficientPeers");this.seenCache.put(a),this.mcache.put({msgId:s,msgIdStr:a},n,!0),this.publishedMessageIds.put(a);let h=Qa([n]);for(let f of o)this.sendRpc(f,h)||o.delete(f);return this.metrics?.onPublishMsg(e,l,o.size,n.data!=null?n.data.length:0),u&&(o.add(this.components.getPeerId().toString()),super.dispatchEvent(new ee("gossipsub:message",{detail:{propagationSource:this.components.getPeerId(),msgId:a,msg:i}})),super.dispatchEvent(new ee("message",{detail:i}))),{recipients:Array.from(o.values()).map(f=>ue(f))}}reportMessageValidationResult(e,t,r){if(r===Za.Accept){let n=this.mcache.validate(e);if(this.metrics?.onReportValidationMcacheHit(n!==null),n!=null){let{message:i,originatingPeers:s}=n;this.score.deliverMessage(t.toString(),e,i.topic),this.forwardMessage(e,n.message,t.toString(),s),this.metrics?.onReportValidation(i.topic,r)}}else{let n=this.mcache.remove(e);if(this.metrics?.onReportValidationMcacheHit(n!==null),n){let i=xC(r),{message:s,originatingPeers:a}=n;this.score.rejectMessage(t.toString(),e,s.topic,i);for(let o of a)this.score.rejectMessage(o,e,s.topic,i);this.metrics?.onReportValidation(s.topic,r)}}}sendGraft(e,t){let r=Qa([],{graft:[{topicID:t}]});this.sendRpc(e,r)}async sendPrune(e,t){let r=[await this.makePrune(e,t,this.opts.doPX)],n=Qa([],{prune:r});this.sendRpc(e,n)}sendRpc(e,t){let r=this.peers.get(e);if(!r||!r.isWritable)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;let n=this.control.get(e);n&&(this.piggybackControl(e,t,n),this.control.delete(e));let i=this.gossip.get(e);i&&(this.piggybackGossip(e,t,i),this.gossip.delete(e));let s=ef.encode(t);return r.write(s),this.metrics?.onRpcSent(t,s.length),!0}piggybackControl(e,t,r){let n=r.graft.filter(({topicID:s})=>(s&&this.mesh.get(s)||new Set).has(e)),i=r.prune.filter(({topicID:s})=>!(s&&this.mesh.get(s)||new Set).has(e));!n.length&&!i.length||(t.control?(t.control.graft=t.control.graft.concat(n),t.control.prune=t.control.prune.concat(i)):t.control={graft:n,prune:i,ihave:[],iwant:[]})}piggybackGossip(e,t,r){t.control||(t.control={ihave:[],iwant:[],graft:[],prune:[]}),t.control.ihave=r}async sendGraftPrune(e,t,r){let n=this.opts.doPX;for(let[i,s]of e){let a=s.map(h=>({topicID:h})),o=[],l=t.get(i);l&&(o=await Promise.all(l.map(async h=>await this.makePrune(i,h,n&&!(r.get(i)??!1)))),t.delete(i));let u=Qa([],{graft:a,prune:o});this.sendRpc(i,u)}for(let[i,s]of t){let a=await Promise.all(s.map(async l=>await this.makePrune(i,l,n&&!(r.get(i)??!1)))),o=Qa([],{prune:a});this.sendRpc(i,o)}}emitGossip(e){let t=this.mcache.getGossipIDs(new Set(e.keys()));for(let[r,n]of e)this.doEmitGossip(r,n,t.get(r)??[])}doEmitGossip(e,t,r){if(!r.length||(Xa(r),r.length>5e3&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",r.length),!t.size))return;let n=this.opts.Dlazy,i=.25*t.size,s=t;i>n&&(n=i),n>s.size?n=s.size:s=Xa(Array.from(s)).slice(0,n),s.forEach(a=>{let o=r;r.length>5e3&&(o=Xa(o.slice()).slice(0,5e3)),this.pushGossip(a,{topicID:e,messageIDs:o})})}flush(){for(let[e,t]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,Qa([],{ihave:t}));for(let[e,t]of this.control.entries())this.control.delete(e),this.sendRpc(e,Qa([],{graft:t.graft,prune:t.prune}))}pushGossip(e,t){this.log("Add gossip to %s",e);let r=this.gossip.get(e)||[];this.gossip.set(e,r.concat(t))}async makePrune(e,t,r){if(this.score.prune(e,t),this.peers.get(e).protocol===Dg)return{topicID:t,peers:[]};let n=BigInt(this.opts.pruneBackoff/1e3);if(!r)return{topicID:t,peers:[],backoff:n};let i=this.getRandomGossipPeers(t,this.opts.prunePeers,a=>a!==e&&this.score.score(a)>=0),s=await Promise.all(Array.from(i).map(async a=>{let o=ue(a);return{peerID:o.toBytes(),signedPeerRecord:await this.components.getPeerStore().addressBook.getRawEnvelope(o)}}));return{topicID:t,peers:s,backoff:n}}async heartbeat(){let{D:e,Dlo:t,Dhi:r,Dscore:n,Dout:i,fanoutTTL:s}=this.opts;this.heartbeatTicks++;let a=new Map,o=p=>{let v=a.get(p);return v===void 0&&(v=this.score.score(p),a.set(p,v)),v},l=new Map,u=new Map,h=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();let f=new Map;this.mesh.forEach((p,v)=>{let d=this.topics.get(v),g=new Set,b=new Set;if(f.set(v,b),d){let E=Xa(Array.from(d)),D=this.backoff.get(v);for(let N of E){let R=this.peers.get(N);if(R&&DE(R.protocol)&&!p.has(N)&&!this.direct.has(N)){let T=o(N);(!D||!D.has(N))&&T>=0&&g.add(N),T>=this.opts.scoreThresholds.gossipThreshold&&b.add(N)}}}let _=(E,D)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",E,v),this.addBackoff(E,v),p.delete(E),o(E)>=this.opts.scoreThresholds.gossipThreshold&&b.add(E),this.metrics?.onRemoveFromMesh(v,D,1);let N=u.get(E);N?N.push(v):u.set(E,[v])},m=(E,D)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",E,v),this.score.graft(E,v),p.add(E),b.delete(E),this.metrics?.onAddToMesh(v,D,1);let N=l.get(E);N?N.push(v):l.set(E,[v])};if(p.forEach(E=>{let D=o(E);D<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",E,D,v),_(E,fd.BadScore),h.set(E,!0))}),p.size<t){let E=e-p.size;gre(g,E).forEach(D=>{m(D,ou.NotEnough)})}if(p.size>r){let E=Array.from(p);E.sort((N,R)=>o(R)-o(N)),E=E.slice(0,n).concat(Xa(E.slice(n)));let D=0;if(E.slice(0,e).forEach(N=>{this.outbound.get(N)&&D++}),D<i){let N=T=>{let S=E[T];for(let O=T;O>0;O--)E[O]=E[O-1];E[0]=S};if(D>0){let T=D;for(let S=1;S<e&&T>0;S++)this.outbound.get(E[S])&&(N(S),T--)}let R=e-D;for(let T=e;T<E.length&&R>0;T++)this.outbound.get(E[T])&&(N(T),R--)}E.slice(e).forEach(N=>{_(N,fd.Excess)})}if(p.size>=t){let E=0;if(p.forEach(D=>{this.outbound.get(D)&&E++}),E<i){let D=i-E;YE(g,D,N=>this.outbound.get(N)===!0).forEach(N=>{m(N,ou.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&p.size>1){let E=Array.from(p).sort((R,T)=>o(R)-o(T)),D=Math.floor(p.size/2),N=o(E[D]);if(N<this.opts.scoreThresholds.opportunisticGraftThreshold){let R=this.opts.opportunisticGraftPeers,T=YE(g,R,S=>o(S)>N);for(let S of T)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",S,v),m(S,ou.Opportunistic)}}});let y=Date.now();this.fanoutLastpub.forEach((p,v)=>{p+s<y&&(this.fanout.delete(v),this.fanoutLastpub.delete(v))}),this.fanout.forEach((p,v)=>{let d=this.topics.get(v);p.forEach(m=>{(!d.has(m)||o(m)<this.opts.scoreThresholds.publishThreshold)&&p.delete(m)});let g=this.topics.get(v),b=[],_=new Set;if(f.set(v,_),g){let m=Xa(Array.from(g));for(let E of m){let D=this.peers.get(E);if(D&&DE(D.protocol)&&!p.has(E)&&!this.direct.has(E)){let N=o(E);N>=this.opts.scoreThresholds.publishThreshold&&b.push(E),N>=this.opts.scoreThresholds.gossipThreshold&&_.add(E)}}}if(p.size<e){let m=e-p.size;b.slice(0,m).forEach(E=>{p.add(E),_?.delete(E)})}}),this.emitGossip(f),await this.sendGraftPrune(l,u,h),this.flush(),this.mcache.shift(),this.dispatchEvent(new ee("gossipsub:heartbeat"))}getRandomGossipPeers(e,t,r=()=>!0){let n=this.topics.get(e);if(!n)return new Set;let i=[];return n.forEach(s=>{let a=this.peers.get(s);!a||DE(a.protocol)&&r(s)&&i.push(s)}),i=Xa(i),t>0&&i.length>t&&(i=i.slice(0,t)),new Set(i)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let t=0;for(let s of this.backoff.values())t+=s.size;e.cacheSize.set({cache:"backoff"},t);for(let[s,a]of this.topics)e.topicPeersCount.set({topicStr:s},a.size);for(let[s,a]of this.mesh)e.meshPeerCounts.set({topicStr:s},a.size);let r=[],n=new Map;e.behaviourPenalty.reset();for(let s of this.peers.keys()){let a=this.score.score(s);r.push(a),n.set(s,a),e.behaviourPenalty.observe(this.score.peerStats.get(s)?.behaviourPenalty??0)}e.registerScores(r,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,n);let i=yre(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(i)}};Fg.multicodec=kg;var Ere=()=>({gossipsub:new Fg({allowPublishToZeroPeers:!0,fallbackToFloodsub:!0,emitSelf:!0})});c(),te(),c();var Are=w(Xu(),1);c(),c();function XC(e,t,r){let n=0,i=e.length;for(;i>0;){let s=Math.trunc(i/2),a=n+s;r(e[a],t)<=0?(n=++a,i-=s+1):i=s}return n}var gd=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},au,Kg=class{constructor(){au.set(this,[])}enqueue(e,t){t={priority:0,...t};let r={priority:t.priority,run:e};if(this.size&&gd(this,au,"f")[this.size-1].priority>=t.priority){gd(this,au,"f").push(r);return}let n=XC(gd(this,au,"f"),r,(i,s)=>s.priority-i.priority);gd(this,au,"f").splice(n,0,r)}dequeue(){return gd(this,au,"f").shift()?.run}filter(e){return gd(this,au,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return gd(this,au,"f").length}};au=new WeakMap;var tr=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},be=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Wn,qg,zg,af,eb,Hg,QE,Js,Vg,vo,XE,So,$g,sf,P1,D1,wd,ZE,bre,_re,Rre,vre,Sre,xre,JE,ZC,JC,tb,rb=()=>{},pCe=new hi,eP=class extends Error{},Gg=class extends Are.default{constructor(e){var t,r,n,i;if(super(),Wn.add(this),qg.set(this,void 0),zg.set(this,void 0),af.set(this,0),eb.set(this,void 0),Hg.set(this,void 0),QE.set(this,0),Js.set(this,void 0),Vg.set(this,void 0),vo.set(this,void 0),XE.set(this,void 0),So.set(this,0),$g.set(this,void 0),sf.set(this,void 0),P1.set(this,rb),D1.set(this,rb),wd.set(this,void 0),ZE.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Kg,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);tr(this,qg,e.carryoverConcurrencyCount,"f"),tr(this,zg,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),tr(this,eb,e.intervalCap,"f"),tr(this,Hg,e.interval,"f"),tr(this,vo,new e.queueClass,"f"),tr(this,XE,e.queueClass,"f"),this.concurrency=e.concurrency,tr(this,wd,e.timeout,"f"),tr(this,ZE,e.throwOnTimeout===!0,"f"),tr(this,sf,e.autoStart===!1,"f")}get concurrency(){return be(this,$g,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);tr(this,$g,e,"f"),be(this,Wn,"m",tb).call(this)}async add(e,t={}){return new Promise((r,n)=>{let i=async()=>{var s,a,o;tr(this,So,(a=be(this,So,"f"),a++,a),"f"),tr(this,af,(o=be(this,af,"f"),o++,o),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){n(new eP("The task was aborted."));return}let l=await(be(this,wd,"f")===void 0&&t.timeout===void 0?e({signal:t.signal}):nn(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?be(this,wd,"f"):t.timeout,()=>{(t.throwOnTimeout===void 0?be(this,ZE,"f"):t.throwOnTimeout)&&n(pCe)}));r(l),this.emit("completed",l)}catch(l){n(l),this.emit("error",l)}be(this,Wn,"m",Rre).call(this)};be(this,vo,"f").enqueue(i,t),be(this,Wn,"m",JE).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return be(this,sf,"f")?(tr(this,sf,!1,"f"),be(this,Wn,"m",tb).call(this),this):this}pause(){tr(this,sf,!0,"f")}clear(){tr(this,vo,new(be(this,XE,"f")),"f")}async onEmpty(){if(be(this,vo,"f").size!==0)return new Promise(e=>{let t=be(this,P1,"f");tr(this,P1,()=>{t(),e()},"f")})}async onSizeLessThan(e){if(!(be(this,vo,"f").size<e))return new Promise(t=>{let r=()=>{be(this,vo,"f").size<e&&(this.removeListener("next",r),t())};this.on("next",r)})}async onIdle(){if(!(be(this,So,"f")===0&&be(this,vo,"f").size===0))return new Promise(e=>{let t=be(this,D1,"f");tr(this,D1,()=>{t(),e()},"f")})}get size(){return be(this,vo,"f").size}sizeBy(e){return be(this,vo,"f").filter(e).length}get pending(){return be(this,So,"f")}get isPaused(){return be(this,sf,"f")}get timeout(){return be(this,wd,"f")}set timeout(e){tr(this,wd,e,"f")}};qg=new WeakMap,zg=new WeakMap,af=new WeakMap,eb=new WeakMap,Hg=new WeakMap,QE=new WeakMap,Js=new WeakMap,Vg=new WeakMap,vo=new WeakMap,XE=new WeakMap,So=new WeakMap,$g=new WeakMap,sf=new WeakMap,P1=new WeakMap,D1=new WeakMap,wd=new WeakMap,ZE=new WeakMap,Wn=new WeakSet,bre=function(){return be(this,zg,"f")||be(this,af,"f")<be(this,eb,"f")},_re=function(){return be(this,So,"f")<be(this,$g,"f")},Rre=function(){var e;tr(this,So,(e=be(this,So,"f"),e--,e),"f"),be(this,Wn,"m",JE).call(this),this.emit("next")},vre=function(){be(this,P1,"f").call(this),tr(this,P1,rb,"f"),be(this,So,"f")===0&&(be(this,D1,"f").call(this),tr(this,D1,rb,"f"),this.emit("idle"))},Sre=function(){be(this,Wn,"m",JC).call(this),be(this,Wn,"m",ZC).call(this),tr(this,Vg,void 0,"f")},xre=function(){let e=Date.now();if(be(this,Js,"f")===void 0){let t=be(this,QE,"f")-e;if(t<0)tr(this,af,be(this,qg,"f")?be(this,So,"f"):0,"f");else return be(this,Vg,"f")===void 0&&tr(this,Vg,setTimeout(()=>{be(this,Wn,"m",Sre).call(this)},t),"f"),!0}return!1},JE=function(){if(be(this,vo,"f").size===0)return be(this,Js,"f")&&clearInterval(be(this,Js,"f")),tr(this,Js,void 0,"f"),be(this,Wn,"m",vre).call(this),!1;if(!be(this,sf,"f")){let e=!be(this,Wn,"m",xre).call(this);if(be(this,Wn,"a",bre)&&be(this,Wn,"a",_re)){let t=be(this,vo,"f").dequeue();return t?(this.emit("active"),t(),e&&be(this,Wn,"m",ZC).call(this),!0):!1}}return!1},ZC=function(){be(this,zg,"f")||be(this,Js,"f")!==void 0||(tr(this,Js,setInterval(()=>{be(this,Wn,"m",JC).call(this)},be(this,Hg,"f")),"f"),tr(this,QE,Date.now()+be(this,Hg,"f"),"f"))},JC=function(){be(this,af,"f")===0&&be(this,So,"f")===0&&be(this,Js,"f")&&(clearInterval(be(this,Js,"f")),tr(this,Js,void 0,"f")),tr(this,af,be(this,qg,"f")?be(this,So,"f"):0,"f"),be(this,Wn,"m",tb).call(this)},tb=function(){for(;be(this,Wn,"m",JE).call(this););};var Ire=w(K(),1),tP=w(Vi(),1),Ed=C("libp2p-delegated-peer-routing"),Tre=3e4,mCe=4,nb=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new Gg({concurrency:mCe});let{protocol:t,host:r,port:n}=e.getEndpointConfig();Ed(`enabled DelegatedPeerRouting via ${t}://${r}:${n}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async findPeer(e,t={}){Ed("findPeer starts: %p",e),t.timeout=t.timeout??Tre,t.signal=(0,tP.default)([this.abortController.signal].concat(t.signal!=null?[t.signal]:[]));let r=Ar(),n=Ar();this.httpQueue.add(async()=>(r.resolve(),await n.promise));try{await r.promise;for await(let i of this.client.dht.findPeer(e,t))if(i.name==="FINAL_PEER")return{id:i.peer.id,multiaddrs:i.peer.multiaddrs.map(s=>new j(s.toString())),protocols:[]}}catch(i){throw Ed.error("findPeer errored: %o",i),i}finally{n.resolve(),Ed("findPeer finished: %p",e)}throw(0,Ire.default)(new Error("Not found"),"ERR_NOT_FOUND")}async*getClosestPeers(e,t={}){let r,n=I.asCID(e);n!=null?r=n:r=Ir(e),Ed("getClosestPeers starts: %s",r),t.timeout=t.timeout??Tre,t.signal=(0,tP.default)([this.abortController.signal].concat(t.signal!=null?[t.signal]:[]));let i=Ar(),s=Ar();this.httpQueue.add(async()=>(i.resolve(),await s.promise));try{await i.promise;for await(let a of this.client.dht.query(r,t))a.name==="PEER_RESPONSE"&&(yield*a.closer.map(o=>({id:o.id,multiaddrs:o.multiaddrs.map(l=>new j(l.toString())),protocols:[]})))}catch(a){throw Ed.error("getClosestPeers errored:",a),a}finally{s.resolve(),Ed("getClosestPeers finished: %b",e)}}};c();var sP=w(Ci(),1);c();var Lre=w(Xu(),1);c(),c();function rP(e,t,r){let n=0,i=e.length;for(;i>0;){let s=Math.trunc(i/2),a=n+s;r(e[a],t)<=0?(n=++a,i-=s+1):i=s}return n}var bd=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},cu,Wg=class{constructor(){cu.set(this,[])}enqueue(e,t){t={priority:0,...t};let r={priority:t.priority,run:e};if(this.size&&bd(this,cu,"f")[this.size-1].priority>=t.priority){bd(this,cu,"f").push(r);return}let n=rP(bd(this,cu,"f"),r,(i,s)=>s.priority-i.priority);bd(this,cu,"f").splice(n,0,r)}dequeue(){return bd(this,cu,"f").shift()?.run}filter(e){return bd(this,cu,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return bd(this,cu,"f").length}};cu=new WeakMap;var rr=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},_e=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},jn,Yg,Qg,uf,cb,Xg,ib,ea,jg,xo,ob,Ro,Zg,cf,k1,N1,_d,sb,Cre,Pre,Ore,Dre,kre,Nre,ab,nP,iP,ub,lb=()=>{},yCe=new hi,oP=class extends Error{},O1=class extends Lre.default{constructor(e){var t,r,n,i;if(super(),jn.add(this),Yg.set(this,void 0),Qg.set(this,void 0),uf.set(this,0),cb.set(this,void 0),Xg.set(this,void 0),ib.set(this,0),ea.set(this,void 0),jg.set(this,void 0),xo.set(this,void 0),ob.set(this,void 0),Ro.set(this,0),Zg.set(this,void 0),cf.set(this,void 0),k1.set(this,lb),N1.set(this,lb),_d.set(this,void 0),sb.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Wg,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);rr(this,Yg,e.carryoverConcurrencyCount,"f"),rr(this,Qg,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),rr(this,cb,e.intervalCap,"f"),rr(this,Xg,e.interval,"f"),rr(this,xo,new e.queueClass,"f"),rr(this,ob,e.queueClass,"f"),this.concurrency=e.concurrency,rr(this,_d,e.timeout,"f"),rr(this,sb,e.throwOnTimeout===!0,"f"),rr(this,cf,e.autoStart===!1,"f")}get concurrency(){return _e(this,Zg,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);rr(this,Zg,e,"f"),_e(this,jn,"m",ub).call(this)}async add(e,t={}){return new Promise((r,n)=>{let i=async()=>{var s,a,o;rr(this,Ro,(a=_e(this,Ro,"f"),a++,a),"f"),rr(this,uf,(o=_e(this,uf,"f"),o++,o),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){n(new oP("The task was aborted."));return}let l=await(_e(this,_d,"f")===void 0&&t.timeout===void 0?e({signal:t.signal}):nn(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?_e(this,_d,"f"):t.timeout,()=>{(t.throwOnTimeout===void 0?_e(this,sb,"f"):t.throwOnTimeout)&&n(yCe)}));r(l),this.emit("completed",l)}catch(l){n(l),this.emit("error",l)}_e(this,jn,"m",Ore).call(this)};_e(this,xo,"f").enqueue(i,t),_e(this,jn,"m",ab).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return _e(this,cf,"f")?(rr(this,cf,!1,"f"),_e(this,jn,"m",ub).call(this),this):this}pause(){rr(this,cf,!0,"f")}clear(){rr(this,xo,new(_e(this,ob,"f")),"f")}async onEmpty(){if(_e(this,xo,"f").size!==0)return new Promise(e=>{let t=_e(this,k1,"f");rr(this,k1,()=>{t(),e()},"f")})}async onSizeLessThan(e){if(!(_e(this,xo,"f").size<e))return new Promise(t=>{let r=()=>{_e(this,xo,"f").size<e&&(this.removeListener("next",r),t())};this.on("next",r)})}async onIdle(){if(!(_e(this,Ro,"f")===0&&_e(this,xo,"f").size===0))return new Promise(e=>{let t=_e(this,N1,"f");rr(this,N1,()=>{t(),e()},"f")})}get size(){return _e(this,xo,"f").size}sizeBy(e){return _e(this,xo,"f").filter(e).length}get pending(){return _e(this,Ro,"f")}get isPaused(){return _e(this,cf,"f")}get timeout(){return _e(this,_d,"f")}set timeout(e){rr(this,_d,e,"f")}};Yg=new WeakMap,Qg=new WeakMap,uf=new WeakMap,cb=new WeakMap,Xg=new WeakMap,ib=new WeakMap,ea=new WeakMap,jg=new WeakMap,xo=new WeakMap,ob=new WeakMap,Ro=new WeakMap,Zg=new WeakMap,cf=new WeakMap,k1=new WeakMap,N1=new WeakMap,_d=new WeakMap,sb=new WeakMap,jn=new WeakSet,Cre=function(){return _e(this,Qg,"f")||_e(this,uf,"f")<_e(this,cb,"f")},Pre=function(){return _e(this,Ro,"f")<_e(this,Zg,"f")},Ore=function(){var e;rr(this,Ro,(e=_e(this,Ro,"f"),e--,e),"f"),_e(this,jn,"m",ab).call(this),this.emit("next")},Dre=function(){_e(this,k1,"f").call(this),rr(this,k1,lb,"f"),_e(this,Ro,"f")===0&&(_e(this,N1,"f").call(this),rr(this,N1,lb,"f"),this.emit("idle"))},kre=function(){_e(this,jn,"m",iP).call(this),_e(this,jn,"m",nP).call(this),rr(this,jg,void 0,"f")},Nre=function(){let e=Date.now();if(_e(this,ea,"f")===void 0){let t=_e(this,ib,"f")-e;if(t<0)rr(this,uf,_e(this,Yg,"f")?_e(this,Ro,"f"):0,"f");else return _e(this,jg,"f")===void 0&&rr(this,jg,setTimeout(()=>{_e(this,jn,"m",kre).call(this)},t),"f"),!0}return!1},ab=function(){if(_e(this,xo,"f").size===0)return _e(this,ea,"f")&&clearInterval(_e(this,ea,"f")),rr(this,ea,void 0,"f"),_e(this,jn,"m",Dre).call(this),!1;if(!_e(this,cf,"f")){let e=!_e(this,jn,"m",Nre).call(this);if(_e(this,jn,"a",Cre)&&_e(this,jn,"a",Pre)){let t=_e(this,xo,"f").dequeue();return t?(this.emit("active"),t(),e&&_e(this,jn,"m",nP).call(this),!0):!1}}return!1},nP=function(){_e(this,Qg,"f")||_e(this,ea,"f")!==void 0||(rr(this,ea,setInterval(()=>{_e(this,jn,"m",iP).call(this)},_e(this,Xg,"f")),"f"),rr(this,ib,Date.now()+_e(this,Xg,"f"),"f"))},iP=function(){_e(this,uf,"f")===0&&_e(this,Ro,"f")===0&&_e(this,ea,"f")&&(clearInterval(_e(this,ea,"f")),rr(this,ea,void 0,"f")),rr(this,uf,_e(this,Yg,"f")?_e(this,Ro,"f"):0,"f"),_e(this,jn,"m",ub).call(this)},ub=function(){for(;_e(this,jn,"m",ab).call(this););};var Bre=w(K(),1),Jg=w(Vi(),1),ec=C("libp2p:delegated-content-routing"),fb=3e4,gCe=4,wCe=2,hb=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new O1({concurrency:gCe}),this.httpQueueRefs=new O1({concurrency:wCe});let{protocol:t,host:r,port:n}=e.getEndpointConfig();ec(`enabled DelegatedContentRouting via ${t}://${r}:${n}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async*findProviders(e,t={}){ec("findProviders starts: %c",e),t.timeout=t.timeout??fb,t.signal=(0,Jg.default)([this.abortController.signal].concat(t.signal!=null?[t.signal]:[]));let r=Ar(),n=Ar();this.httpQueue.add(async()=>(r.resolve(),await n.promise));try{await r.promise;for await(let i of this.client.dht.findProvs(e,t))i.name==="PROVIDER"&&(yield*i.providers.map(s=>({id:s.id,protocols:[],multiaddrs:s.multiaddrs.map(a=>new j(a.toString()))})))}catch(i){throw ec.error("findProviders errored:",i),i}finally{n.resolve(),ec("findProviders finished: %c",e)}}async provide(e,t={}){ec("provide starts: %c",e),t.timeout=t.timeout??fb,t.signal=(0,Jg.default)([this.abortController.signal].concat(t.signal!=null?[t.signal]:[])),await this.httpQueueRefs.add(async()=>{await this.client.block.stat(e,t),await(0,sP.default)(this.client.dht.provide(e,t))}),ec("provide finished: %c",e)}async put(e,t,r={}){ec("put value start: %b",e),r.timeout=r.timeout??fb,r.signal=(0,Jg.default)([this.abortController.signal].concat(r.signal!=null?[r.signal]:[])),await this.httpQueue.add(async()=>{await(0,sP.default)(this.client.dht.put(e,t,r))}),ec("put value finished: %b",e)}async get(e,t={}){return ec("get value start: %b",e),t.timeout=t.timeout??fb,t.signal=(0,Jg.default)([this.abortController.signal].concat(t.signal!=null?[t.signal]:[])),await this.httpQueue.add(async()=>{for await(let r of this.client.dht.get(e,t))if(r.name==="VALUE")return ec("get value finished: %b",e),r.value;throw(0,Bre.default)(new Error("Not found"),"ERR_NOT_FOUND")})}};c(),c();var ECe=e=>Promise.reject(new Error(`No base found for "${e}"`)),L1=class{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||ECe;for(let t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];let t=await this._loadBase(e);return this._basesByName[t.name]==null&&this._basesByPrefix[t.prefix]==null&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}};c();var bCe=e=>Promise.reject(new Error(`No codec found for "${e}"`)),B1=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||bCe;for(let t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let t=typeof e=="string"?this._codecsByName:this._codecsByCode;if(t[e])return t[e];let r=await this._loadCodec(e);return t[e]==null&&this.addCodec(r),r}listCodecs(){return Object.values(this._codecsByName)}};c();var _Ce=e=>Promise.reject(new Error(`No hasher found for "${e}"`)),M1=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||_Ce;for(let t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let t=typeof e=="string"?this._hashersByName:this._hashersByCode;if(t[e])return t[e];let r=await this._loadHasher(e);return t[e]==null&&this.addHasher(r),r}listHashers(){return Object.values(this._hashersByName)}},ePe=w(Z9(),1);va(),o2(),c(),c(),te(),c(),c();var tc=w($7(),1),vd=w(Vp(),1);c();function aP(e){try{e=L0(new j(e))}catch{}return e=e.toString(),e}c();var Mre=()=>{},Ure=C("ipfs-http-client:lib:error-handler"),vCe=Ze.bind({ignoreUndefined:!0}),SCe=tc.isBrowser||tc.isWebWorker?location.protocol:"http",xCe=tc.isBrowser||tc.isWebWorker?location.hostname:"localhost",RCe=tc.isBrowser||tc.isWebWorker?location.port:"5001",ACe=(e={})=>{let t,r={},n;if(typeof e=="string"||j.isMultiaddr(e))t=new URL(aP(e));else if(e instanceof URL)t=e;else if(typeof e.url=="string"||j.isMultiaddr(e.url))t=new URL(aP(e.url)),r=e;else if(e.url instanceof URL)t=e.url,r=e;else{r=e||{};let i=(r.protocol||SCe).replace(":",""),s=(r.host||xCe).split(":")[0],a=r.port||RCe;t=new URL(`${i}://${s}:${a}`)}if(r.apiPath?t.pathname=r.apiPath:(t.pathname==="/"||t.pathname===void 0)&&(t.pathname="api/v0"),tc.isNode){let i=Mre(t);n=r.agent||new i({keepAlive:!0,maxSockets:6})}return{...r,host:t.host,protocol:t.protocol.replace(":",""),port:Number(t.port),apiPath:t.pathname,url:t,agent:n}},TCe=async e=>{let t;try{if((e.headers.get("Content-Type")||"").startsWith("application/json")){let n=await e.json();Ure(n),t=n.Message||n.message}else t=await e.text()}catch(n){Ure("Failed to parse error response",n),t=n.message}let r=new vd.default.HTTPError(e);throw t&&(t.includes("deadline has elapsed")&&(r=new vd.default.TimeoutError),t&&t.includes("context deadline exceeded")&&(r=new vd.default.TimeoutError)),t&&t.includes("request timed out")&&(r=new vd.default.TimeoutError),t&&(r.message=t),r},ICe=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,Fre=e=>e.replace(ICe,function(t){return"-"+t.toLowerCase()}),CCe=e=>typeof e=="string"?ju(e):e,lf=class extends vd.default{constructor(e={}){let t=ACe(e);super({timeout:CCe(t.timeout||0)||void 0,headers:t.headers,base:`${t.url}`,handleError:TCe,transformSearchParams:n=>{let i=new URLSearchParams;for(let[s,a]of n)a!=="undefined"&&a!=="null"&&s!=="signal"&&i.append(Fre(s),a),s==="timeout"&&!isNaN(a)&&i.append(Fre(s),a);return i},agent:t.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;let r=this.fetch;this.fetch=(n,i={})=>(typeof n=="string"&&!n.startsWith("/")&&(n=`${t.url}/${n}`),r.call(this,n,vCe(i,{method:"POST"})))}},tpt=vd.default.HTTPError,P=e=>t=>e(new lf(t),t);c(),c();function db(e){if(e!=null)return typeof e=="string"?e:e.toString(8).padStart(4,"0")}c();var Kre=w(K(),1);function pb(e){if(e==null)return;let t;if(e.secs!=null&&(t={secs:e.secs,nsecs:e.nsecs}),e.Seconds!=null&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){let r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:(r-n*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(t!=null&&t.nsecs!=null&&(t.nsecs<0||t.nsecs>999999999))throw(0,Kre.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}function k({arg:e,searchParams:t,hashAlg:r,mtime:n,mode:i,...s}={}){t&&(s={...s,...t}),r&&(s.hash=r),n!=null&&(n=pb(n),s.mtime=n.secs,s.mtimeNsecs=n.nsecs),i!=null&&(s.mode=db(i)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),e==null?e=[]:Array.isArray(e)||(e=[e]);let a=new URLSearchParams(s);return e.forEach(o=>a.append("arg",o)),a}var Vre=P(e=>{async function t(r={}){return((await(await e.post("bitswap/wantlist",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).Keys||[]).map(n=>I.parse(n["/"]))}return t});c(),te();var qre=P(e=>{async function t(r,n={}){return((await(await e.post("bitswap/wantlist",{signal:n.signal,searchParams:k({...n,peer:r.toString()}),headers:n.headers})).json()).Keys||[]).map(i=>I.parse(i["/"]))}return t});c(),te();var mb=P(e=>{async function t(r={}){let n=await e.post("bitswap/stat",{searchParams:k(r),signal:r.signal,headers:r.headers});return PCe(await n.json())}return t});function PCe(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map(t=>I.parse(t["/"])),peers:(e.Peers||[]).map(t=>ue(t)),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}c();var zre=P(e=>{async function t(r,n={}){return(await e.post("bitswap/unwant",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers})).json()}return t});function Hre(e){return{wantlist:Vre(e),wantlistForPeer:qre(e),unwant:zre(e),stat:mb(e)}}c(),c();var yb=P(e=>{async function t(r,n={}){let i=await e.post("block/get",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers});return new Uint8Array(await i.arrayBuffer())}return t});c(),te(),c(),c(),c();var Gre=w(K(),1),Wre=w(S0(),1),jre=w(v0(),1),Yre=w(Vs(),1);async function Qre(e){if(Jo(e))return new Blob([e]);if(typeof e=="string"||e instanceof String)return new Blob([e.toString()]);if(Vc(e))return e;if(qc(e)&&(e=(0,jre.default)(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let t=(0,Wre.default)(e),{value:r,done:n}=await t.peek();if(n)return $re(t);if(t.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await(0,Yre.default)(t))]);if(Jo(r)||typeof r=="string"||r instanceof String)return $re(t)}throw(0,Gre.default)(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}async function $re(e){let t=[];for await(let r of e)t.push(r);return new Blob(t)}function Xre(e){return w5(e,Qre,!0)}c();function Zre(e){if(e!=null)return typeof e=="string"?e:e.toString(8).padStart(4,"0")}async function En(e,t,r={}){let n=[],i=new FormData,s=0,a=0;for await(let{content:o,path:l,mode:u,mtime:h}of Xre(e)){let f="",y=o?"file":"dir";s>0&&(f=`-${s}`);let p=y+f,v=[];if(u!=null&&v.push(`mode=${Zre(u)}`),h!=null){let{secs:d,nsecs:g}=h;v.push(`mtime=${d}`),g!=null&&v.push(`mtime-nsecs=${g}`)}if(v.length&&(p=`${p}?${v.join("&")}`),o){i.set(p,o,l!=null?encodeURIComponent(l):void 0);let d=a+o.size;n.push({name:l,start:a,end:d}),a=d}else if(l!=null)i.set(p,new File([""],encodeURIComponent(l),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");s++}return{total:a,parts:n,headers:r,body:i}}c();var Jre=w(Vi(),1);function DCe(e){return e.filter(Boolean)}function bn(...e){return(0,Jre.anySignal)(DCe(e))}var ene=P(e=>{async function t(r,n={}){let i=new AbortController,s=bn(i.signal,n.signal),a;try{a=await(await e.post("block/put",{signal:s,searchParams:k(n),...await En([r],i,n.headers)})).json()}catch(o){if(n.format==="dag-pb")return t(r,{...n,format:"protobuf"});if(n.format==="dag-cbor")return t(r,{...n,format:"cbor"});throw o}return I.parse(a.Key)}return t});c(),te();var tne=P(e=>{async function*t(r,n={}){Array.isArray(r)||(r=[r]);let i=await e.post("block/rm",{signal:n.signal,searchParams:k({arg:r.map(s=>s.toString()),"stream-channels":!0,...n}),headers:n.headers});for await(let s of i.ndjson())yield kCe(s)}return t});function kCe(e){let t={cid:I.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}c(),te();var rne=P(e=>{async function t(r,n={}){let i=await(await e.post("block/stat",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers})).json();return{cid:I.parse(i.Key),size:i.Size}}return t});function nne(e){return{get:yb(e),put:ene(e),rm:tne(e),stat:rne(e)}}c(),c();var ine=P(e=>{async function t(r,n={}){let i=await e.post("bootstrap/add",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),{Peers:s}=await i.json();return{Peers:s.map(a=>new j(a))}}return t});c();var one=P(e=>{async function t(r={}){let n=await e.post("bootstrap/rm",{signal:r.signal,searchParams:k({...r,all:!0}),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map(s=>new j(s))}}return t});c();var sne=P(e=>{async function t(r={}){let n=await e.post("bootstrap/list",{signal:r.signal,searchParams:k(r),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map(s=>new j(s))}}return t});c();var ane=P(e=>{async function t(r={}){let n=await e.post("bootstrap/add",{signal:r.signal,searchParams:k({...r,default:!0}),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map(s=>new j(s))}}return t});c();var cne=P(e=>{async function t(r,n={}){let i=await e.post("bootstrap/rm",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),{Peers:s}=await i.json();return{Peers:s.map(a=>new j(a))}}return t});function une(e){return{add:ine(e),clear:one(e),list:sne(e),reset:ane(e),rm:cne(e)}}c(),c(),c();var lne=P(e=>{async function t(r,n={}){let i=await(await e.post("config/profile/apply",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json();return{original:i.OldCfg,updated:i.NewCfg}}return t});c(),c();function St(e){if(e==null)return e;let t=/^[A-Z]+$/,r={};return Object.keys(e).reduce((n,i)=>(t.test(i)?n[i.toLowerCase()]=e[i]:t.test(i[0])?n[i[0].toLowerCase()+i.slice(1)]=e[i]:n[i]=e[i],n),r)}var fne=P(e=>{async function t(r={}){return(await(await e.post("config/profile/list",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).map(n=>St(n))}return t});function hne(e){return{apply:lne(e),list:fne(e)}}c();var dne=P(e=>async(t,r={})=>{if(!t)throw new Error("key argument is required");return(await(await e.post("config",{signal:r.signal,searchParams:k({arg:t,...r}),headers:r.headers})).json()).Value});c();var pne=P(e=>async(t={})=>await(await e.post("config/show",{signal:t.signal,searchParams:k({...t}),headers:t.headers})).json());c(),Re();var mne=P(e=>async(t,r={})=>{let n=new AbortController,i=bn(n.signal,r.signal);await(await e.post("config/replace",{signal:i,searchParams:k(r),...await En([U(JSON.stringify(t))],n,r.headers)})).text()});c();var yne=P(e=>async(t,r,n={})=>{if(typeof t!="string")throw new Error("Invalid key type");let i={...n,...NCe(t,r)};await(await e.post("config",{signal:n.signal,searchParams:k(i),headers:n.headers})).text()}),NCe=(e,t)=>{switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function gne(e){return{getAll:pne(e),get:dne(e),set:yne(e),replace:mne(e),profiles:hne(e)}}c(),c();var wne=P(e=>{async function*t(r,n={}){yield*(await e.post("dag/export",{signal:n.signal,searchParams:k({arg:r.toString()}),headers:n.headers})).iterator()}return t});c(),c(),te();var cP=w(K(),1);async function*uP(e,t,r,n,i){let s=async u=>{let h=await r.getCodec(u.code),f=await n(u,i);return h.decode(f)},a=t.split("/").filter(Boolean),o=await s(e),l=e;for(;a.length;){let u=a.shift();if(!u)throw(0,cP.default)(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(o,u))o=o[u],yield{value:o,remainderPath:a.join("/")};else throw(0,cP.default)(new Error(`no link named "${u}" under ${l}`),"ERR_NO_LINK");let h=I.asCID(o);h&&(l=h,o=await s(o))}yield{value:o,remainderPath:""}}var Ene=w(Gc(),1),bne=w(qi(),1),_ne=w(K(),1),vne=(e,t)=>P((r,n)=>{let i=yb(n);return async(s,a={})=>{if(a.path){let u=a.localResolve?await(0,Ene.default)(uP(s,a.path,e,i,a)):await(0,bne.default)(uP(s,a.path,e,i,a));if(!u)throw(0,_ne.default)(new Error("Not found"),"ERR_NOT_FOUND");return u}let o=await e.getCodec(s.code),l=await i(s,a);return{value:o.decode(l),remainderPath:""}}})(t);c(),te();var Sne=P(e=>{async function*t(r,n={}){let i=new AbortController,s=bn(i.signal,n.signal),{headers:a,body:o}=await En(r,i,n.headers),l=await e.post("dag/import",{signal:s,headers:a,body:o,searchParams:k({"pin-roots":n.pinRoots})});for await(let{Root:u}of l.ndjson())if(u!==void 0){let{Cid:{"/":h},PinErrorMsg:f}=u;yield{root:{cid:I.parse(h),pinErrorMsg:f}}}}return t});c(),te();var gb=(e,t)=>P(r=>async(n,i={})=>{let s={storeCodec:"dag-cbor",hashAlg:"sha2-256",...i},a;if(s.inputCodec){if(!(n instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");a=n}else a=(await e.getCodec(s.storeCodec)).encode(n),s.inputCodec=s.storeCodec;let o=new AbortController,l=bn(o.signal,s.signal),u=await(await r.post("dag/put",{timeout:s.timeout,signal:l,searchParams:k(s),...await En([a],o,s.headers)})).json();return I.parse(u.Cid["/"])})(t);c(),te();var xne=P(e=>async(t,r={})=>{let n=await(await e.post("dag/resolve",{signal:r.signal,searchParams:k({arg:`${t}${r.path?`/${r.path}`.replace(/\/[/]+/g,"/"):""}`,...r}),headers:r.headers})).json();return{cid:I.parse(n.Cid["/"]),remainderPath:n.RemPath}});function Rne(e,t){return{export:wne(t),get:vne(e,t),import:Sne(t),put:gb(e,t),resolve:xne(t)}}c(),c(),c(),Re(),c();var ls=e=>{if(e.Type===0)return{name:"SENDING_QUERY",type:e.Type};if(e.Type===1)return{from:ue(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map(({ID:t,Addrs:r})=>({id:ue(t),multiaddrs:r.map(n=>new j(n)),protocols:[]})),providers:(e.Responses||[]).map(({ID:t,Addrs:r})=>({id:ue(t),multiaddrs:r.map(n=>new j(n)),protocols:[]}))};if(e.Type===2){let t={id:e.ID??ue(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(t={id:ue(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map(r=>new j(r)),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:t}}if(e.Type===3)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(e.Type===4)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map(({ID:t,Addrs:r})=>({id:ue(t),multiaddrs:r.map(n=>new j(n)),protocols:[]}))};if(e.Type===5)return{name:"VALUE",type:e.Type,value:U(e.Extra,"base64pad")};if(e.Type===6){let t=e.Responses.map(({ID:r})=>ue(r));if(!t.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:t[0]}}if(e.Type===7)return{name:"DIALING_PEER",type:e.Type,peer:ue(e.ID)};throw new Error("Unknown DHT event type")},Ane=P(e=>{async function*t(r,n={}){let i=await e.post("dht/findpeer",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers});for await(let s of i.ndjson())yield ls(s)}return t});c();var Tne=P(e=>{async function*t(r,n={}){let i=await e.post("dht/findprovs",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers});for await(let s of i.ndjson())yield ls(s)}return t});c(),me();var Ine=P(e=>{async function*t(r,n={}){let i=await e.post("dht/get",{signal:n.signal,searchParams:k({arg:r instanceof Uint8Array?M(r):r.toString(),...n}),headers:n.headers});for await(let s of i.ndjson())yield ls(s)}return t});c();var Cne=P(e=>{async function*t(r,n={recursive:!1}){let i=Array.isArray(r)?r:[r],s=await e.post("dht/provide",{signal:n.signal,searchParams:k({arg:i.map(a=>a.toString()),...n}),headers:n.headers});for await(let a of s.ndjson())yield ls(a)}return t});c(),me();var Pne=P(e=>{async function*t(r,n,i={}){let s=new AbortController,a=bn(s.signal,i.signal),o=await e.post("dht/put",{signal:a,searchParams:k({arg:r instanceof Uint8Array?M(r):r.toString(),...i}),...await En([n],s,i.headers)});for await(let l of o.ndjson())yield ls(l)}return t});c();var Dne=P(e=>{async function*t(r,n={}){let i=await e.post("dht/query",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers});for await(let s of i.ndjson())yield ls(s)}return t});function kne(e){return{findPeer:Ane(e),findProvs:Tne(e),get:Ine(e),provide:Cne(e),put:Pne(e),query:Dne(e)}}c(),c();var Nne=P(e=>{async function t(r={}){return(await e.post("diag/cmds",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()}return t});c();var One=P(e=>{async function t(r={}){return(await e.post("diag/net",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()}return t});c();var Lne=P(e=>{async function t(r={}){return(await e.post("diag/sys",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()}return t});function Bne(e){return{cmds:Nne(e),net:One(e),sys:Lne(e)}}c(),c();var Mne=P(e=>{async function t(r,n,i={}){await(await e.post("files/chmod",{signal:i.signal,searchParams:k({arg:r,mode:n,...i}),headers:i.headers})).text()}return t});c(),te();var Une=P(e=>{async function t(r,n,i={}){let s=Array.isArray(r)?r:[r];await(await e.post("files/cp",{signal:i.signal,searchParams:k({arg:s.concat(n).map(a=>I.asCID(a)?`/ipfs/${a}`:a),...i}),headers:i.headers})).text()}return t});c(),te();var Fne=P(e=>{async function t(r,n={}){if(!r||typeof r!="string")throw new Error("ipfs.files.flush requires a path");let i=await(await e.post("files/flush",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json();return I.parse(i.Cid)}return t});c(),te(),c();function e3(e){let t=St(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}var Vne=P(e=>{async function*t(r,n={}){if(!r)throw new Error("ipfs.files.ls requires a path");let i=await e.post("files/ls",{signal:n.signal,searchParams:k({arg:I.asCID(r)?`/ipfs/${r}`:r,long:!0,...n,stream:!0}),headers:n.headers});for await(let s of i.ndjson())if("Entries"in s)for(let a of s.Entries||[])yield Kne(e3(a));else yield Kne(e3(s))}return t});function Kne(e){return e.hash&&(e.cid=I.parse(e.hash)),delete e.hash,e.type=e.type===1?"directory":"file",e}c();var qne=P(e=>{async function t(r,n={}){await(await e.post("files/mkdir",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).text()}return t});c();var zne=P(e=>{async function t(r,n,i={}){Array.isArray(r)||(r=[r]),await(await e.post("files/mv",{signal:i.signal,searchParams:k({arg:r.concat(n),...i}),headers:i.headers})).text()}return t});c();var Gne=w($ne(),1),Wne=P(e=>{async function*t(r,n={}){let i=await e.post("files/read",{signal:n.signal,searchParams:k({arg:r,count:n.length,...n}),headers:n.headers});yield*(0,Gne.default)(i.body)}return t});c();var jne=w(Vp(),1),Yne=P(e=>{async function t(r,n={}){let i=await e.post("files/rm",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),s=await i.text();if(s!==""){let a=new jne.default.HTTPError(i);throw a.message=s,a}}return t});c(),te();var wb=P(e=>{async function t(r,n={}){let i=await(await e.post("files/stat",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json();return i.WithLocality=i.WithLocality||!1,qCe(e3(i))}return t});function qCe(e){return e.cid=I.parse(e.hash),delete e.hash,e}c();var Qne=P(e=>{async function t(r,n={}){await(await e.post("files/touch",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).text()}return t});c();var Xne=P(e=>{async function t(r,n,i={}){let s=new AbortController,a=bn(s.signal,i.signal);await(await e.post("files/write",{signal:a,searchParams:k({arg:r,streamChannels:!0,count:i.length,...i}),...await En([{content:n,path:"arg",mode:db(i.mode),mtime:pb(i.mtime)}],s,i.headers)})).text()}return t});function Zne(e){return{chmod:Mne(e),cp:Une(e),flush:Fne(e),ls:Vne(e),mkdir:qne(e),mv:zne(e),read:Wne(e),rm:Yne(e),stat:wb(e),touch:Qne(e),write:Xne(e)}}c(),c();var Jne=w(K(),1),eie=P(e=>async(t,r,n={})=>{throw(0,Jne.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});c();var tie=P(e=>{async function t(r,n={type:"Ed25519"}){let i=await(await e.post("key/gen",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json();return St(i)}return t});c();var rie=P(e=>{async function t(r,n,i,s={}){let a=await(await e.post("key/import",{signal:s.signal,searchParams:k({arg:r,pem:n,password:i,...s}),headers:s.headers})).json();return St(a)}return t});c();var nie=w(K(),1),iie=P(e=>async(t,r={})=>{throw(0,nie.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});c();var oie=P(e=>{async function t(r={}){return((await(await e.post("key/list",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).Keys||[]).map(n=>St(n))}return t});c();var sie=P(e=>{async function t(r,n,i={}){let s=await e.post("key/rename",{signal:i.signal,searchParams:k({arg:[r,n],...i}),headers:i.headers});return St(await s.json())}return t});c();var aie=P(e=>{async function t(r,n={}){let i=await(await e.post("key/rm",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json();return St(i.Keys[0])}return t});function cie(e){return{export:eie(e),gen:tie(e),import:rie(e),info:iie(e),list:oie(e),rename:sie(e),rm:aie(e)}}c(),c();var uie=P(e=>{async function t(r,n,i={}){let s=await e.post("log/level",{signal:i.signal,searchParams:k({arg:[r,n],...i}),headers:i.headers});return St(await s.json())}return t});c();var lie=P(e=>{async function t(r={}){return(await(await e.post("log/ls",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).Strings}return t});c();var fie=P(e=>{async function*t(r={}){yield*(await e.post("log/tail",{signal:r.signal,searchParams:k(r),headers:r.headers})).ndjson()}return t});function hie(e){return{level:uie(e),ls:lie(e),tail:fie(e)}}c(),c();var die=P(e=>{async function t(r,n={}){let i=await e.post("name/publish",{signal:n.signal,searchParams:k({arg:`${r}`,...n}),headers:n.headers});return St(await i.json())}return t});c();var pie=P(e=>{async function*t(r,n={}){let i=await e.post("name/resolve",{signal:n.signal,searchParams:k({arg:r,stream:!0,...n}),headers:n.headers});for await(let s of i.ndjson())yield s.Path}return t});c(),c();var mie=P(e=>{async function t(r,n={}){let i=await e.post("name/pubsub/cancel",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers});return St(await i.json())}return t});c();var yie=P(e=>{async function t(r={}){let n=await e.post("name/pubsub/state",{signal:r.signal,searchParams:k(r),headers:r.headers});return St(await n.json())}return t});c();var gie=P(e=>{async function t(r={}){return(await(await e.post("name/pubsub/subs",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).Strings||[]}return t});function wie(e){return{cancel:mie(e),state:yie(e),subs:gie(e)}}function Eie(e){return{publish:die(e),resolve:pie(e),pubsub:wie(e)}}c(),c(),te();var bie=P(e=>{async function t(r,n={}){let i=await(await e.post("object/data",{signal:n.signal,searchParams:k({arg:`${r instanceof Uint8Array?I.decode(r):r}`,...n}),headers:n.headers})).arrayBuffer();return new Uint8Array(i,0,i.byteLength)}return t});c(),te(),Re();var _ie=P(e=>{async function t(r,n={}){let i=await(await e.post("object/get",{signal:n.signal,searchParams:k({arg:`${r instanceof Uint8Array?I.decode(r):r}`,dataEncoding:"base64",...n}),headers:n.headers})).json();return{Data:U(i.Data,"base64pad"),Links:(i.Links||[]).map(s=>({Name:s.Name,Hash:I.parse(s.Hash),Tsize:s.Size}))}}return t});c(),te();var vie=P(e=>{async function t(r,n={}){return((await(await e.post("object/links",{signal:n.signal,searchParams:k({arg:`${r instanceof Uint8Array?I.decode(r):r}`,...n}),headers:n.headers})).json()).Links||[]).map(i=>({Name:i.Name,Tsize:i.Size,Hash:I.parse(i.Hash)}))}return t});c(),te();var Sie=P(e=>{async function t(r={}){let n=await e.post("object/new",{signal:r.signal,searchParams:k({arg:r.template,...r}),headers:r.headers}),{Hash:i}=await n.json();return I.parse(i)}return t});c();var xie=(e,t)=>P(r=>{let n=gb(e,t);async function i(s,a={}){return n(s,{...a,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return i})(t);c(),te();var Rie=P(e=>{async function t(r,n={}){let i=await(await e.post("object/stat",{signal:n.signal,searchParams:k({arg:`${r}`,...n}),headers:n.headers})).json();return{...i,Hash:I.parse(i.Hash)}}return t});c(),c(),te();var Aie=P(e=>{async function t(r,n,i={}){let s=await e.post("object/patch/add-link",{signal:i.signal,searchParams:k({arg:[`${r}`,n.Name||n.name||"",(n.Hash||n.cid||"").toString()||null],...i}),headers:i.headers}),{Hash:a}=await s.json();return I.parse(a)}return t});c(),te();var Tie=P(e=>{async function t(r,n,i={}){let s=new AbortController,a=bn(s.signal,i.signal),o=await e.post("object/patch/append-data",{signal:a,searchParams:k({arg:`${r}`,...i}),...await En([n],s,i.headers)}),{Hash:l}=await o.json();return I.parse(l)}return t});c(),te();var Iie=P(e=>{async function t(r,n,i={}){let s=await e.post("object/patch/rm-link",{signal:i.signal,searchParams:k({arg:[`${r}`,n.Name||n.name||null],...i}),headers:i.headers}),{Hash:a}=await s.json();return I.parse(a)}return t});c(),te();var Cie=P(e=>{async function t(r,n,i={}){let s=new AbortController,a=bn(s.signal,i.signal),o=await e.post("object/patch/set-data",{signal:a,searchParams:k({arg:[`${r}`],...i}),...await En([n],s,i.headers)}),{Hash:l}=await o.json();return I.parse(l)}return t});function Pie(e){return{addLink:Aie(e),appendData:Tie(e),rmLink:Iie(e),setData:Cie(e)}}function Die(e,t){return{data:bie(t),get:_ie(t),links:vie(t),new:Sie(t),put:xie(e,t),stat:Rie(t),patch:Pie(t)}}c(),c(),te();var Eb=P(e=>{async function*t(r,n={}){for await(let{path:i,recursive:s,metadata:a}of xa(r)){let o=await e.post("pin/add",{signal:n.signal,searchParams:k({...n,arg:i,recursive:s,metadata:a?JSON.stringify(a):void 0,stream:!0}),headers:n.headers});for await(let l of o.ndjson()){if(l.Pins){for(let u of l.Pins)yield I.parse(u);continue}yield I.parse(l)}}}return t});c();var kie=w(qi(),1);function Nie(e){let t=Eb(e);return P(()=>{async function r(n,i={}){return(0,kie.default)(t([{path:n,...i}],i))}return r})(e)}c(),te();function Oie(e,t,r){let n={type:e,cid:I.parse(t)};return r&&(n.metadata=r),n}var Lie=P(e=>{async function*t(r={}){let n=[];r.paths&&(n=Array.isArray(r.paths)?r.paths:[r.paths]);let i=await e.post("pin/ls",{signal:r.signal,searchParams:k({...r,arg:n.map(s=>`${s}`),stream:!0}),headers:r.headers});for await(let s of i.ndjson()){if(s.Keys){for(let a of Object.keys(s.Keys))yield Oie(s.Keys[a].Type,a,s.Keys[a].Metadata);return}yield Oie(s.Type,s.Cid,s.Metadata)}}return t});c(),te();var bb=P(e=>{async function*t(r,n={}){for await(let{path:i,recursive:s}of xa(r)){let a=new URLSearchParams(n.searchParams);a.append("arg",`${i}`),s!=null&&a.set("recursive",String(s));let o=await e.post("pin/rm",{signal:n.signal,headers:n.headers,searchParams:k({...n,arg:`${i}`,recursive:s})});for await(let l of o.ndjson()){if(l.Pins){yield*l.Pins.map(u=>I.parse(u));continue}yield I.parse(l)}}}return t});c();var Bie=w(qi(),1),Mie=e=>{let t=bb(e);return P(()=>{async function r(n,i={}){return(0,Bie.default)(t([{path:n,...i}],i))}return r})(e)};c(),c(),c(),te();var _b=({Name:e,Status:t,Cid:r})=>({cid:I.parse(r),name:e,status:t}),Uie=e=>{if(typeof e=="string"&&e!=="")return e;throw new TypeError("service name must be passed")},Fie=e=>{if(I.asCID(e))return e.toString();throw new TypeError(`CID instance expected instead of ${typeof e}`)},U1=({service:e,cid:t,name:r,status:n,all:i})=>{let s=k({service:Uie(e),name:r,force:i?!0:void 0});if(t)for(let a of t)s.append("cid",Fie(a));if(n)for(let a of n)s.append("status",a);return s},Kie=({cid:e,service:t,background:r,name:n,origins:i})=>{let s=k({arg:Fie(e),service:Uie(t),name:n,background:r?!0:void 0});if(i)for(let a of i)s.append("origin",a.toString());return s};function Vie(e){async function t(r,{timeout:n,signal:i,headers:s,...a}){let o=await e.post("pin/remote/add",{timeout:n,signal:i,headers:s,searchParams:Kie({cid:r,...a})});return _b(await o.json())}return t}c();function qie(e){async function*t({timeout:r,signal:n,headers:i,...s}){let a=await e.post("pin/remote/ls",{timeout:r,signal:n,headers:i,searchParams:U1(s)});for await(let o of a.ndjson())yield _b(o)}return t}c();function zie(e){async function t({timeout:r,signal:n,headers:i,...s}){await e.post("pin/remote/rm",{timeout:r,signal:n,headers:i,searchParams:U1({...s,all:!1})})}return t}c();function Hie(e){async function t({timeout:r,signal:n,headers:i,...s}){await e.post("pin/remote/rm",{timeout:r,signal:n,headers:i,searchParams:U1({...s,all:!0})})}return t}c(),c(),c();function $ie(e){let t=String(e);if(t==="undefined")throw Error("endpoint is required");return t[t.length-1]==="/"?t.slice(0,-1):t}function Gie(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:zCe(e.Stat)}}}function zCe(e){switch(e.Status){case"valid":{let{Pinning:t,Pinned:r,Queued:n,Failed:i}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:t,pinned:r,failed:i}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function Wie(e){async function t(r,n){let{endpoint:i,key:s,headers:a,timeout:o,signal:l}=n;await e.post("pin/remote/service/add",{timeout:o,signal:l,searchParams:k({arg:[r,$ie(i),s]}),headers:a})}return t}c();function jie(e){async function t(r={}){let{stat:n,headers:i,timeout:s,signal:a}=r,o=await e.post("pin/remote/service/ls",{timeout:s,signal:a,headers:i,searchParams:n===!0?k({stat:n}):void 0}),{RemoteServices:l}=await o.json();return l.map(Gie)}return t}c();function Yie(e){async function t(r,n={}){await e.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:k({arg:r})})}return t}function Qie(e){let t=new lf(e);return{add:Wie(t),ls:jie(t),rm:Yie(t)}}function Xie(e){let t=new lf(e);return{add:Vie(t),ls:qie(t),rm:zie(t),rmAll:Hie(t),service:Qie(e)}}function Zie(e){return{addAll:Eb(e),add:Nie(e),ls:Lie(e),rmAll:bb(e),rm:Mie(e),remote:Xie(e)}}c(),c(),c(),Re(),me(),ma();var Jie=e=>Array.isArray(e)?e.map(lP):e,lP=e=>M(fP(e)),fP=e=>qm.decode(e),eoe=e=>BigInt(`0x${M(qm.decode(e),"base16")}`),F1=e=>qm.encode(U(e)),toe=P(e=>{async function t(r={}){let{Strings:n}=await(await e.post("pubsub/ls",{signal:r.signal,searchParams:k(r),headers:r.headers})).json();return Jie(n)||[]}return t});c();var roe=P(e=>{async function t(r,n={}){let i=await e.post("pubsub/peers",{signal:n.signal,searchParams:k({arg:F1(r),...n}),headers:n.headers}),{Strings:s}=await i.json();return s||[]}return t});c();var noe=P(e=>{async function t(r,n,i={}){let s=k({arg:F1(r),...i}),a=new AbortController,o=bn(a.signal,i.signal);await(await e.post("pubsub/pub",{signal:o,searchParams:s,...await En([n],a,i.headers)})).text()}return t});c();var HCe=C("ipfs-http-client:pubsub:subscribe"),ioe=(e,t)=>P(r=>{async function n(i,s,a={}){a.signal=t.subscribe(i,s,a.signal);let o,l,u=new Promise((f,y)=>{o=f,l=y}),h=setTimeout(()=>o(),1e3);return r.post("pubsub/sub",{signal:a.signal,searchParams:k({arg:F1(i),...a}),headers:a.headers}).catch(f=>{t.unsubscribe(i,s),l(f)}).then(f=>{clearTimeout(h),f&&($Ce(f,{onMessage:y=>{if(s){if(typeof s=="function"){s(y);return}typeof s.handleEvent=="function"&&s.handleEvent(y)}},onEnd:()=>t.unsubscribe(i,s),onError:a.onError}),o())}),u}return n})(e);async function $Ce(e,{onMessage:t,onEnd:r,onError:n}){n=n||HCe;try{for await(let i of e.ndjson())try{if(!i.from)continue;t({from:ue(i.from),data:fP(i.data),sequenceNumber:eoe(i.seqno),topic:lP(i.topicIDs[0])})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,n(s,!1,i)}}catch(i){GCe(i)||n(i,!0)}finally{r()}}var GCe=e=>{switch(e.type){case"aborted":return!0;case"abort":return!0;default:return e.name==="AbortError"}};c();var ooe=(e,t)=>{async function r(n,i){t.unsubscribe(n,i)}return r};c();var vb=class{constructor(){this._subs=new Map}subscribe(e,t,r){let n=this._subs.get(e)||[];if(n.find(s=>s.handler===t))throw new Error(`Already subscribed to ${e} with this handler`);let i=new AbortController;return this._subs.set(e,[{handler:t,controller:i}].concat(n)),r&&r.addEventListener("abort",()=>this.unsubscribe(e,t)),i.signal}unsubscribe(e,t){let r=this._subs.get(e)||[],n;t?(this._subs.set(e,r.filter(i=>i.handler!==t)),n=r.filter(i=>i.handler===t)):(this._subs.set(e,[]),n=r),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach(i=>i.controller.abort())}};function soe(e){let t=new vb;return{ls:toe(e),peers:roe(e),publish:noe(e),subscribe:ioe(e,t),unsubscribe:ooe(e,t)}}c(),te(),c();var aoe=P(e=>{async function*t(r={}){yield*(await e.post("refs/local",{signal:r.signal,transform:St,searchParams:k(r),headers:r.headers})).ndjson()}return t}),coe=P((e,t)=>Object.assign(async function*(r,n={}){let i=Array.isArray(r)?r:[r];yield*(await e.post("refs",{signal:n.signal,searchParams:k({arg:i.map(s=>`${s instanceof Uint8Array?I.decode(s):s}`),...n}),headers:n.headers,transform:St})).ndjson()},{local:aoe(t)}));c(),c(),te();var uoe=P(e=>{async function*t(r={}){yield*(await e.post("repo/gc",{signal:r.signal,searchParams:k(r),headers:r.headers,transform:n=>({err:n.Error?new Error(n.Error):null,cid:(n.Key||{})["/"]?I.parse(n.Key["/"]):null})})).ndjson()}return t});c();var Sb=P(e=>{async function t(r={}){let n=await(await e.post("repo/stat",{signal:r.signal,searchParams:k(r),headers:r.headers})).json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return t});c();var loe=P(e=>{async function t(r={}){return(await(await e.post("repo/version",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).Version}return t});function foe(e){return{gc:uoe(e),stat:Sb(e),version:loe(e)}}c(),c();var hoe=P(e=>{async function*t(r={}){yield*(await e.post("stats/bw",{signal:r.signal,searchParams:k(r),headers:r.headers,transform:n=>({totalIn:BigInt(n.TotalIn),totalOut:BigInt(n.TotalOut),rateIn:parseFloat(n.RateIn),rateOut:parseFloat(n.RateOut)})})).ndjson()}return t});function doe(e){return{bitswap:mb(e),repo:Sb(e),bw:hoe(e)}}c(),c();var poe=P(e=>{async function t(r={}){let n=await e.post("swarm/addrs",{signal:r.signal,searchParams:k(r),headers:r.headers}),{Addrs:i}=await n.json();return Object.keys(i).map(s=>({id:ue(s),addrs:(i[s]||[]).map(a=>new j(a))}))}return t});c();var moe=P(e=>{async function t(r,n={}){let i=await e.post("swarm/connect",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),{Strings:s}=await i.json();return s||[]}return t});c();var yoe=P(e=>{async function t(r,n={}){let i=await e.post("swarm/disconnect",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),{Strings:s}=await i.json();return s||[]}return t});c();var goe=P(e=>{async function t(r={}){let n=await e.post("swarm/addrs/local",{signal:r.signal,searchParams:k(r),headers:r.headers}),{Strings:i}=await n.json();return(i||[]).map(s=>new j(s))}return t});c();var woe=P(e=>{async function t(r={}){let n=await e.post("swarm/peers",{signal:r.signal,searchParams:k(r),headers:r.headers}),{Peers:i}=await n.json();return(i||[]).map(s=>({addr:new j(s.Addr),peer:ue(s.Peer),muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}return t});function Eoe(e){return{addrs:poe(e),connect:moe(e),disconnect:yoe(e),localAddrs:goe(e),peers:woe(e)}}c(),c(),te();var xb=P(e=>{async function*t(r,n={}){let i=new AbortController,s=bn(i.signal,n.signal),{headers:a,body:o,total:l,parts:u}=await En(r,i,n.headers),[h,f]=typeof n.progress=="function"?WCe(l,u,n.progress):[void 0,void 0],y=await e.post("add",{searchParams:k({"stream-channels":!0,...n,progress:Boolean(h)}),onUploadProgress:f,signal:s,headers:a,body:o});for await(let p of y.ndjson())p=St(p),p.hash!==void 0?yield YCe(p):h&&h(p.bytes||0,p.name)}return t}),WCe=(e,t,r)=>t?[void 0,jCe(e,t,r)]:[r,void 0],jCe=(e,t,r)=>{let n=0,i=t.length;return({loaded:s,total:a})=>{let o=Math.floor(s/a*e);for(;n<i;){let{start:l,end:u,name:h}=t[n];if(o<u){r(o-l,h);break}else r(u-l,h),n+=1}}};function YCe({name:e,hash:t,size:r,mode:n,mtime:i,mtimeNsecs:s}){let a={path:e,cid:I.parse(t),size:parseInt(r)};return n!=null&&(a.mode=parseInt(n,8)),i!=null&&(a.mtime={secs:i,nsecs:s||0}),a}var boe=w(qi(),1);function _oe(e){let t=xb(e);return P(()=>{async function r(n,i={}){return await(0,boe.default)(t(f5(n),i))}return r})(e)}c();var voe=P(e=>{async function*t(r,n={}){yield*(await e.post("cat",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers})).iterator()}return t});c();var Soe=P(e=>async(t={})=>(await e.post("commands",{signal:t.signal,searchParams:k(t),headers:t.headers})).json());c();var xoe=P(e=>async(t,r={})=>(await(await e.post("dns",{signal:r.signal,searchParams:k({arg:t,...r}),headers:r.headers})).json()).Path);c();var Roe=P(e=>()=>{let t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}});c(),te();var Aoe=P(e=>{async function*t(r,n={}){let i={arg:`${r instanceof Uint8Array?I.decode(r):r}`,...n};i.compressionLevel&&(i["compression-level"]=i.compressionLevel,delete i.compressionLevel),yield*(await e.post("get",{signal:n.signal,searchParams:k(i),headers:n.headers})).iterator()}return t});c();var Rb=P(e=>{async function t(r={}){let n=await(await e.post("id",{signal:r.signal,searchParams:k({arg:r.peerId?r.peerId.toString():void 0,...r}),headers:r.headers})).json(),i={...St(n)};return i.id=ue(i.id),i.addresses&&(i.addresses=i.addresses.map(s=>new j(s))),i}return t});c();var Toe=e=>{let t=Rb(e);async function r(n={}){let i=await t(n);return Boolean(i&&i.addresses&&i.addresses.length)}return r};c(),te();var Ioe=P((e,t)=>{async function*r(n,i={}){let s=`${n instanceof Uint8Array?I.decode(n):n}`;async function a(l){let u=l.Hash;if(u.includes("/")){let f=u.startsWith("/ipfs/")?u:`/ipfs/${u}`;u=(await wb(t)(f)).cid}else u=I.parse(u);let h={name:l.Name,path:s+(l.Name?`/${l.Name}`:""),size:l.Size,cid:u,type:QCe(l)};return l.Mode&&(h.mode=parseInt(l.Mode,8)),l.Mtime!==void 0&&l.Mtime!==null&&(h.mtime={secs:l.Mtime},l.MtimeNsecs!==void 0&&l.MtimeNsecs!==null&&(h.mtime.nsecs=l.MtimeNsecs)),h}let o=await e.post("ls",{signal:i.signal,searchParams:k({arg:s,...i}),headers:i.headers});for await(let l of o.ndjson()){if(l=l.Objects,!l)throw new Error("expected .Objects in results");if(l=l[0],!l)throw new Error("expected one array in results.Objects");let u=l.Links;if(!Array.isArray(u))throw new Error("expected one array in results.Objects[0].Links");if(!u.length){yield a(l);return}yield*u.map(a)}}return r});function QCe(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}c();var Coe=P(e=>{async function t(r={}){let n=await e.post("dns",{signal:r.signal,searchParams:k(r),headers:r.headers});return St(await n.json())}return t});c();var Poe=P(e=>{async function*t(r,n={}){yield*(await e.post("ping",{signal:n.signal,searchParams:k({arg:`${r}`,...n}),headers:n.headers,transform:St})).ndjson()}return t});c();var Doe=P(e=>{async function t(r,n={}){let i=await e.post("resolve",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),{Path:s}=await i.json();return s}return t});c();var koe=w(K(),1),Noe=P(e=>async(t={})=>{throw(0,koe.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});c();var Ooe=P(e=>{async function t(r={}){await(await e.post("shutdown",{signal:r.signal,searchParams:k(r),headers:r.headers})).text()}return t});c();var Loe=P(e=>{async function t(r={}){let n=await e.post("version",{signal:r.signal,searchParams:k(r),headers:r.headers});return{...St(await n.json()),"ipfs-http-client":"1.0.0"}}return t}),tPe=w(hP(),1);te();var rPe=w(dP(),1);function Moe(e={}){let t={name:$r.name,code:$r.code,encode:l=>l,decode:l=>l},r=Object.values(Sa);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach(l=>r.push(l));let n=new L1({bases:r,loadBase:e.ipld&&e.ipld.loadBase}),i=Object.values(sw);[At,vc,vp,ePe,t].concat(e.ipld&&e.ipld.codecs||[]).forEach(l=>i.push(l));let s=new B1({codecs:i,loadCodec:e.ipld&&e.ipld.loadCodec}),a=Object.values(ow);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach(l=>a.push(l));let o=new M1({hashers:a,loadHasher:e.ipld&&e.ipld.loadHasher});return{add:_oe(e),addAll:xb(e),bitswap:Hre(e),block:nne(e),bootstrap:une(e),cat:voe(e),commands:Soe(e),config:gne(e),dag:Rne(s,e),dht:kne(e),diag:Bne(e),dns:xoe(e),files:Zne(e),get:Aoe(e),getEndpointConfig:Roe(e),id:Rb(e),isOnline:Toe(e),key:cie(e),log:hie(e),ls:Ioe(e),mount:Coe(e),name:Eie(e),object:Die(s,e),pin:Zie(e),ping:Poe(e),pubsub:soe(e),refs:coe(e),repo:foe(e),resolve:Doe(e),start:Noe(e),stats:doe(e),stop:Ooe(e),swarm:Eoe(e),version:Loe(e),bases:n,codecs:s,hashers:o}}c(),c();var Ub=w(K(),1);c(),c();var Sse=w(K(),1);c(),c(),c(),c(),c(),c(),c(),c(),c(),c();var ta=Object.create(null);ta.open="0",ta.close="1",ta.ping="2",ta.pong="3",ta.message="4",ta.upgrade="5",ta.noop="6";var t3=Object.create(null);Object.keys(ta).forEach(e=>{t3[ta[e]]=e});var Uoe={type:"error",data:"parser error"},nPe=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",iPe=typeof ArrayBuffer=="function",oPe=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,sPe=({type:e,data:t},r,n)=>nPe&&t instanceof Blob?r?n(t):Foe(t,n):iPe&&(t instanceof ArrayBuffer||oPe(t))?r?n(t):Foe(new Blob([t]),n):n(ta[e]+(t||"")),Foe=(e,t)=>{let r=new FileReader;return r.onload=function(){let n=r.result.split(",")[1];t("b"+n)},r.readAsDataURL(e)},Ab=sPe;c(),c();var Koe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r3=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Koe.length;e++)r3[Koe.charCodeAt(e)]=e;var Voe=e=>{let t=e.length*.75,r=e.length,n,i=0,s,a,o,l;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);let u=new ArrayBuffer(t),h=new Uint8Array(u);for(n=0;n<r;n+=4)s=r3[e.charCodeAt(n)],a=r3[e.charCodeAt(n+1)],o=r3[e.charCodeAt(n+2)],l=r3[e.charCodeAt(n+3)],h[i++]=s<<2|a>>4,h[i++]=(a&15)<<4|o>>2,h[i++]=(o&3)<<6|l&63;return u},aPe=typeof ArrayBuffer=="function",cPe=(e,t)=>{if(typeof e!="string")return{type:"message",data:qoe(e,t)};let r=e.charAt(0);return r==="b"?{type:"message",data:uPe(e.substring(1),t)}:t3[r]?e.length>1?{type:t3[r],data:e.substring(1)}:{type:t3[r]}:Uoe},uPe=(e,t)=>{if(aPe){let r=Voe(e);return qoe(r,t)}else return{base64:!0,data:e}},qoe=(e,t)=>{switch(t){case"blob":return e instanceof ArrayBuffer?new Blob([e]):e;case"arraybuffer":default:return e}},Tb=cPe,zoe=String.fromCharCode(30),Hoe=(e,t)=>{let r=e.length,n=new Array(r),i=0;e.forEach((s,a)=>{Ab(s,!1,o=>{n[a]=o,++i===r&&t(n.join(zoe))})})},$oe=(e,t)=>{let r=e.split(zoe),n=[];for(let i=0;i<r.length;i++){let s=Tb(r[i],t);if(n.push(s),s.type==="error")break}return n},pP=4;c();function Tr(e){if(e)return lPe(e)}function lPe(e){for(var t in Tr.prototype)e[t]=Tr.prototype[t];return e}Tr.prototype.on=Tr.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Tr.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},Tr.prototype.off=Tr.prototype.removeListener=Tr.prototype.removeAllListeners=Tr.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===t||n.fn===t){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+e],this},Tr.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,t)}return this},Tr.prototype.emitReserved=Tr.prototype.emit,Tr.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Tr.prototype.hasListeners=function(e){return!!this.listeners(e).length},c(),c();var fs=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function Ib(e,...t){return t.reduce((r,n)=>(e.hasOwnProperty(n)&&(r[n]=e[n]),r),{})}var fPe=setTimeout,hPe=clearTimeout;function uu(e,t){t.useNativeTimers?(e.setTimeoutFn=fPe.bind(fs),e.clearTimeoutFn=hPe.bind(fs)):(e.setTimeoutFn=setTimeout.bind(fs),e.clearTimeoutFn=clearTimeout.bind(fs))}var dPe=1.33;function Goe(e){return typeof e=="string"?pPe(e):Math.ceil((e.byteLength||e.size)*dPe)}function pPe(e){let t=0,r=0;for(let n=0,i=e.length;n<i;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}var mP=class extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}},Sd=class extends Tr{constructor(e){super(),this.writable=!1,uu(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new mP(e,t,r)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=Tb(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}};c();var Qoe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),yP=64,mPe={},Woe=0,Cb=0,joe;function Yoe(e){let t="";do t=Qoe[e%yP]+t,e=Math.floor(e/yP);while(e>0);return t}function Pb(){let e=Yoe(+new Date);return e!==joe?(Woe=0,joe=e):e+"."+Yoe(Woe++)}for(;Cb<yP;Cb++)mPe[Qoe[Cb]]=Cb;c();function Db(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function Xoe(e){let t={},r=e.split("&");for(let n=0,i=r.length;n<i;n++){let s=r[n].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}c(),c();var Zoe=!1;try{Zoe=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var Joe=Zoe;function gP(e){let t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Joe))return new XMLHttpRequest}catch{}if(!t)try{return new fs[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function yPe(){}var gPe=function(){return new gP({xdomain:!1}).responseType!=null}(),kb=class extends Sd{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){let r=location.protocol==="https:",n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==r}let t=e&&e.forceBase64;this.supportsBinary=gPe&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};$oe(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Hoe(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.query||{},t=this.opts.secure?"https":"http",r="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Pb()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(t==="https"&&Number(this.opts.port)!==443||t==="http"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port);let n=Db(e),i=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new hs(this.uri(),e)}doWrite(e,t){let r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(n,i)=>{this.onError("xhr post error",n,i)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}},hs=class extends Tr{constructor(e,t){super(),uu(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.create()}create(){let e=Ib(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let t=this.xhr=new gP(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let r in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.opts.extraHeaders[r])}}catch{}if(this.method==="POST")try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{t.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{t.readyState===4&&(t.status===200||t.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof t.status=="number"?t.status:0)},0))},t.send(this.data)}catch(r){this.setTimeoutFn(()=>{this.onError(r)},0);return}typeof document<"u"&&(this.index=hs.requestsCount++,hs.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=yPe,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete hs.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};if(hs.requestsCount=0,hs.requests={},typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",ese);else if(typeof addEventListener=="function"){let e="onpagehide"in fs?"pagehide":"unload";addEventListener(e,ese,!1)}}function ese(){for(let e in hs.requests)hs.requests.hasOwnProperty(e)&&hs.requests[e].abort()}c(),c();var tse=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0))(),n3=fs.WebSocket||fs.MozWebSocket,Nb=!0,rse="arraybuffer",nse=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",Ob=class extends Sd{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,r=nse?{}:Ib(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=Nb&&!nse?t?new n3(e,t):new n3(e):new n3(e,t,r)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType||rse,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],n=t===e.length-1;Ab(r,this.supportsBinary,i=>{let s={};Nb||(r.options&&(s.compress=r.options.compress),this.opts.perMessageDeflate&&(typeof i=="string"?Buffer.byteLength(i):i.length)<this.opts.perMessageDeflate.threshold&&(s.compress=!1));try{Nb?this.ws.send(i):this.ws.send(i,s)}catch{}n&&tse(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},t=this.opts.secure?"wss":"ws",r="";this.opts.port&&(t==="wss"&&Number(this.opts.port)!==443||t==="ws"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=Pb()),this.supportsBinary||(e.b64=1);let n=Db(e),i=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}check(){return!!n3}},wP={websocket:Ob,polling:kb};c();var wPe=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,EPe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function K1(e){let t=e,r=e.indexOf("["),n=e.indexOf("]");r!=-1&&n!=-1&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let i=wPe.exec(e||""),s={},a=14;for(;a--;)s[EPe[a]]=i[a]||"";return r!=-1&&n!=-1&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=bPe(s,s.path),s.queryKey=_Pe(s,s.query),s}function bPe(e,t){let r=/\/{2,9}/g,n=t.replace(r,"/").split("/");return(t.substr(0,1)=="/"||t.length===0)&&n.splice(0,1),t.substr(t.length-1,1)=="/"&&n.splice(n.length-1,1),n}function _Pe(e,t){let r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,s){i&&(r[i]=s)}),r}var Ao=class extends Tr{constructor(e,t={}){super(),e&&typeof e=="object"&&(t=e,e=null),e?(e=K1(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=K1(t.host).host),uu(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=Xoe(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){let t=Object.assign({},this.opts.query);t.EIO=pP,t.transport=e,this.id&&(t.sid=this.id);let r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new wP[e](r)}open(){let e;if(this.opts.rememberUpgrade&&Ao.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(e){let t=this.createTransport(e),r=!1;Ao.priorWebsocketSuccess=!1;let n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",h=>{if(!r)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Ao.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{let f=new Error("probe error");f.transport=t.name,this.emitReserved("upgradeError",f)}}))};function i(){r||(r=!0,u(),t.close(),t=null)}let s=h=>{let f=new Error("probe error: "+h);f.transport=t.name,i(),this.emitReserved("upgradeError",f)};function a(){s("transport closed")}function o(){s("socket closed")}function l(h){t&&h.name!==t.name&&i()}let u=()=>{t.removeListener("open",n),t.removeListener("error",s),t.removeListener("close",a),this.off("close",o),this.off("upgrading",l)};t.once("open",n),t.once("error",s),t.once("close",a),this.once("close",o),this.once("upgrading",l),t.open()}onOpen(){if(this.readyState="open",Ao.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let e=0,t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){let r=this.writeBuffer[t].data;if(r&&(e+=Goe(r)),t>0&&e>this.maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,n){if(typeof t=="function"&&(n=t,t=void 0),typeof r=="function"&&(n=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;let i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}onError(e){Ao.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let t=[],r=0,n=e.length;for(;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}};Ao.protocol=pP;var J8t=Ao.protocol;function ise(e,t="",r){let n=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),n=K1(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+t,n.href=n.protocol+"://"+i+(r&&r.port===n.port?"":":"+n.port),n}c(),c();var SP={};ct(SP,{Decoder:()=>s3,Encoder:()=>_P,PacketType:()=>Ct,protocol:()=>cse}),c(),c(),c();var vPe=typeof ArrayBuffer=="function",SPe=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,ose=Object.prototype.toString,xPe=typeof Blob=="function"||typeof Blob<"u"&&ose.call(Blob)==="[object BlobConstructor]",RPe=typeof File=="function"||typeof File<"u"&&ose.call(File)==="[object FileConstructor]";function o3(e){return vPe&&(e instanceof ArrayBuffer||SPe(e))||xPe&&e instanceof Blob||RPe&&e instanceof File}function i3(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,n=e.length;r<n;r++)if(i3(e[r]))return!0;return!1}if(o3(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return i3(e.toJSON(),!0);for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&i3(e[r]))return!0;return!1}function sse(e){let t=[],r=e.data,n=e;return n.data=EP(r,t),n.attachments=t.length,{packet:n,buffers:t}}function EP(e,t){if(!e)return e;if(o3(e)){let r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){let r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=EP(e[n],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){let r={};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=EP(e[n],t));return r}return e}function ase(e,t){return e.data=bP(e.data,t),e.attachments=void 0,e}function bP(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=bP(e[r],t);else if(typeof e=="object")for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=bP(e[r],t));return e}var cse=5,Ct;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Ct||(Ct={}));var _P=class{constructor(e){this.replacer=e}encode(e){return(e.type===Ct.EVENT||e.type===Ct.ACK)&&i3(e)?(e.type=e.type===Ct.EVENT?Ct.BINARY_EVENT:Ct.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Ct.BINARY_EVENT||e.type===Ct.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){let t=sse(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}},s3=class extends Tr{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string")t=this.decodeString(e),t.type===Ct.BINARY_EVENT||t.type===Ct.BINARY_ACK?(this.reconstructor=new vP(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t);else if(o3(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,r={type:Number(e.charAt(0))};if(Ct[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Ct.BINARY_EVENT||r.type===Ct.BINARY_ACK){let i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let s=e.substring(i,t);if(s!=Number(s)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(s)}if(e.charAt(t+1)==="/"){let i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(i,t)}else r.nsp="/";let n=e.charAt(t+1);if(n!==""&&Number(n)==n){let i=t+1;for(;++t;){let s=e.charAt(t);if(s==null||Number(s)!=s){--t;break}if(t===e.length)break}r.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){let i=this.tryParse(e.substr(t));if(s3.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Ct.CONNECT:return typeof t=="object";case Ct.DISCONNECT:return t===void 0;case Ct.CONNECT_ERROR:return typeof t=="string"||typeof t=="object";case Ct.EVENT:case Ct.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case Ct.ACK:case Ct.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}},vP=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=ase(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};c();function To(e,t,r){return e.on(t,r),function(){e.off(t,r)}}var APe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),V1=class extends Tr{constructor(e,t,r){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[To(e,"open",this.onopen.bind(this)),To(e,"packet",this.onpacket.bind(this)),To(e,"error",this.onerror.bind(this)),To(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(APe.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');t.unshift(e);let r={type:Ct.EVENT,data:t};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){let i=this.ids++,s=t.pop();this._registerAckCallback(i,s),r.id=i}let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){let r=this.flags.timeout;if(r===void 0){this.acks[e]=t;return}let n=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let i=0;i<this.sendBuffer.length;i++)this.sendBuffer[i].id===e&&this.sendBuffer.splice(i,1);t.call(this,new Error("operation has timed out"))},r);this.acks[e]=(...i)=>{this.io.clearTimeoutFn(n),t.apply(this,[null,...i])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this.packet({type:Ct.CONNECT,data:e})}):this.packet({type:Ct.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Ct.CONNECT:if(e.data&&e.data.sid){let r=e.data.sid;this.onconnect(r)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ct.EVENT:case Ct.BINARY_EVENT:this.onevent(e);break;case Ct.ACK:case Ct.BINARY_ACK:this.onack(e);break;case Ct.DISCONNECT:this.ondisconnect();break;case Ct.CONNECT_ERROR:this.destroy();let t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t);break}}onevent(e){let t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let r of t)r.apply(this,e)}super.emit.apply(this,e)}ack(e){let t=this,r=!1;return function(...n){r||(r=!0,t.packet({type:Ct.ACK,id:e,data:n}))}}onack(e){let t=this.acks[e.id];typeof t=="function"&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e){this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ct.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let t=this._anyOutgoingListeners.slice();for(let r of t)r.apply(this,e.data)}}};c();function xd(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}xd.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=(Math.floor(t*10)&1)==0?e-r:e+r}return Math.min(e,this.max)|0},xd.prototype.reset=function(){this.attempts=0},xd.prototype.setMin=function(e){this.ms=e},xd.prototype.setMax=function(e){this.max=e},xd.prototype.setJitter=function(e){this.jitter=e};var q1=class extends Tr{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,uu(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new xd({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let n=t.parser||SP;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Ao(this.uri,this.opts);let t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let n=To(t,"open",function(){r.onopen(),e&&e()}),i=To(t,"error",s=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",s),e?e(s):r.maybeReconnectOnOpen()});if(this._timeout!==!1){let s=this._timeout;s===0&&n();let a=this.setTimeoutFn(()=>{n(),t.close(),t.emit("error",new Error("timeout"))},s);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(n),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(To(e,"ping",this.onping.bind(this)),To(e,"data",this.ondata.bind(this)),To(e,"error",this.onerror.bind(this)),To(e,"close",this.onclose.bind(this)),To(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r||(r=new V1(this,e,t),this.nsps[e]=r),r}_destroy(e){let t=Object.keys(this.nsps);for(let r of t)if(this.nsps[r].active)return;this._close()}_packet(e){let t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();this._reconnecting=!0;let r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(function(){clearTimeout(r)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}},a3={};function c3(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};let r=ise(e,t.path||"/socket.io"),n=r.source,i=r.id,s=r.path,a=a3[i]&&s in a3[i].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||a,l;return o?l=new q1(n,t):(a3[i]||(a3[i]=new q1(n,t)),l=a3[i]),r.query&&!t.query&&(t.query=r.queryKey),l.socket(r.path,t)}Object.assign(c3,{Manager:q1,Socket:V1,io:c3,connect:c3}),c(),c(),c();var u3=w(K(),1),pse=w(uh(),1);me(),c();var lse=w(K(),1),use=64*1024,TPe=5*1e3,Lb=class{constructor(e,t){this.label=e.label,this.open=Ar(),this.channel=e,this.channel.binaryType="arraybuffer",this.log=t.log,typeof this.channel.bufferedAmountLowThreshold=="number"&&(this.channel.bufferedAmountLowThreshold=use),e.addEventListener("message",n=>{t.onMessage(n)}),e.addEventListener("bufferedamountlow",()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()}),e.addEventListener("open",()=>{this.open.resolve(),t.onOpen()}),e.addEventListener("close",()=>{t.onClose()}),e.addEventListener("error",n=>{if(n.error?.message==="Transport channel closed")return this.close();t.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',e.readyState,n.error?.message,n.error?.errorDetail);let i=n.error instanceof Error?n.error:new Error(`datachannel error: ${n.error?.message} ${n.error?.errorDetail}`);t.onError((0,lse.default)(i,"ERR_DATA_CHANNEL"))});let r=!1;this.closingInterval=setInterval(()=>{e.readyState==="closing"?(r&&t.onClose(),r=!0):r=!1},TPe)}async send(e){await this.open.promise,this.channel.send(e),this.channel.bufferedAmount>use&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=Ar())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}},mse=w(AP(),1),CPe={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};function PPe(){if(typeof globalThis>"u")throw(0,u3.default)(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");let e={RTCPeerConnection:globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection??globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription??globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate??globalThis.webkitRTCIceCandidate};if(e.RTCPeerConnection==null)throw(0,u3.default)(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return e}var Rd=class extends Ue{constructor(e){super(),this.id=e.id??M((0,pse.default)(4),"hex").slice(0,7),this.log=C(`libp2p:webrtc-peer:${e.logPrefix}:${this.id}`),this.wrtc=e.wrtc??PPe(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},CPe,e.peerConnectionConfig)),this.closed=!1,this.connected=Ar(),this.source=zs(),this.sink=async t=>{if(await this.connected.promise,this.channel==null)throw(0,u3.default)(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(let r of t)await this.channel.send(r);await this.close()}}handleDataChannelEvent(e){let t=e.channel;if(t==null){this.close((0,u3.default)(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch(r=>{this.log("Error closing after event channel was found to be null",r)});return}this.channel=new Lb(t,{log:this.log,onMessage:r=>{this.source.push(new Uint8Array(r.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new ee("ready"))},onClose:()=>{this.close().catch(r=>{this.log("error closing connection after channel close",r)})},onError:r=>{this.close(r).catch(n=>{this.log("error closing connection after channel error",n)})}})}async close(e){if(this.closed=!0,e==null&&this.channel!=null)for(;this.channel.bufferedAmount>0;)await(0,mse.default)(100);this.channel?.close(),this.peerConnection.close(),this.source.end(e),this.dispatchEvent(new ee("close"))}};c();var yse=w(K(),1),z1=class extends Ue{constructor(e){super(),this.log=e.log,this.peerConnection=e.peerConnection,this.wrtc=e.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch(t=>{this.log.error("could not renegotiate %o",t)})})}async handleSignal(e){if(this.log('incoming signal "%s"',e.type),e.type==="offer")return await this.handleOffer(e);if(e.type==="answer")return await this.handleAnswer(e);if(e.type==="candidate")return await this.handleCandidate(e);if(e.type==="renegotiate")return await this.handleRenegotiate(e);if(e.type==="goodbye")return await this.handleGoodye(e);this.log(`Unknown signal type ${e.type}`)}async handleOffer(e){}async handleAnswer(e){}async handleRenegotiate(e){}async handleGoodye(e){this.peerConnection.close()}async handleCandidate(e){let t=new this.wrtc.RTCIceCandidate(e.candidate);try{await this.peerConnection.addIceCandidate(t)}catch(r){if(t.address==null||t.address.endsWith(".local"))this.log("ignoring unsupported ICE candidate.");else throw(0,yse.default)(r,"ERR_ADD_ICE_CANDIDATE")}}},gse=C("libp2p:webrtc-peer:receiver"),l3=class extends Rd{constructor(e={}){super({...e,logPrefix:"receiver"}),this.handshake=new TP({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:e.answerOptions}),this.handshake.addEventListener("signal",t=>this.dispatchEvent(new ee("signal",{detail:t.detail}))),this.peerConnection.addEventListener("datachannel",t=>{this.handleDataChannelEvent(t)})}handleSignal(e){this.handshake.handleSignal(e).catch(t=>{this.log("error handling signal %o %o",e,t)})}},TP=class extends z1{constructor(e){super(e),this.options=e,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){gse.trace("renegotiate"),this.dispatchEvent(new ee("signal",{detail:{type:"renegotiate"}}))}async handleOffer(e){await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e));for(let r of this.iceCandidates)await this.handleCandidate(r);this.iceCandidates=[];let t=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription(t),gse.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new ee("signal",{detail:this.peerConnection.localDescription??t}))}async handleCandidate(e){if(this.peerConnection.remoteDescription==null||this.peerConnection.remoteDescription.type==null){this.iceCandidates.push(e);return}await super.handleCandidate(e)}};c();var Ese=w(uh(),1);me(),c();var DPe=e=>{let t=e.on||e.addListener||e.addEventListener,r=e.off||e.removeListener||e.removeEventListener;if(!t||!r)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:r.bind(e)}};function kPe(e,t,r){let n,i=new Promise((s,a)=>{if(r={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...r},!(r.count>=0&&(r.count===Number.POSITIVE_INFINITY||Number.isInteger(r.count))))throw new TypeError("The `count` option should be at least 0 or more");let o=[t].flat(),l=[],{addListener:u,removeListener:h}=DPe(e),f=(...p)=>{let v=r.multiArgs?p:p[0];r.filter&&!r.filter(v)||(l.push(v),r.count===l.length&&(n(),s(l)))},y=p=>{n(),a(p)};n=()=>{for(let p of o)h(p,f);for(let p of r.rejectionEvents)h(p,y)};for(let p of o)u(p,f);for(let p of r.rejectionEvents)u(p,y);r.resolveImmediately&&s(l)});if(i.cancel=n,typeof r.timeout=="number"){let s=nn(i,r.timeout);return s.cancel=n,s}return i}function wse(e,t,r){typeof r=="function"&&(r={filter:r}),r={...r,count:1,resolveImmediately:!1};let n=kPe(e,t,r),i=n.then(s=>s[0]);return i.cancel=n.cancel,i}var bse=w(AP(),1),IP=C("libp2p:webrtc-peer:initator"),NPe=1e3,f3=class extends Rd{constructor(e={}){super({...e,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(e.dataChannelLabel??M((0,Ese.default)(20),"hex").slice(0,7),e.dataChannelInit)}),this.handshake=new CP({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:e.offerOptions}),this.handshake.addEventListener("signal",t=>{this.dispatchEvent(new ee("signal",{detail:t.detail}))})}handleSignal(e){this.handshake.handleSignal(e).catch(t=>{this.log("error handling signal %o %o",e,t)})}},CP=class extends z1{constructor(e){super(e),this.options=e,this.status="idle",this.peerConnection.addEventListener("icecandidate",t=>{if(t.candidate==null)return;let r={type:"candidate",candidate:{candidate:t.candidate.candidate,sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid}};IP.trace("create candidate",r),this.dispatchEvent(new ee("signal",{detail:r})),this.dispatchEvent(new ee("ice-candidate"))})}async handleRenegotiate(){if(this.status==="negotiating"){this.log("already negotiating, queueing");return}this.status="negotiating";let e=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(e),await wse(this,"ice-candidate"),await(0,bse.default)(NPe),IP.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new ee("signal",{detail:this.peerConnection.localDescription??e}))}async handleAnswer(e){IP.trace("handle answer",e),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e)),this.status="idle"}};c();var PP=C("libp2p:webrtc-star:socket");function Bb(e,t){let{sink:r,source:n}=e,i={remoteAddr:t.remoteAddr,async sink(s){t.signal!=null&&(s=Pn(s,t.signal));try{await r(s)}catch(a){a.type!=="aborted"&&PP.error(a)}},source:t.signal!=null?Pn(n,t.signal):n,timeline:{open:Date.now()},async close(){if(e.closed)return;let s=Date.now(),a=setTimeout(()=>{if(i.remoteAddr!=null){let{host:o,port:l}=i.remoteAddr.toOptions();PP("timeout closing socket to %s:%s after %dms, destroying it manually",o,l,Date.now()-s)}e.closed||e.close().catch(o=>{PP.error("could not close socket",o)})},2e3);try{await e.close()}finally{clearTimeout(a)}}};return e.addEventListener("close",()=>{i.timeline.close==null&&(i.timeline.close=Date.now())},{once:!0}),i}c();function Mb(e){let t=e.toString().split("/"),r=e.protos()[1].name,n=e.protos()[2].name,i=e.stringTuples()[1][1];if(r!=="tcp"||n!=="ws"&&n!=="wss")throw new Error(`invalid multiaddr: ${e.toString()}`);if(!j.isName(e))return`http://${t[2]}:${t[4]}`;if(n==="ws")return`http://${t[2]}${i==null||i==="80"?"":`:${i}`}`;if(n==="wss")return`https://${t[2]}${i==null||i==="443"?"":`:${i}`}`;throw new Error("invalid multiaddr: "+e.toString())}function _se(e){let t="/libp2p-webrtc-star";if(e.startsWith(t)){e=e.substring(t.length,e.length);let r=new j(e),n=r.stringTuples().filter(i=>i[0]===421)[0];if(n[1]==null)throw new Error("invalid multiaddr: "+e);r=r.decapsulate("p2p"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/p2p/${n[1]}`),e=r.toString()}return e}var wi=C("libp2p:webrtc-star:listener"),LPe={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"},DP=class extends Ue{constructor(e,t,r,n,i){super(),this.signallingAddr=t,this.socket=c3(e,LPe),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=r,this.handler=n,this.channelOptions=i,this.handleWsHandshake=this.handleWsHandshake.bind(this),this.socket.once("connect_error",s=>{this.dispatchEvent(new ee("error",{detail:s}))}),this.socket.once("error",s=>{this.dispatchEvent(new ee("error",{detail:s}))}),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",s=>{this.dispatchEvent(new ee("peer",{detail:s}))}),this.socket.on("connect",()=>this.socket.emit("ss-join",t.toString())),this.socket.once("connect",()=>{this.dispatchEvent(new ee("listening"))})}_createChannel(e,t,r){let n={...this.channelOptions},i=new l3(n),s=a=>{let o=a.detail;wi.error("incoming connection errored",o)};return i.addEventListener("error",s),i.addEventListener("close",()=>{i.removeEventListener("error",s)},{once:!0}),i.addEventListener("signal",a=>{let o=a.detail;this.socket.emit("ss-handshake",{intentId:e,srcMultiaddr:t,dstMultiaddr:r,answer:!0,signal:o})}),i.addEventListener("ready",()=>{let a=Bb(i,{remoteAddr:this.signallingAddr});wi("new inbound connection %s",a.remoteAddr);try{this.upgrader.upgradeInbound(a).then(o=>{wi("inbound connection %s upgraded",a.remoteAddr),this.connections.push(a);let l=()=>{this.connections=this.connections.filter(u=>u!==a),this.channels.delete(e),this.pendingSignals.delete(e)};i.addEventListener("close",l,{once:!0}),this.dispatchEvent(new ee("connection",{detail:o})),this.handler(o)}).catch(o=>{wi.error("inbound connection failed to upgrade",o),a.close().catch(l=>{wi.error("inbound connection failed to close after failing to upgrade",l)})})}catch(o){wi.error("inbound connection failed to upgrade",o),a.close().catch(l=>{wi.error("inbound connection failed to close after failing to upgrade",l)})}},{once:!0}),i}handleWsHandshake(e){if(wi('incoming handshake. signal type "%s" is answer %s',e.signal.type,e.answer),e.answer===!0||e.err!=null||e.intentId==null)return;let t=e.intentId,r=this.pendingSignals.get(t);r==null&&(r=[],this.pendingSignals.set(t,r)),r.push(e);let n=this.channels.get(t);if(n==null){if(e.signal.type!=="offer"){wi("handshake is not an offer and channel does not exist, buffering until we receive an offer");return}wi("creating new channel to handle offer handshake"),n=this._createChannel(e.intentId,e.srcMultiaddr,e.dstMultiaddr),this.channels.set(t,n)}else wi("channel already exists, using it to handle handshake");for(;r.length>0;){let i=r.shift();i?.signal!=null&&n.handleSignal(i.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map(async e=>await e.close()),...Array.from(this.channels.values()).map(async e=>await e.close())]),this.dispatchEvent(new ee("close"))}},kP=class extends Ue{constructor(e,t,r,n,i){super(),this.upgrader=e,this.handler=t,this.peerId=r,this.transport=n,this.options=i}async listen(e){if(this.listeningAddr!=null)throw(0,Sse.default)(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let t=Ar();this.listeningAddr=e;let r;e.protoCodes().includes(421)?r=e:r=e.encapsulate(`/p2p/${this.peerId.toString()}`),this.signallingUrl=Mb(e),wi("connecting to signalling server on: %s",this.signallingUrl);let n=new DP(this.signallingUrl,r,this.upgrader,this.handler,this.options.channelOptions);return n.addEventListener("error",i=>{let s=i.detail;wi("error connecting to signalling server %o",s),n.close().catch(a=>{wi.error("error closing server after error",a)}),t.reject(s)}),n.addEventListener("listening",()=>{wi("connected to signalling server"),this.dispatchEvent(new ee("listening")),t.resolve()}),n.addEventListener("peer",i=>{this.transport.peerDiscovered(i.detail)}),n.addEventListener("connection",i=>{let s=i.detail;if(s.remoteAddr==null)try{s.remoteAddr=e.decapsulateCode(421).encapsulate(`/p2p/${s.remotePeer.toString()}`)}catch(a){wi.error("could not determine remote address",a)}this.dispatchEvent(new ee("connection",{detail:s}))}),this.transport.sigServers.set(this.signallingUrl,n),await t.promise}async close(){if(this.signallingUrl!=null){let e=this.transport.sigServers.get(this.signallingUrl);e!=null&&(await e.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new ee("close")),this.listeningAddr=void 0}getAddrs(){return this.listeningAddr!=null?[this.listeningAddr]:[]}};function xse(e,t,r,n,i){return new kP(e,t,r,n,i)}var Rse=w(uh(),1);c();var H1=Symbol.for("@libp2p/transport");c();var rc=Symbol.for("@libp2p/peer-discovery"),MPe="RTCPeerConnection"in globalThis,Ad=C("libp2p:webrtc-star"),UPe=()=>{},NP=class extends Ue{constructor(){super(...arguments),this.started=!1}get[rc](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(e){return this.isStarted()?super.dispatchEvent(e):!1}},Fb=class{constructor(e){this.components=new He,e?.wrtc!=null&&(this.wrtc=e.wrtc),this.sigServers=new Map,this.discovery=new NP,this.peerDiscovered=this.peerDiscovered.bind(this)}get[H1](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}init(e){this.components=e}async dial(e,t){let r=await this._connect(e,t),n=Bb(r,{remoteAddr:e,signal:t.signal});Ad("new outbound connection %s",n.remoteAddr);let i=await t.upgrader.upgradeOutbound(n);return Ad("outbound connection %s upgraded",n.remoteAddr),i}async _connect(e,t){if(t.signal?.aborted===!0)throw new Jl;let r={...t.channelOptions??{}};this.wrtc!=null&&(r.wrtc=this.wrtc);let n=e.toOptions(),i=M((0,Rse.default)(36),"hex");return await new Promise((s,a)=>{let o=this.sigServers.get(Mb(e));if(o?.socket==null)return a((0,Ub.default)(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let l=!1;Ad("dialing %s:%s",n.host,n.port);let u=new f3(r),h=v=>{let d=v.detail;if(!l){let g=`connection error ${n.host}:${n.port}: ${d.message}`;Ad.error(g),p(d)}},f=()=>{l=!0,Ad("connection opened %s:%s",n.host,n.port),p()},y=()=>{Ad.error("connection aborted %s:%s",n.host,n.port),u.close().finally(()=>{p(new Jl)})},p=v=>{u.removeEventListener("ready",f),t.signal?.removeEventListener("abort",y),v==null?s(u):a(v)};u.addEventListener("ready",f,{once:!0}),u.addEventListener("close",()=>{u.removeEventListener("error",h)}),t.signal?.addEventListener("abort",y),u.addEventListener("signal",v=>{let d=v.detail;o.socket.emit("ss-handshake",{intentId:i,srcMultiaddr:o.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:d})}),o.socket.on("ws-handshake",v=>{v.intentId===i&&v.err!=null&&u.close().finally(()=>{a((0,Ub.default)(new Error(v.err),"ERR_SIGNALLING_FAILED"))}),!(v.intentId!==i||v.answer==null||u.closed)&&u.handleSignal(v.signal)})})}createListener(e){if(!MPe&&this.wrtc==null)throw(0,Ub.default)(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return e.channelOptions=e.channelOptions??{},this.wrtc!=null&&(e.channelOptions.wrtc=this.wrtc),xse(e.upgrader,e.handler??UPe,this.components.getPeerId(),this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>t.protoCodes().includes(290)?!1:X6.matches(t))}peerDiscovered(e){Ad("peer discovered: %s",e),e=_se(e);let t=new j(e),r=t.getPeerId();if(r==null)return;let n=ue(r);this.discovery.dispatchEvent(new ee("peer",{detail:{id:n,multiaddrs:[t],protocols:[]}}))}};function Ase(){let e=new Fb;return{transports:[e],peerDiscovery:[e.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1},metrics:{enabled:!0}}}c(),c(),c();var d3=w(K(),1);c();var _t;(function(e){e.NOT_STARTED_YET="The libp2p node is not started yet",e.DHT_DISABLED="DHT is not available",e.PUBSUB_DISABLED="PubSub is not available",e.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",e.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",e.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",e.NOT_FOUND="Not found"})(_t||(_t={}));var q;(function(e){e.DHT_DISABLED="ERR_DHT_DISABLED",e.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",e.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",e.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",e.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",e.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",e.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",e.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",e.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",e.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",e.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",e.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",e.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",e.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",e.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",e.ERR_DIALED_SELF="ERR_DIALED_SELF",e.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",e.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",e.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",e.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",e.ERR_INVALID_KEY="ERR_INVALID_KEY",e.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_PEER="ERR_INVALID_PEER",e.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",e.ERR_NOT_FOUND="ERR_NOT_FOUND",e.ERR_TIMEOUT="ERR_TIMEOUT",e.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",e.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",e.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",e.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",e.ERR_FIND_SELF="ERR_FIND_SELF",e.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",e.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",e.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",e.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",e.ERR_INVALID_CMS="ERR_INVALID_CMS",e.ERR_MISSING_KEYS="ERR_MISSING_KEYS",e.ERR_NO_KEY="ERR_NO_KEY",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",e.ERR_INVALID_RECORD="ERR_INVALID_RECORD",e.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED"})(q||(q={})),c();var Tse=w(K(),1),Ise=w(Gi(),1),Cse=w(ei(),1);async function*h3(e,t){yield*(0,Cse.default)(e,async r=>(await t.addressBook.add(r.id,r.multiaddrs),r))}function Kb(e){let t=new Set;return(0,Ise.default)(e,r=>t.has(r.id.toString())?!1:(t.add(r.id.toString()),!0))}async function*Vb(e,t=1){let r=0;for await(let n of e)r++,yield n;if(r<t)throw(0,Tse.default)(new Error("not found"),"NOT_FOUND")}var kse=w($o(),1),LP=w(Fc(),1),Nse=w(Gc(),1),Ose=w(Ci(),1),Lse=w(Gi(),1),zb=w(OP(),1),Bse=w(In(),1),Dse=C("libp2p:peer-routing"),qb=class{constructor(e,t){this.components=e,this.routers=t.routers,this.refreshManagerInit=t.refreshManager??{},this.started=!1,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}isStarted(){return this.started}async start(){this.started||this.routers.length===0||this.timeoutId!=null||this.refreshManagerInit.enabled===!1||(this.timeoutId=(0,zb.setDelayedInterval)(this._findClosestPeersTask,this.refreshManagerInit.interval,this.refreshManagerInit.bootDelay),this.started=!0)}async _findClosestPeersTask(){if(this.abortController==null)try{this.abortController=new kse.TimeoutController(this.refreshManagerInit.timeout??1e4);try{(0,Bse.setMaxListeners)?.(1/0,this.abortController.signal)}catch{}await(0,Ose.default)(this.getClosestPeers(this.components.getPeerId().toBytes(),{signal:this.abortController.signal}))}catch(e){Dse.error(e)}finally{this.abortController?.clear(),this.abortController=void 0}}async stop(){(0,zb.clearDelayedInterval)(this.timeoutId),this.abortController?.abort(),this.started=!1}async findPeer(e,t){if(this.routers.length===0)throw(0,d3.default)(new Error("No peer routers available"),q.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.components.getPeerId().toString())throw(0,d3.default)(new Error("Should not try to find self"),q.ERR_FIND_SELF);let r=await Te((0,LP.default)(...this.routers.map(n=>async function*(){try{yield await n.findPeer(e,t)}catch(i){Dse.error(i)}}())),n=>(0,Lse.default)(n,Boolean),n=>h3(n,this.components.getPeerStore()),async n=>await(0,Nse.default)(n));if(r!=null)return r;throw(0,d3.default)(new Error(_t.NOT_FOUND),q.ERR_NOT_FOUND)}async*getClosestPeers(e,t){if(this.routers.length===0)throw(0,d3.default)(new Error("No peer routers available"),q.ERR_NO_ROUTERS_AVAILABLE);yield*Te((0,LP.default)(...this.routers.map(r=>r.getClosestPeers(e,t))),r=>h3(r,this.components.getPeerStore()),r=>Kb(r),r=>Vb(r))}};c();var ff=w(K(),1),Mse=w(Ci(),1),Use=w(Fc(),1),Hb=class{constructor(e,t){this.routers=t.routers??[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(e,t={}){if(this.routers.length===0)throw(0,ff.default)(new Error("No content this.routers available"),q.ERR_NO_ROUTERS_AVAILABLE);yield*Te((0,Use.default)(...this.routers.map(r=>r.findProviders(e,t))),r=>h3(r,this.components.getPeerStore()),r=>Kb(r),r=>Vb(r))}async provide(e,t={}){if(this.routers.length===0)throw(0,ff.default)(new Error("No content routers available"),q.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(async r=>await r.provide(e,t)))}async put(e,t,r){if(!this.isStarted())throw(0,ff.default)(new Error(_t.NOT_STARTED_YET),q.DHT_NOT_STARTED);let n=this.components.getDHT();n!=null&&await(0,Mse.default)(n.put(e,t,r))}async get(e,t){if(!this.isStarted())throw(0,ff.default)(new Error(_t.NOT_STARTED_YET),q.DHT_NOT_STARTED);let r=this.components.getDHT();if(r!=null){for await(let n of r.get(e,t))if(n.name==="VALUE")return n.value}throw(0,ff.default)(new Error(_t.NOT_FOUND),q.ERR_NOT_FOUND)}async*getMany(e,t,r){if(!this.isStarted())throw(0,ff.default)(new Error(_t.NOT_STARTED_YET),q.DHT_NOT_STARTED);if(t==null||t===0)return;let n=0,i=this.components.getDHT();if(i!=null){for await(let s of i.get(e,r))if(s.name==="VALUE"&&(yield{from:s.from,val:s.value},n++,n===t))break}if(n===0)throw(0,ff.default)(new Error(_t.NOT_FOUND),q.ERR_NOT_FOUND)}};c();var BP=w(K(),1);function zPe(e){let t=e.getPeerId();if(t==null)throw(0,BP.default)(new Error(`${e.toString()} does not have a valid peer type`),q.ERR_INVALID_MULTIADDR);try{return ue(t)}catch{throw(0,BP.default)(new Error(`${e.toString()} is not a valid peer type`),q.ERR_INVALID_MULTIADDR)}}function Td(e){if(Go(e))return{id:e,multiaddrs:[],protocols:[]};typeof e=="string"&&(e=new j(e));let t;return j.isMultiaddr(e)&&(t=e,e=zPe(e)),{id:e,multiaddrs:t!=null?[t]:[],protocols:[]}}c();var HPe=e=>e,$b=class extends Ue{constructor(e,t){super();let{listen:r=[],announce:n=[]}=t;this.components=e,this.listen=new Set(r.map(i=>i.toString())),this.announce=new Set(n.map(i=>i.toString())),this.observed=new Set,this.announceFilter=t.announceFilter??HPe}getListenAddrs(){return Array.from(this.listen).map(e=>new j(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new j(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new j(e))}addObservedAddr(e){let t=new j(e),r=t.getPeerId();r!=null&&ue(r).equals(this.components.getPeerId())&&(t=t.decapsulate(new j(`/p2p/${this.components.getPeerId().toString()}`)));let n=t.toString();this.observed.has(n)||(this.observed.add(n),this.dispatchEvent(new ee("change:addresses")))}getAddresses(){let e=this.getAnnounceAddrs().map(r=>r.toString());e.length===0&&(e=this.components.getTransportManager().getAddrs().map(r=>r.toString())),e=e.concat(this.getObservedAddrs().map(r=>r.toString()));let t=new Set(e);return this.announceFilter(Array.from(t).map(r=>new j(r))).map(r=>r.getPeerId()===this.components.getPeerId().toString()?r:r.encapsulate(`/p2p/${this.components.getPeerId().toString()}`))}};c();var WP=w(K(),1);c(),c();var Fse=C("libp2p:connection-manager:latency-monitor:visibility-change-emitter"),Gb=class extends Ue{constructor(){super(),this.hidden="hidden",this.visibilityChange="visibilityChange",globalThis.document!=null&&(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener())}_initializeVisibilityVarNames(){let e="hidden",t="visibilitychange";typeof globalThis.document.hidden<"u"?(e="hidden",t="visibilitychange"):typeof globalThis.document.mozHidden<"u"?(e="mozHidden",t="mozvisibilitychange"):typeof globalThis.document.msHidden<"u"?(e="msHidden",t="msvisibilitychange"):typeof globalThis.document.webkitHidden<"u"&&(e="webkitHidden",t="webkitvisibilitychange"),this.hidden=e,this.visibilityChange=t}_addVisibilityChangeListener(){typeof globalThis.document.addEventListener>"u"||typeof document[this.hidden]>"u"?Fse("Checking page visibility requires a browser that supports the Page Visibility API."):globalThis.document.addEventListener(this.visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this.hidden===void 0||document[this.hidden]===void 0))return document[this.hidden]==null}_handleVisibilityChange(){let e=globalThis.document[this.hidden]===!1;Fse(e?"Page Visible":"Page Hidden"),this.dispatchEvent(new ee("visibilityChange",{detail:e}))}},lu=C("libp2p:connection-manager:latency-monitor"),Wb=class extends Ue{constructor(e={}){super();let{latencyCheckIntervalMs:t,dataEmitIntervalMs:r,asyncTestFn:n,latencyRandomPercentage:i}=e;this.latencyCheckIntervalMs=t??500,this.latencyRandomPercentage=i??10,this.latencyCheckMultiply=2*(this.latencyRandomPercentage/100)*this.latencyCheckIntervalMs,this.latencyCheckSubtract=this.latencyCheckMultiply/2,this.dataEmitIntervalMs=r===null||r===0?void 0:r??5*1e3,lu("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",this.latencyCheckIntervalMs,this.dataEmitIntervalMs),this.dataEmitIntervalMs!=null?lu("Expecting ~%s events per summary",this.latencyCheckIntervalMs/this.dataEmitIntervalMs):lu("Not emitting summaries"),this.asyncTestFn=n,globalThis.process?.hrtime!=null?(lu("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=s=>{let a=this.now(s);return a[0]*1e3+a[1]/1e6}):typeof window<"u"&&window.performance?.now!=null?(lu("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=s=>Math.round(this.now()-s)):(lu("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=s=>this.now()-s),this.latencyData=this.initLatencyData()}start(){$Pe()&&(this.visibilityChangeEmitter=new Gb,this.visibilityChangeEmitter.addEventListener("visibilityChange",e=>{let{detail:t}=e;t?this._startTimers():(this._emitSummary(),this._stopTimers())})),this.visibilityChangeEmitter?.isVisible()===!0&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this.checkLatencyID==null&&(this.checkLatency(),this.dataEmitIntervalMs!=null&&(this.emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this.emitIntervalID.unref=="function"&&this.emitIntervalID.unref()))}_stopTimers(){this.checkLatencyID!=null&&(clearTimeout(this.checkLatencyID),this.checkLatencyID=void 0),this.emitIntervalID!=null&&(clearInterval(this.emitIntervalID),this.emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.dispatchEvent(new ee("data",{detail:e}))}getSummary(){let e={events:this.latencyData.events,minMs:this.latencyData.minMs,maxMs:this.latencyData.maxMs,avgMs:this.latencyData.events>0?this.latencyData.totalMs/this.latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this.latencyData.startTime)};return this.latencyData=this.initLatencyData(),lu.trace("Summary: %O",e),e}checkLatency(){let e=Math.random()*this.latencyCheckMultiply-this.latencyCheckSubtract,t={deltaOffset:Math.ceil(this.latencyCheckIntervalMs+e),startTime:this.now()},r=()=>{if(this.checkLatencyID==null)return;let n=this.getDeltaMS(t.startTime)-t.deltaOffset;this.checkLatency(),this.latencyData.events++,this.latencyData.minMs=Math.min(this.latencyData.minMs,n),this.latencyData.maxMs=Math.max(this.latencyData.maxMs,n),this.latencyData.totalMs+=n,lu.trace("MS: %s Data: %O",n,this.latencyData)};lu.trace("localData: %O",t),this.checkLatencyID=setTimeout(()=>{this.asyncTestFn!=null?(t.deltaOffset=0,t.startTime=this.now(),this.asyncTestFn(r)):(t.deltaOffset-=1,r())},t.deltaOffset),typeof this.checkLatencyID.unref=="function"&&this.checkLatencyID.unref()}initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function $Pe(){return typeof globalThis.window<"u"}var jP=w(y2(),1);c();var MP=class extends Map{constructor(e){super();let{system:t,component:r,metric:n,metrics:i}=e;this.system=t??"libp2p",this.component=r,this.metric=n,this.metrics=i,this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){let t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metrics.updateComponentMetric({system:this.system,component:this.component,metric:this.metric,value:this.size})}};function Dn(e){let{system:t,component:r,metric:n,metrics:i}=e,s;return i!=null?s=new MP({system:t,component:r,metric:n,metrics:i}):s=new Map,s}var wae=w(In(),1);c();var jb="OPEN",UP="CLOSING",Yb="CLOSED";c();var lae=w(Vs(),1),fae=w(Gi(),1),j1=w(K(),1),hae=w($o(),1);c();var nc=class extends Error{constructor(e="The operation was aborted"){super(e),this.code=nc.code,this.type=nc.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}},dae=w(Vi(),1),pae=w(In(),1);c();var p3=w(K(),1),Wse=w(Vi(),1),jse=w($se(),1),FP=w(In(),1),Gse=C("libp2p:dialer:dial-request"),Qb=class{constructor(e){let{addrs:t,dialAction:r,dialer:n}=e;this.addrs=t,this.dialer=n,this.dialAction=r}async run(e={}){let t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw(0,p3.default)(new Error("No dial tokens available"),q.ERR_NO_DIAL_TOKENS);let r=new jse.default;for(let a of t)r.push(a).catch(o=>{Gse.error(o)});let n=this.addrs.map(()=>{let a=new AbortController;try{(0,FP.setMaxListeners)?.(1/0,a.signal)}catch{}return a});if(e.signal!=null)try{(0,FP.setMaxListeners)?.(1/0,e.signal)}catch{}let i=0,s=!1;try{return await Promise.any(this.addrs.map(async(a,o)=>{let l=await r.shift();if(s)throw this.dialer.releaseToken(t.splice(t.indexOf(l),1)[0]),(0,p3.default)(new Error("dialAction already succeeded"),q.ERR_ALREADY_SUCCEEDED);let u=n[o];if(u==null)throw(0,p3.default)(new Error("dialAction did not come with an AbortController"),q.ERR_INVALID_PARAMETERS);let h;try{let f=u.signal;h=await this.dialAction(a,{...e,signal:e.signal!=null?(0,Wse.anySignal)([f,e.signal]):f}),n[o]=void 0}finally{i++,this.addrs.length-i>=t.length?r.push(l).catch(f=>{Gse.error(f)}):this.dialer.releaseToken(t.splice(t.indexOf(l),1)[0])}if(h==null)throw(0,p3.default)(new Error("dialAction led to empty object"),q.ERR_TRANSPORT_DIAL_FAILED);return s=!0,h}))}finally{n.forEach(a=>{a!==void 0&&a.abort()}),t.forEach(a=>this.dialer.releaseToken(a))}}};c(),c();var aae=w(Jb(),1);function zP(e){let{address:t}=e.nodeAddress();return Boolean((0,aae.default)(t))}function W1(e,t){let r=zP(e.multiaddr),n=zP(t.multiaddr);return r&&!n?1:!r&&n||e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}c();var cae={computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[6e4,3e5,9e5],maxOldPeersRetention:50},mae=w(ug(),1),yae=w(ei(),1),ic=C("libp2p:dialer"),uae="dialler",oDe="pending-dials",sDe="pending-dial-targets",e_=class{constructor(e={}){this.components=new He,this.started=!1,this.addressSorter=e.addressSorter??W1,this.maxAddrsToDial=e.maxAddrsToDial??25,this.timeout=e.dialTimeout??3e4,this.maxDialsPerPeer=e.maxDialsPerPeer??4,this.tokens=[...new Array(e.maxParallelDials??100)].map((t,r)=>r),this.pendingDials=Dn({component:uae,metric:oDe,metrics:e.metrics}),this.pendingDialTargets=Dn({component:uae,metric:sDe,metrics:e.metrics});for(let[t,r]of Object.entries(e.resolvers??{}))j.resolvers.set(t,r)}init(e){this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1;for(let e of this.pendingDials.values())try{e.controller.abort()}catch(t){ic.error(t)}this.pendingDials.clear();for(let e of this.pendingDialTargets.values())e.reject(new nc("Dialer was destroyed"));this.pendingDialTargets.clear()}async dial(e,t={}){let{id:r,multiaddrs:n}=Td(e);if(this.components.getPeerId().equals(r))throw(0,j1.default)(new Error("Tried to dial self"),q.ERR_DIALED_SELF);if(ic("check multiaddrs %p",r),n!=null&&n.length>0&&(ic("storing multiaddrs %p",r,n),await this.components.getPeerStore().addressBook.add(r,n)),await this.components.getConnectionGater().denyDialPeer(r))throw(0,j1.default)(new Error("The dial request is blocked by gater.allowDialPeer"),q.ERR_PEER_DIAL_INTERCEPTED);ic("creating dial target for %p",r);let i=await this._createCancellableDialTarget(r);if(i.addrs.length===0)throw(0,j1.default)(new Error("The dial request has no valid addresses"),q.ERR_NO_VALID_ADDRESSES);let s=this.pendingDials.get(i.id)??this._createPendingDial(i,t);try{let a=await s.promise;return ic("dial succeeded to %s",i.id),a}catch(a){throw ic("dial failed to %s",i.id,a),s.controller.signal.aborted&&(a.code=q.ERR_TIMEOUT),ic.error(a),a}finally{s.destroy()}}async _createCancellableDialTarget(e){let t=`${parseInt(String(Math.random()*1e9),10).toString()}${Date.now()}`,r=new Promise((n,i)=>{this.pendingDialTargets.set(t,{resolve:n,reject:i})});try{return await Promise.race([this._createDialTarget(e),r])}finally{this.pendingDialTargets.delete(t)}}async _createDialTarget(e){let t=await Te(await this.components.getPeerStore().addressBook.get(e),i=>(0,fae.default)(i,async s=>!await this.components.getConnectionGater().denyDialMultiaddr(e,s.multiaddr)),i=>(0,mae.default)(i,this.addressSorter),i=>(0,yae.default)(i,s=>{let a=s.multiaddr;return e.toString()===a.getPeerId()?a:a.encapsulate(`/p2p/${e.toString()}`)}),async i=>await(0,lae.default)(i)),r=[];for(let i of t)(await this._resolve(i)).forEach(s=>r.push(s));let n=r.filter(i=>this.components.getTransportManager().transportForMultiaddr(i));if(n.length>this.maxAddrsToDial)throw await this.components.getPeerStore().delete(e),(0,j1.default)(new Error("dial with more addresses than allowed"),q.ERR_TOO_MANY_ADDRESSES);return{id:e.toString(),addrs:n}}_createPendingDial(e,t={}){let r=async(l,u={})=>{if(u.signal?.aborted===!0)throw(0,j1.default)(new Error("already aborted"),q.ERR_ALREADY_ABORTED);return await this.components.getTransportManager().dial(l,u)},n=new Qb({addrs:e.addrs,dialAction:r,dialer:this}),i=new hae.TimeoutController(this.timeout),s=[i.signal];t.signal!=null&&s.push(t.signal);let a=(0,dae.anySignal)(s);try{(0,pae.setMaxListeners)?.(1/0,a)}catch{}let o={dialRequest:n,controller:i,promise:n.run({...t,signal:a}),destroy:()=>{i.clear(),this.pendingDials.delete(e.id)}};return this.pendingDials.set(e.id,o),o}getTokens(e){let t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),r=this.tokens.splice(0,t);return ic("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),r}releaseToken(e){this.tokens.includes(e)||(ic("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let t=await this._resolveRecord(e);return(await Promise.all(t.map(async r=>await this._resolve(r)))).flat().reduce((r,n)=>(r.find(i=>i.equals(n))==null&&r.push(n),r),[])}async _resolveRecord(e){try{return e=new j(e.toString()),await e.resolve()}catch(t){return ic.error(`multiaddr ${e.toString()} could not be resolved`,t),[]}}},ki=C("libp2p:connection-manager"),aDe={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:.5},gae="connection-manager",cDe="peer-connections",uDe="peer-values",t_=class extends Ue{constructor(e){if(super(),this.components=new He,this.opts=Ze.call({ignoreUndefined:!0},aDe,e),this.opts.maxConnections<this.opts.minConnections)throw(0,WP.default)(new Error("Connection Manager maxConnections must be greater than minConnections"),q.ERR_INVALID_PARAMETERS);ki("options: %o",this.opts),this.peerValues=Dn({component:gae,metric:uDe,metrics:this.components.getMetrics()}),this.connections=Dn({component:gae,metric:cDe,metrics:this.components.getMetrics()}),this.started=!1,this._checkMetrics=this._checkMetrics.bind(this),this.latencyMonitor=new Wb({latencyCheckIntervalMs:e.pollInterval,dataEmitIntervalMs:e.pollInterval});try{(0,wae.setMaxListeners)?.(1/0,this)}catch{}this.dialer=new e_(this.opts),this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this)}init(e){this.components=e,this.dialer.init(e)}isStarted(){return this.started}async start(){this.components.getMetrics()!=null&&(this.timer=this.timer??(0,jP.default)(this._checkMetrics,this.opts.pollInterval)),this.latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this.latencyMonitor.addEventListener("data",this._onLatencyMeasure),await this.dialer.start(),this.started=!0,ki("started")}async afterStart(){this.components.getUpgrader().addEventListener("connection",this.onConnect),this.components.getUpgrader().addEventListener("connectionEnd",this.onDisconnect)}async beforeStop(){this.components.getUpgrader().removeEventListener("connection",this.onConnect),this.components.getUpgrader().removeEventListener("connectionEnd",this.onDisconnect)}async stop(){this.timer?.clear(),this.latencyMonitor.removeEventListener("data",this._onLatencyMeasure),this.latencyMonitor.stop(),await this.dialer.stop(),this.started=!1,await this._close(),ki("stopped")}async _close(){let e=[];for(let t of this.connections.values())for(let r of t)e.push((async()=>{try{await r.close()}catch(n){ki.error(n)}})());ki("closing %d connections",e.length),await Promise.all(e),this.connections.clear()}setPeerValue(e,t){if(t<0||t>1)throw new Error("value should be a number between 0 and 1");this.peerValues.set(e.toString(),t)}async _checkMetrics(){let e=this.components.getMetrics();if(e!=null)try{let t=e.getGlobal().getMovingAverages(),r=t.dataReceived[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxReceivedData",r);let n=t.dataSent[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxSentData",n);let i=r+n;await this._checkMaxLimit("maxData",i),ki.trace("metrics update",i)}finally{this.timer=(0,jP.default)(this._checkMetrics,this.opts.pollInterval)}}onConnect(e){this._onConnect(e).catch(t=>{ki.error(t)})}async _onConnect(e){let{detail:t}=e;if(!this.started){await t.close();return}let r=t.remotePeer,n=r.toString(),i=this.connections.get(n);i!=null?i.push(t):this.connections.set(n,[t]),r.publicKey!=null&&await this.components.getPeerStore().keyBook.set(r,r.publicKey),this.peerValues.has(n)||this.peerValues.set(n,this.opts.defaultPeerValue);let s=this.getConnections().length,a=s-this.opts.maxConnections;await this._checkMaxLimit("maxConnections",s,a),this.dispatchEvent(new ee("peer:connect",{detail:t}))}onDisconnect(e){let{detail:t}=e;if(!this.started)return;let r=t.remotePeer.toString(),n=this.connections.get(r);n!=null&&n.length>1?(n=n.filter(i=>i.id!==t.id),this.connections.set(r,n)):n!=null&&(this.connections.delete(r),this.peerValues.delete(t.remotePeer.toString()),this.dispatchEvent(new ee("peer:disconnect",{detail:t})),this.components.getMetrics()?.onPeerDisconnected(t.remotePeer))}getConnections(e){if(e!=null)return this.connections.get(e.toString())??[];let t=[];for(let r of this.connections.values())t=t.concat(r);return t}async openConnection(e,t){ki("dial to %p",e);let r=this.getConnections(e);if(r.length>0)return ki("had an existing connection to %p",e),r[0];let n=await this.dialer.dial(e,t),i=this.connections.get(e.toString());i==null&&(i=[],this.connections.set(e.toString(),i));let s=!1;for(let a of i)a.id===n.id&&(s=!0);return s||i.push(n),n}async closeConnections(e){let t=this.connections.get(e.toString())??[];await Promise.all(t.map(async r=>await r.close()))}getAll(e){if(!Go(e))throw(0,WP.default)(new Error("peerId must be an instance of peer-id"),q.ERR_INVALID_PARAMETERS);let t=e.toString(),r=this.connections.get(t);return r!=null?r.filter(n=>n.stat.status===jb):[]}_onLatencyMeasure(e){let{detail:t}=e;this._checkMaxLimit("maxEventLoopDelay",t.avgMs,1).catch(r=>{ki.error(r)})}async _checkMaxLimit(e,t,r=1){let n=this.opts[e];ki.trace("checking limit of %s. current value: %d of %d",e,t,n),t>n&&(ki("%s: limit exceeded: %p, %d, pruning %d connection(s)",this.components.getPeerId(),e,t,r),await this._maybePruneConnections(r))}async _maybePruneConnections(e){let t=this.getConnections();if(t.length<=this.opts.minConnections||e<1)return;let r=Array.from(new Map([...this.peerValues.entries()].sort((i,s)=>i[1]-s[1])));ki.trace("sorted peer values: %j",r);let n=[];for(let[i]of r){ki("too many connections open - closing a connection to %p",i);for(let s of t)if(s.remotePeer.toString()===i&&n.push(s),n.length===e)break}await Promise.all(n.map(async i=>{try{await i.close()}catch(s){ki.error(s)}this.onDisconnect(new ee("connectionEnd",{detail:i}))}))}};c();var YP=w(y2(),1),Eae=w(Vs(),1),bae=w(Gi(),1),_ae=w(ug(),1),df=C("libp2p:connection-manager:auto-dialler"),lDe={enabled:!0,minConnections:0,autoDialInterval:1e4},r_=class{constructor(e,t){this.components=e,this.options=Ze.call({ignoreUndefined:!0},lDe,t),this.running=!1,this._autoDial=this._autoDial.bind(this),df("options: %j",this.options)}isStarted(){return this.running}async start(){if(!this.options.enabled){df("not enabled");return}this.running=!0,this._autoDial().catch(e=>{df.error("could start autodial",e)}),df("started")}async stop(){if(!this.options.enabled){df("not enabled");return}this.running=!1,this.autoDialTimeout!=null&&this.autoDialTimeout.clear(),df("stopped")}async _autoDial(){this.autoDialTimeout!=null&&this.autoDialTimeout.clear();let e=this.options.minConnections;if(this.components.getConnectionManager().getConnections().length>=e){this.autoDialTimeout=(0,YP.default)(this._autoDial,this.options.autoDialInterval);return}let t=await this.components.getPeerStore().all(),r=await Te(t.sort(()=>Math.random()>.5?1:-1),n=>(0,bae.default)(n,i=>!i.id.equals(this.components.getPeerId())),n=>(0,_ae.default)(n,(i,s)=>s.protocols.length>i.protocols.length||s.id.publicKey!=null&&i.id.publicKey==null?1:-1),async n=>await(0,Eae.default)(n));for(let n=0;this.running&&n<r.length&&this.components.getConnectionManager().getConnections().length<e;n++){if(!this.running)return;let i=r[n];if(this.components.getConnectionManager().getConnections(i.id).length===0){df("connecting to a peerStore stored peer %p",i.id);try{await this.components.getConnectionManager().openConnection(i.id)}catch(s){df.error("could not connect to peerStore stored peer",s)}}}!this.running||(this.autoDialTimeout=(0,YP.default)(this._autoDial,this.options.autoDialInterval))}};c();var Dae=w(K(),1);c();var rt;(function(e){let t;(function(a){a.SUCCESS="SUCCESS",a.HOP_SRC_ADDR_TOO_LONG="HOP_SRC_ADDR_TOO_LONG",a.HOP_DST_ADDR_TOO_LONG="HOP_DST_ADDR_TOO_LONG",a.HOP_SRC_MULTIADDR_INVALID="HOP_SRC_MULTIADDR_INVALID",a.HOP_DST_MULTIADDR_INVALID="HOP_DST_MULTIADDR_INVALID",a.HOP_NO_CONN_TO_DST="HOP_NO_CONN_TO_DST",a.HOP_CANT_DIAL_DST="HOP_CANT_DIAL_DST",a.HOP_CANT_OPEN_DST_STREAM="HOP_CANT_OPEN_DST_STREAM",a.HOP_CANT_SPEAK_RELAY="HOP_CANT_SPEAK_RELAY",a.HOP_CANT_RELAY_TO_SELF="HOP_CANT_RELAY_TO_SELF",a.STOP_SRC_ADDR_TOO_LONG="STOP_SRC_ADDR_TOO_LONG",a.STOP_DST_ADDR_TOO_LONG="STOP_DST_ADDR_TOO_LONG",a.STOP_SRC_MULTIADDR_INVALID="STOP_SRC_MULTIADDR_INVALID",a.STOP_DST_MULTIADDR_INVALID="STOP_DST_MULTIADDR_INVALID",a.STOP_RELAY_REFUSED="STOP_RELAY_REFUSED",a.MALFORMED_MESSAGE="MALFORMED_MESSAGE"})(t=e.Status||(e.Status={}));let r;(function(a){a[a.SUCCESS=100]="SUCCESS",a[a.HOP_SRC_ADDR_TOO_LONG=220]="HOP_SRC_ADDR_TOO_LONG",a[a.HOP_DST_ADDR_TOO_LONG=221]="HOP_DST_ADDR_TOO_LONG",a[a.HOP_SRC_MULTIADDR_INVALID=250]="HOP_SRC_MULTIADDR_INVALID",a[a.HOP_DST_MULTIADDR_INVALID=251]="HOP_DST_MULTIADDR_INVALID",a[a.HOP_NO_CONN_TO_DST=260]="HOP_NO_CONN_TO_DST",a[a.HOP_CANT_DIAL_DST=261]="HOP_CANT_DIAL_DST",a[a.HOP_CANT_OPEN_DST_STREAM=262]="HOP_CANT_OPEN_DST_STREAM",a[a.HOP_CANT_SPEAK_RELAY=270]="HOP_CANT_SPEAK_RELAY",a[a.HOP_CANT_RELAY_TO_SELF=280]="HOP_CANT_RELAY_TO_SELF",a[a.STOP_SRC_ADDR_TOO_LONG=320]="STOP_SRC_ADDR_TOO_LONG",a[a.STOP_DST_ADDR_TOO_LONG=321]="STOP_DST_ADDR_TOO_LONG",a[a.STOP_SRC_MULTIADDR_INVALID=350]="STOP_SRC_MULTIADDR_INVALID",a[a.STOP_DST_MULTIADDR_INVALID=351]="STOP_DST_MULTIADDR_INVALID",a[a.STOP_RELAY_REFUSED=390]="STOP_RELAY_REFUSED",a[a.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE"})(r||(r={})),function(a){a.codec=()=>xi(r)}(t=e.Status||(e.Status={}));let n;(function(a){a.HOP="HOP",a.STOP="STOP",a.STATUS="STATUS",a.CAN_HOP="CAN_HOP"})(n=e.Type||(e.Type={}));let i;(function(a){a[a.HOP=1]="HOP",a[a.STOP=2]="STOP",a[a.STATUS=3]="STATUS",a[a.CAN_HOP=4]="CAN_HOP"})(i||(i={})),function(a){a.codec=()=>xi(i)}(n=e.Type||(e.Type={}));let s;(function(a){a.codec=()=>Xe({1:{name:"id",codec:ye},2:{name:"addrs",codec:ye,repeats:!0}}),a.encode=o=>Qe(o,a.codec()),a.decode=o=>Ye(o,a.codec())})(s=e.Peer||(e.Peer={})),e.codec=()=>Xe({1:{name:"type",codec:e.Type.codec(),optional:!0},2:{name:"srcPeer",codec:e.Peer.codec(),optional:!0},3:{name:"dstPeer",codec:e.Peer.codec(),optional:!0},4:{name:"code",codec:e.Status.codec(),optional:!0}}),e.encode=a=>Qe(a,e.codec()),e.decode=a=>Ye(a,e.codec())})(rt||(rt={})),c();var fDe=C("libp2p:stream:converter");function QP(e,t={}){let{stream:r,remoteAddr:n}=e,{sink:i,source:s}=r,a={async sink(l){t.signal!=null&&(l=Pn(l,t.signal));try{await i(l),await o()}catch(u){u.type!=="aborted"&&fDe(u)}},source:t.signal!=null?Pn(s,t.signal):s,remoteAddr:n,timeline:{open:Date.now(),close:void 0},async close(){await i(async function*(){yield new Uint8Array(0)}()),await o()}};async function o(){return a.timeline.close==null&&(a.timeline.close=Date.now()),await Promise.resolve()}return a}c();var fu="/libp2p/circuit/relay/0.1.0";c();function vae(e){let t=new Map;async function r(s){let a=s.toString().split("/p2p-circuit").find(y=>y!==""),o=new j(a),l=o.getPeerId();if(l==null)throw new Error("Could not determine relay peer from multiaddr");let u=ue(l);await e.peerStore.addressBook.add(u,[o]);let h=await e.connectionManager.openConnection(u),f=h.remoteAddr.encapsulate("/p2p-circuit");t.set(h.remotePeer.toString(),f),i.dispatchEvent(new ee("listening"))}function n(){let s=[];for(let a of t.values())s.push(a);return s}let i=Object.assign(new Ue,{close:async()=>await Promise.resolve(),listen:r,getAddrs:n});return e.connectionManager.addEventListener("peer:disconnect",s=>{let{detail:a}=s;t.delete(a.remotePeer.toString())&&i.dispatchEvent(new ee("close"))}),i}c();var XP=w(K(),1);c();function Sae(e,t){e.write({type:rt.Type.STATUS,code:t})}function n_(e,t){try{e.dstPeer?.addrs!=null&&e.dstPeer.addrs.forEach(r=>new j(r))}catch(r){throw Sae(t,e.type===rt.Type.HOP?rt.Status.HOP_DST_MULTIADDR_INVALID:rt.Status.STOP_DST_MULTIADDR_INVALID),r}try{e.srcPeer?.addrs!=null&&e.srcPeer.addrs.forEach(r=>new j(r))}catch(r){throw Sae(t,e.type===rt.Type.HOP?rt.Status.HOP_SRC_MULTIADDR_INVALID:rt.Status.STOP_SRC_MULTIADDR_INVALID),r}}c(),c();var xae=w(ei(),1);function Io(e){let t=zs(),r=by(e.source),n=Ar(),i,s=e.sink(async function*(){yield*t,yield*await n.promise}());s.catch(o=>{i=o});let a={sink:async o=>i!=null?await Promise.reject(i):(n.resolve(o),await s),source:(0,xae.default)(r,o=>o.slice())};return{reader:r,writer:t,stream:a,rest:()=>t.end(),write:t.push,read:async()=>{let o=await r.next();if(o.value!=null)return o.value.slice()}}}var g3=C("libp2p:circuit:stream-handler"),hu=class{constructor(e){let{stream:t,maxLength:r=4096}=e;this.stream=t,this.shake=Io(this.stream),this.decoder=Er.fromReader(this.shake.reader,{maxDataLength:r})}async read(){let e=await this.decoder.next();if(e.value!=null){let t=rt.decode(e.value.slice());return g3("read message type",t.type),t}g3("read received no value, closing stream"),this.close()}write(e){g3("write message type %s",e.type),this.shake.write(kr.single(rt.encode(e)).slice())}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){g3("closing the stream"),this.rest().sink([]).catch(e=>{g3.error(e)})}};c();var w3=C("libp2p:circuit:stop");function Rae(e){let{connection:t,request:r,streamHandler:n}=e;try{n_(r,n)}catch(i){w3.error("invalid stop request via peer %p %o",t.remotePeer,i);return}return w3("stop request is valid"),n.write({type:rt.Type.STATUS,code:rt.Status.SUCCESS}),n.rest()}async function Aae(e){let{connection:t,request:r}=e,{stream:n}=await t.newStream([fu]);w3("starting stop request to %p",t.remotePeer);let i=new hu({stream:n});i.write(r);let s=await i.read();if(s==null){i.close();return}if(s.code===rt.Status.SUCCESS)return w3("stop request to %p was successful",t.remotePeer),i.rest();w3("stop request failed with code %d",s.code),i.close()}var ds=C("libp2p:circuit:hop");async function Tae(e){let{connection:t,request:r,streamHandler:n,circuit:i,connectionManager:s}=e;if(!i.hopEnabled())return ds("HOP request received but we are not acting as a relay"),n.end({type:rt.Type.STATUS,code:rt.Status.HOP_CANT_SPEAK_RELAY});try{n_(r,n)}catch(f){ds.error("invalid hop request via peer %p %o",t.remotePeer,f);return}if(r.dstPeer==null){ds("HOP request received but we do not receive a dstPeer");return}let a=Ir(r.dstPeer.id),o=s.getConnections(a);if(o.length===0&&!i.hopActive())return ds("HOP request received but we are not connected to the destination peer"),n.end({type:rt.Type.STATUS,code:rt.Status.HOP_NO_CONN_TO_DST});if(o.length===0)return ds("did not have connection to remote peer"),n.end({type:rt.Type.STATUS,code:rt.Status.HOP_NO_CONN_TO_DST});let l={type:rt.Type.STOP,dstPeer:r.dstPeer,srcPeer:r.srcPeer},u;try{ds("performing STOP request");let f=await Aae({connection:o[0],request:l});if(f==null)throw new Error("Could not stop");u=f}catch(f){ds.error(f);return}ds("hop request from %p is valid",t.remotePeer),n.write({type:rt.Type.STATUS,code:rt.Status.SUCCESS});let h=n.rest();return ds("creating related connections"),await Te(h,u,h)}async function Iae(e){let{connection:t,request:r}=e,{stream:n}=await t.newStream(fu),i=new hu({stream:n});i.write(r);let s=await i.read();if(s==null)throw(0,XP.default)(new Error("HOP request had no response"),q.ERR_HOP_REQUEST_FAILED);if(s.code===rt.Status.SUCCESS)return ds("hop request was successful"),i.rest();throw ds("hop request failed with code %d, closing stream",s.code),i.close(),(0,XP.default)(new Error(`HOP request failed with code "${s.code??"unknown"}"`),q.ERR_HOP_REQUEST_FAILED)}async function Cae(e){let{connection:t}=e,{stream:r}=await t.newStream(fu),n=new hu({stream:r});n.write({type:rt.Type.CAN_HOP});let i=await n.read();return await n.close(),!(i==null||i.code!==rt.Status.SUCCESS)}function Pae(e){let{connection:t,streamHandler:r,circuit:n}=e,i=n.hopEnabled();ds("can hop (%s) request from %p",i,t.remotePeer),r.end({type:rt.Type.STATUS,code:i?rt.Status.SUCCESS:rt.Status.HOP_CANT_SPEAK_RELAY})}var ps=C("libp2p:circuit"),i_=class{constructor(){this.components=new He}init(e){this.components=e,this.components.getRegistrar().handle(fu,t=>{this._onProtocol(t).catch(r=>{ps.error(r)})}).catch(t=>{ps.error(t)})}hopEnabled(){return!0}hopActive(){return!0}get[H1](){return!0}get[Symbol.toStringTag](){return"libp2p/circuit-relay-v1"}async _onProtocol(e){let{connection:t,stream:r}=e,n=new hu({stream:r}),i=await n.read();if(i==null){ps("request was invalid, could not read from stream"),n.write({type:rt.Type.STATUS,code:rt.Status.MALFORMED_MESSAGE}),n.close();return}let s;switch(i.type){case rt.Type.CAN_HOP:{ps("received CAN_HOP request from %p",t.remotePeer),await Pae({circuit:this,connection:t,streamHandler:n});break}case rt.Type.HOP:{ps("received HOP request from %p",t.remotePeer),s=await Tae({connection:t,request:i,streamHandler:n,circuit:this,connectionManager:this.components.getConnectionManager()});break}case rt.Type.STOP:{ps("received STOP request from %p",t.remotePeer),s=await Rae({connection:t,request:i,streamHandler:n});break}default:{ps("Request of type %s not supported",i.type),n.write({type:rt.Type.STATUS,code:rt.Status.MALFORMED_MESSAGE}),n.close();return}}if(s!=null){let a=new j(i.dstPeer.addrs[0]),o=new j(i.srcPeer.addrs[0]),l=QP({stream:s,remoteAddr:a,localAddr:o}),u=i.type===rt.Type.HOP?"relay":"inbound";ps("new %s connection %s",u,l.remoteAddr);let h=await this.components.getUpgrader().upgradeInbound(l);ps("%s connection %s upgraded",u,l.remoteAddr),this.handler!=null&&this.handler(h)}}async dial(e,t={}){let r=e.toString().split("/p2p-circuit"),n=new j(r[0]),i=new j(r[r.length-1]),s=n.getPeerId(),a=i.getPeerId();if(s==null||a==null){let f="Circuit relay dial failed as addresses did not have peer id";throw ps.error(f),(0,Dae.default)(new Error(f),q.ERR_RELAYED_DIAL)}let o=ue(s),l=ue(a),u=!1,h=this.components.getConnectionManager().getConnections(o)[0];h==null&&(await this.components.getPeerStore().addressBook.add(o,[n]),h=await this.components.getConnectionManager().openConnection(o,t),u=!0);try{let f=await Iae({connection:h,request:{type:rt.Type.HOP,srcPeer:{id:this.components.getPeerId().toBytes(),addrs:this.components.getAddressManager().getAddresses().map(v=>v.bytes)},dstPeer:{id:l.toBytes(),addrs:[new j(i).bytes]}}}),y=n.encapsulate(`/p2p-circuit/p2p/${this.components.getPeerId().toString()}`),p=QP({stream:f,remoteAddr:e,localAddr:y});return ps("new outbound connection %s",p.remoteAddr),await this.components.getUpgrader().upgradeOutbound(p)}catch(f){throw ps.error("Circuit relay dial failed",f),u&&await h.close(),f}}createListener(e){return this.handler=e.handler,vae({connectionManager:this.components.getConnectionManager(),peerStore:this.components.getPeerStore()})}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>_h.matches(t))}};c();var u_=w(OP(),1);c(),Re(),me(),c(),te(),vr();async function o_(e){let t=new TextEncoder().encode(e),r=await xe.digest(t);return I.createV0(r)}c();var ZP="hop_relay",JP="true",s_="/libp2p/relay",kae=w(ug(),1),Nae=w(Vs(),1),E3=C("libp2p:auto-relay"),pDe=()=>{},a_=class{constructor(e,t){this.components=e,this.addressSorter=t.addressSorter??W1,this.maxListeners=t.maxListeners??1,this.listenRelays=new Set,this.onError=t.onError??pDe,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this.components.getPeerStore().addEventListener("change:protocols",r=>{this._onProtocolChange(r).catch(n=>{E3.error(n)})}),this.components.getConnectionManager().addEventListener("peer:disconnect",this._onPeerDisconnected)}async _onProtocolChange(e){let{peerId:t,protocols:r}=e.detail,n=t.toString();if(r.find(i=>i===fu)==null){this.listenRelays.has(n)&&await this._removeListenRelay(n);return}if(!this.listenRelays.has(n))try{let i=this.components.getConnectionManager().getConnections(t);if(i.length===0)return;let s=i[0];if(s.remoteAddr.protoCodes().includes(290)){E3(`relayed connection to ${n} will not be used to hop on`);return}await Cae({connection:s})&&(await this.components.getPeerStore().metadataBook.setValue(t,ZP,U(JP)),await this._addListenRelay(s,n))}catch(i){this.onError(i)}}_onPeerDisconnected(e){let t=e.detail.remotePeer.toString();!this.listenRelays.has(t)||this._removeListenRelay(t).catch(r=>{E3.error(r)})}async _addListenRelay(e,t){try{if(this.listenRelays.size>=this.maxListeners)return;let r=await Te(await this.components.getPeerStore().addressBook.get(e.remotePeer),n=>(0,kae.default)(n,this.addressSorter),async n=>await(0,Nae.default)(n));(await Promise.all(r.map(async n=>{try{let i=n.multiaddr;return i.getPeerId()==null&&(i=i.encapsulate(`/p2p/${e.remotePeer.toString()}`)),i=i.encapsulate("/p2p-circuit"),await this.components.getTransportManager().listen([i]),!0}catch(i){E3.error("error listening on circuit address",i),this.onError(i)}return!1}))).includes(!0)&&this.listenRelays.add(t)}catch(r){this.onError(r),this.listenRelays.delete(t)}}async _removeListenRelay(e){this.listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this.listenRelays.size>=this.maxListeners)return;let t=[],r=await this.components.getPeerStore().all();for(let{id:n,metadata:i}of r){let s=n.toString();if(this.listenRelays.has(s)||e.includes(s))continue;let a=i.get(ZP);if(a==null||M(a)!==JP)continue;let o=this.components.getConnectionManager().getConnections(n);if(o.length===0){t.push(n);continue}if(await this._addListenRelay(o[0],s),this.listenRelays.size>=this.maxListeners)return}for(let n of t)if(await this._tryToListenOnRelay(n),this.listenRelays.size>=this.maxListeners)return;try{let n=await o_(s_);for await(let i of this.components.getContentRouting().findProviders(n)){if(i.multiaddrs.length===0)continue;let s=i.id;if(await this.components.getPeerStore().addressBook.add(s,i.multiaddrs),await this._tryToListenOnRelay(s),this.listenRelays.size>=this.maxListeners)return}}catch(n){this.onError(n)}}async _tryToListenOnRelay(e){try{let t=await this.components.getConnectionManager().openConnection(e);await this._addListenRelay(t,e.toString())}catch(t){E3.error("Could not use %p as relay",e,t),this.onError(t,`could not connect and listen on known hop relay ${e.toString()}`)}}},Oae=C("libp2p:relay"),c_=class{constructor(e,t){this.components=e,this.autoRelay=t.autoRelay?.enabled!==!1?new a_(e,{addressSorter:t.addressSorter,...t.autoRelay}):void 0,this.started=!1,this.init=t,this._advertiseService=this._advertiseService.bind(this)}isStarted(){return this.started}async start(){this.init.hop.enabled!==!1&&this.init.advertise.enabled!==!1&&(this.timeout=(0,u_.setDelayedInterval)(this._advertiseService,this.init.advertise.ttl,this.init.advertise.bootDelay)),this.started=!0}async stop(){this.timeout!=null&&(0,u_.clearDelayedInterval)(this.timeout),this.started=!1}async _advertiseService(){try{let e=await o_(s_);await this.components.getContentRouting().provide(e)}catch(e){e.code===q.ERR_NO_ROUTERS_AVAILABLE?(Oae.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),await this.stop()):Oae.error(e)}}};c();var yce=w(zae(),1);c();var D7t=w(ace(),1),k7t=w(i6(),1),du=w(st(),1);c();var C7t=w(tD(),1),uce=w(st(),1),cce=uce.default.pki,lce=(e,t)=>{let r=cce.rsa.setPublicKey(t.n,t.e),n=cce.createCertificate();n.publicKey=r,n.serialNumber="01",n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+10);let i=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:e.id}];return n.setSubject(i),n.setIssuer(i),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(t),n};async function fce(e,t){let r=e.map(t),n=(await Promise.all(r)).findIndex(i=>i);return e[n]}var pu=w(K(),1);Re(),me();var HDe=C("libp2p:keychain:cms"),iD=new WeakMap,d_=class{constructor(e,t){if(e==null)throw(0,pu.default)(new Error("keychain is required"),q.ERR_KEYCHAIN_REQUIRED);this.keychain=e,iD.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw(0,pu.default)(new Error("Plain data must be a Uint8Array"),q.ERR_INVALID_PARAMETERS);let r=await this.keychain.findKeyByName(e),n=await this.keychain.getPrivateKey(e),i=iD.get(this);if(i==null)throw(0,pu.default)(new Error("dek missing"),q.ERR_INVALID_PARAMETERS);let s=i.dek,a=du.default.pki.decryptRsaPrivateKey(n,s),o=await lce(r,a),l=du.default.pkcs7.createEnvelopedData();l.addRecipient(o),l.content=du.default.util.createBuffer(t),l.encrypt();let u=du.default.asn1.toDer(l.toAsn1()).getBytes();return U(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw(0,pu.default)(new Error("CMS data is required"),q.ERR_INVALID_PARAMETERS);let t;try{let u=du.default.util.createBuffer(M(e,"ascii")),h=du.default.asn1.fromDer(u);t=du.default.pkcs7.messageFromAsn1(h)}catch(u){throw HDe.error(u),(0,pu.default)(new Error("Invalid CMS"),q.ERR_INVALID_CMS)}let r=t.recipients.filter(u=>u.issuer.find(h=>h.shortName==="O"&&h.value==="ipfs")).filter(u=>u.issuer.find(h=>h.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(h=>h.shortName==="CN").value})),n=await fce(r,async u=>{try{if(await this.keychain.findKeyById(u.keyId)!=null)return!0}catch{return!1}return!1});if(n==null){let u=r.map(h=>h.keyId);throw(0,pu.default)(new Error(`Decryption needs one of the key(s): ${u.join(", ")}`),q.ERR_MISSING_KEYS,{missingKeys:u})}let i=await this.keychain.findKeyById(n.keyId);if(i==null)throw(0,pu.default)(new Error("No key available to decrypto"),q.ERR_NO_KEY);let s=await this.keychain.getPrivateKey(i.name),a=iD.get(this);if(a==null)throw(0,pu.default)(new Error("dek missing"),q.ERR_INVALID_PARAMETERS);let o=a.dek,l=du.default.pki.decryptRsaPrivateKey(s,o);return t.decrypt(n.recipient,l),U(t.content.getBytes(),"ascii")}},Gt=w(K(),1);me(),Re(),c(),c(),c();var F7t=w(jp(),1),$De=w(st(),1);me(),Re(),c();var WDe=w(K(),1);c();var dce=w(vx(),1),pce=w(gr(),1),mce=w(K(),1),hce={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function b3(e,t,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let o=Object.keys(hce).join(" / ");throw(0,mce.default)(new Error(`Hash '${i}' is unknown or not supported. Must be ${o}`),"ERR_UNSUPPORTED_HASH_TYPE")}let s=hce[i],a=(0,dce.default)(e,t,r,n,s);return pce.default.encode64(a,null)}var p_=C("libp2p:keychain"),YDe="/pkcs8/",gce="/info/",mf=new WeakMap,Pd={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},oD={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function mu(e){return e==null||typeof e!="string"?!1:e===(0,yce.default)(e.trim())&&e.length>0}async function pr(){let e=Math.random()*800+200;await new Promise(t=>setTimeout(t,e))}function oc(e){return new ae(YDe+e)}function yf(e){return new ae(gce+e)}var _3=class{constructor(e,t){if(this.components=e,this.init=Ze(oD,t),this.init.pass!=null&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(this.init.dek?.keyLength!=null&&this.init.dek.keyLength<Pd.minKeyLength)throw new Error(`dek.keyLength must be least ${Pd.minKeyLength} bytes`);if(this.init.dek?.salt?.length!=null&&this.init.dek.salt.length<Pd.minSaltLength)throw new Error(`dek.saltLength must be least ${Pd.minSaltLength} bytes`);if(this.init.dek?.iterationCount!=null&&this.init.dek.iterationCount<Pd.minIterationCount)throw new Error(`dek.iterationCount must be least ${Pd.minIterationCount}`);let r=this.init.pass!=null&&this.init.dek?.salt!=null?b3(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";mf.set(this,{dek:r})}get cms(){let e=mf.get(this);if(e==null)throw(0,Gt.default)(new Error("dek missing"),q.ERR_INVALID_PARAMETERS);let t=e.dek;return new d_(this,t)}static generateOptions(){let e=Object.assign({},oD),t=Math.ceil(Pd.minSaltLength/3)*3;return e.dek.salt=M(Fs(t),"base64"),e}static get options(){return oD}async createKey(e,t,r=2048){if(!mu(e)||e==="self")throw await pr(),(0,Gt.default)(new Error("Invalid key name"),q.ERR_INVALID_KEY_NAME);if(typeof t!="string")throw await pr(),(0,Gt.default)(new Error("Invalid key type"),q.ERR_INVALID_KEY_TYPE);let n=oc(e);if(await this.components.getDatastore().has(n))throw await pr(),(0,Gt.default)(new Error("Key name already exists"),q.ERR_KEY_ALREADY_EXISTS);switch(t.toLowerCase()){case"rsa":if(!Number.isSafeInteger(r)||r<2048)throw await pr(),(0,Gt.default)(new Error("Invalid RSA key size"),q.ERR_INVALID_KEY_SIZE);break;default:break}let i;try{let s=await sR(t,r),a=await s.id(),o=mf.get(this);if(o==null)throw(0,Gt.default)(new Error("dek missing"),q.ERR_INVALID_PARAMETERS);let l=o.dek,u=await s.export(l);i={name:e,id:a};let h=this.components.getDatastore().batch();h.put(n,U(u)),h.put(yf(e),U(JSON.stringify(i))),await h.commit()}catch(s){throw await pr(),s}return i}async listKeys(){let e={prefix:gce},t=[];for await(let r of this.components.getDatastore().query(e))t.push(JSON.parse(M(r.value)));return t}async findKeyById(e){try{return(await this.listKeys()).find(t=>t.id===e)}catch(t){throw await pr(),t}}async findKeyByName(e){if(!mu(e))throw await pr(),(0,Gt.default)(new Error(`Invalid key name '${e}'`),q.ERR_INVALID_KEY_NAME);let t=yf(e);try{let r=await this.components.getDatastore().get(t);return JSON.parse(M(r))}catch(r){throw await pr(),p_.error(r),(0,Gt.default)(new Error(`Key '${e}' does not exist.`),q.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!mu(e)||e==="self")throw await pr(),(0,Gt.default)(new Error(`Invalid key name '${e}'`),q.ERR_INVALID_KEY_NAME);let t=oc(e),r=await this.findKeyByName(e),n=this.components.getDatastore().batch();return n.delete(t),n.delete(yf(e)),await n.commit(),r}async renameKey(e,t){if(!mu(e)||e==="self")throw await pr(),(0,Gt.default)(new Error(`Invalid old key name '${e}'`),q.ERR_OLD_KEY_NAME_INVALID);if(!mu(t)||t==="self")throw await pr(),(0,Gt.default)(new Error(`Invalid new key name '${t}'`),q.ERR_NEW_KEY_NAME_INVALID);let r=oc(e),n=oc(t),i=yf(e),s=yf(t);if(await this.components.getDatastore().has(n))throw await pr(),(0,Gt.default)(new Error(`Key '${t}' already exists`),q.ERR_KEY_ALREADY_EXISTS);try{let a=await this.components.getDatastore().get(r),o=await this.components.getDatastore().get(i),l=JSON.parse(M(o));l.name=t;let u=this.components.getDatastore().batch();return u.put(n,a),u.put(s,U(JSON.stringify(l))),u.delete(r),u.delete(i),await u.commit(),l}catch(a){throw await pr(),a}}async exportKey(e,t){if(!mu(e))throw await pr(),(0,Gt.default)(new Error(`Invalid key name '${e}'`),q.ERR_INVALID_KEY_NAME);if(t==null)throw await pr(),(0,Gt.default)(new Error("Password is required"),q.ERR_PASSWORD_REQUIRED);let r=oc(e);try{let n=await this.components.getDatastore().get(r),i=M(n),s=mf.get(this);if(s==null)throw(0,Gt.default)(new Error("dek missing"),q.ERR_INVALID_PARAMETERS);let a=s.dek;return await(await Mc(i,a)).export(t)}catch(n){throw await pr(),n}}async importKey(e,t,r){if(!mu(e)||e==="self")throw await pr(),(0,Gt.default)(new Error(`Invalid key name '${e}'`),q.ERR_INVALID_KEY_NAME);if(t==null)throw await pr(),(0,Gt.default)(new Error("PEM encoded key is required"),q.ERR_PEM_REQUIRED);let n=oc(e);if(await this.components.getDatastore().has(n))throw await pr(),(0,Gt.default)(new Error(`Key '${e}' already exists`),q.ERR_KEY_ALREADY_EXISTS);let i;try{i=await Mc(t,r)}catch{throw await pr(),(0,Gt.default)(new Error("Cannot read the key, most likely the password is wrong"),q.ERR_CANNOT_READ_KEY)}let s;try{s=await i.id();let l=mf.get(this);if(l==null)throw(0,Gt.default)(new Error("dek missing"),q.ERR_INVALID_PARAMETERS);let u=l.dek;t=await i.export(u)}catch(l){throw await pr(),l}let a={name:e,id:s},o=this.components.getDatastore().batch();return o.put(n,U(t)),o.put(yf(e),U(JSON.stringify(a))),await o.commit(),a}async importPeer(e,t){try{if(!mu(e))throw(0,Gt.default)(new Error(`Invalid key name '${e}'`),q.ERR_INVALID_KEY_NAME);if(t==null||t.privateKey==null)throw(0,Gt.default)(new Error("Peer.privKey is required"),q.ERR_MISSING_PRIVATE_KEY);let r=await Jn(t.privateKey),n=oc(e);if(await this.components.getDatastore().has(n))throw await pr(),(0,Gt.default)(new Error(`Key '${e}' already exists`),q.ERR_KEY_ALREADY_EXISTS);let i=mf.get(this);if(i==null)throw(0,Gt.default)(new Error("dek missing"),q.ERR_INVALID_PARAMETERS);let s=i.dek,a=await r.export(s),o={name:e,id:t.toString()},l=this.components.getDatastore().batch();return l.put(n,U(a)),l.put(yf(e),U(JSON.stringify(o))),await l.commit(),o}catch(r){throw await pr(),r}}async getPrivateKey(e){if(!mu(e))throw await pr(),(0,Gt.default)(new Error(`Invalid key name '${e}'`),q.ERR_INVALID_KEY_NAME);try{let t=oc(e),r=await this.components.getDatastore().get(t);return M(r)}catch(t){throw await pr(),p_.error(t),(0,Gt.default)(new Error(`Key '${e}' does not exist.`),q.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,t){if(typeof e!="string")throw await pr(),(0,Gt.default)(new Error(`Invalid old pass type '${typeof e}'`),q.ERR_INVALID_OLD_PASS_TYPE);if(typeof t!="string")throw await pr(),(0,Gt.default)(new Error(`Invalid new pass type '${typeof t}'`),q.ERR_INVALID_NEW_PASS_TYPE);if(t.length<20)throw await pr(),(0,Gt.default)(new Error(`Invalid pass length ${t.length}`),q.ERR_INVALID_PASS_LENGTH);p_("recreating keychain");let r=mf.get(this);if(r==null)throw(0,Gt.default)(new Error("dek missing"),q.ERR_INVALID_PARAMETERS);let n=r.dek;this.init.pass=t;let i=t!=null&&this.init.dek?.salt!=null?b3(t,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";mf.set(this,{dek:i});let s=await this.listKeys();for(let a of s){let o=await this.components.getDatastore().get(oc(a.name)),l=M(o),u=await Mc(l,n),h=i.toString(),f=await u.export(h),y=this.components.getDatastore().batch(),p={name:a.name,id:a.id};y.put(oc(a.name),U(f)),y.put(yf(a.name),U(JSON.stringify(p))),await y.commit()}p_("keychain reconstructed")}};c();var uD=w(sD(),1),bce=w(Mp(),1);c(),c();var aD=class{constructor(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");this.timespan=e,this.movingAverage=0,this.variance=0,this.deviation=0,this.forecast=0}alpha(e,t){return 1-Math.exp(-(e-t)/this.timespan)}push(e,t){if(this.previousTime!=null){let r=this.alpha(e,this.previousTime),n=t-this.movingAverage,i=r*n;this.movingAverage=r*t+(1-r)*this.movingAverage,this.variance=(1-r)*(this.variance+n*i),this.deviation=Math.sqrt(this.variance),this.forecast=this.movingAverage+r*n}else this.movingAverage=t;this.previousTime=e}};function cD(e){return new aD(e)}var Ece=w(y2(),1),Z1=class extends Ue{constructor(e){super(),this.enabled=e.enabled,this.queue=[],this.stats={dataReceived:0n,dataSent:0n},this.frequencyLastTime=Date.now(),this.frequencyAccumulators={},this.movingAverages={dataReceived:[],dataSent:[]},this.computeThrottleMaxQueueSize=e.computeThrottleMaxQueueSize,this.computeThrottleTimeout=e.computeThrottleTimeout,this._update=this._update.bind(this),this.movingAverageIntervals=e.movingAverageIntervals;for(let t=0;t<e.initialCounters.length;t++){let r=e.initialCounters[t];this.stats[r]=0n,this.movingAverages[r]=[];for(let n=0;n<this.movingAverageIntervals.length;n++){let i=this.movingAverageIntervals[n];(this.movingAverages[r][i]=cD(i)).push(this.frequencyLastTime,0)}}}start(){!this.enabled||this.queue.length>0&&this._resetComputeTimeout()}stop(){this.timeout!=null&&(this.timeout.clear(),this.timeout=null)}getSnapshot(){return Object.assign({},this.stats)}getMovingAverages(){return Object.assign({},this.movingAverages)}push(e,t){this.queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this.timeout=(0,Ece.default)(this._update,this._nextTimeout())}_nextTimeout(){let e=this.queue.length/this.computeThrottleMaxQueueSize;return Math.max(this.computeThrottleTimeout*(1-e),0)}_update(){if(this.timeout=null,this.queue.length>0){let e=["",0,0];for(e of this.queue)this._applyOp(e);this.queue=[],e.length>2&&e[0]!==""&&this._updateFrequency(e[2]),this.dispatchEvent(new ee("update",{detail:this.stats}))}}_updateFrequency(e){let t=e-this.frequencyLastTime;this._updateFrequencyFor("dataReceived",t,e),this._updateFrequencyFor("dataSent",t,e),this.frequencyLastTime=e}_updateFrequencyFor(e,t,r){let n=this.frequencyAccumulators[e]??0;this.frequencyAccumulators[e]=0;let i=n/(t??1)*1e3,s=this.movingAverages[e];s==null&&(s=this.movingAverages[e]=[]);let a=this.movingAverageIntervals;for(let o=0;o<a.length;o++){let l=a[o],u=s[l];u==null&&(u=s[l]=cD(l)),u.push(r,i)}}_applyOp(e){let t=e[0],r=e[1];if(typeof r!="number")throw new Error("invalid increment number");let n;Object.prototype.hasOwnProperty.call(this.stats,t)?n=this.stats[t]:n=this.stats[t]=0n,this.stats[t]=n+BigInt(r),this.frequencyAccumulators[t]==null&&(this.frequencyAccumulators[t]=0),this.frequencyAccumulators[t]+=r}},XDe=["dataReceived","dataSent"],ZDe={in:"dataReceived",out:"dataSent"},m_=class{constructor(e){this.enabled=e.enabled,this.statsInit={...e,initialCounters:XDe},this.globalStats=new Z1(this.statsInit),this.peerStats=new Map,this.protocolStats=new Map,this.oldPeers=(0,bce.default)(e.maxOldPeersRetention??cae.maxOldPeersRetention),this.running=!1,this._onMessage=this._onMessage.bind(this),this.systems=new Map}isStarted(){return this.running}async start(){!this.enabled||(this.running=!0)}async stop(){if(this.running){this.running=!1,this.globalStats.stop();for(let e of this.peerStats.values())e.stop();for(let e of this.protocolStats.values())e.stop()}}getGlobal(){return this.globalStats}getPeers(){return Array.from(this.peerStats.keys())}getComponentMetrics(){return this.systems}updateComponentMetric(e){let{system:t="libp2p",component:r,metric:n,value:i}=e;this.systems.has(t)||this.systems.set(t,new Map);let s=this.systems.get(t);if(s==null)throw new Error("Unknown metric system");s.has(r)||s.set(r,new Map);let a=s.get(r);if(a==null)throw new Error("Unknown metric component");a.set(n,i)}forPeer(e){let t=e.toString();return this.peerStats.get(t)??this.oldPeers.get(t)}getProtocols(){return Array.from(this.protocolStats.keys())}forProtocol(e){return this.protocolStats.get(e)}onPeerDisconnected(e){let t=e.toString(),r=this.peerStats.get(t);r!=null&&(r.stop(),this.peerStats.delete(t),this.oldPeers.set(t,r))}_onMessage(e){if(!this.running)return;let{remotePeer:t,protocol:r,direction:n,dataLength:i}=e,s=ZDe[n],a=this.forPeer(t);if(a==null){let o=new Z1(this.statsInit);this.peerStats.set(t.toString(),o),a=o}if(a.push(s,i),this.globalStats.push(s,i),r!=null){let o=this.forProtocol(r);if(o==null){let l=new Z1(this.statsInit);this.protocolStats.set(r,l),o=l}o.push(s,i)}}updatePlaceholder(e,t){if(!this.running)return;let r=e.toString(),n=this.peerStats.get(r)??this.oldPeers.get(r),i=t.toString(),s=this.peerStats.get(i)??this.oldPeers.get(i),a=n;s!=null&&(a=JDe(s,a),this.oldPeers.remove(i)),this.peerStats.delete(e.toString()),this.peerStats.set(i,a),a.start()}trackStream(e){let{stream:t,remotePeer:r,protocol:n}=e;if(!this.running)return t;let i=t.source;t.source=(0,uD.default)(i,a=>this._onMessage({remotePeer:r,protocol:n,direction:"in",dataLength:a.length}));let s=t.sink;return t.sink=async a=>await Te(a,o=>(0,uD.default)(o,l=>{this._onMessage({remotePeer:r,protocol:n,direction:"out",dataLength:l.length})}),s),t}};function JDe(e,t){return e.stop(),t.stop(),e.queue=[...e.queue,...t.queue],e}c(),c(),c();async function v3(e){try{let t=await e;return{isFulfilled:!0,isRejected:!1,value:t}}catch(t){return{isFulfilled:!1,isRejected:!0,reason:t}}}c(),c();var lD=class{value;next;constructor(e){this.value=e}},S3=class{#e;#t;#r;constructor(){this.clear()}enqueue(e){let t=new lD(e);this.#e?(this.#t.next=t,this.#t=t):(this.#e=t,this.#t=t),this.#r++}dequeue(){let e=this.#e;if(e)return this.#e=this.#e.next,this.#r--,e.value}clear(){this.#e=void 0,this.#t=void 0,this.#r=0}get size(){return this.#r}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}};function fD(e){if(!((Number.isInteger(e)||e===Number.POSITIVE_INFINITY)&&e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");let t=new S3,r=0,n=()=>{r--,t.size>0&&t.dequeue()()},i=async(o,l,u)=>{r++;let h=(async()=>o(...u))();l(h);try{await h}catch{}n()},s=(o,l,u)=>{t.enqueue(i.bind(void 0,o,l,u)),(async()=>(await Promise.resolve(),r<e&&t.size>0&&t.dequeue()()))()},a=(o,...l)=>new Promise(u=>{s(o,u,l)});return Object.defineProperties(a,{activeCount:{get:()=>r},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),a}async function hD(e,t={}){let{concurrency:r=Number.POSITIVE_INFINITY}=t,n=fD(r);return Promise.all(e.map(i=>i&&typeof i.then=="function"?v3(i):v3(typeof i=="function"?n(()=>i()):Promise.resolve(i))))}var J1=w(K(),1),Dd=C("libp2p:transports"),y_=class extends Ue{constructor(e,t={}){super(),this.components=e,this.started=!1,this.transports=new Map,this.listeners=Dn({component:"transport-manager",metric:"listeners",metrics:this.components.getMetrics()}),this.faultTolerance=t.faultTolerance??kd.FATAL_ALL}add(e){let t=e[Symbol.toStringTag];if(t==null)throw(0,J1.default)(new Error("Transport must have a valid tag"),q.ERR_INVALID_KEY);if(this.transports.has(t))throw(0,J1.default)(new Error("There is already a transport with this tag"),q.ERR_DUPLICATE_TRANSPORT);Dd("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}async start(){let e=this.components.getAddressManager().getListenAddrs();await this.listen(e),this.started=!0}async stop(){let e=[];for(let[t,r]of this.listeners)for(Dd("closing listeners for %s",t);r.length>0;){let n=r.pop();n!=null&&e.push(n.close())}await Promise.all(e),Dd("all listeners closed");for(let t of this.listeners.keys())this.listeners.set(t,[]);this.started=!1}async dial(e,t){let r=this.transportForMultiaddr(e);if(r==null)throw(0,J1.default)(new Error(`No transport available for address ${String(e)}`),q.ERR_TRANSPORT_UNAVAILABLE);try{return await r.dial(e,{...t,upgrader:this.components.getUpgrader()})}catch(n){throw n.code==null&&(n.code=q.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let e=[];for(let t of this.listeners.values())for(let r of t)e=[...e,...r.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}transportForMultiaddr(e){for(let t of this.transports.values())if(t.filter([e]).length>0)return t}async listen(e){if(e==null||e.length===0){Dd("no addresses were provided for listening, this node is dial only");return}let t=[];for(let[r,n]of this.transports.entries()){let i=n.filter(e),s=[];for(let a of i){Dd("creating listener for %s on %s",r,a);let o=n.createListener({upgrader:this.components.getUpgrader()}),l=this.listeners.get(r);l==null&&(l=[],this.listeners.set(r,l)),l.push(o),o.addEventListener("listening",()=>{this.dispatchEvent(new ee("listener:listening",{detail:o}))}),o.addEventListener("close",()=>{this.dispatchEvent(new ee("listener:close",{detail:o}))}),s.push(o.listen(a))}if(s.length===0){t.push(r);continue}if((await hD(s)).find(a=>a.isFulfilled)==null&&this.faultTolerance!==kd.NO_FATAL)throw(0,J1.default)(new Error(`Transport (${r}) could not listen on any available address`),q.ERR_NO_VALID_ADDRESSES)}if(t.length===this.transports.size){let r=`no valid addresses were provided for transports [${t.join(", ")}]`;if(this.faultTolerance===kd.FATAL_ALL)throw(0,J1.default)(new Error(r),q.ERR_NO_VALID_ADDRESSES);Dd(`libp2p in dial mode only: ${r}`)}}async remove(e){Dd("removing %s",e);for(let t of this.listeners.get(e)??[])await t.close();this.transports.delete(e),this.listeners.delete(e)}async removeAll(){let e=[];for(let t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}},kd;(function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"})(kd||(kd={})),c();var Oi=w(K(),1);c(),c();var xce=w(K(),1);c();var dD=w(K(),1);Re();var _ce=w(Gc(),1);me();var vce=U(`
`);function g_(e){let t=new qe(e,vce);return kr.single(t).slice()}function sc(e,t){e.push(g_(t).slice())}function Sce(e,t){let r=new qe;for(let n of t)r.append(g_(n));e.push(r.slice())}async function pD(e,t){let r=1,n={[Symbol.asyncIterator]:()=>n,next:async()=>await e.next(r)},i=n;t?.signal!=null&&(i=Pn(n,t.signal));let s=await Te(i,Er({onLength:a=>{r=a}}),async a=>await(0,_ce.default)(a));if(s==null)throw(0,dD.default)(new Error("no buffer returned"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(s[s.length-1]!==vce[0])throw(0,dD.default)(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return s.slice(0,-1)}async function em(e,t){let r=await pD(e,t);return M(r)}Re();var tm=C("libp2p:mss:select");async function yD(e,t,r,n){t=Array.isArray(t)?[...t]:[t];let{reader:i,writer:s,rest:a,stream:o}=Io(e),l=t.shift();if(l==null)throw new Error("At least one protocol must be specified");r!=null?(tm('select: write ["%s", "%s"]',r,l),Sce(s,[U(r),U(l)])):(tm('select: write "%s"',l),sc(s,U(l)));let u=await em(i,n);if(tm('select: read "%s"',u),u===r&&(u=await em(i,n),tm('select: read "%s"',u)),u===l)return a(),{stream:o,protocol:l};for(let h of t){tm('select: write "%s"',h),sc(s,U(h));let f=await em(i,n);if(tm('select: read "%s" for "%s"',f,h),f===h)return a(),{stream:o,protocol:h}}throw a(),(0,xce.default)(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}c(),c();var Nd="/multistream/1.0.0";Re();var x3=C("libp2p:mss:handle");async function Rce(e,t,r){t=Array.isArray(t)?t:[t];let{writer:n,reader:i,rest:s,stream:a}=Io(e);for(;;){let o=await em(i,r);if(x3('read "%s"',o),o===Nd){x3('respond with "%s" for "%s"',Nd,o),sc(n,U(Nd));continue}if(t.includes(o))return sc(n,U(o)),x3('respond with "%s" for "%s"',o,o),s(),{stream:a,protocol:o};if(o==="ls"){sc(n,new qe(...t.map(l=>g_(U(l))))),x3('respond with "%s" for %s',t,o);continue}sc(n,U("na")),x3('respond with "na" for "%s"',o)}}c(),me(),Re();var eke=C("libp2p:mss:ls");async function Ace(e,t){let{reader:r,writer:n,rest:i,stream:s}=Io(e);eke('write "ls"'),sc(n,U("ls")),i();let a=await pD(r,t),o=by([a]),l=[];return await Te(o,Er(),async u=>{for await(let h of u)l.push(M(h.slice(0,-1)))}),{stream:s,protocols:l}}var w_=class{constructor(e){this.stream=e,this.shaken=!1}async _handshake(e){if(this.shaken)return;let{stream:t}=await yD(this.stream,Nd,void 0,e);this.stream=t,this.shaken=!0}},rm=class extends w_{async select(e,t){return await yD(this.stream,e,this.shaken?void 0:Nd,t)}async ls(e){await this._handshake(e);let t=await Ace(this.stream,e),{stream:r,protocols:n}=t;return this.stream=r,n}},nm=class extends w_{async handle(e,t){return await Rce(this.stream,e,t)}},ED=w(Ice(),1);c();var gD=w(K(),1);c();var Cce=Symbol.for("@libp2p/connection"),rke=C("libp2p:connection"),wD=class{constructor(e){let{remoteAddr:t,remotePeer:r,newStream:n,close:i,getStreams:s,stat:a}=e;this.id=`${parseInt(String(Math.random()*1e9)).toString(36)}${Date.now()}`,this.remoteAddr=t,this.remotePeer=r,this.stat={...a,status:jb},this._newStream=n,this._close=i,this._getStreams=s,this.registry=new Map,this.tags=[],this._closing=!1}get[Symbol.toStringTag](){return"Connection"}get[Cce](){return!0}get streams(){return this._getStreams()}async newStream(e,t){if(this.stat.status===UP)throw(0,gD.default)(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===Yb)throw(0,gD.default)(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:r,protocol:n}=await this._newStream(e,t);return this.addStream(r,{protocol:n,metadata:{}}),{stream:r,protocol:n}}addStream(e,t={}){this.registry.set(e.id,{protocol:t.protocol??"",metadata:t.metadata??{}})}removeStream(e){this.registry.delete(e)}async close(){if(!(this.stat.status===Yb||this._closing)){this.stat.status=UP;try{this.streams.forEach(e=>e.close())}catch(e){rke.error(e)}this._closing=!0,await this._close(),this._closing=!1,this.stat.timeline.close=Date.now(),this.stat.status=Yb}}};function Pce(e){return new wD(e)}var qr=C("libp2p:upgrader"),E_=class extends Ue{constructor(e,t){super(),this.components=e,this.connectionEncryption=new Map,t.connectionEncryption.forEach(r=>{this.connectionEncryption.set(r.protocol,r)}),this.muxers=new Map,t.muxers.forEach(r=>{this.muxers.set(r.protocol,r)})}async upgradeInbound(e){let t,r,n,i,s,a,o,l=this.components.getMetrics();if(await this.components.getConnectionGater().denyInboundConnection(e))throw(0,Oi.default)(new Error("The multiaddr connection is blocked by gater.acceptConnection"),q.ERR_CONNECTION_INTERCEPTED);if(l!=null){({setTarget:a,proxy:o}=(0,ED.default)());let f=`${(Math.random()*1e9).toString(36)}${Date.now()}`;a({toString:()=>f}),e=l.trackStream({stream:e,remotePeer:o})}qr("starting the inbound connection upgrade");let u=e,h=this.components.getConnectionProtector();h!=null&&(qr("protecting the inbound connection"),u=await h.protect(e));try{if({conn:t,remotePeer:r,protocol:s}=await this._encryptInbound(u),await this.components.getConnectionGater().denyInboundEncryptedConnection(r,{...u,...t}))throw(0,Oi.default)(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),q.ERR_CONNECTION_INTERCEPTED);if(this.muxers.size>0){let f=await this._multiplexInbound({...u,...t},this.muxers);i=f.muxerFactory,n=f.stream}else n=t}catch(f){throw qr.error("Failed to upgrade inbound connection",f),await e.close(f),f}if(await this.components.getConnectionGater().denyInboundUpgradedConnection(r,{...u,...t}))throw(0,Oi.default)(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),q.ERR_CONNECTION_INTERCEPTED);return l!=null&&(l.updatePlaceholder(o,r),a(r)),qr("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:s,direction:"inbound",maConn:e,upgradedConn:n,muxerFactory:i,remotePeer:r})}async upgradeOutbound(e){let t=e.remoteAddr.getPeerId();if(t==null)throw(0,Oi.default)(new Error("outbound connection must have a peer id"),q.ERR_INVALID_MULTIADDR);let r=ue(t);if(await this.components.getConnectionGater().denyOutboundConnection(r,e))throw(0,Oi.default)(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),q.ERR_CONNECTION_INTERCEPTED);let n,i,s,a,o,l,u,h=this.components.getMetrics();if(h!=null){({setTarget:l,proxy:u}=(0,ED.default)());let p=`${(Math.random()*1e9).toString(36)}${Date.now()}`;l({toB58String:()=>p}),e=h.trackStream({stream:e,remotePeer:u})}qr("Starting the outbound connection upgrade");let f=e,y=this.components.getConnectionProtector();y!=null&&(f=await y.protect(e));try{if({conn:n,remotePeer:i,protocol:a}=await this._encryptOutbound(f,r),await this.components.getConnectionGater().denyOutboundEncryptedConnection(i,{...f,...n}))throw(0,Oi.default)(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),q.ERR_CONNECTION_INTERCEPTED);if(this.muxers.size>0){let p=await this._multiplexOutbound({...f,...n},this.muxers);o=p.muxerFactory,s=p.stream}else s=n}catch(p){throw qr.error("Failed to upgrade outbound connection",p),await e.close(p),p}if(await this.components.getConnectionGater().denyOutboundUpgradedConnection(i,{...f,...n}))throw(0,Oi.default)(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),q.ERR_CONNECTION_INTERCEPTED);return h!=null&&(h.updatePlaceholder(u,i),l(i)),qr("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:s,muxerFactory:o,remotePeer:i})}_createConnection(e){let{cryptoProtocol:t,direction:r,maConn:n,upgradedConn:i,remotePeer:s,muxerFactory:a}=e,o,l,u;a!=null&&(o=a.createStreamMuxer(this.components,{onIncomingStream:y=>{u!=null&&Promise.resolve().then(async()=>{let p=new nm(y),v=this.components.getRegistrar().getProtocols(),{stream:d,protocol:g}=await p.handle(v);qr("%s: incoming stream opened on %s",r,g),this.components.getMetrics()?.trackStream({stream:d,remotePeer:s,protocol:g}),u!=null&&(u.addStream(y,{protocol:g}),this._onStream({connection:u,stream:{...y,...d},protocol:g}))}).catch(p=>{qr.error(p),y.timeline.close==null&&y.close()})},onStreamEnd:y=>{u?.removeStream(y.id)}}),l=async(y,p={})=>{if(o==null)throw(0,Oi.default)(new Error("Stream is not multiplexed"),q.ERR_MUXER_UNAVAILABLE);qr("%s: starting new stream on %s",r,y);let v=o.newStream(),d=new rm(v),g=this.components.getMetrics();try{let{stream:b,protocol:_}=await d.select(y,p);return g!=null&&(b=g.trackStream({stream:b,remotePeer:s,protocol:_})),{stream:{...v,...b},protocol:_}}catch(b){throw qr.error("could not create new stream",b),v.timeline.close==null&&v.close(),b.code!=null?b:(0,Oi.default)(b,q.ERR_UNSUPPORTED_PROTOCOL)}},Te(i,o,i).catch(qr.error));let h=n.timeline;n.timeline=new Proxy(h,{set:(...y)=>(u!=null&&y[1]==="close"&&y[2]!=null&&h.close==null&&(async()=>{try{u.stat.status==="OPEN"&&await u.close()}catch(p){qr.error(p)}finally{this.dispatchEvent(new ee("connectionEnd",{detail:u}))}})().catch(p=>{qr.error(p)}),Reflect.set(...y))}),n.timeline.upgraded=Date.now();let f=()=>{throw(0,Oi.default)(new Error("connection is not multiplexed"),q.ERR_CONNECTION_NOT_MULTIPLEXED)};return u=Pce({remoteAddr:n.remoteAddr,remotePeer:s,stat:{status:"OPEN",direction:r,timeline:n.timeline,multiplexer:o?.protocol,encryption:t},newStream:l??f,getStreams:()=>o!=null?o.streams:f(),close:async()=>{await n.close(),o!=null&&await Promise.all(o.streams.map(async y=>{await y.close()}))}}),this.dispatchEvent(new ee("connection",{detail:u})),u}_onStream(e){let{connection:t,stream:r,protocol:n}=e;this.components.getRegistrar().getHandler(n)({connection:t,stream:r,protocol:n})}async _encryptInbound(e){let t=new nm(e),r=Array.from(this.connectionEncryption.keys());qr("handling inbound crypto protocol selection",r);try{let{stream:n,protocol:i}=await t.handle(r),s=this.connectionEncryption.get(i);if(s==null)throw new Error(`no crypto module found for ${i}`);return qr("encrypting inbound connection..."),{...await s.secureInbound(this.components.getPeerId(),n),protocol:i}}catch(n){throw(0,Oi.default)(n,q.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t){let r=new rm(e),n=Array.from(this.connectionEncryption.keys());qr("selecting outbound crypto protocol",n);try{let{stream:i,protocol:s}=await r.select(n),a=this.connectionEncryption.get(s);if(a==null)throw new Error(`no crypto module found for ${s}`);return qr("encrypting outbound connection to %p",t),{...await a.secureOutbound(this.components.getPeerId(),i,t),protocol:s}}catch(i){throw(0,Oi.default)(i,q.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){let r=new rm(e),n=Array.from(t.keys());qr("outbound selecting muxer %s",n);try{let{stream:i,protocol:s}=await r.select(n);qr("%s selected as muxer protocol",s);let a=t.get(s);return{stream:i,muxerFactory:a}}catch(i){throw qr.error("error multiplexing outbound stream",i),(0,Oi.default)(i,q.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){let r=new nm(e),n=Array.from(t.keys());qr("inbound handling muxers %s",n);try{let{stream:i,protocol:s}=await r.handle(n),a=t.get(s);return{stream:i,muxerFactory:a}}catch(i){throw qr.error("error multiplexing inbound stream",i),(0,Oi.default)(i,q.ERR_MUXER_UNAVAILABLE)}}};c();var _D=w(K(),1),Dce=C("libp2p:registrar");function bD(e,t){for(let r of e)if(t.includes(r))return!0;return!1}var b_=class{constructor(e){this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onProtocolChange=this._onProtocolChange.bind(this),this.components.getConnectionManager().addEventListener("peer:disconnect",this._onDisconnect),this.components.getPeerStore().addEventListener("change:protocols",this._onProtocolChange)}getProtocols(){let e=new Set;for(let t of this.topologies.values())t.protocols.forEach(r=>e.add(r));for(let t of this.handlers.keys())e.add(t);return Array.from(e).sort()}getHandler(e){let t=this.handlers.get(e);if(t==null)throw new Error(`No handler registered for protocol ${e}`);return t}getTopologies(e){let t=[];for(let{topology:r,protocols:n}of this.topologies.values())n.includes(e)&&t.push(r);return t}async handle(e,t){let r=Array.isArray(e)?e:[e];for(let n of r){if(this.handlers.has(n))throw(0,_D.default)(new Error(`Handler already registered for protocol ${n}`),q.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);this.handlers.set(n,t)}await this.components.getPeerStore().protoBook.add(this.components.getPeerId(),r)}async unhandle(e){let t=Array.isArray(e)?e:[e];t.forEach(r=>{this.handlers.delete(r)}),await this.components.getPeerStore().protoBook.remove(this.components.getPeerId(),t)}async register(e,t){if(!jee(t))throw Dce.error("topology must be an instance of interfaces/topology"),(0,_D.default)(new Error("topology must be an instance of interfaces/topology"),q.ERR_INVALID_PARAMETERS);let r=`${(Math.random()*1e9).toString(36)}${Date.now()}`;return this.topologies.set(r,{topology:t,protocols:Array.isArray(e)?e:[e]}),await t.setRegistrar(this),r}unregister(e){this.topologies.delete(e)}_onDisconnect(e){let t=e.detail;this.components.getPeerStore().protoBook.get(t.remotePeer).then(r=>{for(let{topology:n,protocols:i}of this.topologies.values())bD(r,i)&&n.onDisconnect(t.remotePeer)}).catch(r=>{Dce.error(r)})}_onProtocolChange(e){let{peerId:t,protocols:r,oldProtocols:n}=e.detail,i=n.filter(a=>!r.includes(a)),s=r.filter(a=>!n.includes(a));for(let{topology:a,protocols:o}of this.topologies.values())bD(i,o)&&a.onDisconnect(t);for(let{topology:a,protocols:o}of this.topologies.values())if(bD(s,o)){let l=this.components.getConnectionManager().getConnections(t)[0];if(l==null)continue;a.onConnect(t,l)}}};c();var Ld=w(K(),1),vD=w(Ci(),1),SD=w(Gc(),1);Re(),c();var Od;(function(e){e.codec=()=>Xe({5:{name:"protocolVersion",codec:pn,optional:!0},6:{name:"agentVersion",codec:pn,optional:!0},1:{name:"publicKey",codec:ye,optional:!0},2:{name:"listenAddrs",codec:ye,repeats:!0},4:{name:"observedAddr",codec:ye,optional:!0},3:{name:"protocols",codec:pn,repeats:!0},8:{name:"signedPeerRecord",codec:ye,optional:!0}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(Od||(Od={})),c(),c();var __="0.0.0",kce="libp2p",Nce=`js-libp2p/${__}`,Oce="0.1.0",Lce="id",Bce="id/push",Mce="1.0.0",Uce="1.0.0",R3=w($o(),1),br=C("libp2p:identify"),v_=6e4,Fce=1024*8,im=class{constructor(e,t){this.components=e,this.started=!1,this.init=t,this.handleMessage=this.handleMessage.bind(this),this.identifyProtocolStr=`/${t.protocolPrefix}/${Lce}/${Mce}`,this.identifyPushProtocolStr=`/${t.protocolPrefix}/${Bce}/${Uce}`,this.host={protocolVersion:`${t.protocolPrefix}/${Oce}`,...t.host},this.components.getConnectionManager().addEventListener("peer:connect",r=>{let n=r.detail;this.identify(n).catch(br.error)}),this.components.getPeerStore().addEventListener("change:multiaddrs",r=>{let{peerId:n}=r.detail;this.components.getPeerId().equals(n)&&this.pushToPeerStore().catch(i=>br.error(i))}),this.components.getPeerStore().addEventListener("change:protocols",r=>{let{peerId:n}=r.detail;this.components.getPeerId().equals(n)&&this.pushToPeerStore().catch(i=>br.error(i))})}isStarted(){return this.started}async start(){this.started||(await this.components.getPeerStore().metadataBook.setValue(this.components.getPeerId(),"AgentVersion",U(this.host.agentVersion)),await this.components.getPeerStore().metadataBook.setValue(this.components.getPeerId(),"ProtocolVersion",U(this.host.protocolVersion)),await this.components.getRegistrar().handle([this.identifyProtocolStr,this.identifyPushProtocolStr],e=>{this.handleMessage(e)?.catch(t=>{br.error(t)})}),this.started=!0)}async stop(){await this.components.getRegistrar().unhandle(this.identifyProtocolStr),await this.components.getRegistrar().unhandle(this.identifyPushProtocolStr),this.started=!1}async push(e){let t=await this.components.getPeerStore().addressBook.getRawEnvelope(this.components.getPeerId()),r=this.components.getAddressManager().getAddresses().map(s=>s.bytes),n=await this.components.getPeerStore().protoBook.get(this.components.getPeerId()),i=e.map(async s=>{let a=new R3.TimeoutController(this.init.timeout??v_),o;try{o=(await s.newStream([this.identifyPushProtocolStr],{signal:a.signal})).stream;let l=as(o,a.signal);await Te([Od.encode({listenAddrs:r,signedPeerRecord:t,protocols:n})],kr(),l,vD.default)}catch(l){br.error("could not push identify update to peer",l)}finally{o?.close(),a.clear()}});await Promise.all(i)}async pushToPeerStore(){if(!this.isStarted())return;let e=[];for(let t of this.components.getConnectionManager().getConnections()){let r=t.remotePeer;!(await this.components.getPeerStore().get(r)).protocols.includes(this.identifyPushProtocolStr)||e.push(t)}await this.push(e)}async _identify(e,t={}){let{stream:r}=await e.newStream([this.identifyProtocolStr],t),n=r,i,s=t.signal;s==null&&(i=new R3.TimeoutController(this.init.timeout??v_),s=i.signal),n=as(r,s);try{let a=await Te([],n,Er({maxDataLength:this.init.maxIdentifyMessageSize??Fce}),async o=>await(0,SD.default)(o));if(a==null)throw(0,Ld.default)(new Error("No data could be retrieved"),q.ERR_CONNECTION_ENDED);try{return Od.decode(a)}catch(o){throw(0,Ld.default)(o,q.ERR_INVALID_MESSAGE)}}finally{i?.clear(),r.close()}}async identify(e,t={}){let r=await this._identify(e,t),{publicKey:n,listenAddrs:i,protocols:s,observedAddr:a,signedPeerRecord:o,agentVersion:l,protocolVersion:u}=r;if(n==null)throw(0,Ld.default)(new Error("public key was missing from identify message"),q.ERR_MISSING_PUBLIC_KEY);let h=await sn(n);if(!e.remotePeer.equals(h))throw(0,Ld.default)(new Error("identified peer does not match the expected peer"),q.ERR_INVALID_PEER);if(this.components.getPeerId().equals(h))throw(0,Ld.default)(new Error("identified peer is our own peer id?"),q.ERR_INVALID_PEER);let f=im.getCleanMultiaddr(a);if(o!=null){br("received signed peer record from %p",h);try{let y=await ln.openAndCertify(o,wn.DOMAIN);if(!y.peerId.equals(h))throw(0,Ld.default)(new Error("identified peer does not match the expected peer"),q.ERR_INVALID_PEER);if(await this.components.getPeerStore().addressBook.consumePeerRecord(y)){await this.components.getPeerStore().protoBook.set(h,s),l!=null&&await this.components.getPeerStore().metadataBook.setValue(h,"AgentVersion",U(l)),u!=null&&await this.components.getPeerStore().metadataBook.setValue(h,"ProtocolVersion",U(u)),br("identify completed for peer %p and protocols %o",h,s);return}}catch(y){br("received invalid envelope, discard it and fallback to listenAddrs is available",y)}}else br("no signed peer record received from %p",h);br("falling back to legacy addresses from %p",h);try{await this.components.getPeerStore().addressBook.set(h,i.map(y=>new j(y)))}catch(y){br.error("received invalid addrs",y)}await this.components.getPeerStore().protoBook.set(h,s),l!=null&&await this.components.getPeerStore().metadataBook.setValue(h,"AgentVersion",U(l)),u!=null&&await this.components.getPeerStore().metadataBook.setValue(h,"ProtocolVersion",U(u)),br("identify completed for peer %p and protocols %o",h,s),br("received observed address of %s",f?.toString())}handleMessage(e){let{protocol:t}=e;switch(t){case this.identifyProtocolStr:return this._handleIdentify(e);case this.identifyPushProtocolStr:return this._handlePush(e);default:br.error("cannot handle unknown protocol %s",t)}}async _handleIdentify(e){let{connection:t,stream:r}=e,n=new R3.TimeoutController(this.init.timeout??v_);try{let i=this.components.getPeerId().publicKey??new Uint8Array(0),s=await this.components.getPeerStore().get(this.components.getPeerId()),a=this.components.getAddressManager().getAddresses().map(h=>h.decapsulateCode(Tn("p2p").code)),o=s.peerRecordEnvelope;if(a.length>0&&o==null){let h=new wn({peerId:this.components.getPeerId(),multiaddrs:a}),f=await ln.seal(h,this.components.getPeerId());await this.components.getPeerStore().addressBook.consumePeerRecord(f),o=f.marshal()}let l=Od.encode({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:i,listenAddrs:a.map(h=>h.bytes),signedPeerRecord:o,observedAddr:t.remoteAddr.bytes,protocols:s.protocols}),u=as(r,n.signal);await Te([l],kr(),u,vD.default)}catch(i){br.error("could not respond to identify request",i)}finally{r.close(),n.clear()}}async _handlePush(e){let{connection:t,stream:r}=e,n=new R3.TimeoutController(this.init.timeout??v_),i;try{let a=as(r,n.signal),o=await Te([],a,Er({maxDataLength:this.init.maxIdentifyMessageSize??Fce}),async l=>await(0,SD.default)(l));o!=null&&(i=Od.decode(o))}catch(a){return br.error("received invalid message",a)}finally{r.close(),n.clear()}if(i==null)return br.error("received invalid message");let s=t.remotePeer;if(this.components.getPeerId().equals(s)){br("received push from ourselves?");return}if(br("received push from %p",s),i.signedPeerRecord!=null){br("received signedPeerRecord in push");try{let a=await ln.openAndCertify(i.signedPeerRecord,wn.DOMAIN);if(await this.components.getPeerStore().addressBook.consumePeerRecord(a)){br("consumed signedPeerRecord sent in push"),await this.components.getPeerStore().protoBook.set(s,i.protocols);return}else br("failed to consume signedPeerRecord sent in push")}catch(a){br("received invalid envelope, discard it and fallback to listenAddrs is available",a)}}else br("did not receive signedPeerRecord in push");try{await this.components.getPeerStore().addressBook.set(s,i.listenAddrs.map(a=>new j(a)))}catch(a){br.error("received invalid addrs",a)}try{await this.components.getPeerStore().protoBook.set(s,i.protocols)}catch(a){br.error("received invalid protocols",a)}br("handled push from %p",s)}static getCleanMultiaddr(e){if(e!=null&&e.length>0)try{return new j(e)}catch{}}};c();var S_=w(K(),1);c();var A3;(function(e){e.codec=()=>Xe({1:{name:"identifier",codec:pn}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(A3||(A3={}));var na;(function(e){let t;(function(n){n.OK="OK",n.NOT_FOUND="NOT_FOUND",n.ERROR="ERROR"})(t=e.StatusCode||(e.StatusCode={}));let r;(function(n){n[n.OK=0]="OK",n[n.NOT_FOUND=1]="NOT_FOUND",n[n.ERROR=2]="ERROR"})(r||(r={})),function(n){n.codec=()=>xi(r)}(t=e.StatusCode||(e.StatusCode={})),e.codec=()=>Xe({1:{name:"status",codec:e.StatusCode.codec()},2:{name:"data",codec:ye}}),e.encode=n=>Qe(n,e.codec()),e.decode=n=>Ye(n,e.codec())})(na||(na={})),c();var Kce="0.0.1",Vce="fetch",qce=C("libp2p:fetch"),x_=class{constructor(e,t){this.started=!1,this.components=e,this.protocol=`/${t.protocolPrefix??"libp2p"}/${Vce}/${Kce}`,this.lookupFunctions=new Map,this.handleMessage=this.handleMessage.bind(this)}async start(){await this.components.getRegistrar().handle(this.protocol,e=>{this.handleMessage(e).catch(t=>{qce.error(t)})}),this.started=!0}async stop(){await this.components.getRegistrar().unhandle(this.protocol),this.started=!1}isStarted(){return this.started}async fetch(e,t,r={}){qce("dialing %s to %p",this.protocol,e);let n=await this.components.getConnectionManager().openConnection(e,r),{stream:i}=await n.newStream([this.protocol],r),s=i;r.signal!=null&&(s=as(i,r.signal));let a=Io(s);a.write(kr.single(A3.encode({identifier:t})).slice());let o=na.decode((await Er.fromReader(a.reader).next()).value.slice());switch(o.status){case na.StatusCode.OK:return o.data;case na.StatusCode.NOT_FOUND:return null;case na.StatusCode.ERROR:{let l=new TextDecoder().decode(o.data);throw(0,S_.default)(new Error("Error in fetch protocol response: "+l),q.ERR_INVALID_PARAMETERS)}default:throw(0,S_.default)(new Error("Unknown response status"),q.ERR_INVALID_MESSAGE)}}async handleMessage(e){let{stream:t}=e,r=Io(t),n=A3.decode((await Er.fromReader(r.reader).next()).value.slice()),i,s=this._getLookupFunction(n.identifier);if(s!=null){let a=await s(n.identifier);a!=null?i={status:na.StatusCode.OK,data:a}:i={status:na.StatusCode.NOT_FOUND,data:new Uint8Array(0)}}else{let a=new TextEncoder().encode("No lookup function registered for key: "+n.identifier);i={status:na.StatusCode.ERROR,data:a}}r.write(kr.single(na.encode(i)).slice())}_getLookupFunction(e){for(let t of this.lookupFunctions.keys())if(e.startsWith(t))return this.lookupFunctions.get(t)}registerLookupFunction(e,t){if(this.lookupFunctions.has(e))throw(0,S_.default)(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),q.ERR_KEY_ALREADY_EXISTS);this.lookupFunctions.set(e,t)}unregisterLookupFunction(e,t){t!=null&&this.lookupFunctions.get(e)!==t||this.lookupFunctions.delete(e)}};c();var Gce=w(K(),1),Wce=w(Gc(),1);yr(),c();var zce="1.0.0",Hce="ping",$ce=C("libp2p:ping"),R_=class{constructor(e,t){this.components=e,this.started=!1,this.protocol=`/${t.protocolPrefix}/${Hce}/${zce}`}async start(){await this.components.getRegistrar().handle(this.protocol,this.handleMessage),this.started=!0}async stop(){await this.components.getRegistrar().unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(e){let{stream:t}=e;Te(t,t).catch(r=>{$ce.error(r)})}async ping(e,t={}){$ce("dialing %s to %p",this.protocol,e);let r=await this.components.getConnectionManager().openConnection(e,t),{stream:n}=await r.newStream([this.protocol],t),i=Date.now(),s=Fs(32),a=n;t.signal!=null&&(a=as(n,t.signal));try{let o=await Te([s],a,async u=>await(0,Wce.default)(u)),l=Date.now();if(o==null||!Ce(s,o))throw(0,Gce.default)(new Error("Received wrong ping ack"),q.ERR_WRONG_PING_ACK);return l-i}finally{n.close()}}};c(),c();async function jce(){throw new Error("Not supported in browsers")}var TD=w(xD(),1),Zce=w(Jb(),1),Jce=w(K(),1);c(),c();function Qce(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^::1$/.test(e)}function Xce(e){let{address:t}=e.nodeAddress();return Qce(t)}var RD=C("libp2p:nat"),AD=7200;function dke(e=1024,t=65535){return Math.floor(Math.random()*(t-e+1)+e)}var T_=class{constructor(e,t){if(this.components=e,this.started=!1,this.enabled=t.enabled,this.externalAddress=t.externalAddress,this.localAddress=t.localAddress,this.description=t.description??`${kce}@${__} ${this.components.getPeerId().toString()}`,this.ttl=t.ttl??AD,this.keepAlive=t.keepAlive??!0,this.gateway=t.gateway,this.ttl<AD)throw(0,Jce.default)(new Error(`NatManager ttl should be at least ${AD} seconds`),q.ERR_INVALID_PARAMETERS)}isStarted(){return this.started}start(){}afterStart(){TD.isBrowser||!this.enabled||this.started||(this.started=!0,this._start().catch(e=>{RD.error(e)}))}async _start(){let e=this.components.getTransportManager().getAddrs();for(let t of e){let{family:r,host:n,port:i,transport:s}=t.toOptions();if(!t.isThinWaistAddress()||s!=="tcp"||Xce(t)||r!==4)continue;let a=await this._getClient(),o=this.externalAddress??await a.externalIp();if((0,Zce.default)(o))throw new Error(`${o} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let l=dke();RD(`opening uPnP connection from ${o}:${l} to ${n}:${i}`),await a.map({publicPort:l,localPort:i,localAddress:this.localAddress,protocol:s.toUpperCase()==="TCP"?"TCP":"UDP"}),this.components.getAddressManager().addObservedAddr(j.fromNodeAddress({family:4,address:o,port:l},s))}}async _getClient(){return this.client!=null?this.client:(this.client=await jce({description:this.description,ttl:this.ttl,keepAlive:this.keepAlive,gateway:this.gateway}),this.client)}async stop(){if(!(TD.isBrowser||this.client==null))try{await this.client.close(),this.client=void 0}catch(e){RD.error(e)}}};c();var pke=C("libp2p:peer-record-updater"),I_=class{constructor(e){this.components=e,this.started=!1,this.update=this.update.bind(this)}isStarted(){return this.started}async start(){this.started=!0,this.components.getTransportManager().addEventListener("listener:listening",this.update),this.components.getTransportManager().addEventListener("listener:close",this.update),this.components.getAddressManager().addEventListener("change:addresses",this.update)}async stop(){this.started=!1,this.components.getTransportManager().removeEventListener("listener:listening",this.update),this.components.getTransportManager().removeEventListener("listener:close",this.update),this.components.getAddressManager().removeEventListener("change:addresses",this.update)}update(){Promise.resolve().then(async()=>{let e=new wn({peerId:this.components.getPeerId(),multiaddrs:this.components.getAddressManager().getAddresses().map(r=>r.decapsulateCode(Tn("p2p").code))}),t=await ln.seal(e,this.components.getPeerId());await this.components.getPeerStore().addressBook.consumePeerRecord(t)}).catch(e=>{pke.error("Could not update self peer record: %o",e)})}};c();var eue=w(K(),1),C_=class{constructor(e){this.dht=e}async findPeer(e,t={}){for await(let r of this.dht.findPeer(e,t))if(r.name==="FINAL_PEER")return r.peer;throw(0,eue.default)(new Error(_t.NOT_FOUND),q.ERR_NOT_FOUND)}async*getClosestPeers(e,t={}){for await(let r of this.dht.getClosestPeers(e,t))r.name==="PEER_RESPONSE"&&(yield*r.closer)}};c(),c();var D_=w(K(),1);c();var wt={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_NOT_FOUND:"ERR_NOT_FOUND"},tue=w(Vs(),1),rue=w(Gi(),1),nue=w(ei(),1),iue=w(sD(),1),mr=C("libp2p:peer-store:address-book"),P_="change:multiaddrs";async function mke(){return!0}var k_=class{constructor(e,t,r){this.dispatchEvent=e,this.store=t,this.addressFilter=r??mke}async consumePeerRecord(e){mr.trace("consumePeerRecord await write lock");let t=await this.store.lock.writeLock();mr.trace("consumePeerRecord got write lock");let r,n,i;try{let s;try{s=wn.createFromProtobuf(e.payload)}catch{return mr.error("invalid peer record received"),!1}r=s.peerId;let a=s.multiaddrs;if(!r.equals(e.peerId))return mr("signing key does not match PeerId in the PeerRecord"),!1;if(a==null||a.length===0)return!1;if(await this.store.has(r)&&(n=await this.store.load(r),n.peerRecordEnvelope!=null)){let l=await ln.createFromProtobuf(n.peerRecordEnvelope),u=wn.createFromProtobuf(l.payload);if(u.seqNumber>=s.seqNumber)return mr("sequence number was lower or equal to existing sequence number - stored: %d received: %d",u.seqNumber,s.seqNumber),!1}let o=await ID(r,a,this.addressFilter,!0);i=await this.store.patchOrCreate(r,{addresses:o,peerRecordEnvelope:e.marshal()}),mr("stored provided peer record for %p",s.peerId)}finally{mr.trace("consumePeerRecord release write lock"),t()}return this.dispatchEvent(new ee(P_,{detail:{peerId:r,multiaddrs:i.addresses.map(({multiaddr:s})=>s),oldMultiaddrs:n==null?[]:n.addresses.map(({multiaddr:s})=>s)}})),!0}async getRawEnvelope(e){mr.trace("getRawEnvelope await read lock");let t=await this.store.lock.readLock();mr.trace("getRawEnvelope got read lock");try{return(await this.store.load(e)).peerRecordEnvelope}catch(r){if(r.code!==wt.ERR_NOT_FOUND)throw r}finally{mr.trace("getRawEnvelope release read lock"),t()}}async getPeerRecord(e){let t=await this.getRawEnvelope(e);if(t!=null)return await ln.createFromProtobuf(t)}async get(e){e=on(e),mr.trace("get wait for read lock");let t=await this.store.lock.readLock();mr.trace("get got read lock");try{return(await this.store.load(e)).addresses}catch(r){if(r.code!==wt.ERR_NOT_FOUND)throw r}finally{mr.trace("get release read lock"),t()}return[]}async set(e,t){if(e=on(e),!Array.isArray(t))throw mr.error("multiaddrs must be an array of Multiaddrs"),(0,D_.default)(new Error("multiaddrs must be an array of Multiaddrs"),wt.ERR_INVALID_PARAMETERS);mr.trace("set await write lock");let r=await this.store.lock.writeLock();mr.trace("set got write lock");let n=!1,i,s;try{let a=await ID(e,t,this.addressFilter);if(a.length===0)return;try{if(i=await this.store.load(e),n=!0,new Set([...a.map(({multiaddr:o})=>o.toString()),...i.addresses.map(({multiaddr:o})=>o.toString())]).size===i.addresses.length&&a.length===i.addresses.length)return}catch(o){if(o.code!==wt.ERR_NOT_FOUND)throw o}s=await this.store.patchOrCreate(e,{addresses:a}),mr("set multiaddrs for %p",e)}finally{mr.trace("set multiaddrs for %p",e),mr("set release write lock"),r()}this.dispatchEvent(new ee(P_,{detail:{peerId:e,multiaddrs:s.addresses.map(a=>a.multiaddr),oldMultiaddrs:i==null?[]:i.addresses.map(({multiaddr:a})=>a)}})),n||this.dispatchEvent(new ee("peer",{detail:{id:e,multiaddrs:s.addresses.map(a=>a.multiaddr),protocols:s.protocols}}))}async add(e,t){if(e=on(e),!Array.isArray(t))throw mr.error("multiaddrs must be an array of Multiaddrs"),(0,D_.default)(new Error("multiaddrs must be an array of Multiaddrs"),wt.ERR_INVALID_PARAMETERS);mr.trace("add await write lock");let r=await this.store.lock.writeLock();mr.trace("add got write lock");let n,i,s;try{let a=await ID(e,t,this.addressFilter);if(a.length===0)return;try{if(i=await this.store.load(e),n=!0,new Set([...a.map(({multiaddr:o})=>o.toString()),...i.addresses.map(({multiaddr:o})=>o.toString())]).size===i.addresses.length)return}catch(o){if(o.code!==wt.ERR_NOT_FOUND)throw o}s=await this.store.mergeOrCreate(e,{addresses:a}),mr("added multiaddrs for %p",e)}finally{mr.trace("set release write lock"),r()}this.dispatchEvent(new ee(P_,{detail:{peerId:e,multiaddrs:s.addresses.map(a=>a.multiaddr),oldMultiaddrs:i==null?[]:i.addresses.map(({multiaddr:a})=>a)}})),n===!0&&this.dispatchEvent(new ee("peer",{detail:{id:e,multiaddrs:s.addresses.map(a=>a.multiaddr),protocols:s.protocols}}))}async delete(e){e=on(e),mr.trace("delete await write lock");let t=await this.store.lock.writeLock();mr.trace("delete got write lock");let r;try{try{r=await this.store.load(e)}catch(n){if(n.code!==wt.ERR_NOT_FOUND)throw n}await this.store.patchOrCreate(e,{addresses:[]})}finally{mr.trace("delete release write lock"),t()}r!=null&&this.dispatchEvent(new ee(P_,{detail:{peerId:e,multiaddrs:[],oldMultiaddrs:r==null?[]:r.addresses.map(({multiaddr:n})=>n)}}))}};async function ID(e,t,r,n=!1){return await Te(t,i=>(0,iue.default)(i,s=>{if(!j.isMultiaddr(s))throw mr.error("multiaddr must be an instance of Multiaddr"),(0,D_.default)(new Error("multiaddr must be an instance of Multiaddr"),wt.ERR_INVALID_PARAMETERS)}),i=>(0,rue.default)(i,async s=>await r(e,s)),i=>(0,nue.default)(i,s=>({multiaddr:new j(s.toString()),isCertified:n})),async i=>await(0,tue.default)(i))}c();var sue=w(K(),1);yr();var ac=C("libp2p:peer-store:key-book"),oue="change:pubkey",N_=class{constructor(e,t){this.dispatchEvent=e,this.store=t}async set(e,t){if(e=on(e),!(t instanceof Uint8Array))throw ac.error("publicKey must be an instance of Uint8Array to store data"),(0,sue.default)(new Error("publicKey must be an instance of PublicKey"),wt.ERR_INVALID_PARAMETERS);ac.trace("set await write lock");let r=await this.store.lock.writeLock();ac.trace("set got write lock");let n=!1,i;try{try{if(i=await this.store.load(e),i.pubKey!=null&&Ce(i.pubKey,t))return}catch(s){if(s.code!==wt.ERR_NOT_FOUND)throw s}await this.store.patchOrCreate(e,{pubKey:t}),n=!0}finally{ac.trace("set release write lock"),r()}n&&this.dispatchEvent(new ee(oue,{detail:{peerId:e,publicKey:t,oldPublicKey:i?.pubKey}}))}async get(e){e=on(e),ac.trace("get await write lock");let t=await this.store.lock.readLock();ac.trace("get got write lock");try{return(await this.store.load(e)).pubKey}catch(r){if(r.code!==wt.ERR_NOT_FOUND)throw r}finally{ac("get release write lock"),t()}}async delete(e){e=on(e),ac.trace("delete await write lock");let t=await this.store.lock.writeLock();ac.trace("delete got write lock");let r;try{try{r=await this.store.load(e)}catch(n){if(n.code!==wt.ERR_NOT_FOUND)throw n}await this.store.patchOrCreate(e,{pubKey:void 0})}catch(n){if(n.code!==wt.ERR_NOT_FOUND)throw n}finally{ac.trace("delete release write lock"),t()}this.dispatchEvent(new ee(oue,{detail:{peerId:e,publicKey:void 0,oldPublicKey:r?.pubKey}}))}};c();var CD=w(K(),1);yr();var vn=C("libp2p:peer-store:metadata-book"),O_="change:metadata",L_=class{constructor(e,t){this.dispatchEvent=e,this.store=t}async get(e){e=on(e),vn.trace("get await read lock");let t=await this.store.lock.readLock();vn.trace("get got read lock");try{return(await this.store.load(e)).metadata}catch(r){if(r.code!==wt.ERR_NOT_FOUND)throw r}finally{vn.trace("get release read lock"),t()}return new Map}async getValue(e,t){e=on(e),vn.trace("getValue await read lock");let r=await this.store.lock.readLock();vn.trace("getValue got read lock");try{return(await this.store.load(e)).metadata.get(t)}catch(n){if(n.code!==wt.ERR_NOT_FOUND)throw n}finally{vn.trace("getValue release write lock"),r()}}async set(e,t){if(e=on(e),!(t instanceof Map))throw vn.error("valid metadata must be provided to store data"),(0,CD.default)(new Error("valid metadata must be provided"),wt.ERR_INVALID_PARAMETERS);vn.trace("set await write lock");let r=await this.store.lock.writeLock();vn.trace("set got write lock");let n;try{try{n=await this.store.load(e)}catch(i){if(i.code!==wt.ERR_NOT_FOUND)throw i}await this.store.mergeOrCreate(e,{metadata:t})}finally{vn.trace("set release write lock"),r()}this.dispatchEvent(new ee(O_,{detail:{peerId:e,metadata:t,oldMetadata:n==null?new Map:n.metadata}}))}async setValue(e,t,r){if(e=on(e),typeof t!="string"||!(r instanceof Uint8Array))throw vn.error("valid key and value must be provided to store data"),(0,CD.default)(new Error("valid key and value must be provided"),wt.ERR_INVALID_PARAMETERS);vn.trace("setValue await write lock");let n=await this.store.lock.writeLock();vn.trace("setValue got write lock");let i,s;try{try{i=await this.store.load(e);let a=i.metadata.get(t);if(a!=null&&Ce(r,a))return}catch(a){if(a.code!==wt.ERR_NOT_FOUND)throw a}s=await this.store.mergeOrCreate(e,{metadata:new Map([[t,r]])})}finally{vn.trace("setValue release write lock"),n()}this.dispatchEvent(new ee(O_,{detail:{peerId:e,metadata:s.metadata,oldMetadata:i==null?new Map:i.metadata}}))}async delete(e){e=on(e),vn.trace("delete await write lock");let t=await this.store.lock.writeLock();vn.trace("delete got write lock");let r;try{try{r=await this.store.load(e)}catch(n){if(n.code!==wt.ERR_NOT_FOUND)throw n}r!=null&&await this.store.patch(e,{metadata:new Map})}finally{vn.trace("delete release write lock"),t()}r!=null&&this.dispatchEvent(new ee(O_,{detail:{peerId:e,metadata:new Map,oldMetadata:r.metadata}}))}async deleteValue(e,t){e=on(e),vn.trace("deleteValue await write lock");let r=await this.store.lock.writeLock();vn.trace("deleteValue got write lock");let n,i;try{i=await this.store.load(e),n=i.metadata,n.delete(t),await this.store.patch(e,{metadata:n})}catch(s){if(s.code!==wt.ERR_NOT_FOUND)throw s}finally{vn.trace("deleteValue release write lock"),r()}n!=null&&this.dispatchEvent(new ee(O_,{detail:{peerId:e,metadata:n,oldMetadata:i==null?new Map:i.metadata}}))}};c();var M_=w(K(),1),Sn=C("libp2p:peer-store:proto-book"),B_="change:protocols",U_=class{constructor(e,t){this.dispatchEvent=e,this.store=t}async get(e){Sn.trace("get wait for read lock");let t=await this.store.lock.readLock();Sn.trace("get got read lock");try{return(await this.store.load(e)).protocols}catch(r){if(r.code!==wt.ERR_NOT_FOUND)throw r}finally{Sn.trace("get release read lock"),t()}return[]}async set(e,t){if(e=on(e),!Array.isArray(t))throw Sn.error("protocols must be provided to store data"),(0,M_.default)(new Error("protocols must be provided"),wt.ERR_INVALID_PARAMETERS);Sn.trace("set await write lock");let r=await this.store.lock.writeLock();Sn.trace("set got write lock");let n,i;try{try{if(n=await this.store.load(e),new Set([...t]).size===n.protocols.length)return}catch(s){if(s.code!==wt.ERR_NOT_FOUND)throw s}i=await this.store.patchOrCreate(e,{protocols:t}),Sn("stored provided protocols for %p",e)}finally{Sn.trace("set release write lock"),r()}this.dispatchEvent(new ee(B_,{detail:{peerId:e,protocols:i.protocols,oldProtocols:n==null?[]:n.protocols}}))}async add(e,t){if(e=on(e),!Array.isArray(t))throw Sn.error("protocols must be provided to store data"),(0,M_.default)(new Error("protocols must be provided"),wt.ERR_INVALID_PARAMETERS);Sn.trace("add await write lock");let r=await this.store.lock.writeLock();Sn.trace("add got write lock");let n,i;try{try{if(n=await this.store.load(e),new Set([...n.protocols,...t]).size===n.protocols.length)return}catch(s){if(s.code!==wt.ERR_NOT_FOUND)throw s}i=await this.store.mergeOrCreate(e,{protocols:t}),Sn("added provided protocols for %p",e)}finally{Sn.trace("add release write lock"),r()}this.dispatchEvent(new ee(B_,{detail:{peerId:e,protocols:i.protocols,oldProtocols:n==null?[]:n.protocols}}))}async remove(e,t){if(e=on(e),!Array.isArray(t))throw Sn.error("protocols must be provided to store data"),(0,M_.default)(new Error("protocols must be provided"),wt.ERR_INVALID_PARAMETERS);Sn.trace("remove await write lock");let r=await this.store.lock.writeLock();Sn.trace("remove got write lock");let n,i;try{try{n=await this.store.load(e);let s=new Set(n.protocols);for(let a of t)s.delete(a);if(n.protocols.length===s.size)return;t=Array.from(s)}catch(s){if(s.code!==wt.ERR_NOT_FOUND)throw s}i=await this.store.patchOrCreate(e,{protocols:t})}finally{Sn.trace("remove release write lock"),r()}this.dispatchEvent(new ee(B_,{detail:{peerId:e,protocols:i.protocols,oldProtocols:n==null?[]:n.protocols}}))}async delete(e){e=on(e),Sn.trace("delete await write lock");let t=await this.store.lock.writeLock();Sn.trace("delete got write lock");let r;try{try{r=await this.store.load(e)}catch(n){if(n.code!==wt.ERR_NOT_FOUND)throw n}await this.store.patchOrCreate(e,{protocols:[]})}finally{Sn.trace("delete release write lock"),t()}r!=null&&this.dispatchEvent(new ee(B_,{detail:{peerId:e,protocols:[],oldProtocols:r.protocols}}))}};c();var $D=w(K(),1);si(),c();var I3;(function(e){e.codec=()=>Xe({1:{name:"addresses",codec:PD.codec(),repeats:!0},2:{name:"protocols",codec:pn,repeats:!0},3:{name:"metadata",codec:DD.codec(),repeats:!0},4:{name:"pubKey",codec:ye,optional:!0},5:{name:"peerRecordEnvelope",codec:ye,optional:!0}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(I3||(I3={}));var PD;(function(e){e.codec=()=>Xe({1:{name:"multiaddr",codec:ye},2:{name:"isCertified",codec:P2,optional:!0}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(PD||(PD={}));var DD;(function(e){e.codec=()=>Xe({1:{name:"key",codec:pn},2:{name:"value",codec:ye}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(DD||(DD={})),c(),c();var due=w(Xu(),1);c(),c();function kD(e,t,r){let n=0,i=e.length;for(;i>0;){let s=Math.trunc(i/2),a=n+s;r(e[a],t)<=0?(n=++a,i-=s+1):i=s}return n}var Bd=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},yu,C3=class{constructor(){yu.set(this,[])}enqueue(e,t){t={priority:0,...t};let r={priority:t.priority,run:e};if(this.size&&Bd(this,yu,"f")[this.size-1].priority>=t.priority){Bd(this,yu,"f").push(r);return}let n=kD(Bd(this,yu,"f"),r,(i,s)=>s.priority-i.priority);Bd(this,yu,"f").splice(n,0,r)}dequeue(){return Bd(this,yu,"f").shift()?.run}filter(e){return Bd(this,yu,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return Bd(this,yu,"f").length}};yu=new WeakMap;var nr=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},ve=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Yn,D3,k3,wf,z_,N3,F_,ia,P3,Co,K_,Po,O3,gf,om,sm,Md,V_,aue,cue,hue,uue,lue,fue,q_,ND,OD,H_,$_=()=>{},yke=new hi,LD=class extends Error{},am=class extends due.default{constructor(e){var t,r,n,i;if(super(),Yn.add(this),D3.set(this,void 0),k3.set(this,void 0),wf.set(this,0),z_.set(this,void 0),N3.set(this,void 0),F_.set(this,0),ia.set(this,void 0),P3.set(this,void 0),Co.set(this,void 0),K_.set(this,void 0),Po.set(this,0),O3.set(this,void 0),gf.set(this,void 0),om.set(this,$_),sm.set(this,$_),Md.set(this,void 0),V_.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:C3,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);nr(this,D3,e.carryoverConcurrencyCount,"f"),nr(this,k3,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),nr(this,z_,e.intervalCap,"f"),nr(this,N3,e.interval,"f"),nr(this,Co,new e.queueClass,"f"),nr(this,K_,e.queueClass,"f"),this.concurrency=e.concurrency,nr(this,Md,e.timeout,"f"),nr(this,V_,e.throwOnTimeout===!0,"f"),nr(this,gf,e.autoStart===!1,"f")}get concurrency(){return ve(this,O3,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);nr(this,O3,e,"f"),ve(this,Yn,"m",H_).call(this)}async add(e,t={}){return new Promise((r,n)=>{let i=async()=>{var s,a,o;nr(this,Po,(a=ve(this,Po,"f"),a++,a),"f"),nr(this,wf,(o=ve(this,wf,"f"),o++,o),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){n(new LD("The task was aborted."));return}let l=await(ve(this,Md,"f")===void 0&&t.timeout===void 0?e({signal:t.signal}):nn(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?ve(this,Md,"f"):t.timeout,()=>{(t.throwOnTimeout===void 0?ve(this,V_,"f"):t.throwOnTimeout)&&n(yke)}));r(l),this.emit("completed",l)}catch(l){n(l),this.emit("error",l)}ve(this,Yn,"m",hue).call(this)};ve(this,Co,"f").enqueue(i,t),ve(this,Yn,"m",q_).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return ve(this,gf,"f")?(nr(this,gf,!1,"f"),ve(this,Yn,"m",H_).call(this),this):this}pause(){nr(this,gf,!0,"f")}clear(){nr(this,Co,new(ve(this,K_,"f")),"f")}async onEmpty(){if(ve(this,Co,"f").size!==0)return new Promise(e=>{let t=ve(this,om,"f");nr(this,om,()=>{t(),e()},"f")})}async onSizeLessThan(e){if(!(ve(this,Co,"f").size<e))return new Promise(t=>{let r=()=>{ve(this,Co,"f").size<e&&(this.removeListener("next",r),t())};this.on("next",r)})}async onIdle(){if(!(ve(this,Po,"f")===0&&ve(this,Co,"f").size===0))return new Promise(e=>{let t=ve(this,sm,"f");nr(this,sm,()=>{t(),e()},"f")})}get size(){return ve(this,Co,"f").size}sizeBy(e){return ve(this,Co,"f").filter(e).length}get pending(){return ve(this,Po,"f")}get isPaused(){return ve(this,gf,"f")}get timeout(){return ve(this,Md,"f")}set timeout(e){nr(this,Md,e,"f")}};D3=new WeakMap,k3=new WeakMap,wf=new WeakMap,z_=new WeakMap,N3=new WeakMap,F_=new WeakMap,ia=new WeakMap,P3=new WeakMap,Co=new WeakMap,K_=new WeakMap,Po=new WeakMap,O3=new WeakMap,gf=new WeakMap,om=new WeakMap,sm=new WeakMap,Md=new WeakMap,V_=new WeakMap,Yn=new WeakSet,aue=function(){return ve(this,k3,"f")||ve(this,wf,"f")<ve(this,z_,"f")},cue=function(){return ve(this,Po,"f")<ve(this,O3,"f")},hue=function(){var e;nr(this,Po,(e=ve(this,Po,"f"),e--,e),"f"),ve(this,Yn,"m",q_).call(this),this.emit("next")},uue=function(){ve(this,om,"f").call(this),nr(this,om,$_,"f"),ve(this,Po,"f")===0&&(ve(this,sm,"f").call(this),nr(this,sm,$_,"f"),this.emit("idle"))},lue=function(){ve(this,Yn,"m",OD).call(this),ve(this,Yn,"m",ND).call(this),nr(this,P3,void 0,"f")},fue=function(){let e=Date.now();if(ve(this,ia,"f")===void 0){let t=ve(this,F_,"f")-e;if(t<0)nr(this,wf,ve(this,D3,"f")?ve(this,Po,"f"):0,"f");else return ve(this,P3,"f")===void 0&&nr(this,P3,setTimeout(()=>{ve(this,Yn,"m",lue).call(this)},t),"f"),!0}return!1},q_=function(){if(ve(this,Co,"f").size===0)return ve(this,ia,"f")&&clearInterval(ve(this,ia,"f")),nr(this,ia,void 0,"f"),ve(this,Yn,"m",uue).call(this),!1;if(!ve(this,gf,"f")){let e=!ve(this,Yn,"m",fue).call(this);if(ve(this,Yn,"a",aue)&&ve(this,Yn,"a",cue)){let t=ve(this,Co,"f").dequeue();return t?(this.emit("active"),t(),e&&ve(this,Yn,"m",ND).call(this),!0):!1}}return!1},ND=function(){ve(this,k3,"f")||ve(this,ia,"f")!==void 0||(nr(this,ia,setInterval(()=>{ve(this,Yn,"m",OD).call(this)},ve(this,N3,"f")),"f"),nr(this,F_,Date.now()+ve(this,N3,"f"),"f"))},OD=function(){ve(this,wf,"f")===0&&ve(this,Po,"f")===0&&ve(this,ia,"f")&&(clearInterval(ve(this,ia,"f")),nr(this,ia,void 0,"f")),nr(this,wf,ve(this,D3,"f")?ve(this,Po,"f"):0,"f"),ve(this,Yn,"m",H_).call(this)},H_=function(){for(;ve(this,Yn,"m",q_).call(this););},c(),Lp(),c();var BD="lock:worker:request-read",MD="lock:worker:release-read",UD="lock:master:grant-read",FD="lock:worker:request-write",KD="lock:worker:release-write",VD="lock:master:grant-write";c();var Ef={},cm=e=>{e.addEventListener("message",t=>{cm.dispatchEvent("message",e,t)}),e.port!=null&&e.port.addEventListener("message",t=>{cm.dispatchEvent("message",e,t)})};cm.addEventListener=(e,t)=>{Ef[e]==null&&(Ef[e]=[]),Ef[e].push(t)},cm.removeEventListener=(e,t)=>{Ef[e]!=null&&(Ef[e]=Ef[e].filter(r=>r===t))},cm.dispatchEvent=function(e,t,r){Ef[e]!=null&&Ef[e].forEach(n=>n(t,r))};var qD=cm,pue=(e,t,r,n,i)=>(s,a)=>{if(a.data.type!==r)return;let o={type:a.data.type,name:a.data.name,identifier:a.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:o.name,handler:async()=>(s.postMessage({type:i,name:o.name,identifier:o.identifier}),await new Promise(l=>{let u=h=>{if(h==null||h.data==null)return;let f={type:h.data.type,name:h.data.name,identifier:h.data.identifier};f.type===n&&f.identifier===o.identifier&&(s.removeEventListener("message",u),l())};s.addEventListener("message",u)}))}}))},mue=(e,t,r,n)=>async()=>{let i=jf();return globalThis.postMessage({type:t,identifier:i,name:e}),await new Promise(s=>{let a=o=>{if(o==null||o.data==null)return;let l={type:o.data.type,identifier:o.data.identifier};l.type===r&&l.identifier===i&&(globalThis.removeEventListener("message",a),s(()=>{globalThis.postMessage({type:n,identifier:i,name:e})}))};globalThis.addEventListener("message",a)})},gke={singleProcess:!1},yue=e=>{if(e=Object.assign({},gke,e),Boolean(globalThis.document)||e.singleProcess){let t=new EventTarget;return qD.addEventListener("message",pue(t,"requestReadLock",BD,MD,UD)),qD.addEventListener("message",pue(t,"requestWriteLock",FD,KD,VD)),t}return{isWorker:!0,readLock:t=>mue(t,BD,UD,MD),writeLock:t=>mue(t,FD,VD,KD)}},Ud={},bf;async function zD(e,t){let r,n=new Promise(i=>{r=i});return e.add(async()=>await nn((async()=>await new Promise(i=>{r(()=>{i()})}))(),t.timeout)),await n}var wke=(e,t)=>{if(bf.isWorker===!0)return{readLock:bf.readLock(e,t),writeLock:bf.writeLock(e,t)};let r=new am({concurrency:1}),n;return{async readLock(){if(n!=null)return await zD(n,t);n=new am({concurrency:t.concurrency,autoStart:!1});let i=n,s=zD(n,t);return r.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await s},async writeLock(){return n=null,await zD(r,t)}}},Eke={name:"lock",concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};function HD(e){let t=Object.assign({},Eke,e);return bf==null&&(bf=yue(t),bf.isWorker!==!0&&(bf.addEventListener("requestReadLock",r=>{Ud[r.data.name]!=null&&Ud[r.data.name].readLock().then(async n=>await r.data.handler().finally(()=>n()))}),bf.addEventListener("requestWriteLock",async r=>{Ud[r.data.name]!=null&&Ud[r.data.name].writeLock().then(async n=>await r.data.handler().finally(()=>n()))}))),Ud[t.name]==null&&(Ud[t.name]=wke(t.name,t)),Ud[t.name]}yr();var gue=C("libp2p:peer-store:store"),wue="/peers/",G_=class{constructor(){this.components=new He,this.lock=HD({name:"peer-store",singleProcess:!0})}init(e){this.components=e}_peerIdToDatastoreKey(e){if(e.type==null)throw gue.error("peerId must be an instance of peer-id to store data"),(0,$D.default)(new Error("peerId must be an instance of peer-id"),wt.ERR_INVALID_PARAMETERS);let t=e.toCID().toString();return new ae(`${wue}${t}`)}async has(e){return await this.components.getDatastore().has(this._peerIdToDatastoreKey(e))}async delete(e){await this.components.getDatastore().delete(this._peerIdToDatastoreKey(e))}async load(e){let t=await this.components.getDatastore().get(this._peerIdToDatastoreKey(e)),r=I3.decode(t),n=new Map;for(let i of r.metadata)n.set(i.key,i.value);return{...r,id:e,addresses:r.addresses.map(({multiaddr:i,isCertified:s})=>({multiaddr:new j(i),isCertified:s??!1})),metadata:n,pubKey:r.pubKey??void 0,peerRecordEnvelope:r.peerRecordEnvelope??void 0}}async save(e){if(e.pubKey!=null&&e.id.publicKey!=null&&!Ce(e.pubKey,e.id.publicKey))throw gue.error("peer publicKey bytes do not match peer id publicKey bytes"),(0,$D.default)(new Error("publicKey bytes do not match peer id publicKey bytes"),wt.ERR_INVALID_PARAMETERS);let t=new Set,r=e.addresses.filter(s=>t.has(s.multiaddr.toString())?!1:(t.add(s.multiaddr.toString()),!0)).sort((s,a)=>s.multiaddr.toString().localeCompare(a.multiaddr.toString())).map(({multiaddr:s,isCertified:a})=>({multiaddr:s.bytes,isCertified:a})),n=[];[...e.metadata.keys()].sort().forEach(s=>{let a=e.metadata.get(s);a!=null&&n.push({key:s,value:a})});let i=I3.encode({addresses:r,protocols:e.protocols.sort(),pubKey:e.pubKey,metadata:n,peerRecordEnvelope:e.peerRecordEnvelope});return await this.components.getDatastore().put(this._peerIdToDatastoreKey(e.id),i),await this.load(e.id)}async patch(e,t){let r=await this.load(e);return await this._patch(e,t,r)}async patchOrCreate(e,t){let r;try{r=await this.load(e)}catch(n){if(n.code!==wt.ERR_NOT_FOUND)throw n;r={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,t,r)}async _patch(e,t,r){return await this.save({...r,...t,id:e})}async merge(e,t){let r=await this.load(e);return await this._merge(e,t,r)}async mergeOrCreate(e,t){let r;try{r=await this.load(e)}catch(n){if(n.code!==wt.ERR_NOT_FOUND)throw n;r={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,t,r)}async _merge(e,t,r){let n=new Map;return r.addresses.forEach(i=>{n.set(i.multiaddr.toString(),i.isCertified)}),(t.addresses??[]).forEach(i=>{let s=i.multiaddr.toString(),a=Boolean(n.get(s))||i.isCertified;n.set(s,a)}),await this.save({id:e,addresses:Array.from(n.entries()).map(([i,s])=>({multiaddr:new j(i),isCertified:s})),protocols:Array.from(new Set([...r.protocols??[],...t.protocols??[]])),metadata:new Map([...r.metadata?.entries()??[],...t.metadata?.entries()??[]]),pubKey:t.pubKey??r?.pubKey,peerRecordEnvelope:t.peerRecordEnvelope??r?.peerRecordEnvelope})}async*all(){for await(let e of this.components.getDatastore().queryKeys({prefix:wue})){let t=e.toString().split("/")[2],r=xt.decode(t);yield this.load(Ir(r))}}},ys=C("libp2p:peer-store"),W_=class extends Ue{constructor(e={}){super(),this.components=new He,this.store=new G_,this.addressBook=new k_(this.dispatchEvent.bind(this),this.store,e.addressFilter),this.keyBook=new N_(this.dispatchEvent.bind(this),this.store),this.metadataBook=new L_(this.dispatchEvent.bind(this),this.store),this.protoBook=new U_(this.dispatchEvent.bind(this),this.store)}init(e){this.components=e,this.store.init(e)}async forEach(e){ys.trace("getPeers await read lock");let t=await this.store.lock.readLock();ys.trace("getPeers got read lock");try{for await(let r of this.store.all())r.id.equals(this.components.getPeerId())||e(r)}finally{ys.trace("getPeers release read lock"),t()}}async all(){let e=[];return await this.forEach(t=>{e.push(t)}),e}async delete(e){ys.trace("delete await write lock");let t=await this.store.lock.writeLock();ys.trace("delete got write lock");try{await this.store.delete(e)}finally{ys.trace("delete release write lock"),t()}}async get(e){ys.trace("get await read lock");let t=await this.store.lock.readLock();ys.trace("get got read lock");try{return await this.store.load(e)}finally{ys.trace("get release read lock"),t()}}async has(e){ys.trace("has await read lock");let t=await this.store.lock.readLock();ys.trace("has got read lock");try{return await this.store.has(e)}finally{ys.trace("has release read lock"),t()}}};c();var GD=w(Ci(),1),Eue=w(K(),1),j_=class{constructor(e){this.dht=e}async provide(e){await(0,GD.default)(this.dht.provide(e))}async*findProviders(e,t={}){for await(let r of this.dht.findProviders(e,t))r.name==="PROVIDER"&&(yield*r.providers)}async put(e,t,r){await(0,GD.default)(this.dht.put(e,t,r))}async get(e,t){for await(let r of this.dht.get(e,t))if(r.name==="VALUE")return r.value;throw(0,Eue.default)(new Error("Not found"),"ERR_NOT_FOUND")}};c();var _ue=w($o(),1),bue=C("libp2p:dialer:auto-dialer"),Y_=class{constructor(e,t){this.components=e,this.enabled=t.enabled,this.minConnections=t.minConnections,this.dialTimeout=t.dialTimeout}handle(e){let{detail:t}=e;if(!!this.enabled&&this.components.getConnectionManager().getConnections(t.id).length===0){let r=this.minConnections??0,n=this.components.getConnectionManager().getConnections();if(r>n.length){bue("auto-dialing discovered peer %p with timeout %d",t.id,this.dialTimeout);let i=new _ue.TimeoutController(this.dialTimeout);this.components.getConnectionManager().openConnection(t.id,{signal:i.signal}).catch(s=>{bue.error("could not connect to discovered peer %p with %o",t.id,s)}).finally(()=>{i.clear()})}}}};c(),c(),c(),c();var jD=w(Mi(),1),YD=w(xue(),1);c(),c();var Rue=globalThis.fetch,Aue=globalThis.Headers,ORt=globalThis.Request,LRt=globalThis.Response;function Q_(e,t,r){return`${e}?name=${t}&type=${r}`}async function Tue(e){return await(await Rue(e,{headers:new Aue({accept:"application/dns-json"})})).json()}function Fd(e,t){return`${t}_${e}`}var WD=Object.assign((0,jD.default)("dns-over-http-resolver"),{error:(0,jD.default)("dns-over-http-resolver:error")}),QD=class{constructor(e={}){this._cache=new YD.default({max:e?.maxCache??100}),this._TXTcache=new YD.default({max:e?.maxCache??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=e.request??Tue}getServers(){return this._servers}_getShuffledServers(){let e=[...this._servers];for(let t=e.length-1;t>0;t--){let r=Math.floor(Math.random()*t),n=e[t];e[t]=e[r],e[r]=n}return e}setServers(e){this._servers=e}async resolve(e,t="A"){switch(t){case"A":return await this.resolve4(e);case"AAAA":return await this.resolve6(e);case"TXT":return await this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){let t="A",r=this._cache.get(Fd(e,t));if(r!=null)return r;for(let n of this._getShuffledServers())try{let i=await this._request(Q_(n,e,t)),s=i.Answer.map(o=>o.data),a=Math.min(...i.Answer.map(o=>o.TTL));return this._cache.set(Fd(e,t),s,{ttl:a}),s}catch{WD.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){let t="AAAA",r=this._cache.get(Fd(e,t));if(r!=null)return r;for(let n of this._getShuffledServers())try{let i=await this._request(Q_(n,e,t)),s=i.Answer.map(o=>o.data),a=Math.min(...i.Answer.map(o=>o.TTL));return this._cache.set(Fd(e,t),s,{ttl:a}),s}catch{WD.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){let t="TXT",r=this._TXTcache.get(Fd(e,t));if(r!=null)return r;for(let n of this._getShuffledServers())try{let i=await this._request(Q_(n,e,t)),s=i.Answer.map(o=>[o.data.replace(/['"]+/g,"")]),a=Math.min(...i.Answer.map(o=>o.TTL));return this._TXTcache.set(Fd(e,t),s,{ttl:a}),s}catch{WD.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}},Iue=QD,Cue=Iue,{code:xke}=Tn("dnsaddr");async function Pue(e){let t=new Cue,r=e.getPeerId(),[,n]=e.stringTuples().find(([s])=>s===xke)??[];if(n==null)throw new Error("No hostname found in multiaddr");let i=(await t.resolveTxt(`_dnsaddr.${n}`)).flat().map(s=>s.split("=")[1]);return r!=null&&(i=i.filter(s=>s.includes(r))),i}var X_=w(K(),1),Tke={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{maxConnections:300,minConnections:50,autoDial:!0,autoDialInterval:1e4,maxParallelDials:100,maxDialsPerPeer:4,dialTimeout:3e4,resolvers:{dnsaddr:Pue},addressSorter:W1},connectionGater:{},transportManager:{faultTolerance:kd.FATAL_ALL},metrics:{enabled:!1,computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0},relay:{enabled:!0,advertise:{bootDelay:9e5,enabled:!1,ttl:18e5},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},identify:{protocolPrefix:"ipfs",host:{agentVersion:Nce},timeout:3e4},ping:{protocolPrefix:"ipfs"},fetch:{protocolPrefix:"libp2p"}};function Due(e){let t=Ze(Tke,e);if(t.transports==null||t.transports.length<1)throw(0,X_.default)(new Error(_t.ERR_TRANSPORTS_REQUIRED),q.ERR_TRANSPORTS_REQUIRED);if(t.connectionEncryption==null||t.connectionEncryption.length===0)throw(0,X_.default)(new Error(_t.CONN_ENCRYPTION_REQUIRED),q.CONN_ENCRYPTION_REQUIRED);if(t.connectionProtector===null&&globalThis.process?.env?.LIBP2P_FORCE_PNET!=null)throw(0,X_.default)(new Error(_t.ERR_PROTECTOR_REQUIRED),q.ERR_PROTECTOR_REQUIRED);return t}c(),c(),c();var Ei;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(Ei||(Ei={}));var XD;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(XD||(XD={})),function(e){e.codec=()=>xi(XD)}(Ei||(Ei={}));var gu;(function(e){e.codec=()=>Xe({1:{name:"Type",codec:Ei.codec()},2:{name:"Data",codec:ye}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(gu||(gu={}));var wu;(function(e){e.codec=()=>Xe({1:{name:"Type",codec:Ei.codec()},2:{name:"Data",codec:ye}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(wu||(wu={}));var cTt=w(Aa(),1),uTt=w(i6(),1),Xke=w(st(),1),ale=w(K(),1);Re(),c();var Cke=w(K(),1);ur(),Re(),c(),c();var Zi={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};c(),c(),c();var Pke=w(K(),1);c();var aAt=w(gr(),1),cAt=w(L2(),1),kue=w(st(),1);Re(),me(),ur();function oa(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Ae([new Uint8Array(t-r.length),r])}return M(r,"base64url")}function Do(e){let t=Nue(e);return new kue.default.jsbn.BigInteger(M(t,"base16"),16)}function Nue(e,t){let r=U(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Ae([new Uint8Array(t-r.length),r])}return r}me(),ur(),yr();var Dke={"P-256":256,"P-384":384,"P-521":521},kke=Object.keys(Dke),wAt=kke.join(" / ");c(),ma(),c(),ur(),Re();function ZD(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,a=e?.iterations??32767,o=Zi.get();r*=8;async function l(h,f){let y=o.getRandomValues(new Uint8Array(s)),p=o.getRandomValues(new Uint8Array(n)),v={name:t,iv:p};typeof f=="string"&&(f=U(f));let d={name:"PBKDF2",salt:y,iterations:a,hash:{name:i}},g=await o.subtle.importKey("raw",f,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(d,g,{name:t,length:r},!0,["encrypt"]),_=await o.subtle.encrypt(v,b,h);return Ae([y,v.iv,new Uint8Array(_)])}async function u(h,f){let y=h.slice(0,s),p=h.slice(s,s+n),v=h.slice(s+n),d={name:t,iv:p};typeof f=="string"&&(f=U(f));let g={name:"PBKDF2",salt:y,iterations:a,hash:{name:i}},b=await o.subtle.importKey("raw",f,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),_=await o.subtle.deriveKey(g,b,{name:t,length:r},!0,["decrypt"]),m=await o.subtle.decrypt(d,_,v);return new Uint8Array(m)}return{encrypt:l,decrypt:u}}var nk={};ct(nk,{RsaPrivateKey:()=>lm,RsaPublicKey:()=>B3,fromJwk:()=>Vke,generateKeyPair:()=>qke,unmarshalRsaPrivateKey:()=>Fke,unmarshalRsaPublicKey:()=>Kke}),c(),vr();var rk=w(K(),1);yr(),me();var WAt=w(Bx(),1),L3=w(st(),1);c(),c();var Lue=w(uh(),1),Bue=w(K(),1);function J_(e){if(isNaN(e)||e<=0)throw(0,Bue.default)(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return(0,Lue.default)(e)}me(),Re();var Kd={};ct(Kd,{jwkToPkcs1:()=>Oke,jwkToPkix:()=>Bke,pkcs1ToJwk:()=>Nke,pkixToJwk:()=>Lke}),c();var CAt=w(Aa(),1),PAt=w(sh(),1),Eu=w(st(),1);Re(),me();var JD=w(K(),1);function Nke(e){let t=Eu.default.asn1.fromDer(M(e,"ascii")),r=Eu.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:oa(r.n),e:oa(r.e),d:oa(r.d),p:oa(r.p),q:oa(r.q),dp:oa(r.dP),dq:oa(r.dQ),qi:oa(r.qInv),alg:"RS256"}}function Oke(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw(0,JD.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let t=Eu.default.pki.privateKeyToAsn1({n:Do(e.n),e:Do(e.e),d:Do(e.d),p:Do(e.p),q:Do(e.q),dP:Do(e.dp),dQ:Do(e.dq),qInv:Do(e.qi)});return U(Eu.default.asn1.toDer(t).getBytes(),"ascii")}function Lke(e){let t=Eu.default.asn1.fromDer(M(e,"ascii")),r=Eu.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:oa(r.n),e:oa(r.e)}}function Bke(e){if(e.n==null||e.e==null)throw(0,JD.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let t=Eu.default.pki.publicKeyToAsn1({n:Do(e.n),e:Do(e.e)});return U(Eu.default.asn1.toDer(t).getBytes(),"ascii")}c();var OAt=w(sh(),1),ek=w(st(),1);function Mue(e,t){return t.map(r=>Do(e[r]))}function Uue(e){return ek.default.pki.setRsaPrivateKey(...Mue(e,["n","e","d","p","q","dp","dq","qi"]))}function Fue(e){return ek.default.pki.setRsaPublicKey(...Mue(e,["n","e"]))}var Kue=w(K(),1);async function Vue(e){let t=await Zi.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Hue(t);return{privateKey:r[0],publicKey:r[1]}}async function tk(e){let t=[await Zi.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Mke(e)],r=await Hue({privateKey:t[0],publicKey:t[1]});return{privateKey:r[0],publicKey:r[1]}}async function que(e,t){let r=await Zi.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Zi.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function zue(e,t,r){let n=await Zi.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await Zi.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function Hue(e){if(e.privateKey==null||e.publicKey==null)throw(0,Kue.default)(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([Zi.get().subtle.exportKey("jwk",e.privateKey),Zi.get().subtle.exportKey("jwk",e.publicKey)])}async function Mke(e){return await Zi.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function $ue(e,t,r,n){let i=t?Fue(e):Uue(e),s=M(Uint8Array.from(r),"ascii"),a=n(s,i);return U(a,"ascii")}function Gue(e,t){return $ue(e,!0,t,(r,n)=>n.encrypt(r))}function Wue(e,t){return $ue(e,!1,t,(r,n)=>n.decrypt(r))}c(),ma();async function um(e,t){let r=await ZD().encrypt(e,t);return to.encode(r)}var B3=class{constructor(e){this._key=e}async verify(e,t){return await zue(this._key,t,e)}marshal(){return Kd.jwkToPkix(this._key)}get bytes(){return gu.encode({Type:Ei.RSA,Data:this.marshal()})}encrypt(e){return Gue(this._key,e)}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}},lm=class{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return J_(16)}async sign(e){return await que(this._key,e)}get public(){if(this._publicKey==null)throw(0,rk.default)(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new B3(this._publicKey)}decrypt(e){return Wue(this._key,e)}marshal(){return Kd.jwkToPkcs1(this._key)}get bytes(){return wu.encode({Type:Ei.RSA,Data:this.marshal()})}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}async id(){let e=await this.public.hash();return M(e,"base58btc")}async export(e,t="pkcs-8"){if(t==="pkcs-8"){let r=new L3.default.util.ByteBuffer(this.marshal()),n=L3.default.asn1.fromDer(r),i=L3.default.pki.privateKeyFromAsn1(n),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return L3.default.pki.encryptRsaPrivateKey(i,e,s)}else{if(t==="libp2p-key")return await um(this.bytes,e);throw(0,rk.default)(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function Fke(e){let t=Kd.pkcs1ToJwk(e),r=await tk(t);return new lm(r.privateKey,r.publicKey)}function Kke(e){let t=Kd.pkixToJwk(e);return new B3(t)}async function Vke(e){let t=await tk(e);return new lm(t.privateKey,t.publicKey)}async function qke(e){let t=await Vue(e);return new lm(t.privateKey,t.publicKey)}var ok={};ct(ok,{Ed25519PrivateKey:()=>Vd,Ed25519PublicKey:()=>M3,generateKeyPair:()=>Gke,generateKeyPairFromSeed:()=>Jue,unmarshalEd25519PrivateKey:()=>Hke,unmarshalEd25519PublicKey:()=>$ke}),c();var ik=w(K(),1);yr(),vr(),Hr(),va(),c();var fm=32,bu=64,ev=32;async function jue(){let e=hh.randomPrivateKey(),t=await t0(e);return{privateKey:Zue(e,t),publicKey:t}}async function Yue(e){if(e.length!==ev)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await t0(t);return{privateKey:Zue(t,r),publicKey:r}}async function Que(e,t){let r=e.slice(0,ev);return await l6(t,r)}async function Xue(e,t,r){return await f6(t,r,e)}function Zue(e,t){let r=new Uint8Array(bu);for(let n=0;n<ev;n++)r[n]=e[n],r[ev+n]=t[n];return r}var M3=class{constructor(e){this._key=hm(e,fm)}async verify(e,t){return await Xue(this._key,t,e)}marshal(){return this._key}get bytes(){return gu.encode({Type:Ei.Ed25519,Data:this.marshal()})}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}},Vd=class{constructor(e,t){this._key=hm(e,bu),this._publicKey=hm(t,fm)}async sign(e){return await Que(this._key,e)}get public(){return new M3(this._publicKey)}marshal(){return this._key}get bytes(){return wu.encode({Type:Ei.Ed25519,Data:this.marshal()})}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}async id(){let e=await $r.digest(this.public.bytes);return Ne.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if(t==="libp2p-key")return await um(this.bytes,e);throw(0,ik.default)(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function Hke(e){if(e.length>bu){e=hm(e,bu+fm);let n=e.slice(0,bu),i=e.slice(bu,e.length);return new Vd(n,i)}e=hm(e,bu);let t=e.slice(0,bu),r=e.slice(fm);return new Vd(t,r)}function $ke(e){return e=hm(e,fm),new M3(e)}async function Gke(){let{privateKey:e,publicKey:t}=await jue();return new Vd(e,t)}async function Jue(e){let{privateKey:t,publicKey:r}=await Yue(e);return new Vd(t,r)}function hm(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw(0,ik.default)(new Error(`Key must be a Uint8Array of length ${t}, got ${e.length}`),"ERR_INVALID_KEY_TYPE");return e}var ak={};ct(ak,{Secp256k1PrivateKey:()=>F3,Secp256k1PublicKey:()=>U3,generateKeyPair:()=>Qke,unmarshalSecp256k1PrivateKey:()=>jke,unmarshalSecp256k1PublicKey:()=>Yke}),c(),vr();var sle=w(K(),1);yr(),me(),c();var dm=w(K(),1);vr();function ele(){return Ii.randomPrivateKey()}async function tle(e,t){let{digest:r}=await xe.digest(t);try{return await w6(r,e)}catch(n){throw(0,dm.default)(n,"ERR_INVALID_INPUT")}}async function rle(e,t,r){try{let{digest:n}=await xe.digest(r);return E6(t,n,e)}catch(n){throw(0,dm.default)(n,"ERR_INVALID_INPUT")}}function nle(e){return Tt.fromHex(e).toRawBytes(!0)}function ile(e){try{a0(e,!0)}catch(t){throw(0,dm.default)(t,"ERR_INVALID_PRIVATE_KEY")}}function sk(e){try{Tt.fromHex(e)}catch(t){throw(0,dm.default)(t,"ERR_INVALID_PUBLIC_KEY")}}function ole(e){try{return a0(e,!0)}catch(t){throw(0,dm.default)(t,"ERR_INVALID_PRIVATE_KEY")}}var U3=class{constructor(e){sk(e),this._key=e}async verify(e,t){return await rle(this._key,t,e)}marshal(){return nle(this._key)}get bytes(){return gu.encode({Type:Ei.Secp256k1,Data:this.marshal()})}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}},F3=class{constructor(e,t){this._key=e,this._publicKey=t??ole(e),ile(this._key),sk(this._publicKey)}async sign(e){return await tle(this._key,e)}get public(){return new U3(this._publicKey)}marshal(){return this._key}get bytes(){return wu.encode({Type:Ei.Secp256k1,Data:this.marshal()})}equals(e){return Ce(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xe.digest(this.bytes);return e}async id(){let e=await this.public.hash();return M(e,"base58btc")}async export(e,t="libp2p-key"){if(t==="libp2p-key")return await um(this.bytes,e);throw(0,sle.default)(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function jke(e){return new F3(e)}function Yke(e){return new U3(e)}async function Qke(){let e=await ele();return new F3(e)}var cle={rsa:nk,ed25519:ok,secp256k1:ak};function Zke(e){let t=Object.keys(cle).join(" / ");return(0,ale.default)(new Error(`invalid or unsupported key type ${e}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}function ck(e){if(e=e.toLowerCase(),e==="rsa"||e==="ed25519"||e==="secp256k1")return cle[e];throw Zke(e)}async function uk(e,t){return await ck(e).generateKeyPair(t??2048)}function ule(e,t){return t=(t??"rsa").toLowerCase(),ck(t),e.bytes}function lle(e,t){return t=(t??"rsa").toLowerCase(),ck(t),e.bytes}Re(),c();var lk;(function(e){e.codec=()=>Xe({1:{name:"id",codec:ye},2:{name:"pubKey",codec:ye,optional:!0},3:{name:"privKey",codec:ye,optional:!0}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(lk||(lk={}));var tv=async()=>{let e=await uk("Ed25519"),t=await hle(e);if(t.type==="Ed25519")return t;throw new Error(`Generated unexpected PeerId type "${t.type}"`)},fle=async e=>{let t=await uk("RSA",e?.bits??2048),r=await hle(t);if(r.type==="RSA")return r;throw new Error(`Generated unexpected PeerId type "${r.type}"`)};async function hle(e){return await sn(ule(e.public),lle(e))}ur(),Re();var q3=w(K(),1);c();var gs=w(K(),1),rv=class extends Ue{get[rc](){return!0}get[Symbol.toStringTag](){return"@libp2p/dummy-dht"}get wan(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}get lan(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}get(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}findProviders(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}findPeer(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}getClosestPeers(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}provide(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}put(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}async getMode(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}async setMode(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}async refreshRoutingTable(){throw(0,gs.default)(new Error(_t.DHT_DISABLED),q.DHT_DISABLED)}};c();var _u=w(K(),1),nv=class extends Ue{isStarted(){return!1}start(){}stop(){}get globalSignaturePolicy(){throw(0,_u.default)(new Error(_t.PUBSUB_DISABLED),q.ERR_PUBSUB_DISABLED)}get multicodecs(){throw(0,_u.default)(new Error(_t.PUBSUB_DISABLED),q.ERR_PUBSUB_DISABLED)}getPeers(){throw(0,_u.default)(new Error(_t.PUBSUB_DISABLED),q.ERR_PUBSUB_DISABLED)}getTopics(){throw(0,_u.default)(new Error(_t.PUBSUB_DISABLED),q.ERR_PUBSUB_DISABLED)}subscribe(){throw(0,_u.default)(new Error(_t.PUBSUB_DISABLED),q.ERR_PUBSUB_DISABLED)}unsubscribe(){throw(0,_u.default)(new Error(_t.PUBSUB_DISABLED),q.ERR_PUBSUB_DISABLED)}getSubscribers(){throw(0,_u.default)(new Error(_t.PUBSUB_DISABLED),q.ERR_PUBSUB_DISABLED)}async publish(){throw(0,_u.default)(new Error(_t.PUBSUB_DISABLED),q.ERR_PUBSUB_DISABLED)}};c(),c(),c();function vu(e,t){let r={[Symbol.iterator]:()=>r,next:()=>{let n=e.next(),i=n.value;return n.done===!0||i==null?{done:!0,value:void 0}:{done:!1,value:t(i)}}};return r}var K3=class{constructor(e){if(this.map=new Map,e!=null)for(let[t,r]of e.entries())this.map.set(t.toString(),r)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){this.map.delete(e.toString())}entries(){return vu(this.map.entries(),e=>[ue(e[0]),e[1]])}forEach(e){this.map.forEach((t,r)=>{e(t,ue(r),this)})}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),t)}keys(){return vu(this.map.keys(),e=>ue(e))}values(){return this.map.values()}get size(){return this.map.size}};c();var V3=class{constructor(e){if(this.set=new Set,e!=null)for(let t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return vu(this.set.entries(),e=>{let t=ue(e[0]);return[t,t]})}forEach(e){this.set.forEach(t=>{let r=ue(t);e(r,r,this)})}has(e){return this.set.has(e.toString())}values(){return vu(this.set.values(),e=>ue(e))}};c();var pm=class{constructor(e){if(this.list=[],e!=null)for(let t of e)this.list.push(t.toString())}[Symbol.iterator](){return vu(this.list.entries(),e=>ue(e[1]))}concat(e){let t=new pm(this);for(let r of e)t.push(r);return t}entries(){return vu(this.list.entries(),e=>[e[0],ue(e[1])])}every(e){return this.list.every((t,r)=>e(ue(t),r,this))}filter(e){let t=new pm;return this.list.forEach((r,n)=>{let i=ue(r);e(i,n,this)&&t.push(i)}),t}find(e){let t=this.list.find((r,n)=>e(ue(r),n,this));if(t!=null)return ue(t)}findIndex(e){return this.list.findIndex((t,r)=>e(ue(t),r,this))}forEach(e){this.list.forEach((t,r)=>{e(ue(t),r,this)})}includes(e){return this.list.includes(e.toString())}indexOf(e){return this.list.indexOf(e.toString())}pop(){let e=this.list.pop();if(e!=null)return ue(e)}push(...e){for(let t of e)this.list.push(t.toString())}shift(){let e=this.list.shift();if(e!=null)return ue(e)}unshift(...e){let t=this.list.length;for(let r=e.length-1;r>-1;r--)t=this.list.unshift(e[r].toString());return t}get length(){return this.list.length}},Su=C("libp2p"),fk=class extends Ue{constructor(e){super(),this.initializables=[],this.started=!1,this.peerId=e.peerId,this.components=new He({peerId:e.peerId,datastore:e.datastore??new ny,connectionGater:{denyDialPeer:async()=>await Promise.resolve(!1),denyDialMultiaddr:async()=>await Promise.resolve(!1),denyInboundConnection:async()=>await Promise.resolve(!1),denyOutboundConnection:async()=>await Promise.resolve(!1),denyInboundEncryptedConnection:async()=>await Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>await Promise.resolve(!1),denyInboundUpgradedConnection:async()=>await Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>await Promise.resolve(!1),filterMultiaddrForPeer:async()=>await Promise.resolve(!0),...e.connectionGater}}),this.components.setPeerStore(new W_({addressFilter:this.components.getConnectionGater().filterMultiaddrForPeer,...e.peerStore})),this.services=[this.components],e.metrics.enabled&&(this.metrics=this.components.setMetrics(new m_(e.metrics))),this.peerStore=this.components.getPeerStore(),this.peerStore.addEventListener("peer",s=>{let{detail:a}=s;this.dispatchEvent(new ee("peer:discovery",{detail:a}))}),e.connectionProtector!=null&&this.components.setConnectionProtector(e.connectionProtector),this.components.setUpgrader(new E_(this.components,{connectionEncryption:(e.connectionEncryption??[]).map(s=>this.configureComponent(s)),muxers:(e.streamMuxers??[]).map(s=>this.configureComponent(s))})),this.connectionManager=this.components.setConnectionManager(new t_(e.connectionManager)),this.registrar=this.components.setRegistrar(new b_(this.components)),this.components.setTransportManager(new y_(this.components,e.transportManager)),this.components.setAddressManager(new $b(this.components,e.addresses)),this.configureComponent(new I_(this.components)),this.configureComponent(new r_(this.components,{enabled:e.connectionManager.autoDial,minConnections:e.connectionManager.minConnections,autoDialInterval:e.connectionManager.autoDialInterval}));let t=_3.generateOptions();this.keychain=this.configureComponent(new _3(this.components,{...t,...e.keychain})),this.services.push(new T_(this.components,e.nat)),e.transports.forEach(s=>{this.components.getTransportManager().add(this.configureComponent(s))}),e.streamMuxers!=null&&e.streamMuxers.length>0&&(this.identifyService=new im(this.components,{...e.identify}),this.configureComponent(this.identifyService)),e.dht!=null?this.dht=this.components.setDHT(e.dht):this.dht=new rv,e.pubsub!=null?this.pubsub=this.components.setPubSub(e.pubsub):this.pubsub=new nv;let r=(e.peerRouters??[]).map(s=>this.configureComponent(s));e.dht!=null&&(r.push(this.configureComponent(new C_(this.dht))),this.dht.addEventListener("peer",s=>{this.onDiscoveryPeer(s)})),this.peerRouting=this.components.setPeerRouting(this.configureComponent(new qb(this.components,{...e.peerRouting,routers:r})));let n=(e.contentRouters??[]).map(s=>this.configureComponent(s));e.dht!=null&&n.push(this.configureComponent(new j_(this.dht))),this.contentRouting=this.components.setContentRouting(this.configureComponent(new Hb(this.components,{routers:n}))),e.relay.enabled&&(this.components.getTransportManager().add(this.configureComponent(new i_)),this.configureComponent(new c_(this.components,{addressSorter:e.connectionManager.addressSorter,...e.relay}))),this.fetchService=this.configureComponent(new x_(this.components,{...e.fetch})),this.pingService=this.configureComponent(new R_(this.components,{...e.ping}));let i=this.configureComponent(new Y_(this.components,{enabled:e.connectionManager.autoDial!==!1,minConnections:e.connectionManager.minConnections,dialTimeout:e.connectionManager.dialTimeout??3e4}));this.addEventListener("peer:discovery",s=>{!this.isStarted()||i.handle(s)});for(let s of e.peerDiscovery??[])this.configureComponent(s),s.addEventListener("peer",a=>{this.onDiscoveryPeer(a)})}configureComponent(e){return iu(e)&&this.services.push(e),gi(e)&&this.initializables.push(e),e}async start(){if(!this.started){this.started=!0,Su("libp2p is starting");try{this.initializables.forEach(e=>{e.init(this.components)}),await Promise.all(this.services.map(async e=>{e.beforeStart!=null&&await e.beforeStart()})),await Promise.all(this.services.map(e=>e.start())),await Promise.all(this.services.map(async e=>{e.afterStart!=null&&await e.afterStart()})),Su("libp2p has started"),await this.components.getPeerStore().forEach(e=>{this.dispatchEvent(new ee("peer:discovery",{detail:{id:e.id,multiaddrs:e.addresses.map(t=>t.multiaddr),protocols:e.protocols}}))})}catch(e){throw Su.error("An error occurred starting libp2p",e),await this.stop(),e}}}async stop(){!this.started||(Su("libp2p is stopping"),this.started=!1,await Promise.all(this.services.map(async e=>{e.beforeStop!=null&&await e.beforeStop()})),await Promise.all(this.services.map(e=>e.stop())),await Promise.all(this.services.map(async e=>{e.afterStop!=null&&await e.afterStop()})),Su("libp2p has stopped"))}async loadKeychain(){if(this.keychain!=null)try{await this.keychain.findKeyByName("self")}catch{await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this.started}getConnections(e){return this.components.getConnectionManager().getConnections(e)}getPeers(){let e=new V3;for(let t of this.components.getConnectionManager().getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e,t={}){let{id:r,multiaddrs:n}=Td(e);return await this.components.getPeerStore().addressBook.add(r,n),await this.components.getConnectionManager().openConnection(r,t)}async dialProtocol(e,t,r={}){if(t==null)throw(0,q3.default)(new Error("no protocols were provided to open a stream"),q.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(t=Array.isArray(t)?t:[t],t.length===0)throw(0,q3.default)(new Error("no protocols were provided to open a stream"),q.ERR_INVALID_PROTOCOLS_FOR_STREAM);return await(await this.dial(e,r)).newStream(t,r)}getMultiaddrs(){return this.components.getAddressManager().getAddresses()}async hangUp(e){let{id:t}=Td(e);await this.components.getConnectionManager().closeConnections(t)}async getPublicKey(e,t={}){if(Su("getPublicKey %p",e),e.publicKey!=null)return e.publicKey;let r=await this.peerStore.get(e);if(r.pubKey!=null)return r.pubKey;if(this.dht==null)throw(0,q3.default)(new Error("Public key was not in the peer store and the DHT is not enabled"),q.ERR_NO_ROUTERS_AVAILABLE);let n=Ae([U("/pk/"),e.multihash.digest]);for await(let i of this.dht.get(n,t))if(i.name==="VALUE"){let s=ho(i.value);return await this.peerStore.keyBook.set(e,i.value),s.bytes}throw(0,q3.default)(new Error(`Node not responding with its public key: ${e.toString()}`),q.ERR_INVALID_RECORD)}async fetch(e,t,r={}){let{id:n,multiaddrs:i}=Td(e);return i!=null&&await this.components.getPeerStore().addressBook.add(n,i),await this.fetchService.fetch(n,t,r)}async ping(e,t={}){let{id:r,multiaddrs:n}=Td(e);return n.length>0&&await this.components.getPeerStore().addressBook.add(r,n),await this.pingService.ping(r,t)}async handle(e,t){return await this.components.getRegistrar().handle(e,t)}async unhandle(e){return await this.components.getRegistrar().unhandle(e)}onDiscoveryPeer(e){let{detail:t}=e;if(t.id.toString()===this.peerId.toString()){Su.error(new Error(q.ERR_DISCOVERED_SELF));return}t.multiaddrs.length>0&&this.components.getPeerStore().addressBook.add(t.id,t.multiaddrs).catch(r=>Su.error(r)),t.protocols.length>0&&this.components.getPeerStore().protoBook.set(t.id,t.protocols).catch(r=>Su.error(r)),this.dispatchEvent(new ee("peer:discovery",{detail:t}))}};async function dle(e){return e.peerId==null&&(e.peerId=await tv()),new fk(Due(e))}async function ple(e){return await dle(e)}c(),c(),c();var Vle=w(_le(),1);c(),vr(),Re(),me(),ur();var gk=w(Jb(),1);c();var vle="/lan",Sle="/ipfs",xle="/kad/1.0.0",Rle="/dht/record",yk="/dht/provider",Ale=Number(3e5),Tle=Number(30*1e3),Ile=Number(5*6e4),Cle=Number(30*1e3),Ple=Number(30*1e3),oNe=U("/pk/");function ym(e){return{...e,multiaddrs:e.multiaddrs.filter(t=>{let[[r,n]]=t.stringTuples();return r!==4&&r!==6||n==null?!1:!(0,gk.default)(n)})}}function gm(e){return{...e,multiaddrs:e.multiaddrs.filter(t=>{let[[r,n]]=t.stringTuples();return r!==4&&r!==6||n==null?!1:(0,gk.default)(n)})}}async function uc(e){return(await xe.digest(e)).digest}async function ko(e){return await uc(e.toBytes())}function xu(e){return new ae(`${Rle}/${M(e,"base32")}`,!1)}function Dle(e){return Ae([oNe,e.toBytes()])}function kle(e){return M(e.slice(0,4))==="/pk/"}function Nle(e){return Ir(e.slice(4))}function wk(e,t){let r=new Date;return new Vr(e,t,r).serialize()}c();var Kle=w(Xu(),1);c(),c();function bk(e,t,r){let n=0,i=e.length;for(;i>0;){let s=Math.trunc(i/2),a=n+s;r(e[a],t)<=0?(n=++a,i-=s+1):i=s}return n}var zd=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Ru,H3=class{constructor(){Ru.set(this,[])}enqueue(e,t){t={priority:0,...t};let r={priority:t.priority,run:e};if(this.size&&zd(this,Ru,"f")[this.size-1].priority>=t.priority){zd(this,Ru,"f").push(r);return}let n=bk(zd(this,Ru,"f"),r,(i,s)=>s.priority-i.priority);zd(this,Ru,"f").splice(n,0,r)}dequeue(){return zd(this,Ru,"f").shift()?.run}filter(e){return zd(this,Ru,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return zd(this,Ru,"f").length}};Ru=new WeakMap;var ir=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},Se=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Qn,G3,W3,Sf,lv,j3,sv,sa,$3,No,av,Oo,Y3,vf,wm,Em,Hd,cv,Ole,Lle,Fle,Ble,Mle,Ule,uv,_k,vk,fv,hv=()=>{},sNe=new hi,Sk=class extends Error{},Au=class extends Kle.default{constructor(e){var t,r,n,i;if(super(),Qn.add(this),G3.set(this,void 0),W3.set(this,void 0),Sf.set(this,0),lv.set(this,void 0),j3.set(this,void 0),sv.set(this,0),sa.set(this,void 0),$3.set(this,void 0),No.set(this,void 0),av.set(this,void 0),Oo.set(this,0),Y3.set(this,void 0),vf.set(this,void 0),wm.set(this,hv),Em.set(this,hv),Hd.set(this,void 0),cv.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:H3,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);ir(this,G3,e.carryoverConcurrencyCount,"f"),ir(this,W3,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),ir(this,lv,e.intervalCap,"f"),ir(this,j3,e.interval,"f"),ir(this,No,new e.queueClass,"f"),ir(this,av,e.queueClass,"f"),this.concurrency=e.concurrency,ir(this,Hd,e.timeout,"f"),ir(this,cv,e.throwOnTimeout===!0,"f"),ir(this,vf,e.autoStart===!1,"f")}get concurrency(){return Se(this,Y3,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);ir(this,Y3,e,"f"),Se(this,Qn,"m",fv).call(this)}async add(e,t={}){return new Promise((r,n)=>{let i=async()=>{var s,a,o;ir(this,Oo,(a=Se(this,Oo,"f"),a++,a),"f"),ir(this,Sf,(o=Se(this,Sf,"f"),o++,o),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){n(new Sk("The task was aborted."));return}let l=await(Se(this,Hd,"f")===void 0&&t.timeout===void 0?e({signal:t.signal}):nn(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?Se(this,Hd,"f"):t.timeout,()=>{(t.throwOnTimeout===void 0?Se(this,cv,"f"):t.throwOnTimeout)&&n(sNe)}));r(l),this.emit("completed",l)}catch(l){n(l),this.emit("error",l)}Se(this,Qn,"m",Fle).call(this)};Se(this,No,"f").enqueue(i,t),Se(this,Qn,"m",uv).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return Se(this,vf,"f")?(ir(this,vf,!1,"f"),Se(this,Qn,"m",fv).call(this),this):this}pause(){ir(this,vf,!0,"f")}clear(){ir(this,No,new(Se(this,av,"f")),"f")}async onEmpty(){if(Se(this,No,"f").size!==0)return new Promise(e=>{let t=Se(this,wm,"f");ir(this,wm,()=>{t(),e()},"f")})}async onSizeLessThan(e){if(!(Se(this,No,"f").size<e))return new Promise(t=>{let r=()=>{Se(this,No,"f").size<e&&(this.removeListener("next",r),t())};this.on("next",r)})}async onIdle(){if(!(Se(this,Oo,"f")===0&&Se(this,No,"f").size===0))return new Promise(e=>{let t=Se(this,Em,"f");ir(this,Em,()=>{t(),e()},"f")})}get size(){return Se(this,No,"f").size}sizeBy(e){return Se(this,No,"f").filter(e).length}get pending(){return Se(this,Oo,"f")}get isPaused(){return Se(this,vf,"f")}get timeout(){return Se(this,Hd,"f")}set timeout(e){ir(this,Hd,e,"f")}};G3=new WeakMap,W3=new WeakMap,Sf=new WeakMap,lv=new WeakMap,j3=new WeakMap,sv=new WeakMap,sa=new WeakMap,$3=new WeakMap,No=new WeakMap,av=new WeakMap,Oo=new WeakMap,Y3=new WeakMap,vf=new WeakMap,wm=new WeakMap,Em=new WeakMap,Hd=new WeakMap,cv=new WeakMap,Qn=new WeakSet,Ole=function(){return Se(this,W3,"f")||Se(this,Sf,"f")<Se(this,lv,"f")},Lle=function(){return Se(this,Oo,"f")<Se(this,Y3,"f")},Fle=function(){var e;ir(this,Oo,(e=Se(this,Oo,"f"),e--,e),"f"),Se(this,Qn,"m",uv).call(this),this.emit("next")},Ble=function(){Se(this,wm,"f").call(this),ir(this,wm,hv,"f"),Se(this,Oo,"f")===0&&(Se(this,Em,"f").call(this),ir(this,Em,hv,"f"),this.emit("idle"))},Mle=function(){Se(this,Qn,"m",vk).call(this),Se(this,Qn,"m",_k).call(this),ir(this,$3,void 0,"f")},Ule=function(){let e=Date.now();if(Se(this,sa,"f")===void 0){let t=Se(this,sv,"f")-e;if(t<0)ir(this,Sf,Se(this,G3,"f")?Se(this,Oo,"f"):0,"f");else return Se(this,$3,"f")===void 0&&ir(this,$3,setTimeout(()=>{Se(this,Qn,"m",Mle).call(this)},t),"f"),!0}return!1},uv=function(){if(Se(this,No,"f").size===0)return Se(this,sa,"f")&&clearInterval(Se(this,sa,"f")),ir(this,sa,void 0,"f"),Se(this,Qn,"m",Ble).call(this),!1;if(!Se(this,vf,"f")){let e=!Se(this,Qn,"m",Ule).call(this);if(Se(this,Qn,"a",Ole)&&Se(this,Qn,"a",Lle)){let t=Se(this,No,"f").dequeue();return t?(this.emit("active"),t(),e&&Se(this,Qn,"m",_k).call(this),!0):!1}}return!1},_k=function(){Se(this,W3,"f")||Se(this,sa,"f")!==void 0||(ir(this,sa,setInterval(()=>{Se(this,Qn,"m",vk).call(this)},Se(this,j3,"f")),"f"),ir(this,sv,Date.now()+Se(this,j3,"f"),"f"))},vk=function(){Se(this,Sf,"f")===0&&Se(this,Oo,"f")===0&&Se(this,sa,"f")&&(clearInterval(Se(this,sa,"f")),ir(this,sa,void 0,"f")),ir(this,Sf,Se(this,G3,"f")?Se(this,Oo,"f"):0,"f"),Se(this,Qn,"m",fv).call(this)},fv=function(){for(;Se(this,Qn,"m",uv).call(this););};var qle=w($o(),1),xk="routing-table-size",aNe="ping-queue-size",cNe="ping-running",dv=class{constructor(e){this.components=new He;let{kBucketSize:t,pingTimeout:r,lan:n,pingConcurrency:i,protocol:s}=e;this.log=C(`libp2p:kad-dht:${n?"lan":"wan"}:routing-table`),this.kBucketSize=t??20,this.pingTimeout=r??1e4,this.pingConcurrency=i??10,this.lan=n,this.running=!1,this.protocol=s;let a=()=>{this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:aNe,value:this.pingQueue.size}),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:cNe,value:this.pingQueue.pending})};this.pingQueue=new Au({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",a),this.pingQueue.addListener("next",a),this._onPing=this._onPing.bind(this)}init(e){this.components=e}isStarted(){return this.running}async start(){this.running=!0;let e=new Vle.default({localNodeId:await ko(this.components.getPeerId()),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});e.on("ping",this._onPing),this.kb=e}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_onPing(e,t){this.pingQueue.add(async()=>{if(!this.running)return;let r=0;try{await Promise.all(e.map(async n=>{let i;try{i=new qle.TimeoutController(this.pingTimeout);let s={signal:i.signal};this.log("pinging old contact %p",n.peer);let a=await this.components.getConnectionManager().openConnection(n.peer,s),{stream:o}=await a.newStream(this.protocol,s);o.close(),r++}catch(s){this.running&&this.kb!=null&&(this.log.error("could not ping peer %p",n.peer,s),this.log("evicting old contact after ping failed %p",n),this.kb.remove(n.id))}finally{i?.clear(),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:xk,value:this.size})}})),this.running&&r<e.length&&this.kb!=null&&(this.log("adding new contact %p",t.peer),this.kb.add(t))}catch(n){this.log.error("could not process k-bucket ping event",n)}}).catch(r=>{this.log.error("could not process k-bucket ping event",r)})}get size(){return this.kb==null?0:this.kb.count()}async find(e){let t=await ko(e),r=this.closestPeer(t);if(r!=null&&e.equals(r))return r}closestPeer(e){let t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t=this.kBucketSize){return this.kb==null?[]:this.kb.closest(e,t).map(r=>r.peer)}async add(e){if(this.kb==null)throw new Error("RoutingTable is not started");let t=await ko(e);this.kb.add({id:t,peer:e}),this.log("added %p with kad id %b",e,t),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:xk,value:this.size})}async remove(e){if(this.kb==null)throw new Error("RoutingTable is not started");let t=await ko(e);this.kb.remove(t),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:xk,value:this.size})}};c(),c();var zle=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];vr();var Hle=w(Jy(),1),$le=w($o(),1),pv=15,mv=class{constructor(e){let{peerRouting:t,routingTable:r,refreshInterval:n,refreshQueryTimeout:i,lan:s}=e;this.log=C(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table:refresh`),this.peerRouting=t,this.routingTable=r,this.refreshInterval=n??Ile,this.refreshQueryTimeout=i??Cle,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}init(e){}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){this.refreshTimeoutId!=null&&clearTimeout(this.refreshTimeoutId)}refreshTable(e=!1){this.log("refreshing routing table");let t=this._maxCommonPrefix(),r=this._getTrackedCommonPrefixLengthsForRefresh(t);this.log(`max common prefix length ${t}`),this.log(`tracked CPLs [ ${r.map(n=>n.toISOString()).join(", ")} ]`),Promise.all(r.map(async(n,i)=>{try{if(await this._refreshCommonPrefixLength(i,n,e),this._numPeersForCpl(t)===0){let s=Math.min(2*(i+1),r.length-1);for(let a=i+1;a<s+1;a++)try{await this._refreshCommonPrefixLength(a,n,e)}catch(o){this.log.error(o)}}}catch(s){this.log.error(s)}})).catch(n=>{this.log.error(n)}).then(()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),this.refreshTimeoutId.unref!=null&&this.refreshTimeoutId.unref()}).catch(n=>{this.log.error(n)})}async _refreshCommonPrefixLength(e,t,r){if(!r&&t.getTime()>Date.now()-this.refreshInterval){this.log("not running refresh for cpl %s as time since last refresh not above interval",e);return}let n=await this._generateRandomPeerId(e);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,n,this.routingTable.size);let i=new $le.TimeoutController(this.refreshQueryTimeout);try{let s=await(0,Hle.default)(this.peerRouting.getClosestPeers(n.toBytes(),{signal:i.signal}));this.log(`found ${s} peers that were close to imaginary peer %p`,n),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,n,this.routingTable.size)}finally{i.clear()}}_getTrackedCommonPrefixLengthsForRefresh(e){e>pv&&(e=pv);let t=[];for(let r=0;r<=e;r++)t[r]=this.commonPrefixLengthRefreshedAt[r]??new Date;return t}async _generateRandomPeerId(e){if(this.routingTable.kb==null)throw new Error("Routing table not started");let t=Fs(2),r=(t[1]<<8)+t[0],n=await this._makePeerId(this.routingTable.kb.localNodeId,r,e);return Ir(n)}async _makePeerId(e,t,r){if(r>pv)throw new Error(`Cannot generate peer ID for common prefix length greater than ${pv}`);let n=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1)^32768>>r,i=65535<<16-(r+1),s=n&i|t&~i,a=zle[s],o=new ArrayBuffer(34),l=new DataView(o,0,o.byteLength);return l.setUint8(0,xe.code),l.setUint8(1,32),l.setUint32(2,a,!1),new Uint8Array(l.buffer,l.byteOffset,l.byteLength)}_maxCommonPrefix(){let e=0;for(let t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(let r of this._prefixLengths())r===e&&t++;return t}*_prefixLengths(){if(this.routingTable.kb!=null)for(let{id:e}of this.routingTable.kb.toIterable()){let t=Pc(this.routingTable.kb.localNodeId,e),r=0;for(let n of t)if(n===0)r++;else break;yield r}}};c();var Qle=w(K(),1),Xle=w(Ci(),1),Zle=w(Gc(),1);c(),c();var Gle;(function(e){e.codec=()=>Xe({1:{name:"key",codec:ye,optional:!0},2:{name:"value",codec:ye,optional:!0},3:{name:"author",codec:ye,optional:!0},4:{name:"signature",codec:ye,optional:!0},5:{name:"timeReceived",codec:pn,optional:!0}}),e.encode=t=>Qe(t,e.codec()),e.decode=t=>Ye(t,e.codec())})(Gle||(Gle={}));var xf;(function(e){let t;(function(a){a.PUT_VALUE="PUT_VALUE",a.GET_VALUE="GET_VALUE",a.ADD_PROVIDER="ADD_PROVIDER",a.GET_PROVIDERS="GET_PROVIDERS",a.FIND_NODE="FIND_NODE",a.PING="PING"})(t=e.MessageType||(e.MessageType={}));let r;(function(a){a[a.PUT_VALUE=0]="PUT_VALUE",a[a.GET_VALUE=1]="GET_VALUE",a[a.ADD_PROVIDER=2]="ADD_PROVIDER",a[a.GET_PROVIDERS=3]="GET_PROVIDERS",a[a.FIND_NODE=4]="FIND_NODE",a[a.PING=5]="PING"})(r||(r={})),function(a){a.codec=()=>xi(r)}(t=e.MessageType||(e.MessageType={}));let n;(function(a){a.NOT_CONNECTED="NOT_CONNECTED",a.CONNECTED="CONNECTED",a.CAN_CONNECT="CAN_CONNECT",a.CANNOT_CONNECT="CANNOT_CONNECT"})(n=e.ConnectionType||(e.ConnectionType={}));let i;(function(a){a[a.NOT_CONNECTED=0]="NOT_CONNECTED",a[a.CONNECTED=1]="CONNECTED",a[a.CAN_CONNECT=2]="CAN_CONNECT",a[a.CANNOT_CONNECT=3]="CANNOT_CONNECT"})(i||(i={})),function(a){a.codec=()=>xi(i)}(n=e.ConnectionType||(e.ConnectionType={}));let s;(function(a){a.codec=()=>Xe({1:{name:"id",codec:ye,optional:!0},2:{name:"addrs",codec:ye,repeats:!0},3:{name:"connection",codec:e.ConnectionType.codec(),optional:!0}}),a.encode=o=>Qe(o,a.codec()),a.decode=o=>Ye(o,a.codec())})(s=e.Peer||(e.Peer={})),e.codec=()=>Xe({1:{name:"type",codec:e.MessageType.codec(),optional:!0},10:{name:"clusterLevelRaw",codec:cx,optional:!0},2:{name:"key",codec:ye,optional:!0},3:{name:"record",codec:ye,optional:!0},8:{name:"closerPeers",codec:e.Peer.codec(),repeats:!0},9:{name:"providerPeers",codec:e.Peer.codec(),repeats:!0}}),e.encode=a=>Qe(a,e.codec()),e.decode=a=>Ye(a,e.codec())})(xf||(xf={}));var fn=xf.MessageType,uNe=xf.ConnectionType,Yle=Object.keys(fn),Mr=class{constructor(e,t,r){if(!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this.clusterLevelRaw=r,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this.clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this.clusterLevelRaw=e}serialize(){return xf.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(Wle),providerPeers:this.providerPeers.map(Wle),record:this.record==null?void 0:this.record.serialize()})}static deserialize(e){let t=xf.decode(e),r=new Mr(t.type??xf.MessageType.PUT_VALUE,t.key??Uint8Array.from([]),t.clusterLevelRaw??0);return r.closerPeers=t.closerPeers.map(jle),r.providerPeers=t.providerPeers.map(jle),t.record?.length!=null&&(r.record=Vr.deserialize(t.record)),r}};function Wle(e){return{id:e.id.toBytes(),addrs:(e.multiaddrs??[]).map(t=>t.bytes),connection:uNe.CONNECTED}}function jle(e){if(e.id==null)throw new Error("Invalid peer in message");return{id:Ir(e.id),multiaddrs:(e.addrs??[]).map(t=>new j(t)),protocols:[]}}c();function Rk(e){return{...e,name:"SENDING_QUERY",type:0,messageName:e.type,messageType:Yle.indexOf(e.type.toString())}}function Q3(e){return{...e,name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:e.closer!=null?e.closer:[],providers:e.providers!=null?e.providers:[]}}function X3(e){return{...e,name:"FINAL_PEER",type:2}}function Li(e){return{...e,name:"QUERY_ERROR",type:3}}function Ak(e){return{...e,name:"PROVIDER",type:4}}function Z3(e){return{...e,name:"VALUE",type:5}}function Tk(e){return{...e,name:"DIALING_PEER",type:7}}var yv=class extends Ue{constructor(e){super(),this.components=new He;let{protocol:t,lan:r}=e;this.log=C(`libp2p:kad-dht:${r?"lan":"wan"}:network`),this.running=!1,this.protocol=t}init(e){this.components=e}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async*sendRequest(e,t,r={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield Tk({peer:e}),yield Rk({to:e,type:t.type});let n;try{n=(await(await this.components.getConnectionManager().openConnection(e,r)).newStream(this.protocol,r)).stream;let i=await this._writeReadMessage(n,t.serialize(),r);yield Q3({from:e,messageType:i.type,closer:i.closerPeers,providers:i.providerPeers,record:i.record})}catch(i){yield Li({from:e,error:i})}finally{n?.close()}}async*sendMessage(e,t,r={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield Tk({peer:e}),yield Rk({to:e,type:t.type});let n;try{n=(await(await this.components.getConnectionManager().openConnection(e,r)).newStream(this.protocol,r)).stream,await this._writeMessage(n,t.serialize(),r),yield Q3({from:e,messageType:t.type})}catch(i){yield Li({from:e,error:i})}finally{n?.close()}}async _writeMessage(e,t,r){r.signal!=null&&(e=as(e,r.signal)),await Te([t],kr(),e,Xle.default)}async _writeReadMessage(e,t,r){r.signal!=null&&(e=as(e,r.signal));let n=await Te([t],kr(),e,Er(),async s=>{let a=await(0,Zle.default)(s);if(a!=null)return a;throw(0,Qle.default)(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED")}),i=Mr.deserialize(n);return i.closerPeers.forEach(s=>{this.dispatchEvent(new ee("peer",{detail:s}))}),i.providerPeers.forEach(s=>{this.dispatchEvent(new ee("peer",{detail:s}))}),i}};c();var wv=w(K(),1);yr(),c();var bm=w(K(),1);me(),vr(),yr();function _m(e,t){let r=t.key,n=M(r).split("/");if(n.length<3)return;let i=e[n[1].toString()];if(i==null){let s="Invalid record keytype";throw(0,bm.default)(new Error(s),"ERR_INVALID_RECORD_KEY_TYPE")}return i(r,t.value)}var lNe=async(e,t)=>{if(!(e instanceof Uint8Array))throw(0,bm.default)(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw(0,bm.default)(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(M(e.subarray(0,4))!=="/pk/")throw(0,bm.default)(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let r=e.slice(4),n=await xe.digest(t);if(!Ce(r,n.bytes))throw(0,bm.default)(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")},Jle={pk:lNe};c();var gv=w(K(),1);me();function efe(e,t,r){if(r.length===0){let s="No records given";throw(0,gv.default)(new Error(s),"ERR_NO_RECORDS_RECEIVED")}let n=M(t).split("/");if(n.length<3){let s="Record key does not have a selector function";throw(0,gv.default)(new Error(s),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let i=e[n[1].toString()];if(i==null){let s=`Unrecognized key prefix: ${n[1]}`;throw(0,gv.default)(new Error(s),"ERR_UNRECOGNIZED_KEY_PREFIX")}return r.length===1?0:i(t,r)}function fNe(e,t){return 0}var tfe={pk:fNe},rfe=w(n5(),1),nfe=w(ei(),1),Ev=class{constructor(e){this.components=new He;let{validators:t,selectors:r,peerRouting:n,queryManager:i,routingTable:s,network:a,lan:o}=e;this.log=C(`libp2p:kad-dht:${o?"lan":"wan"}:content-fetching`),this.validators=t,this.selectors=r,this.peerRouting=n,this.queryManager=i,this.routingTable=s,this.network=a}init(e){this.components=e}async putLocal(e,t){let r=xu(e);await this.components.getDatastore().put(r,t)}async getLocal(e){this.log("getLocal %b",e);let t=xu(e);this.log("fetching record for key %k",t);let r=await this.components.getDatastore().get(t);this.log("found %k in local datastore",t);let n=Vr.deserialize(r);return await _m(this.validators,n),n}async*sendCorrectionRecord(e,t,r,n={}){this.log("sendCorrection for %b",e);let i=await wk(e,r);for(let{value:s,from:a}of t){if(Ce(s,r)){this.log("record was ok");continue}if(this.components.getPeerId().equals(a)){try{let u=xu(e);this.log(`Storing corrected record for key ${u.toString()}`),await this.components.getDatastore().put(u,i)}catch(u){this.log.error("Failed error correcting self",u)}continue}let o=!1,l=new Mr(fn.PUT_VALUE,e,0);l.record=Vr.deserialize(i);for await(let u of this.network.sendRequest(a,l,n))u.name==="PEER_RESPONSE"&&u.record!=null&&Ce(u.record.value,Vr.deserialize(i).value)&&(o=!0),yield u;o||(yield Li({from:a,error:(0,wv.default)(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this.log.error("Failed error correcting entry")}}async*put(e,t,r={}){this.log("put key %b value %b",e,t);let n=await wk(e,t),i=xu(e);this.log(`storing record for key ${i.toString()}`),await this.components.getDatastore().put(i,n),yield*Te(this.peerRouting.getClosestPeers(e,{signal:r.signal}),s=>(0,nfe.default)(s,a=>async()=>{if(a.name!=="FINAL_PEER")return[a];let o=[],l=new Mr(fn.PUT_VALUE,e,0);l.record=Vr.deserialize(n),this.log("send put to %p",a.peer.id);for await(let u of this.network.sendRequest(a.peer.id,l,r))o.push(u),u.name==="PEER_RESPONSE"&&(u.record!=null&&Ce(u.record.value,Vr.deserialize(n).value)||o.push(Li({from:a.peer.id,error:(0,wv.default)(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return o}),s=>(0,rfe.default)(s,{ordered:!1,concurrency:3}),async function*(s){for await(let a of s)yield*a})}async*get(e,t={}){this.log("get %b",e);let r=[];for await(let a of this.getMany(e,t))a.name==="VALUE"&&r.push(a),yield a;if(r.length===0)return;let n=r.map(a=>a.value),i=0;try{i=efe(this.selectors,e,n)}catch(a){if(a.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw a}let s=n[i];if(this.log("GetValue %b %b",e,s),s==null)throw(0,wv.default)(new Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(e,r,s,t),yield r[i]}async*getMany(e,t={}){this.log("getMany values for %b",e);try{let a=await this.getLocal(e);yield Z3({value:a.value,from:this.components.getPeerId()})}catch(a){this.log("error getting local value for %b",e,a)}let r=await uc(e),n=this.routingTable.closestPeers(r);this.log("found %d peers in routing table",n.length);let i=this,s=async function*({peer:a,signal:o}){for await(let l of i.peerRouting.getValueOrPeers(a,e,{signal:o}))yield l,l.name==="PEER_RESPONSE"&&l.record!=null&&(yield Z3({from:a,value:l.record.value}))};yield*this.queryManager.run(e,n,s,t)}};c();var ife=w(n5(),1),ofe=w(ei(),1),bv=class{constructor(e){this.components=new He;let{network:t,peerRouting:r,queryManager:n,routingTable:i,providers:s,lan:a}=e;this.log=C(`libp2p:kad-dht:${a?"lan":"wan"}:content-routing`),this.network=t,this.peerRouting=r,this.queryManager=n,this.routingTable=i,this.providers=s}init(e){this.components=e}async*provide(e,t,r={}){this.log("provide %s",e),await this.providers.addProvider(e,this.components.getPeerId());let n=new Mr(fn.ADD_PROVIDER,e.bytes,0);n.providerPeers=[{id:this.components.getPeerId(),multiaddrs:t,protocols:[]}];let i=0,s=a=>async()=>{if(a.name!=="FINAL_PEER")return[a];let o=[];this.log("putProvider %s to %p",e,a.peer.id);try{this.log("sending provider record for %s to %p",e,a.peer.id);for await(let l of this.network.sendMessage(a.peer.id,n,r))l.name==="PEER_RESPONSE"&&(this.log("sent provider record for %s to %p",e,a.peer.id),i++),o.push(l)}catch(l){this.log.error("error sending provide record to peer %p",a.peer.id,l),o.push(Li({from:a.peer.id,error:l}))}return o};yield*Te(this.peerRouting.getClosestPeers(e.multihash.bytes,r),a=>(0,ofe.default)(a,o=>s(o)),a=>(0,ife.default)(a,{ordered:!1,concurrency:3}),async function*(a){for await(let o of a)yield*o}),this.log("sent provider records to %d peers",i)}async*findProviders(e,t){let r=this.routingTable.kBucketSize,n=e.multihash.bytes,i=await uc(n),s=this;this.log("findProviders %c",e);let a=await this.providers.getProviders(e);if(a.length>0){let u=[];for(let h of a.slice(0,r))u.push({id:h,multiaddrs:(await this.components.getPeerStore().addressBook.get(h)??[]).map(f=>f.multiaddr),protocols:[]});yield Q3({from:this.components.getPeerId(),messageType:fn.GET_PROVIDERS,providers:u}),yield Ak({from:this.components.getPeerId(),providers:u})}if(a.length>=r)return;let o=async function*({peer:u,signal:h}){let f=new Mr(fn.GET_PROVIDERS,n,0);yield*s.network.sendRequest(u,f,{signal:h})},l=new Set(a.map(u=>u.toString()));for await(let u of this.queryManager.run(n,this.routingTable.closestPeers(i),o,t))if(yield u,u.name==="PEER_RESPONSE"){this.log("Found %d provider entries for %c and %d closer peers",u.providers.length,e,u.closer.length);let h=[];for(let f of u.providers)l.has(f.id.toString())||(l.add(f.id.toString()),h.push(f));if(h.length>0&&(yield Ak({from:u.from,providers:h})),l.size===r)return}}};c();var $d=w(K(),1);me(),c();var _v=class{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(n=>n.peerId.equals(e))!=null)return;let t=await ko(e),r={peerId:e,distance:Pc(this.originDhtKey,t)};this.peerDistances.push(r),this.peerDistances.sort((n,i)=>eh(n.distance,i.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(e.length===0)return!1;if(this.length===0)return!0;let t=await Promise.all(e.map(ko)),r=this.peerDistances[this.peerDistances.length-1].distance;for(let n of t){let i=Pc(this.originDhtKey,n);if(eh(i,r)<0)return!0}return!1}},vv=class{constructor(e){this.components=new He;let{routingTable:t,network:r,validators:n,queryManager:i,lan:s}=e;this.routingTable=t,this.network=r,this.validators=n,this.queryManager=i,this.log=C(`libp2p:kad-dht:${s?"lan":"wan"}:peer-routing`)}init(e){this.components=e}async findPeerLocal(e){let t,r=await this.routingTable.find(e);if(r!=null){this.log("findPeerLocal found %p in routing table",e);try{t=await this.components.getPeerStore().get(r)}catch(n){if(n.code!=="ERR_NOT_FOUND")throw n}}if(t==null)try{t=await this.components.getPeerStore().get(e)}catch(n){if(n.code!=="ERR_NOT_FOUND")throw n}if(t!=null)return this.log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map(n=>n.multiaddr),protocols:[]}}async*_getValueSingle(e,t,r={}){let n=new Mr(fn.GET_VALUE,t,0);yield*this.network.sendRequest(e,n,r)}async*getPublicKeyFromNode(e,t={}){let r=Dle(e);for await(let n of this._getValueSingle(e,r,t))if(yield n,n.name==="PEER_RESPONSE"&&n.record!=null){let i=await sn(v6.marshalPublicKey({bytes:n.record.value}));if(!i.equals(e))throw(0,$d.default)(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(i.publicKey==null)throw(0,$d.default)(new Error("public key missing"),"ERR_PUBLIC_KEY_MISSING");yield Z3({from:e,value:i.publicKey})}throw(0,$d.default)(new Error(`Node not responding with its public key: ${e.toString()}`),"ERR_INVALID_RECORD")}async*findPeer(e,t={}){this.log("findPeer %p",e);let r=await this.findPeerLocal(e);if(r!=null){this.log("found local"),yield X3({from:this.components.getPeerId(),peer:r});return}let n=await ko(e),i=this.routingTable.closestPeers(n);if(i.find(l=>l.equals(e))!=null)try{let l=await this.components.getPeerStore().get(e);this.log("found in peerStore"),yield X3({from:this.components.getPeerId(),peer:{id:l.id,multiaddrs:l.addresses.map(u=>u.multiaddr),protocols:[]}});return}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}let s=this,a=async function*({peer:l,signal:u}){let h=new Mr(fn.FIND_NODE,e.toBytes(),0);for await(let f of s.network.sendRequest(l,h,{signal:u}))if(yield f,f.name==="PEER_RESPONSE"){let y=f.closer.find(p=>p.id.equals(e));y!=null&&(yield X3({from:f.from,peer:y}))}},o=!1;for await(let l of this.queryManager.run(e.toBytes(),i,a,t))l.name==="FINAL_PEER"&&(o=!0),yield l;o||(yield Li({from:this.components.getPeerId(),error:(0,$d.default)(new Error("Not found"),"ERR_NOT_FOUND")}))}async*getClosestPeers(e,t={}){this.log("getClosestPeers to %b",e);let r=await uc(e),n=this.routingTable.closestPeers(r),i=this,s=new _v(r,this.routingTable.kBucketSize);await Promise.all(n.map(async o=>await s.add(o)));let a=async function*({peer:o,signal:l}){i.log("closerPeersSingle %s from %p",M(e,"base32"),o);let u=new Mr(fn.FIND_NODE,e,0);yield*i.network.sendRequest(o,u,{signal:l})};for await(let o of this.queryManager.run(e,n,a,t))yield o,o.name==="PEER_RESPONSE"&&await Promise.all(o.closer.map(async l=>await s.add(l.id)));this.log("found %d peers close to %b",s.length,e);for(let o of s.peers)yield X3({from:this.components.getPeerId(),peer:{id:o,multiaddrs:(await this.components.getPeerStore().addressBook.get(o)??[]).map(l=>l.multiaddr),protocols:[]}})}async*getValueOrPeers(e,t,r={}){for await(let n of this._getValueSingle(e,t,r)){if(n.name==="PEER_RESPONSE"&&n.record!=null)try{await this._verifyRecordOnline(n.record)}catch{let i="invalid record received, discarded";this.log(i),yield Li({from:n.from,error:(0,$d.default)(new Error(i),"ERR_INVALID_RECORD")});continue}yield n}}async _verifyRecordOnline(e){if(e.timeReceived==null)throw(0,$d.default)(new Error("invalid record received"),"ERR_INVALID_RECORD");await _m(this.validators,new Vr(e.key,e.value,e.timeReceived))}async getCloserPeersOffline(e,t){let r=await uc(e),n=this.routingTable.closestPeers(r),i=[];for(let s of n)if(!s.equals(t))try{let a=await this.components.getPeerStore().addressBook.get(s),o=await this.components.getPeerStore().protoBook.get(s);i.push({id:s,multiaddrs:a.map(l=>l.multiaddr),protocols:o})}catch(a){if(a.code!=="ERR_NOT_FOUND")throw a}return i.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",i.length,e,t):this.log("getCloserPeersOffline could not find peer closer to %b than %p",e,t),i}};c();var sfe=w(Mp(),1),Ik=w(ai(),1);me();var Tu=C("libp2p:kad-dht:providers"),Sv=class{constructor(e={}){this.components=new He;let{cacheSize:t,cleanupInterval:r,provideValidity:n}=e;this.cleanupInterval=r??36e5,this.provideValidity=n??864e5,this.cache=(0,sfe.default)(t??256),this.syncQueue=new Au({concurrency:1}),this.started=!1}init(e){this.components=e}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval(()=>{this._cleanup().catch(e=>{Tu.error(e)})},this.cleanupInterval))}async stop(){this.started=!1,this.cleaner!=null&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){return await this.syncQueue.add(async()=>{let e=Date.now(),t=0,r=0,n=new Map,i=this.components.getDatastore().batch(),s=this.components.getDatastore().query({prefix:yk});for await(let a of s)try{let{cid:o,peerId:l}=afe(a.key),u=cfe(a.value).getTime(),h=Date.now(),f=h-u,y=f>this.provideValidity;if(Tu("comparing: %d - %d = %d > %d %s",h,u,f,this.provideValidity,y?"(expired)":""),y){r++,i.delete(a.key);let p=n.get(o)??new Set;p.add(l),n.set(o,p)}t++}catch(o){Tu.error(o.message)}n.size>0?(Tu("deleting %d / %d entries",r,t),await i.commit()):Tu("nothing to delete");for(let[a,o]of n){let l=J3(a),u=this.cache.get(l);if(u!=null){for(let h of o)u.delete(h);u.size===0?this.cache.remove(l):this.cache.set(l,u)}}Tu("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let t=J3(e),r=this.cache.get(t);return r==null&&(r=await yNe(this.components.getDatastore(),e),this.cache.set(t,r)),r}async addProvider(e,t){return await this.syncQueue.add(async()=>{Tu("%p provides %s",t,e);let r=await this._getProvidersMap(e);Tu("loaded %s provs",r.size);let n=new Date;r.set(t.toString(),n);let i=J3(e);this.cache.set(i,r),await mNe(this.components.getDatastore(),e,t,n)})}async getProviders(e){return await this.syncQueue.add(async()=>(Tu("get providers for %s",e),[...(await this._getProvidersMap(e)).keys()].map(t=>ue(t))))}};function J3(e){let t=typeof e=="string"?e:M(e.multihash.bytes,"base32");return`${yk}/${t}`}async function mNe(e,t,r,n){let i=[J3(t),"/",r.toString()].join(""),s=new ae(i),a=Uint8Array.from(Ik.default.encode(n.getTime()));return await e.put(s,a)}function afe(e){let t=e.toString().split("/");if(t.length!==5)throw new Error(`incorrectly formatted provider entry key in datastore: ${e.toString()}`);return{cid:t[3],peerId:t[4]}}async function yNe(e,t){let r=new Map,n=e.query({prefix:J3(t)});for await(let i of n){let{peerId:s}=afe(i.key);r.set(s,cfe(i.value))}return r}function cfe(e){return new Date(Ik.default.decode(e))}c();var pfe=w($o(),1),mfe=w(Vi(),1);me(),c(),me();var ufe=w(K(),1),lfe=w($o(),1),ffe=w(Vi(),1),gNe=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*hfe(e){let{key:t,startingPeer:r,ourPeerId:n,signal:i,query:s,alpha:a,pathIndex:o,numPaths:l,cleanUp:u,queryFuncTimeout:h,log:f}=e,y=new Au({concurrency:a}),p=await uc(t),v=new Set;function d(g,b){if(g==null)return;v.add(g.toString());let _=BigInt("0x"+M(Pc(b,p),"base16"));y.add(async()=>{let m,E=[i];h!=null&&(m=new lfe.TimeoutController(h),E.push(m.signal));let D=(0,ffe.anySignal)(E);try{for await(let N of s({key:t,peer:g,signal:D,pathIndex:o,numPaths:l})){if(D.aborted)return;if(N.name==="PEER_RESPONSE")for(let R of N.closer){if(v.has(R.id.toString())){f("already seen %p in query",R.id);continue}if(n.equals(R.id)){f("not querying ourselves");continue}let T=await ko(R.id);if(BigInt("0x"+M(Pc(T,p),"base16"))>_){f("skipping %p as they are not closer to %b than %p",R.id,t,g);continue}f("querying closer peer %p",R.id),d(R.id,T)}y.emit("completed",N)}m?.clear()}catch(N){i.aborted?y.emit("error",N):y.emit("completed",Li({from:g,error:N}))}finally{m?.clear()}},{priority:gNe-_}).catch(m=>{f.error(m)})}d(r,await ko(r)),yield*wNe(y,i,u,f)}async function*wNe(e,t,r,n){let i=Ar(),s=!0,a=[],o=()=>{!s||(n("clean up queue, results %d, queue size %d, pending tasks %d",a.length,e.size,e.pending),s=!1,e.clear(),a.splice(0,a.length))};for(e.on("completed",l=>{a.push(l),i.resolve()}),e.on("error",l=>{n("queue error",l),o(),i.reject(l)}),e.on("idle",()=>{n("queue idle"),s=!1,i.resolve()}),t.addEventListener("abort",()=>{n("abort queue");let l=s;o(),l&&i.reject((0,ufe.default)(new Error("Query aborted"),"ERR_QUERY_ABORTED"))}),r.addEventListener("cleanup",()=>{o(),i.resolve()});s;)for(await i.promise,i=Ar();a.length>0;){let l=a.shift();l!=null&&(yield l)}yield*a}var yfe=w(Fc(),1),e4=w(In(),1),dfe="running-queries",Rv=class{constructor(e){this.components=new He;let{lan:t=!1,disjointPaths:r=20,alpha:n=3}=e;this.disjointPaths=r??20,this.controllers=new Set,this.running=!1,this.alpha=n??3,this.lan=t,this.queries=0}init(e){this.components=e}isStarted(){return this.running}async start(){this.running=!0}async stop(){this.running=!1;for(let e of this.controllers)e.abort();this.controllers.clear()}async*run(e,t,r,n={}){if(!this.running)throw new Error("QueryManager not started");let i;if(n.signal==null){i=new pfe.TimeoutController(Ple),n.signal=i.signal;try{e4.setMaxListeners!=null&&(0,e4.setMaxListeners)(1/0,i.signal)}catch{}}let s=new AbortController;this.controllers.add(s);let a=[s.signal];n.signal!=null&&a.push(n.signal);let o=(0,mfe.anySignal)(a);try{e4.setMaxListeners!=null&&(0,e4.setMaxListeners)(1/0,o)}catch{}let l=C(`libp2p:kad-dht:${this.lan?"lan":"wan"}:query:`+M(e,"base58btc")),u=t.slice(0,Math.min(this.disjointPaths,t.length)),h=Date.now(),f=new Ue;try{if(l("query:start"),this.queries++,this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:dfe,value:this.queries}),t.length===0){l.error("Running query with no peers");return}let y=u.map((p,v)=>hfe({key:e,startingPeer:p,ourPeerId:this.components.getPeerId(),signal:o,query:r,pathIndex:v,numPaths:u.length,alpha:this.alpha,cleanUp:f,queryFuncTimeout:n.queryFuncTimeout,log:l}));for await(let p of(0,yfe.default)(...y))yield p,p.name==="QUERY_ERROR"&&l("error",p.error)}catch(y){if(!(!this.running&&y.code==="ERR_QUERY_ABORTED"))throw y}finally{this.controllers.delete(s),i?.clear(),this.queries--,this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:dfe,value:this.queries}),f.dispatchEvent(new ee("cleanup")),l("query:done in %dms",Date.now()-h)}}};c(),c(),te();var Ck=w(K(),1),t4=C("libp2p:kad-dht:rpc:handlers:add-provider"),Av=class{constructor(e){let{providers:t}=e;this.providers=t}init(){}async handle(e,t){if(t4("start"),t.key==null||t.key.length===0)throw(0,Ck.default)(new Error("Missing key"),"ERR_MISSING_KEY");let r;try{r=I.decode(t.key)}catch{throw(0,Ck.default)(new Error("Invalid CID"),"ERR_INVALID_CID")}(t.providerPeers==null||t.providerPeers.length===0)&&t4.error("no providers found in message"),await Promise.all(t.providerPeers.map(async n=>{if(!n.id.equals(e)){t4("invalid provider peer %p from %p",n.id,e);return}if(n.multiaddrs.length<1){t4("no valid addresses for provider %p. Ignore",e);return}t4("received provider %p for %s (addrs %s)",e,r,n.multiaddrs.map(i=>i.toString())),await this.providers.addProvider(r,n.id)}))}};c();var gfe=C("libp2p:kad-dht:rpc:handlers:find-node"),Tv=class{constructor(e){this.components=new He;let{peerRouting:t,lan:r}=e;this.peerRouting=t,this.lan=Boolean(r)}init(e){this.components=e}async handle(e,t){gfe("incoming request from %p for peers closer to %b",e,t.key);let r=[];Ce(this.components.getPeerId().toBytes(),t.key)?r=[{id:this.components.getPeerId(),multiaddrs:this.components.getAddressManager().getAddresses().map(i=>i.decapsulateCode(Tn("p2p").code)),protocols:[]}]:r=await this.peerRouting.getCloserPeersOffline(t.key,e),r=r.map(this.lan?gm:ym).filter(({multiaddrs:i})=>i.length);let n=new Mr(t.type,new Uint8Array(0),t.clusterLevel);return r.length>0?n.closerPeers=r:gfe("could not find any peers closer to %b than %p",t.key,e),n}};c(),te();var Efe=w(K(),1),wfe=C("libp2p:kad-dht:rpc:handlers:get-providers"),Iv=class{constructor(e){this.components=new He;let{peerRouting:t,providers:r,lan:n}=e;this.peerRouting=t,this.providers=r,this.lan=Boolean(n)}init(e){this.components=e}async handle(e,t){let r;try{r=I.decode(t.key)}catch{throw(0,Efe.default)(new Error("Invalid CID"),"ERR_INVALID_CID")}wfe("%p asking for providers for %s",e,r);let[n,i]=await Promise.all([this.providers.getProviders(r),this.peerRouting.getCloserPeersOffline(t.key,e)]),s=await this._getPeers(n),a=await this._getPeers(i.map(({id:l})=>l)),o=new Mr(t.type,t.key,t.clusterLevel);return s.length>0&&(o.providerPeers=s),a.length>0&&(o.closerPeers=a),wfe("got %s providers %s closerPeers",s.length,a.length),o}async _getAddresses(e){return(await this.components.getPeerStore().addressBook.get(e)).map(t=>t.multiaddr)}async _getPeers(e){let t=[],r=this.lan?gm:ym;for(let n of e){let i=r({id:n,multiaddrs:await this._getAddresses(n),protocols:[]});i.multiaddrs.length>0&&t.push(i)}return t}};c();var Cv=w(K(),1),Sm=C("libp2p:kad-dht:rpc:handlers:get-value"),Pv=class{constructor(e){this.components=new He;let{peerRouting:t}=e;this.peerRouting=t}init(e){this.components=e}async handle(e,t){let r=t.key;if(Sm("%p asked for key %b",e,r),r==null||r.length===0)throw(0,Cv.default)(new Error("Invalid key"),"ERR_INVALID_KEY");let n=new Mr(fn.GET_VALUE,r,t.clusterLevel);if(kle(r)){Sm("is public key");let a=Nle(r),o;try{let l=await this.components.getPeerStore().keyBook.get(a);if(l==null)throw(0,Cv.default)(new Error("No public key found in key book"),"ERR_NOT_FOUND");o=l}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}if(o!=null)return Sm("returning found public key"),n.record=new Vr(r,o,new Date),n}let[i,s]=await Promise.all([this._checkLocalDatastore(r),this.peerRouting.getCloserPeersOffline(t.key,e)]);return i!=null&&(Sm("had record for %b in local datastore",r),n.record=i),s.length>0&&(Sm("had %s closer peers in routing table",s.length),n.closerPeers=s),n}async _checkLocalDatastore(e){Sm("checkLocalDatastore looking for %b",e);let t=xu(e),r;try{r=await this.components.getDatastore().get(t)}catch(i){if(i.code==="ERR_NOT_FOUND")return;throw i}let n=Vr.deserialize(r);if(n==null)throw(0,Cv.default)(new Error("Invalid record"),"ERR_INVALID_RECORD");if(n.timeReceived==null||Date.now()-n.timeReceived.getTime()>1296e5){await this.components.getDatastore().delete(t);return}return n}};c();var bNe=C("libp2p:kad-dht:rpc:handlers:ping"),Dv=class{async handle(e,t){return bNe("ping from %p",e),t}init(){}};c();var bfe=w(K(),1),kv=class{constructor(e){this.components=new He;let{validators:t}=e;this.log=C("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=t}init(e){this.components=e}async handle(e,t){let r=t.key;this.log("%p asked us to store value for key %b",e,r);let n=t.record;if(n==null){let i=`Empty record from: ${e.toString()}`;throw this.log.error(i),(0,bfe.default)(new Error(i),"ERR_EMPTY_RECORD")}try{await _m(this.validators,n),n.timeReceived=new Date;let i=xu(n.key);await this.components.getDatastore().put(i,n.serialize()),this.log("put record for %b into datastore under key %k",r,i)}catch(i){this.log("did not put record for key %b into datastore %o",r,i)}return t}},Nv=class{constructor(e){let{providers:t,peerRouting:r,validators:n,lan:i}=e;this.log=C("libp2p:kad-dht:rpc"),this.routingTable=e.routingTable,this.handlers={[fn.GET_VALUE]:new Pv({peerRouting:r}),[fn.PUT_VALUE]:new kv({validators:n}),[fn.FIND_NODE]:new Tv({peerRouting:r,lan:i}),[fn.ADD_PROVIDER]:new Av({providers:t}),[fn.GET_PROVIDERS]:new Iv({peerRouting:r,providers:t,lan:i}),[fn.PING]:new Dv}}init(e){for(let t of Object.values(this.handlers))t.init(e)}async handleMessage(e,t){try{await this.routingTable.add(e)}catch(n){this.log.error("Failed to update the kbucket store",n)}let r=this.handlers[t.type];if(r==null){this.log.error(`no handler found for message type: ${t.type}`);return}return await r.handle(e,t)}onIncomingStream(e){Promise.resolve().then(async()=>{let{stream:t,connection:r}=e,n=r.remotePeer;try{await this.routingTable.add(n)}catch(s){this.log.error(s)}let i=this;await Te(t,Er(),async function*(s){for await(let a of s){let o=Mr.deserialize(a);i.log("incoming %s from %p",o.type,n);let l=await i.handleMessage(n,o);l!=null&&(yield l.serialize())}},kr(),t)}).catch(t=>{this.log.error(t)})}};c();var Ov=class extends Ue{constructor(e){super(),this.components=new He;let{protocol:t,lan:r}=e;this.log=C(`libp2p:kad-dht:topology-listener:${r?"lan":"wan"}`),this.running=!1,this.protocol=t}init(e){this.components=e}isStarted(){return this.running}async start(){if(this.running)return;this.running=!0;let e=g1({onConnect:t=>{this.log("observed peer %p with protocol %s",t,this.protocol),this.dispatchEvent(new ee("peer",{detail:t}))}});this.registrarId=await this.components.getRegistrar().register(this.protocol,e)}stop(){this.running=!1,this.registrarId!=null&&(this.components.getRegistrar().unregister(this.registrarId),this.registrarId=void 0)}};c();var Pk=w(In(),1),_fe=w(h0(),1),vfe=w(Jy(),1),Sfe=w($o(),1),xfe=w(Vi(),1),Lv=class{constructor(e){this.components=new He;let{peerRouting:t,lan:r,count:n,interval:i,queryTimeout:s}=e;this.log=C(`libp2p:kad-dht:${r?"lan":"wan"}:query-self`),this.running=!1,this.peerRouting=t,this.count=n??20,this.interval=i??Ale,this.queryTimeout=s??Tle}init(e){this.components=e}isStarted(){return this.running}async start(){this.running||(this.running=!0,this._querySelf())}async stop(){this.running=!1,this.timeoutId!=null&&clearTimeout(this.timeoutId),this.controller!=null&&this.controller.abort()}_querySelf(){Promise.resolve().then(async()=>{let e=new Sfe.TimeoutController(this.queryTimeout);try{this.controller=new AbortController;let t=(0,xfe.anySignal)([this.controller.signal,e.signal]);try{Pk.setMaxListeners!=null&&(0,Pk.setMaxListeners)(1/0,t)}catch{}let r=await Te(this.peerRouting.getClosestPeers(this.components.getPeerId().toBytes(),{signal:t}),n=>(0,_fe.default)(n,this.count),async n=>await(0,vfe.default)(n));this.log("query ran successfully - found %d peers",r)}catch(t){this.log("query error",t)}finally{this.timeoutId=setTimeout(this._querySelf.bind(this),this.interval),e.clear()}}).catch(e=>{this.log("query error",e)})}},r4=class extends Ue{constructor(e){super(),this.components=new He;let{kBucketSize:t,clientMode:r,validators:n,selectors:i,querySelfInterval:s,lan:a,protocolPrefix:o,pingTimeout:l,pingConcurrency:u}=e;this.running=!1,this.lan=Boolean(a),this.log=C(`libp2p:kad-dht:${a===!0?"lan":"wan"}`),this.protocol=`${o??Sle}${a===!0?vle:""}${xle}`,this.kBucketSize=t??20,this.clientMode=r??!0,this.routingTable=new dv({kBucketSize:t,lan:this.lan,pingTimeout:l,pingConcurrency:u,protocol:this.protocol}),this.providers=new Sv,this.validators={...Jle,...n},this.selectors={...tfe,...i},this.network=new yv({protocol:this.protocol,lan:this.lan}),this.queryManager=new Rv({disjointPaths:Math.ceil(this.kBucketSize/2),lan:a}),this.peerRouting=new vv({routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new Ev({validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,network:this.network,lan:this.lan}),this.contentRouting=new bv({network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new mv({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new Nv({routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new Ov({protocol:this.protocol,lan:this.lan}),this.querySelf=new Lv({peerRouting:this.peerRouting,interval:s,lan:this.lan}),this.network.addEventListener("peer",h=>{let f=h.detail;this.onPeerConnect(f).catch(y=>{this.log.error("could not add %p to routing table",f.id,y)}),this.dispatchEvent(new ee("peer",{detail:f}))}),this.topologyListener.addEventListener("peer",h=>{let f=h.detail;Promise.resolve().then(async()=>{let y=await this.components.getPeerStore().addressBook.get(f),p={id:f,multiaddrs:y.map(v=>v.multiaddr),protocols:[]};await this.onPeerConnect(p)}).catch(y=>{this.log.error("could not add %p to routing table",f,y)})})}get[rc](){return!0}get[Symbol.toStringTag](){return"@libp2p/kad-dht"}init(e){this.components=e,this.routingTable.init(e),this.providers.init(e),this.network.init(e),this.queryManager.init(e),this.peerRouting.init(e),this.contentFetching.init(e),this.contentRouting.init(e),this.routingTableRefresh.init(e),this.rpc.init(e),this.topologyListener.init(e),this.querySelf.init(e)}async onPeerConnect(e){if(this.log("peer %p connected with protocols %s",e.id,e.protocols),this.lan?e=gm(e):e=ym(e),e.multiaddrs.length===0){this.log("ignoring %p as they do not have any %s addresses in %s",e.id,this.lan?"private":"public",e.multiaddrs.map(t=>t.toString()));return}try{await this.routingTable.add(e.id)}catch(t){this.log.error("could not add %p to routing table",e.id,t)}}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(e){await this.components.getRegistrar().unhandle(this.protocol),e==="client"?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.getRegistrar().handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc)))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start(),this.querySelf.start()]),await this.routingTableRefresh.start()}async stop(){this.running=!1,await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop(),this.querySelf.stop()])}async*put(e,t,r={}){yield*this.contentFetching.put(e,t,r)}async*get(e,t={}){yield*this.contentFetching.get(e,t)}async*provide(e,t={}){yield*this.contentRouting.provide(e,this.components.getAddressManager().getAddresses(),t)}async*findProviders(e,t={}){yield*this.contentRouting.findProviders(e,t)}async*findPeer(e,t={}){yield*this.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={}){yield*this.peerRouting.getClosestPeers(e,t)}async refreshRoutingTable(){await this.routingTableRefresh.refreshTable(!0)}};c();var xm=w(K(),1),Gd=w(Fc(),1),_Ne=C("libp2p:kad-dht"),Bv=class extends Ue{constructor(e,t){super(),this.components=new He,this.wan=e,this.lan=t,this.wan.addEventListener("peer",r=>{this.dispatchEvent(new ee("peer",{detail:r.detail}))}),this.lan.addEventListener("peer",r=>{this.dispatchEvent(new ee("peer",{detail:r.detail}))})}get[rc](){return!0}get[Symbol.toStringTag](){return"@libp2p/dual-kad-dht"}init(e){this.components=e,this.wan.init(e),this.lan.init(e)}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return await this.wan.getMode()}async setMode(e){await this.wan.setMode(e)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}async*put(e,t,r={}){for await(let n of(0,Gd.default)(this.lan.put(e,t,r),this.wan.put(e,t,r)))yield n}async*get(e,t={}){let r=!1,n=!1;for await(let i of(0,Gd.default)(this.lan.get(e,t),this.wan.get(e,t)))yield i,i.name==="DIALING_PEER"&&(r=!0),i.name==="VALUE"&&(r=!0,i.value!=null&&(n=!0)),i.name==="SENDING_QUERY"&&(r=!0);if(!r)throw(0,xm.default)(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");n||(yield Li({from:this.components.getPeerId(),error:(0,xm.default)(new Error("Not found"),"ERR_NOT_FOUND")}))}async*provide(e,t={}){let r=0,n=0,i=[],s=[this.lan];await this.wan.getMode()==="server"&&s.push(this.wan);for await(let a of(0,Gd.default)(...s.map(o=>o.provide(e,t))))yield a,a.name==="SENDING_QUERY"&&r++,a.name==="QUERY_ERROR"&&i.push(a.error),a.name==="PEER_RESPONSE"&&a.messageName==="ADD_PROVIDER"&&(_Ne("sent provider record for %s to %p",e,a.from),n++);if(n===0)throw i.length>0?(0,xm.default)(new Error(`Failed to provide to ${i.length} of ${r} peers`),"ERR_PROVIDES_FAILED",{errors:i}):(0,xm.default)(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}async*findProviders(e,t={}){yield*(0,Gd.default)(this.lan.findProviders(e,t),this.wan.findProviders(e,t))}async*findPeer(e,t={}){let r=!1;for await(let n of(0,Gd.default)(this.lan.findPeer(e,t),this.wan.findPeer(e,t)))yield n,(n.name==="SENDING_QUERY"||n.name==="FINAL_PEER")&&(r=!0);if(!r)throw(0,xm.default)(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async*getClosestPeers(e,t={}){yield*(0,Gd.default)(this.lan.getClosestPeers(e,t),this.wan.getClosestPeers(e,t))}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}},Mv=class extends Bv{constructor(e){super(new r4({protocolPrefix:"/ipfs",...e,lan:!1}),new r4({protocolPrefix:"/ipfs",...e,clientMode:!1,lan:!0}))}};c();var Dk=C("libp2p:bootstrap"),n4=class extends Ue{constructor(e={list:[]}){if(e.list==null||e.list.length===0)throw new Error("Bootstrap requires a list of peer addresses");super(),this.interval=e.interval??1e4,this.list=[];for(let t of e.list){if(!qR.matches(t)){Dk.error("Invalid multiaddr");continue}let r=new j(t),n=r.getPeerId();if(n==null){Dk.error("Invalid bootstrap multiaddr without peer id");continue}let i={id:ue(n),multiaddrs:[r],protocols:[]};this.list.push(i)}}get[rc](){return!0}get[Symbol.toStringTag](){return"@libp2p/bootstrap"}isStarted(){return Boolean(this.timer)}start(){this.timer==null&&(this.timer=setInterval(()=>this._discoverBootstrapPeers(),this.interval),Dk("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){this.timer!=null&&this.list.forEach(e=>{this.dispatchEvent(new ee("peer",{detail:e}))})}stop(){this.timer!=null&&clearInterval(this.timer),this.timer=void 0}};n4.tag="bootstrap",c(),c(),c();var Rfe=WebSocket;c(),c();var Cfe=w(Tfe(),1);Re();function Ife(e){return e instanceof ArrayBuffer||e?.constructor?.name==="ArrayBuffer"&&typeof e?.byteLength=="number"}var Pfe=e=>{e.binaryType="arraybuffer";let t=async()=>await new Promise((s,a)=>{if(n)return s();if(i!=null)return a(i);let o=h=>{e.removeEventListener("open",l),e.removeEventListener("error",u),h()},l=()=>o(s),u=h=>{o(()=>a(h.error??new Error(`connect ECONNREFUSED ${e.url}`)))};e.addEventListener("open",l),e.addEventListener("error",u)}),r=async function*(){let s=new Cfe.EventIterator(({push:a,stop:o,fail:l})=>{let u=f=>{let y=null;typeof f.data=="string"&&(y=U(f.data)),Ife(f.data)&&(y=new Uint8Array(f.data)),f.data instanceof Uint8Array&&(y=f.data),y!=null&&a(y)},h=f=>l(f.error??new Error("Socket error"));return e.addEventListener("message",u),e.addEventListener("error",h),e.addEventListener("close",o),()=>{e.removeEventListener("message",u),e.removeEventListener("error",h),e.removeEventListener("close",o)}},{highWaterMark:1/0});await t();for await(let a of s)yield Ife(a)?new Uint8Array(a):a}(),n=e.readyState===1,i;return e.addEventListener("open",()=>{n=!0,i=null}),e.addEventListener("close",()=>{n=!1,i=null}),e.addEventListener("error",s=>{n||(i=s.error??new Error(`connect ECONNREFUSED ${e.url}`))}),Object.assign(r,{connected:t})};c(),c();var Dfe=e=>{if(e.readyState>=2)throw new Error("socket closed");if(e.readyState!==1)return new Promise((t,r)=>{function n(){e.removeEventListener("open",i),e.removeEventListener("error",s)}function i(){n(),t()}function s(a){n(),r(a.error??new Error(`connect ECONNREFUSED ${e.url}`))}e.addEventListener("open",i),e.addEventListener("error",s)})},kfe=(e,t)=>(t=t??{},t.closeOnEnd=t.closeOnEnd!==!1,async r=>{for await(let n of r){try{await Dfe(e)}catch(i){if(i.message==="socket closed")break;throw i}e.send(n)}if(t.closeOnEnd!=null&&e.readyState<=1)return await new Promise((n,i)=>{e.addEventListener("close",s=>{if(s.wasClean||s.code===1006)n();else{let a=Object.assign(new Error("ws error"),{event:s});i(a)}}),setTimeout(()=>e.close())})}),Nfe=(e,t)=>{t=t??{};let r=Pfe(e),n=t.remoteAddress,i=t.remotePort;if(e.url!=null)try{let s=new URL(e.url);n=s.hostname,i=parseInt(s.port,10)}catch{}if(n==null||i==null)throw new Error("Remote connection did not have address and/or port");return{sink:kfe(e,t),source:r,connected:async()=>await r.connected(),close:async()=>{(e.readyState===e.CONNECTING||e.readyState===e.OPEN)&&await new Promise(s=>{e.addEventListener("close",()=>{s()}),e.close()})},destroy:()=>{e.terminate!=null?e.terminate():e.close()},remoteAddress:n,remotePort:i,socket:e}};c();var Ofe=w(ww(),1),SNe={http:"ws",https:"wss"},xNe="ws",Lfe=(e,t)=>(0,Ofe.relative)(e,t,SNe,xNe);function Bfe(e,t){let r=typeof window>"u"?"":window.location;t=t??{};let n=Lfe(e,r.toString()),i=new Rfe(n,t.websocket);return Nfe(i,t)}var Ok=w(xD(),1);c();function Mfe(){throw new Error("WebSocket Servers can not be created in the browser!")}c(),c();var Ufe=C("libp2p:websockets:socket");function Ffe(e,t,r){r=r??{};let n={async sink(i){r?.signal!=null&&(i=Pn(i,r.signal));try{await e.sink(i)}catch(s){s.type!=="aborted"&&Ufe.error(s)}},source:r.signal!=null?Pn(e.source,r.signal):e.source,remoteAddr:t,timeline:{open:Date.now()},async close(){let i=Date.now();try{await nn(e.close(),2e3)}catch{let{host:s,port:a}=n.remoteAddr.toOptions();Ufe("timeout closing stream to %s:%s after %dms, destroying it manually",s,a,Date.now()-i),e.destroy()}finally{n.timeline.close=Date.now()}}};return e.socket.once!=null&&e.socket.once("close",()=>{n.timeline.close==null&&(n.timeline.close=Date.now())}),n}c();function qfe(e){return e.filter(t=>{if(t.protoCodes().includes(290))return!1;let r=t.decapsulateCode(421);return vh.matches(r)||yl.matches(r)})}function zfe(e){return e.filter(t=>{if(t.protoCodes().includes(290))return!1;let r=t.decapsulateCode(421);return yl.matches(r)&&gl.matches(r.decapsulateCode(6).decapsulateCode(478))})}var Rf=C("libp2p:websockets"),Kv=class{constructor(e){this.init=e}get[Symbol.toStringTag](){return"@libp2p/websockets"}get[H1](){return!0}async dial(e,t){Rf("dialing %s",e),t=t??{};let r=await this._connect(e,t),n=Ffe(r,e);Rf("new outbound connection %s",n.remoteAddr);let i=await t.upgrader.upgradeOutbound(n);return Rf("outbound connection %s upgraded",n.remoteAddr),i}async _connect(e,t){if(t?.signal?.aborted===!0)throw new nc;let r=e.toOptions();Rf("dialing %s:%s",r.host,r.port);let n=Ar(),i=l=>{Rf.error("connection error:",l),n.reject(l)},s=Bfe(L0(e),this.init);if(s.socket.on!=null?s.socket.on("error",i):s.socket.onerror=i,t.signal==null)return await Promise.race([s.connected(),n.promise]),Rf("connected %s",e),s;let a,o=new Promise((l,u)=>{if(a=()=>{u(new nc),setTimeout(()=>{s.close().catch(h=>{Rf.error("error closing raw socket",h)})})},t?.signal?.aborted===!0)return a();t?.signal?.addEventListener("abort",a)});try{await Promise.race([o,n.promise,s.connected()])}finally{a!=null&&t?.signal?.removeEventListener("abort",a)}return Rf("connected %s",e),s}createListener(e){return Mfe({...this.init,...e})}filter(e){return e=Array.isArray(e)?e:[e],this.init?.filter!=null?this.init?.filter(e):Ok.default.isBrowser||Ok.default.isWebWorker?zfe(e):qfe(e)}};c(),c(),c(),c();var Vv=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},Rm=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Vv(this.hwm),this.tail=this.head,this.size=0,this.objectMode=Boolean(e.objectMode)}push(e){if(e?.value!=null)if(this.objectMode)e.value!=null&&this.size++;else if(e.value instanceof Uint8Array)this.size+=e.value.byteLength;else throw new Error("objectMode was false but tried to push non-Uint8Array value");if(!this.head.push(e)){let t=this.head;this.head=t.next=new Vv(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}if(e?.value!=null)if(this.objectMode)this.size--;else if(e.value instanceof Uint8Array)this.size-=e.value.byteLength;else throw new Error("objectMode was false but tried to shift non-Uint8Array value");return e}isEmpty(){return this.head.isEmpty()}};function Hfe(e={}){return Gfe(t=>{let r=t.shift();if(r==null)return{done:!0};if(r.error!=null)throw r.error;return{done:r.done===!0,value:r.value}},e)}function $fe(e={}){return Gfe(t=>{let r,n=[];for(;!t.isEmpty()&&(r=t.shift(),r!=null);){if(r.error!=null)throw r.error;r.done===!1&&n.push(r.value)}return r==null?{done:!0}:{done:r.done===!0,value:n}},e)}function Gfe(e,t){t=t??{};let r=t.onEnd,n=new Rm(t),i,s,a,o=async()=>n.isEmpty()?a?{done:!0}:await new Promise((d,g)=>{s=b=>{s=null,n.push(b);try{d(e(n))}catch(_){g(_)}return i}}):e(n),l=d=>s!=null?s(d):(n.push(d),i),u=d=>(n=new Rm,s!=null?s({error:d}):(n.push({error:d}),i)),h=d=>a?i:l({done:!1,value:d}),f=d=>a?i:(a=!0,d!=null?u(d):l({done:!0})),y=()=>(n=new Rm,f(),{done:!0}),p=d=>(f(d),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:y,throw:p,push:h,end:f,get readableLength(){return n.size}},r==null)return i;let v=i;return i={[Symbol.asyncIterator](){return this},next(){return v.next()},throw(d){return v.throw(d),r!=null&&(r(d),r=void 0),{done:!0}},return(){return v.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(d){return v.end(d),r!=null&&(r(d),r=void 0),i},get readableLength(){return v.readableLength}},i}c();var Am=w(ai(),1);c();var lt;(function(e){e[e.NEW_STREAM=0]="NEW_STREAM",e[e.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",e[e.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",e[e.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",e[e.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",e[e.RESET_RECEIVER=5]="RESET_RECEIVER",e[e.RESET_INITIATOR=6]="RESET_INITIATOR"})(lt||(lt={}));var qv=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),Lk=Object.freeze({NEW_STREAM:lt.NEW_STREAM,MESSAGE:lt.MESSAGE_INITIATOR,CLOSE:lt.CLOSE_INITIATOR,RESET:lt.RESET_INITIATOR}),Wfe=Object.freeze({MESSAGE:lt.MESSAGE_RECEIVER,CLOSE:lt.CLOSE_RECEIVER,RESET:lt.RESET_RECEIVER}),Bk=10*1024;function jfe(e){return globalThis.Buffer!=null?Buffer.allocUnsafe(e):new Uint8Array(e)}var Mk=class{constructor(){this._pool=jfe(Bk),this._poolOffset=0}write(e){let t=this._pool,r=this._poolOffset;Am.default.encode(e.id<<3|e.type,t,r),r+=Am.default.encode.bytes,(e.type===lt.NEW_STREAM||e.type===lt.MESSAGE_INITIATOR||e.type===lt.MESSAGE_RECEIVER)&&e.data!=null?Am.default.encode(e.data.length,t,r):Am.default.encode(0,t,r),r+=Am.default.encode.bytes;let n=t.slice(this._poolOffset,r);return Bk-r<100?(this._pool=jfe(Bk),this._poolOffset=0):this._poolOffset=r,(e.type===lt.NEW_STREAM||e.type===lt.MESSAGE_INITIATOR||e.type===lt.MESSAGE_RECEIVER)&&e.data!=null?[n,e.data instanceof Uint8Array?e.data:e.data.slice()]:[n]}},Yfe=new Mk;async function*Qfe(e){for await(let t of e)if(Array.isArray(t))for(let r of t)yield*Yfe.write(r);else yield*Yfe.write(t)}c();var Uk=class{constructor(){this._buffer=new qe,this._headerInfo=null}write(e){if(e==null||e.length===0)return[];this._buffer.append(e);let t=[];for(;this._buffer.length!==0;){if(this._headerInfo==null)try{this._headerInfo=this._decodeHeader(this._buffer)}catch{break}let{id:r,type:n,length:i,offset:s}=this._headerInfo;if(this._buffer.length-s<i)break;let a={id:r,type:n};(n===lt.NEW_STREAM||n===lt.MESSAGE_INITIATOR||n===lt.MESSAGE_RECEIVER)&&(a.data=this._buffer.slice(s,s+i)),t.push(a),this._buffer.consume(s+i),this._headerInfo=null}return t}_decodeHeader(e){let{value:t,offset:r}=Zfe(e),{value:n,offset:i}=Zfe(e,r),s=t&7;if(qv[s]==null)throw new Error(`Invalid type received: ${s}`);return{id:t>>3,type:s,offset:r+i,length:n}}},CNe=128,Xfe=127;function Zfe(e,t=0){let r=0,n=0,i=t,s,a=e.length;do{if(i>=a||n>49)throw t=0,new RangeError("Could not decode varint");s=e.get(i++),r+=n<28?(s&Xfe)<<n:(s&Xfe)*Math.pow(2,n),n+=7}while(s>=CNe);return t=i-t,{value:r,offset:t}}async function*Jfe(e){let t=new Uk;for await(let r of e){let n=t.write(r);n.length>0&&(yield n)}}c();var Fk=1<<20;function ehe(e){let t=e??Fk,r=n=>{if(!(n.type!==lt.NEW_STREAM&&n.type!==lt.MESSAGE_INITIATOR&&n.type!==lt.MESSAGE_RECEIVER)&&n.data.byteLength>t)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return n=>async function*(){for await(let i of n)Array.isArray(i)?(i.forEach(r),yield*i):(r(i),yield i)}()}c();var Vk=w(K(),1),the=w(Vi(),1);Re();var aa=C("libp2p:mplex:stream"),Kk="ERR_MPLEX_STREAM_RESET",PNe="ERR_MPLEX_STREAM_ABORT",DNe="ERR_MPLEX_SINK_ENDED";function rhe(e){let{id:t,name:r,send:n,onEnd:i,type:s="initiator",maxMsgSize:a=Fk}=e,o=new AbortController,l=new AbortController,u=new AbortController,h=s==="initiator"?Lk:Wfe,f=s==="initiator"?`i${t}`:`r${t}`,y=`${r??t}`,p=!1,v=!1,d,g={open:Date.now()},b=E=>{p||(p=!0,aa.trace("%s stream %s source end - err: %o",s,y,E),E!=null&&d==null&&(d=E),v&&(m.timeline.close=Date.now(),i?.(d)))},_=E=>{v||(v=!0,aa.trace("%s stream %s sink end - err: %o",s,y,E),E!=null&&d==null&&(d=E),p&&(g.close=Date.now(),i?.(d)))},m={close:()=>{aa.trace("%s stream %s close",s,y),m.closeRead(),m.closeWrite()},closeRead:()=>{aa.trace("%s stream %s closeRead",s,y),!p&&m.source.end()},closeWrite:()=>{if(aa.trace("%s stream %s closeWrite",s,y),!v){u.abort();try{n({id:t,type:h.CLOSE})}catch(E){aa.trace("%s stream %s error sending close",s,r,E)}_()}},abort:E=>{aa.trace("%s stream %s abort",s,y,E),m.source.end(E),o.abort(),_(E)},reset:()=>{let E=(0,Vk.default)(new Error("stream reset"),Kk);l.abort(),m.source.end(E),_(E)},sink:async E=>{if(v)throw(0,Vk.default)(new Error("stream closed for writing"),DNe);E=Pn(E,(0,the.anySignal)([o.signal,l.signal,u.signal]));try{s==="initiator"&&n({id:t,type:Lk.NEW_STREAM,data:U(y)});let D=new qe;for await(let N of E)for(D.append(N);D.length!==0;){if(D.length<=a){n({id:t,type:h.MESSAGE,data:D.subarray()}),D.consume(D.length);break}let R=D.length-a;n({id:t,type:h.MESSAGE,data:D.subarray(0,R)}),D.consume(R)}}catch(D){if(D.type==="aborted"&&D.message==="The operation was aborted"){if(u.signal.aborted)return;l.signal.aborted&&(D.message="stream reset",D.code=Kk),o.signal.aborted&&(D.message="stream aborted",D.code=PNe)}if(D.code===Kk)aa.trace("%s stream %s reset",s,r);else{aa.trace("%s stream %s error",s,r,D);try{n({id:t,type:h.RESET})}catch(N){aa.trace("%s stream %s error sending reset",s,r,N)}}m.source.end(D),_(D);return}try{n({id:t,type:h.CLOSE})}catch(D){aa.trace("%s stream %s error sending close",s,r,D)}_()},source:Hfe({onEnd:b}),timeline:g,id:f};return m}var zv=w(K(),1),Iu=C("libp2p:mplex"),kNe=1024,NNe=1024*1024*4;function nhe(e){let t={...e,type:`${qv[e.type]} (${e.type})`};return e.type===lt.NEW_STREAM&&(t.data=M(e.data instanceof Uint8Array?e.data:e.data.slice())),(e.type===lt.MESSAGE_INITIATOR||e.type===lt.MESSAGE_RECEIVER)&&(t.data=M(e.data instanceof Uint8Array?e.data:e.data.slice(),"base16")),t}var Hv=class{constructor(e,t){this.protocol="/mplex/6.7.0",t=t??{},this._streamId=0,this._streams={initiators:Dn({metrics:e.getMetrics(),component:"mplex",metric:"initiatorStreams"}),receivers:Dn({metrics:e.getMetrics(),component:"mplex",metric:"receiverStreams"})},this._init=t,this.sink=this._createSink();let r=this._createSource();this._source=r,this.source=r}init(e){}get streams(){let e=[];return this._streams.initiators.forEach(t=>{e.push(t)}),this._streams.receivers.forEach(t=>{e.push(t)}),e}newStream(e){let t=this._streamId++;e=e==null?t.toString():e.toString();let r=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:r})}_newReceiverStream(e){let{id:t,name:r}=e,n=this._streams.receivers;return this._newStream({id:t,name:r,type:"receiver",registry:n})}_newStream(e){let t=this._init.maxStreamsPerConnection??kNe;if(this._streams.initiators.size+this._streams.receivers.size===t)throw(0,zv.default)(new Error("Too many streams open"),"ERR_TOO_MANY_STREAMS");let{id:r,name:n,type:i,registry:s}=e;if(Iu("new %s stream %s %s",i,r,n),s.has(r))throw new Error(`${i} stream ${r} already exists!`);let a=rhe({id:r,name:n,send:o=>{if(!s.has(r))throw(0,zv.default)(new Error("the stream is not in the muxer registry, it may have already been closed"),"ERR_STREAM_DOESNT_EXIST");Iu.enabled&&Iu.trace("%s stream %s send",i,r,nhe(o)),(o.type===lt.NEW_STREAM||o.type===lt.MESSAGE_INITIATOR||o.type===lt.MESSAGE_RECEIVER)&&(o.data=o.data instanceof Uint8Array?o.data:o.data.slice()),this._source.push(o)},type:i,onEnd:()=>{Iu("%s stream %s %s ended",i,r,n),s.delete(r),this._init.onStreamEnd!=null&&this._init.onStreamEnd(a)},maxMsgSize:this._init.maxMsgSize});return s.set(r,a),a}_createSink(){return async e=>{this._init.signal!=null&&(e=Pn(e,this._init.signal));try{await Te(e,Jfe,ehe(this._init.maxMsgSize),async t=>{for await(let r of t)this._handleIncoming(r)}),this._source.end()}catch(t){Iu("error in sink",t),this._source.end(t)}}}_createSource(){let e=$fe({objectMode:!0,onEnd:t=>{let{initiators:r,receivers:n}=this._streams;for(let i of r.values())t!=null?i.abort(t):i.close();for(let i of n.values())t!=null?i.abort(t):i.close()}});return Object.assign(Qfe(e),{push:e.push,end:e.end,return:e.return})}_handleIncoming(e){let{id:t,type:r}=e;if(Iu.enabled&&Iu.trace("incoming message",nhe(e)),e.type===lt.NEW_STREAM){let s=this._newReceiverStream({id:t,name:M(e.data instanceof Uint8Array?e.data:e.data.slice())});this._init.onIncomingStream!=null&&this._init.onIncomingStream(s);return}let n=((r&1)===1?this._streams.initiators:this._streams.receivers).get(t);if(n==null){Iu("missing stream %s",t);return}let i=this._init.maxStreamBufferSize??NNe;switch(r){case lt.MESSAGE_INITIATOR:case lt.MESSAGE_RECEIVER:if(n.source.readableLength>i){this._source.push({id:e.id,type:r===lt.MESSAGE_INITIATOR?lt.RESET_RECEIVER:lt.RESET_INITIATOR});let s=(0,zv.default)(new Error("Input buffer full - increase Mplex maxBufferSize to accomodate slow consumers"),"ERR_STREAM_INPUT_BUFFER_FULL");n.abort(s);return}n.source.push(e.data.slice());break;case lt.CLOSE_INITIATOR:case lt.CLOSE_RECEIVER:n.closeRead();break;case lt.RESET_INITIATOR:case lt.RESET_RECEIVER:n.reset();break;default:Iu("unknown message type %s",r)}}},$v=class{constructor(e={}){this.protocol="/mplex/6.7.0",this.init=e}createStreamMuxer(e,t={}){return new Hv(e,{...t,...this.init})}};c(),c(),c();function qk(e,t={}){let r=Io(e),n=Er.fromReader(r.reader,t),i={read:async s=>{let{value:a}=await r.reader.next(s);if(a==null)throw new Error("Value is null");return a},readLP:async()=>{let{value:s}=await n.next();if(s==null)throw new Error("Value is null");return s},readPB:async s=>{let a=await i.readLP();if(a==null)throw new Error("Value is null");let o=a instanceof Uint8Array?a:a.slice();return s.decode(o)},write:s=>{s instanceof Uint8Array?r.writer.push(s):r.writer.push(s.slice())},writeLP:s=>{i.write(kr.single(s,t))},writePB:(s,a)=>{i.writeLP(a.encode(s))},pb:s=>({read:async()=>await i.readPB(s),write:a=>i.writePB(a,s)}),unwrap:()=>(r.rest(),r.stream)};return i}c(),c();function zk(){let e=Ar(),t=!1;return{sink:async r=>{if(t)throw new Error("already piped");t=!0,e.resolve(r)},source:async function*(){yield*await e.promise}()}}function ihe(){let e=zk(),t=zk();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}c();var ohe=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);c();var Khe=w(hhe(),1),Im=w(Phe(),1),r7=w(khe(),1),oN=w(Fhe(),1),Vhe={hashSHA256(e){return(0,r7.hash)(e)},getHKDF(e,t){let r=new Khe.HKDF(r7.SHA256,t,e).expand(96),n=r.slice(0,32),i=r.slice(32,64),s=r.slice(64,96);return[n,i,s]},generateX25519KeyPair(){let e=Im.generateKeyPair();return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519KeyPairFromSeed(e){let t=Im.generateKeyPairFromSeed(e);return{publicKey:t.publicKey,privateKey:t.secretKey}},generateX25519SharedKey(e,t){return Im.sharedKey(e,t)},chaCha20Poly1305Encrypt(e,t,r,n){return new oN.ChaCha20Poly1305(n).seal(t,e,r)},chaCha20Poly1305Decrypt(e,t,r,n){return new oN.ChaCha20Poly1305(n).open(t,e,r)}};c();function zhe(e){return async function*(t){for await(let r of t)for(let n=0;n<r.length;n+=65519){let i=n+65519;i>r.length&&(i=r.length),yield e.encrypt(r.slice(n,i),e.session)}}}function Hhe(e){return async function*(t){for await(let r of t)for(let n=0;n<r.length;n+=65535){let i=n+65535;i>r.length&&(i=r.length);let{plaintext:s,valid:a}=await e.decrypt(r.slice(n,i),e.session);if(!a)throw new Error("Failed to validate decrypted chunk");yield s}}}c(),ur();var $Oe=e=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e),f4=(e,t,r)=>(t=t??$Oe(2),new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(r??0,e,!1),t);f4.bytes=2;var h4=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};h4.bytes=2;function n7(e){return Ae([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}function i7(e){return Ae([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}function $he(e){return Ae([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}function Cm(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.slice(0,32),ciphertext:e.slice(32,e.length),ns:new Uint8Array(0)}}function Pm(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.slice(0,32),ns:e.slice(32,80),ciphertext:e.slice(80,e.length)}}function Ghe(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.slice(0,48),ciphertext:e.slice(48,e.length)}}c(),c(),c(),ur(),Re(),c();var o7;(function(e){let t;(function(r){r.codec=()=>Xe({1:{name:"identityKey",codec:ye},2:{name:"identitySig",codec:ye},3:{name:"data",codec:ye}}),r.encode=n=>Qe(n,r.codec()),r.decode=n=>Ye(n,r.codec())})(t=e.NoiseHandshakePayload||(e.NoiseHandshakePayload={}))})(o7||(o7={}));var Whe=o7.NoiseHandshakePayload;async function jhe(e,t,r){let n=await WOe(e,Yhe(t)),i=r??new Uint8Array(0);if(e.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return GOe(e.publicKey,n,i)}function GOe(e,t,r){return Whe.encode({identityKey:e,identitySig:t,data:r??new Uint8Array(0)})}async function WOe(e,t){if(e.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return await(await Jn(e.privateKey)).sign(t)}async function Tf(e){return await sn(e.identityKey)}function If(e){return Whe.decode(e)}function Yhe(e){let t=U("noise-libp2p-static-key:");return Ae([t,e],t.length+e.length)}async function jOe(e,t){return(await sn(t)).equals(e)}async function Cf(e,t,r){let n=t.identityKey;if(!await jOe(r,n))throw new Error("Peer ID doesn't match libp2p public key.");let i=Yhe(e),s=await sn(n);if(s.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(t.identitySig==null)throw new Error("Signature was missing from message");if(!await ho(s.publicKey).verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return s}function ku(e){return!(!(e instanceof Uint8Array)||e.length!==32)}c(),yr(),ur(),c(),me();var at=C("libp2p:noise"),ws;ohe?ws=at:ws=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function s7(e){ws(`LOCAL_STATIC_PUBLIC_KEY ${M(e.publicKey,"hex")}`),ws(`LOCAL_STATIC_PRIVATE_KEY ${M(e.privateKey,"hex")}`)}function Pf(e){e?(ws(`LOCAL_PUBLIC_EPHEMERAL_KEY ${M(e.publicKey,"hex")}`),ws(`LOCAL_PRIVATE_EPHEMERAL_KEY ${M(e.privateKey,"hex")}`)):ws("Missing local ephemeral keys.")}function Dm(e){ws(`REMOTE_STATIC_PUBLIC_KEY ${M(e,"hex")}`)}function Nu(e){ws(`REMOTE_EPHEMERAL_PUBLIC_KEY ${M(e,"hex")}`)}function a7(e){e.cs1&&e.cs2?(ws(`CIPHER_STATE_1 ${e.cs1.n} ${M(e.cs1.k,"hex")}`),ws(`CIPHER_STATE_2 ${e.cs2.n} ${M(e.cs2.k,"hex")}`)):ws("Missing cipher state.")}var YOe=0,Qhe=Number.MAX_SAFE_INTEGER,Xhe="Cipherstate has reached maximum n, a new handshake must be performed",km=class{constructor(e){this.crypto=e}encryptWithAd(e,t,r){let n=this.encrypt(e.k,e.n,t,r);return this.setNonce(e,this.incrementNonce(e.n)),n}decryptWithAd(e,t,r){let{plaintext:n,valid:i}=this.decrypt(e.k,e.n,t,r);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:n,valid:i}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,t){e.n=t}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){let t=this.createEmptyKey();return Ce(t,e)}incrementNonce(e){return e+1}nonceToBytes(e){let t=new Uint8Array(12);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint32(4,e,!0),t}encrypt(e,t,r,n){if(t>Qhe)throw new Error(Xhe);let i=this.nonceToBytes(t);return this.crypto.chaCha20Poly1305Encrypt(n,i,r,e)}encryptAndHash(e,t){let r;return this.hasKey(e.cs)?r=this.encryptWithAd(e.cs,e.h,t):r=t,this.mixHash(e,r),r}decrypt(e,t,r,n){if(t>Qhe)throw new Error(Xhe);let i=this.nonceToBytes(t),s=this.crypto.chaCha20Poly1305Decrypt(n,i,r,e);return s?{plaintext:s,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,t){let r,n=!0;return this.hasKey(e.cs)?{plaintext:r,valid:n}=this.decryptWithAd(e.cs,e.h,t):r=t,this.mixHash(e,t),{plaintext:r,valid:n}}dh(e,t){try{let r=this.crypto.generateX25519SharedKey(e,t);return r.length===32?r:r.slice(0,32)}catch(r){return at(r.message),new Uint8Array(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return this.crypto.hashSHA256(Ae([e,t],e.length+t.length))}mixKey(e,t){let[r,n]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(n),e.ck=r}initializeKey(e){return{k:e,n:YOe}}initializeSymmetric(e){let t=U(e,"utf-8"),r=this.hashProtocolName(t),n=r,i=this.createEmptyKey();return{cs:this.initializeKey(i),ck:n,h:r}}hashProtocolName(e){if(e.length<=32){let t=new Uint8Array(32);return t.set(e),t}else return this.getHash(e,new Uint8Array(0))}split(e){let[t,r]=this.crypto.getHKDF(e.ck,new Uint8Array(0)),n=this.initializeKey(t),i=this.initializeKey(r);return{cs1:n,cs2:i}}writeMessageRegular(e,t){let r=this.encryptWithAd(e,new Uint8Array(0),t),n=this.createEmptyKey(),i=new Uint8Array(0);return{ne:n,ns:i,ciphertext:r}}readMessageRegular(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}},c7=class extends km{initSession(e,t,r,n){let i=this.createEmptyKey(),s;return e?s=this.initializeInitiator(t,r,n,i):s=this.initializeResponder(t,r,n,i),{hs:s,i:e,mc:0}}sendMessage(e,t){let r;if(e.mc===0)r=this.writeMessageA(e.hs,t);else if(e.mc===1){let{messageBuffer:n,h:i,cs1:s,cs2:a}=this.writeMessageB(e.hs,t);r=n,e.h=i,e.cs1=s,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");r=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");r=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,r}recvMessage(e,t){let r=new Uint8Array(0),n=!1;if(e.mc===0&&({plaintext:r,valid:n}=this.readMessageA(e.hs,t)),e.mc===1){let{plaintext:i,valid:s,h:a,cs1:o,cs2:l}=this.readMessageB(e.hs,t);r=i,n=s,e.h=a,e.cs1=o,e.cs2=l}return e.mc++,{plaintext:r,valid:n}}writeMessageA(e,t){e.e=this.crypto.generateX25519KeyPair();let r=e.e.publicKey;this.mixHash(e.ss,r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=e.s.publicKey,i=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let s=this.encryptAndHash(e.ss,t);return{ne:r,ns:i,ciphertext:s}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();let r=e.e.publicKey;this.mixHash(e.ss,r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=this.encryptAndHash(e.ss,t),i=this.createEmptyKey(),s={ne:r,ns:i,ciphertext:n},{cs1:a,cs2:o}=this.split(e.ss);return{messageBuffer:s,cs1:a,cs2:o,h:e.ss.h}}readMessageA(e,t){ku(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&r.length===32&&ku(r)&&(e.rs=r),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:i,valid:s}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:i,valid:n&&s}}readMessageB(e,t){if(ku(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:i,cs2:s}=this.split(e.ss);return{h:e.ss.h,valid:n,plaintext:r,cs1:i,cs2:s}}initializeInitiator(e,t,r,n){let i="Noise_IK_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(i);this.mixHash(s,e),this.mixHash(s,r);let a=new Uint8Array(32);return{ss:s,s:t,rs:r,re:a,psk:n}}initializeResponder(e,t,r,n){let i="Noise_IK_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(i);this.mixHash(s,e),this.mixHash(s,t.publicKey);let a=new Uint8Array(32);return{ss:s,s:t,rs:r,re:a,psk:n}}};c();var d4=class extends Error{constructor(e,t){super(t),this.initialMsg=e,this.name="FailedIKhandshake"}},u7=class{constructor(e,t,r,n,i,s,a,o,l){this.isInitiator=e,this.payload=t,this.prologue=r,this.staticKeypair=i,this.connection=s,o&&(this.remotePeer=o),this.ik=l??new c7(n),this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,a),this.remoteEarlyData=new Uint8Array}async stage0(){if(s7(this.session.hs.s),Dm(this.session.hs.rs),this.isInitiator){at("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(i7(e)),at("IK Stage 0 - Initiator sent message."),Pf(this.session.hs.e)}else{at("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let t=Pm(e.slice()),{plaintext:r,valid:n}=this.ik.recvMessage(this.session,t);if(!n)throw new Error("ik handshake stage 0 decryption validation fail");at("IK Stage 0 - Responder got message, going to verify payload.");let i=await If(r);this.remotePeer=this.remotePeer||await Tf(i),await Cf(this.session.hs.rs,i,this.remotePeer),this.setRemoteEarlyData(i.data),at("IK Stage 0 - Responder successfully verified payload!"),Nu(this.session.hs.re)}catch(t){let r=t;throw at("Responder breaking up with IK handshake in stage 0."),new d4(e,`Error occurred while verifying initiator's signed payload: ${r.message}`)}}}async stage1(){if(this.isInitiator){at("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),t=Cm(e),{plaintext:r,valid:n}=this.ik.recvMessage(this.session,t);at("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!n)throw new Error("ik stage 1 decryption validation fail");let i=await If(r);this.remotePeer=this.remotePeer||await Tf(i),await Cf(t.ns.slice(0,32),i,this.remotePeer),this.setRemoteEarlyData(i.data),at("IK Stage 1 - Initiator successfully verified payload!"),Nu(this.session.hs.re)}catch(i){let s=i;throw at("Initiator breaking up with IK handshake in stage 1."),new d4(e,`Error occurred while verifying responder's signed payload: ${s.message}`)}}else{at("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(n7(e)),at("IK Stage 1 - Responder sent message..."),Pf(this.session.hs.e)}a7(this.session)}decrypt(e,t){let r=this.getCS(t,!1);return this.ik.decryptWithAd(r,new Uint8Array(0),e)}encrypt(e,t){let r=this.getCS(t);return this.ik.encryptWithAd(r,new Uint8Array(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}};c(),c();var Wd=class extends Error{constructor(e="Unexpected Peer"){super(e),this.code=Wd.code}static get code(){return"ERR_UNEXPECTED_PEER"}},Ou=class extends Error{constructor(e="Invalid crypto exchange"){super(e),this.code=Ou.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}};c();var l7=class extends km{initializeInitiator(e,t,r,n){let i="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(i);this.mixHash(s,e);let a=new Uint8Array(32);return{ss:s,s:t,rs:r,psk:n,re:a}}initializeResponder(e,t,r,n){let i="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(i);this.mixHash(s,e);let a=new Uint8Array(32);return{ss:s,s:t,rs:r,psk:n,re:a}}writeMessageA(e,t,r){let n=new Uint8Array(0);r!==void 0?e.e=r:e.e=this.crypto.generateX25519KeyPair();let i=e.e.publicKey;this.mixHash(e.ss,i);let s=this.encryptAndHash(e.ss,t);return{ne:i,ns:n,ciphertext:s}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();let r=e.e.publicKey;this.mixHash(e.ss,r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let n=e.s.publicKey,i=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,t);return{ne:r,ns:i,ciphertext:s}}writeMessageC(e,t){let r=e.s.publicKey,n=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let i=this.encryptAndHash(e.ss,t),s={ne:this.createEmptyKey(),ns:n,ciphertext:i},{cs1:a,cs2:o}=this.split(e.ss);return{h:e.ss.h,messageBuffer:s,cs1:a,cs2:o}}readMessageA(e,t){return ku(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(ku(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&r.length===32&&ku(r)&&(e.rs=r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:i,valid:s}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:i,valid:n&&s}}readMessageC(e,t){let{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&r.length===32&&ku(r)&&(e.rs=r),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:i,valid:s}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:a,cs2:o}=this.split(e.ss);return{h:e.ss.h,plaintext:i,valid:n&&s,cs1:a,cs2:o}}initSession(e,t,r){let n=this.createEmptyKey(),i=new Uint8Array(32),s;return e?s=this.initializeInitiator(t,r,i,n):s=this.initializeResponder(t,r,i,n),{hs:s,i:e,mc:0}}sendMessage(e,t,r){let n;if(e.mc===0)n=this.writeMessageA(e.hs,t,r);else if(e.mc===1)n=this.writeMessageB(e.hs,t);else if(e.mc===2){let{h:i,messageBuffer:s,cs1:a,cs2:o}=this.writeMessageC(e.hs,t);n=s,e.h=i,e.cs1=a,e.cs2=o}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,t){let r=new Uint8Array(0),n=!1;if(e.mc===0)({plaintext:r,valid:n}=this.readMessageA(e.hs,t));else if(e.mc===1)({plaintext:r,valid:n}=this.readMessageB(e.hs,t));else if(e.mc===2){let{h:i,plaintext:s,valid:a,cs1:o,cs2:l}=this.readMessageC(e.hs,t);r=s,n=a,e.h=i,e.cs1=o,e.cs2=l}return e.mc++,{plaintext:r,valid:n}}},Nm=class{constructor(e,t,r,n,i,s,a,o){this.isInitiator=e,this.payload=t,this.prologue=r,this.staticKeypair=i,this.connection=s,a&&(this.remotePeer=a),this.xx=o??new l7(n),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=new Uint8Array(0)}async propose(){if(s7(this.session.hs.s),this.isInitiator){at("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(n7(e)),at("Stage 0 - Initiator finished sending first message."),Pf(this.session.hs.e)}else{at("Stage 0 - Responder waiting to receive first message...");let e=Cm((await this.connection.readLP()).slice()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new Ou("xx handshake stage 0 validation fail");at("Stage 0 - Responder received first message."),Nu(this.session.hs.re)}}async exchange(){if(this.isInitiator){at("Stage 1 - Initiator waiting to receive first message from responder...");let e=Pm((await this.connection.readLP()).slice()),{plaintext:t,valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new Ou("xx handshake stage 1 validation fail");at("Stage 1 - Initiator received the message."),Nu(this.session.hs.re),Dm(this.session.hs.rs),at("Initiator going to check remote's signature...");try{let n=await If(t);this.remotePeer=this.remotePeer||await Tf(n),this.remotePeer=await Cf(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let i=n;throw new Wd(`Error occurred while verifying signed payload: ${i.message}`)}at("All good with the signature!")}else{at("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(i7(e)),at("Stage 1 - Responder sent the second handshake message with signed payload."),Pf(this.session.hs.e)}}async finish(){if(this.isInitiator){at("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP($he(e)),at("Stage 2 - Initiator sent message with signed payload.")}else{at("Stage 2 - Responder waiting for third handshake message...");let e=Ghe((await this.connection.readLP()).slice()),{plaintext:t,valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new Ou("xx handshake stage 2 validation fail");at("Stage 2 - Responder received the message, finished handshake.");try{let n=await If(t);this.remotePeer=this.remotePeer||await Tf(n),await Cf(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let i=n;throw new Wd(`Error occurred while verifying signed payload: ${i.message}`)}}a7(this.session)}encrypt(e,t){let r=this.getCS(t);return this.xx.encryptWithAd(r,new Uint8Array(0),e)}decrypt(e,t){let r=this.getCS(t,!1);return this.xx.decryptWithAd(r,new Uint8Array(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Ou("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}};c();var f7=class extends Nm{constructor(e,t,r,n,i,s,a,o,l,u){super(e,t,r,n,i,s,o,u),l&&(this.ephemeralKeys=l),this.initialMsg=a}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,new Uint8Array(0),this.ephemeralKeys),at("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),Pf(this.session.hs.e);else{at("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=Cm(this.initialMsg),{valid:t}=this.xx.recvMessage(this.session,{ne:e.ne,ns:new Uint8Array(0),ciphertext:new Uint8Array(0)});if(!t)throw new Error("xx fallback stage 0 decryption validation fail");at("XX Fallback Stage 0 - Responder used received message from IK."),Nu(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=Pm(this.initialMsg),{plaintext:t,valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new Error("xx fallback stage 1 decryption validation fail");at("XX Fallback Stage 1 - Initiator used received message from IK."),Nu(this.session.hs.re),Dm(this.session.hs.rs),at("Initiator going to check remote's signature...");try{let n=await If(t);this.remotePeer=this.remotePeer||await Tf(n),await Cf(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let i=n;throw new Error(`Error occurred while verifying signed payload from responder: ${i.message}`)}at("All good with the signature!")}else at("XX Fallback Stage 1 - Responder start"),await super.exchange(),at("XX Fallback Stage 1 - Responder end")}};c();var sN=class{constructor(){this.storage=new K3}store(e,t){this.storage.set(e,t)}load(e){return e?this.storage.get(e)??null:null}resetStorage(){this.storage.clear()}},h7=new sN,d7=class{constructor(e,t,r=Vhe){this.protocol="/noise",this.prologue=new Uint8Array(0),this.earlyData=t??new Uint8Array(0),this.useNoisePipes=!1,this.crypto=r,e?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(e):this.staticKeys=this.crypto.generateX25519KeyPair()}async secureOutbound(e,t,r){let n=qk(t,{lengthEncoder:f4,lengthDecoder:h4,maxDataLength:65535}),i=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:r});return{conn:await this.createSecureConnection(n,i),remoteEarlyData:i.remoteEarlyData,remotePeer:i.remotePeer}}async secureInbound(e,t,r){let n=qk(t,{lengthEncoder:f4,lengthDecoder:h4,maxDataLength:65535}),i=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:r});return{conn:await this.createSecureConnection(n,i),remoteEarlyData:i.remoteEarlyData,remotePeer:i.remotePeer}}async performHandshake(e){let t=await jhe(e.localPeer,this.staticKeys.publicKey,this.earlyData),r=this.useNoisePipes;if(e.isInitiator&&h7.load(e.remotePeer)===null&&(r=!1),r){let{remotePeer:n,connection:i,isInitiator:s}=e,a=new u7(s,t,this.prologue,this.crypto,this.staticKeys,i,h7.load(e.remotePeer)??new Uint8Array(32),n);try{return await this.performIKHandshake(a)}catch(o){let l=o,u;return e.isInitiator&&(u=a.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,t,l.initialMsg,u)}}else return await this.performXXHandshake(e,t)}async performXXFallbackHandshake(e,t,r,n){let{isInitiator:i,remotePeer:s,connection:a}=e,o=new f7(i,t,this.prologue,this.crypto,this.staticKeys,a,r,s,n);try{await o.propose(),await o.exchange(),await o.finish()}catch(l){let u=l;throw u.message=`Error occurred during XX Fallback handshake: ${u.message}`,at(u),u}return o}async performXXHandshake(e,t){let{isInitiator:r,remotePeer:n,connection:i}=e,s=new Nm(r,t,this.prologue,this.crypto,this.staticKeys,i,n);try{await s.propose(),await s.exchange(),await s.finish(),this.useNoisePipes&&s.remotePeer&&h7.store(s.remotePeer,s.getRemoteStaticKey())}catch(a){if(a instanceof Error)throw a.message=`Error occurred during XX handshake: ${a.message}`,a}return s}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,t){let[r,n]=ihe(),i=e.unwrap();return await Te(r,zhe(t),kr({lengthEncoder:f4}),i,Er({lengthDecoder:h4}),Hhe(t),r),n}};c();var Zhe=new d7,QOe=Ze.bind({ignoreUndefined:!0,concatArrays:!0});function p4({options:e={},peerId:t,multiaddrs:r=[],repo:n,keychainConfig:i={},config:s={}}){let{datastore:a}=n,o=XOe({options:e,config:s,datastore:a,keychainConfig:i,peerId:t,multiaddrs:r});return typeof e.libp2p=="function"?e.libp2p({libp2pOptions:o,options:e,config:s,datastore:a,peerId:t}):ple(o)}function XOe({options:e,config:t,datastore:r,keychainConfig:n,peerId:i,multiaddrs:s}){let a=()=>{let p=(0,Qt.default)(t,"Pubsub.Router")||"gossipsub",v=Ere();if(!v[p])throw(0,Jhe.default)(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${p} router.`),"ERR_NOT_SUPPORTED");return v[p]},o={datastore:r,peerId:i},l={addresses:{listen:s.map(p=>p.toString()),announce:(0,Qt.default)(e,"addresses.announce",(0,Qt.default)(t,"Addresses.Announce",[])),noAnnounce:(0,Qt.default)(e,"addresses.noAnnounce",(0,Qt.default)(t,"Addresses.NoAnnounce",[]))},connectionManager:(0,Qt.default)(e,"connectionManager",{maxConnections:(0,Qt.default)(e,"config.Swarm.ConnMgr.HighWater",(0,Qt.default)(t,"Swarm.ConnMgr.HighWater")),minConnections:(0,Qt.default)(e,"config.Swarm.ConnMgr.LowWater",(0,Qt.default)(t,"Swarm.ConnMgr.LowWater"))}),keychain:n,identify:{host:{agentVersion:`js-ipfs/${Nh}`}},contentRouters:[],peerRouters:[],peerDiscovery:[],transports:[],streamMuxers:[new $v({maxStreamsPerConnection:1/0})],connectionEncryption:[Zhe],relay:{enabled:(0,Qt.default)(e,"relay.enabled",(0,Qt.default)(t,"relay.enabled",!0)),hop:{enabled:(0,Qt.default)(e,"relay.hop.enabled",(0,Qt.default)(t,"relay.hop.enabled",!1)),active:(0,Qt.default)(e,"relay.hop.active",(0,Qt.default)(t,"relay.hop.active",!1))}},nat:{enabled:!(0,Qt.default)(t,"Swarm.DisableNatPortMap",!1)}};(0,Qt.default)(e,"config.Pubsub.Enabled",(0,Qt.default)(t,"Pubsub.Enabled",!0))&&(l.pubsub=a()),(0,Qt.default)(t,"Routing.Type","dhtclient")!=="none"&&(l.dht=new Mv({clientMode:(0,Qt.default)(t,"Routing.Type","dht")!=="dhtserver",kBucketSize:(0,Qt.default)(e,"dht.kBucketSize",20),validators:{ipns:l0},selectors:{ipns:k6}}));let u=(0,Qt.default)(e,"config.Bootstrap",(0,Qt.default)(t,"Bootstrap",[]));u.length>0&&l.peerDiscovery?.push(new n4({list:u}));let h=(0,Qt.default)(e,"libp2p",void 0);typeof h=="function"&&(h=void 0);let f=QOe(o,Ase(),l,h),y=(0,Qt.default)(e,"config.Addresses.Delegates",(0,Qt.default)(t,"Addresses.Delegates",[]));if(y.length>0){let p=y[Math.floor(Math.random()*y.length)],v=new j(p).toOptions(),d={host:v.host,protocol:parseInt(v.port)===443?"https":"http",port:v.port},g=Moe(d);f.contentRouters?.push(new hb(g)),f.peerRouters?.push(new nb(g))}return(0,Qt.default)(e,"config.Discovery.MDNS.Enabled",(0,Qt.default)(t,"Discovery.MDNS.Enabled",!0))||(f.peerDiscovery=f.peerDiscovery?.filter(p=>p!=null&&p[Symbol.toStringTag]!=="@libp2p/mdns")),f.transports==null&&(f.transports=[]),f.transports.find(p=>p[Symbol.toStringTag]==="@libp2p/websockets")==null&&f.transports.push(new Kv),f}var aN=w(K(),1),tde=Ze.bind({ignoreUndefined:!0}),m4=C("ipfs:components:peer:storage"),Om=class{constructor(e,t,r,n,i){this.print=n,this.peerId=e,this.keychain=t,this.repo=r,this.print=n,this.isNew=i}static async start(e,t,r){let{repoAutoMigrate:n,repo:i,onMigrationProgress:s}=r,a=typeof i=="string"||i==null?Vee(e,t,{path:i,autoMigrate:n,onMigrationProgress:s}):i,{peerId:o,keychain:l,isNew:u}=await ZOe(e,a,r);return new Om(o,l,a,e,u)}},ZOe=async(e,t,r)=>{if(!t.closed)return{...await ede(t,r),isNew:!1};try{return await t.open(),{...await ede(t,r),isNew:!1}}catch(n){if(n.code!==Yh)throw n;if(r.init&&r.init.allowNew===!1)throw new Is("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await JOe(e,t,r),isNew:!0}}},JOe=async(e,t,r)=>{let n=r.init||{},i=await t.exists();if(m4("repo exists?",i),i===!0)throw new Error("repo already exists");let s=n.privateKey?await eLe(n.privateKey):await tLe(e,n),a=rLe(s);m4("peer identity: %s",a.PeerID);let o={...tde(rde(Kc(),n.profiles),r.config),Identity:a};await t.init(o),await t.open(),m4("repo opened");let l={pass:r.pass};try{l.dek=await t.config.get("Keychain.DEK")}catch(h){if(h.code!=="ERR_NOT_FOUND")throw h}let u=await p4({options:void 0,multiaddrs:void 0,peerId:s,repo:t,config:o,keychainConfig:l});return u.keychain&&(await u.loadKeychain(),await t.config.set("Keychain",{DEK:u.keychain.init.dek})),{peerId:s,keychain:u.keychain}},eLe=async e=>{if(m4("using user-supplied private-key"),Go(e))return e;let t=U(e,"base64pad"),r=await Jn(t);return await sn(r.public.bytes,r.bytes)},tLe=(e,{algorithm:t="Ed25519",bits:r=2048})=>{if(e("generating %s keypair...",t),t==="Ed25519")return tv();if(t==="RSA")return fle({bits:r});throw(0,aN.default)(new Error("Unknown PeerId algorithm"),"ERR_UNKNOWN_PEER_ID_ALGORITHM")},rLe=e=>{if(e.privateKey==null)throw(0,aN.default)(new Error("Private key missing"),"ERR_MISSING_PRIVATE_KEY");return{PeerID:e.toString(),PrivKey:M(e.privateKey,"base64pad")}},ede=async(e,t)=>{let r=t.config,n=t.init&&t.init.profiles||[],i=t.pass,s=await e.config.getAll(),a=nLe(rde(s,n),r);if(s!==a&&await e.config.replace(a),!a.Identity||!a.Identity.PrivKey)throw new Sc("No private key was found in the config, please intialize the repo");let o=U(a.Identity.PrivKey,"base64pad"),l=await Jn(o),u=await sn(l.public.bytes,l.bytes),h=await p4({options:void 0,multiaddrs:void 0,peerId:u,repo:e,config:a,keychainConfig:{pass:i,...a.Keychain}});return h.keychain&&await h.loadKeychain(),{peerId:u,keychain:h.keychain}},nLe=(e,t)=>t?tde(e,t):e,rde=(e,t)=>(t||[]).reduce((r,n)=>{let i=k0[n];if(!i)throw new Error(`Could not find profile with name '${n}'`);return m4("applying profile %s",n),i.transform(r)},e);c(),c(),c(),c(),c(),te(),vr(),Hr();var Ede=w(yde(),1);c();var y4=w(ai(),1);function gLe(e){let t=new Uint8Array(e.reduce((n,i)=>n+y4.default.encodingLength(i),0)),r=0;for(let n of e)t=y4.encode(n,t,r),r+=y4.default.encodingLength(n);return t}var gde=gLe;c();var uN=w(Mi(),1);yr(),c(),c(),c(),Hr();var g4=class{constructor(e,t,r){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=r}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(Ne)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};Hr(),c();var ua=w(Ea(),1),dc=ua.default.Reader,w4=ua.default.Writer,Ht=ua.default.util,Bt=ua.default.roots["ipfs-bitswap"]||(ua.default.roots["ipfs-bitswap"]={}),Bo=Bt.Message=(()=>{function e(t){if(this.blocks=[],this.payload=[],this.blockPresences=[],t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.wantlist=null,e.prototype.blocks=Ht.emptyArray,e.prototype.payload=Ht.emptyArray,e.prototype.blockPresences=Ht.emptyArray,e.prototype.pendingBytes=0,e.encode=function(t,r){if(r||(r=w4.create()),t.wantlist!=null&&Object.hasOwnProperty.call(t,"wantlist")&&Bt.Message.Wantlist.encode(t.wantlist,r.uint32(10).fork()).ldelim(),t.blocks!=null&&t.blocks.length)for(var n=0;n<t.blocks.length;++n)r.uint32(18).bytes(t.blocks[n]);if(t.payload!=null&&t.payload.length)for(var n=0;n<t.payload.length;++n)Bt.Message.Block.encode(t.payload[n],r.uint32(26).fork()).ldelim();if(t.blockPresences!=null&&t.blockPresences.length)for(var n=0;n<t.blockPresences.length;++n)Bt.Message.BlockPresence.encode(t.blockPresences[n],r.uint32(34).fork()).ldelim();return t.pendingBytes!=null&&Object.hasOwnProperty.call(t,"pendingBytes")&&r.uint32(40).int32(t.pendingBytes),r},e.decode=function(t,r){t instanceof dc||(t=dc.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new Bt.Message;t.pos<n;){var s=t.uint32();switch(s>>>3){case 1:i.wantlist=Bt.Message.Wantlist.decode(t,t.uint32());break;case 2:i.blocks&&i.blocks.length||(i.blocks=[]),i.blocks.push(t.bytes());break;case 3:i.payload&&i.payload.length||(i.payload=[]),i.payload.push(Bt.Message.Block.decode(t,t.uint32()));break;case 4:i.blockPresences&&i.blockPresences.length||(i.blockPresences=[]),i.blockPresences.push(Bt.Message.BlockPresence.decode(t,t.uint32()));break;case 5:i.pendingBytes=t.int32();break;default:t.skipType(s&7);break}}return i},e.fromObject=function(t){if(t instanceof Bt.Message)return t;var r=new Bt.Message;if(t.wantlist!=null){if(typeof t.wantlist!="object")throw TypeError(".Message.wantlist: object expected");r.wantlist=Bt.Message.Wantlist.fromObject(t.wantlist)}if(t.blocks){if(!Array.isArray(t.blocks))throw TypeError(".Message.blocks: array expected");r.blocks=[];for(var n=0;n<t.blocks.length;++n)typeof t.blocks[n]=="string"?Ht.base64.decode(t.blocks[n],r.blocks[n]=Ht.newBuffer(Ht.base64.length(t.blocks[n])),0):t.blocks[n].length&&(r.blocks[n]=t.blocks[n])}if(t.payload){if(!Array.isArray(t.payload))throw TypeError(".Message.payload: array expected");r.payload=[];for(var n=0;n<t.payload.length;++n){if(typeof t.payload[n]!="object")throw TypeError(".Message.payload: object expected");r.payload[n]=Bt.Message.Block.fromObject(t.payload[n])}}if(t.blockPresences){if(!Array.isArray(t.blockPresences))throw TypeError(".Message.blockPresences: array expected");r.blockPresences=[];for(var n=0;n<t.blockPresences.length;++n){if(typeof t.blockPresences[n]!="object")throw TypeError(".Message.blockPresences: object expected");r.blockPresences[n]=Bt.Message.BlockPresence.fromObject(t.blockPresences[n])}}return t.pendingBytes!=null&&(r.pendingBytes=t.pendingBytes|0),r},e.toObject=function(t,r){r||(r={});var n={};if((r.arrays||r.defaults)&&(n.blocks=[],n.payload=[],n.blockPresences=[]),r.defaults&&(n.wantlist=null,n.pendingBytes=0),t.wantlist!=null&&t.hasOwnProperty("wantlist")&&(n.wantlist=Bt.Message.Wantlist.toObject(t.wantlist,r)),t.blocks&&t.blocks.length){n.blocks=[];for(var i=0;i<t.blocks.length;++i)n.blocks[i]=r.bytes===String?Ht.base64.encode(t.blocks[i],0,t.blocks[i].length):r.bytes===Array?Array.prototype.slice.call(t.blocks[i]):t.blocks[i]}if(t.payload&&t.payload.length){n.payload=[];for(var i=0;i<t.payload.length;++i)n.payload[i]=Bt.Message.Block.toObject(t.payload[i],r)}if(t.blockPresences&&t.blockPresences.length){n.blockPresences=[];for(var i=0;i<t.blockPresences.length;++i)n.blockPresences[i]=Bt.Message.BlockPresence.toObject(t.blockPresences[i],r)}return t.pendingBytes!=null&&t.hasOwnProperty("pendingBytes")&&(n.pendingBytes=t.pendingBytes),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,ua.default.util.toJSONOptions)},e.Wantlist=function(){function t(r){if(this.entries=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return t.prototype.entries=Ht.emptyArray,t.prototype.full=!1,t.encode=function(r,n){if(n||(n=w4.create()),r.entries!=null&&r.entries.length)for(var i=0;i<r.entries.length;++i)Bt.Message.Wantlist.Entry.encode(r.entries[i],n.uint32(10).fork()).ldelim();return r.full!=null&&Object.hasOwnProperty.call(r,"full")&&n.uint32(16).bool(r.full),n},t.decode=function(r,n){r instanceof dc||(r=dc.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Bt.Message.Wantlist;r.pos<i;){var a=r.uint32();switch(a>>>3){case 1:s.entries&&s.entries.length||(s.entries=[]),s.entries.push(Bt.Message.Wantlist.Entry.decode(r,r.uint32()));break;case 2:s.full=r.bool();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof Bt.Message.Wantlist)return r;var n=new Bt.Message.Wantlist;if(r.entries){if(!Array.isArray(r.entries))throw TypeError(".Message.Wantlist.entries: array expected");n.entries=[];for(var i=0;i<r.entries.length;++i){if(typeof r.entries[i]!="object")throw TypeError(".Message.Wantlist.entries: object expected");n.entries[i]=Bt.Message.Wantlist.Entry.fromObject(r.entries[i])}}return r.full!=null&&(n.full=Boolean(r.full)),n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.entries=[]),n.defaults&&(i.full=!1),r.entries&&r.entries.length){i.entries=[];for(var s=0;s<r.entries.length;++s)i.entries[s]=Bt.Message.Wantlist.Entry.toObject(r.entries[s],n)}return r.full!=null&&r.hasOwnProperty("full")&&(i.full=r.full),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ua.default.util.toJSONOptions)},t.WantType=function(){let r={},n=Object.create(r);return n[r[0]="Block"]=0,n[r[1]="Have"]=1,n}(),t.Entry=function(){function r(n){if(n)for(var i=Object.keys(n),s=0;s<i.length;++s)n[i[s]]!=null&&(this[i[s]]=n[i[s]])}return r.prototype.block=Ht.newBuffer([]),r.prototype.priority=0,r.prototype.cancel=!1,r.prototype.wantType=0,r.prototype.sendDontHave=!1,r.encode=function(n,i){return i||(i=w4.create()),n.block!=null&&Object.hasOwnProperty.call(n,"block")&&i.uint32(10).bytes(n.block),n.priority!=null&&Object.hasOwnProperty.call(n,"priority")&&i.uint32(16).int32(n.priority),n.cancel!=null&&Object.hasOwnProperty.call(n,"cancel")&&i.uint32(24).bool(n.cancel),n.wantType!=null&&Object.hasOwnProperty.call(n,"wantType")&&i.uint32(32).int32(n.wantType),n.sendDontHave!=null&&Object.hasOwnProperty.call(n,"sendDontHave")&&i.uint32(40).bool(n.sendDontHave),i},r.decode=function(n,i){n instanceof dc||(n=dc.create(n));for(var s=i===void 0?n.len:n.pos+i,a=new Bt.Message.Wantlist.Entry;n.pos<s;){var o=n.uint32();switch(o>>>3){case 1:a.block=n.bytes();break;case 2:a.priority=n.int32();break;case 3:a.cancel=n.bool();break;case 4:a.wantType=n.int32();break;case 5:a.sendDontHave=n.bool();break;default:n.skipType(o&7);break}}return a},r.fromObject=function(n){if(n instanceof Bt.Message.Wantlist.Entry)return n;var i=new Bt.Message.Wantlist.Entry;switch(n.block!=null&&(typeof n.block=="string"?Ht.base64.decode(n.block,i.block=Ht.newBuffer(Ht.base64.length(n.block)),0):n.block.length&&(i.block=n.block)),n.priority!=null&&(i.priority=n.priority|0),n.cancel!=null&&(i.cancel=Boolean(n.cancel)),n.wantType){case"Block":case 0:i.wantType=0;break;case"Have":case 1:i.wantType=1;break}return n.sendDontHave!=null&&(i.sendDontHave=Boolean(n.sendDontHave)),i},r.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.block="":(s.block=[],i.bytes!==Array&&(s.block=Ht.newBuffer(s.block))),s.priority=0,s.cancel=!1,s.wantType=i.enums===String?"Block":0,s.sendDontHave=!1),n.block!=null&&n.hasOwnProperty("block")&&(s.block=i.bytes===String?Ht.base64.encode(n.block,0,n.block.length):i.bytes===Array?Array.prototype.slice.call(n.block):n.block),n.priority!=null&&n.hasOwnProperty("priority")&&(s.priority=n.priority),n.cancel!=null&&n.hasOwnProperty("cancel")&&(s.cancel=n.cancel),n.wantType!=null&&n.hasOwnProperty("wantType")&&(s.wantType=i.enums===String?Bt.Message.Wantlist.WantType[n.wantType]:n.wantType),n.sendDontHave!=null&&n.hasOwnProperty("sendDontHave")&&(s.sendDontHave=n.sendDontHave),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,ua.default.util.toJSONOptions)},r}(),t}(),e.Block=function(){function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return t.prototype.prefix=Ht.newBuffer([]),t.prototype.data=Ht.newBuffer([]),t.encode=function(r,n){return n||(n=w4.create()),r.prefix!=null&&Object.hasOwnProperty.call(r,"prefix")&&n.uint32(10).bytes(r.prefix),r.data!=null&&Object.hasOwnProperty.call(r,"data")&&n.uint32(18).bytes(r.data),n},t.decode=function(r,n){r instanceof dc||(r=dc.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Bt.Message.Block;r.pos<i;){var a=r.uint32();switch(a>>>3){case 1:s.prefix=r.bytes();break;case 2:s.data=r.bytes();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof Bt.Message.Block)return r;var n=new Bt.Message.Block;return r.prefix!=null&&(typeof r.prefix=="string"?Ht.base64.decode(r.prefix,n.prefix=Ht.newBuffer(Ht.base64.length(r.prefix)),0):r.prefix.length&&(n.prefix=r.prefix)),r.data!=null&&(typeof r.data=="string"?Ht.base64.decode(r.data,n.data=Ht.newBuffer(Ht.base64.length(r.data)),0):r.data.length&&(n.data=r.data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.prefix="":(i.prefix=[],n.bytes!==Array&&(i.prefix=Ht.newBuffer(i.prefix))),n.bytes===String?i.data="":(i.data=[],n.bytes!==Array&&(i.data=Ht.newBuffer(i.data)))),r.prefix!=null&&r.hasOwnProperty("prefix")&&(i.prefix=n.bytes===String?Ht.base64.encode(r.prefix,0,r.prefix.length):n.bytes===Array?Array.prototype.slice.call(r.prefix):r.prefix),r.data!=null&&r.hasOwnProperty("data")&&(i.data=n.bytes===String?Ht.base64.encode(r.data,0,r.data.length):n.bytes===Array?Array.prototype.slice.call(r.data):r.data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ua.default.util.toJSONOptions)},t}(),e.BlockPresenceType=function(){let t={},r=Object.create(t);return r[t[0]="Have"]=0,r[t[1]="DontHave"]=1,r}(),e.BlockPresence=function(){function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return t.prototype.cid=Ht.newBuffer([]),t.prototype.type=0,t.encode=function(r,n){return n||(n=w4.create()),r.cid!=null&&Object.hasOwnProperty.call(r,"cid")&&n.uint32(10).bytes(r.cid),r.type!=null&&Object.hasOwnProperty.call(r,"type")&&n.uint32(16).int32(r.type),n},t.decode=function(r,n){r instanceof dc||(r=dc.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Bt.Message.BlockPresence;r.pos<i;){var a=r.uint32();switch(a>>>3){case 1:s.cid=r.bytes();break;case 2:s.type=r.int32();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof Bt.Message.BlockPresence)return r;var n=new Bt.Message.BlockPresence;switch(r.cid!=null&&(typeof r.cid=="string"?Ht.base64.decode(r.cid,n.cid=Ht.newBuffer(Ht.base64.length(r.cid)),0):r.cid.length&&(n.cid=r.cid)),r.type){case"Have":case 0:n.type=0;break;case"DontHave":case 1:n.type=1;break}return n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.cid="":(i.cid=[],n.bytes!==Array&&(i.cid=Ht.newBuffer(i.cid))),i.type=n.enums===String?"Have":0),r.cid!=null&&r.hasOwnProperty("cid")&&(i.cid=n.bytes===String?Ht.base64.encode(r.cid,0,r.cid.length):n.bytes===Array?Array.prototype.slice.call(r.cid):r.cid),r.type!=null&&r.hasOwnProperty("type")&&(i.type=n.enums===String?Bt.Message.BlockPresenceType[r.type]:r.type),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ua.default.util.toJSONOptions)},t}(),e})(),wde={Block:Bo.Wantlist.WantType.Block,Have:Bo.Wantlist.WantType.Have},wLe=(e,t)=>Array.prototype.slice.call(t,0).sort((r,n)=>{let i=e(r),s=e(n);return i<s?-1:i>s?1:0}),la=class{constructor(e,t){this.set=t?Dn({system:"ipfs",component:"bitswap",metric:"wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,r){let n=e.toString(Ne),i=this.set.get(n);i?(i.inc(),i.priority=t,i.wantType===wde.Have&&r===wde.Block&&(i.wantType=r)):(this.set.set(n,new g4(e,t,r)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let t=e.toString(Ne),r=this.set.get(t);!r||(r.dec(),!r.hasRefs()&&(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(wLe(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let t=e.toString(Ne);return this.set.has(t)}get(e){let t=e.toString(Ne);return this.set.get(t)}};la.Entry=g4,Hr();var ELe=la.Entry,Df=class{constructor(e,t,r,n,i){this.entry=new ELe(e,t,r),this.cancel=Boolean(n),this.sendDontHave=Boolean(i)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(Ne)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}},Es=(e,t)=>{let r=["bitswap"];return t&&r.push(t),e&&r.push(`${e.toString().slice(0,8)}`),Object.assign((0,uN.default)(r.join(":")),{error:(0,uN.default)(r.concat(["error"]).join(":"))})},p7=(e,t)=>{if(e.size!==t.size)return!1;for(let[r,n]of e){let i=t.get(r);if(i===void 0||n instanceof Uint8Array&&i instanceof Uint8Array&&!Ce(n,i)||n instanceof Df&&i instanceof Df&&!n.equals(i))return!1}return!0},bde=w(K(),1),Xt=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,t,r,n,i){r==null&&(r=Xt.WantType.Block);let s=e.toString(Ne),a=this.wantlist.get(s);a?(a.wantType===r&&(a.priority=t),n&&(a.cancel=Boolean(n)),i&&(a.sendDontHave=Boolean(i)),r===Xt.WantType.Block&&a.wantType===Xt.WantType.Have&&(a.wantType=r)):this.wantlist.set(s,new Df(e,t,r,n,i))}addBlock(e,t){let r=e.toString(Ne);this.blocks.set(r,t)}addHave(e){let t=e.toString(Ne);this.blockPresences.has(t)||this.blockPresences.set(t,Xt.BlockPresenceType.Have)}addDontHave(e){let t=e.toString(Ne);this.blockPresences.has(t)||this.blockPresences.set(t,Xt.BlockPresenceType.DontHave)}cancel(e){let t=e.toString(Ne);this.wantlist.delete(t),this.addEntry(e,0,Xt.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),cancel:Boolean(t.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return Bo.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),wantType:t.wantType,cancel:Boolean(t.cancel),sendDontHave:Boolean(t.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[t,r]of this.blocks.entries()){let n=I.parse(t),i=n.version,s=n.code,a=n.multihash.code,o=n.multihash.digest.length,l=gde([i,s,a,o]);e.payload.push(new Bo.Block({prefix:l,data:r}))}for(let[t,r]of this.blockPresences)e.blockPresences.push(new Bo.BlockPresence({cid:I.parse(t).bytes,type:r}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),Bo.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!p7(this.wantlist,e.wantlist)||!p7(this.blocks,e.blocks)||!p7(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}};Xt.deserialize=async(e,t)=>{let r=Bo.decode(e),n=r.wantlist&&r.wantlist.full||!1,i=new Xt(n);return r.wantlist&&r.wantlist.entries&&r.wantlist.entries.forEach(s=>{if(!s.block)return;let a=I.decode(s.block);i.addEntry(a,s.priority||0,s.wantType,Boolean(s.cancel),Boolean(s.sendDontHave))}),r.blockPresences&&r.blockPresences.forEach(s=>{if(!s.cid)return;let a=I.decode(s.cid);s.type===Xt.BlockPresenceType.Have?i.addHave(a):i.addDontHave(a)}),r.blocks.length>0?(await Promise.all(r.blocks.map(async s=>{let a=await xe.digest(s),o=I.createV0(a);i.addBlock(o,s)})),i):(r.payload.length>0&&(await Promise.all(r.payload.map(async s=>{if(!s.prefix||!s.data)return;let a=(0,Ede.default)(s.prefix),o=a[0],l=a[1],u=a[2],h=u===xe.code?xe:t&&await t.getHasher(u);if(!h)throw(0,bde.default)(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let f=await h.digest(s.data),y=I.create(o,l,f);i.addBlock(y,s.data)})),i.setPendingBytes(r.pendingBytes)),i)},Xt.blockPresenceSize=e=>e.bytes.length+1,Xt.Entry=Df,Xt.WantType={Block:Bo.Wantlist.WantType.Block,Have:Bo.Wantlist.WantType.Have},Xt.BlockPresenceType={Have:Bo.BlockPresenceType.Have,DontHave:Bo.BlockPresenceType.DontHave},c();var _de=Math.pow(2,31)-1,vde=1e3,Sde=1;c(),c();var xde=bLe;function bLe(e,t,r){var n=null,i=null,s=function(){n&&(clearTimeout(n),i=null,n=null)},a=function(){var l=i;s(),l&&l()},o=function(){if(!t)return e.apply(this,arguments);var l=this,u=arguments,h=r&&!n;if(s(),i=function(){e.apply(l,u)},n=setTimeout(function(){if(n=null,!h){var f=i;return i=null,f()}},t),h)return i()};return o.cancel=s,o.flush=a,o}var m7=class{constructor(e,t,r){this.peerId=t,this.network=r,this.refcnt=1,this._entries=[],this._log=Es(e,"msgqueue"),this.sendEntries=xde(this._sendEntries.bind(this),Sde)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new Xt(!1);this._entries.forEach(t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(t){this._log.error("cant connect to peer %s: %s",this.peerId.toString(),t.message);return}this._log("sending message to peer %s",this.peerId.toString()),this.network.sendMessage(this.peerId,e).catch(t=>{this._log.error("send error: %s",t.message)})}};Hr();var y7=class{constructor(e,t,r,n){this.peers=Dn({system:"ipfs",component:"bitswap",metric:"want-manager-peers",metrics:n.metrics}),this.wantlist=new la(r,n),this.network=t,this._stats=r,this._peerId=e,this._log=Es(e,"want")}_addEntries(e,t,r){let n=e.map((i,s)=>new Xt.Entry(i,_de-s,Xt.WantType.Block,t));n.forEach(i=>{i.cancel?r?this.wantlist.removeForce(i.cid.toString(Ne)):this.wantlist.remove(i.cid):(this._log("adding to wl"),this.wantlist.add(i.cid,i.priority))});for(let i of this.peers.values())i.addEntries(n)}_startPeerHandler(e){let t=this.peers.get(e.toString());if(t){t.refcnt++;return}t=new m7(this._peerId,e,this.network);let r=new Xt(!0);for(let n of this.wantlist.entries())r.addEntry(n[1].cid,n[1].priority);return t.addMessage(r),this.peers.set(e.toString(),t),t}_stopPeerHandler(e){let t=this.peers.get(e.toString());!t||(t.refcnt--,!(t.refcnt>0)&&this.peers.delete(e.toString()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}};c();var fN="/ipfs/bitswap/1.0.0",hN="/ipfs/bitswap/1.1.0",dN="/ipfs/bitswap/1.2.0",g7=class{constructor(e,t,r,n={}){this._log=Es(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[fN],n.b100Only||(this._protocols.unshift(hN),this._protocols.unshift(dN)),this._stats=r,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=n.hashLoader}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection);let e=g1({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarId=await this._libp2p.registrar.register(this._protocols,e),this._libp2p.getConnections().forEach(t=>{this._onPeerConnect(t.remotePeer)})}async stop(){this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}_onConnection({protocol:e,stream:t,connection:r}){!this._running||Promise.resolve().then(async()=>{this._log("incoming new bitswap %s connection from %p",e,r.remotePeer),await Te(t,Er(),async n=>{for await(let i of n)try{let s=await Xt.deserialize(i.slice(),this._hashLoader);await this._bitswap._receiveMessage(r.remotePeer,s)}catch(s){this._bitswap._receiveError(s);break}})}).catch(n=>{this._log(n)})}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t={}){return this._libp2p.contentRouting.findProviders(e,t)}async findAndConnect(e,t){let r=[],n=0;for await(let i of this.findProviders(e,t))if(this._log(`connecting to provider ${i.id}`),r.push(this.connectTo(i.id,t).catch(s=>{this._log.error(s)})),n++,n===3)break;await Promise.all(r)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");let r=e.toString();this._log("sendMessage to %s",r,t);let n=await this._libp2p.dial(e),{stream:i,protocol:s}=await n.newStream([dN,hN,fN]),a;switch(s){case fN:a=t.serializeToBitswap100();break;case hN:case dN:a=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+s)}vLe(i,a,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){let r=e.toString();if(this._stats){for(let n of t.values())this._stats.push(r,"dataSent",n.length);this._stats.push(r,"blocksSent",t.size)}}};async function vLe(e,t,r){try{await Te([t],kr(),e)}catch(n){r(n)}}c(),te(),Hr(),c();var w7=class{constructor(e){this.partner=e,this.wantlist=new la,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,t,r){this.wantlist.add(e,t,r)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};c(),c();var E4=class extends Map{constructor(e,t){super(),this._cmp=t||this._defaultSort,this._keys=[];for(let[r,n]of e||[])this.set(r,n)}update(e){if(e<0||e>=this._keys.length)return;let t=this._keys[e];this._keys.splice(e,1);let r=this._find(t);this._keys.splice(r,0,t)}set(e,t){if(this.has(e)){let n=this.indexOf(e);this._keys.splice(n,1)}super.set(e,t);let r=this._find(e);return this._keys.splice(r,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let t=this._find(e);if(this._keys[t]===e)return t;for(let r=1;r<this._keys.length;r++){if(this._keys[t+r]===e)return t+r;if(this._keys[t-r]===e)return t-r}return-1}_find(e){let t=0,r=this._keys.length;for(;t<r;){let n=t+r>>>1,i=this._kCmp(this._keys[n],e);if(i<0)t=n+1;else if(i>0)r=n;else return n}return t}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(e)for(let r of this._keys)e.apply(t,[[r,this.get(r)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}},SLe={hasNewInfo(){return!1},merge(){}},E7=class{constructor(e=SLe){this._taskMerger=e,this._byPeer=new E4([],b7.compare)}pushTasks(e,t){let r=this._byPeer.get(e.toString());r||(r=new b7(e,this._taskMerger)),r.pushTasks(t),this._byPeer.set(e.toString(),r)}popTasks(e){let t=this._head();if(t===void 0)return{tasks:[],pendingSize:0};let{tasks:r,pendingSize:n}=t.popTasks(e);if(r.length===0)return{tasks:r,pendingSize:n};let i=t.peerId;return t.isIdle()?this._byPeer.delete(i.toString()):this._byPeer.update(0),{peerId:i,tasks:r,pendingSize:n}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,t){let r=this._byPeer.get(t.toString());r&&r.remove(e)}tasksDone(e,t){let r=this._byPeer.get(e.toString());if(!r)return;let n=this._byPeer.indexOf(e.toString());for(let i of t)r.taskDone(i);this._byPeer.update(n)}},b7=class{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new pN,this._active=new Set}pushTasks(e){for(let t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let t=this._pending.get(e.topic);if(t){e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,t);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let t=[];for(let r of this._active)r.topic===e.topic&&t.push(r);return t.length===0?!0:this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0,r=[],n=this._pending.tasks();for(let i=0;i<n.length&&t<e;i++){let s=n[i];r.push(s),t+=s.size,this._pending.delete(s.topic),this._activeTotalSize+=s.size,this._active.add(s)}return{tasks:r,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,t){return e[1]._pending.length===0?1:t[1]._pending.length===0?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}},pN=class{constructor(){this._tasks=new E4([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){let r=this._tasks.get(e);if(!r)return;let n=this._tasks.indexOf(e);r.task.priority=t,this._tasks.update(n)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}};c();var Rde={hasNewInfo(e,t){let r=!1,n=!1;for(let i of t)i.data.haveBlock&&(r=!0),i.data.isWantBlock&&(n=!0);return!!(!n&&e.data.isWantBlock||!r&&e.data.haveBlock)},merge(e,t){let r=e.data,n=t.data;!n.haveBlock&&r.haveBlock&&(n.haveBlock=r.haveBlock,n.blockSize=r.blockSize),!n.isWantBlock&&r.isWantBlock&&(n.isWantBlock=!0,(!n.haveBlock||r.haveBlock)&&(n.haveBlock=r.haveBlock,t.size=e.size)),n.isWantBlock&&n.haveBlock&&(t.size=n.blockSize)}},Ade=Xt.WantType,xLe=16*1024,RLe=1024,_7=class{constructor(e,t,r,n,i,s={}){this._log=Es(e,"engine"),this.blockstore=t,this.network=r,this._stats=n,this._opts=this._processOpts(s),this.ledgerMap=Dn({system:"ipfs",component:"bitswap",metric:"ledger-map",metrics:i.metrics}),this._running=!1,this._requestQueue=new E7(Rde)}_processOpts(e){return{maxSizeReplaceHasWithBlock:RLe,targetMessageSize:xLe,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:t,pendingSize:r}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(t.length===0)return;let n=new Xt(!1);n.setPendingBytes(r);let i=[],s=new Map;for(let o of t){let l=I.parse(o.topic);o.data.haveBlock?o.data.isWantBlock?(i.push(l),s.set(o.topic,o.data)):n.addHave(l):n.addDontHave(l)}let a=await this._getBlocks(i);for(let[o,l]of s){let u=I.parse(o),h=a.get(o);h?n.addBlock(u,h):l.sendDontHave&&n.addDontHave(u)}if(n.empty){e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,n);for(let[o,l]of a.entries())e&&this.messageSent(e,I.parse(o),l)}catch(o){this._log.error(o)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){let t=e.toString(),r=this.ledgerMap.get(t);return r?r.wantlist.sortedEntries():new Map}ledgerForPeer(e){let t=e.toString(),r=this.ledgerMap.get(t);return r?{peer:r.partner,value:r.debtRatio(),sent:r.accounting.bytesSent,recv:r.accounting.bytesRecv,exchanged:r.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(e.length){for(let t of this.ledgerMap.values())for(let r of e){let n=t.wantlistContains(r.cid);if(!n)continue;let i=r.data.length,s=this._sendAsBlock(n.wantType,i),a=i;s||(a=Xt.blockPresenceSize(n.cid)),this._requestQueue.pushTasks(t.partner,[{topic:n.cid.toString(Ne),priority:n.priority,size:a,data:{blockSize:i,isWantBlock:s,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){let r=this._findOrCreate(e);if(t.empty)return;if(t.full&&(r.wantlist=new la),this._updateBlockAccounting(t.blocks,r),t.wantlist.size===0){this._scheduleProcessTasks();return}let n=[],i=[];t.wantlist.forEach(s=>{s.cancel?(r.cancelWant(s.cid),n.push(s.cid)):(r.wants(s.cid,s.priority,s.wantType),i.push(s))}),this._cancelWants(e,n),await this._addWants(e,i),this._scheduleProcessTasks()}_cancelWants(e,t){for(let r of t)this._requestQueue.remove(r.toString(Ne),e)}async _addWants(e,t){let r=await this._getBlockSizes(t.map(i=>i.cid)),n=[];for(let i of t){let s=i.cid.toString(Ne),a=r.get(s);if(a==null)i.sendDontHave&&n.push({topic:s,priority:i.priority,size:Xt.blockPresenceSize(i.cid),data:{isWantBlock:i.wantType===Ade.Block,blockSize:0,haveBlock:!1,sendDontHave:i.sendDontHave}});else{let o=this._sendAsBlock(i.wantType,a),l=a;o||(l=Xt.blockPresenceSize(i.cid)),n.push({topic:s,priority:i.priority,size:l,data:{isWantBlock:o,blockSize:a,haveBlock:!0,sendDontHave:i.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,t){return e===Ade.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let t=await this._getBlocks(e);return new Map([...t].map(([r,n])=>[r,n.length]))}async _getBlocks(e){let t=new Map;return await Promise.all(e.map(async r=>{try{let n=await this.blockstore.get(r);t.set(r.toString(Ne),n)}catch(n){n.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",r,n)}})),t}_updateBlockAccounting(e,t){for(let r of e.values())this._log("got block (%s bytes)",r.length),t.receivedBytes(r.length)}messageSent(e,t,r){let n=this._findOrCreate(e);n.sentBytes(r.length),n.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){let t=e.toString(),r=this.ledgerMap.get(t);if(r)return r;let n=new w7(e);return this.ledgerMap.set(t,n),this._stats&&this._stats.push(t,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}};c();var Cde=w(In(),1);me();var Tde=e=>`unwant:${M(e.multihash.bytes,"base64")}`,Ide=e=>`block:${M(e.multihash.bytes,"base64")}`,v7=class extends Cde.EventEmitter{constructor(e){super(),this.setMaxListeners(vde),this._log=Es(e,"notif")}hasBlock(e,t){let r=Ide(e);this._log(r),this.emit(r,t)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");let r=Ide(e),n=Tde(e);return this._log(`wantBlock:${e}`),new Promise((i,s)=>{let a=()=>{this.removeListener(r,o),s(new Error(`Block for ${e} unwanted`))},o=l=>{this.removeListener(n,a),i(l)};this.once(n,a),this.once(r,o),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.removeListener(r,o),this.removeListener(n,a),s(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let t=Tde(e);this._log(t),this.emit(t)}};c();var Lde=w(In(),1);c();var Nde=w(In(),1),mN=w(kde(),1),b4=class extends Nde.EventEmitter{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(r=>{this._stats[r]=BigInt(0),this._movingAverages[r]={},this._options.movingAverageIntervals.forEach(n=>{(this._movingAverages[r][n]=(0,mN.default)(n)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach(r=>{this._updateFrequencyFor(r,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,r){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let i=n/t*1e3,s=this._movingAverages[e];s||(s=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let o=s[a];o||(o=s[a]=(0,mN.default)(a)),o.push(r,i)})}_applyOp(e){let t=e[0],r=e[1];if(typeof r!="number")throw new Error(`invalid increment number: ${r}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(r),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=r}},Ode={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},S7=class extends Lde.EventEmitter{constructor(e,t=[],r=Ode){super();let n=Object.assign({},Ode,r);if(typeof n.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof n.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=n,this._enabled=this._options.enabled,this._global=new b4(t,n),this._global.on("update",i=>this.emit("update",i)),this._peers=Dn({system:"ipfs",component:"bitswap",metric:"stats-peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let t=typeof e!="string"&&e.toString?e.toString():`${e}`;return this._peers.get(t)}push(e,t,r){if(this._enabled&&(this._global.push(t,r),e)){let n=this._peers.get(e);n||(n=new b4(this._initialCounters,this._options),this._peers.set(e,n)),n.push(t,r)}}disconnected(e){let t=e.toString(),r=this._peers.get(t);r&&(r.stop(),this._peers.delete(t))}},Bde=w(Vi(),1);te();var TLe={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},ILe=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],x7=class extends ja{constructor(e,t,r={}){super(),this._libp2p=e,this._log=Es(this.peerId),this._options=Object.assign({},TLe,r),this._stats=new S7(e,ILe,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new g7(e,this,this._stats,{hashLoader:r.hashLoader}),this.blockstore=t,this.engine=new _7(this.peerId,t,this.network,this._stats,e),this.wm=new y7(this.peerId,this.network,this._stats,e),this.notifications=new v7(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch{this._log("failed to receive message",t)}if(t.blocks.size===0)return;let r=[];for(let[n,i]of t.blocks.entries()){let s=I.parse(n);r.push({wasWanted:this.wm.wantlist.contains(s),cid:s,data:i})}this.wm.cancelWants(r.filter(({wasWanted:n})=>n).map(({cid:n})=>n)),await Promise.all(r.map(({cid:n,wasWanted:i,data:s})=>this._handleReceivedBlock(e,n,s,i)))}async _handleReceivedBlock(e,t,r,n){this._log("received block");let i=await this.blockstore.has(t);this._updateReceiveCounters(e.toString(),t,r,i),n&&await this.put(t,r)}_updateReceiveCounters(e,t,r,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",r.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",r.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){let r=(o,l)=>(this.wm.wantBlocks([o],l),this.notifications.wantBlock(o,l)),n=!1,i=async(o,l)=>{try{return await this.blockstore.get(o,l)}catch(u){if(u.code!=="ERR_NOT_FOUND")throw u;return n||(n=!0,this.network.findAndConnect(o,l).catch(h=>this._log.error(h))),r(o,l)}},s=new AbortController,a=t.signal?(0,Bde.anySignal)([t.signal,s.signal]):s.signal;try{return await Promise.race([this.notifications.wantBlock(e,{signal:a}),i(e,{signal:a})])}finally{s.abort()}}async*getMany(e,t={}){for await(let r of e)yield this.get(r,t)}unwant(e){let t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(r=>this.notifications.unwantBlock(r))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,r){await this.blockstore.put(e,t),this._sendHaveBlockNotifications(e,t)}async*putMany(e,t){for await(let{key:r,value:n}of this.blockstore.putMany(e,t))this._sendHaveBlockNotifications(r,n),yield{key:r,value:n}}_sendHaveBlockNotifications(e,t){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,data:t}]),this.network.provide(e).catch(r=>{this._log.error("Failed to provide: %s",r.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}},Mde=(e,t,r={})=>new x7(e,t,r),Vde=w(K(),1);c(),c();var R7={};ct(R7,{abortedError:()=>CLe,notFoundError:()=>Ude}),c();var yN=w(K(),1);function Ude(e){return e=e||new Error("Not Found"),(0,yN.default)(e,"ERR_NOT_FOUND")}function CLe(e){return e=e||new Error("Aborted"),(0,yN.default)(e,"ERR_ABORTED")}c(),si(),zo(),te(),On();var mMt={...R7},Fde=w(Fc(),1),Kde=w(Gi(),1),A7=class extends ja{constructor(e,t){super(),this.child=e,this.bitswap=t}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,t,r={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,t,r):await this.child.put(e,t,r))}async*putMany(e,t={}){let r=(0,Kde.default)(e,async({key:n})=>!await this.has(n));this.bitswap.isStarted()?yield*this.bitswap.putMany(r,t):yield*this.child.putMany(r,t)}async get(e,t={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,t):this.child.get(e,t)}async*getMany(e,t={}){let r=zs(),n=zs();Promise.resolve().then(async()=>{for await(let i of e)!await this.has(i)&&this.bitswap.isStarted()?r.push(i):n.push(i);r.end(),n.end()}),yield*(0,Fde.default)(this.bitswap.getMany(r,t),this.child.getMany(n,t))}async delete(e,t){await this.child.delete(e,t)}async*deleteMany(e,t){yield*this.child.deleteMany(e,t)}async has(e,t={}){return this.child.has(e,t)}async*query(e,t={}){yield*this.child.query(e,t)}async*queryKeys(e,t={}){yield*this.child.queryKeys(e,t)}},Lm=class{constructor(e,t,r,n,i){this.peerId=e,this.libp2p=t,this.bitswap=r,this.repo=n,this.blockstore=i}static async start({peerId:e,repo:t,print:r,hashers:n,options:i}){t.closed&&await t.open();let s=await t.config.getAll(),a=await p4({options:i,repo:t,peerId:e,multiaddrs:PLe(e,s),config:s,keychainConfig:void 0});a.keychain&&await a.loadKeychain(),await a.start();for(let u of a.getMultiaddrs())r(`Swarm listening on ${u.toString()}`);let o=Mde(a,t.blocks,{statsEnabled:!0,hashLoader:n});await o.start();let l=new A7(t.blocks,o);return t.blocks=l,t.pins.blockstore=l,new Lm(e,a,o,t,l)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await e.bitswap.stop(),await e.libp2p.stop()}},PLe=(e,t)=>{let r=e.toString(),n=[],i=t.Addresses&&t.Addresses.Swarm||[];for(let s of i){let a=new j(s);if(a.protoCodes().includes(DLe))throw(0,Vde.default)(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let o=a.getPeerId();o&&o!==r&&(a=a.encapsulate(`/p2p/${r}`)),n.push(a)}return n},DLe=479;c(),c();function qde({network:e}){async function t(r={}){let n=[],{libp2p:i}=await e.use(r);return await i.peerStore.forEach(s=>{n.push({id:s.id,addrs:s.addresses.map(a=>a.multiaddr)})}),n}return B(t)}c();function zde({network:e}){async function t(r,n={}){let{libp2p:i}=await e.use(n);await i.dial(r,n)}return B(t)}c();function Hde({network:e}){async function t(r,n={}){let{libp2p:i}=await e.use(n);await i.hangUp(r)}return B(t)}c();function $de({network:e}){async function t(r={}){let{libp2p:n}=await e.use(r);return n.getMultiaddrs()}return B(t)}c();function Gde({network:e}){async function t(r={}){let{libp2p:n}=await e.use(r);if(r.verbose){let s=[];for(let a of n.getConnections()){let o={addr:a.remoteAddr,peer:a.remotePeer};(r.verbose||r.direction)&&(o.direction=a.stat.direction),r.verbose&&(o.muxer=a.stat.multiplexer,o.latency="n/a",o.streams=[]),s.push(o)}return s}let i=new Map;for(let s of n.getConnections()){let a={addr:s.remoteAddr,peer:s.remotePeer};i.set(s.remotePeer.toString(),a)}return Array.from(i.values())}return B(t)}var T7=class{constructor({network:e}){this.addrs=qde({network:e}),this.connect=zde({network:e}),this.disconnect=Hde({network:e}),this.localAddrs=$de({network:e}),this.peers=Gde({network:e})}};c();var _4={success:!0,time:0,text:""};function Wde({network:e}){async function*t(r,n={}){let{libp2p:i}=await e.use();n.count=n.count||10;let s=await i.peerStore.get(r),a=s&&s.id;if(!a){yield{..._4,text:`Looking up peer ${r}`};let u=await i.peerRouting.findPeer(r);a=u&&u.id}if(!a)throw new Error("Peer was not found");yield{..._4,text:`PING ${a.toString()}`};let o=0,l=0;for(let u=0;u<n.count;u++)try{let h=await i.ping(a);l+=h,o++,yield{..._4,time:h}}catch(h){yield{..._4,success:!1,text:h.toString()}}if(o){let u=l/o;yield{..._4,text:`Average latency: ${u}ms`}}}return B(t)}c();var Lu=w(K(),1);te(),Hr(),nw(),ur(),Re();var gN="/ipns/";function jde(e){e.startsWith(gN)&&(e=e.substring(gN.length));let t;if((e[0]==="1"||e[0]==="Q")&&(e=`z${e}`),e[0]==="z"&&(t=Ne.decode(e)),e[0]==="k"&&(t=xp.decode(e)),!t)throw new Error("Could not parse string");if(t[0]!==1&&t[1]!==114&&(t=Ae([[1,114],t])),t.length!==40)throw new Error("Incorrect length "+t.length);return Ae([U(gN),t.subarray(2)])}function Yde({network:e,repo:t,peerId:r}){let{get:n,put:i,findProvs:s,findPeer:a,provide:o,query:l}={async*get(u,h={}){let{libp2p:f}=await Bm(e,r,h),y=u instanceof Uint8Array?u:jde(u);if(f.dht==null)throw(0,Lu.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*f.dht.get(y,h)},async*put(u,h,f){let{libp2p:y}=await Bm(e,r,f),p=u instanceof Uint8Array?u:jde(u);if(y.dht==null)throw(0,Lu.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*y.dht.put(p,h)},async*findProvs(u,h={}){let{libp2p:f}=await Bm(e,r,h);if(f.dht==null)throw(0,Lu.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*f.dht.findProviders(u,{signal:h.signal})},async*findPeer(u,h={}){let{libp2p:f}=await Bm(e,r,h);if(f.dht==null)throw(0,Lu.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*f.dht.findPeer(u,{signal:h.signal})},async*provide(u,h={recursive:!1}){let{libp2p:f}=await Bm(e,r,h);if(!await t.blocks.has(u))throw(0,Lu.default)(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(h.recursive)throw(0,Lu.default)(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");if(f.dht==null)throw(0,Lu.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*f.dht.provide(u)},async*query(u,h={}){let{libp2p:f}=await Bm(e,r,h),y,p=I.asCID(u);if(p!=null?y=p.multihash.bytes:y=ue(u.toString()).toBytes(),f.dht==null)throw(0,Lu.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*f.dht.getClosestPeers(y,h)}};return{get:B(n),put:B(i),findProvs:B(s),findPeer:B(a),provide:B(o),query:B(l)}}var Bm=async(e,t,r)=>{let n=await e.use(r);if(n.libp2p.dht!=null)return n;{let i=async function*(){yield{from:t,name:"QUERY_ERROR",type:3,error:new Is("dht not enabled")}};return{libp2p:{dht:{get:i,put:i,findProviders:i,findPeer:i,provide:i,getClosestPeers:i}}}}};c();var Qde=w(K(),1),Xde=w(D6(),1);function Zde({network:e,config:t}){let r=(0,Xde.default)(t||{},"Pubsub.Enabled",!0),n={},i;return{subscribe:r?B(s):v4,unsubscribe:r?B(a):v4,publish:r?B(o):v4,ls:r?B(l):v4,peers:r?B(u):v4};async function s(h,f,y={}){let{libp2p:p}=await e.use(y);p.pubsub.subscribe(h),i==null&&(i=v=>{let d=v.detail;n[d.topic]&&n[d.topic].forEach(g=>{if(typeof g=="function"){g(d);return}g!=null&&g.handleEvent!=null&&g.handleEvent(d)})},p.pubsub.addEventListener("message",i)),f!=null&&(n[h]==null&&(n[h]=[]),n[h].push(f))}async function a(h,f,y={}){let{libp2p:p}=await e.use(y);f!=null&&n[h]!=null&&(n[h]=n[h].filter(v=>v!==f),n[h].length===0&&delete n[h]),typeof f!="function"&&delete n[h],n[h]==null&&p.pubsub.unsubscribe(h),Object.keys(n).length===0&&(p.pubsub.removeEventListener("message",i),i=void 0)}async function o(h,f,y={}){let{libp2p:p}=await e.use(y);if(!f)throw(0,Qde.default)(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await p.pubsub.publish(h,f)}async function l(h={}){let{libp2p:f}=await e.use(h);return f.pubsub.getTopics()}async function u(h,f={}){let{libp2p:y}=await e.use(f);return y.pubsub.getSubscribers(h)}}var v4=async()=>{throw new Is("pubsub not enabled")},NLe=Ze.bind({ignoreUndefined:!0}),kf=C("ipfs"),wN=class{constructor({print:e,storage:t,codecs:r,options:n}){let{peerId:i,repo:s,keychain:a}=t,o=li.create(Lm),l=Dj(n.preload),u=SF(),h=xF({network:o}),f=new U6(n),y=Object.values(ow);(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]).forEach(ne=>y.push(ne)),this.hashers=new M1({hashers:y,loadHasher:n.ipld&&n.ipld.loadHasher});let p=Object.values(Sa);(n.ipld&&n.ipld.bases?n.ipld.bases:[]).forEach(ne=>p.push(ne)),this.bases=new L1({bases:p,loadBase:n.ipld&&n.ipld.loadBase});let v=new Ow({repo:s,codecs:r}),d=new s5({codecs:r,hashers:this.hashers,preload:l,repo:s}),g=new V6({dns:u,ipns:f,repo:s,codecs:r,peerId:i,isOnline:h,keychain:a,options:n}),b=CF({repo:s,codecs:r,bases:this.bases,name:g}),_=new X5({repo:s,codecs:r,hashers:this.hashers,preload:l}),m=Object.assign(kz({repo:s,codecs:r,resolve:b,preload:l}),{local:Nz({repo:t.repo})}),{add:E,addAll:D,cat:N,get:R,ls:T}=new q5({preload:l,repo:s,options:n.EXPERIMENTAL,hashers:this.hashers}),S=xY({repo:s,preload:l,hashers:this.hashers,options:n}),O=kj({files:S,preload:l,options:n.preload});this.preload=l,this.name=g,this.ipns=f,this.pin=v,this.resolve=b,this.block=d,this.refs=m,this.start=WU({network:o,peerId:i,repo:s,preload:l,ipns:f,mfsPreload:O,print:e,keychain:a,hashers:this.hashers,options:n}),this.stop=jU({network:o,preload:l,mfsPreload:O,ipns:f,repo:s}),this.dht=Yde({network:o,repo:s,peerId:i}),this.pubsub=Zde({network:o,config:n.config}),this.dns=u,this.isOnline=h,this.id=ej({network:o,peerId:i}),this.version=JW({repo:s}),this.bitswap=new z6({network:o}),this.bootstrap=new J6({repo:s}),this.config=rj({repo:s}),this.ping=Wde({network:o}),this.add=E,this.addAll=D,this.cat=N,this.get=R,this.ls=T,this.dag=_,this.files=S,this.key=new p8({keychain:a}),this.object=new y8({preload:l,codecs:r,repo:s}),this.repo=new w8({repo:s,hashers:this.hashers}),this.stats=new E8({repo:s,network:o}),this.swarm=new T7({network:o}),Object.defineProperty(this,"libp2p",{get(){let ne=o.try();return ne?ne.libp2p:void 0}});let F=()=>Promise.reject((0,I7.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),G=async function*(){throw(0,I7.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=F,this.diag={cmds:F,net:F,sys:F},this.log={level:F,ls:F,tail:G},this.mount=F,this.codecs=r}async init(){throw new Ts}},OLe=async e=>{let t=je({Data:new Je({type:"directory"}).marshal(),Links:[]}),r=await e.block.put(t,{mhtype:"sha2-256",format:"dag-pb"});return await e.pin.add(r),r},LLe=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!Jde.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}});async function epe(e={}){e=NLe(LLe(),e);let t=e.init||{},r={name:$r.name,code:$r.code,encode:u=>u,decode:u=>u},n=Object.values(sw);[At,vc,vp,kLe,r].concat(e.ipld&&e.ipld.codecs||[]).forEach(u=>n.push(u));let i=new B1({codecs:n,loadCodec:e.ipld&&e.ipld.loadCodec}),s=e.silent?kf:console.log;kf("creating repo");let a=await Om.start(s,i,e);kf("getting repo config");let o=await a.repo.config.getAll(),l=new wN({storage:a,print:s,codecs:i,options:{...e,config:o}});if(kf("starting preload"),await l.preload.start(),kf("starting storage"),l.ipns.startOffline(a),a.isNew&&!t.emptyRepo){let u=await OLe(l);if(kf("adding default assets"),await(l.addAll,void 0),kf("initializing IPNS keyspace"),a.peerId.publicKey==null)throw(0,I7.default)(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");await l.ipns.initializeKeyspace(a.peerId,U(`/ipfs/${u}`))}return e.start!==!1&&(kf("starting node"),await l.start()),l}var tpe=w(hP(),1),rpe=w(dP(),1),BLe=epe,MLe=tpe.default,ULe=rpe.default;return cr(FLe)})();return IpfsCore})});fe();fe();fe();fe();fe();fe();fe();var lE=O2,D2=128,uE=127,hE=~uE,dE=Math.pow(2,31);function O2(e,t,r){t=t||[],r=r||0;for(var n=r;e>=dE;)t[r++]=e&255|D2,e/=128;for(;e&hE;)t[r++]=e&255|D2,e>>>=7;return t[r]=e|0,O2.bytes=r-n+1,t}var fE=d1,pE=128,N2=127;function d1(e,n){var r=0,n=n||0,i=0,s=n,a,o=e.length;do{if(s>=o)throw d1.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&N2)<<i:(a&N2)*Math.pow(2,i),i+=7}while(a>=pE);return d1.bytes=s-n,r}var yE=Math.pow(2,7),mE=Math.pow(2,14),wE=Math.pow(2,21),vE=Math.pow(2,28),bE=Math.pow(2,35),EE=Math.pow(2,42),_E=Math.pow(2,49),SE=Math.pow(2,56),LE=Math.pow(2,63),xE=function(e){return e<yE?1:e<mE?2:e<wE?3:e<vE?4:e<bE?5:e<EE?6:e<_E?7:e<SE?8:e<LE?9:10},BE={encode:lE,decode:fE,encodingLength:xE},ME=BE,il=ME;var al=e=>[il.decode(e),il.decode.bytes],Ia=(e,t,r=0)=>(il.encode(e,t,r),t),Ca=e=>il.encodingLength(e);fe();fe();var eN=new Uint8Array(0);var B2=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},ss=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var hy=e=>new TextEncoder().encode(e),dy=e=>new TextDecoder().decode(e);var bs=(e,t)=>{let r=t.byteLength,n=Ca(e),i=n+Ca(r),s=new Uint8Array(i+r);return Ia(e,s,0),Ia(r,s,n),s.set(t,i),new ka(e,r,t,s)},Qs=e=>{let t=ss(e),[r,n]=al(t),[i,s]=al(t.subarray(n)),a=t.subarray(n+s);if(a.byteLength!==i)throw new Error("Incorrect length");return new ka(r,i,a,t)},gy=(e,t)=>e===t?!0:e.code===t.code&&e.size===t.size&&B2(e.bytes,t.bytes),ka=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}};var I1={};Vn(I1,{base58btc:()=>rn,base58flickr:()=>$E});fe();fe();fe();function UE(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var o=e.length,l=e.charAt(0),u=Math.log(o)/Math.log(256),h=Math.log(256)/Math.log(o);function f(v){if(v instanceof Uint8Array||(ArrayBuffer.isView(v)?v=new Uint8Array(v.buffer,v.byteOffset,v.byteLength):Array.isArray(v)&&(v=Uint8Array.from(v))),!(v instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(v.length===0)return"";for(var d=0,g=0,b=0,_=v.length;b!==_&&v[b]===0;)b++,d++;for(var m=(_-b)*h+1>>>0,E=new Uint8Array(m);b!==_;){for(var D=v[b],N=0,R=m-1;(D!==0||N<g)&&R!==-1;R--,N++)D+=256*E[R]>>>0,E[R]=D%o>>>0,D=D/o>>>0;if(D!==0)throw new Error("Non-zero carry");g=N,b++}for(var T=m-g;T!==m&&E[T]===0;)T++;for(var S=l.repeat(d);T<m;++T)S+=e.charAt(E[T]);return S}function y(v){if(typeof v!="string")throw new TypeError("Expected String");if(v.length===0)return new Uint8Array;var d=0;if(v[d]!==" "){for(var g=0,b=0;v[d]===l;)g++,d++;for(var _=(v.length-d)*u+1>>>0,m=new Uint8Array(_);v[d];){var E=r[v.charCodeAt(d)];if(E===255)return;for(var D=0,N=_-1;(E!==0||D<b)&&N!==-1;N--,D++)E+=o*m[N]>>>0,m[N]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");b=D,d++}if(v[d]!==" "){for(var R=_-b;R!==_&&m[R]===0;)R++;for(var T=new Uint8Array(g+(_-R)),S=g;R!==_;)T[S++]=m[R++];return T}}}function p(v){var d=y(v);if(d)return d;throw new Error(`Non-${t} character`)}return{encode:f,decodeUnsafe:y,decode:p}}var FE=UE,jE=FE,my=jE;var f1=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},p1=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Zy(this,t)}},m1=class{constructor(t){this.decoders=t}or(t){return Zy(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Zy=(e,t)=>new m1({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),A1=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new f1(t,r,n),this.decoder=new p1(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},Ta=({name:e,prefix:t,encode:r,decode:n})=>new A1(e,t,r,n),Ss=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=my(r,t);return Ta({prefix:e,name:t,encode:n,decode:s=>ss(i(s))})},zE=(e,t,r,n)=>{let i={};for(let h=0;h<t.length;++h)i[t[h]]=h;let s=e.length;for(;e[s-1]==="=";)--s;let a=new Uint8Array(s*r/8|0),o=0,l=0,u=0;for(let h=0;h<s;++h){let f=i[e[h]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);l=l<<r|f,o+=r,o>=8&&(o-=8,a[u++]=255&l>>o)}if(o>=r||255&l<<8-o)throw new SyntaxError("Unexpected end of data");return a},KE=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,s="",a=0,o=0;for(let l=0;l<e.length;++l)for(o=o<<8|e[l],a+=8;a>r;)a-=r,s+=t[i&o>>a];if(a&&(s+=t[i&o<<r-a]),n)for(;s.length*r&7;)s+="=";return s},Zr=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Ta({prefix:t,name:e,encode(i){return KE(i,n,r)},decode(i){return zE(i,n,r,e)}});var rn=Ss({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$E=Ss({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var R1={};Vn(R1,{base32:()=>Bi,base32hex:()=>GE,base32hexpad:()=>h_,base32hexpadupper:()=>f_,base32hexupper:()=>l_,base32pad:()=>HE,base32padupper:()=>WE,base32upper:()=>qE,base32z:()=>A_});fe();var Bi=Zr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qE=Zr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),HE=Zr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),WE=Zr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),GE=Zr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),l_=Zr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),h_=Zr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),f_=Zr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),A_=Zr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var fr=class{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Wu,byteLength:Wu,code:Vu,version:Vu,multihash:Vu,bytes:Vu,_baseCache:Wu,asCID:Wu})}toV0(){switch(this.version){case 0:return this;default:{let{code:t,multihash:r}=this;if(t!==ol)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==gS)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return fr.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=bs(t,r);return fr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(t){return t&&this.code===t.code&&this.version===t.version&&gy(this.multihash,t.multihash)}toString(t){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return pS(r,i,t||rn.encoder);default:return yS(r,i,t||Bi.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(t){return wS(/^0\.0/,vS),!!(t&&(t[lg]||t.asCID===t))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(t){if(t instanceof fr)return t;if(t!=null&&t.asCID===t){let{version:r,code:n,multihash:i,bytes:s}=t;return new fr(r,n,i,s||ag(r,n,i.bytes))}else if(t!=null&&t[lg]===!0){let{version:r,multihash:n,code:i}=t,s=Qs(n);return fr.create(r,i,s)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(t){case 0:{if(r!==ol)throw new Error(`Version 0 CID must use dag-pb (code: ${ol}) block encoding`);return new fr(t,r,n,n.bytes)}case 1:{let i=ag(t,r,n.bytes);return new fr(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return fr.create(0,ol,t)}static createV1(t,r){return fr.create(1,t,r)}static decode(t){let[r,n]=fr.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=fr.inspectBytes(t),n=r.size-r.multihashSize,i=ss(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),a=new ka(r.multihashCode,r.digestSize,s,i);return[r.version===0?fr.createV0(a):fr.createV1(r.codec,a),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[f,y]=al(t.subarray(r));return r+=y,f},i=n(),s=ol;if(i===18?(i=0,r=0):i===1&&(s=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let a=r,o=n(),l=n(),u=r+l,h=u-a;return{version:i,codec:s,multihashCode:o,digestSize:l,multihashSize:h,size:u}}static parse(t,r){let[n,i]=Z_(t,r),s=fr.decode(i);return s._baseCache.set(n,t),s}},Z_=(e,t)=>{switch(e[0]){case"Q":{let r=t||rn;return[rn.prefix,r.decode(`${rn.prefix}${e}`)]}case rn.prefix:{let r=t||rn;return[rn.prefix,r.decode(e)]}case Bi.prefix:{let r=t||Bi;return[Bi.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},pS=(e,t,r)=>{let{prefix:n}=r;if(n!==rn.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return i},yS=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let s=r.encode(e);return t.set(n,s),s}else return i},ol=112,gS=18,ag=(e,t,r)=>{let n=Ca(e),i=n+Ca(t),s=new Uint8Array(i+r.byteLength);return Ia(e,s,0),Ia(t,s,n),s.set(r,i),s},lg=Symbol.for("@ipld/js-cid/CID"),Vu={writable:!1,configurable:!1,enumerable:!0},Wu={writable:!1,enumerable:!1,configurable:!1},mS="0.0.0-dev",wS=(e,t)=>{if(e.test(mS))console.warn(t);else throw new Error(t)},vS=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var _n=(e,t)=>(t&&t.add(e.multihash.bytes.buffer),e),di=e=>{let t=e;return t._baseCache||Object.defineProperty(t,"_baseCache",{value:new Map}),t.asCID||Object.defineProperty(t,"asCID",{get:()=>t}),Object.setPrototypeOf(t.multihash.digest,Uint8Array.prototype),Object.setPrototypeOf(t.multihash.bytes,Uint8Array.prototype),Object.setPrototypeOf(t.bytes,Uint8Array.prototype),Object.setPrototypeOf(t,fr.prototype),Object.defineProperty(t,Symbol.for("@ipld/js-cid/CID"),{value:!0}),t};fe();var hg=({dagNode:e,cids:t})=>{for(let r of t)di(r);return e},dg=(e,t)=>{let r=[];return C1(e,r,t),{dagNode:e,cids:r}},C1=(e,t,r)=>{if(e!=null&&typeof e=="object"){let n=fr.asCID(e);if(n)t.push(n),_n(n,r);else if(e instanceof ArrayBuffer)r&&r.add(e);else if(ArrayBuffer.isView(e))r&&r.add(e.buffer);else if(Array.isArray(e))for(let i of e)C1(i,t,r);else for(let i of Object.values(e))C1(i,t,r)}};var cl=class{constructor(t){this.ipfs=t}async put(t){let r=hg(t.dagNode),n=await this.ipfs.dag.put(r,t);return _n(n)}async get(t){let{cid:r,path:n,localResolve:i,timeout:s,signal:a}=t,{value:o,remainderPath:l}=await this.ipfs.dag.get(di(r),{path:n,localResolve:i,timeout:s,signal:a}),u=new Set;return{remainderPath:l,value:dg(o,u),transfer:u}}async resolve(t){let{cid:r,remainderPath:n}=await this.ipfs.dag.resolve(bS(t.cid),t);return{cid:_n(r),remainderPath:n}}},bS=e=>typeof e=="string"?e:di(e);fe();fe();fe();var Da=e=>{let{name:t,message:r,stack:n,code:i,detail:s}=e;return{name:t,message:r,stack:n,code:i,detail:s}},pg=e=>{if(e instanceof Error)return e;{let{name:t,message:r,stack:n,code:i}=e;return Object.assign(ES(t,r),{name:t,stack:n,code:i})}},ES=(e,t)=>{switch(e){case"RangeError":return new RangeError(t);case"ReferenceError":return ReferenceError(t);case"SyntaxError":return new SyntaxError(t);case"TypeError":return new TypeError(t);case"URIError":return new URIError(t);default:return new Error(t)}};var Gu=async function*({port:e},t){let r=a=>{},n=()=>new Promise(a=>r=a),i=()=>(e.postMessage({method:"next"}),n());e.onmessage=a=>r(a.data);let s=!1;try{for(;!s;){let{done:a,value:o,error:l}=await i();if(s=a,l!=null)throw pg(l);o!=null&&(yield t(o))}}finally{s||e.postMessage({method:"return"}),e.close()}},th=(e,t,r)=>{let{port1:n,port2:i}=new MessageChannel,s=_S(e),a=new Set;return n.onmessage=async({data:{method:o}})=>{switch(o){case"next":{try{let{done:l,value:u}=await s.next();if(l)n.postMessage({type:"next",done:!0}),n.close();else{a.clear();let h=t(u,a);yg(n,{type:"next",done:!1,value:h},a)}}catch(l){n.postMessage({type:"throw",error:Da(l)}),n.close()}break}case"return":{n.close(),s.return&&s.return();break}default:break}},n.start(),r.add(i),{type:"RemoteIterable",port:i}},_S=e=>{if(e!=null){if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]()}throw TypeError("Value must be async or sync iterable")};var T1=({port:e})=>(r,n)=>{yg(e,r,n)},yg=(e,t,r)=>e.postMessage(t,r);var jl=class{constructor(t){this.ipfs=t}addAll(t){let{input:r}=t,{chunker:n,cidVersion:i,enableShardingExperiment:s,hashAlg:a,onlyHash:o,pin:l,progressCallback:u,rawLeaves:h,shardSplitThreshold:f,trickle:y,wrapWithDirectory:p,timeout:v,signal:d}=t,g;if(u){let m=T1(u);g=(E,D)=>{m([E,D])}}let b={chunker:n,cidVersion:i,enableShardingExperiment:s,hashAlg:a,onlyHash:o,pin:l,rawLeaves:h,shardSplitThreshold:f,trickle:y,wrapWithDirectory:p,timeout:v,progress:g,signal:d},_=SS(r);return RS(this.ipfs.addAll(_,b))}async add(t){let{input:r}=t,{chunker:n,cidVersion:i,hashAlg:s,onlyHash:a,pin:o,progressCallback:l,rawLeaves:u,trickle:h,wrapWithDirectory:f,timeout:y,signal:p}=t,v;if(l){let b=T1(l);v=(_,m)=>{b([_,m])}}let d={chunker:n,cidVersion:i,hashAlg:s,onlyHash:a,pin:o,rawLeaves:u,trickle:h,wrapWithDirectory:f,timeout:y,progress:v,signal:p},g=AS(r);return CS(await this.ipfs.add(g,d))}cat(t){let{path:r,offset:n,length:i,timeout:s,signal:a}=t,o=typeof r=="string"?r:di(r),l=this.ipfs.cat(o,{offset:n,length:i,timeout:s,signal:a});return kS(l)}ls(t){let{path:r,recursive:n,preload:i,timeout:s,signal:a}=t,o=typeof r=="string"?r:di(r),l=this.ipfs.ls(o,{recursive:n,preload:i,timeout:s,signal:a});return TS(l)}},SS=e=>Gu(e,$1),AS=e=>G1(e,t=>t.type==="RemoteIterable"?{content:Gu(t,$1)}:$1(t)),$1=e=>G1(e,t=>({...t,content:t.content&&IS(t.content)})),IS=e=>G1(e,t=>Gu(t,LS)),G1=(e,t)=>typeof e=="string"||e instanceof ArrayBuffer||e instanceof Blob||ArrayBuffer.isView(e)?e:t(e),RS=e=>{let t=new Set;return{data:th(e,gg,t),transfer:t}},CS=e=>{let t=new Set;return{data:gg(e,t),transfer:t}},kS=e=>{let t=new Set;return{data:th(e,NS,t),transfer:t}},TS=e=>{let t=new Set;return{data:th(e,PS,t),transfer:t}},PS=({name:e,path:t,size:r,cid:n,type:i,mode:s,mtime:a})=>({cid:_n(n),type:i,name:e,path:t,mode:s,mtime:a,size:r}),NS=(e,t)=>(t.add(e.buffer),e),gg=(e,t)=>({...e,cid:_n(e.cid)}),LS=e=>e;fe();var zl=class{constructor(t){this.ipfs=t}async stat(t){let r=await this.ipfs.files.stat(t.path,t),n=new Set;return{stat:{...r,cid:_n(r.cid,n)},transfer:n}}};fe();var _g=hn(vg(),1);fe();var Eg=(e,t)=>(t&&t.add(e.buffer),e);var Kl=class{constructor(t){this.ipfs=t}async get(t){let r=di(t.cid),n=await this.ipfs.block.get(r,t),i=new Set;return{transfer:i,block:Eg(n,i)}}async put(t){let r=t.block,n=await this.ipfs.block.put(r,t),i=new Set;return{transfer:i,cid:_n(n,i)}}async rm(t){let r=new Set;return(await(0,_g.default)(this.ipfs.block.rm(t.cids.map(di),t))).map(i=>xS(i,r))}async stat(t){let r=di(t.cid),n=await this.ipfs.block.stat(r,t);return{...n,cid:_n(n.cid)}}},xS=(e,t)=>{let r=_n(e.cid,t);return e.error?{cid:r,error:Da(e.error)}:{cid:r}};fe();var $l=class{constructor(t){this.dag=new cl(t),this.core=new jl(t),this.files=new zl(t),this.block=new Kl(t)}};fe();var ih=class{constructor(t,r,n){this.result=new Promise((i,s)=>{this.succeed=i,this.fail=s,this.namespace=t,this.method=r,this.input=n,this.abortController=new AbortController,this.signal=this.abortController.signal})}abort(){this.abortController.abort(),this.fail(new BS)}},ql=class{constructor(t){this.services=t,this.queries=Object.create(null)}connect(t){t.addEventListener("message",this),t.start()}disconnect(t){t.removeEventListener("message",this),t.close()}handleEvent(t){let r=t.data;switch(r.type){case"query":{this.handleQuery(r.id,new ih(r.namespace,r.method,r.input),t.target);return}case"abort":return this.abort(r.id);default:throw new Y1(t)}}abort(t){let r=this.queries[t];r&&(delete this.queries[t],r.abort())}async handleQuery(t,r,n){if(this.queries[t]=r,await this.run(r),delete this.queries[t],!r.signal.aborted)try{let i=await r.result,s=i.transfer;delete i.transfer,n.postMessage({type:"result",id:t,result:{ok:!0,value:i}},s)}catch(i){n.postMessage({type:"result",id:t,result:{ok:!1,error:Da(i)}})}}run(t){let{services:r}=this,{namespace:n,method:i}=t,s=r[n];if(s)if(typeof s[i]=="function")try{let a=s[i]({...t.input,signal:t.signal});Promise.resolve(a).then(t.succeed,t.fail)}catch(a){t.fail(a)}else t.fail(new RangeError(`Method '${String(i)}' is not found`));else t.fail(new RangeError(`Namespace '${String(n)}' is not found`))}execute(t){let r=new ih(t.namespace,t.method,t.input);return this.run(r),r.result}},Y1=class extends RangeError{constructor(t){super("Unexpected message was received by the server"),this.event=t}get name(){return this.constructor.name}},BS=class extends Error{get name(){return this.constructor.name}};fe();var Sg=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}});fe();fe();fe();var Ji=hn(Og(),1);var X1={};Vn(X1,{base64:()=>Q1,base64pad:()=>iI,base64url:()=>lI,base64urlpad:()=>cI});fe();var Q1=Zr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),iI=Zr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),lI=Zr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),cI=Zr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});Ji.default.formatters.b=e=>e==null?"undefined":rn.baseEncode(e);Ji.default.formatters.t=e=>e==null?"undefined":Bi.baseEncode(e);Ji.default.formatters.m=e=>e==null?"undefined":Q1.baseEncode(e);Ji.default.formatters.p=e=>e==null?"undefined":e.toString();Ji.default.formatters.c=e=>e==null?"undefined":e.toString();Ji.default.formatters.k=e=>e==null?"undefined":e.toString();function fi(e){return Object.assign((0,Ji.default)(e),{error:(0,Ji.default)(`${e}:error`),trace:(0,Ji.default)(`${e}:trace`)})}var c1=hn(os(),1);fe();fe();var Cs=class extends Error{constructor(t,r){super(t??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};fe();function Mg(e){if(e!=null){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}function tf(e,t,r){let n=r??{},i=Mg(e);async function*s(){let a,o=()=>{a?.()};for(t.addEventListener("abort",o);;){let l;try{if(t.aborted){let{abortMessage:h,abortCode:f}=n;throw new Cs(h,f)}let u=new Promise((h,f)=>{a=()=>{let{abortMessage:y,abortCode:p}=n;f(new Cs(y,p))}});l=await Promise.race([u,i.next()]),a=null}catch(u){t.removeEventListener("abort",o);let h=u.type==="aborted"&&t.aborted;if(h&&n.onAbort!=null&&await n.onAbort(e),typeof i.return=="function")try{let f=i.return();f instanceof Promise&&f.catch(y=>{n.onReturnError!=null&&n.onReturnError(y)})}catch(f){n.onReturnError!=null&&n.onReturnError(f)}if(h&&n.returnOnAbort===!0)return;throw u}if(l.done===!0)break;yield l.value}t.removeEventListener("abort",o)}return s()}fe();fe();fe();fe();fe();fe();var Ug="[a-fA-F\\d:]",Ps=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${Ug})|(?<=${Ug})(?=\\s|$))`:"",Ui="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",en="[a-fA-F\\d]{1,4}",ch=`
(?:
(?:${en}:){7}(?:${en}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${en}:){6}(?:${Ui}|:${en}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${en}:){5}(?::${Ui}|(?::${en}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${en}:){4}(?:(?::${en}){0,1}:${Ui}|(?::${en}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${en}:){3}(?:(?::${en}){0,2}:${Ui}|(?::${en}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${en}:){2}(?:(?::${en}){0,3}:${Ui}|(?::${en}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${en}:){1}(?:(?::${en}){0,4}:${Ui}|(?::${en}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${en}){0,5}:${Ui}|(?::${en}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),hI=new RegExp(`(?:^${Ui}$)|(?:^${ch}$)`),dI=new RegExp(`^${Ui}$`),fI=new RegExp(`^${ch}$`),rf=e=>e&&e.exact?hI:new RegExp(`(?:${Ps(e)}${Ui}${Ps(e)})|(?:${Ps(e)}${ch}${Ps(e)})`,"g");rf.v4=e=>e&&e.exact?dI:new RegExp(`${Ps(e)}${Ui}${Ps(e)}`,"g");rf.v6=e=>e&&e.exact?fI:new RegExp(`${Ps(e)}${ch}${Ps(e)}`,"g");var Qh=rf;function Zh(e){return Qh({exact:!0}).test(e)}function y3(e){return Qh.v6({exact:!0}).test(e)}function m3(e){return Qh.v4({exact:!0}).test(e)}fe();fe();fe();var nf={};Vn(nf,{identity:()=>pI});fe();var pI=Ta({prefix:"\0",name:"identity",encode:e=>dy(e),decode:e=>hy(e)});var of={};Vn(of,{base2:()=>gI});fe();var gI=Zr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var hf={};Vn(hf,{base8:()=>mI});fe();var mI=Zr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var pf={};Vn(pf,{base10:()=>vI});fe();var vI=Ss({prefix:"9",name:"base10",alphabet:"0123456789"});var _f={};Vn(_f,{base16:()=>bI,base16upper:()=>AI});fe();var bI=Zr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),AI=Zr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Af={};Vn(Af,{base36:()=>kI,base36upper:()=>TI});fe();var kI=Ss({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),TI=Ss({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Nf={};Vn(Nf,{base256emoji:()=>BI});fe();var T3=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),PI=T3.reduce((e,t,r)=>(e[r]=t,e),[]),NI=T3.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function LI(e){return e.reduce((t,r)=>(t+=PI[r],t),"")}function xI(e){let t=[];for(let r of e){let n=NI[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var BI=Ta({prefix:"\u{1F680}",name:"base256emoji",encode:LI,decode:xI});var Bf={};Vn(Bf,{sha256:()=>Jh,sha512:()=>UI});fe();fe();var Of=({name:e,code:t,encode:r})=>new Lf(e,t,r),Lf=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?bs(this.code,r):r.then(n=>bs(this.code,n))}else throw Error("Unknown type, must be binary type")}};var mm=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Jh=Of({name:"sha2-256",code:18,encode:mm("SHA-256")}),UI=Of({name:"sha2-512",code:19,encode:mm("SHA-512")});var Mf={};Vn(Mf,{identity:()=>rd});fe();var vm=0,FI="identity",Tm=ss,jI=e=>bs(vm,Tm(e)),rd={code:vm,name:FI,encode:Tm,digest:jI};fe();fe();var YO=new TextEncoder,QO=new TextDecoder;fe();var Ya={...nf,...of,...hf,...pf,..._f,...R1,...Af,...I1,...X1,...Nf},tx={...Bf,...Mf};function Um(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var Mm=Um("utf8","u",e=>{let t=new TextDecoder("utf8");return"u"+t.decode(e)},e=>new TextEncoder().encode(e.substring(1))),Uf=Um("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),KI={utf8:Mm,"utf-8":Mm,hex:Ya.base16,latin1:Uf,ascii:Uf,binary:Uf,...Ya},nd=KI;function Jr(e,t="utf8"){let r=nd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}var Fm=m3,$I=y3,Kf=function(e){let t=0,r;if(Fm(e))r=new Uint8Array(t+4),e.split(/\./g).forEach(n=>{r[t++]=parseInt(n,10)&255});else if($I(e)){let n=e.split(":",8),i;for(i=0;i<n.length;i++){let s=Fm(n[i]),a;s&&(a=Kf(n[i]),n[i]=Jr(a.slice(0,2),"base16")),a!=null&&++i<8&&n.splice(i,0,Jr(a.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(i=0;i<n.length&&n[i]!=="";i++);let s=[i,1];for(i=9-n.length;i>0;i--)s.push("0");n.splice.apply(n,s)}for(r=new Uint8Array(t+16),i=0;i<n.length;i++){let s=parseInt(n[i],16);r[t++]=s>>8&255,r[t++]=s&255}}if(r==null)throw Error("Invalid ip address: "+e);return r},zm=function(e,t,r){t=~~t,r=r??e.length-t;let n=[],i="",s=new DataView(e.buffer);if(r===4){for(let a=0;a<r;a++)n.push(e[t+a]);i=n.join(".")}else if(r===16){for(let a=0;a<r;a+=2)n.push(s.getUint16(t+a).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};fe();var Hl={},Hf={},HI=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];HI.forEach(e=>{let t=WI(...e);Hf[t.code]=t,Hl[t.name]=t});function WI(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}function Ur(e){if(typeof e=="number"){if(Hf[e]!=null)return Hf[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(Hl[e]!=null)return Hl[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}var ra=hn(id(),1);fe();function sd(e,t="utf8"){let r=nd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}fe();function cs(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));let r=new Uint8Array(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return r}function l4(e,t){switch(Ur(e).code){case 4:case 41:return HR(t);case 6:case 273:case 33:case 132:return u4(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return XR(t);case 421:return JR(t);case 444:return o4(t);case 445:return o4(t);default:return Jr(t,"base16")}}function c4(e,t){switch(Ur(e).code){case 4:return a4(t);case 41:return a4(t);case 6:case 273:case 33:case 132:return tp(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return QR(t);case 421:return ZR(t);case 444:return eC(t);case 445:return tC(t);default:return sd(t,"base16")}}function a4(e){if(!Zh(e))throw new Error("invalid ip address");return Kf(e)}function HR(e){let t=zm(e,0,e.length);if(t==null||!Zh(t))throw new Error("invalid ip address");return t}function tp(e){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function u4(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function QR(e){let t=sd(e),r=Uint8Array.from(ra.default.encode(t.length));return cs([r,t],r.length+t.length)}function XR(e){let t=ra.default.decode(e);if(e=e.slice(ra.default.decode.bytes),e.length!==t)throw new Error("inconsistent lengths");return Jr(e)}function ZR(e){let t;e[0]==="Q"||e[0]==="1"?t=Qs(rn.decode(`z${e}`)).bytes:t=fr.parse(e).multihash.bytes;let r=Uint8Array.from(ra.default.encode(t.length));return cs([r,t],r.length+t.length)}function JR(e){let t=ra.default.decode(e),r=e.slice(ra.default.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return Jr(r,"base58btc")}function eC(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let r=Bi.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=tp(n);return cs([r,i],r.length+i.length)}function tC(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let r=Bi.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=tp(n);return cs([r,i],r.length+i.length)}function o4(e){let t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=Jr(t,"base32"),i=u4(r);return`${n}:${i}`}var Ja=hn(id(),1);function rC(e){let t=[],r=e.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=Ur(i);if(s.size===0){t.push([i]);continue}if(n++,n>=r.length)throw I4("invalid address: "+e);if(s.path===!0){t.push([i,cp(r.slice(n).join("/"))]);break}t.push([i,r[n]])}return t}function nC(e){let t=[];return e.map(r=>{let n=pd(r);return t.push(n.name),r.length>1&&r[1]!=null&&t.push(r[1]),null}),cp(t.join("/"))}function iC(e){return e.map(t=>{Array.isArray(t)||(t=[t]);let r=pd(t);return t.length>1?[r.code,c4(r.code,t[1])]:[r.code]})}function rp(e){return e.map(t=>{let r=pd(t);return t[1]!=null?[r.code,l4(r.code,t[1])]:[r.code]})}function np(e){return od(cs(e.map(t=>{let r=pd(t),n=Uint8Array.from(Ja.default.encode(r.code));return t.length>1&&t[1]!=null&&(n=cs([n,t[1]])),n})))}function ip(e,t){return e.size>0?e.size/8:e.size===0?0:Ja.default.decode(t)+Ja.default.decode.bytes}function Wl(e){let t=[],r=0;for(;r<e.length;){let n=Ja.default.decode(e,r),i=Ja.default.decode.bytes,s=Ur(n),a=ip(s,e.slice(r+i));if(a===0){t.push([n]),r+=i;continue}let o=e.slice(r+i,r+i+a);if(r+=a+i,r>e.length)throw I4("Invalid address Uint8Array: "+Jr(e,"base16"));t.push([n,o])}return t}function ad(e){let t=Wl(e),r=rp(t);return nC(r)}function sC(e){e=cp(e);let t=rC(e),r=iC(t);return np(r)}function A4(e){return sC(e)}function od(e){let t=aC(e);if(t!=null)throw t;return Uint8Array.from(e)}function aC(e){try{Wl(e)}catch(t){return t}}function cp(e){return"/"+e.trim().split("/").filter(t=>t).join("/")}function I4(e){return new Error("Error parsing address: "+e)}function pd(e){return Ur(e[0])}var Sp=hn(id(),1);var k4=hn(os(),1);fe();function eo(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var cC=Symbol.for("nodejs.util.inspect.custom"),dC=[Ur("ip4").code,Ur("ip6").code],yd=[Ur("dns").code,Ur("dns4").code,Ur("dns6").code,Ur("dnsaddr").code],R4=[Ur("p2p").code,Ur("ipfs").code],IC=[Ur("tcp").code,Ur("udp").code],T4=new Map,C4=Symbol.for("@multiformats/js-multiaddr/multiaddr"),tn=class{constructor(t){if(t==null&&(t=""),Object.defineProperty(this,C4,{value:!0}),t instanceof Uint8Array)this.bytes=od(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);this.bytes=A4(t)}else if(tn.isMultiaddr(t))this.bytes=od(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return ad(this.bytes)}toJSON(){return this.toString()}toOptions(){let t=this.protoCodes(),r=this.toString().split("/").slice(1),n,i;if(r.length>2)yd.includes(t[0])&&R4.includes(t[1])?(n=Ur("tcp").name,i=443):(n=Ur(r[2]).name,i=parseInt(r[3]));else if(yd.includes(t[0]))n=Ur("tcp").name,i=443;else throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t[0]===41||t[0]===55?6:4,host:r[1],transport:n,port:i}}protos(){return this.protoCodes().map(t=>Object.assign({},Ur(t)))}protoCodes(){let t=[],r=this.bytes,n=0;for(;n<r.length;){let i=Sp.default.decode(r,n),s=Sp.default.decode.bytes,a=Ur(i);n+=ip(a,r.slice(n+s))+s,t.push(i)}return t}protoNames(){return this.protos().map(t=>t.name)}tuples(){return Wl(this.bytes)}stringTuples(){let t=Wl(this.bytes);return rp(t)}encapsulate(t){return t=new tn(t),new tn(this.toString()+t.toString())}decapsulate(t){let r=t.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new tn(n.slice(0,i))}decapsulateCode(t){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===t)return new tn(np(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===Hl.ipfs.code).pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?Jr(rn.decode(`z${n}`),"base58btc"):Jr(fr.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let t=null;try{t=this.stringTuples().filter(r=>Ur(r[0]).path===!0)[0][1],t==null&&(t=null)}catch{t=null}return t}equals(t){return eo(this.bytes,t.bytes)}async resolve(t){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=T4.get(r.name);if(n==null)throw(0,k4.default)(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,t)).map(s=>new tn(s))}nodeAddress(){let t=this.protoCodes(),r=this.protoNames(),n=this.toString().split("/").slice(1),i=Ur(n[2]).code,s=parseInt(n[3]);if(yd.includes(t[0])&&R4.includes(t[1])&&(i=Ur("tcp").code,s=443),n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');if(!dC.includes(t[0])&&!yd.includes(t[0]))throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns, dns4, dns6, dnsaddr}".`);if(!IC.includes(i))throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:t[0]===41||t[0]===55?6:4,address:n[1],port:s}}isThinWaistAddress(t){let r=(t??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(t,r){if(t==null)throw new Error("requires node address object");if(r==null)throw new Error("requires transport protocol");let n;switch(t.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new tn("/"+[n,t.address,r,t.port].join("/"))}static isName(t){return tn.isMultiaddr(t)?t.protos().some(r=>r.resolvable):!1}static isMultiaddr(t){return Boolean(t?.[C4])}[cC](){return"<Multiaddr "+Jr(this.bytes,"base16")+" - "+ad(this.bytes)+">"}inspect(){return"<Multiaddr "+Jr(this.bytes,"base16")+" - "+ad(this.bytes)+">"}};tn.resolvers=T4;fe();var kC=jt("dns4"),TC=jt("dns6"),DC=jt("dnsaddr"),Lo=dn(jt("dns"),DC,kC,TC),md=dn(jt("ip4"),jt("ip6")),fc=dn(Yt(md,jt("tcp")),Yt(Lo,jt("tcp"))),P4=Yt(md,jt("udp")),LC=Yt(P4,jt("utp")),OC=Yt(P4,jt("quic")),Yl=dn(Yt(fc,jt("ws")),Yt(Lo,jt("ws"))),cc=dn(Yt(fc,jt("wss")),Yt(Lo,jt("wss"))),Ip=dn(Yt(fc,jt("http")),Yt(md,jt("http")),Yt(Lo,jt("http"))),Rp=dn(Yt(fc,jt("https")),Yt(md,jt("https")),Yt(Lo,jt("https"))),Id=dn(Yt(Yl,jt("p2p-webrtc-star"),jt("p2p")),Yt(cc,jt("p2p-webrtc-star"),jt("p2p")),Yt(Yl,jt("p2p-webrtc-star")),Yt(cc,jt("p2p-webrtc-star"))),wM=dn(Yt(Yl,jt("p2p-websocket-star"),jt("p2p")),Yt(cc,jt("p2p-websocket-star"),jt("p2p")),Yt(Yl,jt("p2p-websocket-star")),Yt(cc,jt("p2p-websocket-star"))),L4=dn(Yt(Ip,jt("p2p-webrtc-direct"),jt("p2p")),Yt(Rp,jt("p2p-webrtc-direct"),jt("p2p")),Yt(Ip,jt("p2p-webrtc-direct")),Yt(Rp,jt("p2p-webrtc-direct"))),hc=dn(Yl,cc,Ip,Rp,Id,L4,fc,LC,OC,Lo),bM=dn(Yt(hc,jt("p2p-stardust"),jt("p2p")),Yt(hc,jt("p2p-stardust"))),Bs=dn(Yt(hc,jt("p2p")),Id,L4,jt("p2p")),D4=dn(Yt(Bs,jt("p2p-circuit"),Bs),Yt(Bs,jt("p2p-circuit")),Yt(jt("p2p-circuit"),Bs),Yt(hc,jt("p2p-circuit")),Yt(jt("p2p-circuit"),hc),jt("p2p-circuit")),O4=()=>dn(Yt(D4,O4),D4),Gl=O4(),EM=dn(Yt(Gl,Bs,Gl),Yt(Bs,Gl),Yt(Gl,Bs),Gl,Bs);function x4(e){function t(r){let n;try{n=new tn(r)}catch{return!1}let i=e(n.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return t}function Yt(...e){function t(r){if(r.length<e.length)return null;let n=r;return e.some(i=>(n=typeof i=="function"?i().partialMatch(r):i.partialMatch(r),Array.isArray(n)&&(r=n),n===null)),n}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:x4(t),partialMatch:t}}function dn(...e){function t(n){let i=null;return e.some(s=>{let a=typeof s=="function"?s().partialMatch(n):s.partialMatch(n);return a!=null?(i=a,!0):!1}),i}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:x4(t),partialMatch:t}}function jt(e){let t=e;function r(i){let s;try{s=new tn(i)}catch{return!1}let a=s.protoNames();return a.length===1&&a[0]===t}function n(i){return i.length===0?null:i[0]===t?i.slice(1):null}return{toString:function(){return t},matches:r,partialMatch:n}}fe();fe();var J8=hn(os(),1);fe();fe();fe();fe();fe();fe();fe();fe();fe();fe();var zi=Object.create(null);zi.open="0";zi.close="1";zi.ping="2";zi.pong="3";zi.message="4";zi.upgrade="5";zi.noop="6";var pc=Object.create(null);Object.keys(zi).forEach(e=>{pc[zi[e]]=e});var B4={type:"error",data:"parser error"};var UC=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",FC=typeof ArrayBuffer=="function",jC=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,zC=({type:e,data:t},r,n)=>UC&&t instanceof Blob?r?n(t):M4(t,n):FC&&(t instanceof ArrayBuffer||jC(t))?r?n(t):M4(new Blob([t]),n):n(zi[e]+(t||"")),M4=(e,t)=>{let r=new FileReader;return r.onload=function(){let n=r.result.split(",")[1];t("b"+n)},r.readAsDataURL(e)},Cd=zC;fe();fe();var F4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yc=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<F4.length;e++)yc[F4.charCodeAt(e)]=e;var lw=e=>{let t=e.length*.75,r=e.length,n,i=0,s,a,o,l;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);let u=new ArrayBuffer(t),h=new Uint8Array(u);for(n=0;n<r;n+=4)s=yc[e.charCodeAt(n)],a=yc[e.charCodeAt(n+1)],o=yc[e.charCodeAt(n+2)],l=yc[e.charCodeAt(n+3)],h[i++]=s<<2|a>>4,h[i++]=(a&15)<<4|o>>2,h[i++]=(o&3)<<6|l&63;return u};var VC=typeof ArrayBuffer=="function",KC=(e,t)=>{if(typeof e!="string")return{type:"message",data:cw(e,t)};let r=e.charAt(0);return r==="b"?{type:"message",data:$C(e.substring(1),t)}:pc[r]?e.length>1?{type:pc[r],data:e.substring(1)}:{type:pc[r]}:B4},$C=(e,t)=>{if(VC){let r=lw(e);return cw(r,t)}else return{base64:!0,data:e}},cw=(e,t)=>{switch(t){case"blob":return e instanceof ArrayBuffer?new Blob([e]):e;case"arraybuffer":default:return e}},qd=KC;var hw=String.fromCharCode(30),dw=(e,t)=>{let r=e.length,n=new Array(r),i=0;e.forEach((s,a)=>{Cd(s,!1,o=>{n[a]=o,++i===r&&t(n.join(hw))})})},fw=(e,t)=>{let r=e.split(hw),n=[];for(let i=0;i<r.length;i++){let s=qd(r[i],t);if(n.push(s),s.type==="error")break}return n},Cp=4;fe();function Yr(e){if(e)return qC(e)}function qC(e){for(var t in Yr.prototype)e[t]=Yr.prototype[t];return e}Yr.prototype.on=Yr.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Yr.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};Yr.prototype.off=Yr.prototype.removeListener=Yr.prototype.removeAllListeners=Yr.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===t||n.fn===t){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+e],this};Yr.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,t)}return this};Yr.prototype.emitReserved=Yr.prototype.emit;Yr.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Yr.prototype.hasListeners=function(e){return!!this.listeners(e).length};fe();fe();var bi=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function Yd(e,...t){return t.reduce((r,n)=>(e.hasOwnProperty(n)&&(r[n]=e[n]),r),{})}var HC=setTimeout,GC=clearTimeout;function us(e,t){t.useNativeTimers?(e.setTimeoutFn=HC.bind(bi),e.clearTimeoutFn=GC.bind(bi)):(e.setTimeoutFn=setTimeout.bind(bi),e.clearTimeoutFn=clearTimeout.bind(bi))}var hk=1.33;function pw(e){return typeof e=="string"?dk(e):Math.ceil((e.byteLength||e.size)*hk)}function dk(e){let t=0,r=0;for(let n=0,i=e.length;n<i;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}var kp=class extends Error{constructor(t,r,n){super(t),this.description=r,this.context=n,this.type="TransportError"}},ca=class extends Yr{constructor(t){super(),this.writable=!1,us(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,r,n){return super.emitReserved("error",new kp(t,r,n)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){let r=qd(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}};fe();var _w="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Tp=64,pk={},yw=0,Qd=0,gw;function Ew(e){let t="";do t=_w[e%Tp]+t,e=Math.floor(e/Tp);while(e>0);return t}function Xd(){let e=Ew(+new Date);return e!==gw?(yw=0,gw=e):e+"."+Ew(yw++)}for(;Qd<Tp;Qd++)pk[_w[Qd]]=Qd;fe();function Zd(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function Rw(e){let t={},r=e.split("&");for(let n=0,i=r.length;n<i;n++){let s=r[n].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}fe();fe();var Nw=!1;try{Nw=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var zw=Nw;function Dp(e){let t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||zw))return new XMLHttpRequest}catch{}if(!t)try{return new bi[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function mk(){}var Ek=function(){return new Dp({xdomain:!1}).responseType!=null}(),Jd=class extends ca{constructor(t){if(super(t),this.polling=!1,typeof location<"u"){let n=location.protocol==="https:",i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port,this.xs=t.secure!==n}let r=t&&t.forceBase64;this.supportsBinary=Ek&&!r}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";let r=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let n=0;this.polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){let r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};fw(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,dw(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.query||{},r=this.opts.secure?"https":"http",n="";this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Xd()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.opts.port&&(r==="https"&&Number(this.opts.port)!==443||r==="http"&&Number(this.opts.port)!==80)&&(n=":"+this.opts.port);let i=Zd(t),s=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new Si(this.uri(),t)}doWrite(t,r){let n=this.request({method:"POST",data:t});n.on("success",r),n.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){let t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=t}},Si=class extends Yr{constructor(t,r){super(),us(this,r),this.opts=r,this.method=r.method||"GET",this.uri=t,this.async=r.async!==!1,this.data=r.data!==void 0?r.data:null,this.create()}create(){let t=Yd(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;let r=this.xhr=new Dp(t);try{r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let n in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(n)&&r.setRequestHeader(n,this.opts.extraHeaders[n])}}catch{}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},r.send(this.data)}catch(n){this.setTimeoutFn(()=>{this.onError(n)},0);return}typeof document<"u"&&(this.index=Si.requestsCount++,Si.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=mk,t)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Si.requests[this.index],this.xhr=null}}onLoad(){let t=this.xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};Si.requestsCount=0;Si.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",$w);else if(typeof addEventListener=="function"){let e="onpagehide"in bi?"pagehide":"unload";addEventListener(e,$w,!1)}}function $w(){for(let e in Si.requests)Si.requests.hasOwnProperty(e)&&Si.requests[e].abort()}fe();fe();var qw=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0))(),mc=bi.WebSocket||bi.MozWebSocket,e1=!0,Hw="arraybuffer";var Ww=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",t1=class extends ca{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let t=this.uri(),r=this.opts.protocols,n=Ww?{}:Yd(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=e1&&!Ww?r?new mc(t,r):new mc(t):new mc(t,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType||Hw,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){let n=t[r],i=r===t.length-1;Cd(n,this.supportsBinary,s=>{let a={};e1||(n.options&&(a.compress=n.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(a.compress=!1));try{e1?this.ws.send(s):this.ws.send(s,a)}catch{}i&&qw(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{},r=this.opts.secure?"wss":"ws",n="";this.opts.port&&(r==="wss"&&Number(this.opts.port)!==443||r==="ws"&&Number(this.opts.port)!==80)&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=Xd()),this.supportsBinary||(t.b64=1);let i=Zd(t),s=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}check(){return!!mc}};var Pp={websocket:t1,polling:Jd};fe();var kk=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Nk=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Mo(e){let t=e,r=e.indexOf("["),n=e.indexOf("]");r!=-1&&n!=-1&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let i=kk.exec(e||""),s={},a=14;for(;a--;)s[Nk[a]]=i[a]||"";return r!=-1&&n!=-1&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=jk(s,s.path),s.queryKey=$k(s,s.query),s}function jk(e,t){let r=/\/{2,9}/g,n=t.replace(r,"/").split("/");return(t.substr(0,1)=="/"||t.length===0)&&n.splice(0,1),t.substr(t.length-1,1)=="/"&&n.splice(n.length-1,1),n}function $k(e,t){let r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,s){i&&(r[i]=s)}),r}var ii=class extends Yr{constructor(t,r={}){super(),t&&typeof t=="object"&&(r=t,t=null),t?(t=Mo(t),r.hostname=t.host,r.secure=t.protocol==="https"||t.protocol==="wss",r.port=t.port,t.query&&(r.query=t.query)):r.host&&(r.hostname=Mo(r.host).host),us(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=r.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},r),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=Rw(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){let r=Object.assign({},this.opts.query);r.EIO=Cp,r.transport=t,this.id&&(r.sid=this.id);let n=Object.assign({},this.opts.transportOptions[t],this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Pp[t](n)}open(){let t;if(this.opts.rememberUpgrade&&ii.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch{this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",r=>this.onClose("transport close",r))}probe(t){let r=this.createTransport(t),n=!1;ii.priorWebsocketSuccess=!1;let i=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",f=>{if(!n)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;ii.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{let y=new Error("probe error");y.transport=r.name,this.emitReserved("upgradeError",y)}}))};function s(){n||(n=!0,h(),r.close(),r=null)}let a=f=>{let y=new Error("probe error: "+f);y.transport=r.name,s(),this.emitReserved("upgradeError",y)};function o(){a("transport closed")}function l(){a("socket closed")}function u(f){r&&f.name!==r.name&&s()}let h=()=>{r.removeListener("open",i),r.removeListener("error",a),r.removeListener("close",o),this.off("close",l),this.off("upgrading",u)};r.once("open",i),r.once("error",a),r.once("close",o),this.once("close",l),this.once("upgrading",u),r.open()}onOpen(){if(this.readyState="open",ii.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let t=0,r=this.upgrades.length;for(;t<r;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let r=new Error("server error");r.code=t.data,this.onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){let i=this.writeBuffer[n].data;if(i&&(r+=pw(i)),n>0&&r>this.maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}write(t,r,n){return this.sendPacket("message",t,r,n),this}send(t,r,n){return this.sendPacket("message",t,r,n),this}sendPacket(t,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;let s={type:t,data:r,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){let t=()=>{this.onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}onError(t){ii.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){let r=[],n=0,i=t.length;for(;n<i;n++)~this.transports.indexOf(t[n])&&r.push(t[n]);return r}};ii.protocol=Cp;var BU=ii.protocol;function Gw(e,t="",r){let n=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),n=Mo(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let s=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+t,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}fe();fe();var Gp={};Vn(Gp,{Decoder:()=>Dc,Encoder:()=>Kp,PacketType:()=>or,protocol:()=>Jw});fe();fe();fe();var Hk=typeof ArrayBuffer=="function",Wk=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Yw=Object.prototype.toString,Gk=typeof Blob=="function"||typeof Blob<"u"&&Yw.call(Blob)==="[object BlobConstructor]",Yk=typeof File=="function"||typeof File<"u"&&Yw.call(File)==="[object FileConstructor]";function kc(e){return Hk&&(e instanceof ArrayBuffer||Wk(e))||Gk&&e instanceof Blob||Yk&&e instanceof File}function Cc(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,n=e.length;r<n;r++)if(Cc(e[r]))return!0;return!1}if(kc(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Cc(e.toJSON(),!0);for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&Cc(e[r]))return!0;return!1}function Qw(e){let t=[],r=e.data,n=e;return n.data=Np(r,t),n.attachments=t.length,{packet:n,buffers:t}}function Np(e,t){if(!e)return e;if(kc(e)){let r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){let r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=Np(e[n],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){let r={};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=Np(e[n],t));return r}return e}function Xw(e,t){return e.data=Op(e.data,t),e.attachments=void 0,e}function Op(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=Op(e[r],t);else if(typeof e=="object")for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Op(e[r],t));return e}var Jw=5,or;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(or||(or={}));var Kp=class{constructor(t){this.replacer=t}encode(t){return(t.type===or.EVENT||t.type===or.ACK)&&Cc(t)?(t.type=t.type===or.EVENT?or.BINARY_EVENT:or.BINARY_ACK,this.encodeAsBinary(t)):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===or.BINARY_EVENT||t.type===or.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){let r=Qw(t),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}},Dc=class extends Yr{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t),r.type===or.BINARY_EVENT||r.type===or.BINARY_ACK?(this.reconstructor=new Wp(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(kc(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0,n={type:Number(t.charAt(0))};if(or[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===or.BINARY_EVENT||n.type===or.BINARY_ACK){let s=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);let a=t.substring(s,r);if(a!=Number(a)||t.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(a)}if(t.charAt(r+1)==="/"){let s=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););n.nsp=t.substring(s,r)}else n.nsp="/";let i=t.charAt(r+1);if(i!==""&&Number(i)==i){let s=r+1;for(;++r;){let a=t.charAt(r);if(a==null||Number(a)!=a){--r;break}if(r===t.length)break}n.id=Number(t.substring(s,r+1))}if(t.charAt(++r)){let s=this.tryParse(t.substr(r));if(Dc.isPayloadValid(n.type,s))n.data=s;else throw new Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case or.CONNECT:return typeof r=="object";case or.DISCONNECT:return r===void 0;case or.CONNECT_ERROR:return typeof r=="string"||typeof r=="object";case or.EVENT:case or.BINARY_EVENT:return Array.isArray(r)&&r.length>0;case or.ACK:case or.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}},Wp=class{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){let r=Xw(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};fe();function ci(e,t,r){return e.on(t,r),function(){e.off(t,r)}}var Qk=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Fo=class extends Yr{constructor(t,r,n){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let t=this.io;this.subs=[ci(t,"open",this.onopen.bind(this)),ci(t,"packet",this.onpacket.bind(this)),ci(t,"error",this.onerror.bind(this)),ci(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){if(Qk.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');r.unshift(t);let n={type:or.EVENT,data:r};if(n.options={},n.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){let a=this.ids++,o=r.pop();this._registerAckCallback(a,o),n.id=a}let i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(t,r){let n=this.flags.timeout;if(n===void 0){this.acks[t]=r;return}let i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===t&&this.sendBuffer.splice(s,1);r.call(this,new Error("operation has timed out"))},n);this.acks[t]=(...s)=>{this.io.clearTimeoutFn(i),r.apply(this,[null,...s])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this.packet({type:or.CONNECT,data:t})}):this.packet({type:or.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case or.CONNECT:if(t.data&&t.data.sid){let i=t.data.sid;this.onconnect(i)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case or.EVENT:case or.BINARY_EVENT:this.onevent(t);break;case or.ACK:case or.BINARY_ACK:this.onack(t);break;case or.DISCONNECT:this.ondisconnect();break;case or.CONNECT_ERROR:this.destroy();let n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){let r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){let r=this._anyListeners.slice();for(let n of r)n.apply(this,t)}super.emit.apply(this,t)}ack(t){let r=this,n=!1;return function(...i){n||(n=!0,r.packet({type:or.ACK,id:t,data:i}))}}onack(t){let r=this.acks[t.id];typeof r=="function"&&(r.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:or.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){let r=this._anyListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){let r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let r=this._anyOutgoingListeners.slice();for(let n of r)n.apply(this,t.data)}}};fe();function ha(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}ha.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=(Math.floor(t*10)&1)==0?e-r:e+r}return Math.min(e,this.max)|0};ha.prototype.reset=function(){this.attempts=0};ha.prototype.setMin=function(e){this.ms=e};ha.prototype.setMax=function(e){this.max=e};ha.prototype.setJitter=function(e){this.jitter=e};var jo=class extends Yr{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,us(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new ha({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;let i=r.parser||Gp;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new ii(this.uri,this.opts);let r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;let i=ci(r,"open",function(){n.onopen(),t&&t()}),s=ci(r,"error",a=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",a),t?t(a):n.maybeReconnectOnOpen()});if(this._timeout!==!1){let a=this._timeout;a===0&&i();let o=this.setTimeoutFn(()=>{i(),r.close(),r.emit("error",new Error("timeout"))},a);this.opts.autoUnref&&o.unref(),this.subs.push(function(){clearTimeout(o)})}return this.subs.push(i),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let t=this.engine;this.subs.push(ci(t,"ping",this.onping.bind(this)),ci(t,"data",this.ondata.bind(this)),ci(t,"error",this.onerror.bind(this)),ci(t,"close",this.onclose.bind(this)),ci(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,r){let n=this.nsps[t];return n||(n=new Fo(this,t,r),this.nsps[t]=n),n}_destroy(t){let r=Object.keys(this.nsps);for(let n of r)if(this.nsps[n].active)return;this._close()}_packet(t){let r=this.encoder.encode(t);for(let n=0;n<r.length;n++)this.engine.write(r[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,r){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let r=this.backoff.duration();this._reconnecting=!0;let n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(function(){clearTimeout(n)})}}onreconnect(){let t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}};var Nc={};function Qc(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};let r=Gw(e,t.path||"/socket.io"),n=r.source,i=r.id,s=r.path,a=Nc[i]&&s in Nc[i].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||a,l;return o?l=new jo(n,t):(Nc[i]||(Nc[i]=new jo(n,t)),l=Nc[i]),r.query&&!t.query&&(t.query=r.queryKey),l.socket(r.path,t)}Object.assign(Qc,{Manager:jo,Socket:Fo,io:Qc,connect:Qc});fe();function Ms(){let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}fe();fe();fe();fe();var da=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},ms,Ki=class extends EventTarget{constructor(){super(...arguments),ms.set(this,new Map)}listenerCount(t){let r=da(this,ms,"f").get(t);return r==null?0:r.length}addEventListener(t,r,n){super.addEventListener(t,r,n);let i=da(this,ms,"f").get(t);i==null&&(i=[],da(this,ms,"f").set(t,i)),i.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(t,r,n){super.removeEventListener(t.toString(),r??null,n);let i=da(this,ms,"f").get(t);i!=null&&(i=i.filter(({callback:s})=>s!==r),da(this,ms,"f").set(t,i))}dispatchEvent(t){let r=super.dispatchEvent(t),n=da(this,ms,"f").get(t.type);return n==null||(n=n.filter(({once:i})=>!i),da(this,ms,"f").set(t.type,n)),r}};ms=new WeakMap;var Yp=class extends Event{constructor(t,r){super(t,r),this.detail=r?.detail}},Qr=globalThis.CustomEvent??Yp;var Xc=hn(os(),1),L8=hn(r1(),1);fe();fe();var n1=class{constructor(t){if(!(t>0)||(t-1&t)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){let t=this.buffer[this.btm];if(t!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return this.buffer[this.btm]===void 0}},qo=class{constructor(t){this.hwm=t??16,this.head=new n1(this.hwm),this.tail=this.head}push(t){if(!this.head.push(t)){let r=this.head;this.head=r.next=new n1(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(t===void 0&&this.tail.next!=null){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return t}isEmpty(){return this.head.isEmpty()}};function t5(e){return Zk(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},e)}function Zk(e,t){t=t??{};let r=t.onEnd,n=new qo,i,s,a,o=async()=>n.isEmpty()?a?{done:!0}:await new Promise((d,g)=>{s=b=>{s=null,n.push(b);try{d(e(n))}catch(_){g(_)}return i}}):e(n),l=d=>s!=null?s(d):(n.push(d),i),u=d=>(n=new qo,s!=null?s({error:d}):(n.push({error:d}),i)),h=d=>a?i:l({done:!1,value:d}),f=d=>a?i:(a=!0,d!=null?u(d):l({done:!0})),y=()=>(n=new qo,f(),{done:!0}),p=d=>(f(d),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:y,throw:p,push:h,end:f},r==null)return i;let v=i;return i={[Symbol.asyncIterator](){return this},next(){return v.next()},throw(d){return v.throw(d),r!=null&&(r(d),r=void 0),{done:!0}},return(){return v.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(d){return v.end(d),r!=null&&(r(d),r=void 0),i}},i}fe();var p5=hn(os(),1);var r5=64*1024,Jk=5*1e3,i1=class{constructor(t,r){this.label=t.label,this.open=Ms(),this.channel=t,this.channel.binaryType="arraybuffer",this.log=r.log,typeof this.channel.bufferedAmountLowThreshold=="number"&&(this.channel.bufferedAmountLowThreshold=r5),t.addEventListener("message",i=>{r.onMessage(i)}),t.addEventListener("bufferedamountlow",()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()}),t.addEventListener("open",()=>{this.open.resolve(),r.onOpen()}),t.addEventListener("close",()=>{r.onClose()}),t.addEventListener("error",i=>{if(i.error?.message==="Transport channel closed")return this.close();r.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',t.readyState,i.error?.message,i.error?.errorDetail);let s=i.error instanceof Error?i.error:new Error(`datachannel error: ${i.error?.message} ${i.error?.errorDetail}`);r.onError((0,p5.default)(s,"ERR_DATA_CHANNEL"))});let n=!1;this.closingInterval=setInterval(()=>{t.readyState==="closing"?(n&&r.onClose(),n=!0):n=!1},Jk)}async send(t){await this.open.promise,this.channel.send(t),this.channel.bufferedAmount>r5&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=Ms())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}};var O8=hn(b0(),1),FT={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};function zT(){if(typeof globalThis>"u")throw(0,Xc.default)(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");let e={RTCPeerConnection:globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection??globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription??globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate??globalThis.webkitRTCIceCandidate};if(e.RTCPeerConnection==null)throw(0,Xc.default)(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return e}var fa=class extends Ki{constructor(t){super(),this.id=t.id??Jr((0,L8.default)(4),"hex").slice(0,7),this.log=fi(`libp2p:webrtc-peer:${t.logPrefix}:${this.id}`),this.wrtc=t.wrtc??zT(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},FT,t.peerConnectionConfig)),this.closed=!1,this.connected=Ms(),this.source=t5(),this.sink=async r=>{if(await this.connected.promise,this.channel==null)throw(0,Xc.default)(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(let n of r)await this.channel.send(n);await this.close()}}handleDataChannelEvent(t){let r=t.channel;if(r==null){this.close((0,Xc.default)(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch(n=>{this.log("Error closing after event channel was found to be null",n)});return}this.channel=new i1(r,{log:this.log,onMessage:n=>{this.source.push(new Uint8Array(n.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new Qr("ready"))},onClose:()=>{this.close().catch(n=>{this.log("error closing connection after channel close",n)})},onError:n=>{this.close(n).catch(i=>{this.log("error closing connection after channel error",i)})}})}async close(t){if(this.closed=!0,t==null&&this.channel!=null)for(;this.channel.bufferedAmount>0;)await(0,O8.default)(100);this.channel?.close(),this.peerConnection.close(),this.source.end(t),this.dispatchEvent(new Qr("close"))}};fe();var j8=hn(os(),1),Ho=class extends Ki{constructor(t){super(),this.log=t.log,this.peerConnection=t.peerConnection,this.wrtc=t.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch(r=>{this.log.error("could not renegotiate %o",r)})})}async handleSignal(t){if(this.log('incoming signal "%s"',t.type),t.type==="offer")return await this.handleOffer(t);if(t.type==="answer")return await this.handleAnswer(t);if(t.type==="candidate")return await this.handleCandidate(t);if(t.type==="renegotiate")return await this.handleRenegotiate(t);if(t.type==="goodbye")return await this.handleGoodye(t);this.log(`Unknown signal type ${t.type}`)}async handleOffer(t){}async handleAnswer(t){}async handleRenegotiate(t){}async handleGoodye(t){this.peerConnection.close()}async handleCandidate(t){let r=new this.wrtc.RTCIceCandidate(t.candidate);try{await this.peerConnection.addIceCandidate(r)}catch(n){if(r.address==null||r.address.endsWith(".local"))this.log("ignoring unsupported ICE candidate.");else throw(0,j8.default)(n,"ERR_ADD_ICE_CANDIDATE")}}};var z8=fi("libp2p:webrtc-peer:receiver"),Jc=class extends fa{constructor(t={}){super({...t,logPrefix:"receiver"}),this.handshake=new i2({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:t.answerOptions}),this.handshake.addEventListener("signal",r=>this.dispatchEvent(new Qr("signal",{detail:r.detail}))),this.peerConnection.addEventListener("datachannel",r=>{this.handleDataChannelEvent(r)})}handleSignal(t){this.handshake.handleSignal(t).catch(r=>{this.log("error handling signal %o %o",t,r)})}},i2=class extends Ho{constructor(t){super(t),this.options=t,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){z8.trace("renegotiate"),this.dispatchEvent(new Qr("signal",{detail:{type:"renegotiate"}}))}async handleOffer(t){await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(t));for(let n of this.iceCandidates)await this.handleCandidate(n);this.iceCandidates=[];let r=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription(r),z8.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new Qr("signal",{detail:this.peerConnection.localDescription??r}))}async handleCandidate(t){if(this.peerConnection.remoteDescription==null||this.peerConnection.remoteDescription.type==null){this.iceCandidates.push(t);return}await super.handleCandidate(t)}};fe();var H8=hn(r1(),1);fe();fe();var s1=class extends Error{constructor(t){super(t),this.name="TimeoutError"}},a2=class extends Error{constructor(t){super(),this.name="AbortError",this.message=t}},V8=e=>globalThis.DOMException===void 0?new a2(e):new DOMException(e),K8=e=>{let t=e.reason===void 0?V8("This operation was aborted."):e.reason;return t instanceof Error?t:V8(t)};function l2(e,t,r,n){let i,s=new Promise((a,o)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){a(e);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:l}=n;l.aborted&&o(K8(l)),l.addEventListener("abort",()=>{o(K8(l))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{a(r())}catch(h){o(h)}return}let l=typeof r=="string"?r:`Promise timed out after ${t} milliseconds`,u=r instanceof Error?r:new s1(l);typeof e.cancel=="function"&&e.cancel(),o(u)},t),(async()=>{try{a(await e)}catch(l){o(l)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return s.clear=()=>{clearTimeout(i),i=void 0},s}var VT=e=>{let t=e.on||e.addListener||e.addEventListener,r=e.off||e.removeListener||e.removeEventListener;if(!t||!r)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:r.bind(e)}};function KT(e,t,r){let n,i=new Promise((s,a)=>{if(r={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...r},!(r.count>=0&&(r.count===Number.POSITIVE_INFINITY||Number.isInteger(r.count))))throw new TypeError("The `count` option should be at least 0 or more");let o=[t].flat(),l=[],{addListener:u,removeListener:h}=VT(e),f=(...p)=>{let v=r.multiArgs?p:p[0];r.filter&&!r.filter(v)||(l.push(v),r.count===l.length&&(n(),s(l)))},y=p=>{n(),a(p)};n=()=>{for(let p of o)h(p,f);for(let p of r.rejectionEvents)h(p,y)};for(let p of o)u(p,f);for(let p of r.rejectionEvents)u(p,y);r.resolveImmediately&&s(l)});if(i.cancel=n,typeof r.timeout=="number"){let s=l2(i,r.timeout);return s.cancel=n,s}return i}function $8(e,t,r){typeof r=="function"&&(r={filter:r}),r={...r,count:1,resolveImmediately:!1};let n=KT(e,t,r),i=n.then(s=>s[0]);return i.cancel=n.cancel,i}var W8=hn(b0(),1);var c2=fi("libp2p:webrtc-peer:initator"),qT=1e3,eu=class extends fa{constructor(t={}){super({...t,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(t.dataChannelLabel??Jr((0,H8.default)(20),"hex").slice(0,7),t.dataChannelInit)}),this.handshake=new u2({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:t.offerOptions}),this.handshake.addEventListener("signal",r=>{this.dispatchEvent(new Qr("signal",{detail:r.detail}))})}handleSignal(t){this.handshake.handleSignal(t).catch(r=>{this.log("error handling signal %o %o",t,r)})}},u2=class extends Ho{constructor(t){super(t),this.options=t,this.status="idle",this.peerConnection.addEventListener("icecandidate",r=>{if(r.candidate==null)return;let n={type:"candidate",candidate:{candidate:r.candidate.candidate,sdpMLineIndex:r.candidate.sdpMLineIndex,sdpMid:r.candidate.sdpMid}};c2.trace("create candidate",n),this.dispatchEvent(new Qr("signal",{detail:n})),this.dispatchEvent(new Qr("ice-candidate"))})}async handleRenegotiate(){if(this.status==="negotiating"){this.log("already negotiating, queueing");return}this.status="negotiating";let t=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(t),await $8(this,"ice-candidate"),await(0,W8.default)(qT),c2.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new Qr("signal",{detail:this.peerConnection.localDescription??t}))}async handleAnswer(t){c2.trace("handle answer",t),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(t)),this.status="idle"}};fe();var h2=fi("libp2p:webrtc-star:socket");function a1(e,t){let{sink:r,source:n}=e,i={remoteAddr:t.remoteAddr,async sink(s){t.signal!=null&&(s=tf(s,t.signal));try{await r(s)}catch(a){a.type!=="aborted"&&h2.error(a)}},source:t.signal!=null?tf(n,t.signal):n,timeline:{open:Date.now()},async close(){if(e.closed)return;let s=Date.now(),a=setTimeout(()=>{if(i.remoteAddr!=null){let{host:o,port:l}=i.remoteAddr.toOptions();h2("timeout closing socket to %s:%s after %dms, destroying it manually",o,l,Date.now()-s)}e.closed||e.close().catch(o=>{h2.error("could not close socket",o)})},2e3);try{await e.close()}finally{clearTimeout(a)}}};return e.addEventListener("close",()=>{i.timeline.close==null&&(i.timeline.close=Date.now())},{once:!0}),i}fe();function o1(e){let t=e.toString().split("/"),r=e.protos()[1].name,n=e.protos()[2].name,i=e.stringTuples()[1][1];if(r!=="tcp"||n!=="ws"&&n!=="wss")throw new Error(`invalid multiaddr: ${e.toString()}`);if(!tn.isName(e))return`http://${t[2]}:${t[4]}`;if(n==="ws")return`http://${t[2]}${i==null||i==="80"?"":`:${i}`}`;if(n==="wss")return`https://${t[2]}${i==null||i==="443"?"":`:${i}`}`;throw new Error("invalid multiaddr: "+e.toString())}function G8(e){let t="/libp2p-webrtc-star";if(e.startsWith(t)){e=e.substring(t.length,e.length);let r=new tn(e),n=r.stringTuples().filter(i=>i[0]===421)[0];if(n[1]==null)throw new Error("invalid multiaddr: "+e);r=r.decapsulate("p2p"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/p2p/${n[1]}`),e=r.toString()}return e}var gn=fi("libp2p:webrtc-star:listener"),YT={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"},d2=class extends Ki{constructor(t,r,n,i,s){super(),this.signallingAddr=r,this.socket=Qc(t,YT),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=n,this.handler=i,this.channelOptions=s,this.handleWsHandshake=this.handleWsHandshake.bind(this),this.socket.once("connect_error",a=>{this.dispatchEvent(new Qr("error",{detail:a}))}),this.socket.once("error",a=>{this.dispatchEvent(new Qr("error",{detail:a}))}),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",a=>{this.dispatchEvent(new Qr("peer",{detail:a}))}),this.socket.on("connect",()=>this.socket.emit("ss-join",r.toString())),this.socket.once("connect",()=>{this.dispatchEvent(new Qr("listening"))})}_createChannel(t,r,n){let i={...this.channelOptions},s=new Jc(i),a=o=>{let l=o.detail;gn.error("incoming connection errored",l)};return s.addEventListener("error",a),s.addEventListener("close",()=>{s.removeEventListener("error",a)},{once:!0}),s.addEventListener("signal",o=>{let l=o.detail;this.socket.emit("ss-handshake",{intentId:t,srcMultiaddr:r,dstMultiaddr:n,answer:!0,signal:l})}),s.addEventListener("ready",()=>{let o=a1(s,{remoteAddr:this.signallingAddr});gn("new inbound connection %s",o.remoteAddr);try{this.upgrader.upgradeInbound(o).then(l=>{gn("inbound connection %s upgraded",o.remoteAddr),this.connections.push(o);let u=()=>{this.connections=this.connections.filter(h=>h!==o),this.channels.delete(t),this.pendingSignals.delete(t)};s.addEventListener("close",u,{once:!0}),this.dispatchEvent(new Qr("connection",{detail:l})),this.handler(l)}).catch(l=>{gn.error("inbound connection failed to upgrade",l),o.close().catch(u=>{gn.error("inbound connection failed to close after failing to upgrade",u)})})}catch(l){gn.error("inbound connection failed to upgrade",l),o.close().catch(u=>{gn.error("inbound connection failed to close after failing to upgrade",u)})}},{once:!0}),s}handleWsHandshake(t){if(gn('incoming handshake. signal type "%s" is answer %s',t.signal.type,t.answer),t.answer===!0||t.err!=null||t.intentId==null)return;let r=t.intentId,n=this.pendingSignals.get(r);n==null&&(n=[],this.pendingSignals.set(r,n)),n.push(t);let i=this.channels.get(r);if(i==null){if(t.signal.type!=="offer"){gn("handshake is not an offer and channel does not exist, buffering until we receive an offer");return}gn("creating new channel to handle offer handshake"),i=this._createChannel(t.intentId,t.srcMultiaddr,t.dstMultiaddr),this.channels.set(r,i)}else gn("channel already exists, using it to handle handshake");for(;n.length>0;){let s=n.shift();s?.signal!=null&&i.handleSignal(s.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map(async t=>await t.close()),...Array.from(this.channels.values()).map(async t=>await t.close())]),this.dispatchEvent(new Qr("close"))}},f2=class extends Ki{constructor(t,r,n,i,s){super(),this.upgrader=t,this.handler=r,this.peerId=n,this.transport=i,this.options=s}async listen(t){if(this.listeningAddr!=null)throw(0,J8.default)(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let r=Ms();this.listeningAddr=t;let n;t.protoCodes().includes(421)?n=t:n=t.encapsulate(`/p2p/${this.peerId.toString()}`),this.signallingUrl=o1(t),gn("connecting to signalling server on: %s",this.signallingUrl);let i=new d2(this.signallingUrl,n,this.upgrader,this.handler,this.options.channelOptions);return i.addEventListener("error",s=>{let a=s.detail;gn("error connecting to signalling server %o",a),i.close().catch(o=>{gn.error("error closing server after error",o)}),r.reject(a)}),i.addEventListener("listening",()=>{gn("connected to signalling server"),this.dispatchEvent(new Qr("listening")),r.resolve()}),i.addEventListener("peer",s=>{this.transport.peerDiscovered(s.detail)}),i.addEventListener("connection",s=>{let a=s.detail;if(a.remoteAddr==null)try{a.remoteAddr=t.decapsulateCode(421).encapsulate(`/p2p/${a.remotePeer.toString()}`)}catch(o){gn.error("could not determine remote address",o)}this.dispatchEvent(new Qr("connection",{detail:a}))}),this.transport.sigServers.set(this.signallingUrl,i),await r.promise}async close(){if(this.signallingUrl!=null){let t=this.transport.sigServers.get(this.signallingUrl);t!=null&&(await t.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new Qr("close")),this.listeningAddr=void 0}getAddrs(){return this.listeningAddr!=null?[this.listeningAddr]:[]}};function iv(e,t,r,n,i){return new f2(e,t,r,n,i)}var Qv=hn(r1(),1);fe();fe();fe();fe();var eD=hn(os(),1);fe();var ov=Symbol.for("@libp2p/peer-id");var xv=Object.values(Ya).map(e=>e.decoder).reduce((e,t)=>e.or(t),Ya.identity.decoder),Uv=114,Fv=36,jv=37,tu=class{constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[ov](){return!0}toString(){return this.string==null&&(this.string=rn.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return fr.createV1(Uv,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return eo(this.multihash.bytes,t);if(typeof t=="string")return p2(t).equals(this);if(t?.multihash?.bytes!=null)return eo(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}},su=class extends tu{constructor(t){super({...t,type:"RSA"}),this.type="RSA",this.publicKey=t.publicKey}},Cu=class extends tu{constructor(t){super({...t,type:"Ed25519"}),this.type="Ed25519",this.publicKey=t.multihash.digest}},Du=class extends tu{constructor(t){super({...t,type:"secp256k1"}),this.type="secp256k1",this.publicKey=t.multihash.digest}};function p2(e,t){if(t=t??xv,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=Qs(rn.decode(`z${e}`));return e.startsWith("12D")?new Cu({multihash:r}):e.startsWith("16U")?new Du({multihash:r}):new su({multihash:r})}return rD(xv.decode(e))}function rD(e){try{let t=Qs(e);if(t.code===rd.code){if(t.digest.length===Fv)return new Cu({multihash:t});if(t.digest.length===jv)return new Du({multihash:t})}if(t.code===Jh.code)return new su({multihash:t})}catch{return nD(fr.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function nD(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==Uv)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===Jh.code)return new su({multihash:e.multihash});if(t.code===rd.code){if(t.digest.length===Fv)return new Cu({multihash:e.multihash});if(t.digest.length===jv)return new Du({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}fe();var Wv=Symbol.for("@libp2p/transport");fe();var Nn=hn(os(),1);fe();function pa(e){return e!=null&&typeof e.start=="function"&&typeof e.stop=="function"}function kn(e){return e!=null&&typeof e.init=="function"}var l1=class{constructor(t={}){this.started=!1,t.peerId!=null&&this.setPeerId(t.peerId),t.addressManager!=null&&this.setAddressManager(t.addressManager),t.peerStore!=null&&this.setPeerStore(t.peerStore),t.upgrader!=null&&this.setUpgrader(t.upgrader),t.metrics!=null&&this.setMetrics(t.metrics),t.registrar!=null&&this.setRegistrar(t.registrar),t.connectionManager!=null&&this.setConnectionManager(t.connectionManager),t.transportManager!=null&&this.setTransportManager(t.transportManager),t.connectionGater!=null&&this.setConnectionGater(t.connectionGater),t.contentRouting!=null&&this.setContentRouting(t.contentRouting),t.peerRouting!=null&&this.setPeerRouting(t.peerRouting),t.datastore!=null&&this.setDatastore(t.datastore),t.connectionProtector!=null&&this.setConnectionProtector(t.connectionProtector),t.dht!=null&&this.setDHT(t.dht),t.pubsub!=null&&this.setPubSub(t.pubsub)}isStarted(){return this.started}async beforeStart(){await Promise.all(Object.values(this).filter(t=>pa(t)).map(async t=>{t.beforeStart!=null&&await t.beforeStart()}))}async start(){await Promise.all(Object.values(this).filter(t=>pa(t)).map(async t=>{await t.start()})),this.started=!0}async afterStart(){await Promise.all(Object.values(this).filter(t=>pa(t)).map(async t=>{t.afterStart!=null&&await t.afterStart()}))}async beforeStop(){await Promise.all(Object.values(this).filter(t=>pa(t)).map(async t=>{t.beforeStop!=null&&await t.beforeStop()}))}async stop(){await Promise.all(Object.values(this).filter(t=>pa(t)).map(async t=>{await t.stop()})),this.started=!1}async afterStop(){await Promise.all(Object.values(this).filter(t=>pa(t)).map(async t=>{t.afterStop!=null&&await t.afterStop()}))}setPeerId(t){return this.peerId=t,t}getPeerId(){if(this.peerId==null)throw(0,Nn.default)(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this.peerId}setMetrics(t){return this.metrics=t,kn(t)&&t.init(this),t}getMetrics(){return this.metrics}setAddressManager(t){return this.addressManager=t,kn(t)&&t.init(this),t}getAddressManager(){if(this.addressManager==null)throw(0,Nn.default)(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this.addressManager}setPeerStore(t){return this.peerStore=t,kn(t)&&t.init(this),t}getPeerStore(){if(this.peerStore==null)throw(0,Nn.default)(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this.peerStore}setUpgrader(t){return this.upgrader=t,kn(t)&&t.init(this),t}getUpgrader(){if(this.upgrader==null)throw(0,Nn.default)(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this.upgrader}setRegistrar(t){return this.registrar=t,kn(t)&&t.init(this),t}getRegistrar(){if(this.registrar==null)throw(0,Nn.default)(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this.registrar}setConnectionManager(t){return this.connectionManager=t,kn(t)&&t.init(this),t}getConnectionManager(){if(this.connectionManager==null)throw(0,Nn.default)(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this.connectionManager}setTransportManager(t){return this.transportManager=t,kn(t)&&t.init(this),t}getTransportManager(){if(this.transportManager==null)throw(0,Nn.default)(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this.transportManager}setConnectionGater(t){return this.connectionGater=t,kn(t)&&t.init(this),t}getConnectionGater(){if(this.connectionGater==null)throw(0,Nn.default)(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this.connectionGater}setContentRouting(t){return this.contentRouting=t,kn(t)&&t.init(this),t}getContentRouting(){if(this.contentRouting==null)throw(0,Nn.default)(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this.contentRouting}setPeerRouting(t){return this.peerRouting=t,kn(t)&&t.init(this),t}getPeerRouting(){if(this.peerRouting==null)throw(0,Nn.default)(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this.peerRouting}setDatastore(t){return this.datastore=t,kn(t)&&t.init(this),t}getDatastore(){if(this.datastore==null)throw(0,Nn.default)(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this.datastore}setConnectionProtector(t){return this.connectionProtector=t,kn(t)&&t.init(this),t}getConnectionProtector(){return this.connectionProtector}setDHT(t){return this.dht=t,kn(t)&&t.init(this),t}getDHT(){if(this.dht==null)throw(0,Nn.default)(new Error("dht not set"),"ERR_SERVICE_MISSING");return this.dht}setPubSub(t){return this.pubsub=t,kn(t)&&t.init(this),t}getPubSub(){if(this.pubsub==null)throw(0,Nn.default)(new Error("pubsub not set"),"ERR_SERVICE_MISSING");return this.pubsub}};fe();var Yv=Symbol.for("@libp2p/peer-discovery");var RP="RTCPeerConnection"in globalThis,ga=fi("libp2p:webrtc-star"),xP=()=>{},g2=class extends Ki{constructor(){super(...arguments),this.started=!1}get[Yv](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(t){return this.isStarted()?super.dispatchEvent(t):!1}},u1=class{constructor(t){this.components=new l1,t?.wrtc!=null&&(this.wrtc=t.wrtc),this.sigServers=new Map,this.discovery=new g2,this.peerDiscovered=this.peerDiscovered.bind(this)}get[Wv](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}init(t){this.components=t}async dial(t,r){let n=await this._connect(t,r),i=a1(n,{remoteAddr:t,signal:r.signal});ga("new outbound connection %s",i.remoteAddr);let s=await r.upgrader.upgradeOutbound(i);return ga("outbound connection %s upgraded",i.remoteAddr),s}async _connect(t,r){if(r.signal?.aborted===!0)throw new Cs;let n={...r.channelOptions??{}};this.wrtc!=null&&(n.wrtc=this.wrtc);let i=t.toOptions(),s=Jr((0,Qv.default)(36),"hex");return await new Promise((a,o)=>{let l=this.sigServers.get(o1(t));if(l?.socket==null)return o((0,c1.default)(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let u=!1;ga("dialing %s:%s",i.host,i.port);let h=new eu(n),f=d=>{let g=d.detail;if(!u){let b=`connection error ${i.host}:${i.port}: ${g.message}`;ga.error(b),v(g)}},y=()=>{u=!0,ga("connection opened %s:%s",i.host,i.port),v()},p=()=>{ga.error("connection aborted %s:%s",i.host,i.port),h.close().finally(()=>{v(new Cs)})},v=d=>{h.removeEventListener("ready",y),r.signal?.removeEventListener("abort",p),d==null?a(h):o(d)};h.addEventListener("ready",y,{once:!0}),h.addEventListener("close",()=>{h.removeEventListener("error",f)}),r.signal?.addEventListener("abort",p),h.addEventListener("signal",d=>{let g=d.detail;l.socket.emit("ss-handshake",{intentId:s,srcMultiaddr:l.signallingAddr.toString(),dstMultiaddr:t.toString(),signal:g})}),l.socket.on("ws-handshake",d=>{d.intentId===s&&d.err!=null&&h.close().finally(()=>{o((0,c1.default)(new Error(d.err),"ERR_SIGNALLING_FAILED"))}),!(d.intentId!==s||d.answer==null||h.closed)&&h.handleSignal(d.signal)})})}createListener(t){if(!RP&&this.wrtc==null)throw(0,c1.default)(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return t.channelOptions=t.channelOptions??{},this.wrtc!=null&&(t.channelOptions.wrtc=this.wrtc),iv(t.upgrader,t.handler??xP,this.components.getPeerId(),this,t)}filter(t){return t=Array.isArray(t)?t:[t],t.filter(r=>r.protoCodes().includes(290)?!1:Id.matches(r))}peerDiscovered(t){ga("peer discovered: %s",t),t=G8(t);let r=new tn(t),n=r.getPeerId();if(n==null)return;let i=p2(n);this.discovery.dispatchEvent(new Qr("peer",{detail:{id:i,multiaddrs:[r],protocols:[]}}))}};function Xv(){let e=new u1;return{transports:[e],peerDiscovery:[e.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1},metrics:{enabled:!0}}}Zv();var{IpfsCore:$P}=self,qP={};self.orbitDbs=qP;var b2=null,Dpe=async e=>(b2=b2||new ql(new $l(await $P.create({start:!0,preload:{enabled:!1},config:{...Sg(),...Xv()}}))),b2.connect(e.port1));export{Dpe as connect};
