(()=>{"use strict";var e,t,n={52956:(e,t,n)=>{var r=n(56922);function i(e,t,n,r,i,o,a){try{var u=e[o](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){i(a,r,o,u,s,"next",e)}function s(e){i(a,r,o,u,s,"throw",e)}u(void 0)}))}}var a=function(){var e=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,n=yield s(e),[r]=n.sort(((e,n)=>t(n)-t(e)));if(r&&"visible"===r.visibilityState)return r;var i=yield s(e,!0),[o]=i.sort(((e,n)=>t(n)-t(e)));if(o)return o;throw new Error("No viable client can be found")}));return function(t){return e.apply(this,arguments)}}(),u=e=>{var{frameType:t,type:n,focused:r,visibilityState:i}=e;return("window"===n?1:0)*(r?2:1)*("visible"===i?1:0)*("nested"===t?0:1)},s=function(){var e=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=yield e.clients.matchAll({type:"window",includeUncontrolled:t});return n}));return function(t){return e.apply(this,arguments)}}(),c=e=>{var t=e[Symbol.asyncIterator]();return new ReadableStream({pull:e=>o((function*(){try{var n=yield t.next();n.done?e.close():e.enqueue(n.value)}catch(t){e.error(t)}}))(),cancel(t){e.return&&e.return(t)}})},l=n(23716);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t,n,r,i,o,a){try{var u=e[o](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){v(o,r,i,a,u,"next",e)}function u(e){v(o,r,i,a,u,"throw",e)}a(void 0)}))}}function y(e){return new w(e)}function m(e){var t,n;function r(t,n){try{var o=e[t](n),a=o.value,u=a instanceof w;Promise.resolve(u?a.wrapped:a).then((function(e){u?r("return"===t?"return":"next",e):i(o.done?"return":"normal",e)}),(function(e){r("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise((function(o,a){var u={key:e,arg:i,resolve:o,reject:a,next:null};n?n=n.next=u:(t=n=u,r(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}function w(e){this.wrapped=e}function b(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new g(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function g(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return g=function(e){this.s=e,this.n=e.next},g.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new g(e)}m.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},m.prototype.next=function(e){return this._invoke("next",e)},m.prototype.throw=function(e){return this._invoke("throw",e)},m.prototype.return=function(e){return this._invoke("return",e)};var x=function(){var e=d((function*(e){e.waitUntil(e.target.skipWaiting())}));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=d((function*(e){e.waitUntil(e.target.clients.claim())}));return function(t){return e.apply(this,arguments)}}(),j=e=>{var t=new URL(e.request.url);if(t.origin===location.origin){var[,n]=t.pathname.split("/");switch(n){case"ipfs":case"ipns":return e.respondWith(P({url:t}));case"view":return e.respondWith(k({event:e,path:t.pathname.slice(n.length+1)}));default:return e.respondWith(fetch(e.request))}}return e.respondWith(fetch(e.request))},P=function(){var e=d((function*(e){var{url:t}=e,n=new Blob(["<html data-viewer>\n<head>\n  <title>".concat(t.pathname,'</title>\n  <script src="https://spike.land/main.js"><\/script>\n</head>\n<body>\n  <iframe id="viewer" style="width:100%;height:100%;position:fixed;top:0;left:0;border:none;" src="/view').concat(t.pathname,'"></iframe>\n</body>\n\n</html>\n')],{type:"text/html"});return new Response(n,{status:200})}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=d((function*(e){var{event:t,path:n}=e,[,r]=n.split("/");switch(r){case"ipns":return yield S({event:t,path:n});case"ipfs":return yield T({event:t,path:n});default:return yield q(r)}}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=d((function*(e){var{}=e;return new Response("<html>\n  <body>\n    <h1>IPNS protocol support is not implemented</h1>\n    <p>It is left as an excercise to the viewer</p>\n  </body>\n</html>",{statusText:"IPNS support is not implemented",status:502})}));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=d((function*(e){var{event:t,path:n}=e,r=yield D(t);try{switch((yield r.files.stat(n)).type){case"file":return yield R(r,n);case"directory":if(n.endsWith("/")){var i="".concat(n,"index.html");return"file"===(yield r.files.stat(i).catch((()=>({type:null})))).type?R(r,i):I(r,n)}return Response.redirect("".concat(t.request.url,"/"));default:return Response.redirect("https://explore.ipld.io/#/explore".concat(n))}}catch({message:e}){return l.error(e),e.startsWith("no link named")||e.includes("does not exist")?new Response(e,{statusText:e,status:404}):e.includes("invalid")?new Response(e,{statusText:e,status:400}):new Response(e,{statusText:e,status:500})}}));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=d((function*(e,t){var n=e.cat(t),r=c(n),i=t.endsWith(".svg")?{"content-type":"image/svg+xml"}:null;return new Response(r,{status:200,headers:f({},i)})}));return function(t,n){return e.apply(this,arguments)}}(),I=function(){var e=d((function*(e,t){return new Response(c(_(e,t)),{headers:{"content-type":"text/html"},status:200})}));return function(t,n){return e.apply(this,arguments)}}(),_=function(){var e,t=(e=function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,r=new TextEncoder;yield r.encode("<html><h3>Index of ".concat(t,"<h3><ul>"));var i,o=!1,a=!1;try{for(var u,s=b(e.ls(t));o=!(u=yield y(s.next())).done;o=!1){var c=u.value;if(yield r.encode(E(t,c)),--n<0)break}}catch(e){a=!0,i=e}finally{try{o&&null!=s.return&&(yield y(s.return()))}finally{if(a)throw i}}yield r.encode("</ul>".concat(n<0?W:"","</html>"))},function(){return new m(e.apply(this,arguments))});return function(e,n){return t.apply(this,arguments)}}(),W="<h2>Directory has too many entries</h2><p><mark>Implementing a pagination is left as an excercise to the viewer</mark></p></h2>",E=(e,t)=>'<li>\n  <div class="type-'.concat(t.type,'"><a href="/view').concat(e).concat(t.name,'">').concat(t.name,"<a></div>\n  <small>").concat(t.cid.toString(),"</small>\n  <details><pre>").concat(JSON.stringify(t,null,2),"</pre></details>\n</li>"),q=function(){var e=d((function*(e){return new Response("<html>\n    <body>\n      <h1>Protocol ".concat(e," is not supported</h1>\n    </body>\n</html>"),{statusText:"Unsupported protocol ".concat(e),status:405})}));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=d((function*(e){var t=yield a(e.target),n=yield U(t);return r.B.from(n)}));return function(t){return e.apply(this,arguments)}}(),U=e=>{var t,n=N[e.id];if(null==n){var r=((t={}).promise=new Promise(((e,n)=>{t.resolve=e,t.reject=n})),t);return N[e.id]=r,e.postMessage({method:"ipfs-message-port",id:e.id}),r.promise}return n.promise},N=Object.create(null),B=e=>{var{data:t}=e;if(t){var n=N[t.id];null!=n&&(delete N[t.id],t.port instanceof MessagePort?n.resolve(t.port):n.reject(new Error(t.error)))}};(e=>{e.oninstall=x,e.onactivate=O,e.onfetch=j,e.onmessage=B})(self)}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e].call(o.exports,o,o.exports,i),o.exports}i.m=n,i.x=()=>{var e=i.O(void 0,[662,119],(()=>i(52956)));return i.O(e)},e=[],i.O=(t,n,r,o)=>{if(!n){var a=1/0;for(l=0;l<e.length;l++){for(var[n,r,o]=e[l],u=!0,s=0;s<n.length;s++)(!1&o||a>=o)&&Object.keys(i.O).every((e=>i.O[e](n[s])))?n.splice(s--,1):(u=!1,o<a&&(a=o));if(u){e.splice(l--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[n,r,o]},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+".js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.p="/",(()=>{var e={956:1};i.f.i=(t,n)=>{e[t]||importScripts(i.p+i.u(t))};var t=globalThis.webpackChunkexample_browser_service_worker=globalThis.webpackChunkexample_browser_service_worker||[],n=t.push.bind(t);t.push=t=>{var[r,o,a]=t;for(var u in o)i.o(o,u)&&(i.m[u]=o[u]);for(a&&a(i);r.length;)e[r.pop()]=1;n(t)}})(),t=i.x,i.x=()=>Promise.all([i.e(662),i.e(119)]).then(t),i.x()})();