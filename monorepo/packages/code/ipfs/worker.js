"use strict";(()=>{var zEe=Object.create;var h4=Object.defineProperty;var HEe=Object.getOwnPropertyDescriptor;var $Ee=Object.getOwnPropertyNames;var GEe=Object.getPrototypeOf,WEe=Object.prototype.hasOwnProperty;var MD=t=>h4(t,"__esModule",{value:!0});var La=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var w=(t,e)=>()=>(t&&(e=t(t=0)),e);var g=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Tt=(t,e)=>{for(var r in e)h4(t,r,{get:e[r],enumerable:!0})},UD=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of $Ee(e))!WEe.call(t,i)&&(r||i!=="default")&&h4(t,i,{get:()=>e[i],enumerable:!(n=HEe(e,i))||n.enumerable});return t},A=(t,e)=>UD(MD(h4(t!=null?zEe(GEe(t)):{},"default",!e&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t),se=(t=>(e,r)=>t&&t.get(e)||(r=UD(MD({}),e,1),t&&t.set(e,r),r))(typeof WeakMap!="undefined"?new WeakMap:0);var m7=g((olt,qD)=>{"use strict";qD.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var Wu=g((VD,zD)=>{"use strict";var d4=m7(),{hasOwnProperty:KD}=Object.prototype,{propertyIsEnumerable:YEe}=Object,ep=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),XEe=VD,FD={concatArrays:!1,ignoreUndefined:!1},p4=t=>{let e=[];for(let r in t)KD.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let n of r)YEe.call(t,n)&&e.push(n)}return e};function tp(t){return Array.isArray(t)?QEe(t):d4(t)?ZEe(t):t}function QEe(t){let e=t.slice(0,0);return p4(t).forEach(r=>{ep(e,r,tp(t[r]))}),e}function ZEe(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return p4(t).forEach(r=>{ep(e,r,tp(t[r]))}),e}var jD=(t,e,r,n)=>(r.forEach(i=>{typeof e[i]>"u"&&n.ignoreUndefined||(i in t&&t[i]!==Object.getPrototypeOf(t)?ep(t,i,w7(t[i],e[i],n)):ep(t,i,tp(e[i])))}),t),JEe=(t,e,r)=>{let n=t.slice(0,0),i=0;return[t,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!KD.call(s,a)||(o.push(String(a)),s===t?ep(n,i++,s[a]):ep(n,i++,tp(s[a])));n=jD(n,s,p4(s).filter(a=>!o.includes(a)),r)}),n};function w7(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?JEe(t,e,r):!d4(e)||!d4(t)?tp(e):jD(t,e,p4(e),r)}zD.exports=function(...t){let e=w7(tp(FD),this!==XEe&&this||{},FD),r={_:{}};for(let n of t)if(n!==void 0){if(!d4(n))throw new TypeError("`"+n+"` is not an Option Object");r=w7(r,{_:n},e)}return r._}});var HD,Bt,Fn=w(()=>{HD=A(Wu(),1),Bt=HD.default});var b7=g((clt,$D)=>{function e9e(){return typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}$D.exports=e9e});var Xy=g((ult,GD)=>{"use strict";var t9e=b7(),y4=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Yy=t9e(),r9e=y4&&!Yy,n9e=Yy&&!y4,i9e=Yy&&y4,s9e=typeof La=="function"&&typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!Yy,o9e=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerglobalThisScope<"u"&&self instanceof WorkerglobalThisScope,a9e=typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis.process.env.NODE_ENV==="test",c9e=typeof navigator<"u"&&navigator.product==="ReactNative";GD.exports={isTest:a9e,isElectron:Yy,isElectronMain:n9e,isElectronRenderer:i9e,isNode:s9e,isBrowser:r9e,isWebWorker:o9e,isEnvWithDom:y4,isReactNative:c9e}});var YD=g((llt,WD)=>{var rp=1e3,np=rp*60,ip=np*60,$f=ip*24,u9e=$f*7,l9e=$f*365.25;WD.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return f9e(t);if(r==="number"&&isFinite(t))return e.long?d9e(t):h9e(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function f9e(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*l9e;case"weeks":case"week":case"w":return r*u9e;case"days":case"day":case"d":return r*$f;case"hours":case"hour":case"hrs":case"hr":case"h":return r*ip;case"minutes":case"minute":case"mins":case"min":case"m":return r*np;case"seconds":case"second":case"secs":case"sec":case"s":return r*rp;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function h9e(t){var e=Math.abs(t);return e>=$f?Math.round(t/$f)+"d":e>=ip?Math.round(t/ip)+"h":e>=np?Math.round(t/np)+"m":e>=rp?Math.round(t/rp)+"s":t+"ms"}function d9e(t){var e=Math.abs(t);return e>=$f?g4(t,e,$f,"day"):e>=ip?g4(t,e,ip,"hour"):e>=np?g4(t,e,np,"minute"):e>=rp?g4(t,e,rp,"second"):t+" ms"}function g4(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var QD=g((flt,XD)=>{function p9e(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=YD(),r.destroy=u,Object.keys(t).forEach(l=>{r[l]=t[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let f=0;for(let h=0;h<l.length;h++)f=(f<<5)-f+l.charCodeAt(h),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=e;function r(l){let f,h=null,d,p;function y(...b){if(!y.enabled)return;let m=y,_=Number(new Date),R=_-(f||_);m.diff=R,m.prev=f,m.curr=_,f=_,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let k=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(x,D)=>{if(x==="%%")return"%";k++;let U=r.formatters[D];if(typeof U=="function"){let M=b[k];x=U.call(m,M),b.splice(k,1),k--}return x}),r.formatArgs.call(m,b),(m.log||r.log).apply(m,b)}return y.namespace=l,y.useColors=r.useColors(),y.color=r.selectColor(l),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(l)),p),set:b=>{h=b}}),typeof r.init=="function"&&r.init(y),y}function n(l,f){let h=r(this.namespace+(typeof f>"u"?":":f)+l);return h.log=this.log,h}function i(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let f,h=(typeof l=="string"?l:"").split(/[\s,]+/),d=h.length;for(f=0;f<d;f++)!h[f]||(l=h[f].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.slice(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...r.names.map(a),...r.skips.map(a).map(f=>"-"+f)].join(",");return r.enable(""),l}function o(l){if(l[l.length-1]==="*")return!0;let f,h;for(f=0,h=r.skips.length;f<h;f++)if(r.skips[f].test(l))return!1;for(f=0,h=r.names.length;f<h;f++)if(r.names[f].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}XD.exports=p9e});var he=g((As,m4)=>{As.formatArgs=g9e;As.save=m9e;As.load=w9e;As.useColors=y9e;As.storage=b9e();As.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();As.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function y9e(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function g9e(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+m4.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}As.log=console.debug||console.log||(()=>{});function m9e(t){try{t?As.storage.setItem("debug",t):As.storage.removeItem("debug")}catch{}}function w9e(){let t;try{t=As.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function b9e(){try{return localStorage}catch{}}m4.exports=QD()(As);var{formatters:_9e}=m4.exports;_9e.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var oe=g((hlt,JD)=>{"use strict";function ZD(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function v9e(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return ZD(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),ZD(new i,r)}}JD.exports=v9e});var tN=g((dlt,eN)=>{"use strict";eN.exports=E9e;function E9e(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,c){r[n]=function(l){if(s)if(s=!1,l)c(l);else{for(var f=new Array(arguments.length-1),h=0;h<f.length;)f[h++]=arguments[h];a.apply(null,f)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,c(u))}})}});var sN=g(iN=>{"use strict";var w4=iN;w4.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var sp=new Array(64),nN=new Array(123);for(Xo=0;Xo<64;)nN[sp[Xo]=Xo<26?Xo+65:Xo<52?Xo+71:Xo<62?Xo-4:Xo-59|43]=Xo++;var Xo;w4.encode=function(e,r,n){for(var i=null,s=[],o=0,a=0,c;r<n;){var u=e[r++];switch(a){case 0:s[o++]=sp[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=sp[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=sp[c|u>>6],s[o++]=sp[u&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=sp[c],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var rN="invalid encoding";w4.decode=function(e,r,n){for(var i=n,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=nN[c])===void 0)throw Error(rN);switch(s){case 0:o=c,s=1;break;case 1:r[n++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:r[n++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:r[n++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(rN);return n-i};w4.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var aN=g((ylt,oN)=>{"use strict";oN.exports=b4;function b4(){this._listeners={}}b4.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};b4.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};b4.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var pN=g((glt,dN)=>{"use strict";dN.exports=cN(cN);function cN(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3]}function s(c,u,l){e[0]=c,u[l]=r[3],u[l+1]=r[2],u[l+2]=r[1],u[l+3]=r[0]}t.writeFloatLE=n?i:s,t.writeFloatBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],e[0]}function a(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],e[0]}t.readFloatLE=n?o:a,t.readFloatBE=n?a:o}():function(){function e(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|u)>>>0,s,o)}}t.writeFloatLE=e.bind(null,uN),t.writeFloatBE=e.bind(null,lN);function r(n,i,s){var o=n(i,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}t.readFloatLE=r.bind(null,fN),t.readFloatBE=r.bind(null,hN)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3],u[l+4]=r[4],u[l+5]=r[5],u[l+6]=r[6],u[l+7]=r[7]}function s(c,u,l){e[0]=c,u[l]=r[7],u[l+1]=r[6],u[l+2]=r[5],u[l+3]=r[4],u[l+4]=r[3],u[l+5]=r[2],u[l+6]=r[1],u[l+7]=r[0]}t.writeDoubleLE=n?i:s,t.writeDoubleBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],e[0]}function a(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],e[0]}t.readDoubleLE=n?o:a,t.readDoubleBE=n?a:o}():function(){function e(n,i,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)n(0,a,c+i),n(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))n(0,a,c+i),n(2146959360,a,c+s);else if(o>17976931348623157e292)n(0,a,c+i),n((u<<31|2146435072)>>>0,a,c+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,n(l>>>0,a,c+i),n((u<<31|l/4294967296)>>>0,a,c+s);else{var f=Math.floor(Math.log(o)/Math.LN2);f===1024&&(f=1023),l=o*Math.pow(2,-f),n(l*4503599627370496>>>0,a,c+i),n((u<<31|f+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}t.writeDoubleLE=e.bind(null,uN,0,4),t.writeDoubleBE=e.bind(null,lN,4,0);function r(n,i,s,o,a){var c=n(o,a+i),u=n(o,a+s),l=(u>>31)*2+1,f=u>>>20&2047,h=4294967296*(u&1048575)+c;return f===2047?h?NaN:l*(1/0):f===0?l*5e-324*h:l*Math.pow(2,f-1075)*(h+4503599627370496)}t.readDoubleLE=r.bind(null,fN,0,4),t.readDoubleBE=r.bind(null,hN,4,0)}(),t}function uN(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function lN(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function fN(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function hN(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var yN=g((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var mN=g(gN=>{"use strict";var _7=gN;_7.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};_7.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],a=0,c;r<n;)c=e[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};_7.write=function(e,r,n){for(var i=n,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var bN=g((wlt,wN)=>{"use strict";wN.exports=S9e;function S9e(t,e,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(c){if(c<1||c>i)return t(c);o+c>n&&(s=t(n),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var vN=g((blt,_N)=>{"use strict";_N.exports=Xn;var Qy=Xu();function Xn(t,e){this.lo=t>>>0,this.hi=e>>>0}var Gf=Xn.zero=new Xn(0,0);Gf.toNumber=function(){return 0};Gf.zzEncode=Gf.zzDecode=function(){return this};Gf.length=function(){return 1};var A9e=Xn.zeroHash="\0\0\0\0\0\0\0\0";Xn.fromNumber=function(e){if(e===0)return Gf;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Xn(n,i)};Xn.from=function(e){if(typeof e=="number")return Xn.fromNumber(e);if(Qy.isString(e))if(Qy.Long)e=Qy.Long.fromString(e);else return Xn.fromNumber(parseInt(e,10));return e.low||e.high?new Xn(e.low>>>0,e.high>>>0):Gf};Xn.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Xn.prototype.toLong=function(e){return Qy.Long?new Qy.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Yu=String.prototype.charCodeAt;Xn.fromHash=function(e){return e===A9e?Gf:new Xn((Yu.call(e,0)|Yu.call(e,1)<<8|Yu.call(e,2)<<16|Yu.call(e,3)<<24)>>>0,(Yu.call(e,4)|Yu.call(e,5)<<8|Yu.call(e,6)<<16|Yu.call(e,7)<<24)>>>0)};Xn.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Xn.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Xn.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Xn.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Xu=g(v7=>{"use strict";var Qe=v7;Qe.asPromise=tN();Qe.base64=sN();Qe.EventEmitter=aN();Qe.float=pN();Qe.inquire=yN();Qe.utf8=mN();Qe.pool=bN();Qe.LongBits=vN();Qe.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);Qe.globalThis=Qe.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||v7;Qe.emptyArray=Object.freeze?Object.freeze([]):[];Qe.emptyObject=Object.freeze?Object.freeze({}):{};Qe.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Qe.isString=function(e){return typeof e=="string"||e instanceof String};Qe.isObject=function(e){return e&&typeof e=="object"};Qe.isset=Qe.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};Qe.Buffer=function(){try{var t=Qe.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();Qe._Buffer_from=null;Qe._Buffer_allocUnsafe=null;Qe.newBuffer=function(e){return typeof e=="number"?Qe.Buffer?Qe._Buffer_allocUnsafe(e):new Qe.Array(e):Qe.Buffer?Qe._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};Qe.Array=typeof Uint8Array<"u"?Uint8Array:Array;Qe.Long=Qe.globalThis.dcodeIO&&Qe.globalThis.dcodeIO.Long||Qe.globalThis.Long||Qe.inquire("long");Qe.key2Re=/^true|false|0|1$/;Qe.key32Re=/^-?(?:0|[1-9][0-9]*)$/;Qe.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;Qe.longToHash=function(e){return e?Qe.LongBits.from(e).toHash():Qe.LongBits.zeroHash};Qe.longFromHash=function(e,r){var n=Qe.LongBits.fromHash(e);return Qe.Long?Qe.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function EN(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}Qe.merge=EN;Qe.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function SN(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&EN(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}Qe.newError=SN;Qe.ProtocolError=SN("ProtocolError");Qe.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};Qe.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};Qe.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};Qe._configure=function(){var t=Qe.Buffer;if(!t){Qe._Buffer_from=Qe._Buffer_allocUnsafe=null;return}Qe._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},Qe._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var x7=g((vlt,TN)=>{"use strict";TN.exports=Qt;var Ws=Xu(),E7,_4=Ws.LongBits,AN=Ws.base64,RN=Ws.utf8;function Zy(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function A7(){}function R9e(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Qt(){this.len=0,this.head=new Zy(A7,0,0),this.tail=this.head,this.states=null}var IN=function(){return Ws.Buffer?function(){return(Qt.create=function(){return new E7})()}:function(){return new Qt}};Qt.create=IN();Qt.alloc=function(e){return new Ws.Array(e)};Ws.Array!==Array&&(Qt.alloc=Ws.pool(Qt.alloc,Ws.Array.prototype.subarray));Qt.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Zy(e,r,n),this.len+=r,this};function R7(t,e,r){e[r]=t&255}function I9e(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function I7(t,e){this.len=t,this.next=void 0,this.val=e}I7.prototype=Object.create(Zy.prototype);I7.prototype.fn=I9e;Qt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new I7((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Qt.prototype.int32=function(e){return e<0?this._push(T7,10,_4.fromNumber(e)):this.uint32(e)};Qt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function T7(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}Qt.prototype.uint64=function(e){var r=_4.from(e);return this._push(T7,r.length(),r)};Qt.prototype.int64=Qt.prototype.uint64;Qt.prototype.sint64=function(e){var r=_4.from(e).zzEncode();return this._push(T7,r.length(),r)};Qt.prototype.bool=function(e){return this._push(R7,1,e?1:0)};function S7(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Qt.prototype.fixed32=function(e){return this._push(S7,4,e>>>0)};Qt.prototype.sfixed32=Qt.prototype.fixed32;Qt.prototype.fixed64=function(e){var r=_4.from(e);return this._push(S7,4,r.lo)._push(S7,4,r.hi)};Qt.prototype.sfixed64=Qt.prototype.fixed64;Qt.prototype.float=function(e){return this._push(Ws.float.writeFloatLE,4,e)};Qt.prototype.double=function(e){return this._push(Ws.float.writeDoubleLE,8,e)};var T9e=Ws.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};Qt.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(R7,1,0);if(Ws.isString(e)){var n=Qt.alloc(r=AN.length(e));AN.decode(e,n,0),e=n}return this.uint32(r)._push(T9e,r,e)};Qt.prototype.string=function(e){var r=RN.length(e);return r?this.uint32(r)._push(RN.write,r,e):this._push(R7,1,0)};Qt.prototype.fork=function(){return this.states=new R9e(this),this.head=this.tail=new Zy(A7,0,0),this.len=0,this};Qt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Zy(A7,0,0),this.len=0),this};Qt.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};Qt.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};Qt._configure=function(t){E7=t,Qt.create=IN(),E7._configure()}});var CN=g((Elt,PN)=>{"use strict";PN.exports=Ma;var xN=x7();(Ma.prototype=Object.create(xN.prototype)).constructor=Ma;var Qu=Xu();function Ma(){xN.call(this)}Ma._configure=function(){Ma.alloc=Qu._Buffer_allocUnsafe,Ma.writeBytesBuffer=Qu.Buffer&&Qu.Buffer.prototype instanceof Uint8Array&&Qu.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Ma.prototype.bytes=function(e){Qu.isString(e)&&(e=Qu._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Ma.writeBytesBuffer,r,e),this};function x9e(t,e,r){t.length<40?Qu.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Ma.prototype.string=function(e){var r=Qu.Buffer.byteLength(e);return this.uint32(r),r&&this._push(x9e,r,e),this};Ma._configure()});var O7=g((Slt,BN)=>{"use strict";BN.exports=yn;var Ua=Xu(),C7,DN=Ua.LongBits,P9e=Ua.utf8;function Qo(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function yn(t){this.buf=t,this.pos=0,this.len=t.length}var ON=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new yn(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new yn(e);throw Error("illegal buffer")},NN=function(){return Ua.Buffer?function(r){return(yn.create=function(i){return Ua.Buffer.isBuffer(i)?new C7(i):ON(i)})(r)}:ON};yn.create=NN();yn.prototype._slice=Ua.Array.prototype.subarray||Ua.Array.prototype.slice;yn.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Qo(this,10);return e}}();yn.prototype.int32=function(){return this.uint32()|0};yn.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function P7(){var t=new DN(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Qo(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Qo(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}yn.prototype.bool=function(){return this.uint32()!==0};function v4(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}yn.prototype.fixed32=function(){if(this.pos+4>this.len)throw Qo(this,4);return v4(this.buf,this.pos+=4)};yn.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Qo(this,4);return v4(this.buf,this.pos+=4)|0};function kN(){if(this.pos+8>this.len)throw Qo(this,8);return new DN(v4(this.buf,this.pos+=4),v4(this.buf,this.pos+=4))}yn.prototype.float=function(){if(this.pos+4>this.len)throw Qo(this,4);var e=Ua.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};yn.prototype.double=function(){if(this.pos+8>this.len)throw Qo(this,4);var e=Ua.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};yn.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Qo(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};yn.prototype.string=function(){var e=this.bytes();return P9e.read(e,0,e.length)};yn.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Qo(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Qo(this);while(this.buf[this.pos++]&128);return this};yn.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};yn._configure=function(t){C7=t,yn.create=NN(),C7._configure();var e=Ua.Long?"toLong":"toNumber";Ua.merge(yn.prototype,{int64:function(){return P7.call(this)[e](!1)},uint64:function(){return P7.call(this)[e](!0)},sint64:function(){return P7.call(this).zzDecode()[e](!1)},fixed64:function(){return kN.call(this)[e](!0)},sfixed64:function(){return kN.call(this)[e](!1)}})}});var qN=g((Alt,UN)=>{"use strict";UN.exports=Wf;var MN=O7();(Wf.prototype=Object.create(MN.prototype)).constructor=Wf;var LN=Xu();function Wf(t){MN.call(this,t)}Wf._configure=function(){LN.Buffer&&(Wf.prototype._slice=LN.Buffer.prototype.slice)};Wf.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Wf._configure()});var KN=g((Rlt,FN)=>{"use strict";FN.exports=Jy;var k7=Xu();(Jy.prototype=Object.create(k7.EventEmitter.prototype)).constructor=Jy;function Jy(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");k7.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}Jy.prototype.rpcCall=function t(e,r,n,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return k7.asPromise(t,o,e,r,n,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof n))try{u=n[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};Jy.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var VN=g(jN=>{"use strict";var C9e=jN;C9e.Service=KN()});var HN=g((Tlt,zN)=>{"use strict";zN.exports={}});var WN=g(GN=>{"use strict";var Ji=GN;Ji.build="minimal";Ji.Writer=x7();Ji.BufferWriter=CN();Ji.Reader=O7();Ji.BufferReader=qN();Ji.util=Xu();Ji.rpc=VN();Ji.roots=HN();Ji.configure=$N;function $N(){Ji.util._configure(),Ji.Writer._configure(Ji.BufferWriter),Ji.Reader._configure(Ji.BufferReader)}$N()});var Kr=g((Plt,YN)=>{"use strict";YN.exports=WN()});var Hc,op,D7,ot,ui,XN,Clt,Olt,QN=w(()=>{Hc=A(Kr(),1),op=Hc.default.Reader,D7=Hc.default.Writer,ot=Hc.default.util,ui=Hc.default.roots["ipfs-unixfs"]||(Hc.default.roots["ipfs-unixfs"]={}),XN=ui.Data=(()=>{function t(e){if(this.blocksizes=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=ot.newBuffer([]),t.prototype.filesize=ot.Long?ot.Long.fromBits(0,0,!0):0,t.prototype.blocksizes=ot.emptyArray,t.prototype.hashType=ot.Long?ot.Long.fromBits(0,0,!0):0,t.prototype.fanout=ot.Long?ot.Long.fromBits(0,0,!0):0,t.prototype.mode=0,t.prototype.mtime=null,t.encode=function(r,n){if(n||(n=D7.create()),n.uint32(8).int32(r.Type),r.Data!=null&&Object.hasOwnProperty.call(r,"Data")&&n.uint32(18).bytes(r.Data),r.filesize!=null&&Object.hasOwnProperty.call(r,"filesize")&&n.uint32(24).uint64(r.filesize),r.blocksizes!=null&&r.blocksizes.length)for(var i=0;i<r.blocksizes.length;++i)n.uint32(32).uint64(r.blocksizes[i]);return r.hashType!=null&&Object.hasOwnProperty.call(r,"hashType")&&n.uint32(40).uint64(r.hashType),r.fanout!=null&&Object.hasOwnProperty.call(r,"fanout")&&n.uint32(48).uint64(r.fanout),r.mode!=null&&Object.hasOwnProperty.call(r,"mode")&&n.uint32(56).uint32(r.mode),r.mtime!=null&&Object.hasOwnProperty.call(r,"mtime")&&ui.UnixTime.encode(r.mtime,n.uint32(66).fork()).ldelim(),n},t.decode=function(r,n){r instanceof op||(r=op.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ui.Data;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;case 3:s.filesize=r.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(o&7)===2)for(var a=r.uint32()+r.pos;r.pos<a;)s.blocksizes.push(r.uint64());else s.blocksizes.push(r.uint64());break;case 5:s.hashType=r.uint64();break;case 6:s.fanout=r.uint64();break;case 7:s.mode=r.uint32();break;case 8:s.mtime=ui.UnixTime.decode(r,r.uint32());break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw ot.ProtocolError("missing required 'Type'",{instance:s});return s},t.fromObject=function(r){if(r instanceof ui.Data)return r;var n=new ui.Data;switch(r.Type){case"Raw":case 0:n.Type=0;break;case"Directory":case 1:n.Type=1;break;case"File":case 2:n.Type=2;break;case"Metadata":case 3:n.Type=3;break;case"Symlink":case 4:n.Type=4;break;case"HAMTShard":case 5:n.Type=5;break}if(r.Data!=null&&(typeof r.Data=="string"?ot.base64.decode(r.Data,n.Data=ot.newBuffer(ot.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),r.filesize!=null&&(ot.Long?(n.filesize=ot.Long.fromValue(r.filesize)).unsigned=!0:typeof r.filesize=="string"?n.filesize=parseInt(r.filesize,10):typeof r.filesize=="number"?n.filesize=r.filesize:typeof r.filesize=="object"&&(n.filesize=new ot.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0))),r.blocksizes){if(!Array.isArray(r.blocksizes))throw TypeError(".Data.blocksizes: array expected");n.blocksizes=[];for(var i=0;i<r.blocksizes.length;++i)ot.Long?(n.blocksizes[i]=ot.Long.fromValue(r.blocksizes[i])).unsigned=!0:typeof r.blocksizes[i]=="string"?n.blocksizes[i]=parseInt(r.blocksizes[i],10):typeof r.blocksizes[i]=="number"?n.blocksizes[i]=r.blocksizes[i]:typeof r.blocksizes[i]=="object"&&(n.blocksizes[i]=new ot.LongBits(r.blocksizes[i].low>>>0,r.blocksizes[i].high>>>0).toNumber(!0))}if(r.hashType!=null&&(ot.Long?(n.hashType=ot.Long.fromValue(r.hashType)).unsigned=!0:typeof r.hashType=="string"?n.hashType=parseInt(r.hashType,10):typeof r.hashType=="number"?n.hashType=r.hashType:typeof r.hashType=="object"&&(n.hashType=new ot.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0))),r.fanout!=null&&(ot.Long?(n.fanout=ot.Long.fromValue(r.fanout)).unsigned=!0:typeof r.fanout=="string"?n.fanout=parseInt(r.fanout,10):typeof r.fanout=="number"?n.fanout=r.fanout:typeof r.fanout=="object"&&(n.fanout=new ot.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0))),r.mode!=null&&(n.mode=r.mode>>>0),r.mtime!=null){if(typeof r.mtime!="object")throw TypeError(".Data.mtime: object expected");n.mtime=ui.UnixTime.fromObject(r.mtime)}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.blocksizes=[]),n.defaults){if(i.Type=n.enums===String?"Raw":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=ot.newBuffer(i.Data))),ot.Long){var s=new ot.Long(0,0,!0);i.filesize=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.filesize=n.longs===String?"0":0;if(ot.Long){var s=new ot.Long(0,0,!0);i.hashType=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.hashType=n.longs===String?"0":0;if(ot.Long){var s=new ot.Long(0,0,!0);i.fanout=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.fanout=n.longs===String?"0":0;i.mode=0,i.mtime=null}if(r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?ui.Data.DataType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?ot.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),r.filesize!=null&&r.hasOwnProperty("filesize")&&(typeof r.filesize=="number"?i.filesize=n.longs===String?String(r.filesize):r.filesize:i.filesize=n.longs===String?ot.Long.prototype.toString.call(r.filesize):n.longs===Number?new ot.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0):r.filesize),r.blocksizes&&r.blocksizes.length){i.blocksizes=[];for(var o=0;o<r.blocksizes.length;++o)typeof r.blocksizes[o]=="number"?i.blocksizes[o]=n.longs===String?String(r.blocksizes[o]):r.blocksizes[o]:i.blocksizes[o]=n.longs===String?ot.Long.prototype.toString.call(r.blocksizes[o]):n.longs===Number?new ot.LongBits(r.blocksizes[o].low>>>0,r.blocksizes[o].high>>>0).toNumber(!0):r.blocksizes[o]}return r.hashType!=null&&r.hasOwnProperty("hashType")&&(typeof r.hashType=="number"?i.hashType=n.longs===String?String(r.hashType):r.hashType:i.hashType=n.longs===String?ot.Long.prototype.toString.call(r.hashType):n.longs===Number?new ot.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0):r.hashType),r.fanout!=null&&r.hasOwnProperty("fanout")&&(typeof r.fanout=="number"?i.fanout=n.longs===String?String(r.fanout):r.fanout:i.fanout=n.longs===String?ot.Long.prototype.toString.call(r.fanout):n.longs===Number?new ot.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0):r.fanout),r.mode!=null&&r.hasOwnProperty("mode")&&(i.mode=r.mode),r.mtime!=null&&r.hasOwnProperty("mtime")&&(i.mtime=ui.UnixTime.toObject(r.mtime,n)),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Hc.default.util.toJSONOptions)},t.DataType=function(){let e={},r=Object.create(e);return r[e[0]="Raw"]=0,r[e[1]="Directory"]=1,r[e[2]="File"]=2,r[e[3]="Metadata"]=3,r[e[4]="Symlink"]=4,r[e[5]="HAMTShard"]=5,r}(),t})(),Clt=ui.UnixTime=(()=>{function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Seconds=ot.Long?ot.Long.fromBits(0,0,!1):0,t.prototype.FractionalNanoseconds=0,t.encode=function(r,n){return n||(n=D7.create()),n.uint32(8).int64(r.Seconds),r.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(r,"FractionalNanoseconds")&&n.uint32(21).fixed32(r.FractionalNanoseconds),n},t.decode=function(r,n){r instanceof op||(r=op.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ui.UnixTime;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Seconds=r.int64();break;case 2:s.FractionalNanoseconds=r.fixed32();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Seconds"))throw ot.ProtocolError("missing required 'Seconds'",{instance:s});return s},t.fromObject=function(r){if(r instanceof ui.UnixTime)return r;var n=new ui.UnixTime;return r.Seconds!=null&&(ot.Long?(n.Seconds=ot.Long.fromValue(r.Seconds)).unsigned=!1:typeof r.Seconds=="string"?n.Seconds=parseInt(r.Seconds,10):typeof r.Seconds=="number"?n.Seconds=r.Seconds:typeof r.Seconds=="object"&&(n.Seconds=new ot.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber())),r.FractionalNanoseconds!=null&&(n.FractionalNanoseconds=r.FractionalNanoseconds>>>0),n},t.toObject=function(r,n){n||(n={});var i={};if(n.defaults){if(ot.Long){var s=new ot.Long(0,0,!1);i.Seconds=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.Seconds=n.longs===String?"0":0;i.FractionalNanoseconds=0}return r.Seconds!=null&&r.hasOwnProperty("Seconds")&&(typeof r.Seconds=="number"?i.Seconds=n.longs===String?String(r.Seconds):r.Seconds:i.Seconds=n.longs===String?ot.Long.prototype.toString.call(r.Seconds):n.longs===Number?new ot.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber():r.Seconds),r.FractionalNanoseconds!=null&&r.hasOwnProperty("FractionalNanoseconds")&&(i.FractionalNanoseconds=r.FractionalNanoseconds),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Hc.default.util.toJSONOptions)},t})(),Olt=ui.Metadata=(()=>{function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.MimeType="",t.encode=function(r,n){return n||(n=D7.create()),r.MimeType!=null&&Object.hasOwnProperty.call(r,"MimeType")&&n.uint32(10).string(r.MimeType),n},t.decode=function(r,n){r instanceof op||(r=op.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ui.Metadata;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.MimeType=r.string();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof ui.Metadata)return r;var n=new ui.Metadata;return r.MimeType!=null&&(n.MimeType=String(r.MimeType)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.MimeType=""),r.MimeType!=null&&r.hasOwnProperty("MimeType")&&(i.MimeType=r.MimeType),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Hc.default.util.toJSONOptions)},t})()});function Gc(t){if(t!=null)return typeof t=="number"?t&4095:(t=t.toString(),t.substring(0,1)==="0"?parseInt(t,8)&4095:parseInt(t,10)&4095)}function Zu(t){if(t==null)return;let e;if(t.secs!=null&&(e={secs:t.secs,nsecs:t.nsecs}),t.Seconds!=null&&(e={secs:t.Seconds,nsecs:t.FractionalNanoseconds}),Array.isArray(t)&&(e={secs:t[0],nsecs:t[1]}),t instanceof Date){let r=t.getTime(),n=Math.floor(r/1e3);e={secs:n,nsecs:(r-n*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw(0,E4.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var E4,$c,ZN,k9e,JN,eB,mt,gn=w(()=>{E4=A(oe(),1);QN();$c=XN,ZN=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],k9e=["directory","hamt-sharded-directory"],JN=parseInt("0644",8),eB=parseInt("0755",8);mt=class{static unmarshal(e){let r=$c.decode(e),n=$c.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}),i=new mt({type:ZN[n.Type],data:n.Data,blockSizes:n.blocksizes,mode:n.mode,mtime:n.mtime?{secs:n.mtime.Seconds,nsecs:n.mtime.FractionalNanoseconds}:void 0});return i._originalMode=n.mode||0,i}constructor(e={type:"file"}){let{type:r,data:n,blockSizes:i,hashType:s,fanout:o,mtime:a,mode:c}=e;if(r&&!ZN.includes(r))throw(0,E4.default)(new Error("Type: "+r+" is not valid"),"ERR_INVALID_TYPE");this.type=r||"file",this.data=n,this.hashType=s,this.fanout=o,this.blockSizes=i||[],this._originalMode=0,this.mode=Gc(c),a&&(this.mtime=Zu(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?eB:JN;let r=Gc(e);r!==void 0&&(this._mode=r)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&k9e.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(r=>{e+=r}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=$c.DataType.Raw;break;case"directory":e=$c.DataType.Directory;break;case"file":e=$c.DataType.File;break;case"metadata":e=$c.DataType.Metadata;break;case"symlink":e=$c.DataType.Symlink;break;case"hamt-sharded-directory":e=$c.DataType.HAMTShard;break;default:throw(0,E4.default)(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let r=this.data;(!this.data||!this.data.length)&&(r=void 0);let n;this.mode!=null&&(n=this._originalMode&4294963200|(Gc(this.mode)||0),n===JN&&!this.isDirectory()&&(n=void 0),n===eB&&this.isDirectory()&&(n=void 0));let i;if(this.mtime!=null){let o=Zu(this.mtime);o&&(i={Seconds:o.secs,FractionalNanoseconds:o.nsecs},i.FractionalNanoseconds===0&&delete i.FractionalNanoseconds)}let s={Type:e,Data:r,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:n,mtime:i};return $c.encode(s).finish()}}});function nB(t,e,r){e=e||[],r=r||0;for(var n=r;t>=L9e;)e[r++]=t&255|tB,t/=128;for(;t&B9e;)e[r++]=t&255|tB,t>>>=7;return e[r]=t|0,nB.bytes=r-n+1,e}function N7(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw N7.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&rB)<<i:(o&rB)*Math.pow(2,i),i+=7}while(o>=U9e);return N7.bytes=s-n,r}var D9e,tB,N9e,B9e,L9e,M9e,U9e,rB,q9e,F9e,K9e,j9e,V9e,z9e,H9e,$9e,G9e,W9e,Y9e,X9e,e2,iB=w(()=>{D9e=nB,tB=128,N9e=127,B9e=~N9e,L9e=Math.pow(2,31);M9e=N7,U9e=128,rB=127;q9e=Math.pow(2,7),F9e=Math.pow(2,14),K9e=Math.pow(2,21),j9e=Math.pow(2,28),V9e=Math.pow(2,35),z9e=Math.pow(2,42),H9e=Math.pow(2,49),$9e=Math.pow(2,56),G9e=Math.pow(2,63),W9e=function(t){return t<q9e?1:t<F9e?2:t<K9e?3:t<j9e?4:t<V9e?5:t<z9e?6:t<H9e?7:t<$9e?8:t<G9e?9:10},Y9e={encode:D9e,decode:M9e,encodingLength:W9e},X9e=Y9e,e2=X9e});var t2,ap,cp,A4=w(()=>{iB();t2=t=>[e2.decode(t),e2.decode.bytes],ap=(t,e,r=0)=>(e2.encode(t,e,r),e),cp=t=>e2.encodingLength(t)});var up={};Tt(up,{coerce:()=>Ys,empty:()=>sB,equals:()=>B7,fromHex:()=>Z9e,fromString:()=>L7,isBinary:()=>J9e,toHex:()=>Q9e,toString:()=>M7});var sB,Q9e,Z9e,B7,Ys,J9e,L7,M7,Ju=w(()=>{sB=new Uint8Array(0),Q9e=t=>t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),""),Z9e=t=>{let e=t.match(/../g);return e?new Uint8Array(e.map(r=>parseInt(r,16))):sB},B7=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Ys=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},J9e=t=>t instanceof ArrayBuffer||ArrayBuffer.isView(t),L7=t=>new TextEncoder().encode(t),M7=t=>new TextDecoder().decode(t)});var Qn={};Tt(Qn,{Digest:()=>lp,create:()=>el,decode:()=>mn,equals:()=>U7});var el,mn,U7,lp,li=w(()=>{Ju();A4();el=(t,e)=>{let r=e.byteLength,n=cp(t),i=n+cp(r),s=new Uint8Array(i+r);return ap(t,s,0),ap(r,s,n),s.set(e,i),new lp(t,r,e,s)},mn=t=>{let e=Ys(t),[r,n]=t2(e),[i,s]=t2(e.subarray(n)),o=e.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new lp(r,i,o,e)},U7=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&B7(t.bytes,e.bytes),lp=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}});function eSe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function f(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,b=0,m=0,_=p.length;m!==_&&p[m]===0;)m++,y++;for(var R=(_-m)*l+1>>>0,k=new Uint8Array(R);m!==_;){for(var P=p[m],x=0,D=R-1;(P!==0||x<b)&&D!==-1;D--,x++)P+=256*k[D]>>>0,k[D]=P%a>>>0,P=P/a>>>0;if(P!==0)throw new Error("Non-zero carry");b=x,m++}for(var U=R-b;U!==R&&k[U]===0;)U++;for(var M=c.repeat(y);U<R;++U)M+=t.charAt(k[U]);return M}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var b=0,m=0;p[y]===c;)b++,y++;for(var _=(p.length-y)*u+1>>>0,R=new Uint8Array(_);p[y];){var k=r[p.charCodeAt(y)];if(k===255)return;for(var P=0,x=_-1;(k!==0||P<m)&&x!==-1;x--,P++)k+=a*R[x]>>>0,R[x]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");m=P,y++}if(p[y]!==" "){for(var D=_-m;D!==_&&R[D]===0;)D++;for(var U=new Uint8Array(b+(_-D)),M=b;D!==_;)U[M++]=R[D++];return U}}}function d(p){var y=h(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:h,decode:d}}var tSe,rSe,oB,aB=w(()=>{tSe=eSe,rSe=tSe,oB=rSe});var cB,uB,lB,fB,hB,R4,tl,nSe,iSe,rn,qa=w(()=>{aB();Ju();cB=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},uB=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseDecode=n}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return fB(this,e)}},lB=class{constructor(e){this.decoders=e}or(e){return fB(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},fB=(t,e)=>new lB({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),hB=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new cB(e,r,n),this.decoder=new uB(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},R4=({name:t,prefix:e,encode:r,decode:n})=>new hB(t,e,r,n),tl=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=oB(r,e);return R4({prefix:t,name:e,encode:n,decode:s=>Ys(i(s))})},nSe=(t,e,r,n)=>{let i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let f=i[t[l]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},iSe=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},rn=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>R4({prefix:e,name:t,encode(i){return iSe(i,n,r)},decode(i){return nSe(i,n,r,t)}})});var Zo={};Tt(Zo,{base58btc:()=>bt,base58flickr:()=>sSe});var bt,sSe,wn=w(()=>{qa();bt=tl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),sSe=tl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Wc={};Tt(Wc,{base32:()=>gr,base32hex:()=>aSe,base32hexpad:()=>uSe,base32hexpadupper:()=>lSe,base32hexupper:()=>cSe,base32pad:()=>F7,base32padupper:()=>oSe,base32upper:()=>q7,base32z:()=>fSe});var gr,q7,F7,oSe,aSe,cSe,uSe,lSe,fSe,fi=w(()=>{qa();gr=rn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),q7=rn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),F7=rn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),oSe=rn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),aSe=rn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),cSe=rn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),uSe=rn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),lSe=rn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),fSe=rn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Yc={};Tt(Yc,{CID:()=>L});var L,hSe,dSe,pSe,r2,ySe,dB,pB,I4,T4,gSe,mSe,wSe,Se=w(()=>{A4();li();wn();fi();Ju();L=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:T4,byteLength:T4,code:I4,version:I4,multihash:I4,bytes:I4,_baseCache:T4,asCID:T4})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==r2)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==ySe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return L.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=el(e,r);return L.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&U7(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return dSe(r,i,e||bt.encoder);default:return pSe(r,i,e||gr.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return mSe(/^0\.0/,wSe),!!(e&&(e[pB]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof L)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:i,bytes:s}=e;return new L(r,n,i,s||dB(r,n,i.bytes))}else if(e!=null&&e[pB]===!0){let{version:r,multihash:n,code:i}=e,s=mn(n);return L.create(r,i,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==r2)throw new Error(`Version 0 CID must use dag-pb (code: ${r2}) block encoding`);return new L(e,r,n,n.bytes)}case 1:{let i=dB(e,r,n.bytes);return new L(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return L.create(0,r2,e)}static createV1(e,r){return L.create(1,e,r)}static decode(e){let[r,n]=L.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=L.inspectBytes(e),n=r.size-r.multihashSize,i=Ys(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new lp(r.multihashCode,r.digestSize,s,i);return[r.version===0?L.createV0(o):L.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[f,h]=t2(e.subarray(r));return r+=h,f},i=n(),s=r2;if(i===18?(i=0,r=0):i===1&&(s=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),c=n(),u=r+c,l=u-o;return{version:i,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,i]=hSe(e,r),s=L.decode(i);return s._baseCache.set(n,e),s}},hSe=(t,e)=>{switch(t[0]){case"Q":{let r=e||bt;return[bt.prefix,r.decode(`${bt.prefix}${t}`)]}case bt.prefix:{let r=e||bt;return[bt.prefix,r.decode(t)]}case gr.prefix:{let r=e||gr;return[gr.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},dSe=(t,e,r)=>{let{prefix:n}=r;if(n!==bt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},pSe=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},r2=112,ySe=18,dB=(t,e,r)=>{let n=cp(t),i=n+cp(e),s=new Uint8Array(i+r.byteLength);return ap(t,s,0),ap(e,s,n),s.set(r,i),s},pB=Symbol.for("@ipld/js-cid/CID"),I4={writable:!1,configurable:!1,enumerable:!0},T4={writable:!1,enumerable:!1,configurable:!1},gSe="0.0.0-dev",mSe=(t,e)=>{if(t.test(gSe))console.warn(e);else throw new Error(e)},wSe=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});function K7(t,e){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=t.length)throw new Error("protobuf: unexpected end of data");let i=t[e++];if(r+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[r,e]}function x4(t,e){let r;[r,e]=K7(t,e);let n=e+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>t.length)throw new Error("protobuf: unexpected end of data");return[t.subarray(e,n),n]}function yB(t,e){let r;return[r,e]=K7(t,e),[r&7,r>>3,e]}function _Se(t){let e={},r=t.length,n=0;for(;n<r;){let i,s;if([i,s,n]=yB(t,n),s===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=x4(t,n)}else if(s===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,n]=x4(t,n),e.Name=bSe.decode(o)}else if(s===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[e.Tsize,n]=K7(t,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function gB(t){let e=t.length,r=0,n,i=!1,s;for(;r<e;){let a,c;if([a,c,r]=yB(t,r),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,r]=x4(t,r),n&&(i=!0)}else if(c===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let u;[u,r]=x4(t,r),n.push(_Se(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(r>e)throw new Error("protobuf: (PBNode) unexpected end of data");let o={};return s&&(o.Data=s),o.Links=n||[],o}var bSe,mB=w(()=>{bSe=new TextDecoder});function ESe(t,e){let r=e.length;if(typeof t.Tsize=="number"){if(t.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(t.Tsize))throw new Error("Tsize too large for encoding");r=n2(e,r,t.Tsize)-1,e[r]=24}if(typeof t.Name=="string"){let n=bB.encode(t.Name);r-=n.length,e.set(n,r),r=n2(e,r,n.length)-1,e[r]=18}return t.Hash&&(r-=t.Hash.length,e.set(t.Hash,r),r=n2(e,r,t.Hash.length)-1,e[r]=10),e.length-r}function _B(t){let e=ASe(t),r=new Uint8Array(e),n=e;if(t.Data&&(n-=t.Data.length,r.set(t.Data,n),n=n2(r,n,t.Data.length)-1,r[n]=10),t.Links)for(let i=t.Links.length-1;i>=0;i--){let s=ESe(t.Links[i],r.subarray(0,n));n-=s,n=n2(r,n,s)-1,r[n]=18}return r}function SSe(t){let e=0;if(t.Hash){let r=t.Hash.length;e+=1+r+fp(r)}if(typeof t.Name=="string"){let r=bB.encode(t.Name).length;e+=1+r+fp(r)}return typeof t.Tsize=="number"&&(e+=1+fp(t.Tsize)),e}function ASe(t){let e=0;if(t.Data){let r=t.Data.length;e+=1+r+fp(r)}if(t.Links)for(let r of t.Links){let n=SSe(r);e+=1+n+fp(n)}return e}function n2(t,e,r){e-=fp(r);let n=e;for(;r>=vSe;)t[e++]=r&127|128,r/=128;for(;r>=128;)t[e++]=r&127|128,r>>>=7;return t[e]=r,n}function fp(t){return t%2===0&&t++,Math.floor((RSe(t)+6)/7)}function RSe(t){let e=0;return t>=wB&&(t=Math.floor(t/wB),e=32),t>=1<<16&&(t>>>=16,e+=16),t>=1<<8&&(t>>>=8,e+=8),e+ISe[t]}var bB,wB,vSe,ISe,vB=w(()=>{bB=new TextEncoder,wB=2**32,vSe=2**31;ISe=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]});function SB(t,e){if(t===e)return 0;let r=t.Name?j7.encode(t.Name):[],n=e.Name?j7.encode(e.Name):[],i=r.length,s=n.length;for(let o=0,a=Math.min(i,s);o<a;++o)if(r[o]!==n[o]){i=r[o],s=n[o];break}return i<s?-1:s<i?1:0}function EB(t,e){return!Object.keys(t).some(r=>!e.includes(r))}function AB(t){if(typeof t.asCID=="object"){let r=L.asCID(t);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if(typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Hash){let r=L.asCID(t.Hash);try{r||(typeof t.Hash=="string"?r=L.parse(t.Hash):t.Hash instanceof Uint8Array&&(r=L.decode(t.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}r&&(e.Hash=r)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof t.Name=="string"&&(e.Name=t.Name),typeof t.Tsize=="number"&&(e.Tsize=t.Tsize),e}function Zn(t){if((t instanceof Uint8Array||typeof t=="string")&&(t={Data:t}),typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Data!==void 0)if(typeof t.Data=="string")e.Data=j7.encode(t.Data);else if(t.Data instanceof Uint8Array)e.Data=t.Data;else throw new TypeError("Invalid DAG-PB form");if(t.Links!==void 0)if(Array.isArray(t.Links))e.Links=t.Links.map(AB),e.Links.sort(SB);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function V7(t){if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");if(!EB(t,TSe))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(t.Data!==void 0&&!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<t.Links.length;e++){let r=t.Links[e];if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!EB(r,xSe))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash.asCID!==r.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0&&(typeof r.Tsize!="number"||r.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&SB(r,t.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function RB(t,e=[]){return Zn({Data:t,Links:e})}function IB(t,e,r){return AB({Hash:r,Name:t,Tsize:e})}var TSe,xSe,j7,TB=w(()=>{Se();TSe=["Data","Links"],xSe=["Hash","Name","Tsize"],j7=new TextEncoder});var Kt={};Tt(Kt,{code:()=>St,createLink:()=>IB,createNode:()=>RB,decode:()=>Ft,encode:()=>lt,name:()=>PSe,prepare:()=>Zn,validate:()=>V7});function lt(t){V7(t);let e={};return t.Links&&(e.Links=t.Links.map(r=>{let n={};return r.Hash&&(n.Hash=r.Hash.bytes),r.Name!==void 0&&(n.Name=r.Name),r.Tsize!==void 0&&(n.Tsize=r.Tsize),n})),t.Data&&(e.Data=t.Data),_B(e)}function Ft(t){let e=gB(t),r={};return e.Data&&(r.Data=e.Data),e.Links&&(r.Links=e.Links.map(n=>{let i={};try{i.Hash=L.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),r}var PSe,St,xt=w(()=>{Se();mB();vB();TB();PSe="dag-pb",St=112});function xB(t){if(t===null)return"null";if(t===void 0)return"undefined";if(t===!0||t===!1)return"boolean";let e=typeof t;if(CSe.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(t))return"Array";if(kSe(t))return"Buffer";let r=DSe(t);return r||"Object"}function kSe(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}function DSe(t){let e=Object.prototype.toString.call(t).slice(8,-1);if(OSe.includes(e))return e}var CSe,OSe,PB=w(()=>{CSe=["string","number","bigint","symbol"],OSe=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]});var $,be,Mi=w(()=>{$=class{constructor(e,r,n){this.major=e,this.majorEncoded=e<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};$.uint=new $(0,"uint",!0);$.negint=new $(1,"negint",!0);$.bytes=new $(2,"bytes",!0);$.string=new $(3,"string",!0);$.array=new $(4,"array",!1);$.map=new $(5,"map",!1);$.tag=new $(6,"tag",!1);$.float=new $(7,"float",!0);$.false=new $(7,"false",!0);$.true=new $(7,"true",!0);$.null=new $(7,"null",!0);$.undefined=new $(7,"undefined",!0);$.break=new $(7,"break",!0);be=class{constructor(e,r,n){this.type=e,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function P4(t){return hp&&globalThis.Buffer.isBuffer(t)}function i2(t){return t instanceof Uint8Array?P4(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}function LB(t,e){if(P4(t)&&P4(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}function CB(t,e=1/0){let r,n=t.length,i=null,s=[];for(let o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function OB(t,e,r){let n=[];for(;e<r;){let i=t[e],s=null,o=i>239?4:i>223?3:i>191?2:1;if(e+o<=r){let a,c,u,l;switch(o){case 1:i<128&&(s=i);break;case 2:a=t[e+1],(a&192)===128&&(l=(i&31)<<6|a&63,l>127&&(s=l));break;case 3:a=t[e+1],c=t[e+2],(a&192)===128&&(c&192)===128&&(l=(i&15)<<12|(a&63)<<6|c&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:a=t[e+1],c=t[e+2],u=t[e+3],(a&192)===128&&(c&192)===128&&(u&192)===128&&(l=(i&15)<<18|(a&63)<<12|(c&63)<<6|u&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),e+=o}return z7(n)}function z7(t){let e=t.length;if(e<=kB)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=kB));return r}var hp,NSe,BSe,DB,C4,Fa,dp,NB,BB,kB,rl=w(()=>{hp=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",NSe=new TextDecoder,BSe=new TextEncoder;DB=hp?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):OB(t,e,r):(t,e,r)=>r-e>64?NSe.decode(t.subarray(e,r)):OB(t,e,r),C4=hp?t=>t.length>64?globalThis.Buffer.from(t):CB(t):t=>t.length>64?BSe.encode(t):CB(t),Fa=t=>Uint8Array.from(t),dp=hp?(t,e,r)=>P4(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),NB=hp?(t,e)=>(t=t.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),i2(globalThis.Buffer.concat(t,e))):(t,e)=>{let r=new Uint8Array(e),n=0;for(let i of t)n+i.length>r.length&&(i=i.subarray(0,r.length-n)),r.set(i,n),n+=i.length;return r},BB=hp?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);kB=4096});var LSe,O4,MB=w(()=>{rl();LSe=256,O4=class{constructor(e=LSe){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let r=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let i=r.length-(this.maxCursor-this.cursor)-1;r.set(e,i)}else{if(r){let i=r.length-(this.maxCursor-this.cursor)-1;i<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,i),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(r=BB(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let r;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=dp(n,0,this.cursor)}else r=NB(this.chunks,this.cursor);return e&&this.reset(),r}}});function Qc(t,e,r){if(t.length-e<r)throw new Error(`${Ge} not enough data for type`)}var Ge,Xc,s2,Rs=w(()=>{Ge="CBOR decode error:",Xc="CBOR encode error:",s2=[];s2[23]=1;s2[24]=2;s2[25]=3;s2[26]=5;s2[27]=9});function Is(t,e,r){Qc(t,e,1);let n=t[e];if(r.strict===!0&&n<Jn[0])throw new Error(`${Ge} integer encoded in more bytes than necessary (strict decode)`);return n}function Ts(t,e,r){Qc(t,e,2);let n=t[e]<<8|t[e+1];if(r.strict===!0&&n<Jn[1])throw new Error(`${Ge} integer encoded in more bytes than necessary (strict decode)`);return n}function xs(t,e,r){Qc(t,e,4);let n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(r.strict===!0&&n<Jn[2])throw new Error(`${Ge} integer encoded in more bytes than necessary (strict decode)`);return n}function Ps(t,e,r){Qc(t,e,8);let n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],i=t[e+4]*16777216+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],s=(BigInt(n)<<BigInt(32))+BigInt(i);if(r.strict===!0&&s<Jn[3])throw new Error(`${Ge} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(r.allowBigInt===!0)return s;throw new Error(`${Ge} integers outside of the safe integer range are not supported`)}function UB(t,e,r,n){return new be($.uint,Is(t,e+1,n),2)}function qB(t,e,r,n){return new be($.uint,Ts(t,e+1,n),3)}function FB(t,e,r,n){return new be($.uint,xs(t,e+1,n),5)}function KB(t,e,r,n){return new be($.uint,Ps(t,e+1,n),9)}function Xs(t,e){return hi(t,0,e.value)}function hi(t,e,r){if(r<Jn[0]){let n=Number(r);t.push([e|n])}else if(r<Jn[1]){let n=Number(r);t.push([e|24,n])}else if(r<Jn[2]){let n=Number(r);t.push([e|25,n>>>8,n&255])}else if(r<Jn[3]){let n=Number(r);t.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<Jn[4]){let i=[e|27,0,0,0,0,0,0,0],s=Number(n&BigInt(4294967295)),o=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=s&255,s=s>>8,i[7]=s&255,s=s>>8,i[6]=s&255,s=s>>8,i[5]=s&255,i[4]=o&255,o=o>>8,i[3]=o&255,o=o>>8,i[2]=o&255,o=o>>8,i[1]=o&255,t.push(i)}else throw new Error(`${Ge} encountered BigInt larger than allowable range`)}}var Jn,Ka=w(()=>{Mi();Rs();Jn=[24,256,65536,4294967296,BigInt("18446744073709551616")];Xs.encodedSize=function(e){return hi.encodedSize(e.value)};hi.encodedSize=function(e){return e<Jn[0]?1:e<Jn[1]?2:e<Jn[2]?3:e<Jn[3]?5:9};Xs.compareTokens=function(e,r){return e.value<r.value?-1:e.value>r.value?1:0}});function jB(t,e,r,n){return new be($.negint,-1-Is(t,e+1,n),2)}function VB(t,e,r,n){return new be($.negint,-1-Ts(t,e+1,n),3)}function zB(t,e,r,n){return new be($.negint,-1-xs(t,e+1,n),5)}function $B(t,e,r,n){let i=Ps(t,e+1,n);if(typeof i!="bigint"){let s=-1-i;if(s>=Number.MIN_SAFE_INTEGER)return new be($.negint,s,9)}if(n.allowBigInt!==!0)throw new Error(`${Ge} integers outside of the safe integer range are not supported`);return new be($.negint,H7-BigInt(i),9)}function k4(t,e){let r=e.value,n=typeof r=="bigint"?r*H7-HB:r*-1-1;hi(t,e.type.majorEncoded,n)}var H7,HB,$7=w(()=>{Mi();Ka();Rs();H7=BigInt(-1),HB=BigInt(1);k4.encodedSize=function(e){let r=e.value,n=typeof r=="bigint"?r*H7-HB:r*-1-1;return n<Jn[0]?1:n<Jn[1]?2:n<Jn[2]?3:n<Jn[3]?5:9};k4.compareTokens=function(e,r){return e.value<r.value?1:e.value>r.value?-1:0}});function o2(t,e,r,n){Qc(t,e,r+n);let i=dp(t,e+r,e+r+n);return new be($.bytes,i,r+n)}function GB(t,e,r,n){return o2(t,e,1,r)}function WB(t,e,r,n){return o2(t,e,2,Is(t,e+1,n))}function YB(t,e,r,n){return o2(t,e,3,Ts(t,e+1,n))}function XB(t,e,r,n){return o2(t,e,5,xs(t,e+1,n))}function QB(t,e,r,n){let i=Ps(t,e+1,n);if(typeof i=="bigint")throw new Error(`${Ge} 64-bit integer bytes lengths not supported`);return o2(t,e,9,i)}function D4(t){return t.encodedBytes===void 0&&(t.encodedBytes=t.type===$.string?C4(t.value):t.value),t.encodedBytes}function pp(t,e){let r=D4(e);hi(t,e.type.majorEncoded,r.length),t.push(r)}function USe(t,e){return t.length<e.length?-1:t.length>e.length?1:LB(t,e)}var N4=w(()=>{Mi();Rs();Ka();rl();pp.encodedSize=function(e){let r=D4(e);return hi.encodedSize(r.length)+r.length};pp.compareTokens=function(e,r){return USe(D4(e),D4(r))}});function a2(t,e,r,n,i){let s=r+n;Qc(t,e,s);let o=new be($.string,DB(t,e+r,e+s),s);return i.retainStringBytes===!0&&(o.byteValue=dp(t,e+r,e+s)),o}function ZB(t,e,r,n){return a2(t,e,1,r,n)}function JB(t,e,r,n){return a2(t,e,2,Is(t,e+1,n),n)}function eL(t,e,r,n){return a2(t,e,3,Ts(t,e+1,n),n)}function tL(t,e,r,n){return a2(t,e,5,xs(t,e+1,n),n)}function rL(t,e,r,n){let i=Ps(t,e+1,n);if(typeof i=="bigint")throw new Error(`${Ge} 64-bit integer string lengths not supported`);return a2(t,e,9,i,n)}var nL,G7=w(()=>{Mi();Rs();Ka();N4();rl();nL=pp});function yp(t,e,r,n){return new be($.array,n,r)}function iL(t,e,r,n){return yp(t,e,1,r)}function sL(t,e,r,n){return yp(t,e,2,Is(t,e+1,n))}function oL(t,e,r,n){return yp(t,e,3,Ts(t,e+1,n))}function aL(t,e,r,n){return yp(t,e,5,xs(t,e+1,n))}function cL(t,e,r,n){let i=Ps(t,e+1,n);if(typeof i=="bigint")throw new Error(`${Ge} 64-bit integer array lengths not supported`);return yp(t,e,9,i)}function uL(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${Ge} indefinite length items not allowed`);return yp(t,e,1,1/0)}function B4(t,e){hi(t,$.array.majorEncoded,e.value)}var W7=w(()=>{Mi();Ka();Rs();B4.compareTokens=Xs.compareTokens;B4.encodedSize=function(e){return hi.encodedSize(e.value)}});function gp(t,e,r,n){return new be($.map,n,r)}function lL(t,e,r,n){return gp(t,e,1,r)}function fL(t,e,r,n){return gp(t,e,2,Is(t,e+1,n))}function hL(t,e,r,n){return gp(t,e,3,Ts(t,e+1,n))}function dL(t,e,r,n){return gp(t,e,5,xs(t,e+1,n))}function pL(t,e,r,n){let i=Ps(t,e+1,n);if(typeof i=="bigint")throw new Error(`${Ge} 64-bit integer map lengths not supported`);return gp(t,e,9,i)}function yL(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${Ge} indefinite length items not allowed`);return gp(t,e,1,1/0)}function L4(t,e){hi(t,$.map.majorEncoded,e.value)}var Y7=w(()=>{Mi();Ka();Rs();L4.compareTokens=Xs.compareTokens;L4.encodedSize=function(e){return hi.encodedSize(e.value)}});function gL(t,e,r,n){return new be($.tag,r,1)}function mL(t,e,r,n){return new be($.tag,Is(t,e+1,n),2)}function wL(t,e,r,n){return new be($.tag,Ts(t,e+1,n),3)}function bL(t,e,r,n){return new be($.tag,xs(t,e+1,n),5)}function _L(t,e,r,n){return new be($.tag,Ps(t,e+1,n),9)}function M4(t,e){hi(t,$.tag.majorEncoded,e.value)}var X7=w(()=>{Mi();Ka();M4.compareTokens=Xs.compareTokens;M4.encodedSize=function(e){return hi.encodedSize(e.value)}});function vL(t,e,r,n){if(n.allowUndefined===!1)throw new Error(`${Ge} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new be($.null,null,1):new be($.undefined,void 0,1)}function EL(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${Ge} indefinite length items not allowed`);return new be($.break,void 0,1)}function Q7(t,e,r){if(r){if(r.allowNaN===!1&&Number.isNaN(t))throw new Error(`${Ge} NaN values are not supported`);if(r.allowInfinity===!1&&(t===1/0||t===-1/0))throw new Error(`${Ge} Infinity values are not supported`)}return new be($.float,t,e)}function SL(t,e,r,n){return Q7(Z7(t,e+1),3,n)}function AL(t,e,r,n){return Q7(J7(t,e+1),5,n)}function RL(t,e,r,n){return Q7(PL(t,e+1),9,n)}function U4(t,e,r){let n=e.value;if(n===!1)t.push([$.float.majorEncoded|zSe]);else if(n===!0)t.push([$.float.majorEncoded|HSe]);else if(n===null)t.push([$.float.majorEncoded|$Se]);else if(n===void 0)t.push([$.float.majorEncoded|GSe]);else{let i,s=!1;(!r||r.float64!==!0)&&(TL(n),i=Z7(Jo,1),n===i||Number.isNaN(n)?(Jo[0]=249,t.push(Jo.slice(0,3)),s=!0):(xL(n),i=J7(Jo,1),n===i&&(Jo[0]=250,t.push(Jo.slice(0,5)),s=!0))),s||(WSe(n),i=PL(Jo,1),Jo[0]=251,t.push(Jo.slice(0,9)))}}function TL(t){if(t===1/0)Qs.setUint16(0,31744,!1);else if(t===-1/0)Qs.setUint16(0,64512,!1);else if(Number.isNaN(t))Qs.setUint16(0,32256,!1);else{Qs.setFloat32(0,t);let e=Qs.getUint32(0),r=(e&2139095040)>>23,n=e&8388607;if(r===255)Qs.setUint16(0,31744,!1);else if(r===0)Qs.setUint16(0,(t&2147483648)>>16|n>>13,!1);else{let i=r-127;i<-24?Qs.setUint16(0,0):i<-14?Qs.setUint16(0,(e&2147483648)>>16|1<<24+i,!1):Qs.setUint16(0,(e&2147483648)>>16|i+15<<10|n>>13,!1)}}}function Z7(t,e){if(t.length-e<2)throw new Error(`${Ge} not enough data for float16`);let r=(t[e]<<8)+t[e+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,i=r&1023,s;return n===0?s=i*2**-24:n!==31?s=(i+1024)*2**(n-25):s=i===0?1/0:NaN,r&32768?-s:s}function xL(t){Qs.setFloat32(0,t,!1)}function J7(t,e){if(t.length-e<4)throw new Error(`${Ge} not enough data for float32`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function WSe(t){Qs.setFloat64(0,t,!1)}function PL(t,e){if(t.length-e<8)throw new Error(`${Ge} not enough data for float64`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}var zSe,HSe,$Se,GSe,IL,Qs,Jo,eE=w(()=>{Mi();Rs();Ka();zSe=20,HSe=21,$Se=22,GSe=23;U4.encodedSize=function(e,r){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){TL(n);let i=Z7(Jo,1);if(n===i||Number.isNaN(n))return 3;if(xL(n),i=J7(Jo,1),n===i)return 5}return 9};IL=new ArrayBuffer(9),Qs=new DataView(IL,1),Jo=new Uint8Array(IL,0);U4.compareTokens=Xs.compareTokens});function tr(t,e,r){throw new Error(`${Ge} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function q4(t){return()=>{throw new Error(`${Ge} ${t}`)}}function CL(t){switch(t.type){case $.false:return Fa([244]);case $.true:return Fa([245]);case $.null:return Fa([246]);case $.bytes:return t.value.length?void 0:Fa([64]);case $.string:return t.value===""?Fa([96]):void 0;case $.array:return t.value===0?Fa([128]):void 0;case $.map:return t.value===0?Fa([160]):void 0;case $.uint:return t.value<24?Fa([Number(t.value)]):void 0;case $.negint:if(t.value>=-24)return Fa([31-Number(t.value)])}}var Pe,ea,tE=w(()=>{Mi();Ka();$7();N4();G7();W7();Y7();X7();eE();Rs();rl();Pe=[];for(let t=0;t<=23;t++)Pe[t]=tr;Pe[24]=UB;Pe[25]=qB;Pe[26]=FB;Pe[27]=KB;Pe[28]=tr;Pe[29]=tr;Pe[30]=tr;Pe[31]=tr;for(let t=32;t<=55;t++)Pe[t]=tr;Pe[56]=jB;Pe[57]=VB;Pe[58]=zB;Pe[59]=$B;Pe[60]=tr;Pe[61]=tr;Pe[62]=tr;Pe[63]=tr;for(let t=64;t<=87;t++)Pe[t]=GB;Pe[88]=WB;Pe[89]=YB;Pe[90]=XB;Pe[91]=QB;Pe[92]=tr;Pe[93]=tr;Pe[94]=tr;Pe[95]=q4("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)Pe[t]=ZB;Pe[120]=JB;Pe[121]=eL;Pe[122]=tL;Pe[123]=rL;Pe[124]=tr;Pe[125]=tr;Pe[126]=tr;Pe[127]=q4("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)Pe[t]=iL;Pe[152]=sL;Pe[153]=oL;Pe[154]=aL;Pe[155]=cL;Pe[156]=tr;Pe[157]=tr;Pe[158]=tr;Pe[159]=uL;for(let t=160;t<=183;t++)Pe[t]=lL;Pe[184]=fL;Pe[185]=hL;Pe[186]=dL;Pe[187]=pL;Pe[188]=tr;Pe[189]=tr;Pe[190]=tr;Pe[191]=yL;for(let t=192;t<=215;t++)Pe[t]=gL;Pe[216]=mL;Pe[217]=wL;Pe[218]=bL;Pe[219]=_L;Pe[220]=tr;Pe[221]=tr;Pe[222]=tr;Pe[223]=tr;for(let t=224;t<=243;t++)Pe[t]=q4("simple values are not supported");Pe[244]=tr;Pe[245]=tr;Pe[246]=tr;Pe[247]=vL;Pe[248]=q4("simple values are not supported");Pe[249]=SL;Pe[250]=AL;Pe[251]=RL;Pe[252]=tr;Pe[253]=tr;Pe[254]=tr;Pe[255]=EL;ea=[];for(let t=0;t<24;t++)ea[t]=new be($.uint,t,1);for(let t=-1;t>=-24;t--)ea[31-t]=new be($.negint,t,1);ea[64]=new be($.bytes,new Uint8Array(0),1);ea[96]=new be($.string,"",1);ea[128]=new be($.array,0,1);ea[160]=new be($.map,0,1);ea[244]=new be($.false,!1,1);ea[245]=new be($.true,!0,1);ea[246]=new be($.null,null,1)});function QSe(){let t=[];return t[$.uint.major]=Xs,t[$.negint.major]=k4,t[$.bytes.major]=pp,t[$.string.major]=nL,t[$.array.major]=B4,t[$.map.major]=L4,t[$.tag.major]=M4,t[$.float.major]=U4,t}function F4(t,e={},r){let n=xB(t),i=e&&e.typeEncoders&&e.typeEncoders[n]||il[n];if(typeof i=="function"){let o=i(t,n,e,r);if(o!=null)return o}let s=il[n];if(!s)throw new Error(`${Xc} unsupported type: ${n}`);return s(t,n,e,r)}function ZSe(t,e){e.mapSorter&&t.sort(e.mapSorter)}function JSe(t,e){let r=Array.isArray(t[0])?t[0][0]:t[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(r.type!==n.type)return r.type.compare(n.type);let i=r.type.major,s=OL[i].compareTokens(r,n);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function kL(t,e,r,n){if(Array.isArray(e))for(let i of e)kL(t,i,r,n);else r[e.type.major](t,e,n)}function nE(t,e,r){let n=F4(t,r);if(!Array.isArray(n)&&r.quickEncodeToken){let i=r.quickEncodeToken(n);if(i)return i;let s=e[n.type.major];if(s.encodedSize){let o=s.encodedSize(n,r),a=new O4(o);if(s(a,n,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return i2(a.chunks[0])}}return rE.reset(),kL(rE,n,e,r),rE.toBytes(!0)}function es(t,e){return e=Object.assign({},XSe,e),nE(t,OL,e)}var XSe,OL,rE,c2,nl,il,iE=w(()=>{PB();Mi();MB();Rs();tE();rl();Ka();$7();N4();G7();W7();Y7();X7();eE();XSe={float64:!1,mapSorter:JSe,quickEncodeToken:CL};OL=QSe(),rE=new O4,c2=class{constructor(e,r){this.obj=e,this.parent=r}includes(e){let r=this;do if(r.obj===e)return!0;while(r=r.parent);return!1}static createCheck(e,r){if(e&&e.includes(r))throw new Error(`${Xc} object contains circular references`);return new c2(r,e)}},nl={null:new be($.null,null),undefined:new be($.undefined,void 0),true:new be($.true,!0),false:new be($.false,!1),emptyArray:new be($.array,0),emptyMap:new be($.map,0)},il={number(t,e,r,n){return!Number.isInteger(t)||!Number.isSafeInteger(t)?new be($.float,t):t>=0?new be($.uint,t):new be($.negint,t)},bigint(t,e,r,n){return t>=BigInt(0)?new be($.uint,t):new be($.negint,t)},Uint8Array(t,e,r,n){return new be($.bytes,t)},string(t,e,r,n){return new be($.string,t)},boolean(t,e,r,n){return t?nl.true:nl.false},null(t,e,r,n){return nl.null},undefined(t,e,r,n){return nl.undefined},ArrayBuffer(t,e,r,n){return new be($.bytes,new Uint8Array(t))},DataView(t,e,r,n){return new be($.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength))},Array(t,e,r,n){if(!t.length)return r.addBreakTokens===!0?[nl.emptyArray,new be($.break)]:nl.emptyArray;n=c2.createCheck(n,t);let i=[],s=0;for(let o of t)i[s++]=F4(o,r,n);return r.addBreakTokens?[new be($.array,t.length),i,new be($.break)]:[new be($.array,t.length),i]},Object(t,e,r,n){let i=e!=="Object",s=i?t.keys():Object.keys(t),o=i?t.size:s.length;if(!o)return r.addBreakTokens===!0?[nl.emptyMap,new be($.break)]:nl.emptyMap;n=c2.createCheck(n,t);let a=[],c=0;for(let u of s)a[c++]=[F4(u,r,n),F4(i?t.get(u):t[u],r,n)];return ZSe(a,r),r.addBreakTokens?[new be($.map,o),a,new be($.break)]:[new be($.map,o),a]}};il.Map=il.Object;il.Buffer=il.Uint8Array;for(let t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))il[`${t}Array`]=il.DataView});function tAe(t,e,r){let n=[];for(let i=0;i<t.value;i++){let s=l2(e,r);if(s===K4){if(t.value===1/0)break;throw new Error(`${Ge} got unexpected break to lengthed array`)}if(s===u2)throw new Error(`${Ge} found array but not enough entries (got ${i}, expected ${t.value})`);n[i]=s}return n}function rAe(t,e,r){let n=r.useMaps===!0,i=n?void 0:{},s=n?new Map:void 0;for(let o=0;o<t.value;o++){let a=l2(e,r);if(a===K4){if(t.value===1/0)break;throw new Error(`${Ge} got unexpected break to lengthed map`)}if(a===u2)throw new Error(`${Ge} found map but not enough entries (got ${o} [no key], expected ${t.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${Ge} non-string keys not supported (got ${typeof a})`);let c=l2(e,r);if(c===u2)throw new Error(`${Ge} found map but not enough entries (got ${o} [no value], expected ${t.value})`);n?s.set(a,c):i[a]=c}return n?s:i}function l2(t,e){if(t.done())return u2;let r=t.next();if(r.type===$.break)return K4;if(r.type.terminal)return r.value;if(r.type===$.array)return tAe(r,t,e);if(r.type===$.map)return rAe(r,t,e);if(r.type===$.tag){if(e.tags&&typeof e.tags[r.value]=="function"){let n=l2(t,e);return e.tags[r.value](n)}throw new Error(`${Ge} tag not supported (${r.value})`)}throw new Error("unsupported")}function Rn(t,e){if(!(t instanceof Uint8Array))throw new Error(`${Ge} data to decode must be a Uint8Array`);e=Object.assign({},eAe,e);let r=e.tokenizer||new DL(t,e),n=l2(r,e);if(n===u2)throw new Error(`${Ge} did not find any content to decode`);if(n===K4)throw new Error(`${Ge} got unexpected break`);if(!r.done())throw new Error(`${Ge} too many terminals, data makes no sense`);return n}var eAe,DL,u2,K4,sE=w(()=>{Rs();Mi();tE();eAe={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},DL=class{constructor(e,r={}){this.pos=0,this.data=e,this.options=r}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],r=ea[e];if(r===void 0){let n=Pe[e];if(!n)throw new Error(`${Ge} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let i=e&31;r=n(this.data,this.pos,i,this.options)}return this.pos+=r.encodedLength,r}},u2=Symbol.for("DONE"),K4=Symbol.for("BREAK")});var sl=w(()=>{iE();sE();Mi()});var wp={};Tt(wp,{code:()=>oE,decode:()=>cE,encode:()=>aE,name:()=>cAe});function nAe(t){if(t.asCID!==t)return null;let e=L.asCID(t);if(!e)return null;let r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new be($.tag,NL),new be($.bytes,r)]}function iAe(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function sAe(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function aAe(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return L.decode(t.subarray(1))}var NL,oAe,BL,cAe,oE,aE,cE,bp=w(()=>{sl();Se();NL=42;oAe={float64:!0,typeEncoders:{Object:nAe,undefined:iAe,number:sAe}};BL={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};BL.tags[NL]=aAe;cAe="dag-cbor",oE=113,aE=t=>es(t,oAe),cE=t=>Rn(t,BL)});var _p,LL,j4=w(()=>{li();_p=({name:t,code:e,encode:r})=>new LL(t,e,r),LL=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?el(this.code,r):r.then(n=>el(this.code,n))}else throw Error("Unknown type, must be binary type")}}});var vp=w(()=>{Se();A4();Ju();j4();li()});var Xf={};Tt(Xf,{base64:()=>V4,base64pad:()=>uAe,base64url:()=>z4,base64urlpad:()=>lAe});var V4,uAe,z4,lAe,ol=w(()=>{qa();V4=rn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),uAe=rn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),z4=rn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),lAe=rn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});function fAe(t,e){if(Array.isArray(t[0])||Array.isArray(e[0]))throw new Error(`${Xc} complex map keys are not supported`);let r=t[0],n=e[0];if(r.type!==$.string||n.type!==$.string)throw new Error(`${Xc} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${Xc} unexpected duplicate map keys, this is not supported`)}function uE(t,e){return e=Object.assign({},hAe,e),nE(t,new UL,e)}var UL,hAe,qL=w(()=>{Mi();iE();Rs();rl();UL=class extends Array{constructor(){super();this.inRecursive=[]}prefix(e){let r=this.inRecursive[this.inRecursive.length-1];r&&(r.type===$.array&&(r.elements++,r.elements!==1&&e.push([44])),r.type===$.map&&(r.elements++,r.elements!==1&&(r.elements%2===1?e.push([44]):e.push([58]))))}[$.uint.major](e,r){this.prefix(e);let n=String(r.value),i=[];for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);e.push(i)}[$.negint.major](e,r){this[$.uint.major](e,r)}[$.bytes.major](e,r){throw new Error(`${Xc} unsupported type: Uint8Array`)}[$.string.major](e,r){this.prefix(e);let n=C4(JSON.stringify(r.value));e.push(n.length>32?i2(n):n)}[$.array.major](e,r){this.prefix(e),this.inRecursive.push({type:$.array,elements:0}),e.push([91])}[$.map.major](e,r){this.prefix(e),this.inRecursive.push({type:$.map,elements:0}),e.push([123])}[$.tag.major](e,r){}[$.float.major](e,r){if(r.type.name==="break"){let o=this.inRecursive.pop();if(o){if(o.type===$.array)e.push([93]);else if(o.type===$.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(r.value===void 0)throw new Error(`${Xc} unsupported type: undefined`);if(this.prefix(e),r.type.name==="true"){e.push([116,114,117,101]);return}else if(r.type.name==="false"){e.push([102,97,108,115,101]);return}else if(r.type.name==="null"){e.push([110,117,108,108]);return}let n=String(r.value),i=[],s=!1;for(let o=0;o<n.length;o++)i[o]=n.charCodeAt(o),!s&&(i[o]===46||i[o]===101||i[o]===69)&&(s=!0);s||(i.push(46),i.push(48)),e.push(i)}};hAe={addBreakTokens:!0,mapSorter:fAe}});function lE(t,e){return e=Object.assign({tokenizer:new f2(t,e)},e),Rn(t,e)}var f2,FL=w(()=>{sE();Mi();rl();Rs();f2=class{constructor(e,r={}){this.pos=0,this.data=e,this.options=r,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${Ge} unexpected end of input at position ${this.pos}`);for(let r=0;r<e.length;r++)if(this.data[this.pos++]!==e[r])throw new Error(`${Ge} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){let e=this.pos,r=!1,n=!1,i=a=>{for(;!this.done();){let c=this.ch();if(a.includes(c))this.pos++;else break}};if(this.ch()===45&&(r=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,n=!0;else return new be($.uint,0,this.pos-e);if(i([48,49,50,51,52,53,54,55,56,57]),r&&this.pos===e+1)throw new Error(`${Ge} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${Ge} unexpected token at position ${this.pos}`);n=!0,this.pos++,i([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,i([48,49,50,51,52,53,54,55,56,57]));let s=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),o=parseFloat(s);return n?new be($.float,o,this.pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(o)?new be(o>=0?$.uint:$.negint,o,this.pos-e):new be(o>=0?$.uint:$.negint,BigInt(s),this.pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${Ge} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let s=this.pos,o=0;s<this.data.length&&o<65536;s++,o++){let a=this.data[s];if(a===92||a<32||a>=128)break;if(a===34){let c=String.fromCharCode.apply(null,this.data.subarray(this.pos,s));return this.pos=s+1,new be($.string,c,o)}}let e=this.pos,r=[],n=()=>{if(this.pos+4>=this.data.length)throw new Error(`${Ge} unexpected end of unicode escape sequence at position ${this.pos}`);let s=0;for(let o=0;o<4;o++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${Ge} unexpected unicode escape character at position ${this.pos}`);s=s*16+a,this.pos++}return s},i=()=>{let s=this.ch(),o=null,a=s>239?4:s>223?3:s>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${Ge} unexpected unicode sequence at position ${this.pos}`);let c,u,l,f;switch(a){case 1:s<128&&(o=s);break;case 2:c=this.data[this.pos+1],(c&192)===128&&(f=(s&31)<<6|c&63,f>127&&(o=f));break;case 3:c=this.data[this.pos+1],u=this.data[this.pos+2],(c&192)===128&&(u&192)===128&&(f=(s&15)<<12|(c&63)<<6|u&63,f>2047&&(f<55296||f>57343)&&(o=f));break;case 4:c=this.data[this.pos+1],u=this.data[this.pos+2],l=this.data[this.pos+3],(c&192)===128&&(u&192)===128&&(l&192)===128&&(f=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,f>65535&&f<1114112&&(o=f))}o===null?(o=65533,a=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|o&1023),r.push(o),this.pos+=a};for(;!this.done();){let s=this.ch(),o;switch(s){case 92:if(this.pos++,this.done())throw new Error(`${Ge} unexpected string termination at position ${this.pos}`);switch(o=this.ch(),this.pos++,o){case 34:case 39:case 92:case 47:r.push(o);break;case 98:r.push(8);break;case 116:r.push(9);break;case 110:r.push(10);break;case 102:r.push(12);break;case 114:r.push(13);break;case 117:r.push(n());break;default:throw new Error(`${Ge} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new be($.string,z7(r),this.pos-e);default:if(s<32)throw new Error(`${Ge} invalid control character at position ${this.pos}`);s<128?(r.push(s),this.pos++):i()}}throw new Error(`${Ge} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new be($.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new be($.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new be($.null,null,4);case 102:return this.expect([102,97,108,115,101]),new be($.false,!1,5);case 116:return this.expect([116,114,117,101]),new be($.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${Ge} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new be($.break,void 0,1);if(this.ch()!==44)throw new Error(`${Ge} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new be($.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new be($.break,void 0,1);if(this.ch()!==44)throw new Error(`${Ge} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new be($.break,void 0,1);let e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${Ge} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${Ge} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}});var KL=w(()=>{qL();FL()});var Ep={};Tt(Ep,{code:()=>hE,decode:()=>_Ae,encode:()=>bAe,name:()=>wAe});function pAe(t){if(t.asCID!==t)return null;let e=L.asCID(t);if(!e)return null;let r=e.toString();return[new be($.map,1/0,1),new be($.string,"/",1),new be($.string,r,r.length),new be($.break,void 0,1)]}function jL(t){let e=V4.encode(t).slice(1);return[new be($.map,1/0,1),new be($.string,"/",1),new be($.map,1/0,1),new be($.string,"bytes",5),new be($.string,e,e.length),new be($.break,void 0,1),new be($.break,void 0,1)]}function yAe(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function gAe(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var mAe,VL,fE,wAe,hE,bAe,_Ae,H4=w(()=>{vp();ol();sl();KL();mAe={typeEncoders:{Object:pAe,Uint8Array:jL,Buffer:jL,undefined:yAe,number:gAe}},VL=class extends f2{constructor(e,r){super(e,r);this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let e=this._next();if(e.type===$.map){let r=this._next();if(r.type===$.string&&r.value==="/"){let n=this._next();if(n.type===$.string){if(this._next().type!==$.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new be($.tag,42,0)}if(n.type===$.map){let i=this._next();if(i.type===$.string&&i.value==="bytes"){let s=this._next();if(s.type===$.string){for(let a=0;a<2;a++)if(this._next().type!==$.break)throw new Error("Invalid encoded Bytes form");let o=V4.decode(`m${s.value}`);return new be($.bytes,o,s.value.length)}this.tokenBuffer.push(s)}this.tokenBuffer.push(i)}this.tokenBuffer.push(n)}this.tokenBuffer.push(r)}return e}},fE={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};fE.tags[42]=L.parse;wAe="dag-json",hE=297,bAe=t=>uE(t,mAe),_Ae=t=>{let e=Object.assign(fE,{tokenizer:new VL(t,fE)});return lE(t,e)}});var dE=g(Sp=>{"use strict";Object.defineProperty(Sp,"__esModule",{value:!0});Sp.fromBase64url=Sp.toBase64url=void 0;var zL=(ol(),se(Xf));function vAe(t){return zL.base64url.encode(t).slice(1)}Sp.toBase64url=vAe;function EAe(t){return zL.base64url.decode(`u${t}`)}Sp.fromBase64url=EAe});var HL=g(yE=>{"use strict";Object.defineProperty(yE,"__esModule",{value:!0});var Qf=dE(),pE=(Se(),se(Yc));function SAe(t){let[e,r,n]=t;return{payload:r,signatures:[{protected:e,signature:n}],link:pE.CID.decode(Qf.fromBase64url(r))}}function AAe(t){let e={signature:Qf.fromBase64url(t.signature)};return t.header&&(e.header=t.header),t.protected&&(e.protected=Qf.fromBase64url(t.protected)),e}function RAe(t){let e=Qf.fromBase64url(t.payload);try{pE.CID.decode(e)}catch{throw new Error("Not a valid DagJWS")}return{payload:e,signatures:t.signatures.map(AAe)}}function IAe(t){let e={signature:Qf.toBase64url(t.signature)};return t.header&&(e.header=t.header),t.protected&&(e.protected=Qf.toBase64url(t.protected)),e}function TAe(t){let e={payload:Qf.toBase64url(t.payload),signatures:t.signatures.map(IAe)};return e.link=pE.CID.decode(new Uint8Array(t.payload)),e}yE.default={fromSplit:SAe,encode:RAe,decode:TAe}});var $L=g(gE=>{"use strict";Object.defineProperty(gE,"__esModule",{value:!0});var Zs=dE();function xAe(t){let[e,r,n,i,s]=t,o={ciphertext:i,iv:n,protected:e,tag:s};return r&&(o.recipients=[{encrypted_key:r}]),o}function PAe(t){let e={};return t.encrypted_key&&(e.encrypted_key=Zs.fromBase64url(t.encrypted_key)),t.header&&(e.header=t.header),e}function CAe(t){let e={ciphertext:Zs.fromBase64url(t.ciphertext),protected:Zs.fromBase64url(t.protected),iv:Zs.fromBase64url(t.iv),tag:Zs.fromBase64url(t.tag)};return t.aad&&(e.aad=Zs.fromBase64url(t.aad)),t.recipients&&(e.recipients=t.recipients.map(PAe)),t.unprotected&&(e.unprotected=t.unprotected),e}function OAe(t){let e={};return t.encrypted_key&&(e.encrypted_key=Zs.toBase64url(t.encrypted_key)),t.header&&(e.header=t.header),e}function kAe(t){let e={ciphertext:Zs.toBase64url(t.ciphertext),protected:Zs.toBase64url(t.protected),iv:Zs.toBase64url(t.iv),tag:Zs.toBase64url(t.tag)};return t.aad&&(e.aad=Zs.toBase64url(t.aad)),t.recipients&&(e.recipients=t.recipients.map(OAe)),t.unprotected&&(e.unprotected=t.unprotected),e}gE.default={fromSplit:xAe,decode:kAe,encode:CAe}});var YL={};Tt(YL,{code:()=>qAe,decode:()=>KAe,encode:()=>FAe,name:()=>UAe});function DAe(t){if(t.asCID!==t)return null;let e=L.asCID(t);if(!e)return null;let r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new be($.tag,GL),new be($.bytes,r)]}function NAe(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function BAe(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function MAe(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return L.decode(t.subarray(1))}var GL,LAe,WL,UAe,qAe,FAe,KAe,XL=w(()=>{sl();Se();GL=42;LAe={float64:!0,typeEncoders:{Object:DAe,undefined:NAe,number:BAe}};WL={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};WL.tags[GL]=MAe;UAe="dag-cbor",qAe=113,FAe=t=>es(t,LAe),KAe=t=>Rn(t,WL)});var bE=g(In=>{"use strict";var jAe=In&&In.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),VAe=In&&In.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),zAe=In&&In.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&jAe(e,t,r);return VAe(e,t),e},QL=In&&In.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(In,"__esModule",{value:!0});In.decode=In.encode=In.toGeneral=In.code=In.name=void 0;var mE=QL(HL()),wE=QL($L()),ZL=zAe((XL(),se(YL)));In.name="dag-jose";In.code=133;function JL(t){return"payload"in t&&typeof t.payload=="string"&&"signatures"in t&&Array.isArray(t.signatures)}function HAe(t){return"payload"in t&&t.payload instanceof Uint8Array&&"signatures"in t&&Array.isArray(t.signatures)}function $Ae(t){return"ciphertext"in t&&t.ciphertext instanceof Uint8Array&&"iv"in t&&t.iv instanceof Uint8Array&&"protected"in t&&t.protected instanceof Uint8Array&&"tag"in t&&t.tag instanceof Uint8Array}function eM(t){return"ciphertext"in t&&typeof t.ciphertext=="string"&&"iv"in t&&typeof t.iv=="string"&&"protected"in t&&typeof t.protected=="string"&&"tag"in t&&typeof t.tag=="string"}function tM(t){if(typeof t=="string"){let e=t.split(".");if(e.length===3)return mE.default.fromSplit(e);if(e.length===5)return wE.default.fromSplit(e);throw new Error("Not a valid JOSE string")}if(JL(t)||eM(t))return t;throw new Error("Not a valid unencoded JOSE object")}In.toGeneral=tM;function GAe(t){typeof t=="string"&&(t=tM(t));let e;if(JL(t))e=mE.default.encode(t);else if(eM(t))e=wE.default.encode(t);else throw new Error("Not a valid JOSE object");return new Uint8Array(ZL.encode(e))}In.encode=GAe;function WAe(t){let e;try{e=ZL.decode(t)}catch{throw new Error("Not a valid DAG-JOSE object")}if(HAe(e))return mE.default.decode(e);if($Ae(e))return wE.default.decode(e);throw new Error("Not a valid DAG-JOSE object")}In.decode=WAe});var h2={};Tt(h2,{identity:()=>Cs});var rM,YAe,nM,XAe,Cs,Zc=w(()=>{Ju();li();rM=0,YAe="identity",nM=Ys,XAe=t=>el(rM,nM(t)),Cs={code:rM,name:YAe,encode:nM,digest:XAe}});var _E={};Tt(_E,{identity:()=>QAe});var QAe,iM=w(()=>{qa();Ju();QAe=R4({prefix:"\0",name:"identity",encode:t=>M7(t),decode:t=>L7(t)})});var vE={};Tt(vE,{base2:()=>ZAe});var ZAe,sM=w(()=>{qa();ZAe=rn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var EE={};Tt(EE,{base8:()=>JAe});var JAe,oM=w(()=>{qa();JAe=rn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var SE={};Tt(SE,{base10:()=>eRe});var eRe,aM=w(()=>{qa();eRe=tl({prefix:"9",name:"base10",alphabet:"0123456789"})});var $4={};Tt($4,{base16:()=>tRe,base16upper:()=>rRe});var tRe,rRe,AE=w(()=>{qa();tRe=rn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),rRe=rn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var G4={};Tt(G4,{base36:()=>Ap,base36upper:()=>nRe});var Ap,nRe,d2=w(()=>{qa();Ap=tl({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),nRe=tl({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var Js={};Tt(Js,{sha256:()=>jr,sha512:()=>iRe});var cM,jr,iRe,Tn=w(()=>{j4();cM=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),jr=_p({name:"sha2-256",code:18,encode:cM("SHA-256")}),iRe=_p({name:"sha2-512",code:19,encode:cM("SHA-512")})});var ts={};Tt(ts,{code:()=>ei,decode:()=>aRe,encode:()=>oRe,name:()=>sRe});var sRe,ei,oRe,aRe,eo=w(()=>{Ju();sRe="raw",ei=85,oRe=t=>Ys(t),aRe=t=>Ys(t)});var W4={};Tt(W4,{code:()=>RE,decode:()=>hRe,encode:()=>fRe,name:()=>lRe});var cRe,uRe,lRe,RE,fRe,hRe,IE=w(()=>{cRe=new TextEncoder,uRe=new TextDecoder,lRe="json",RE=512,fRe=t=>cRe.encode(JSON.stringify(t)),hRe=t=>JSON.parse(uRe.decode(t))});var Zf,Y4,X4,Q4=w(()=>{iM();sM();oM();aM();AE();fi();d2();wn();ol();Tn();Zc();eo();IE();vp();Zf={..._E,...vE,...EE,...SE,...$4,...Wc,...G4,...Zo,...Xf},Y4={...Js,...h2},X4={raw:ts,json:W4}});var uM=w(()=>{});var al,lM,ja,cl,Rp,Ip,Va,ul=w(()=>{al=class extends Error{constructor(e="not initialized"){super(e);this.name="NotInitializedError",this.code=al.code}};al.code="ERR_NOT_INITIALIZED";lM=class extends Error{constructor(e="cannot initialize an initializing node"){super(e);this.name="AlreadyInitializingError",this.code=ja.code}};lM.code="ERR_ALREADY_INITIALIZING";ja=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e);this.name="AlreadyInitializedError",this.code=ja.code}};ja.code="ERR_ALREADY_INITIALIZED";cl=class extends Error{constructor(e="not started"){super(e);this.name="NotStartedError",this.code=cl.code}};cl.code="ERR_NOT_STARTED";Rp=class extends Error{constructor(e="cannot start, already startin"){super(e);this.name="AlreadyStartingError",this.code=Rp.code}};Rp.code="ERR_ALREADY_STARTING";Ip=class extends Error{constructor(e="cannot start, already started"){super(e);this.name="AlreadyStartedError",this.code=Ip.code}};Ip.code="ERR_ALREADY_STARTED";Va=class extends Error{constructor(e="not enabled"){super(e);this.name="NotEnabledError",this.code=Va.code}};Va.code="ERR_NOT_ENABLED"});function hM(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var fM,TE,dRe,Z4,xE=w(()=>{Q4();fM=hM("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),TE=hM("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),dRe={utf8:fM,"utf-8":fM,hex:Zf.base16,latin1:TE,ascii:TE,binary:TE,...Zf},Z4=dRe});var nn={};Tt(nn,{fromString:()=>tt});function tt(t,e="utf8"){let r=Z4[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}var dt=w(()=>{xE()});var CE=g((Mht,pM)=>{"use strict";var dM="[a-fA-F\\d:]",ll=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${dM})|(?<=${dM})(?=\\s|$))`:"",ta="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",xn="[a-fA-F\\d]{1,4}",J4=`
(?:
(?:${xn}:){7}(?:${xn}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${xn}:){6}(?:${ta}|:${xn}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${xn}:){5}(?::${ta}|(?::${xn}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${xn}:){4}(?:(?::${xn}){0,1}:${ta}|(?::${xn}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${xn}:){3}(?:(?::${xn}){0,2}:${ta}|(?::${xn}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${xn}:){2}(?:(?::${xn}){0,3}:${ta}|(?::${xn}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${xn}:){1}(?:(?::${xn}){0,4}:${ta}|(?::${xn}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${xn}){0,5}:${ta}|(?::${xn}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),pRe=new RegExp(`(?:^${ta}$)|(?:^${J4}$)`),yRe=new RegExp(`^${ta}$`),gRe=new RegExp(`^${J4}$`),PE=t=>t&&t.exact?pRe:new RegExp(`(?:${ll(t)}${ta}${ll(t)})|(?:${ll(t)}${J4}${ll(t)})`,"g");PE.v4=t=>t&&t.exact?yRe:new RegExp(`${ll(t)}${ta}${ll(t)}`,"g");PE.v6=t=>t&&t.exact?gRe:new RegExp(`${ll(t)}${J4}${ll(t)}`,"g");pM.exports=PE});var kE=g((Uht,yM)=>{"use strict";var OE=CE(),Tp=t=>OE({exact:!0}).test(t);Tp.v4=t=>OE.v4({exact:!0}).test(t);Tp.v6=t=>OE.v6({exact:!0}).test(t);Tp.version=t=>Tp(t)?Tp.v4(t)?4:6:void 0;yM.exports=Tp});var hr={};Tt(hr,{toString:()=>Xe});function Xe(t,e="utf8"){let r=Z4[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var st=w(()=>{xE()});var _M=g((Fht,bM)=>{"use strict";var NE=kE(),{toString:gM}=(st(),se(hr)),mRe=NE,DE=NE.v4,mM=NE.v6,wM=function(t,e,r){r=~~r;let n;if(DE(t))n=e||new Uint8Array(r+4),t.split(/\./g).map(function(i){n[r++]=parseInt(i,10)&255});else if(mM(t)){let i=t.split(":",8),s;for(s=0;s<i.length;s++){let o=DE(i[s]),a;o&&(a=wM(i[s]),i[s]=gM(a.slice(0,2),"base16")),a&&++s<8&&i.splice(s,0,gM(a.slice(2,4),"base16"))}if(i[0]==="")for(;i.length<8;)i.unshift("0");else if(i[i.length-1]==="")for(;i.length<8;)i.push("0");else if(i.length<8){for(s=0;s<i.length&&i[s]!=="";s++);let o=[s,"1"];for(s=9-i.length;s>0;s--)o.push("0");i.splice.apply(i,o)}for(n=e||new Uint8Array(r+16),s=0;s<i.length;s++){let o=parseInt(i[s],16);n[r++]=o>>8&255,n[r++]=o&255}}if(!n)throw Error("Invalid ip address: "+t);return n},wRe=function(t,e,r){e=~~e,r=r||t.length-e;let n=[],i,s=new DataView(t.buffer);if(r===4){for(let o=0;o<r;o++)n.push(t[e+o]);i=n.join(".")}else if(r===16){for(let o=0;o<r;o+=2)n.push(s.getUint16(e+o).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};bM.exports={isIP:mRe,isV4:DE,isV6:mM,toBytes:wM,toString:wRe}});var p2=g((Kht,EM)=>{"use strict";function rs(t){if(typeof t=="number"){if(rs.codes[t])return rs.codes[t];throw new Error("no protocol with code: "+t)}else if(typeof t=="string"){if(rs.names[t])return rs.names[t];throw new Error("no protocol with name: "+t)}throw new Error("invalid protocol id type: "+t)}var to=-1;rs.lengthPrefixedVarSize=to;rs.V=to;rs.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,to,"ip6zone"],[53,to,"dns","resolvable"],[54,to,"dns4","resolvable"],[55,to,"dns6","resolvable"],[56,to,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,to,"unix",!1,"path"],[421,to,"ipfs"],[421,to,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,to,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,to,"memory"]];rs.names={};rs.codes={};rs.table.map(t=>{let e=vM.apply(null,t);return rs.codes[e.code]=e,rs.names[e.name]=e,null});rs.object=vM;function vM(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(i)}}EM.exports=rs});var RM=g((jht,AM)=>{AM.exports=BE;var SM=128,bRe=127,_Re=~bRe,vRe=Math.pow(2,31);function BE(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw BE.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=vRe;)e[r++]=t&255|SM,t/=128;for(;t&_Re;)e[r++]=t&255|SM,t>>>=7;return e[r]=t|0,BE.bytes=r-n+1,e}});var xM=g((Vht,TM)=>{TM.exports=LE;var ERe=128,IM=127;function LE(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a||i>49)throw LE.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&IM)<<i:(o&IM)*Math.pow(2,i),i+=7}while(o>=ERe);return LE.bytes=s-n,r}});var CM=g((zht,PM)=>{var SRe=Math.pow(2,7),ARe=Math.pow(2,14),RRe=Math.pow(2,21),IRe=Math.pow(2,28),TRe=Math.pow(2,35),xRe=Math.pow(2,42),PRe=Math.pow(2,49),CRe=Math.pow(2,56),ORe=Math.pow(2,63);PM.exports=function(t){return t<SRe?1:t<ARe?2:t<RRe?3:t<IRe?4:t<TRe?5:t<xRe?6:t<PRe?7:t<CRe?8:t<ORe?9:10}});var ns=g((Hht,OM)=>{OM.exports={encode:RM(),decode:xM(),encodingLength:CM()}});var Ui={};Tt(Ui,{concat:()=>Kn});function Kn(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));let r=new Uint8Array(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}var Pn=w(()=>{});var qM=g(($ht,UM)=>{"use strict";var e6=_M(),NM=p2(),{CID:kRe}=(Se(),se(Yc)),{base32:BM}=(fi(),se(Wc)),{base58btc:DRe}=(wn(),se(Zo)),NRe=(li(),se(Qn)),xp=ns(),{toString:t6}=(st(),se(hr)),{fromString:LM}=(dt(),se(nn)),{concat:r6}=(Pn(),se(Ui));UM.exports=y2;function y2(t,e){return e instanceof Uint8Array?y2.toString(t,e):y2.toBytes(t,e)}y2.toString=function(e,r){switch(NM(e).code){case 4:case 41:return BRe(r);case 6:case 273:case 33:case 132:return MM(r).toString();case 53:case 54:case 55:case 56:case 400:case 777:return MRe(r);case 421:return qRe(r);case 444:return DM(r);case 445:return DM(r);default:return t6(r,"base16")}};y2.toBytes=function(e,r){switch(NM(e).code){case 4:return kM(r);case 41:return kM(r);case 6:case 273:case 33:case 132:return ME(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 777:return LRe(r);case 421:return URe(r);case 444:return FRe(r);case 445:return KRe(r);default:return LM(r,"base16")}};function kM(t){if(!e6.isIP(t))throw new Error("invalid ip address");return e6.toBytes(t)}function BRe(t){let e=e6.toString(t);if(!e||!e6.isIP(e))throw new Error("invalid ip address");return e}function ME(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function MM(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function LRe(t){let e=LM(t),r=Uint8Array.from(xp.encode(e.length));return r6([r,e],r.length+e.length)}function MRe(t){let e=xp.decode(t);if(t=t.slice(xp.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return t6(t)}function URe(t){let e;t[0]==="Q"||t[0]==="1"?e=NRe.decode(DRe.decode(`z${t}`)).bytes:e=kRe.parse(t).multihash.bytes;let r=Uint8Array.from(xp.encode(e.length));return r6([r,e],r.length+e.length)}function qRe(t){let e=xp.decode(t),r=t.slice(xp.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return t6(r,"base58btc")}function FRe(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let r=BM.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=ME(n);return r6([r,i],r.length+i.length)}function KRe(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let r=BM.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=ME(n);return r6([r,i],r.length+i.length)}function DM(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=t6(e,"base32"),i=MM(r);return n+":"+i}});var QM=g((Ght,XM)=>{"use strict";var KM=qM(),UE=p2(),g2=ns(),{concat:FM}=(Pn(),se(Ui)),{toString:jRe}=(st(),se(hr));XM.exports={stringToStringTuples:jM,stringTuplesToString:VM,tuplesToStringTuples:HM,stringTuplesToTuples:zM,bytesToTuples:qE,tuplesToBytes:$M,bytesToString:VRe,stringToBytes:WM,fromString:zRe,fromBytes:YM,validateBytes:FE,isValidBytes:HRe,cleanPath:n6,ParseError:KE,protoFromTuple:m2,sizeForAddr:GM};function jM(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=UE(i);if(s.size===0){e.push([i]);continue}if(n++,n>=r.length)throw KE("invalid address: "+t);if(s.path){e.push([i,n6(r.slice(n).join("/"))]);break}e.push([i,r[n]])}return e}function VM(t){let e=[];return t.map(r=>{let n=m2(r);return e.push(n.name),r.length>1&&e.push(r[1]),null}),n6(e.join("/"))}function zM(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=m2(e);return e.length>1?[r.code,KM.toBytes(r.code,e[1])]:[r.code]})}function HM(t){return t.map(e=>{let r=m2(e);return e[1]?[r.code,KM.toString(r.code,e[1])]:[r.code]})}function $M(t){return YM(FM(t.map(e=>{let r=m2(e),n=Uint8Array.from(g2.encode(r.code));return e.length>1&&(n=FM([n,e[1]])),n})))}function GM(t,e){return t.size>0?t.size/8:t.size===0?0:g2.decode(e)+g2.decode.bytes}function qE(t){let e=[],r=0;for(;r<t.length;){let n=g2.decode(t,r),i=g2.decode.bytes,s=UE(n),o=GM(s,t.slice(r+i));if(o===0){e.push([n]),r+=i;continue}let a=t.slice(r+i,r+i+o);if(r+=o+i,r>t.length)throw KE("Invalid address Uint8Array: "+jRe(t,"base16"));e.push([n,a])}return e}function VRe(t){let e=qE(t),r=HM(e);return VM(r)}function WM(t){t=n6(t);let e=jM(t),r=zM(e);return $M(r)}function zRe(t){return WM(t)}function YM(t){let e=FE(t);if(e)throw e;return Uint8Array.from(t)}function FE(t){try{qE(t)}catch(e){return e}}function HRe(t){return FE(t)===void 0}function n6(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function KE(t){return new Error("Error parsing address: "+t)}function m2(t){return UE(t[0])}});var Ei={};Tt(Ei,{equals:()=>ro});function ro(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var bn=w(()=>{});var yt=g((Wht,eU)=>{"use strict";var ra=QM(),Pp=p2(),ZM=ns(),{CID:$Re}=(Se(),se(Yc)),{base58btc:GRe}=(wn(),se(Zo)),WRe=oe(),YRe=Symbol.for("nodejs.util.inspect.custom"),{toString:i6}=(st(),se(hr)),{equals:XRe}=(bn(),se(Ei)),jE=new Map,JM=Symbol.for("@multiformats/js-multiaddr/multiaddr"),qi=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,JM,{value:!0}),e instanceof Uint8Array)this.bytes=ra.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=ra.fromString(e)}else if(qi.isMultiaddr(e))this.bytes=ra.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return ra.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},r=this.toString().split("/");return e.family=r[1]==="ip4"?4:6,e.host=r[2],e.transport=r[3],e.port=parseInt(r[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},Pp(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let i=ZM.decode(r,n),s=ZM.decode.bytes,o=Pp(i);n+=ra.sizeForAddr(o,r.slice(n+s))+s,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return ra.bytesToTuples(this.bytes)}stringTuples(){let e=ra.bytesToTuples(this.bytes);return ra.tuplesToStringTuples(e)}encapsulate(e){return e=new qi(e),new qi(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new qi(n.slice(0,i))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new qi(ra.tuplesToBytes(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===Pp.names.ipfs.code).pop();if(r&&r[1]){let n=r[1];return n[0]==="Q"||n[0]==="1"?i6(GRe.decode(`z${n}`),"base58btc"):i6($Re.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>!!Pp(r[0]).path)[0][1],e||(e=null)}catch{e=null}return e}equals(e){return XRe(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(i=>i.resolvable);if(!e)return[this];let r=jE.get(e.name);if(!r)throw WRe(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this)).map(i=>new qi(i))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),n=this.toString().split("/").slice(1);if(n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(n[2]!=="tcp"&&n[2]!=="udp")throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:n[1],port:parseInt(n[3])}}isThinWaistAddress(e){let r=(e||this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(!e)throw new Error("requires node address object");if(!r)throw new Error("requires transport protocol");let n;switch(e.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new qi("/"+[n,e.address,r,e.port].join("/"))}static isName(e){return qi.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return e instanceof qi||Boolean(e&&e[JM])}[YRe](){return"<Multiaddr "+i6(this.bytes,"base16")+" - "+ra.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+i6(this.bytes,"base16")+" - "+ra.bytesToString(this.bytes)+">"}};qi.protocols=Pp;qi.resolvers=jE;function QRe(t){return new qi(t)}eU.exports={Multiaddr:qi,multiaddr:QRe,protocols:Pp,resolvers:jE}});var eh=g((Yht,lU)=>{"use strict";var{Multiaddr:VE}=yt(),nU=at("dns4"),iU=at("dns6"),sU=at("dnsaddr"),Jf=Si(at("dns"),sU,nU,iU),w2=Si(at("ip4"),at("ip6")),Np=Si(Et(w2,at("tcp")),Et(Jf,at("tcp"))),zE=Et(w2,at("udp")),oU=Et(zE,at("utp")),aU=Et(zE,at("quic")),Op=Si(Et(Np,at("ws")),Et(Jf,at("ws"))),kp=Si(Et(Np,at("wss")),Et(Jf,at("wss"))),s6=Si(Et(Np,at("http")),Et(w2,at("http")),Et(Jf,at("http"))),o6=Si(Et(Np,at("https")),Et(w2,at("https")),Et(Jf,at("https"))),HE=Si(Et(Op,at("p2p-webrtc-star"),at("p2p")),Et(kp,at("p2p-webrtc-star"),at("p2p")),Et(Op,at("p2p-webrtc-star")),Et(kp,at("p2p-webrtc-star"))),ZRe=Si(Et(Op,at("p2p-websocket-star"),at("p2p")),Et(kp,at("p2p-websocket-star"),at("p2p")),Et(Op,at("p2p-websocket-star")),Et(kp,at("p2p-websocket-star"))),$E=Si(Et(s6,at("p2p-webrtc-direct"),at("p2p")),Et(o6,at("p2p-webrtc-direct"),at("p2p")),Et(s6,at("p2p-webrtc-direct")),Et(o6,at("p2p-webrtc-direct"))),Dp=Si(Op,kp,s6,o6,HE,$E,Np,oU,aU,Jf),JRe=Si(Et(Dp,at("p2p-stardust"),at("p2p")),Et(Dp,at("p2p-stardust"))),fl=Si(Et(Dp,at("p2p")),HE,$E,at("p2p")),tU=Si(Et(fl,at("p2p-circuit"),fl),Et(fl,at("p2p-circuit")),Et(at("p2p-circuit"),fl),Et(Dp,at("p2p-circuit")),Et(at("p2p-circuit"),Dp),at("p2p-circuit")),cU=()=>Si(Et(tU,cU),tU),Cp=cU(),rU=Si(Et(Cp,fl,Cp),Et(fl,Cp),Et(Cp,fl),Cp,fl);lU.exports={DNS:Jf,DNS4:nU,DNS6:iU,DNSADDR:sU,IP:w2,TCP:Np,UDP:zE,QUIC:aU,UTP:oU,HTTP:s6,HTTPS:o6,WebSockets:Op,WebSocketsSecure:kp,WebSocketStar:ZRe,WebRTCStar:HE,WebRTCDirect:$E,Reliable:Dp,Stardust:JRe,Circuit:Cp,P2P:rU,IPFS:rU};function uU(t){function e(r){if(!VE.isMultiaddr(r))try{r=new VE(r)}catch{return!1}let n=t(r.protoNames());return n===null?!1:n===!0||n===!1?n:n.length===0}return e}function Et(...t){function e(r){if(r.length<t.length)return null;let n=r;return t.some(i=>(n=typeof i=="function"?i().partialMatch(r):i.partialMatch(r),Array.isArray(n)&&(r=n),n===null)),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:uU(e),partialMatch:e}}function Si(...t){function e(n){let i=null;return t.some(s=>{let o=typeof s=="function"?s().partialMatch(n):s.partialMatch(n);return o?(i=o,!0):!1}),i}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:uU(e),partialMatch:e}}function at(t){let e=t;function r(i){let s;if(typeof i=="string"||i instanceof Uint8Array)try{s=new VE(i)}catch{return!1}else s=i;let o=s.protoNames();return o.length===1&&o[0]===e}function n(i){return i.length===0?null:i[0]===e?i.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:n}}});var GE=g((Xht,dU)=>{"use strict";var eIe=typeof navigator<"u"&&navigator.product==="ReactNative";function tIe(){return eIe?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}var b2=self.URL,fU=tIe(),hU=class{constructor(e="",r=fU){this.super=new b2(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return b2.createObjectURL(e)}static revokeObjectURL(e){b2.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function rIe(t){if(typeof t=="string")return new b2(t).toString();if(!(t instanceof b2)){let e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",s=t.host||"",o=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",u=t.pathname||"",l=t.path||u+a;return`${i}${e||r}${s||o+n}${l}${c}`}}dU.exports={URLWithLegacySupport:hU,URLSearchParams:self.URLSearchParams,defaultBase:fU,format:rIe}});var gU=g((Qht,yU)=>{"use strict";var{URLWithLegacySupport:pU,format:nIe}=GE();yU.exports=(t,e={},r={},n)=>{let i=e.protocol?e.protocol.replace(":",""):"http";i=(r[i]||n||i)+":";let s;try{s=new pU(t)}catch{s={}}let o=Object.assign({},e,{protocol:i||s.protocol,host:e.host||s.host});return new pU(t,nIe(o)).toString()}});var a6=g((Zht,mU)=>{"use strict";var{URLWithLegacySupport:iIe,format:sIe,URLSearchParams:oIe,defaultBase:aIe}=GE(),cIe=gU();mU.exports={URL:iIe,URLSearchParams:oIe,format:sIe,relative:cIe,defaultBase:aIe}});var Lp=g((Jht,CU)=>{"use strict";var{base58btc:uIe}=(wn(),se(Zo)),{base32:lIe}=(fi(),se(Wc)),fIe=(li(),se(Qn)),{Multiaddr:wU}=yt(),hIe=eh(),{CID:WE}=(Se(),se(Yc)),{URL:dIe}=a6(),{toString:pIe}=(st(),se(hr)),YE=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,Bp=/^\/(ip[fn]s)\/([^/?#]+)/,vU=1,EU=2,E2=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,SU=1,AU=2,yIe=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function gIe(t){let e=XE(t);try{fIe.decode(uIe.decode("z"+e))}catch{return!1}return!0}function mIe(t){try{lIe.decode(t)}catch{return!1}return!0}function _2(t){try{return typeof t=="string"?Boolean(WE.parse(t)):t instanceof Uint8Array?Boolean(WE.decode(t)):Boolean(WE.asCID(t))}catch{return!1}}function RU(t){if(!t)return!1;if(wU.isMultiaddr(t))return!0;try{return new wU(t),!0}catch{return!1}}function wIe(t){return RU(t)&&hIe.P2P.matches(t)}function v2(t,e,r=vU,n=EU){let i=XE(t);if(!i)return!1;let s=i.match(e);if(!s||s[r]!=="ipfs")return!1;let o=s[n];return o&&e===E2&&(o=o.toLowerCase()),_2(o)}function c6(t,e,r=vU,n=EU){let i=XE(t);if(!i)return!1;let s=i.match(e);if(!s||s[r]!=="ipns")return!1;let o=s[n];if(o&&e===E2){if(o=o.toLowerCase(),_2(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:a}=new dIe(`http://${o}`);return yIe.test(a)}catch{return!1}}return!0}function IU(t){return typeof t=="string"}function XE(t){return t instanceof Uint8Array?pIe(t,"base58btc"):IU(t)?t:!1}var QE=t=>v2(t,E2,AU,SU),ZE=t=>c6(t,E2,AU,SU),TU=t=>QE(t)||ZE(t),xU=t=>v2(t,YE)||QE(t),PU=t=>c6(t,YE)||ZE(t),bU=t=>xU(t)||PU(t)||TU(t),_U=t=>v2(t,Bp)||c6(t,Bp);CU.exports={multihash:gIe,multiaddr:RU,peerMultiaddr:wIe,cid:_2,base32cid:t=>mIe(t)&&_2(t),ipfsSubdomain:QE,ipnsSubdomain:ZE,subdomain:TU,subdomainGatewayPattern:E2,ipfsUrl:xU,ipnsUrl:PU,url:bU,pathGatewayPattern:YE,ipfsPath:t=>v2(t,Bp),ipnsPath:t=>c6(t,Bp),path:_U,pathPattern:Bp,urlOrPath:t=>bU(t)||_U(t),cidPath:t=>IU(t)&&!_2(t)&&v2(`/ipfs/${t}`,Bp)}});var OU,kU=w(()=>{OU="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"});var e9={};Tt(e9,{customAlphabet:()=>bIe,customRandom:()=>NU,nanoid:()=>JE,random:()=>DU,urlAlphabet:()=>OU});var DU,NU,bIe,JE,u6=w(()=>{kU();DU=t=>crypto.getRandomValues(new Uint8Array(t)),NU=(t,e,r)=>{let n=(2<<Math.log(t.length-1)/Math.LN2)-1,i=-~(1.6*n*e/t.length);return(s=e)=>{let o="";for(;;){let a=r(i),c=i;for(;c--;)if(o+=t[a[c]&n]||"",o.length===s)return o}}},bIe=(t,e=21)=>NU(t,e,DU),JE=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,r)=>(r&=63,r<36?e+=r.toString(36):r<62?e+=(r-26).toString(36).toUpperCase():r>62?e+="-":e+="_",e),"")});var Mp={};Tt(Mp,{Key:()=>Oe});function _Ie(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function vIe(t){let e=t.split(":");return e[e.length-1]}function EIe(t){return[].concat(...t)}var Jc,BU,l6,Oe,Vr=w(()=>{u6();st();dt();Jc="/",BU=new TextEncoder().encode(Jc),l6=BU[0],Oe=class{constructor(e,r){if(typeof e=="string")this._buf=tt(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==l6)throw new Error("Invalid key")}toString(e="utf8"){return Xe(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Oe(e.join(Jc))}static random(){return new Oe(JE().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new Oe(e):e.uint8Array?new Oe(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=BU),this._buf[0]!==l6){let e=new Uint8Array(this._buf.byteLength+1);e.fill(l6,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===l6;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let i=0;i<r.length;i++){if(n.length<i+1)return!1;let s=r[i],o=n[i];if(s<o)return!0;if(s>o)return!1}return r.length<n.length}reverse(){return Oe.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Jc).slice(1)}type(){return _Ie(this.baseNamespace())}name(){return vIe(this.baseNamespace())}instance(e){return new Oe(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Jc)||(e+=Jc),e+=this.type(),new Oe(e)}parent(){let e=this.list();return e.length===1?new Oe(Jc):new Oe(e.slice(0,-1).join(Jc))}child(e){return this.toString()===Jc?e:e.toString()===Jc?this:new Oe(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Oe.withNamespaces([...this.namespaces(),...EIe(e.map(r=>r.namespaces()))])}}});var MU=g((sdt,LU)=>{"use strict";LU.exports=function(){return Date.now()}});var S2=g((odt,qU)=>{"use strict";var f6=MU(),UU=class{constructor(e,r,n){let i=this;this._started=f6(),this._rescheduled=0,this._scheduled=r,this._args=n,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(f6()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,r)}reschedule(e){e||(e=this._scheduled);let r=f6();r+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=r,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=f6(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function SIe(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new UU(arguments[0],arguments[1],t)}qU.exports=SIe});var za=g((adt,KU)=>{"use strict";var{AbortController:AIe}=globalThis,FU=S2(),h6=class extends AIe{constructor(e){super();this._ms=e,this._timer=FU(()=>this.abort(),e),Object.setPrototypeOf(this,h6.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=FU(()=>this.abort(),this._ms)}};KU.exports={TimeoutController:h6}});var na=g((cdt,t9)=>{function jU(t){let e=new globalThis.AbortController;function r(){e.abort();for(let n of t)!n||!n.removeEventListener||n.removeEventListener("abort",r)}for(let n of t)if(!(!n||!n.addEventListener)){if(n.aborted){r();break}n.addEventListener("abort",r)}return e.signal}t9.exports=jU;t9.exports.anySignal=jU});function At(t="",e="ms"){var r=null;return t=(t+"").replace(/(\d)[,_](\d)/g,"$1$2"),t.replace(RIe,function(n,i,s){s=VU(s),s&&(r=(r||0)+parseFloat(i,10)*s)}),r&&r/(VU(e)||1)}function VU(t){return At[t]||At[t.toLowerCase().replace(/s$/,"")]}var RIe,hl,A2=w(()=>{RIe=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;At.nanosecond=At.ns=1/1e6;At.\u00B5s=At.\u03BCs=At.us=At.microsecond=1/1e3;At.millisecond=At.ms=At[""]=1;At.second=At.sec=At.s=At.ms*1e3;At.minute=At.min=At.m=At.s*60;At.hour=At.hr=At.h=At.m*60;At.day=At.d=At.h*24;At.week=At.wk=At.w=At.d*7;At.month=At.b=At.d*(365.25/12);At.year=At.yr=At.y=At.d*365.25;hl=At});var dl,zU=w(()=>{dl=class extends Error{constructor(e="request timed out"){super(e);this.name="TimeoutError",this.code=dl.code}};dl.code="ERR_TIMEOUT"});function Q(t,e){return(...r)=>{let n=r[e??r.length-1];if(!n||!n.timeout)return t(...r);let i=typeof n.timeout=="string"?hl(n.timeout):n.timeout,s=new HU.TimeoutController(i);n.signal=(0,$U.anySignal)([n.signal,s.signal]);let o=t(...r),a=new Promise((l,f)=>{s.signal.addEventListener("abort",()=>{f(new dl)})}),c=Date.now(),u=()=>{if(s.signal.aborted)throw new dl;if(Date.now()-c>i)throw s.abort(),new dl};return o[Symbol.asyncIterator]?async function*(){let l=o[Symbol.asyncIterator]();try{for(;;){let{value:f,done:h}=await Promise.race([l.next(),a]);if(h)break;u(),yield f}}catch(f){throw u(),f}finally{s.clear(),l.return&&l.return()}}():(async()=>{try{let l=await Promise.race([o,a]);return u(),l}catch(l){throw u(),l}finally{s.clear()}})()}}var HU,$U,Ce=w(()=>{HU=A(za(),1),$U=A(na(),1);A2();zU()});function eu(t){if(t instanceof Uint8Array)try{t=L.decode(t)}catch(i){throw(0,r9.default)(i,"ERR_INVALID_CID")}let e=L.asCID(t);if(e)return{cid:e,path:void 0};t=t.toString(),t.startsWith(GU)&&(t=t.substring(GU.length));let r=t.split("/"),n;try{e=L.parse(r.shift()||"")}catch(i){throw(0,r9.default)(i,"ERR_INVALID_CID")}return r.length&&(n=`/${r.join("/")}`),{cid:e,path:n}}var r9,GU,R2=w(()=>{Se();r9=A(oe(),1),GU="/ipfs/"});var WU,d6,IIe,p6,I2,T2,YU,Up,pl,n9,XU,yl,ti=w(()=>{WU=A(Lp(),1);Se();Vr();d6=A(oe(),1);Ce();R2();xt();IIe="ERR_BAD_PATH",p6="This command must be run in online mode. Try running 'ipfs daemon' first.",I2=new Oe("/local/filesroot"),T2=262144,YU=t=>{if(L.asCID(t))return`/ipfs/${t}`;let r=t.toString();try{return`/ipfs/${L.parse(r)}`}catch{}if(WU.default.path(r))return r;throw(0,d6.default)(new Error(`invalid path: ${t}`),IIe)},Up=t=>t instanceof Uint8Array?L.decode(t).toString():(t=t.toString(),t.indexOf("/ipfs/")===0&&(t=t.substring(6)),t.charAt(t.length-1)==="/"&&(t=t.substring(0,t.length-1)),t),pl=async function(t,e,r,n={}){let{cid:i,path:s}=eu(r);s&&(n.path=s);let o=i,a=n.path||"";if(a.startsWith("/")&&(a=a.substring(1)),n.path)try{for await(let{value:c,remainderPath:u}of yl(i,n.path,e,t,{signal:n.signal})){if(!L.asCID(c))break;a=u,o=c}}catch(c){throw c.message.startsWith("Object has no property")&&(c.message=`no link named "${a.split("/")[0]}" under ${o}`,c.code="ERR_NO_LINK"),c}return{cid:o,remainderPath:a||""}},n9=t=>{if(t.type!=="file"&&t.type!=="directory"&&t.type!=="raw")throw new Error(`Unknown node type '${t.type}'`);let e={cid:t.cid,path:t.path,name:t.name,size:t.size,type:"file"};return t.type==="directory"&&(e.type="dir"),t.type==="file"&&(e.size=t.unixfs.fileSize()),(t.type==="file"||t.type==="directory")&&(e.mode=t.unixfs.mode,t.unixfs.mtime!==void 0&&(e.mtime=t.unixfs.mtime)),e},XU=Q(async(t,e)=>await t),yl=async function*(t,e,r,n,i){let s=async u=>{let l=await r.getCodec(u.code),f=await n.blocks.get(u,i);return l.decode(f)},o=e.split("/").filter(Boolean),a=await s(t),c=t;for(;o.length;){let u=o.shift();if(!u)throw(0,d6.default)(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(t.code===St&&Array.isArray(a.Links)){let l=a.Links.find(f=>f.Name===u);if(l){yield{value:l.Hash,remainderPath:o.join("/")},a=await s(l.Hash),c=l.Hash;continue}}if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw(0,d6.default)(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");L.asCID(a)&&(c=a,a=await s(a))}yield{value:a,remainderPath:""}}});var Fi,y6=w(()=>{ul();ti();Fi=class{static create({start:e,stop:r}){return new Fi(e,r)}static async start(e,r){let{state:n,activate:i}=e;switch(n.status){case"stopped":try{let s=i(r);e.state={status:"starting",ready:s};let o=await s;return e.state={status:"started",value:o},o}catch(s){throw e.state={status:"stopped"},s}case"starting":throw new Rp;case"started":throw new Ip;case"stopping":return await n.ready,await Fi.start(e,r);default:return Fi.panic(e)}}static async stop(e){let{state:r,deactivate:n}=e;switch(r.status){case"stopped":break;case"starting":{try{await r.ready}catch{}return await Fi.stop(e)}case"stopping":return await r.ready;case"started":{n&&await n(r.value),e.state={status:"stopped"};break}default:Fi.panic(r)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},r){switch(e.status){case"started":return e.value;case"starting":return await XU(e.ready,r);default:throw new cl}}static panic({state:e}){let r=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${r}, should never happen if you see this please report a bug`)}constructor(e,r){this.activate=e,this.deactivate=r,this.state={status:"stopped"}}async use(e){return await Fi.use(this,e)}try(){return Fi.try(this)}}});function QU({network:t,preload:e,peerId:r,keychain:n,repo:i,ipns:s,mfsPreload:o,print:a,hashers:c,options:u}){return async()=>{let{libp2p:f}=await Fi.start(t,{peerId:r,repo:i,print:a,hashers:c,options:u});await Promise.all([s.startOnline({keychain:n,libp2p:f,peerId:r,repo:i}),e.start(),o.start()])}}var ZU=w(()=>{y6()});function JU({network:t,preload:e,ipns:r,repo:n,mfsPreload:i}){return async()=>{await Promise.all([e.stop(),r.stop(),i.stop()]),await Fi.stop(t),await n.close()}}var eq=w(()=>{y6()});var qp=g((xdt,tq)=>{tq.exports=function(t){if(!t)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,r=Object.create(null),n=Object.create(null);function i(s,o){r[s]=o,e++,e>=t&&(e=0,n=r,r=Object.create(null))}return{has:function(s){return r[s]!==void 0||n[s]!==void 0},remove:function(s){r[s]!==void 0&&(r[s]=void 0),n[s]!==void 0&&(n[s]=void 0)},get:function(s){var o=r[s];if(o!==void 0)return o;if((o=n[s])!==void 0)return i(s,o),o},set:function(s,o){r[s]!==void 0?r[s]=o:i(s,o)},clear:function(){r=Object.create(null),n=Object.create(null)}}}});var rq,i9,nq=w(()=>{rq=A(qp(),1),i9=class{constructor(e){this.lru=(0,rq.default)(e)}get(e){let r=this.lru.get(e);if(r){if(r.expire&&r.expire<Date.now()){this.lru.remove(e);return}return r.value}}set(e,r,n){this.lru.set(e,{value:r,expire:Date.now()+n})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}});var sq=g((Cdt,s9)=>{"use strict";var TIe=Object.prototype.hasOwnProperty,Ki="~";function x2(){}Object.create&&(x2.prototype=Object.create(null),new x2().__proto__||(Ki=!1));function xIe(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function iq(t,e,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new xIe(r,n||t,i),o=Ki?Ki+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(t._events[o]=s,t._eventsCount++),t}function g6(t,e){--t._eventsCount===0?t._events=new x2:delete t._events[e]}function Ai(){this._events=new x2,this._eventsCount=0}Ai.prototype.eventNames=function(){var e=[],r,n;if(this._eventsCount===0)return e;for(n in r=this._events)TIe.call(r,n)&&e.push(Ki?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};Ai.prototype.listeners=function(e){var r=Ki?Ki+e:e,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o};Ai.prototype.listenerCount=function(e){var r=Ki?Ki+e:e,n=this._events[r];return n?n.fn?1:n.length:0};Ai.prototype.emit=function(e,r,n,i,s,o){var a=Ki?Ki+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,f;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,n),!0;case 4:return c.fn.call(c.context,r,n,i),!0;case 5:return c.fn.call(c.context,r,n,i,s),!0;case 6:return c.fn.call(c.context,r,n,i,s,o),!0}for(f=1,l=new Array(u-1);f<u;f++)l[f-1]=arguments[f];c.fn.apply(c.context,l)}else{var h=c.length,d;for(f=0;f<h;f++)switch(c[f].once&&this.removeListener(e,c[f].fn,void 0,!0),u){case 1:c[f].fn.call(c[f].context);break;case 2:c[f].fn.call(c[f].context,r);break;case 3:c[f].fn.call(c[f].context,r,n);break;case 4:c[f].fn.call(c[f].context,r,n,i);break;default:if(!l)for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c[f].fn.apply(c[f].context,l)}}return!0};Ai.prototype.on=function(e,r,n){return iq(this,e,r,n,!1)};Ai.prototype.once=function(e,r,n){return iq(this,e,r,n,!0)};Ai.prototype.removeListener=function(e,r,n,i){var s=Ki?Ki+e:e;if(!this._events[s])return this;if(!r)return g6(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!i||o.once)&&(!n||o.context===n)&&g6(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==r||i&&!o[a].once||n&&o[a].context!==n)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:g6(this,s)}return this};Ai.prototype.removeAllListeners=function(e){var r;return e?(r=Ki?Ki+e:e,this._events[r]&&g6(this,r)):(this._events=new x2,this._eventsCount=0),this};Ai.prototype.off=Ai.prototype.removeListener;Ai.prototype.addListener=Ai.prototype.on;Ai.prefixed=Ki;Ai.EventEmitter=Ai;typeof s9<"u"&&(s9.exports=Ai)});var aq=g((Odt,oq)=>{"use strict";oq.exports=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(n=>{n(e())}).then(()=>r),r=>new Promise(n=>{n(e())}).then(()=>{throw r})))});var uq=g((kdt,m6)=>{"use strict";var PIe=aq(),o9=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},cq=(t,e,r)=>new Promise((n,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(t);return}let s=setTimeout(()=>{if(typeof r=="function"){try{n(r())}catch(c){i(c)}return}let o=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,a=r instanceof Error?r:new o9(o);typeof t.cancel=="function"&&t.cancel(),i(a)},e);PIe(t.then(n,i),()=>{clearTimeout(s)})});m6.exports=cq;m6.exports.default=cq;m6.exports.TimeoutError=o9});var lq=g(a9=>{"use strict";Object.defineProperty(a9,"__esModule",{value:!0});function CIe(t,e,r){let n=0,i=t.length;for(;i>0;){let s=i/2|0,o=n+s;r(t[o],e)<=0?(n=++o,i-=s+1):i=s}return n}a9.default=CIe});var hq=g(c9=>{"use strict";Object.defineProperty(c9,"__esModule",{value:!0});var OIe=lq(),fq=class{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);let n={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(n);return}let i=OIe.default(this._queue,n,(s,o)=>o.priority-s.priority);this._queue.splice(i,0,n)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}};c9.default=fq});var ia=g(u9=>{"use strict";Object.defineProperty(u9,"__esModule",{value:!0});var kIe=sq(),dq=uq(),DIe=hq(),w6=()=>{},NIe=new dq.TimeoutError,pq=class extends kIe{constructor(e){var r,n,i,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=w6,this._resolveIdle=w6,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:DIe.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=w6,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=w6,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((n,i)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&r.timeout===void 0?e():dq.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&i(NIe)});n(await o)}catch(o){i(o)}this._next()};this._queue.enqueue(s,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};u9.default=pq});var l9=g(b6=>{"use strict";var yq=class extends Error{constructor(e="Request timed out"){super(e);this.name="TimeoutError"}};b6.TimeoutError=yq;var gq=class extends Error{constructor(e="The operation was aborted."){super(e);this.name="AbortError"}};b6.AbortError=gq;var mq=class extends Error{constructor(e){super(e.statusText);this.name="HTTPError",this.response=e}};b6.HTTPError=mq});var wq=g(()=>{});var P2=g((Fp,bq)=>{"use strict";var BIe=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof tu<"u")return tu;throw new Error("unable to locate globalThis object")},tu=BIe();bq.exports=Fp=tu.fetch;tu.fetch&&(Fp.default=tu.fetch.bind(tu));Fp.Headers=tu.Headers;Fp.Request=tu.Request;Fp.Response=tu.Response});var h9=g((qdt,f9)=>{"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?f9.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:f9.exports={default:P2().default,Headers:P2().Headers,Request:P2().Request,Response:P2().Response}});var _q=g((Fdt,d9)=>{"use strict";var{isElectronMain:LIe}=Xy();LIe?d9.exports=wq():d9.exports=h9()});var Aq=g((Kdt,Sq)=>{"use strict";var{TimeoutError:MIe,AbortError:UIe}=l9(),{Response:vq,Request:qIe,Headers:p9,default:FIe}=_q(),KIe=(t,e={})=>{let r=new XMLHttpRequest;r.open(e.method||"GET",t.toString(),!0);let{timeout:n,headers:i}=e;if(n&&n>0&&n<1/0&&(r.timeout=n),e.overrideMimeType!=null&&r.overrideMimeType(e.overrideMimeType),i)for(let[s,o]of new p9(i))r.setRequestHeader(s,o);return e.signal&&(e.signal.onabort=()=>r.abort()),e.onUploadProgress&&(r.upload.onprogress=e.onUploadProgress),r.responseType="arraybuffer",new Promise((s,o)=>{let a=c=>{switch(c.type){case"error":{s(vq.error());break}case"load":{s(new Eq(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:zIe(r.getAllResponseHeaders())}));break}case"timeout":{o(new MIe);break}case"abort":{o(new UIe);break}default:break}};r.onerror=a,r.onload=a,r.ontimeout=a,r.onabort=a,r.send(e.body)})},jIe=FIe,VIe=(t,e={})=>e.onUploadProgress!=null?KIe(t,e):jIe(t,e),zIe=t=>{let e=new p9;for(let r of t.trim().split(/[\r\n]+/)){let n=r.indexOf(": ");n>0&&e.set(r.slice(0,n),r.slice(n+1))}return e},Eq=class extends vq{constructor(e,r,n){super(r,n);Object.defineProperty(this,"url",{value:e})}};Sq.exports={fetch:VIe,Request:qIe,Headers:p9}});var Kp=g((jdt,Cq)=>{"use strict";var{fetch:HIe,Request:$Ie,Headers:GIe}=Aq(),{TimeoutError:y9,HTTPError:xq}=l9(),Rq=Wu().bind({ignoreUndefined:!0}),{URL:Iq,URLSearchParams:Tq}=a6(),WIe=na(),YIe=(t,e,r)=>{if(e===void 0)return t;let n=Date.now(),i=()=>Date.now()-n>=e;return new Promise((s,o)=>{let a=setTimeout(()=>{i()&&(o(new y9),r.abort())},e),c=u=>f=>{if(clearTimeout(a),i()){o(new y9);return}u(f)};t.then(c(s),c(o))})},XIe={throwHttpErrors:!0,credentials:"same-origin"},ji=class{constructor(e={}){this.opts=Rq(XIe,e)}async fetch(e,r={}){let n=Rq(this.opts,r),i=new GIe(n.headers);if(typeof e!="string"&&!(e instanceof Iq||e instanceof $Ie))throw new TypeError("`resource` must be a string, URL, or Request");let s=new Iq(e.toString(),n.base),{searchParams:o,transformSearchParams:a,json:c}=n;o&&(typeof a=="function"?s.search=a(new Tq(n.searchParams)):s.search=new Tq(n.searchParams)),c&&(n.body=JSON.stringify(n.json),i.set("content-type","application/json"));let u=new AbortController,l=WIe([u.signal,n.signal]),f=await YIe(HIe(s.toString(),{...n,signal:l,timeout:void 0,headers:i}),n.timeout,u);if(!f.ok&&n.throwHttpErrors)throw n.handleError&&await n.handleError(f),new xq(f);return f.iterator=function(){return Pq(f.body)},f.ndjson=async function*(){for await(let h of QIe(f.iterator()))r.transform?yield r.transform(h):yield h},f}post(e,r={}){return this.fetch(e,{...r,method:"POST"})}get(e,r={}){return this.fetch(e,{...r,method:"GET"})}put(e,r={}){return this.fetch(e,{...r,method:"PUT"})}delete(e,r={}){return this.fetch(e,{...r,method:"DELETE"})}options(e,r={}){return this.fetch(e,{...r,method:"OPTIONS"})}},QIe=async function*(t){let e=new TextDecoder,r="";for await(let n of t){r+=e.decode(n,{stream:!0});let i=r.split(/\r?\n/);for(let s=0;s<i.length-1;s++){let o=i[s].trim();o.length>0&&(yield JSON.parse(o))}r=i[i.length-1]}r+=e.decode(),r=r.trim(),r.length!==0&&(yield JSON.parse(r))},Pq=t=>{if(eTe(t)){let e=t[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(r){return t.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:r})}}}}}if(JIe(t)){let e=t.getReader();return async function*(){try{for(;;){let{done:r,value:n}=await e.read();if(r)return;n&&(yield n)}}finally{e.releaseLock()}}()}if(ZIe(t))return t;throw new TypeError("Body can't be converted to AsyncIterable")},ZIe=t=>typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function",JIe=t=>t&&typeof t.getReader=="function",eTe=t=>Object.prototype.hasOwnProperty.call(t,"readable")&&Object.prototype.hasOwnProperty.call(t,"writable");ji.HTTPError=xq;ji.TimeoutError=y9;ji.streamToAsyncIterator=Pq;ji.post=(t,e)=>new ji(e).post(t,e);ji.get=(t,e)=>new ji(e).get(t,e);ji.put=(t,e)=>new ji(e).put(t,e);ji.delete=(t,e)=>new ji(e).delete(t,e);ji.options=(t,e)=>new ji(e).options(t,e);Cq.exports=ji});async function Dq(t,e){return(async(n,i={})=>{let s=new URLSearchParams(i);s.set("arg",n);let o=s.toString();if(!i.nocache&&g9.has(o)){let c=g9.get(o);return Oq(c)}let a=await nTe.add(async()=>{let c=await kq.default.get("https://ipfs.io/api/v0/dns",{searchParams:s}),u=new URL(c.url).search.slice(1),l=await c.json();return g9.set(u,l,tTe),l});return Oq(a)})(t,e)}var _6,kq,g9,tTe,rTe,nTe,Oq,Nq=w(()=>{nq();_6=A(ia(),1),kq=A(Kp(),1),g9=new i9(1e3),tTe=60*1e3,rTe=_6.default.default?_6.default.default:_6.default,nTe=new rTe({concurrency:4}),Oq=t=>{if(t.Path)return t.Path;throw new Error(t.Message)}});function iTe(t){return t.endsWith(".eth")&&(t=t.replace(/.eth$/,".eth.link")),t}function Bq(){return Q(async(e,r={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=iTe(e),Dq(e,r)})}var Lq=w(()=>{Nq();Ce()});function Mq({network:t}){return()=>{let e=t.try();return e!=null&&Boolean(e.libp2p.isStarted())}}var Uq=w(()=>{});var E6=g((Ydt,Fq)=>{"use strict";var th=Kr(),v6=th.Reader,qq=th.Writer,Ri=th.util,no=th.roots["libp2p-crypto-keys"]||(th.roots["libp2p-crypto-keys"]={});no.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();no.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=Ri.newBuffer([]),t.encode=function(r,n){return n||(n=qq.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof v6||(r=v6.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new no.PublicKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Ri.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Ri.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof no.PublicKey)return r;var n=new no.PublicKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Ri.base64.decode(r.Data,n.Data=Ri.newBuffer(Ri.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=Ri.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?no.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?Ri.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,th.util.toJSONOptions)},t}();no.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=Ri.newBuffer([]),t.encode=function(r,n){return n||(n=qq.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof v6||(r=v6.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new no.PrivateKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Ri.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Ri.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof no.PrivateKey)return r;var n=new no.PrivateKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Ri.base64.decode(r.Data,n.Data=Ri.newBuffer(Ri.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=Ri.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?no.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?Ri.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,th.util.toJSONOptions)},t}();Fq.exports=no});var Pt=g((Xdt,Kq)=>{Kq.exports={options:{usePureJavaScript:!1}}});var zq=g((Qdt,Vq)=>{var m9={};Vq.exports=m9;var jq={};m9.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=sTe(t,e);else{var i=0,s=e.length,o=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var c=0,u=t[i];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join(`\r
`)}return n};m9.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=jq[e];if(!r){r=jq[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*i,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var l=0;t[l]===s&&l<t.length-1;++l)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function sTe(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Tr=g((Zdt,Wq)=>{var Hq=Pt(),$q=zq(),z=Wq.exports=Hq.util=Hq.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){z.nextTick=process.nextTick,typeof setImmediate=="function"?z.setImmediate=setImmediate:z.setImmediate=z.nextTick;return}if(typeof setImmediate=="function"){z.setImmediate=function(){return setImmediate.apply(void 0,arguments)},z.nextTick=function(a){return setImmediate(a)};return}if(z.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var o=a,t="forge.setImmediate",e=[];z.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(i,{attributes:!0});var s=z.setImmediate;z.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}z.nextTick=z.setImmediate})();z.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;z.globalThisScope=function(){return z.isNodejs?globalThis:typeof self>"u"?window:self}();z.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};z.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};z.isArrayBufferView=function(t){return t&&z.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function C2(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}z.ByteBuffer=w9;function w9(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(z.isArrayBuffer(t)||z.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof w9||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}z.ByteStringBuffer=w9;var oTe=4096;z.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>oTe&&(this.data.substr(0,1),this._constructedStringLength=0)};z.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};z.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};z.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};z.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};z.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};z.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(z.encodeUtf8(t))};z.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};z.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};z.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};z.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};z.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};z.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};z.ByteStringBuffer.prototype.putInt=function(t,e){C2(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};z.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};z.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};z.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};z.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};z.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};z.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};z.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};z.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};z.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};z.ByteStringBuffer.prototype.getInt=function(t){C2(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};z.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};z.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};z.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};z.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};z.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};z.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};z.ByteStringBuffer.prototype.copy=function(){var t=z.createBuffer(this.data);return t.read=this.read,t};z.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};z.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};z.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};z.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};z.ByteStringBuffer.prototype.toString=function(){return z.decodeUtf8(this.bytes())};function aTe(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=z.isArrayBuffer(t),n=z.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}z.DataBuffer=aTe;z.DataBuffer.prototype.length=function(){return this.write-this.read};z.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};z.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};z.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};z.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};z.DataBuffer.prototype.putBytes=function(t,e){if(z.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(z.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof z.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&z.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof z.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=z.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=z.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=z.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=z.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=z.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};z.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};z.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};z.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};z.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};z.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};z.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};z.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};z.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};z.DataBuffer.prototype.putInt=function(t,e){C2(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};z.DataBuffer.prototype.putSignedInt=function(t,e){return C2(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};z.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};z.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};z.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};z.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};z.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};z.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};z.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};z.DataBuffer.prototype.getInt=function(t){C2(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};z.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};z.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};z.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};z.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};z.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};z.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};z.DataBuffer.prototype.copy=function(){return new z.DataBuffer(this)};z.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};z.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};z.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};z.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};z.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return z.binary.raw.encode(e);if(t==="hex")return z.binary.hex.encode(e);if(t==="base64")return z.binary.base64.encode(e);if(t==="utf8")return z.text.utf8.decode(e);if(t==="utf16")return z.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};z.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=z.encodeUtf8(t)),new z.ByteBuffer(t)};z.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};z.xorBytes=function(t,e,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};z.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};z.bytesToHex=function(t){return z.createBuffer(t).toHex()};z.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var gl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ml=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Gq="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";z.encode64=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.length;)i=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=gl.charAt(i>>2),r+=gl.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=gl.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":gl.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};z.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,o=0;o<t.length;)r=ml[t.charCodeAt(o++)-43],n=ml[t.charCodeAt(o++)-43],i=ml[t.charCodeAt(o++)-43],s=ml[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};z.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};z.decodeUtf8=function(t){return decodeURIComponent(escape(t))};z.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:$q.encode,decode:$q.decode}};z.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};z.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};z.binary.hex.encode=z.bytesToHex;z.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};z.binary.base64.encode=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.byteLength;)i=t[a++],s=t[a++],o=t[a++],r+=gl.charAt(i>>2),r+=gl.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=gl.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":gl.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};z.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,c=0,u=r;c<t.length;)i=ml[t.charCodeAt(c++)-43],s=ml[t.charCodeAt(c++)-43],o=ml[t.charCodeAt(c++)-43],a=ml[t.charCodeAt(c++)-43],n[u++]=i<<2|s>>4,o!==64&&(n[u++]=(s&15)<<4|o>>2,a!==64&&(n[u++]=(o&3)<<6|a));return e?u-r:n.subarray(0,u)};z.binary.base58.encode=function(t,e){return z.binary.baseN.encode(t,Gq,e)};z.binary.base58.decode=function(t,e){return z.binary.baseN.decode(t,Gq,e)};z.text={utf8:{},utf16:{}};z.text.utf8.encode=function(t,e,r){t=z.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};z.text.utf8.decode=function(t){return z.decodeUtf8(String.fromCharCode.apply(null,t))};z.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)i[o++]=t.charCodeAt(a),s+=2;return e?s-r:n};z.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};z.deflate=function(t,e,r){if(e=z.decode64(t.deflate(z.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};z.inflate=function(t,e,r){var n=t.inflate(z.encode64(e)).rval;return n===null?null:z.decode64(n)};var b9=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=z.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},_9=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(z.decode64(r))),r},cTe=function(t,e,r,n){var i=_9(t,e);i===null&&(i={}),i[r]=n,b9(t,e,i)},uTe=function(t,e,r){var n=_9(t,e);return n!==null&&(n=r in n?n[r]:null),n},lTe=function(t,e,r){var n=_9(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),b9(t,e,n)}},fTe=function(t,e){b9(t,e,null)},S6=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return n};z.setItem=function(t,e,r,n,i){S6(cTe,arguments,i)};z.getItem=function(t,e,r,n){return S6(uTe,arguments,n)};z.removeItem=function(t,e,r,n){S6(lTe,arguments,n)};z.clearItems=function(t,e,r){S6(fTe,arguments,r)};z.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};z.format=function(t){for(var e=/%./g,r,n,i=0,s=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&s.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};z.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-u).toFixed(s).slice(2):"")};z.formatSize=function(t){return t>=1073741824?t=z.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=z.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=z.formatNumber(t/1024,0)+" KiB":t=z.formatNumber(t,0)+" bytes",t};z.bytesFromIP=function(t){return t.indexOf(".")!==-1?z.bytesFromIPv4(t):t.indexOf(":")!==-1?z.bytesFromIPv6(t):null};z.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=z.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};z.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=z.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=z.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};z.bytesToIP=function(t){return t.length===4?z.bytesToIPv4(t):t.length===16?z.bytesToIPv6(t):null};z.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};z.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=z.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};z.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in z&&!t.update)return e(null,z.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return z.cores=navigator.hardwareConcurrency,e(null,z.cores);if(typeof Worker>"u")return z.cores=1,e(null,z.cores);if(typeof Blob>"u")return z.cores=2,e(null,z.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(l,f){return l+f},0)/o.length);return z.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,z.cores)}i(c,function(l,f){o.push(s(c,f)),n(o,a-1,c)})}function i(o,a){for(var c=[],u=[],l=0;l<o;++l){var f=new Worker(r);f.addEventListener("message",function(h){if(u.push(h.data),u.length===o){for(var d=0;d<o;++d)c[d].terminate();a(null,u)}}),c.push(f)}for(var l=0;l<o;++l)c[l].postMessage(l)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var l=a[u],f=c[u]=[],h=0;h<o;++h)if(u!==h){var d=a[h];(l.st>d.st&&l.st<d.et||d.st>l.st&&d.st<l.et)&&f.push(h)}return c.reduce(function(p,y){return Math.max(p,y.length)},0)}}});var jp=g((Jdt,Yq)=>{var O2=Pt();O2.pki=O2.pki||{};var v9=Yq.exports=O2.pki.oids=O2.oids=O2.oids||{};function Ee(t,e){v9[t]=e,v9[e]=t}function ar(t,e){v9[t]=e}Ee("1.2.840.113549.1.1.1","rsaEncryption");Ee("1.2.840.113549.1.1.4","md5WithRSAEncryption");Ee("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Ee("1.2.840.113549.1.1.7","RSAES-OAEP");Ee("1.2.840.113549.1.1.8","mgf1");Ee("1.2.840.113549.1.1.9","pSpecified");Ee("1.2.840.113549.1.1.10","RSASSA-PSS");Ee("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Ee("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Ee("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Ee("1.3.101.112","EdDSA25519");Ee("1.2.840.10040.4.3","dsa-with-sha1");Ee("1.3.14.3.2.7","desCBC");Ee("1.3.14.3.2.26","sha1");Ee("1.3.14.3.2.29","sha1WithRSASignature");Ee("2.16.840.1.101.3.4.2.1","sha256");Ee("2.16.840.1.101.3.4.2.2","sha384");Ee("2.16.840.1.101.3.4.2.3","sha512");Ee("2.16.840.1.101.3.4.2.4","sha224");Ee("2.16.840.1.101.3.4.2.5","sha512-224");Ee("2.16.840.1.101.3.4.2.6","sha512-256");Ee("1.2.840.113549.2.2","md2");Ee("1.2.840.113549.2.5","md5");Ee("1.2.840.113549.1.7.1","data");Ee("1.2.840.113549.1.7.2","signedData");Ee("1.2.840.113549.1.7.3","envelopedData");Ee("1.2.840.113549.1.7.4","signedAndEnvelopedData");Ee("1.2.840.113549.1.7.5","digestedData");Ee("1.2.840.113549.1.7.6","encryptedData");Ee("1.2.840.113549.1.9.1","emailAddress");Ee("1.2.840.113549.1.9.2","unstructuredName");Ee("1.2.840.113549.1.9.3","contentType");Ee("1.2.840.113549.1.9.4","messageDigest");Ee("1.2.840.113549.1.9.5","signingTime");Ee("1.2.840.113549.1.9.6","counterSignature");Ee("1.2.840.113549.1.9.7","challengePassword");Ee("1.2.840.113549.1.9.8","unstructuredAddress");Ee("1.2.840.113549.1.9.14","extensionRequest");Ee("1.2.840.113549.1.9.20","friendlyName");Ee("1.2.840.113549.1.9.21","localKeyId");Ee("1.2.840.113549.1.9.22.1","x509Certificate");Ee("1.2.840.113549.1.12.10.1.1","keyBag");Ee("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Ee("1.2.840.113549.1.12.10.1.3","certBag");Ee("1.2.840.113549.1.12.10.1.4","crlBag");Ee("1.2.840.113549.1.12.10.1.5","secretBag");Ee("1.2.840.113549.1.12.10.1.6","safeContentsBag");Ee("1.2.840.113549.1.5.13","pkcs5PBES2");Ee("1.2.840.113549.1.5.12","pkcs5PBKDF2");Ee("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Ee("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Ee("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Ee("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Ee("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Ee("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Ee("1.2.840.113549.2.7","hmacWithSHA1");Ee("1.2.840.113549.2.8","hmacWithSHA224");Ee("1.2.840.113549.2.9","hmacWithSHA256");Ee("1.2.840.113549.2.10","hmacWithSHA384");Ee("1.2.840.113549.2.11","hmacWithSHA512");Ee("1.2.840.113549.3.7","des-EDE3-CBC");Ee("2.16.840.1.101.3.4.1.2","aes128-CBC");Ee("2.16.840.1.101.3.4.1.22","aes192-CBC");Ee("2.16.840.1.101.3.4.1.42","aes256-CBC");Ee("2.5.4.3","commonName");Ee("2.5.4.4","surname");Ee("2.5.4.5","serialNumber");Ee("2.5.4.6","countryName");Ee("2.5.4.7","localityName");Ee("2.5.4.8","stateOrProvinceName");Ee("2.5.4.9","streetAddress");Ee("2.5.4.10","organizationName");Ee("2.5.4.11","organizationalUnitName");Ee("2.5.4.12","title");Ee("2.5.4.13","description");Ee("2.5.4.15","businessCategory");Ee("2.5.4.17","postalCode");Ee("2.5.4.42","givenName");Ee("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Ee("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Ee("2.16.840.1.113730.1.1","nsCertType");Ee("2.16.840.1.113730.1.13","nsComment");ar("2.5.29.1","authorityKeyIdentifier");ar("2.5.29.2","keyAttributes");ar("2.5.29.3","certificatePolicies");ar("2.5.29.4","keyUsageRestriction");ar("2.5.29.5","policyMapping");ar("2.5.29.6","subtreesConstraint");ar("2.5.29.7","subjectAltName");ar("2.5.29.8","issuerAltName");ar("2.5.29.9","subjectDirectoryAttributes");ar("2.5.29.10","basicConstraints");ar("2.5.29.11","nameConstraints");ar("2.5.29.12","policyConstraints");ar("2.5.29.13","basicConstraints");Ee("2.5.29.14","subjectKeyIdentifier");Ee("2.5.29.15","keyUsage");ar("2.5.29.16","privateKeyUsagePeriod");Ee("2.5.29.17","subjectAltName");Ee("2.5.29.18","issuerAltName");Ee("2.5.29.19","basicConstraints");ar("2.5.29.20","cRLNumber");ar("2.5.29.21","cRLReason");ar("2.5.29.22","expirationDate");ar("2.5.29.23","instructionCode");ar("2.5.29.24","invalidityDate");ar("2.5.29.25","cRLDistributionPoints");ar("2.5.29.26","issuingDistributionPoint");ar("2.5.29.27","deltaCRLIndicator");ar("2.5.29.28","issuingDistributionPoint");ar("2.5.29.29","certificateIssuer");ar("2.5.29.30","nameConstraints");Ee("2.5.29.31","cRLDistributionPoints");Ee("2.5.29.32","certificatePolicies");ar("2.5.29.33","policyMappings");ar("2.5.29.34","policyConstraints");Ee("2.5.29.35","authorityKeyIdentifier");ar("2.5.29.36","policyConstraints");Ee("2.5.29.37","extKeyUsage");ar("2.5.29.46","freshestCRL");ar("2.5.29.54","inhibitAnyPolicy");Ee("1.3.6.1.4.1.11129.2.4.2","timestampList");Ee("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Ee("1.3.6.1.5.5.7.3.1","serverAuth");Ee("1.3.6.1.5.5.7.3.2","clientAuth");Ee("1.3.6.1.5.5.7.3.3","codeSigning");Ee("1.3.6.1.5.5.7.3.4","emailProtection");Ee("1.3.6.1.5.5.7.3.8","timeStamping")});var wl=g((ept,Qq)=>{var Lr=Pt();Tr();jp();var Be=Qq.exports=Lr.asn1=Lr.asn1||{};Be.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Be.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Be.create=function(t,e,r,n,i){if(Lr.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:t,type:e,constructed:r,composed:r||Lr.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=Be.copy(a)),a};Be.copy=function(t,e){var r;if(Lr.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(Be.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:Be.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};Be.equals=function(t,e,r){if(Lr.util.isArray(t)){if(!Lr.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!Be.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&Be.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};Be.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function k2(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var hTe=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;k2(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};Be.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=Lr.util.createBuffer(t));var r=t.length(),n=A6(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function A6(t,e,r,n){var i;k2(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;i=t.length();var c=hTe(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=c,u}c=e}var l,f,h=(s&32)===32;if(h)if(l=[],c===void 0)for(;;){if(k2(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),l.push(A6(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),l.push(A6(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(l===void 0&&o===Be.Class.UNIVERSAL&&a===Be.Type.BITSTRING&&(f=t.bytes(c)),l===void 0&&n.decodeBitStrings&&o===Be.Class.UNIVERSAL&&a===Be.Type.BITSTRING&&c>1){var d=t.read,p=e,y=0;if(a===Be.Type.BITSTRING&&(k2(t,e,1),y=t.getByte(),e--),y===0)try{i=t.length();var b={strict:!0,decodeBitStrings:!0},m=A6(t,e,r+1,b),_=i-t.length();e-=_,a==Be.Type.BITSTRING&&_++;var R=m.tagClass;_===c&&(R===Be.Class.UNIVERSAL||R===Be.Class.CONTEXT_SPECIFIC)&&(l=[m])}catch{}l===void 0&&(t.read=d,e=p)}if(l===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===Be.Type.BMPSTRING)for(l="";c>0;c-=2)k2(t,e,2),l+=String.fromCharCode(t.getInt16()),e-=2;else l=t.getBytes(c),e-=c}var k=f===void 0?null:{bitStringContents:f};return Be.create(o,a,h,l,k)}Be.toDer=function(t){var e=Lr.util.createBuffer(),r=t.tagClass|t.type,n=Lr.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=Be.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(Be.toDer(t.value[s]))}else if(t.type===Be.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===Be.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)===0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(n),e};Be.oidToDer=function(t){var e=t.split("."),r=Lr.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,o,a=2;a<e.length;++a){n=!0,i=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};Be.derToOid=function(t){var e;typeof t=="string"&&(t=Lr.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};Be.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,0),u&&(c=t.charAt(u),c==="+"||c==="-")){var l=parseInt(t.substr(u+1,2),10),f=parseInt(t.substr(u+4,2),10),h=l*60+f;h*=6e4,c==="+"?e.setTime(+e-h):e.setTime(+e+h)}return e};Be.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,u=0,l=!1;t.charAt(t.length-1)==="Z"&&(l=!0);var f=t.length-5,h=t.charAt(f);if(h==="+"||h==="-"){var d=parseInt(t.substr(f+1,2),10),p=parseInt(t.substr(f+4,2),10);u=d*60+p,u*=6e4,h==="+"&&(u*=-1),l=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),l?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(r,n,i),e.setHours(s,o,a,c)),e};Be.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Be.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Be.integerToDer=function(t){var e=Lr.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};Be.derToInteger=function(t){typeof t=="string"&&(t=Lr.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};Be.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&Lr.util.isArray(e.value))for(var s=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[s]&&(i=Be.validate(t.value[s],e.value[o],r,n),i?++s:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Xq=/[^\\u0000-\\u00ff]/;Be.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case Be.Class.UNIVERSAL:n+="Universal:";break;case Be.Class.APPLICATION:n+="Application:";break;case Be.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case Be.Class.PRIVATE:n+="Private:";break}if(t.tagClass===Be.Class.UNIVERSAL)switch(n+=t.type,t.type){case Be.Type.NONE:n+=" (None)";break;case Be.Type.BOOLEAN:n+=" (Boolean)";break;case Be.Type.INTEGER:n+=" (Integer)";break;case Be.Type.BITSTRING:n+=" (Bit string)";break;case Be.Type.OCTETSTRING:n+=" (Octet string)";break;case Be.Type.NULL:n+=" (Null)";break;case Be.Type.OID:n+=" (Object Identifier)";break;case Be.Type.ODESC:n+=" (Object Descriptor)";break;case Be.Type.EXTERNAL:n+=" (External or Instance of)";break;case Be.Type.REAL:n+=" (Real)";break;case Be.Type.ENUMERATED:n+=" (Enumerated)";break;case Be.Type.EMBEDDED:n+=" (Embedded PDV)";break;case Be.Type.UTF8:n+=" (UTF8)";break;case Be.Type.ROID:n+=" (Relative Object Identifier)";break;case Be.Type.SEQUENCE:n+=" (Sequence)";break;case Be.Type.SET:n+=" (Set)";break;case Be.Type.PRINTABLESTRING:n+=" (Printable String)";break;case Be.Type.IA5String:n+=" (IA5String (ASCII))";break;case Be.Type.UTCTIME:n+=" (UTC time)";break;case Be.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case Be.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=Be.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",t.type===Be.Type.OID){var c=Be.derToOid(t.value);n+=c,Lr.pki&&Lr.pki.oids&&c in Lr.pki.oids&&(n+=" ("+Lr.pki.oids[c]+") ")}if(t.type===Be.Type.INTEGER)try{n+=Be.derToInteger(t.value)}catch{n+="0x"+Lr.util.bytesToHex(t.value)}else if(t.type===Be.Type.BITSTRING){if(t.value.length>1?n+="0x"+Lr.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(t.type===Be.Type.OCTETSTRING)Xq.test(t.value)||(n+="("+t.value+") "),n+="0x"+Lr.util.bytesToHex(t.value);else if(t.type===Be.Type.UTF8)try{n+=Lr.util.decodeUtf8(t.value)}catch(l){if(l.message==="URI malformed")n+="0x"+Lr.util.bytesToHex(t.value)+" (malformed UTF8)";else throw l}else t.type===Be.Type.PRINTABLESTRING||t.type===Be.Type.IA5String?n+=t.value:Xq.test(t.value)?n+="0x"+Lr.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var S9=g((tpt,Zq)=>{var ri=Pt();Tr();Zq.exports=ri.cipher=ri.cipher||{};ri.cipher.algorithms=ri.cipher.algorithms||{};ri.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=ri.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new ri.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};ri.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=ri.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new ri.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};ri.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),ri.cipher.algorithms[t]=e};ri.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in ri.cipher.algorithms?ri.cipher.algorithms[t]:null};var E9=ri.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};E9.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=ri.util.createBuffer(),this.output=t.output||ri.util.createBuffer(),this.mode.start(e)};E9.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};E9.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var R9=g((rpt,Jq)=>{var ni=Pt();Tr();ni.cipher=ni.cipher||{};var Ct=Jq.exports=ni.cipher.modes=ni.cipher.modes||{};Ct.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ct.ecb.prototype.start=function(t){};Ct.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Ct.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Ct.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Ct.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Ct.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ct.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=R6(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Ct.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};Ct.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Ct.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Ct.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Ct.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=ni.util.createBuffer(),this._partialBytes=0};Ct.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=R6(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ct.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Ct.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Ct.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=ni.util.createBuffer(),this._partialBytes=0};Ct.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=R6(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ct.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Ct.ofb.prototype.decrypt=Ct.ofb.prototype.encrypt;Ct.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=ni.util.createBuffer(),this._partialBytes=0};Ct.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=R6(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ct.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}I6(this._inBlock)};Ct.ctr.prototype.decrypt=Ct.ctr.prototype.encrypt;Ct.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=ni.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Ct.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=ni.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=ni.util.createBuffer(t.additionalData):r=ni.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=ni.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(A9(n*8)))}this._inBlock=this._j0.slice(0),I6(this._inBlock),this._partialBytes=0,r=ni.util.createBuffer(r),this._aDataLength=A9(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Ct.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),I6(this._inBlock)};Ct.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),I6(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Ct.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=ni.util.createBuffer();var n=this._aDataLength.concat(A9(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Ct.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Ct.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Ct.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};Ct.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Ct.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,u=(n-1-o%n)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};Ct.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return i};function R6(t,e){if(typeof t=="string"&&(t=ni.util.createBuffer(t)),ni.util.isArray(t)&&t.length>4){var r=t;t=ni.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!ni.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function I6(t){t[t.length-1]=t[t.length-1]+1&4294967295}function A9(t){return[t/4294967296|0,t&4294967295]}});var Hp=g((npt,nF)=>{var xr=Pt();S9();R9();Tr();nF.exports=xr.aes=xr.aes||{};xr.aes.startEncrypting=function(t,e,r,n){var i=T6({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};xr.aes.createEncryptionCipher=function(t,e){return T6({key:t,output:null,decrypt:!1,mode:e})};xr.aes.startDecrypting=function(t,e,r,n){var i=T6({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};xr.aes.createDecryptionCipher=function(t,e){return T6({key:t,output:null,decrypt:!0,mode:e})};xr.aes.Algorithm=function(t,e){x9||tF();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return T9(r._w,n,i,!1)},decrypt:function(n,i){return T9(r._w,n,i,!0)}}}),r._init=!1};xr.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=xr.util.createBuffer(e);else if(xr.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=xr.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!xr.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!xr.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=rF(e,t.decrypt&&!o),this._init=!0}};xr.aes._expandKey=function(t,e){return x9||tF(),rF(t,e)};xr.aes._updateBlock=T9;zp("AES-ECB",xr.cipher.modes.ecb);zp("AES-CBC",xr.cipher.modes.cbc);zp("AES-CFB",xr.cipher.modes.cfb);zp("AES-OFB",xr.cipher.modes.ofb);zp("AES-CTR",xr.cipher.modes.ctr);zp("AES-GCM",xr.cipher.modes.gcm);function zp(t,e){var r=function(){return new xr.aes.Algorithm(t,e)};xr.cipher.registerAlgorithm(t,r)}var x9=!1,Vp=4,Vi,I9,eF,rh,sa;function tF(){x9=!0,eF=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Vi=new Array(256),I9=new Array(256),rh=new Array(4),sa=new Array(4);for(var e=0;e<4;++e)rh[e]=new Array(256),sa[e]=new Array(256);for(var r=0,n=0,i,s,o,a,c,u,l,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Vi[r]=a,I9[a]=r,c=t[a],i=t[r],s=t[i],o=t[s],u=c<<24^a<<16^a<<8^(a^c),l=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var f=0;f<4;++f)rh[f][r]=u,sa[f][a]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function rF(t,e){for(var r=t.slice(0),n,i=1,s=r.length,o=s+6+1,a=Vp*o,c=s;c<a;++c)n=r[c-1],c%s===0?(n=Vi[n>>>16&255]<<24^Vi[n>>>8&255]<<16^Vi[n&255]<<8^Vi[n>>>24]^eF[i]<<24,i++):s>6&&c%s===4&&(n=Vi[n>>>24]<<24^Vi[n>>>16&255]<<16^Vi[n>>>8&255]<<8^Vi[n&255]),r[c]=r[c-s]^n;if(e){var u,l=sa[0],f=sa[1],h=sa[2],d=sa[3],p=r.slice(0);a=r.length;for(var c=0,y=a-Vp;c<a;c+=Vp,y-=Vp)if(c===0||c===a-Vp)p[c]=r[y],p[c+1]=r[y+3],p[c+2]=r[y+2],p[c+3]=r[y+1];else for(var b=0;b<Vp;++b)u=r[y+b],p[c+(3&-b)]=l[Vi[u>>>24]]^f[Vi[u>>>16&255]]^h[Vi[u>>>8&255]]^d[Vi[u&255]];r=p}return r}function T9(t,e,r,n){var i=t.length/4-1,s,o,a,c,u;n?(s=sa[0],o=sa[1],a=sa[2],c=sa[3],u=I9):(s=rh[0],o=rh[1],a=rh[2],c=rh[3],u=Vi);var l,f,h,d,p,y,b;l=e[0]^t[0],f=e[n?3:1]^t[1],h=e[2]^t[2],d=e[n?1:3]^t[3];for(var m=3,_=1;_<i;++_)p=s[l>>>24]^o[f>>>16&255]^a[h>>>8&255]^c[d&255]^t[++m],y=s[f>>>24]^o[h>>>16&255]^a[d>>>8&255]^c[l&255]^t[++m],b=s[h>>>24]^o[d>>>16&255]^a[l>>>8&255]^c[f&255]^t[++m],d=s[d>>>24]^o[l>>>16&255]^a[f>>>8&255]^c[h&255]^t[++m],l=p,f=y,h=b;r[0]=u[l>>>24]<<24^u[f>>>16&255]<<16^u[h>>>8&255]<<8^u[d&255]^t[++m],r[n?3:1]=u[f>>>24]<<24^u[h>>>16&255]<<16^u[d>>>8&255]<<8^u[l&255]^t[++m],r[2]=u[h>>>24]<<24^u[d>>>16&255]<<16^u[l>>>8&255]<<8^u[f&255]^t[++m],r[n?1:3]=u[d>>>24]<<24^u[l>>>16&255]<<16^u[f>>>8&255]<<8^u[h&255]^t[++m]}function T6(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=xr.cipher.createDecipher(r,t.key):n=xr.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof xr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var P6=g((ipt,sF)=>{var zr=Pt();S9();R9();Tr();sF.exports=zr.des=zr.des||{};zr.des.startEncrypting=function(t,e,r,n){var i=x6({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};zr.des.createEncryptionCipher=function(t,e){return x6({key:t,output:null,decrypt:!1,mode:e})};zr.des.startDecrypting=function(t,e,r,n){var i=x6({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};zr.des.createDecryptionCipher=function(t,e){return x6({key:t,output:null,decrypt:!0,mode:e})};zr.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return iF(r._keys,n,i,!1)},decrypt:function(n,i){return iF(r._keys,n,i,!0)}}}),r._init=!1};zr.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=zr.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=vTe(e),this._init=!0}};Ha("DES-ECB",zr.cipher.modes.ecb);Ha("DES-CBC",zr.cipher.modes.cbc);Ha("DES-CFB",zr.cipher.modes.cfb);Ha("DES-OFB",zr.cipher.modes.ofb);Ha("DES-CTR",zr.cipher.modes.ctr);Ha("3DES-ECB",zr.cipher.modes.ecb);Ha("3DES-CBC",zr.cipher.modes.cbc);Ha("3DES-CFB",zr.cipher.modes.cfb);Ha("3DES-OFB",zr.cipher.modes.ofb);Ha("3DES-CTR",zr.cipher.modes.ctr);function Ha(t,e){var r=function(){return new zr.des.Algorithm(t,e)};zr.cipher.registerAlgorithm(t,r)}var dTe=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],pTe=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],yTe=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],gTe=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],mTe=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],wTe=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],bTe=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],_Te=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function vTe(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=t.length()>8?3:1,b=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],_=0,R,k=0;k<y;k++){var P=t.getInt32(),x=t.getInt32();R=(P>>>4^x)&252645135,x^=R,P^=R<<4,R=(x>>>-16^P)&65535,P^=R,x^=R<<-16,R=(P>>>2^x)&858993459,x^=R,P^=R<<2,R=(x>>>-16^P)&65535,P^=R,x^=R<<-16,R=(P>>>1^x)&1431655765,x^=R,P^=R<<1,R=(x>>>8^P)&16711935,P^=R,x^=R<<8,R=(P>>>1^x)&1431655765,x^=R,P^=R<<1,R=P<<8|x>>>20&240,P=x<<24|x<<8&16711680|x>>>8&65280|x>>>24&240,x=R;for(var D=0;D<m.length;++D){m[D]?(P=P<<2|P>>>26,x=x<<2|x>>>26):(P=P<<1|P>>>27,x=x<<1|x>>>27),P&=-15,x&=-15;var U=e[P>>>28]|r[P>>>24&15]|n[P>>>20&15]|i[P>>>16&15]|s[P>>>12&15]|o[P>>>8&15]|a[P>>>4&15],M=c[x>>>28]|u[x>>>24&15]|l[x>>>20&15]|f[x>>>16&15]|h[x>>>12&15]|d[x>>>8&15]|p[x>>>4&15];R=(M>>>16^U)&65535,b[_++]=U^R,b[_++]=M^R<<16}}return b}function iF(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<i;u+=3){for(var l=s[u+1],f=s[u+2],h=s[u];h!=l;h+=f){var d=c^t[h],p=(c>>>4|c<<28)^t[h+1];o=a,a=c,c=o^(pTe[d>>>24&63]|gTe[d>>>16&63]|wTe[d>>>8&63]|_Te[d&63]|dTe[p>>>24&63]|yTe[p>>>16&63]|mTe[p>>>8&63]|bTe[p&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function x6(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=zr.cipher.createDecipher(r,t.key):n=zr.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof zr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var bl=g((spt,oF)=>{var C6=Pt();oF.exports=C6.md=C6.md||{};C6.md.algorithms=C6.md.algorithms||{}});var cF=g((opt,aF)=>{var ru=Pt();bl();Tr();var ETe=aF.exports=ru.hmac=ru.hmac||{};ETe.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in ru.md.algorithms)e=ru.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=ru.util.createBuffer(o);else if(ru.util.isArray(o)){var a=o;o=ru.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=ru.util.createBuffer(),n=ru.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var nh=g(()=>{});var P9=g((upt,uF)=>{var zi=Pt();cF();bl();Tr();var STe=zi.pkcs5=zi.pkcs5||{},nu;zi.util.isNodejs&&!zi.options.usePureJavaScript&&(nu=nh());uF.exports=zi.pbkdf2=STe.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),zi.util.isNodejs&&!zi.options.usePureJavaScript&&nu.pbkdf2&&(i===null||typeof i!="object")&&(nu.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?nu.pbkdf2Sync.length===4?nu.pbkdf2(t,e,r,n,function(R,k){if(R)return s(R);s(null,k.toString("binary"))}):nu.pbkdf2(t,e,r,n,i,function(R,k){if(R)return s(R);s(null,k.toString("binary"))}):nu.pbkdf2Sync.length===4?nu.pbkdf2Sync(t,e,r,n).toString("binary"):nu.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in zi.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=zi.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/o),u=n-(c-1)*o,l=zi.hmac.create();l.start(i,t);var f="",h,d,p;if(!s){for(var y=1;y<=c;++y){l.start(null,null),l.update(e),l.update(zi.util.int32ToBytes(y)),h=p=l.digest().getBytes();for(var b=2;b<=r;++b)l.start(null,null),l.update(p),d=l.digest().getBytes(),h=zi.util.xorBytes(h,d,o),p=d;f+=y<c?h:h.substr(0,u)}return f}var y=1,b;function m(){if(y>c)return s(null,f);l.start(null,null),l.update(e),l.update(zi.util.int32ToBytes(y)),h=p=l.digest().getBytes(),b=2,_()}function _(){if(b<=r)return l.start(null,null),l.update(p),d=l.digest().getBytes(),h=zi.util.xorBytes(h,d,o),p=d,++b,zi.util.setImmediate(_);f+=y<c?h:h.substr(0,u),++y,m()}m()}});var D6=g((lpt,fF)=>{var k6=Pt();Tr();var lF=fF.exports=k6.pem=k6.pem||{};lF.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=O6(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=O6(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=O6(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=O6(t.headers[i]);return t.procType&&(r+=`\r
`),r+=k6.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};lF.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:k6.util.decode64(s[3])};if(e.push(a),!!s[2]){for(var c=s[2].split(i),u=0;s&&u<c.length;){for(var l=c[u].replace(/\s+$/,""),f=u+1;f<c.length;++f){var h=c[f];if(!/\s/.test(h[0]))break;l+=h,u=f}if(s=l.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),y=0;y<p.length;++y)d.values.push(ATe(p[y]));if(a.procType)if(!a.contentDomain&&d.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function O6(t){for(var e=t.name+": ",r=[],n=function(c,u){return" "+u},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<e.length;++i,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function ATe(t){return t.replace(/^\s+/,"")}});var mF=g((fpt,gF)=>{var $a=Pt();bl();Tr();var dF=gF.exports=$a.sha256=$a.sha256||{};$a.md.sha256=$a.md.algorithms.sha256=dF;dF.create=function(){pF||RTe();var t=null,e=$a.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=$a.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=$a.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),hF(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=$a.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(C9.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,l=0;l<n.fullMessageLength.length-1;++l)a=n.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};hF(f,r,i);var h=$a.util.createBuffer();return h.putInt32(f.h0),h.putInt32(f.h1),h.putInt32(f.h2),h.putInt32(f.h3),h.putInt32(f.h4),h.putInt32(f.h5),h.putInt32(f.h6),h.putInt32(f.h7),h},n};var C9=null,pF=!1,yF=null;function RTe(){C9=String.fromCharCode(128),C9+=$a.util.fillString(String.fromCharCode(0),64),yF=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],pF=!0}function hF(t,e,r){for(var n,i,s,o,a,c,u,l,f,h,d,p,y,b,m,_=r.length();_>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[u]=n+e[u-7]+i+e[u-16]|0;for(l=t.h0,f=t.h1,h=t.h2,d=t.h3,p=t.h4,y=t.h5,b=t.h6,m=t.h7,u=0;u<64;++u)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=b^p&(y^b),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&f|h&(l^f),n=m+o+a+yF[u]+e[u],i=s+c,m=b,b=y,y=p,p=d+n>>>0,d=h,h=f,f=l,l=n+i>>>0;t.h0=t.h0+l|0,t.h1=t.h1+f|0,t.h2=t.h2+h|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+y|0,t.h6=t.h6+b|0,t.h7=t.h7+m|0,_-=64}}});var bF=g((hpt,wF)=>{var Ga=Pt();Tr();var N6=null;Ga.util.isNodejs&&!Ga.options.usePureJavaScript&&!process.versions["node-webkit"]&&(N6=nh());var ITe=wF.exports=Ga.prng=Ga.prng||{};ITe.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var f=e.plugin.cipher,h=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,y=Ga.util.createBuffer();e.key=null,b();function b(m){if(m)return l(m);if(y.length()>=u)return l(null,y.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Ga.util.nextTick(function(){s(b)});var _=f(e.key,e.seed);e.generated+=_.length,y.putBytes(_),e.key=d(f(e.key,h(e.seed))),e.seed=p(f(e.key,e.seed)),Ga.util.setImmediate(b)}},e.generateSync=function(u){var l=e.plugin.cipher,f=e.plugin.increment,h=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=Ga.util.createBuffer();p.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var y=l(e.key,e.seed);e.generated+=y.length,p.putBytes(y),e.key=h(l(e.key,f(e.seed))),e.seed=d(l(e.key,e.seed))}return p.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(f,h){if(f)return u(f);e.collect(h),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,f=0;f<32;++f)e.reseeds%l===0&&(u.update(e.pools[f].digest().getBytes()),e.pools[f].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var h=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(h),e.generated=0}function c(u){var l=null,f=Ga.util.globalThisScope,h=f.crypto||f.msCrypto;h&&h.getRandomValues&&(l=function(P){return h.getRandomValues(P)});var d=Ga.util.createBuffer();if(l)for(;d.length()<u;){var p=Math.max(1,Math.min(u-d.length(),65536)/4),y=new Uint32Array(Math.floor(p));try{l(y);for(var b=0;b<y.length;++b)d.putInt32(y[b])}catch(P){if(!(typeof QuotaExceededError<"u"&&P instanceof QuotaExceededError))throw P}}if(d.length()<u)for(var m,_,R,k=Math.floor(Math.random()*65536);d.length()<u;){_=16807*(k&65535),m=16807*(k>>16),_+=(m&32767)<<16,_+=m>>15,_=(_&2147483647)+(_>>31),k=_&4294967295;for(var b=0;b<3;++b)R=k>>>(b<<3),R^=Math.floor(Math.random()*256),d.putByte(R&255)}return d.getBytes(u)}return N6?(e.seedFile=function(u,l){N6.randomBytes(u,function(f,h){if(f)return l(f);l(null,h.toString())})},e.seedFileSync=function(u){return N6.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(f){l(f)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,f=0;f<l;++f)e.pools[e.pool].update(u.substr(f,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var f="",h=0;h<l;h+=8)f+=String.fromCharCode(u>>h&255);e.collect(f)},e.registerWorker=function(u){if(u===self)e.seedFile=function(f,h){function d(p){var y=p.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",d),h(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:f}}})};else{var l=function(f){var h=f.data;h.forge&&h.forge.prng&&e.seedFile(h.forge.prng.needed,function(d,p){u.postMessage({forge:{prng:{err:d,bytes:p}}})})};u.addEventListener("message",l)}},e}});var ih=g((dpt,O9)=>{var ii=Pt();Hp();mF();bF();Tr();(function(){if(ii.random&&ii.random.getBytes){O9.exports=ii.random;return}(function(t){var e={},r=new Array(4),n=ii.util.createBuffer();e.formatKey=function(f){var h=ii.util.createBuffer(f);return f=new Array(4),f[0]=h.getInt32(),f[1]=h.getInt32(),f[2]=h.getInt32(),f[3]=h.getInt32(),ii.aes._expandKey(f,!1)},e.formatSeed=function(f){var h=ii.util.createBuffer(f);return f=new Array(4),f[0]=h.getInt32(),f[1]=h.getInt32(),f[2]=h.getInt32(),f[3]=h.getInt32(),f},e.cipher=function(f,h){return ii.aes._updateBlock(f,h,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(f){return++f[3],f},e.md=ii.md.sha256;function i(){var f=ii.prng.create(e);return f.getBytes=function(h,d){return f.generate(h,d)},f.getBytesSync=function(h){return f.generate(h)},f}var s=i(),o=null,a=ii.util.globalThisScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(f){return c.getRandomValues(f)}),ii.options.usePureJavaScript||!ii.util.isNodejs&&!o){if(typeof window>"u"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch{}s.collect(u),u=null}t&&(t().mousemove(function(f){s.collectInt(f.clientX,16),s.collectInt(f.clientY,16)}),t().keypress(function(f){s.collectInt(f.charCode,8)}))}if(!ii.random)ii.random=s;else for(var l in s)ii.random[l]=s[l];ii.random.createInstance=i,O9.exports=ii.random})(typeof jQuery<"u"?jQuery:null)})()});var SF=g((ppt,EF)=>{var is=Pt();Tr();var k9=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],_F=[1,2,3,5],TTe=function(t,e){return t<<e&65535|(t&65535)>>16-e},xTe=function(t,e){return(t&65535)>>e|t<<16-e&65535};EF.exports=is.rc2=is.rc2||{};is.rc2.expandKey=function(t,e){typeof t=="string"&&(t=is.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(k9[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,k9[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,k9[r.at(a+1)^r.at(a+s)]);return r};var vF=function(t,e,r){var n=!1,i=null,s=null,o=null,a,c,u,l,f=[];for(t=is.rc2.expandKey(t,e),u=0;u<64;u++)f.push(t.getInt16Le());r?(a=function(p){for(u=0;u<4;u++)p[u]+=f[l]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),p[u]=TTe(p[u],_F[u]),l++},c=function(p){for(u=0;u<4;u++)p[u]+=f[p[(u+3)%4]&63]}):(a=function(p){for(u=3;u>=0;u--)p[u]=xTe(p[u],_F[u]),p[u]-=f[l]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),l--},c=function(p){for(u=3;u>=0;u--)p[u]-=f[p[(u+3)%4]&63]});var h=function(p){var y=[];for(u=0;u<4;u++){var b=i.getInt16Le();o!==null&&(r?b^=o.getInt16Le():o.putInt16Le(b)),y.push(b&65535)}l=r?0:63;for(var m=0;m<p.length;m++)for(var _=0;_<p[m][0];_++)p[m][1](y);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(y[u]):y[u]^=o.getInt16Le()),s.putInt16Le(y[u])},d=null;return d={start:function(p,y){p&&typeof p=="string"&&(p=is.util.createBuffer(p)),n=!1,i=is.util.createBuffer(),s=y||new is.util.createBuffer,o=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)h([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(p){var y=!0;if(r)if(p)y=p(8,i,!r);else{var b=i.length()===8?8:8-i.length();i.fillWithByte(b,b)}if(y&&(n=!0,d.update()),!r&&(y=i.length()===0,y))if(p)y=p(8,s,!r);else{var m=s.length(),_=s.at(m-1);_>m?y=!1:s.truncate(_)}return y}},d};is.rc2.startEncrypting=function(t,e,r){var n=is.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};is.rc2.createEncryptionCipher=function(t,e){return vF(t,e,!0)};is.rc2.startDecrypting=function(t,e,r){var n=is.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};is.rc2.createDecryptionCipher=function(t,e){return vF(t,e,!1)}});var M6=g((ypt,OF)=>{var D9=Pt();OF.exports=D9.jsbn=D9.jsbn||{};var iu,PTe=244837814094590,AF=(PTe&16777215)==15715070;function we(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}D9.jsbn.BigInteger=we;function Zt(){return new we(null)}function CTe(t,e,r,n,i,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function OTe(t,e,r,n,i,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,u=this.data[t++]>>15,l=a*c+u*o;c=o*c+((l&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(l>>>15)+a*u+(i>>>30),r.data[n++]=c&1073741823}return i}function RF(t,e,r,n,i,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,u=this.data[t++]>>14,l=a*c+u*o;c=o*c+((l&16383)<<14)+r.data[n]+i,i=(c>>28)+(l>>14)+a*u,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(we.prototype.am=RF,iu=28):AF&&navigator.appName=="Microsoft Internet Explorer"?(we.prototype.am=OTe,iu=30):AF&&navigator.appName!="Netscape"?(we.prototype.am=CTe,iu=26):(we.prototype.am=RF,iu=28);we.prototype.DB=iu;we.prototype.DM=(1<<iu)-1;we.prototype.DV=1<<iu;var N9=52;we.prototype.FV=Math.pow(2,N9);we.prototype.F1=N9-iu;we.prototype.F2=2*iu-N9;var kTe="0123456789abcdefghijklmnopqrstuvwxyz",B6=new Array,$p,io;$p="0".charCodeAt(0);for(io=0;io<=9;++io)B6[$p++]=io;$p="a".charCodeAt(0);for(io=10;io<36;++io)B6[$p++]=io;$p="A".charCodeAt(0);for(io=10;io<36;++io)B6[$p++]=io;function IF(t){return kTe.charAt(t)}function TF(t,e){var r=B6[t.charCodeAt(e)];return r??-1}function DTe(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function NTe(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function _l(t){var e=Zt();return e.fromInt(t),e}function BTe(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var o=r==8?t[n]&255:TF(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&we.ZERO.subTo(this,this)}function LTe(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function MTe(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=IF(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=IF(n));return i?s:"0"}function UTe(){var t=Zt();return we.ZERO.subTo(this,t),t}function qTe(){return this.s<0?this.negate():this}function FTe(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function L6(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function KTe(){return this.t<=0?0:this.DB*(this.t-1)+L6(this.data[this.t-1]^this.s&this.DM)}function jTe(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function VTe(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function zTe(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function HTe(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function $Te(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function GTe(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&we.ZERO.subTo(e,e)}function WTe(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function YTe(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Zt());var s=Zt(),o=this.s,a=t.s,c=this.DB-L6(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,l=s.data[u-1];if(l!=0){var f=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),h=this.FV/f,d=(1<<this.F1)/f,p=1<<this.F2,y=r.t,b=y-u,m=e??Zt();for(s.dlShiftTo(b,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),we.ONE.dlShiftTo(u,m),m.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--b>=0;){var _=r.data[--y]==l?this.DM:Math.floor(r.data[y]*h+(r.data[y-1]+p)*d);if((r.data[y]+=s.am(0,_,r,b,0,u))<_)for(s.dlShiftTo(b,m),r.subTo(m,r);r.data[y]<--_;)r.subTo(m,r)}e!=null&&(r.drShiftTo(u,e),o!=a&&we.ZERO.subTo(e,e)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&we.ZERO.subTo(r,r)}}}function XTe(t){var e=Zt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(we.ZERO)>0&&t.subTo(e,e),e}function sh(t){this.m=t}function QTe(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function ZTe(t){return t}function JTe(t){t.divRemTo(this.m,null,t)}function exe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function txe(t,e){t.squareTo(e),this.reduce(e)}sh.prototype.convert=QTe;sh.prototype.revert=ZTe;sh.prototype.reduce=JTe;sh.prototype.mulTo=exe;sh.prototype.sqrTo=txe;function rxe(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function oh(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function nxe(t){var e=Zt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(we.ZERO)>0&&this.m.subTo(e,e),e}function ixe(t){var e=Zt();return t.copyTo(e),this.reduce(e),e}function sxe(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function oxe(t,e){t.squareTo(e),this.reduce(e)}function axe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}oh.prototype.convert=nxe;oh.prototype.revert=ixe;oh.prototype.reduce=sxe;oh.prototype.mulTo=axe;oh.prototype.sqrTo=oxe;function cxe(){return(this.t>0?this.data[0]&1:this.s)==0}function uxe(t,e){if(t>4294967295||t<1)return we.ONE;var r=Zt(),n=Zt(),i=e.convert(this),s=L6(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function lxe(t,e){var r;return t<256||e.isEven()?r=new sh(e):r=new oh(e),this.exp(t,r)}we.prototype.copyTo=DTe;we.prototype.fromInt=NTe;we.prototype.fromString=BTe;we.prototype.clamp=LTe;we.prototype.dlShiftTo=jTe;we.prototype.drShiftTo=VTe;we.prototype.lShiftTo=zTe;we.prototype.rShiftTo=HTe;we.prototype.subTo=$Te;we.prototype.multiplyTo=GTe;we.prototype.squareTo=WTe;we.prototype.divRemTo=YTe;we.prototype.invDigit=rxe;we.prototype.isEven=cxe;we.prototype.exp=uxe;we.prototype.toString=MTe;we.prototype.negate=UTe;we.prototype.abs=qTe;we.prototype.compareTo=FTe;we.prototype.bitLength=KTe;we.prototype.mod=XTe;we.prototype.modPowInt=lxe;we.ZERO=_l(0);we.ONE=_l(1);function fxe(){var t=Zt();return this.copyTo(t),t}function hxe(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function dxe(){return this.t==0?this.s:this.data[0]<<24>>24}function pxe(){return this.t==0?this.s:this.data[0]<<16>>16}function yxe(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function gxe(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function mxe(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=_l(r),i=Zt(),s=Zt(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}function wxe(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,a=0;a<t.length;++a){var c=TF(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&we.ZERO.subTo(this,this)}function bxe(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(we.ONE.shiftLeft(t-1),B9,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(we.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function _xe(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function vxe(t){return this.compareTo(t)==0}function Exe(t){return this.compareTo(t)<0?this:t}function Sxe(t){return this.compareTo(t)>0?this:t}function Axe(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Rxe(t,e){return t&e}function Ixe(t){var e=Zt();return this.bitwiseTo(t,Rxe,e),e}function B9(t,e){return t|e}function Txe(t){var e=Zt();return this.bitwiseTo(t,B9,e),e}function xF(t,e){return t^e}function xxe(t){var e=Zt();return this.bitwiseTo(t,xF,e),e}function PF(t,e){return t&~e}function Pxe(t){var e=Zt();return this.bitwiseTo(t,PF,e),e}function Cxe(){for(var t=Zt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Oxe(t){var e=Zt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function kxe(t){var e=Zt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Dxe(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function Nxe(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Dxe(this.data[t]);return this.s<0?this.t*this.DB:-1}function Bxe(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Lxe(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Bxe(this.data[r]^e);return t}function Mxe(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Uxe(t,e){var r=we.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function qxe(t){return this.changeBit(t,B9)}function Fxe(t){return this.changeBit(t,PF)}function Kxe(t){return this.changeBit(t,xF)}function jxe(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function Vxe(t){var e=Zt();return this.addTo(t,e),e}function zxe(t){var e=Zt();return this.subTo(t,e),e}function Hxe(t){var e=Zt();return this.multiplyTo(t,e),e}function $xe(t){var e=Zt();return this.divRemTo(t,e,null),e}function Gxe(t){var e=Zt();return this.divRemTo(t,null,e),e}function Wxe(t){var e=Zt(),r=Zt();return this.divRemTo(t,e,r),new Array(e,r)}function Yxe(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Xxe(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function D2(){}function CF(t){return t}function Qxe(t,e,r){t.multiplyTo(e,r)}function Zxe(t,e){t.squareTo(e)}D2.prototype.convert=CF;D2.prototype.revert=CF;D2.prototype.mulTo=Qxe;D2.prototype.sqrTo=Zxe;function Jxe(t){return this.exp(t,new D2)}function ePe(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function tPe(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Gp(t){this.r2=Zt(),this.q3=Zt(),we.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function rPe(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Zt();return t.copyTo(e),this.reduce(e),e}function nPe(t){return t}function iPe(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function sPe(t,e){t.squareTo(e),this.reduce(e)}function oPe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Gp.prototype.convert=rPe;Gp.prototype.revert=nPe;Gp.prototype.reduce=iPe;Gp.prototype.mulTo=oPe;Gp.prototype.sqrTo=sPe;function aPe(t,e){var r=t.bitLength(),n,i=_l(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new sh(e):e.isEven()?s=new Gp(e):s=new oh(e);var o=new Array,a=3,c=n-1,u=(1<<n)-1;if(o[1]=s.convert(this),n>1){var l=Zt();for(s.sqrTo(o[1],l);a<=u;)o[a]=Zt(),s.mulTo(l,o[a-2],o[a]),a+=2}var f=t.t-1,h,d=!0,p=Zt(),y;for(r=L6(t.data[f])-1;f>=0;){for(r>=c?h=t.data[f]>>r-c&u:(h=(t.data[f]&(1<<r+1)-1)<<c-r,f>0&&(h|=t.data[f-1]>>this.DB+r-c)),a=n;(h&1)==0;)h>>=1,--a;if((r-=a)<0&&(r+=this.DB,--f),d)o[h].copyTo(i),d=!1;else{for(;a>1;)s.sqrTo(i,p),s.sqrTo(p,i),a-=2;a>0?s.sqrTo(i,p):(y=i,i=p,p=y),s.mulTo(p,o[h],i)}for(;f>=0&&(t.data[f]&1<<r)==0;)s.sqrTo(i,p),y=i,i=p,p=y,--r<0&&(r=this.DB-1,--f)}return s.revert(i)}function cPe(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function uPe(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function lPe(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return we.ZERO;for(var r=t.clone(),n=this.clone(),i=_l(1),s=_l(0),o=_l(0),a=_l(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),e&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(we.ONE)!=0)return we.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var oa=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],fPe=(1<<26)/oa[oa.length-1];function hPe(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=oa[oa.length-1]){for(e=0;e<oa.length;++e)if(r.data[0]==oa[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<oa.length;){for(var n=oa[e],i=e+1;i<oa.length&&n<fPe;)n*=oa[i++];for(n=r.modInt(n);e<i;)if(n%oa[e++]==0)return!1}return r.millerRabin(t)}function dPe(t){var e=this.subtract(we.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=pPe(),s,o=0;o<t;++o){do s=new we(this.bitLength(),i);while(s.compareTo(we.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(n,this);if(a.compareTo(we.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(we.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function pPe(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}we.prototype.chunkSize=yxe;we.prototype.toRadix=mxe;we.prototype.fromRadix=wxe;we.prototype.fromNumber=bxe;we.prototype.bitwiseTo=Axe;we.prototype.changeBit=Uxe;we.prototype.addTo=jxe;we.prototype.dMultiply=Yxe;we.prototype.dAddOffset=Xxe;we.prototype.multiplyLowerTo=ePe;we.prototype.multiplyUpperTo=tPe;we.prototype.modInt=uPe;we.prototype.millerRabin=dPe;we.prototype.clone=fxe;we.prototype.intValue=hxe;we.prototype.byteValue=dxe;we.prototype.shortValue=pxe;we.prototype.signum=gxe;we.prototype.toByteArray=_xe;we.prototype.equals=vxe;we.prototype.min=Exe;we.prototype.max=Sxe;we.prototype.and=Ixe;we.prototype.or=Txe;we.prototype.xor=xxe;we.prototype.andNot=Pxe;we.prototype.not=Cxe;we.prototype.shiftLeft=Oxe;we.prototype.shiftRight=kxe;we.prototype.getLowestSetBit=Nxe;we.prototype.bitCount=Lxe;we.prototype.testBit=Mxe;we.prototype.setBit=qxe;we.prototype.clearBit=Fxe;we.prototype.flipBit=Kxe;we.prototype.add=Vxe;we.prototype.subtract=zxe;we.prototype.multiply=Hxe;we.prototype.divide=$xe;we.prototype.remainder=Gxe;we.prototype.divideAndRemainder=Wxe;we.prototype.modPow=aPe;we.prototype.modInverse=lPe;we.prototype.pow=Jxe;we.prototype.gcd=cPe;we.prototype.isProbablePrime=hPe});var LF=g((gpt,BF)=>{var Wa=Pt();bl();Tr();var DF=BF.exports=Wa.sha1=Wa.sha1||{};Wa.md.sha1=Wa.md.algorithms.sha1=DF;DF.create=function(){NF||yPe();var t=null,e=Wa.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=Wa.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Wa.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),kF(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Wa.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(L9.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,l=0;l<n.fullMessageLength.length-1;++l)a=n.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};kF(f,r,i);var h=Wa.util.createBuffer();return h.putInt32(f.h0),h.putInt32(f.h1),h.putInt32(f.h2),h.putInt32(f.h3),h.putInt32(f.h4),h},n};var L9=null,NF=!1;function yPe(){L9=String.fromCharCode(128),L9+=Wa.util.fillString(String.fromCharCode(0),64),NF=!0}function kF(t,e,r){for(var n,i,s,o,a,c,u,l,f=r.length();f>=64;){for(i=t.h0,s=t.h1,o=t.h2,a=t.h3,c=t.h4,l=0;l<16;++l)n=r.getInt32(),e[l]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<20;++l)n=e[l-3]^e[l-8]^e[l-14]^e[l-16],n=n<<1|n>>>31,e[l]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<32;++l)n=e[l-3]^e[l-8]^e[l-14]^e[l-16],n=n<<1|n>>>31,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<40;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<60;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s&o|a&(s^o),n=(i<<5|i>>>27)+u+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<80;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,f-=64}}});var qF=g((mpt,UF)=>{var Ya=Pt();Tr();ih();LF();var MF=UF.exports=Ya.pkcs1=Ya.pkcs1||{};MF.encode_rsa_oaep=function(t,e,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=Ya.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}n||(n=""),s.update(n,"raw");for(var l=s.digest(),f="",h=c-e.length,d=0;d<h;d++)f+="\0";var p=l.getBytes()+f+""+e;if(!i)i=Ya.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=s.digestLength,u}var y=U6(i,a-s.digestLength-1,o),b=Ya.util.xorBytes(p,y,p.length),m=U6(b,s.digestLength,o),_=Ya.util.xorBytes(i,m,i.length);return"\0"+_+b};MF.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var b=new Error("RSAES-OAEP encoded message length is invalid.");throw b.length=e.length,b.expectedLength=o,b}if(i===void 0?i=Ya.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=e.charAt(0),u=e.substring(1,i.digestLength+1),l=e.substring(1+i.digestLength),f=U6(l,i.digestLength,s),h=Ya.util.xorBytes(u,f,u.length),d=U6(h,o-i.digestLength-1,s),p=Ya.util.xorBytes(l,d,l.length),y=p.substring(0,i.digestLength),b=c!=="\0",m=0;m<i.digestLength;++m)b|=a.charAt(m)!==y.charAt(m);for(var _=1,R=i.digestLength,k=i.digestLength;k<p.length;k++){var P=p.charCodeAt(k),x=P&1^1,D=_?65534:0;b|=P&D,_=_&x,R+=_}if(b||p.charCodeAt(R)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(R+1)};function U6(t,e,r){r||(r=Ya.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var FF=g((wpt,M9)=>{var vl=Pt();Tr();M6();ih();(function(){if(vl.prime){M9.exports=vl.prime;return}var t=M9.exports=vl.prime=vl.prime||{},e=vl.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(f,h){return f|h};t.generateProbablePrime=function(f,h,d){typeof h=="function"&&(d=h,h={}),h=h||{};var p=h.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var y=h.prng||vl.random,b={nextBytes:function(m){for(var _=y.getBytesSync(m.length),R=0;R<m.length;++R)m[R]=_.charCodeAt(R)}};if(p.name==="PRIMEINC")return s(f,b,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(f,h,d,p){return"workers"in d?c(f,h,d,p):o(f,h,d,p)}function o(f,h,d,p){var y=u(f,h),b=0,m=l(y.bitLength());"millerRabinTests"in d&&(m=d.millerRabinTests);var _=10;"maxBlockTime"in d&&(_=d.maxBlockTime),a(y,f,h,b,m,_,p)}function a(f,h,d,p,y,b,m){var _=+new Date;do{if(f.bitLength()>h&&(f=u(h,d)),f.isProbablePrime(y))return m(null,f);f.dAddOffset(r[p++%8],0)}while(b<0||+new Date-_<b);vl.util.setImmediate(function(){a(f,h,d,p,y,b,m)})}function c(f,h,d,p){if(typeof Worker>"u")return o(f,h,d,p);var y=u(f,h),b=d.workers,m=d.workLoad||100,_=m*30/8,R=d.workerScript||"forge/prime.worker.js";if(b===-1)return vl.util.estimateCores(function(P,x){P&&(x=2),b=x-1,k()});k();function k(){b=Math.max(1,b);for(var P=[],x=0;x<b;++x)P[x]=new Worker(R);for(var D=b,x=0;x<b;++x)P[x].addEventListener("message",M);var U=!1;function M(ae){if(!U){--D;var ne=ae.data;if(ne.found){for(var de=0;de<P.length;++de)P[de].terminate();return U=!0,p(null,new e(ne.prime,16))}y.bitLength()>f&&(y=u(f,h));var me=y.toString(16);ae.target.postMessage({hex:me,workLoad:m}),y.dAddOffset(_,0)}}}}function u(f,h){var d=new e(f,h),p=f-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function l(f){return f<=100?27:f<=150?18:f<=200?15:f<=250?12:f<=300?9:f<=350?8:f<=400?7:f<=500?6:f<=600?5:f<=800?4:f<=1250?3:2}})()});var N2=g((bpt,GF)=>{var rt=Pt();wl();M6();jp();qF();FF();ih();Tr();typeof Ht>"u"&&(Ht=rt.jsbn.BigInteger);var Ht,U9=rt.util.isNodejs?nh():null,te=rt.asn1,so=rt.util;rt.pki=rt.pki||{};GF.exports=rt.pki.rsa=rt.rsa=rt.rsa||{};var wt=rt.pki,gPe=[6,4,2,4,2,4,6,2],mPe={name:"PrivateKeyInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},wPe={name:"RSAPrivateKey",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},bPe={name:"RSAPublicKey",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},_Pe=rt.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:te.Class.UNIVERSAL,type:te.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},vPe={name:"DigestInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:te.Class.UNIVERSAL,type:te.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:te.Class.UNIVERSAL,type:te.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},EPe=function(t){var e;if(t.algorithm in wt.oids)e=wt.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=te.oidToDer(e).getBytes(),i=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[]),s=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[]);s.value.push(te.create(te.Class.UNIVERSAL,te.Type.OID,!1,n)),s.value.push(te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,""));var o=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(o),te.toDer(i).getBytes()},HF=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Ht.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Ht.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new Ht(rt.util.bytesToHex(rt.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(Ht.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var o=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};wt.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=$F(t,e,r)):(i=rt.util.createBuffer(),i.putBytes(t));for(var o=new Ht(i.toHex(),16),a=HF(o,e,n),c=a.toString(16),u=rt.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(rt.util.hexToBytes(c)),u.getBytes()};wt.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var o=new Ht(rt.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=HF(o,e,r),c=a.toString(16),u=rt.util.createBuffer(),l=i-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(rt.util.hexToBytes(c)),n!==!1?q6(u.getBytes(),e,r):u.getBytes()};wt.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||rt.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new Ht(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};wt.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Ht(null);r.fromInt(30);for(var n=0,i=function(f,h){return f|h},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,u=c-1;t.pqState===0?(t.num=new Ht(c,t.rng),t.num.testBit(u)||t.num.bitwiseTo(Ht.ONE.shiftLeft(u),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(APe(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(gPe[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(Ht.ONE).gcd(t.e).compareTo(Ht.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Ht.ONE),t.q1=t.q.subtract(Ht.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Ht.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var l=t.e.modInverse(t.phi);t.keys={privateKey:wt.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:wt.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};wt.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!rt.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(KF("generateKeyPair"))return U9.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return n(a);n(null,{privateKey:wt.privateKeyFromPem(u),publicKey:wt.publicKeyFromPem(c)})});if(jF("generateKey")&&jF("exportKey"))return so.globalThisScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:zF(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return so.globalThisScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=wt.privateKeyFromAsn1(te.fromDer(rt.util.createBuffer(a)));n(null,{privateKey:c,publicKey:wt.setRsaPublicKey(c.n,c.e)})}});if(VF("generateKey")&&VF("exportKey")){var i=so.globalThisScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:zF(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,u=so.globalThisScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var f=l.target.result,h=wt.privateKeyFromAsn1(te.fromDer(rt.util.createBuffer(f)));n(null,{privateKey:h,publicKey:wt.setRsaPublicKey(h.n,h.e)})},u.onerror=function(l){n(l)}},i.onerror=function(a){n(a)};return}}else if(KF("generateKeyPairSync")){var s=U9.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:wt.privateKeyFromPem(s.privateKey),publicKey:wt.publicKeyFromPem(s.publicKey)}}}var o=wt.rsa.createKeyPairGenerationState(t,e,r);if(!n)return wt.rsa.stepKeyPairGenerationState(o,0),o.keys;SPe(o,r,n)};wt.setRsaPublicKey=wt.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,u){return $F(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return rt.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return wt.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,u){u=q6(u,r,!0);var l=te.fromDer(u,{parseAllBytes:o._parseAllDigestBytes}),f={},h=[];if(!te.validate(l,vPe,f,h)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=h,d}var p=te.derToOid(f.algorithmIdentifier);if(!(p===rt.oids.md2||p===rt.oids.md5||p===rt.oids.sha1||p===rt.oids.sha224||p===rt.oids.sha256||p===rt.oids.sha384||p===rt.oids.sha512||p===rt.oids["sha512-224"]||p===rt.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===rt.oids.md2||p===rt.oids.md5)&&!("parameters"in f))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===f.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,u){return u=q6(u,r,!0),c===u}});var a=wt.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};wt.setRsaPrivateKey=wt.rsa.setPrivateKey=function(t,e,r,n,i,s,o,a){var c={n:t,e,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,l,f){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var h=wt.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:q6};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(d,p){return rt.pkcs1.decode_rsa_oaep(p,d,f)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(h,c,!1)},c.sign=function(u,l){var f=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:EPe},f=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},f=1);var h=l.encode(u,c.n.bitLength());return wt.rsa.encrypt(h,c,f)},c};wt.wrapRsaPrivateKey=function(t){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(0).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(wt.oids.rsaEncryption).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,te.toDer(t).getBytes())])};wt.privateKeyFromAsn1=function(t){var e={},r=[];if(te.validate(t,mPe,e,r)&&(t=te.fromDer(rt.util.createBuffer(e.privateKey))),e={},r=[],!te.validate(t,wPe,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,c,u,l,f;return i=rt.util.createBuffer(e.privateKeyModulus).toHex(),s=rt.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=rt.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=rt.util.createBuffer(e.privateKeyPrime1).toHex(),c=rt.util.createBuffer(e.privateKeyPrime2).toHex(),u=rt.util.createBuffer(e.privateKeyExponent1).toHex(),l=rt.util.createBuffer(e.privateKeyExponent2).toHex(),f=rt.util.createBuffer(e.privateKeyCoefficient).toHex(),wt.setRsaPrivateKey(new Ht(i,16),new Ht(s,16),new Ht(o,16),new Ht(a,16),new Ht(c,16),new Ht(u,16),new Ht(l,16),new Ht(f,16))};wt.privateKeyToAsn1=wt.privateKeyToRSAPrivateKey=function(t){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(0).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Xa(t.n)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Xa(t.e)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Xa(t.d)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Xa(t.p)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Xa(t.q)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Xa(t.dP)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Xa(t.dQ)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Xa(t.qInv))])};wt.publicKeyFromAsn1=function(t){var e={},r=[];if(te.validate(t,_Pe,e,r)){var n=te.derToOid(e.publicKeyOid);if(n!==wt.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!te.validate(t,bPe,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=rt.util.createBuffer(e.publicKeyModulus).toHex(),o=rt.util.createBuffer(e.publicKeyExponent).toHex();return wt.setRsaPublicKey(new Ht(s,16),new Ht(o,16))};wt.publicKeyToAsn1=wt.publicKeyToSubjectPublicKeyInfo=function(t){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(wt.oids.rsaEncryption).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]),te.create(te.Class.UNIVERSAL,te.Type.BITSTRING,!1,[wt.publicKeyToRSAPublicKey(t)])])};wt.publicKeyToRSAPublicKey=function(t){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Xa(t.n)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Xa(t.e))])};function $F(t,e,r){var n=rt.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var u=0,l=rt.random.getBytes(o),c=0;c<o;++c)a=l.charCodeAt(c),a===0?++u:n.putByte(a);o=u}return n.putByte(0),n.putBytes(t),n}function q6(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=rt.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function SPe(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,c){rt.prime.generateProbablePrime(a,n,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(Ht.ONE).gcd(t.e).compareTo(Ht.ONE)!==0){t.p=null,i();return}if(t.q.subtract(Ht.ONE).gcd(t.e).compareTo(Ht.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(Ht.ONE),t.q1=t.q.subtract(Ht.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Ht.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var l=t.e.modInverse(t.phi);t.keys={privateKey:wt.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:wt.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Xa(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=rt.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function APe(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function KF(t){return rt.util.isNodejs&&typeof U9[t]=="function"}function jF(t){return typeof so.globalThisScope<"u"&&typeof so.globalThisScope.crypto=="object"&&typeof so.globalThisScope.crypto.subtle=="object"&&typeof so.globalThisScope.crypto.subtle[t]=="function"}function VF(t){return typeof so.globalThisScope<"u"&&typeof so.globalThisScope.msCrypto=="object"&&typeof so.globalThisScope.msCrypto.subtle=="object"&&typeof so.globalThisScope.msCrypto.subtle[t]=="function"}function zF(t){for(var e=rt.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var q9=g((_pt,ZF)=>{var qe=Pt();Hp();wl();P6();bl();jp();P9();D6();ih();SF();N2();Tr();typeof WF>"u"&&(WF=qe.jsbn.BigInteger);var WF,ce=qe.asn1,_t=qe.pki=qe.pki||{};ZF.exports=_t.pbe=qe.pbe=qe.pbe||{};var ah=_t.oids,RPe={name:"EncryptedPrivateKeyInfo",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},IPe={name:"PBES2Algorithms",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},TPe={name:"pkcs-12PbeParams",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"iterations"}]};_t.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=qe.random.getBytesSync(r.saltSize),i=r.count,s=ce.integerToDer(i),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,l,f;switch(r.algorithm){case"aes128":o=16,u=16,l=ah["aes128-CBC"],f=qe.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,l=ah["aes192-CBC"],f=qe.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,l=ah["aes256-CBC"],f=qe.aes.createEncryptionCipher;break;case"des":o=8,u=8,l=ah.desCBC,f=qe.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=QF(d),y=qe.pkcs5.pbkdf2(e,n,i,o,p),b=qe.random.getBytesSync(u),m=f(y);m.start(b),m.update(ce.toDer(t)),m.finish(),c=m.output.getBytes();var _=xPe(n,s,o,d);a=ce.create(ce.Class.UNIVERSAL,ce.Type.SEQUENCE,!0,[ce.create(ce.Class.UNIVERSAL,ce.Type.OID,!1,ce.oidToDer(ah.pkcs5PBES2).getBytes()),ce.create(ce.Class.UNIVERSAL,ce.Type.SEQUENCE,!0,[ce.create(ce.Class.UNIVERSAL,ce.Type.SEQUENCE,!0,[ce.create(ce.Class.UNIVERSAL,ce.Type.OID,!1,ce.oidToDer(ah.pkcs5PBKDF2).getBytes()),_]),ce.create(ce.Class.UNIVERSAL,ce.Type.SEQUENCE,!0,[ce.create(ce.Class.UNIVERSAL,ce.Type.OID,!1,ce.oidToDer(l).getBytes()),ce.create(ce.Class.UNIVERSAL,ce.Type.OCTETSTRING,!1,b)])])])}else if(r.algorithm==="3des"){o=24;var R=new qe.util.ByteBuffer(n),y=_t.pbe.generatePkcs12Key(e,R,1,i,o),b=_t.pbe.generatePkcs12Key(e,R,2,i,o),m=qe.des.createEncryptionCipher(y);m.start(b),m.update(ce.toDer(t)),m.finish(),c=m.output.getBytes(),a=ce.create(ce.Class.UNIVERSAL,ce.Type.SEQUENCE,!0,[ce.create(ce.Class.UNIVERSAL,ce.Type.OID,!1,ce.oidToDer(ah["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),ce.create(ce.Class.UNIVERSAL,ce.Type.SEQUENCE,!0,[ce.create(ce.Class.UNIVERSAL,ce.Type.OCTETSTRING,!1,n),ce.create(ce.Class.UNIVERSAL,ce.Type.INTEGER,!1,s.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var k=ce.create(ce.Class.UNIVERSAL,ce.Type.SEQUENCE,!0,[a,ce.create(ce.Class.UNIVERSAL,ce.Type.OCTETSTRING,!1,c)]);return k};_t.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!ce.validate(t,RPe,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=ce.derToOid(n.encryptionOid),a=_t.pbe.getCipher(o,n.encryptionParams,e),c=qe.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=ce.fromDer(a.output)),r};_t.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:ce.toDer(t).getBytes()};return qe.pem.encode(r,{maxline:e})};_t.encryptedPrivateKeyFromPem=function(t){var e=qe.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return ce.fromDer(e.body)};_t.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=_t.wrapRsaPrivateKey(_t.privateKeyToAsn1(t));return n=_t.encryptPrivateKeyInfo(n,e,r),_t.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=qe.random.getBytesSync(16),a=qe.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=qe.random.getBytesSync(16),a=qe.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=qe.random.getBytesSync(16),a=qe.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=qe.random.getBytesSync(8),a=qe.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=qe.random.getBytesSync(8),a=qe.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=qe.pbe.opensslDeriveBytes(e,s.substr(0,8),o),l=a(u);l.start(s),l.update(ce.toDer(_t.privateKeyToAsn1(t))),l.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:qe.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return qe.pem.encode(f)};_t.decryptRsaPrivateKey=function(t,e){var r=null,n=qe.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=qe.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=qe.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=qe.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=qe.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=qe.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(f){return qe.rc2.createDecryptionCipher(f,40)};break;case"RC2-64-CBC":s=8,o=function(f){return qe.rc2.createDecryptionCipher(f,64)};break;case"RC2-128-CBC":s=16,o=function(f){return qe.rc2.createDecryptionCipher(f,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=qe.util.hexToBytes(n.dekInfo.parameters),c=qe.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(qe.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=_t.decryptPrivateKeyInfo(ce.fromDer(r),e):r=ce.fromDer(r),r!==null&&(r=_t.privateKeyFromAsn1(r)),r};_t.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in qe.md))throw new Error('"sha1" hash algorithm unavailable.');s=qe.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new qe.util.ByteBuffer,f=new qe.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)f.putInt16(t.charCodeAt(a));f.putInt16(0)}var h=f.length(),d=e.length(),p=new qe.util.ByteBuffer;p.fillWithByte(r,u);var y=u*Math.ceil(d/u),b=new qe.util.ByteBuffer;for(a=0;a<y;a++)b.putByte(e.at(a%d));var m=u*Math.ceil(h/u),_=new qe.util.ByteBuffer;for(a=0;a<m;a++)_.putByte(f.at(a%h));var R=b;R.putBuffer(_);for(var k=Math.ceil(i/c),P=1;P<=k;P++){var x=new qe.util.ByteBuffer;x.putBytes(p.bytes()),x.putBytes(R.bytes());for(var D=0;D<n;D++)s.start(),s.update(x.getBytes()),x=s.digest();var U=new qe.util.ByteBuffer;for(a=0;a<u;a++)U.putByte(x.at(a%c));var M=Math.ceil(d/u)+Math.ceil(h/u),ae=new qe.util.ByteBuffer;for(o=0;o<M;o++){var ne=new qe.util.ByteBuffer(R.getBytes(u)),de=511;for(a=U.length()-1;a>=0;a--)de=de>>8,de+=U.at(a)+ne.at(a),ne.setAt(a,de&255);ae.putBuffer(ne)}R=ae,l.putBuffer(x)}return l.truncate(l.length()-i),l};_t.pbe.getCipher=function(t,e,r){switch(t){case _t.oids.pkcs5PBES2:return _t.pbe.getCipherForPBES2(t,e,r);case _t.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case _t.oids["pbewithSHAAnd40BitRC2-CBC"]:return _t.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};_t.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!ce.validate(e,IPe,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=ce.derToOid(n.kdfOid),t!==_t.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=ce.derToOid(n.encOid),t!==_t.oids["aes128-CBC"]&&t!==_t.oids["aes192-CBC"]&&t!==_t.oids["aes256-CBC"]&&t!==_t.oids["des-EDE3-CBC"]&&t!==_t.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=qe.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(_t.oids[t]){case"aes128-CBC":c=16,u=qe.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=qe.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=qe.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=qe.des.createDecryptionCipher;break;case"desCBC":c=8,u=qe.des.createDecryptionCipher;break}var l=XF(n.prfOid),f=qe.pkcs5.pbkdf2(r,o,a,c,l),h=n.encIv,d=u(f);return d.start(h),d};_t.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!ce.validate(e,TPe,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=qe.util.createBuffer(n.salt),a=qe.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,u,l;switch(t){case _t.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=qe.des.startDecrypting;break;case _t.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(y,b){var m=qe.rc2.createDecryptionCipher(y,40);return m.start(b,null),m};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var f=XF(n.prfOid),h=_t.pbe.generatePkcs12Key(r,o,1,a,c,f);f.start();var d=_t.pbe.generatePkcs12Key(r,o,2,a,u,f);return l(h,d)};_t.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in qe.md))throw new Error('"md5" hash algorithm unavailable.');n=qe.md.md5.create()}e===null&&(e="");for(var i=[YF(n,t+e)],s=16,o=1;s<r;++o,s+=16)i.push(YF(n,i[o-1]+t+e));return i.join("").substr(0,r)};function YF(t,e){return t.start().update(e).digest().getBytes()}function XF(t){var e;if(!t)e="hmacWithSHA1";else if(e=_t.oids[ce.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return QF(e)}function QF(t){var e=qe.md;switch(t){case"hmacWithSHA224":e=qe.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function xPe(t,e,r,n){var i=ce.create(ce.Class.UNIVERSAL,ce.Type.SEQUENCE,!0,[ce.create(ce.Class.UNIVERSAL,ce.Type.OCTETSTRING,!1,t),ce.create(ce.Class.UNIVERSAL,ce.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(ce.create(ce.Class.UNIVERSAL,ce.Type.INTEGER,!1,qe.util.hexToBytes(r.toString(16))),ce.create(ce.Class.UNIVERSAL,ce.Type.SEQUENCE,!0,[ce.create(ce.Class.UNIVERSAL,ce.Type.OID,!1,ce.oidToDer(_t.oids[n]).getBytes()),ce.create(ce.Class.UNIVERSAL,ce.Type.NULL,!1,"")])),i}});var B2=g(JF=>{"use strict";JF.get=(t=globalThis)=>{let e=t.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var F9=g((Ept,tK)=>{"use strict";var{concat:PPe}=(Pn(),se(Ui)),{fromString:eK}=(dt(),se(nn)),CPe=B2();function OPe({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:n="SHA-256",saltLength:i=16,iterations:s=32767}={}){let o=CPe.get();r*=8;async function a(u,l){let f=o.getRandomValues(new Uint8Array(i)),h=o.getRandomValues(new Uint8Array(e)),d={name:t,iv:h},p={name:"PBKDF2",salt:f,iterations:s,hash:{name:n}},y=await o.subtle.importKey("raw",eK(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(p,y,{name:t,length:r},!0,["encrypt"]),m=await o.subtle.encrypt(d,b,u);return PPe([f,d.iv,new Uint8Array(m)])}async function c(u,l){let f=u.slice(0,i),h=u.slice(i,i+e),d=u.slice(i+e),p={name:t,iv:h},y={name:"PBKDF2",salt:f,iterations:s,hash:{name:n}},b=await o.subtle.importKey("raw",eK(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),m=await o.subtle.deriveKey(y,b,{name:t,length:r},!0,["decrypt"]),_=await o.subtle.decrypt(p,m,d);return new Uint8Array(_)}return{encrypt:a,decrypt:c}}tK.exports={create:OPe}});var nK=g((Spt,rK)=>{"use strict";var{base64:kPe}=(ol(),se(Xf)),DPe=F9();rK.exports={import:async function(t,e){let r=kPe.decode(t);return await DPe.create().decrypt(r,e)}}});var V9=g((Apt,aK)=>{var Mr=Pt();bl();Tr();var L2=aK.exports=Mr.sha512=Mr.sha512||{};Mr.md.sha512=Mr.md.algorithms.sha512=L2;var sK=Mr.sha384=Mr.sha512.sha384=Mr.sha512.sha384||{};sK.create=function(){return L2.create("SHA-384")};Mr.md.sha384=Mr.md.algorithms.sha384=sK;Mr.sha512.sha256=Mr.sha512.sha256||{create:function(){return L2.create("SHA-512/256")}};Mr.md["sha512/256"]=Mr.md.algorithms["sha512/256"]=Mr.sha512.sha256;Mr.sha512.sha224=Mr.sha512.sha224||{create:function(){return L2.create("SHA-512/224")}};Mr.md["sha512/224"]=Mr.md.algorithms["sha512/224"]=Mr.sha512.sha224;L2.create=function(t){if(oK||NPe(),typeof t>"u"&&(t="SHA-512"),!(t in ch))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=ch[t],r=null,n=Mr.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);n=Mr.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=Mr.util.encodeUtf8(c));var l=c.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var f=a.fullMessageLength.length-1;f>=0;--f)a.fullMessageLength[f]+=l[1],l[1]=l[0]+(a.fullMessageLength[f]/4294967296>>>0),a.fullMessageLength[f]=a.fullMessageLength[f]>>>0,l[0]=l[1]/4294967296>>>0;return n.putBytes(c),iK(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=Mr.util.createBuffer();c.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,l=u&a.blockLength-1;c.putBytes(K9.substr(0,a.blockLength-l));for(var f,h,d=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)f=a.fullMessageLength[p+1]*8,h=f/4294967296>>>0,d+=h,c.putInt32(d>>>0),d=f>>>0;c.putInt32(d);for(var y=new Array(r.length),p=0;p<r.length;++p)y[p]=r[p].slice(0);iK(y,i,c);var b=Mr.util.createBuffer(),m;t==="SHA-512"?m=y.length:t==="SHA-384"?m=y.length-2:m=y.length-4;for(var p=0;p<m;++p)b.putInt32(y[p][0]),(p!==m-1||t!=="SHA-512/224")&&b.putInt32(y[p][1]);return b},a};var K9=null,oK=!1,j9=null,ch=null;function NPe(){K9=String.fromCharCode(128),K9+=Mr.util.fillString(String.fromCharCode(0),128),j9=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],ch={},ch["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],ch["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],ch["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],ch["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],oK=!0}function iK(t,e,r){for(var n,i,s,o,a,c,u,l,f,h,d,p,y,b,m,_,R,k,P,x,D,U,M,ae,ne,de,me,Ke,xe,Ue,ie,Ve,pt,Je,et,pe=r.length();pe>=128;){for(xe=0;xe<16;++xe)e[xe][0]=r.getInt32()>>>0,e[xe][1]=r.getInt32()>>>0;for(;xe<80;++xe)Ve=e[xe-2],Ue=Ve[0],ie=Ve[1],n=((Ue>>>19|ie<<13)^(ie>>>29|Ue<<3)^Ue>>>6)>>>0,i=((Ue<<13|ie>>>19)^(ie<<3|Ue>>>29)^(Ue<<26|ie>>>6))>>>0,Je=e[xe-15],Ue=Je[0],ie=Je[1],s=((Ue>>>1|ie<<31)^(Ue>>>8|ie<<24)^Ue>>>7)>>>0,o=((Ue<<31|ie>>>1)^(Ue<<24|ie>>>8)^(Ue<<25|ie>>>7))>>>0,pt=e[xe-7],et=e[xe-16],ie=i+pt[1]+o+et[1],e[xe][0]=n+pt[0]+s+et[0]+(ie/4294967296>>>0)>>>0,e[xe][1]=ie>>>0;for(y=t[0][0],b=t[0][1],m=t[1][0],_=t[1][1],R=t[2][0],k=t[2][1],P=t[3][0],x=t[3][1],D=t[4][0],U=t[4][1],M=t[5][0],ae=t[5][1],ne=t[6][0],de=t[6][1],me=t[7][0],Ke=t[7][1],xe=0;xe<80;++xe)u=((D>>>14|U<<18)^(D>>>18|U<<14)^(U>>>9|D<<23))>>>0,l=((D<<18|U>>>14)^(D<<14|U>>>18)^(U<<23|D>>>9))>>>0,f=(ne^D&(M^ne))>>>0,h=(de^U&(ae^de))>>>0,a=((y>>>28|b<<4)^(b>>>2|y<<30)^(b>>>7|y<<25))>>>0,c=((y<<4|b>>>28)^(b<<30|y>>>2)^(b<<25|y>>>7))>>>0,d=(y&m|R&(y^m))>>>0,p=(b&_|k&(b^_))>>>0,ie=Ke+l+h+j9[xe][1]+e[xe][1],n=me+u+f+j9[xe][0]+e[xe][0]+(ie/4294967296>>>0)>>>0,i=ie>>>0,ie=c+p,s=a+d+(ie/4294967296>>>0)>>>0,o=ie>>>0,me=ne,Ke=de,ne=M,de=ae,M=D,ae=U,ie=x+i,D=P+n+(ie/4294967296>>>0)>>>0,U=ie>>>0,P=R,x=k,R=m,k=_,m=y,_=b,ie=i+o,y=n+s+(ie/4294967296>>>0)>>>0,b=ie>>>0;ie=t[0][1]+b,t[0][0]=t[0][0]+y+(ie/4294967296>>>0)>>>0,t[0][1]=ie>>>0,ie=t[1][1]+_,t[1][0]=t[1][0]+m+(ie/4294967296>>>0)>>>0,t[1][1]=ie>>>0,ie=t[2][1]+k,t[2][0]=t[2][0]+R+(ie/4294967296>>>0)>>>0,t[2][1]=ie>>>0,ie=t[3][1]+x,t[3][0]=t[3][0]+P+(ie/4294967296>>>0)>>>0,t[3][1]=ie>>>0,ie=t[4][1]+U,t[4][0]=t[4][0]+D+(ie/4294967296>>>0)>>>0,t[4][1]=ie>>>0,ie=t[5][1]+ae,t[5][0]=t[5][0]+M+(ie/4294967296>>>0)>>>0,t[5][1]=ie>>>0,ie=t[6][1]+de,t[6][0]=t[6][0]+ne+(ie/4294967296>>>0)>>>0,t[6][1]=ie>>>0,ie=t[7][1]+Ke,t[7][0]=t[7][0]+me+(ie/4294967296>>>0)>>>0,t[7][1]=ie>>>0,pe-=128}}});var uK=g((Rpt,cK)=>{"use strict";function BPe(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>65536)for(;r<t;)r+65536>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+65536)),r+=65536);else crypto.getRandomValues(e);return e}cK.exports=BPe});var M2=g((Ipt,lK)=>{"use strict";var LPe=uK(),MPe=oe();lK.exports=function(t){if(isNaN(t)||t<=0)throw MPe(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return LPe(t)}});var F6=g(U2=>{"use strict";Tr();M6();var UPe=Pt(),{fromString:qPe}=(dt(),se(nn)),{toString:fK}=(st(),se(hr)),{concat:hK}=(Pn(),se(Ui));U2.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=hK([new Uint8Array(e-r.length),r])}return fK(r,"base64url")};U2.base64urlToBigInteger=t=>{let e=U2.base64urlToBuffer(t);return new UPe.jsbn.BigInteger(fK(e,"base16"),16)};U2.base64urlToBuffer=(t,e)=>{let r=qPe(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=hK([new Uint8Array(e-r.length),r])}return r}});var yK=g(q2=>{"use strict";wl();N2();var El=Pt(),{bigIntegerToUintBase64url:Qa,base64urlToBigInteger:Za}=F6(),{fromString:dK}=(dt(),se(nn)),{toString:pK}=(st(),se(hr));q2.pkcs1ToJwk=function(t){let e=El.asn1.fromDer(pK(t,"ascii")),r=El.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Qa(r.n),e:Qa(r.e),d:Qa(r.d),p:Qa(r.p),q:Qa(r.q),dp:Qa(r.dP),dq:Qa(r.dQ),qi:Qa(r.qInv),alg:"RS256",kid:"2011-04-29"}};q2.jwkToPkcs1=function(t){let e=El.pki.privateKeyToAsn1({n:Za(t.n),e:Za(t.e),d:Za(t.d),p:Za(t.p),q:Za(t.q),dP:Za(t.dp),dQ:Za(t.dq),qInv:Za(t.qi)});return dK(El.asn1.toDer(e).getBytes(),"ascii")};q2.pkixToJwk=function(t){let e=El.asn1.fromDer(pK(t,"ascii")),r=El.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Qa(r.n),e:Qa(r.e),alg:"RS256",kid:"2011-04-29"}};q2.jwkToPkix=function(t){let e=El.pki.publicKeyToAsn1({n:Za(t.n),e:Za(t.e)});return dK(El.asn1.toDer(e).getBytes(),"ascii")}});var bK=g((Ppt,wK)=>{"use strict";N2();var gK=Pt(),{base64urlToBigInteger:FPe}=F6();function mK(t,e){return e.map(r=>FPe(t[r]))}function KPe(t){return gK.pki.setRsaPrivateKey(...mK(t,["n","e","d","p","q","dp","dq","qi"]))}function jPe(t){return gK.pki.setRsaPublicKey(...mK(t,["n","e"]))}wK.exports={jwk2pub:jPe,jwk2priv:KPe}});var EK=g(ou=>{"use strict";var su=B2(),VPe=M2(),{toString:zPe}=(st(),se(hr)),{fromString:HPe}=(dt(),se(nn));ou.utils=yK();ou.generateKey=async function(t){let e=await su.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await _K(e);return{privateKey:r[0],publicKey:r[1]}};ou.unmarshalPrivateKey=async function(t){let r=[await su.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await $Pe(t)],n=await _K({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}};ou.getRandomValues=VPe;ou.hashAndSign=async function(t,e){let r=await su.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await su.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,n.byteOffset,n.byteLength)};ou.hashAndVerify=async function(t,e,r){let n=await su.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return su.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)};function _K(t){return Promise.all([su.get().subtle.exportKey("jwk",t.privateKey),su.get().subtle.exportKey("jwk",t.publicKey)])}function $Pe(t){return su.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:GPe,jwk2priv:WPe}=bK();function vK(t,e,r,n){let i=e?GPe(t):WPe(t),s=zPe(Uint8Array.from(r),"ascii"),o=n(s,i);return HPe(o,"ascii")}ou.encrypt=function(t,e){return vK(t,!0,e,(r,n)=>n.encrypt(r))};ou.decrypt=function(t,e){return vK(t,!1,e,(r,n)=>n.decrypt(r))}});var K6=g((Opt,SK)=>{"use strict";var{base64:YPe}=(ol(),se(Xf)),XPe=F9();SK.exports={export:async function(t,e){let n=await XPe.create().encrypt(t,e);return YPe.encode(n)}}});var xK=g((kpt,TK)=>{"use strict";var{sha256:RK}=(Tn(),se(Js)),AK=oe(),{equals:IK}=(bn(),se(Ei)),{toString:QPe}=(st(),se(hr));V9();var j6=Pt(),oo=EK(),V6=E6(),ZPe=K6(),z6=class{constructor(e){this._key=e}async verify(e,r){return oo.hashAndVerify(this._key,r,e)}marshal(){return oo.utils.jwkToPkix(this._key)}get bytes(){return V6.PublicKey.encode({Type:V6.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return oo.encrypt(this._key,e)}equals(e){return IK(this.bytes,e.bytes)}async hash(){let{bytes:e}=await RK.digest(this.bytes);return e}},F2=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return oo.getRandomValues(16)}async sign(e){return oo.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw AK(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new z6(this._publicKey)}decrypt(e){return oo.decrypt(this._key,e)}marshal(){return oo.utils.jwkToPkcs1(this._key)}get bytes(){return V6.PrivateKey.encode({Type:V6.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return IK(this.bytes,e.bytes)}async hash(){let{bytes:e}=await RK.digest(this.bytes);return e}async id(){let e=await this.public.hash();return QPe(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new j6.util.ByteBuffer(this.marshal()),i=j6.asn1.fromDer(n),s=j6.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return j6.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return ZPe.export(this.bytes,e);throw AK(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function JPe(t){let e=oo.utils.pkcs1ToJwk(t),r=await oo.unmarshalPrivateKey(e);return new F2(r.privateKey,r.publicKey)}function eCe(t){let e=oo.utils.pkixToJwk(t);return new z6(e)}async function tCe(t){let e=await oo.unmarshalPrivateKey(t);return new F2(e.privateKey,e.publicKey)}async function rCe(t){let e=await oo.generateKey(t);return new F2(e.privateKey,e.publicKey)}TK.exports={RsaPublicKey:z6,RsaPrivateKey:F2,unmarshalRsaPublicKey:eCe,unmarshalRsaPrivateKey:JPe,generateKeyPair:rCe,fromJwk:tCe}});var UK=g(rr=>{"use strict";var nCe=rr&&rr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(rr,"__esModule",{value:!0});rr.utils=rr.curve25519=rr.getSharedSecret=rr.verify=rr.sign=rr.getPublicKey=rr.Signature=rr.Point=rr.RistrettoPoint=rr.ExtendedPoint=rr.CURVE=void 0;var iCe=nCe(nh()),Jr=BigInt(0),Ot=BigInt(1),di=BigInt(2),kK=BigInt(255),PK=di**BigInt(252)+BigInt("27742317777372353535851937790883648493"),mr={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:di**kK-BigInt(19),l:PK,n:PK,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};rr.CURVE=mr;var DK=di**BigInt(256),K2=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Dpt=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),sCe=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),oCe=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),aCe=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),cCe=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),$t=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof Hr))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Hr.ZERO)?$t.ZERO:new $t(e.x,e.y,Ot,le(e.x*e.y))}static toAffineBatch(e){let r=fCe(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){CK(e);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e,c=le(r*a),u=le(s*i),l=le(n*a),f=le(o*i);return c===u&&l===f}negate(){return new $t(le(-this.x),this.y,this.z,le(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=mr,s=le(e**di),o=le(r**di),a=le(di*le(n**di)),c=le(i*s),u=le(le((e+r)**di)-s-o),l=c+o,f=l-a,h=c-o,d=le(u*f),p=le(l*h),y=le(u*h),b=le(f*l);return new $t(d,p,b,y)}add(e){CK(e);let{x:r,y:n,z:i,t:s}=this,{x:o,y:a,z:c,t:u}=e,l=le((n-r)*(a+o)),f=le((n+r)*(a-o)),h=le(f-l);if(h===Jr)return this.double();let d=le(i*di*u),p=le(s*di*c),y=p+d,b=f+l,m=p-d,_=le(y*h),R=le(b*m),k=le(y*m),P=le(h*b);return new $t(_,R,P,k)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals($t.BASE)&&(r=Hr.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&G9.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=$t.normalizeZ(i),G9.set(r,i)));let s=$t.ZERO,o=$t.ZERO,a=1+256/n,c=2**(n-1),u=BigInt(2**n-1),l=2**n,f=BigInt(n);for(let h=0;h<a;h++){let d=h*c,p=Number(e&u);if(e>>=f,p>c&&(p-=l,e+=Ot),p===0){let y=i[d];h%2&&(y=y.negate()),o=o.add(y)}else{let y=i[d+Math.abs(p)-1];p<0&&(y=y.negate()),s=s.add(y)}}return $t.normalizeZ([s,o])[0]}multiply(e,r){return this.wNAF(Yp(e,mr.l),r)}multiplyUnsafe(e){let r=Yp(e,mr.l,!1),n=$t.BASE,i=$t.ZERO;if(r===Jr)return i;if(this.equals(i)||r===Ot)return this;if(this.equals(n))return this.wNAF(r);let s=i,o=this;for(;r>Jr;)r&Ot&&(s=s.add(o)),o=o.double(),r>>=Ot;return s}isSmallOrder(){return this.multiplyUnsafe(mr.h).equals($t.ZERO)}isTorsionFree(){return this.multiplyUnsafe(mr.l).equals($t.ZERO)}toAffine(e=$6(this.z)){let{x:r,y:n,z:i}=this,s=le(r*e),o=le(n*e);if(le(i*e)!==Ot)throw new Error("invZ was invalid");return new Hr(s,o)}fromRistrettoBytes(){H9()}toRistrettoBytes(){H9()}fromRistrettoHash(){H9()}};rr.ExtendedPoint=$t;$t.BASE=new $t(mr.Gx,mr.Gy,Ot,le(mr.Gx*mr.Gy));$t.ZERO=new $t(Jr,Ot,Ot,Jr);function CK(t){if(!(t instanceof $t))throw new TypeError("ExtendedPoint expected")}function z9(t){if(!(t instanceof ss))throw new TypeError("RistrettoPoint expected")}function H9(){throw new Error("Legacy method: switch to RistrettoPoint")}var ss=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=mr,n=le(K2*e*e),i=le((n+Ot)*aCe),s=BigInt(-1),o=le((s-r*n)*le(n+r)),{isValid:a,value:c}=Y9(i,o),u=le(c*e);Al(u)||(u=le(-u)),a||(c=u),a||(s=n);let l=le(s*(n-Ot)*cCe-o),f=c*c,h=le((c+c)*o),d=le(l*sCe),p=le(Ot-f),y=le(Ot+f);return new $t(le(h*y),le(p*d),le(d*y),le(h*p))}static hashToCurve(e){e=Ja(e,64);let r=$9(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=$9(e.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new ss(n.add(s))}static fromHex(e){e=Ja(e,32);let{a:r,d:n}=mr,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=$9(e);if(!hCe(Wp(s),e)||Al(s))throw new Error(i);let o=le(s*s),a=le(Ot+r*o),c=le(Ot-r*o),u=le(a*a),l=le(c*c),f=le(r*n*u-l),{isValid:h,value:d}=OK(le(f*l)),p=le(d*c),y=le(d*p*f),b=le((s+s)*p);Al(b)&&(b=le(-b));let m=le(a*y),_=le(b*m);if(!h||Al(_)||m===Jr)throw new Error(i);return new ss(new $t(b,m,Ot,_))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,s=le(le(n+r)*le(n-r)),o=le(e*r),{value:a}=OK(le(s*o**di)),c=le(a*s),u=le(a*o),l=le(c*u*i),f;if(Al(i*l)){let d=le(r*K2),p=le(e*K2);e=d,r=p,f=le(c*oCe)}else f=u;Al(e*l)&&(r=le(-r));let h=le((n-r)*f);return Al(h)&&(h=le(-h)),Wp(h)}toHex(){return j2(this.toRawBytes())}toString(){return this.toHex()}equals(e){z9(e);let r=this.ep,n=e.ep,i=le(r.x*n.y)===le(r.y*n.x),s=le(r.y*n.y)===le(r.x*n.x);return i||s}add(e){return z9(e),new ss(this.ep.add(e.ep))}subtract(e){return z9(e),new ss(this.ep.subtract(e.ep))}multiply(e){return new ss(this.ep.multiply(e))}multiplyUnsafe(e){return new ss(this.ep.multiplyUnsafe(e))}};rr.RistrettoPoint=ss;ss.BASE=new ss($t.BASE);ss.ZERO=new ss($t.ZERO);var G9=new WeakMap,Hr=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,G9.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=mr;e=Ja(e,32);let s=e.slice();s[31]=e[31]&-129;let o=Rl(s);if(r&&o>=i)throw new Error("Expected 0 < hex < P");if(!r&&o>=DK)throw new Error("Expected 0 < hex < 2**256");let a=le(o*o),c=le(a-Ot),u=le(n*a+Ot),{isValid:l,value:f}=Y9(c,u);if(!l)throw new Error("Point.fromHex: invalid y coordinate");let h=(f&Ot)===Ot;return(e[31]&128)!==0!==h&&(f=le(-f)),new Hr(f,o)}static async fromPrivateKey(e){return(await V2(e)).point}toRawBytes(){let e=Wp(this.y);return e[31]|=this.x&Ot?128:0,e}toHex(){return j2(this.toRawBytes())}toX25519(){let{y:e}=this,r=le((Ot+e)*$6(Ot-e));return Wp(r)}isTorsionFree(){return $t.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Hr(le(-this.x),this.y)}add(e){return $t.fromAffine(this).add($t.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return $t.fromAffine(this).multiply(e,this).toAffine()}};rr.Point=Hr;Hr.BASE=new Hr(mr.Gx,mr.Gy);Hr.ZERO=new Hr(Jr,Ot);var uh=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=Ja(e,64),n=Hr.fromHex(r.slice(0,32),!1),i=Rl(r.slice(32,64));return new uh(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof Hr))throw new Error("Expected Point instance");return Yp(r,mr.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Wp(this.s),32),e}toHex(){return j2(this.toRawBytes())}};rr.Signature=uh;function uCe(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var lCe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function j2(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=lCe[t[r]];return e}function NK(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function BK(t){let r=t.toString(16).padStart(64,"0");return NK(r)}function Wp(t){return BK(t).reverse()}function Al(t){return(le(t)&Ot)===Ot}function Rl(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+j2(Uint8Array.from(t).reverse()))}function $9(t){return le(Rl(t)&di**kK-Ot)}function le(t,e=mr.P){let r=t%e;return r>=Jr?r:e+r}function $6(t,e=mr.P){if(t===Jr||e<=Jr)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=le(t,e),n=e,i=Jr,s=Ot,o=Ot,a=Jr;for(;r!==Jr;){let u=n/r,l=n%r,f=i-o*u,h=s-a*u;n=r,r=l,i=o,s=a,o=f,a=h}if(n!==Ot)throw new Error("invert: does not exist");return le(i,e)}function fCe(t,e=mr.P){let r=new Array(t.length),n=t.reduce((s,o,a)=>o===Jr?s:(r[a]=s,le(s*o,e)),Ot),i=$6(n,e);return t.reduceRight((s,o,a)=>o===Jr?s:(r[a]=le(s*r[a],e),le(s*o,e)),i),r}function aa(t,e){let{P:r}=mr,n=t;for(;e-- >Jr;)n*=n,n%=r;return n}function LK(t){let{P:e}=mr,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),o=BigInt(80),c=t*t%e*t%e,u=aa(c,di)*c%e,l=aa(u,Ot)*t%e,f=aa(l,r)*l%e,h=aa(f,n)*f%e,d=aa(h,i)*h%e,p=aa(d,s)*d%e,y=aa(p,o)*p%e,b=aa(y,o)*p%e,m=aa(b,n)*f%e;return{pow_p_5_8:aa(m,di)*t%e,b2:c}}function Y9(t,e){let r=le(e*e*e),n=le(r*r*e),i=LK(t*n).pow_p_5_8,s=le(t*r*i),o=le(e*s*s),a=s,c=le(s*K2),u=o===t,l=o===le(-t),f=o===le(-t*K2);return u&&(s=a),(l||f)&&(s=c),Al(s)&&(s=le(-s)),{isValid:u||l,value:s}}function OK(t){return Y9(Ot,t)}async function W9(...t){let e=await rr.utils.sha512(uCe(...t)),r=Rl(e);return le(r,mr.l)}function hCe(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Ja(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):NK(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Yp(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(Jr<t)return t}else if(Jr<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function MK(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function dCe(t){return Rl(MK(Ja(t,32)))}async function V2(t){if(t=typeof t=="bigint"||typeof t=="number"?BK(Yp(t,DK)):Ja(t),t.length!==32)throw new Error("Expected 32 bytes");let e=await rr.utils.sha512(t),r=MK(e.slice(0,32)),n=e.slice(32,64),i=le(Rl(r),mr.l),s=Hr.BASE.multiply(i),o=s.toRawBytes();return{head:r,prefix:n,scalar:i,point:s,pointBytes:o}}async function pCe(t){return(await V2(t)).pointBytes}rr.getPublicKey=pCe;async function yCe(t,e){t=Ja(t);let{prefix:r,scalar:n,pointBytes:i}=await V2(e),s=await W9(r,t),o=Hr.BASE.multiply(s),a=await W9(o.toRawBytes(),i,t),c=le(s+a*n,mr.l);return new uh(o,c).toRawBytes()}rr.sign=yCe;async function gCe(t,e,r){e=Ja(e),r instanceof Hr||(r=Hr.fromHex(r,!1));let{r:n,s:i}=t instanceof uh?t.assertValidity():uh.fromHex(t),s=$t.BASE.multiplyUnsafe(i),o=await W9(n.toRawBytes(),r.toRawBytes(),e),a=$t.fromAffine(r).multiplyUnsafe(o);return $t.fromAffine(n).add(a).subtract(s).multiplyUnsafe(mr.h).equals($t.ZERO)}rr.verify=gCe;async function mCe(t,e){let{head:r}=await V2(t),n=Hr.fromHex(e).toX25519();return rr.curve25519.scalarMult(r,n)}rr.getSharedSecret=mCe;Hr.BASE._setWindowSize(8);function H6(t,e,r){let n=le(t*(e-r));return e=le(e-n),r=le(r+n),[e,r]}function wCe(t,e){let{P:r}=mr,n=Yp(t,r),i=Yp(e,r),s=BigInt(121665),o=n,a=Ot,c=Jr,u=n,l=Ot,f=Jr,h;for(let b=BigInt(255-1);b>=Jr;b--){let m=i>>b&Ot;f^=m,h=H6(f,a,u),a=h[0],u=h[1],h=H6(f,c,l),c=h[0],l=h[1],f=m;let _=a+c,R=le(_*_),k=a-c,P=le(k*k),x=R-P,D=u+l,U=u-l,M=le(U*_),ae=le(D*k);u=le((M+ae)**di),l=le(o*(M-ae)**di),a=le(R*P),c=le(x*(R+le(s*x)))}h=H6(f,a,u),a=h[0],u=h[1],h=H6(f,c,l),c=h[0],l=h[1];let{pow_p_5_8:d,b2:p}=LK(c),y=le(aa(d,BigInt(3))*p);return le(a*y)}function bCe(t){return Wp(le(t,mr.P))}function _Ce(t){let e=Ja(t,32);return e[31]&=127,Rl(e)}rr.curve25519={BASE_POINT_U:"0900000000000000000000000000000000000000000000000000000000000000",scalarMult(t,e){let r=_Ce(e),n=dCe(t),i=wCe(r,n);if(i===Jr)throw new Error("Invalid private or public key received");return bCe(i)},scalarMultBase(t){return rr.curve25519.scalarMult(t,rr.curve25519.BASE_POINT_U)}};var Sl={node:iCe.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};rr.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:j2,getExtendedPublicKey:V2,mod:le,invert:$6,hashToPrivateScalar:t=>{if(t=Ja(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=le(Rl(t),mr.l);if(e===Jr||e===Ot)throw new Error("Invalid private key");return e},randomBytes:(t=32)=>{if(Sl.web)return Sl.web.getRandomValues(new Uint8Array(t));if(Sl.node){let{randomBytes:e}=Sl.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>rr.utils.randomBytes(32),sha512:async t=>{if(Sl.web){let e=await Sl.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(Sl.node)return Uint8Array.from(Sl.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=Hr.BASE){let r=e.equals(Hr.BASE)?e:new Hr(e.x,e.y);return r._setWindowSize(t),r.multiply(di),r}}});var FK=g(Il=>{"use strict";var z2=UK(),vCe=32,ECe=64,G6=32;Il.publicKeyLength=vCe;Il.privateKeyLength=ECe;Il.generateKey=async function(){let t=z2.utils.randomPrivateKey(),e=await z2.getPublicKey(t);return{privateKey:qK(t,e),publicKey:e}};Il.generateKeyFromSeed=async function(t){if(t.length!==G6)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await z2.getPublicKey(e);return{privateKey:qK(e,r),publicKey:r}};Il.hashAndSign=function(t,e){let r=t.slice(0,G6);return z2.sign(e,r)};Il.hashAndVerify=function(t,e,r){return z2.verify(e,r,t)};function qK(t,e){let r=new Uint8Array(Il.privateKeyLength);for(let n=0;n<G6;n++)r[n]=t[n],r[G6+n]=e[n];return r}});var HK=g((Lpt,zK)=>{"use strict";var KK=oe(),{equals:jK}=(bn(),se(Ei)),{sha256:VK}=(Tn(),se(Js)),{base58btc:SCe}=(wn(),se(Zo)),{identity:ACe}=(Zc(),se(h2)),Ii=FK(),W6=E6(),RCe=K6(),Y6=class{constructor(e){this._key=Qp(e,Ii.publicKeyLength)}async verify(e,r){return Ii.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return W6.PublicKey.encode({Type:W6.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return jK(this.bytes,e.bytes)}async hash(){let{bytes:e}=await VK.digest(this.bytes);return e}},Xp=class{constructor(e,r){this._key=Qp(e,Ii.privateKeyLength),this._publicKey=Qp(r,Ii.publicKeyLength)}async sign(e){return Ii.hashAndSign(this._key,e)}get public(){return new Y6(this._publicKey)}marshal(){return this._key}get bytes(){return W6.PrivateKey.encode({Type:W6.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return jK(this.bytes,e.bytes)}async hash(){let{bytes:e}=await VK.digest(this.bytes);return e}async id(){let e=await ACe.digest(this.public.bytes);return SCe.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return RCe.export(this.bytes,e);throw KK(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function ICe(t){if(t.length>Ii.privateKeyLength){t=Qp(t,Ii.privateKeyLength+Ii.publicKeyLength);let n=t.slice(0,Ii.privateKeyLength),i=t.slice(Ii.privateKeyLength,t.length);return new Xp(n,i)}t=Qp(t,Ii.privateKeyLength);let e=t.slice(0,Ii.privateKeyLength),r=t.slice(Ii.publicKeyLength);return new Xp(e,r)}function TCe(t){return t=Qp(t,Ii.publicKeyLength),new Y6(t)}async function xCe(){let{privateKey:t,publicKey:e}=await Ii.generateKey();return new Xp(t,e)}async function PCe(t){let{privateKey:e,publicKey:r}=await Ii.generateKeyFromSeed(t);return new Xp(e,r)}function Qp(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw KK(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}zK.exports={Ed25519PublicKey:Y6,Ed25519PrivateKey:Xp,unmarshalEd25519PrivateKey:ICe,unmarshalEd25519PublicKey:TCe,generateKeyPair:xCe,generateKeyPairFromSeed:PCe}});var cj=g(jt=>{"use strict";var CCe=jt&&jt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(jt,"__esModule",{value:!0});jt.utils=jt.schnorr=jt.verify=jt.signSync=jt.sign=jt.getSharedSecret=jt.recoverPublicKey=jt.getPublicKey=jt.Signature=jt.Point=jt.CURVE=void 0;var OCe=CCe(nh()),Lt=BigInt(0),Ur=BigInt(1),_n=BigInt(2),$2=BigInt(3),kCe=BigInt(8),X9=_n**BigInt(256),wr={a:Lt,b:BigInt(7),P:X9-_n**BigInt(32)-BigInt(977),n:X9-BigInt("432420386565659656852420866394968145599"),h:Ur,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};jt.CURVE=wr;function $K(t){let{a:e,b:r}=wr,n=Me(t*t),i=Me(n*t);return Me(i+e*t+r)}var X6=wr.a===Lt,sr=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof or))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new sr(e.x,e.y,Ur)}static toAffineBatch(e){let r=LCe(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return sr.toAffineBatch(e).map(sr.fromAffine)}equals(e){if(!(e instanceof sr))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e,c=Me(i**_n),u=Me(a**_n),l=Me(r*u),f=Me(s*c),h=Me(Me(n*a)*u),d=Me(Me(o*i)*c);return l===f&&h===d}negate(){return new sr(this.x,Me(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=Me(e**_n),s=Me(r**_n),o=Me(s**_n),a=Me(_n*(Me((e+s)**_n)-i-o)),c=Me($2*i),u=Me(c**_n),l=Me(u-_n*a),f=Me(c*(a-l)-kCe*o),h=Me(_n*r*n);return new sr(l,f,h)}add(e){if(!(e instanceof sr))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e;if(s===Lt||o===Lt)return this;if(r===Lt||n===Lt)return e;let c=Me(i**_n),u=Me(a**_n),l=Me(r*u),f=Me(s*c),h=Me(Me(n*a)*u),d=Me(Me(o*i)*c),p=Me(f-l),y=Me(d-h);if(p===Lt)return y===Lt?this.double():sr.ZERO;let b=Me(p**_n),m=Me(p*b),_=Me(l*b),R=Me(y**_n-m-_n*_),k=Me(y*(_-R)-h*m),P=Me(i*a*p);return new sr(R,k,P)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=YK(e),n=sr.BASE,i=sr.ZERO;if(r===Lt)return i;if(r===Ur)return this;if(!X6){let h=i,d=this;for(;r>Lt;)r&Ur&&(h=h.add(d)),d=d.double(),r>>=Ur;return h}let{k1neg:s,k1:o,k2neg:a,k2:c}=QK(r),u=i,l=i,f=this;for(;o>Lt||c>Lt;)o&Ur&&(u=u.add(f)),c&Ur&&(l=l.add(f)),f=f.double(),o>>=Ur,c>>=Ur;return s&&(u=u.negate()),a&&(l=l.negate()),l=new sr(Me(l.x*wr.beta),l.y,l.z),u.add(l)}precomputeWindow(e){let r=X6?128/e+1:256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(sr.BASE)&&(r=or.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Q9.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=sr.normalizeZ(i),Q9.set(r,i)));let s=sr.ZERO,o=sr.ZERO,a=1+(X6?128/n:256/n),c=2**(n-1),u=BigInt(2**n-1),l=2**n,f=BigInt(n);for(let h=0;h<a;h++){let d=h*c,p=Number(e&u);if(e>>=f,p>c&&(p-=l,e+=Ur),p===0){let y=i[d];h%2&&(y=y.negate()),o=o.add(y)}else{let y=i[d+Math.abs(p)-1];p<0&&(y=y.negate()),s=s.add(y)}}return{p:s,f:o}}multiply(e,r){let n=YK(e),i,s;if(X6){let{k1neg:o,k1:a,k2neg:c,k2:u}=QK(n),{p:l,f}=this.wNAF(a,r),{p:h,f:d}=this.wNAF(u,r);o&&(l=l.negate()),c&&(h=h.negate()),h=new sr(Me(h.x*wr.beta),h.y,h.z),i=l.add(h),s=f.add(d)}else{let{p:o,f:a}=this.wNAF(n,r);i=o,s=a}return sr.normalizeZ([i,s])[0]}toAffine(e=W2(this.z)){let{x:r,y:n,z:i}=this,s=e,o=Me(s*s),a=Me(o*s),c=Me(r*o),u=Me(n*a);if(Me(i*s)!==Ur)throw new Error("invZ was invalid");return new or(c,u)}};sr.BASE=new sr(wr.Gx,wr.Gy,Ur);sr.ZERO=new sr(Lt,Ur,Lt);var Q9=new WeakMap,or=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Q9.delete(this)}static fromCompressedHex(e){let r=e.length===32,n=co(r?e:e.subarray(1));if(!Z6(n))throw new Error("Point is not on curve");let i=$K(n),s=BCe(i),o=(s&Ur)===Ur;r?o&&(s=Me(-s)):(e[0]&1)===1!==o&&(s=Me(-s));let a=new or(n,s);return a.assertValidity(),a}static fromUncompressedHex(e){let r=co(e.subarray(1,33)),n=co(e.subarray(33,65)),i=new or(r,n);return i.assertValidity(),i}static fromHex(e){let r=tc(e),n=r.length,i=r[0];if(n===32||n===33&&(i===2||i===3))return this.fromCompressedHex(r);if(n===65&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return or.BASE.multiply(e0(e))}static fromSignature(e,r,n){e=tc(e);let i=JK(e),{r:s,s:o}=tj(r);if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid recovery bit");if(i===Lt)throw new Error("Cannot recover signature: msgHash cannot be 0");let a=n&1?"03":"02",c=or.fromHex(a+au(s)),{n:u}=wr,l=W2(s,u),f=Me(-i*l,u),h=Me(o*l,u),d=or.BASE.multiplyAndAddUnsafe(c,f,h);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(e=!1){return Tl(this.toHex(e))}toHex(e=!1){let r=au(this.x);return e?`${this.y&Ur?"03":"02"}${r}`:`04${r}${au(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!Z6(r)||!Z6(n))throw new Error(e);let i=Me(n*n),s=$K(r);if(Me(i-s)!==Lt)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new or(this.x,Me(-this.y))}double(){return sr.fromAffine(this).double().toAffine()}add(e){return sr.fromAffine(this).add(sr.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return sr.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let s=sr.fromAffine(this).multiply(r),o=sr.fromAffine(e).multiplyUnsafe(n),a=s.add(o);return a.equals(sr.ZERO)?void 0:a.toAffine()}};jt.Point=or;or.BASE=new or(wr.Gx,wr.Gy);or.ZERO=new or(Lt,Lt);function GK(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function WK(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${Zp(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:co(r),left:t.subarray(e+2)}}function DCe(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${Zp(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=WK(t.subarray(2)),{data:n,left:i}=WK(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${Zp(i)}`);return{r:e,s:n}}var ec=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=G2(e),n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?Zp(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new ec(J6(i.slice(0,64)),J6(i.slice(64,128)))}static fromDER(e){let r=G2(e);if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=DCe(r?e:Tl(e));return new ec(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!Jp(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Jp(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=wr.n>>Ur;return this.s>e}normalizeS(){return this.hasHighS()?new ec(this.r,wr.n-this.s):this}toDERRawBytes(e=!1){return Tl(this.toDERHex(e))}toDERHex(e=!1){let r=GK(H2(this.s));if(e)return r;let n=GK(H2(this.r)),i=H2(n.length/2),s=H2(r.length/2);return`30${H2(n.length/2+r.length/2+4)}02${i}${n}02${s}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Tl(this.toCompactHex())}toCompactHex(){return au(this.r)+au(this.s)}};jt.Signature=ec;function eS(...t){if(!t.every(G2))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}function G2(t){return t instanceof Uint8Array}var NCe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Zp(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=NCe[t[r]];return e}function au(t){if(t>X9)throw new Error("Expected number < 2^256");return t.toString(16).padStart(64,"0")}function tS(t){return Tl(au(t))}function H2(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function J6(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Tl(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function co(t){return J6(Zp(t))}function tc(t){return t instanceof Uint8Array?Uint8Array.from(t):Tl(t)}function YK(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&Jp(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function Me(t,e=wr.P){let r=t%e;return r>=Lt?r:e+r}function ao(t,e){let{P:r}=wr,n=t;for(;e-- >Lt;)n*=n,n%=r;return n}function BCe(t){let{P:e}=wr,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),c=t*t*t%e,u=c*c*t%e,l=ao(u,$2)*u%e,f=ao(l,$2)*u%e,h=ao(f,_n)*c%e,d=ao(h,n)*h%e,p=ao(d,i)*d%e,y=ao(p,o)*p%e,b=ao(y,a)*y%e,m=ao(b,o)*p%e,_=ao(m,$2)*u%e,R=ao(_,s)*d%e,k=ao(R,r)*c%e;return ao(k,_n)}function W2(t,e=wr.P){if(t===Lt||e<=Lt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Me(t,e),n=e,i=Lt,s=Ur,o=Ur,a=Lt;for(;r!==Lt;){let u=n/r,l=n%r,f=i-o*u,h=s-a*u;n=r,r=l,i=o,s=a,o=f,a=h}if(n!==Ur)throw new Error("invert: does not exist");return Me(i,e)}function LCe(t,e=wr.P){let r=new Array(t.length),n=t.reduce((s,o,a)=>o===Lt?s:(r[a]=s,Me(s*o,e)),Ur),i=W2(n,e);return t.reduceRight((s,o,a)=>o===Lt?s:(r[a]=Me(s*r[a],e),Me(s*o,e)),i),r}var XK=(t,e)=>(t+e/_n)/e,Q6=_n**BigInt(128);function QK(t){let{n:e}=wr,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Ur*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=XK(s*t,e),a=XK(-n*t,e),c=Me(t-o*r-a*i,e),u=Me(-o*n-a*s,e),l=c>Q6,f=u>Q6;if(l&&(c=e-c),f&&(u=e-u),c>Q6||u>Q6)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:l,k1:c,k2neg:f,k2:u}}function JK(t){let{n:e}=wr,n=t.length*8-256,i=co(t);return n>0&&(i=i>>BigInt(n)),i>=e&&(i-=e),i}var rS=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return jt.utils.hmacSha256(this.k,...e)}hmacSync(...e){if(typeof jt.utils.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let r=jt.utils.hmacSha256Sync(this.k,...e);if(r instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return r}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function Jp(t){return Lt<t&&t<wr.n}function Z6(t){return Lt<t&&t<wr.P}function ej(t,e,r){let n=co(t);if(!Jp(n))return;let{n:i}=wr,s=or.BASE.multiply(n),o=Me(s.x,i);if(o===Lt)return;let a=Me(W2(n,i)*Me(e+r*o,i),i);if(a===Lt)return;let c=new ec(o,a),u=(s.x===c.r?0:2)|Number(s.y&Ur);return{sig:c,recovery:u}}function e0(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=J6(t)}else if(G2(t)){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=co(t)}else throw new TypeError("Expected valid private key");if(!Jp(e))throw new Error("Expected private key: 0 < key < n");return e}function nS(t){return t instanceof or?(t.assertValidity(),t):or.fromHex(t)}function tj(t){if(t instanceof ec)return t.assertValidity(),t;try{return ec.fromDER(t)}catch{return ec.fromCompact(t)}}function MCe(t,e=!1){return or.fromPrivateKey(t).toRawBytes(e)}jt.getPublicKey=MCe;function UCe(t,e,r,n=!1){return or.fromSignature(t,e,r).toRawBytes(n)}jt.recoverPublicKey=UCe;function ZK(t){let e=G2(t),r=typeof t=="string",n=(e||r)&&t.length;return e?n===33||n===65:r?n===66||n===130:t instanceof or}function qCe(t,e,r=!1){if(ZK(t))throw new TypeError("getSharedSecret: first arg must be private key");if(!ZK(e))throw new TypeError("getSharedSecret: second arg must be public key");let n=nS(e);return n.assertValidity(),n.multiply(e0(t)).toRawBytes(r)}jt.getSharedSecret=qCe;function rj(t){let e=t.length>32?t.slice(0,32):t;return co(e)}function FCe(t){let e=rj(t),r=Me(e,wr.n);return nj(r<Lt?e:r)}function nj(t){if(typeof t!="bigint")throw new Error("Expected bigint");let e=au(t);return Tl(e)}function ij(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=tc(t),i=e0(e),s=[nj(i),FCe(n)];if(r!=null){r===!0&&(r=jt.utils.randomBytes(32));let c=tc(r);if(c.length!==32)throw new Error("sign: Expected 32 bytes of extra data");s.push(c)}let o=eS(...s),a=rj(n);return{seed:o,m:a,d:i}}function sj(t,e){let{sig:r,recovery:n}=t,{canonical:i,der:s,recovered:o}=Object.assign({canonical:!0,der:!0},e);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let a=s?r.toDERRawBytes():r.toCompactRawBytes();return o?[a,n]:a}async function KCe(t,e,r={}){let{seed:n,m:i,d:s}=ij(t,e,r.extraEntropy),o,a=new rS;for(await a.reseed(n);!(o=ej(await a.generate(),i,s));)await a.reseed();return sj(o,r)}jt.sign=KCe;function jCe(t,e,r={}){let{seed:n,m:i,d:s}=ij(t,e,r.extraEntropy),o,a=new rS;for(a.reseedSync(n);!(o=ej(a.generateSync(),i,s));)a.reseedSync();return sj(o,r)}jt.signSync=jCe;var VCe={strict:!0};function zCe(t,e,r,n=VCe){let i;try{i=tj(t),e=tc(e)}catch{return!1}let{r:s,s:o}=i;if(n.strict&&i.hasHighS())return!1;let a=JK(e);if(a===Lt)return!1;let c;try{c=nS(r)}catch{return!1}let{n:u}=wr,l=W2(o,u),f=Me(a*l,u),h=Me(s*l,u),d=or.BASE.multiplyAndAddUnsafe(c,f,h);return d?Me(d.x,u)===s:!1}jt.verify=zCe;async function Z9(t,...e){let r=new Uint8Array(t.split("").map(s=>s.charCodeAt(0))),n=await jt.utils.sha256(r),i=await jt.utils.sha256(eS(n,n,...e));return co(i)}async function oj(t,e,r){let n=tS(t),i=await Z9("BIP0340/challenge",n,e.toRawX(),r);return Me(i,wr.n)}function J9(t){return(t.y&Ur)===Lt}var lh=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=tc(e);if(r.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${r.length}`);let n=co(r.subarray(0,32)),i=co(r.subarray(32,64));return new lh(n,i)}assertValidity(){let{r:e,s:r}=this;if(!Z6(e)||!Jp(r))throw new Error("Invalid signature")}toHex(){return au(this.r)+au(this.s)}toRawBytes(){return Tl(this.toHex())}};function HCe(t){return or.fromPrivateKey(t).toRawX()}async function $Ce(t,e,r=jt.utils.randomBytes()){if(t==null)throw new TypeError(`sign: Expected valid message, not "${t}"`);let{n}=wr,i=tc(t),s=e0(e),o=tc(r);if(o.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let a=or.fromPrivateKey(s),c=J9(a)?s:n-s,u=await Z9("BIP0340/aux",o),l=c^u,f=await Z9("BIP0340/nonce",tS(l),a.toRawX(),i),h=Me(f,n);if(h===Lt)throw new Error("sign: Creation of signature failed. k is zero");let d=or.fromPrivateKey(h),p=J9(d)?h:n-h,y=await oj(d.x,a,i),b=new lh(d.x,Me(p+y*c,n)).toRawBytes();if(!await aj(b,i,a.toRawX()))throw new Error("sign: Invalid signature produced");return b}async function aj(t,e,r){let n=t instanceof lh,i;try{i=n?t:lh.fromHex(t),n&&i.assertValidity()}catch{return!1}let{r:s,s:o}=i,a=tc(e),c;try{c=nS(r)}catch{return!1}let u=await oj(s,c,a),l=or.BASE.multiplyAndAddUnsafe(c,e0(o),Me(-u,wr.n));return!(!l||!J9(l)||l.x!==s)}jt.schnorr={Signature:lh,getPublicKey:HCe,sign:$Ce,verify:aj};or.BASE._setWindowSize(8);var Os={node:OCe.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};jt.utils={isValidPrivateKey(t){try{return e0(t),!0}catch{return!1}},hashToPrivateKey:t=>{if(t=tc(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=Me(co(t),wr.n);if(e===Lt||e===Ur)throw new Error("Invalid private key");return tS(e)},randomBytes:(t=32)=>{if(Os.web)return Os.web.getRandomValues(new Uint8Array(t));if(Os.node){let{randomBytes:e}=Os.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>jt.utils.hashToPrivateKey(jt.utils.randomBytes(40)),bytesToHex:Zp,mod:Me,sha256:async t=>{if(Os.web){let e=await Os.web.subtle.digest("SHA-256",t.buffer);return new Uint8Array(e)}else if(Os.node){let{createHash:e}=Os.node;return Uint8Array.from(e("sha256").update(t).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(Os.web){let r=await Os.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=eS(...e),i=await Os.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Os.node){let{createHmac:r}=Os.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(t=8,e=or.BASE){let r=e===or.BASE?e:new or(e.x,e.y);return r._setWindowSize(t),r.multiply($2),r}}});var fj=g((Upt,lj)=>{"use strict";var Y2=oe(),xl=cj(),{sha256:uj}=(Tn(),se(Js));lj.exports=()=>{function e(){return xl.utils.randomPrivateKey()}async function r(u,l){let{digest:f}=await uj.digest(l);try{return await xl.sign(f,u)}catch(h){throw Y2(h,"ERR_INVALID_INPUT")}}async function n(u,l,f){try{let{digest:h}=await uj.digest(f);return xl.verify(l,h,u)}catch(h){throw Y2(h,"ERR_INVALID_INPUT")}}function i(u){return xl.Point.fromHex(u).toRawBytes(!0)}function s(u){return xl.Point.fromHex(u).toRawBytes(!1)}function o(u){try{xl.getPublicKey(u,!0)}catch(l){throw Y2(l,"ERR_INVALID_PRIVATE_KEY")}}function a(u){try{xl.Point.fromHex(u)}catch(l){throw Y2(l,"ERR_INVALID_PUBLIC_KEY")}}function c(u){try{return xl.getPublicKey(u,!0)}catch(l){throw Y2(l,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:32,hashAndSign:r,hashAndVerify:n,compressPublicKey:i,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:a,computePublicKey:c}}});var yj=g((qpt,pj)=>{"use strict";var{sha256:hj}=(Tn(),se(Js)),GCe=oe(),{equals:dj}=(bn(),se(Ei)),{toString:WCe}=(st(),se(hr)),YCe=K6();pj.exports=(t,e,r)=>{r=r||fj()();class n{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,l){return r.hashAndVerify(this._key,l,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return dj(this.bytes,u.bytes)}async hash(){let{bytes:u}=await hj.digest(this.bytes);return u}}class i{constructor(u,l){this._key=u,this._publicKey=l||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new n(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return dj(this.bytes,u.bytes)}async hash(){let{bytes:u}=await hj.digest(this.bytes);return u}async id(){let u=await this.public.hash();return WCe(u,"base58btc")}async export(u,l="libp2p-key"){if(l==="libp2p-key")return YCe.export(this.bytes,u);throw GCe(new Error(`export format '${l}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new i(c)}function o(c){return new n(c)}async function a(){let c=await r.generateKey();return new i(c)}return{Secp256k1PublicKey:n,Secp256k1PrivateKey:i,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var mj=g((Fpt,gj)=>{"use strict";gj.exports={SHA1:20,SHA256:32,SHA512:64}});var iS=g(bj=>{"use strict";var wj=B2(),XCe=mj(),QCe={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},ZCe=async(t,e)=>{let r=await wj.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};bj.create=async function(t,e){let r=QCe[t],n=await wj.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return ZCe(n,i)},length:XCe[t]}}});var Aj=g((jpt,Sj)=>{"use strict";var _j=oe(),{concat:vj}=(Pn(),se(Ui)),{fromString:JCe}=(dt(),se(nn)),eOe=iS(),Ej={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};Sj.exports=async(t,e,r)=>{let n=Ej[t];if(!n){let _=Object.keys(Ej).join(" / ");throw _j(new Error(`unknown cipher type '${t}'. Must be ${_}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw _j(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,s=n.ivSize,o=20,a=JCe("key expansion"),c=2*(s+i+o),u=await eOe.create(e,r),l=await u.digest(a),f=[],h=0;for(;h<c;){let _=await u.digest(vj([l,a])),R=_.length;h+R>c&&(R=c-h),f.push(_),h+=R,l=await u.digest(l)}let d=c/2,p=vj(f),y=p.slice(0,d),b=p.slice(d,c),m=_=>({iv:_.slice(0,s),cipherKey:_.slice(s,s+i),macKey:_.slice(s+i)});return{k1:m(y),k2:m(b)}}});var Ij=g((Vpt,Rj)=>{"use strict";var tOe=oe();Rj.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw tOe(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var kj=g(Oj=>{"use strict";var rOe=oe(),X2=B2(),{base64urlToBuffer:Tj}=F6(),nOe=Ij(),{toString:sS}=(st(),se(hr)),{concat:iOe}=(Pn(),se(Ui)),{equals:sOe}=(bn(),se(Ei)),xj={"P-256":256,"P-384":384,"P-521":521};Oj.generateEphmeralKeyPair=async function(t){nOe(Object.keys(xj),t);let e=await X2.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(i,s)=>{let o;s?o=await X2.get().subtle.importKey("jwk",aOe(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let a=[await X2.get().subtle.importKey("jwk",Cj(t,i),{name:"ECDH",namedCurve:t},!1,[]),o],c=await X2.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:a[0]},a[1],xj[t]);return new Uint8Array(c,c.byteOffset,c.byteLength)},n=await X2.get().subtle.exportKey("jwk",e.publicKey);return{key:oOe(n),genSharedKey:r}};var Pj={"P-256":32,"P-384":48,"P-521":66};function oOe(t){let e=Pj[t.crv];return iOe([Uint8Array.from([4]),Tj(t.x,e),Tj(t.y,e)],1+e*2)}function Cj(t,e){let r=Pj[t];if(sOe(!e.slice(0,1),Uint8Array.from([4])))throw rOe(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:sS(e.slice(1,r+1),"base64url"),y:sS(e.slice(1+r),"base64url"),ext:!0}}var aOe=(t,e)=>({...Cj(t,e.public),d:sS(e.private,"base64url")})});var Nj=g((Hpt,Dj)=>{"use strict";var cOe=kj();Dj.exports=async t=>cOe.generateEphmeralKeyPair(t)});var t5=g(($pt,Lj)=>{"use strict";var rc=E6();wl();q9();var oS=Pt(),Q2=oe(),{fromString:uOe}=(dt(),se(nn)),lOe=nK(),uo={rsa:xK(),ed25519:HK(),secp256k1:yj()(rc,M2())},e5={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function t0(t){let e=uo[t.toLowerCase()];if(!e){let r=Object.keys(uo).join(" / ");throw Q2(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var fOe=async(t,e)=>t0(t).generateKeyPair(e),hOe=async(t,e,r)=>{let n=t0(t);if(t.toLowerCase()!=="ed25519")throw Q2(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return n.generateKeyPairFromSeed(e,r)},dOe=t=>{let e=rc.PublicKey.decode(t),r=e.Data;switch(e.Type){case rc.KeyType.RSA:return uo.rsa.unmarshalRsaPublicKey(r);case rc.KeyType.Ed25519:return uo.ed25519.unmarshalEd25519PublicKey(r);case rc.KeyType.Secp256k1:if(uo.secp256k1)return uo.secp256k1.unmarshalSecp256k1PublicKey(r);throw Q2(new Error(e5.message),e5.code);default:t0(e.Type)}},pOe=(t,e)=>(e=(e||"rsa").toLowerCase(),t0(e),t.bytes),Bj=async t=>{let e=rc.PrivateKey.decode(t),r=e.Data;switch(e.Type){case rc.KeyType.RSA:return uo.rsa.unmarshalRsaPrivateKey(r);case rc.KeyType.Ed25519:return uo.ed25519.unmarshalEd25519PrivateKey(r);case rc.KeyType.Secp256k1:if(uo.secp256k1)return uo.secp256k1.unmarshalSecp256k1PrivateKey(r);throw Q2(new Error(e5.message),e5.code);default:t0(e.Type)}},yOe=(t,e)=>(e=(e||"rsa").toLowerCase(),t0(e),t.bytes),gOe=async(t,e)=>{try{let i=await lOe.import(t,e);return Bj(i)}catch{}let r=oS.pki.decryptRsaPrivateKey(t,e);if(r===null)throw Q2(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=oS.asn1.toDer(oS.pki.privateKeyToAsn1(r));return n=uOe(n.getBytes(),"ascii"),uo.rsa.unmarshalRsaPrivateKey(n)};Lj.exports={supportedKeys:uo,keysPBM:rc,keyStretcher:Aj(),generateEphemeralKeyPair:Nj(),generateKeyPair:fOe,generateKeyPairFromSeed:hOe,unmarshalPublicKey:dOe,marshalPublicKey:pOe,unmarshalPrivateKey:Bj,marshalPrivateKey:yOe,import:gOe}});var r5=g((Gpt,aS)=>{"use strict";function mOe(t,{className:e,symbolName:r}){let n=Symbol.for(r),i={[e]:class extends t{constructor(...s){super(...s);Object.defineProperty(this,n,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return i[`is${e}`]=s=>!!(s&&s[n]),i}function wOe(t,{className:e,symbolName:r,withoutNew:n}){let i=Symbol.for(r),s={[e]:function(...o){if(n&&!(this instanceof s))return new s(...o);let a=t.call(this,...o)||this;return a&&!a[i]&&Object.defineProperty(a,i,{value:!0}),a}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[i]),s}aS.exports=mOe;aS.exports.proto=wOe});var qj=g((Wpt,Uj)=>{"use strict";var r0=Kr(),Mj=r0.Reader,bOe=r0.Writer,jn=r0.util,Z2=r0.roots["libp2p-peer-id"]||(r0.roots["libp2p-peer-id"]={});Z2.PeerIdProto=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.id=jn.newBuffer([]),t.prototype.pubKey=jn.newBuffer([]),t.prototype.privKey=jn.newBuffer([]),t.encode=function(r,n){return n||(n=bOe.create()),n.uint32(10).bytes(r.id),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&n.uint32(18).bytes(r.pubKey),r.privKey!=null&&Object.hasOwnProperty.call(r,"privKey")&&n.uint32(26).bytes(r.privKey),n},t.decode=function(r,n){r instanceof Mj||(r=Mj.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Z2.PeerIdProto;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.id=r.bytes();break;case 2:s.pubKey=r.bytes();break;case 3:s.privKey=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw jn.ProtocolError("missing required 'id'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Z2.PeerIdProto)return r;var n=new Z2.PeerIdProto;return r.id!=null&&(typeof r.id=="string"?jn.base64.decode(r.id,n.id=jn.newBuffer(jn.base64.length(r.id)),0):r.id.length&&(n.id=r.id)),r.pubKey!=null&&(typeof r.pubKey=="string"?jn.base64.decode(r.pubKey,n.pubKey=jn.newBuffer(jn.base64.length(r.pubKey)),0):r.pubKey.length&&(n.pubKey=r.pubKey)),r.privKey!=null&&(typeof r.privKey=="string"?jn.base64.decode(r.privKey,n.privKey=jn.newBuffer(jn.base64.length(r.privKey)),0):r.privKey.length&&(n.privKey=r.privKey)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.id="":(i.id=[],n.bytes!==Array&&(i.id=jn.newBuffer(i.id))),n.bytes===String?i.pubKey="":(i.pubKey=[],n.bytes!==Array&&(i.pubKey=jn.newBuffer(i.pubKey))),n.bytes===String?i.privKey="":(i.privKey=[],n.bytes!==Array&&(i.privKey=jn.newBuffer(i.privKey)))),r.id!=null&&r.hasOwnProperty("id")&&(i.id=n.bytes===String?jn.base64.encode(r.id,0,r.id.length):n.bytes===Array?Array.prototype.slice.call(r.id):r.id),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(i.pubKey=n.bytes===String?jn.base64.encode(r.pubKey,0,r.pubKey.length):n.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.privKey!=null&&r.hasOwnProperty("privKey")&&(i.privKey=n.bytes===String?jn.base64.encode(r.privKey,0,r.privKey.length):n.bytes===Array?Array.prototype.slice.call(r.privKey):r.privKey),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,r0.util.toJSONOptions)},t}();Uj.exports=Z2});var ft=g((Ti,Gj)=>{"use strict";var{CID:cS}=(Se(),se(Yc)),_Oe=(fi(),se(Wc)),vOe=(d2(),se(G4)),EOe=(wn(),se(Zo)),SOe=(ol(),se(Xf)),{base58btc:uS}=(wn(),se(Zo)),{base32:AOe}=(fi(),se(Wc)),{base16:jj}=(AE(),se($4)),J2=(li(),se(Qn)),nc=t5(),ROe=r5(),{PeerIdProto:Vj}=qj(),{equals:fh}=(bn(),se(Ei)),{fromString:eg}=(dt(),se(nn)),{toString:IOe}=(st(),se(hr)),{identity:n5}=(Zc(),se(h2)),Fj={..._Oe,...vOe,...EOe,...SOe},TOe=Object.keys(Fj).reduce((t,e)=>t.or(Fj[e]),AOe.decoder),xOe=112,zj=114,Hj=class{constructor(e,r,n){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(r&&n&&!fh(r.public.bytes,n.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=uS.encode(this.id).substring(1),this._privKey=r,this._pubKey=n}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=J2.decode(this.id);e.code===n5.code&&(this._pubKey=nc.unmarshalPublicKey(e.digest))}catch{}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return nc.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return nc.marshalPrivateKey(this.privKey)}marshal(e){return Vj.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let r=6;return e.length<r&&(r=e.length),"<peer.ID "+e.substr(0,r)+">"}toJSON(){return{id:this.toB58String(),privKey:Kj(this.marshalPrivKey()),pubKey:Kj(this.marshalPubKey())}}toHexString(){return jj.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=cS.createV1(zj,J2.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return fh(this.id,e);if(e.id)return fh(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&fh(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(J2.decode(this.id).code===n5.code)return!0}catch{}return!1}},ic=ROe(Hj,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});Ti=Gj.exports=ic;var tg=t=>t.bytes.length<=42?J2.create(n5.code,t.bytes).bytes:t.hash(),lS=async(t,e)=>{let r=await tg(e);return new ic(r,t,e)};Ti.create=async t=>{t=t||{},t.bits=t.bits||2048,t.keyType=t.keyType||"RSA";let e=await nc.generateKeyPair(t.keyType,t.bits);return lS(e,e.public)};Ti.createFromHexString=t=>new ic(jj.decode("f"+t));Ti.createFromBytes=t=>{try{let e=cS.decode(t);if(!$j(e))throw new Error("Supplied PeerID CID is invalid");return Ti.createFromCID(e)}catch{if(J2.decode(t).code!==n5.code)throw new Error("Supplied PeerID CID is invalid");return new ic(t)}};Ti.createFromB58String=t=>Ti.createFromBytes(uS.decode("z"+t));var $j=t=>t.code===zj||t.code===xOe;Ti.createFromCID=t=>{if(t=cS.asCID(t),!t||!$j(t))throw new Error("Supplied PeerID CID is invalid");return new ic(t.multihash.bytes)};Ti.createFromPubKey=async t=>{let e=t;if(typeof e=="string"&&(e=eg(t,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let r=await nc.unmarshalPublicKey(e);return lS(void 0,r)};Ti.createFromPrivKey=async t=>{if(typeof t=="string"&&(t=eg(t,"base64pad")),!(t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await nc.unmarshalPrivateKey(t);return lS(e,e.public)};Ti.createFromJSON=async t=>{let e=uS.decode("z"+t.id),r=t.privKey&&eg(t.privKey,"base64pad"),n=t.pubKey&&eg(t.pubKey,"base64pad"),i=n&&await nc.unmarshalPublicKey(n);if(!r)return new ic(e,void 0,i);let s=await nc.unmarshalPrivateKey(r),o=await tg(s.public),a;if(i&&(a=await tg(i)),i&&!fh(o,a))throw new Error("Public and private key do not match");if(e&&!fh(o,e))throw new Error("Id and private key do not match");return new ic(e,s,i)};Ti.createFromProtobuf=async t=>{typeof t=="string"&&(t=eg(t,"base16"));let{id:e,privKey:r,pubKey:n}=Vj.decode(t);r=r?await nc.unmarshalPrivateKey(r):!1,n=n?await nc.unmarshalPublicKey(n):!1;let i,s;if(r&&(s=await tg(r.public)),n&&(i=await tg(n)),r){if(n&&!fh(s,i))throw new Error("Public and private key do not match");return new ic(s,r,r.public)}if(n)return new ic(i,void 0,n);if(e)return new ic(e);throw new Error("Protobuf did not contain any usable key material")};Ti.parse=t=>((t.charAt(0)==="1"||t.charAt(0)==="Q")&&(t=`z${t}`),Ti.createFromBytes(TOe.decode(t)));Ti.isPeerId=t=>Boolean(typeof t=="object"&&t._id&&t._idB58String);function Kj(t){if(t)return IOe(t,"base64pad")}});function Yj({repo:t,codecs:e,bases:r,name:n}){async function i(s,o={}){if(!fS.default.path(s))throw new Error("invalid argument "+s);if(fS.default.ipnsPath(s))for await(let b of n.resolve(s,o))s=b;let[,a,c,...u]=s.split("/"),l=o.cidBase?await r.getBase(o.cidBase):void 0,f=POe(c);if(u.length===0){let b=l?l.encoder.encode(f):c;return`/${a}/${b}`}let h=L.decode(f);s=u.join("/");let d=yl(h,s,e,t,o),p=h,y=s;for await(let b of d)L.asCID(b.value)&&(p=b.value,y=b.remainderPath);return`/ipfs/${p.toString(l&&l.encoder)}${y?"/"+y:""}`}return Q(i)}function POe(t){try{return Wj.default.parse(t).toBytes()}catch{return L.parse(t).bytes}}var fS,Wj,Xj=w(()=>{fS=A(Lp(),1);Se();Wj=A(ft(),1);Ce();ti()});var os=g((Jpt,Qj)=>{"use strict";var COe=async t=>{let e;for await(let r of t)e=r;return e};Qj.exports=COe});function Jj({addAll:t}){return(e,r={})=>{let n,i=L.asCID(e);return i?n=t([{cid:i,...r}],r):n=t([{path:e.toString(),...r}],r),(0,Zj.default)(n)}}var Zj,eV=w(()=>{Zj=A(os(),1);Se()});async function*sc(t){if(t==null)throw(0,n0.default)(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT");let e=L.asCID(t);if(e){yield ca({cid:e});return}if(t instanceof String||typeof t=="string"){yield ca({path:t});return}if(t.cid!=null||t.path!=null)return yield ca(t);if(Symbol.iterator in t){let r=t[Symbol.iterator](),n=r.next();if(n.done)return r;if(L.asCID(n.value)||n.value instanceof String||typeof n.value=="string"){yield ca({cid:n.value});for(let i of r)yield ca({cid:i});return}if(n.value.cid!=null||n.value.path!=null){yield ca(n.value);for(let i of r)yield ca(i);return}throw(0,n0.default)(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in t){let r=t[Symbol.asyncIterator](),n=await r.next();if(n.done)return r;if(L.asCID(n.value)||n.value instanceof String||typeof n.value=="string"){yield ca({cid:n.value});for await(let i of r)yield ca({cid:i});return}if(n.value.cid!=null||n.value.path!=null){yield ca(n.value);for await(let i of r)yield ca(i);return}throw(0,n0.default)(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}throw(0,n0.default)(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}function ca(t){let e=t.cid||`${t.path}`;if(!e)throw(0,n0.default)(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let r={path:e,recursive:t.recursive!==!1};return t.metadata!=null&&(r.metadata=t.metadata),r}var n0,i0=w(()=>{n0=A(oe(),1);Se()});var Mt,s0=w(()=>{Mt={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"}});function tV({repo:t,codecs:e}){async function*r(n,i={}){let s=async function*(){for await(let{path:c,recursive:u,metadata:l}of sc(n)){let{cid:f}=await pl(t,e,c),{reason:h}=await t.pins.isPinnedWithType(f,[Mt.recursive,Mt.direct]);if(h==="recursive"&&!u)throw new Error(`${f} already pinned recursively`);u?await t.pins.pinRecursively(f,{metadata:l}):await t.pins.pinDirectly(f,{metadata:l}),yield f}};if(!Boolean(i.lock)){yield*s();return}let a=await t.gcLock.readLock();try{yield*s()}finally{a()}}return Q(r)}var rV=w(()=>{ti();Ce();i0();s0()});function rg(t,e,r){let n={type:t,cid:e};return r&&(n.metadata=r),n}function nV({repo:t,codecs:e}){async function*r(n={}){let i=Mt.all;if(n.type&&(i=n.type,!Object.keys(Mt).includes(i)))throw(0,hS.default)(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(n.paths){let s=!1;for await(let{path:o}of sc(n.paths)){let{cid:a}=await pl(t,e,o),{reason:c,pinned:u,parent:l,metadata:f}=await t.pins.isPinnedWithType(a,i);if(!u)throw(0,hS.default)(new Error(`path '${o}' is not pinned`),"ERR_NOT_PINNED");switch(c){case Mt.direct:case Mt.recursive:s=!0,yield rg(c,a,f);break;default:s=!0,yield rg(`${Mt.indirect} through ${l}`,a,f)}}if(!s)throw new Error("No match found");return}if(i===Mt.recursive||i===Mt.all)for await(let{cid:s,metadata:o}of t.pins.recursiveKeys())yield rg(Mt.recursive,s,o);if(i===Mt.indirect||i===Mt.all)for await(let s of t.pins.indirectKeys(n))yield rg(Mt.indirect,s);if(i===Mt.direct||i===Mt.all)for await(let{cid:s,metadata:o}of t.pins.directKeys())yield rg(Mt.direct,s,o)}return Q(r)}var hS,iV=w(()=>{i0();ti();Ce();hS=A(oe(),1);s0()});function oV({rmAll:t}){async function e(r,n={}){let i=await(0,sV.default)(t([{path:r,...n}],n));if(!i)throw new Error("CID expected");return i}return e}var sV,aV=w(()=>{sV=A(os(),1)});function cV({repo:t,codecs:e}){async function*r(n,i={}){let s=await t.gcLock.readLock();try{for await(let{path:o,recursive:a}of sc(n)){let{cid:c}=await pl(t,e,o),{pinned:u,reason:l}=await t.pins.isPinnedWithType(c,Mt.all);if(!u)throw new Error(`${c} is not pinned`);switch(l){case Mt.recursive:if(!a)throw new Error(`${c} is pinned recursively`);await t.pins.unpin(c),yield c;break;case Mt.direct:await t.pins.unpin(c),yield c;break;default:throw new Error(`${c} is pinned indirectly under ${l}`)}}}finally{s()}}return Q(r)}var uV=w(()=>{i0();ti();Ce();s0()});var dS,lV=w(()=>{eV();rV();iV();aV();uV();dS=class{constructor({codecs:e,repo:r}){let n=tV({codecs:e,repo:r});this.addAll=n,this.add=Jj({addAll:n});let i=cV({codecs:e,repo:r});this.rmAll=i,this.rm=oV({rmAll:i}),this.ls=nV({codecs:e,repo:r}),this.remote={add:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:async function*(s,o={}){return Promise.reject(new Error("Not implemented"))},rm:(s,o={})=>Promise.reject(new Error("Not implemented")),rmAll:(s,o={})=>Promise.reject(new Error("Not implemented")),service:{add:(s,o)=>Promise.reject(new Error("Not implemented")),rm:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:(s={})=>Promise.reject(new Error("Not implemented"))}}}}});var Pl={};Tt(Pl,{abortedError:()=>OOe,dbDeleteFailedError:()=>ig,dbOpenFailedError:()=>ng,dbWriteFailedError:()=>sg,notFoundError:()=>Cn});function ng(t){return t=t||new Error("Cannot open database"),(0,o0.default)(t,"ERR_DB_OPEN_FAILED")}function ig(t){return t=t||new Error("Delete failed"),(0,o0.default)(t,"ERR_DB_DELETE_FAILED")}function sg(t){return t=t||new Error("Write failed"),(0,o0.default)(t,"ERR_DB_WRITE_FAILED")}function Cn(t){return t=t||new Error("Not Found"),(0,o0.default)(t,"ERR_NOT_FOUND")}function OOe(t){return t=t||new Error("Aborted"),(0,o0.default)(t,"ERR_ABORTED")}var o0,lo=w(()=>{o0=A(oe(),1)});var fV=g((x0t,pS)=>{var T0t=function(){typeof pS<"u"&&(pS.exports=m);var t=24*3600,e=3200,r=(365*400+97)*e/400,n=t*r,i=n*1e3,s=1e3*1e4*1e4*t,o=16777216,a=65536*65536,c=1e3*1e3,u=1e3*1e3*1e3,l="000000000",f=Math.trunc||Ve,h=m.prototype;m.fromDate=M,m.fromInt64BE=Ue(0,1,2,3,0,4),m.fromInt64LE=Ue(3,2,1,0,4,0),m.fromString=U,m.fromTimeT=ae,h.year=0,h.time=0,h.nano=0,h.addNano=x,h.getNano=D,h.getTimeT=de,h.getYear=_,h.toDate=k,h.toJSON=me,h.toString=Ke,h.writeInt64BE=xe(0,1,2,3,0,4),h.writeInt64LE=xe(3,2,1,0,4,0);var d="%Y-%m-%dT%H:%M:%S.%NZ",p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],y=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],b={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return m;function m(pe,J,Ie){var ze=this;if(!(ze instanceof m))return new m(pe,J,Ie);ze.time=+pe||0,ze.nano=+J||0,ze.year=+Ie||0,R(ze)}function _(){var pe=this.toDate().getUTCFullYear();return pe+this.year}function R(pe){var J=pe.year,Ie=pe.time,ze=pe.nano,We,De;if(ze<0||c<=ze){var ht=Math.floor(ze/c);ze-=ht*c,Ie+=ht,We=1}var T=J%e;if(Ie<-s||s<Ie||T){De=f(Ie/i),De&&(J+=De*e,Ie-=De*i);var O=P(Ie);O.setUTCFullYear(T+O.getUTCFullYear()),J-=T,Ie=+O,De=f(J/e);var N=Ie+De*i;De&&-s<=N&&N<=s&&(J-=De*e,Ie=N),We=1}return We&&(pe.year=J,pe.time=Ie,pe.nano=ze),pe}function k(){var pe=R(this);return P(pe.time)}function P(pe){var J=new Date(0);return J.setTime(pe),J}function x(pe){return this.nano+=+pe||0,this}function D(){var pe=R(this);return(pe.time%1e3*c+ +pe.nano+u)%u}function U(pe){var J,Ie=new m;pe+="";var ze=pe.replace(/^\s*[+\-]?\d+/,function(We){var De=+We,ht=1970+(De-1970)%400;return Ie.year=De-ht,ht}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(We,De,ht){return De<0&&(ht*=-1),J=(+De*60+ +ht)*6e4,""}).replace(/\.\d+$/,function(We){return Ie.nano=+(We+l).substr(1,9),""}).split(/\D+/);if(ze.length>1?ze[1]--:ze[1]=0,Ie.time=J=Date.UTC.apply(Date,ze)-(J||0),isNaN(J))throw new TypeError("Invalid Date");return R(Ie)}function M(pe){return new m(+pe)}function ae(pe){return ne(pe,0)}function ne(pe,J){J|=0,J*=a,pe=+pe||0;var Ie=f(J/n)+f(pe/n),ze=J%n+pe%n,We=f(ze/n);return We&&(Ie+=We,ze-=We*n),new m(ze*1e3,0,Ie*e)}function de(){var pe=R(this),J=Math.floor(pe.time/1e3),Ie=pe.year;return Ie&&(J+=Ie*r*t/e),J}function me(){return this.toString().replace(/0{1,6}Z$/,"Z")}function Ke(pe){var J=this,Ie=J.toDate(),ze={H:N,L:W,M:Y,N:ee,S:K,Y:De,a:V,b:X,d:T,e:O,m:ht};return We(pe||d);function We(re){return re.replace(/%./g,function(I){var B=I[1],G=b[B],Z=ze[B];return G?We(G):Z?Z():I})}function De(){var re=J.getYear();return re>999999?"+"+re:re>9999?"+"+et(re,6):re>=0?et(re,4):re>=-999999?"-"+et(-re,6):re}function ht(){return Je(Ie.getUTCMonth()+1)}function T(){return Je(Ie.getUTCDate())}function O(){return pt(Ie.getUTCDate())}function N(){return Je(Ie.getUTCHours())}function Y(){return Je(Ie.getUTCMinutes())}function K(){return Je(Ie.getUTCSeconds())}function W(){return et(Ie.getUTCMilliseconds(),3)}function ee(){return et(J.getNano(),9)}function V(){return y[Ie.getUTCDay()]}function X(){return p[Ie.getUTCMonth()]}}function xe(pe,J,Ie,ze,We,De){return ht;function ht(O,N){var Y=R(this);O||(O=new Array(8)),ie(O,N|=0);var K=Math.floor(Y.time/1e3),W=Y.year*(r*t/e),ee=f(W/a)+f(K/a),V=W%a+K%a,X=Math.floor(V/a);return X&&(ee+=X,V-=X*a),T(O,N+We,ee),T(O,N+De,V),O}function T(O,N,Y){O[N+pe]=Y>>24&255,O[N+J]=Y>>16&255,O[N+Ie]=Y>>8&255,O[N+ze]=Y&255}}function Ue(pe,J,Ie,ze,We,De){return ht;function ht(O,N){ie(O,N|=0);var Y=T(O,N+We),K=T(O,N+De);return ne(K,Y)}function T(O,N){return O[N+pe]*o+(O[N+J]<<16|O[N+Ie]<<8|O[N+ze])}}function ie(pe,J){var Ie=pe&&pe.length;if(Ie==null)throw new TypeError("Invalid Buffer");if(Ie<J+8)throw new RangeError("Out of range")}function Ve(pe){var J=pe-pe%1;return J===0&&(pe<0||pe===0&&1/pe!==1/0)?-0:J}function pt(pe){return(pe>9?"":" ")+(pe|0)}function Je(pe){return(pe>9?"":"0")+(pe|0)}function et(pe,J){return(l+(pe|0)).substr(-J)}}()});var pV=g((P0t,dV)=>{"use strict";Hp();var i5=Pt(),{toString:a0}=(st(),se(hr)),{fromString:hV}=(dt(),se(nn));dV.exports={createCipheriv:(t,e,r)=>{let n=i5.cipher.createCipher("AES-CTR",a0(e,"ascii"));return n.start({iv:a0(r,"ascii")}),{update:i=>(n.update(i5.util.createBuffer(a0(i,"ascii"))),hV(n.output.getBytes(),"ascii"))}},createDecipheriv:(t,e,r)=>{let n=i5.cipher.createDecipher("AES-CTR",a0(e,"ascii"));return n.start({iv:a0(r,"ascii")}),{update:i=>(n.update(i5.util.createBuffer(a0(i,"ascii"))),hV(n.output.getBytes(),"ascii"))}}}});var mV=g((C0t,gV)=>{"use strict";var kOe=oe(),yV={16:"aes-128-ctr",32:"aes-256-ctr"};gV.exports=function(t){let e=yV[t.length];if(!e){let r=Object.entries(yV).map(([n,i])=>`${n} (${i})`).join(" / ");throw kOe(new Error(`Invalid key length ${t.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return e}});var _V=g(bV=>{"use strict";var wV=pV(),DOe=mV();bV.create=async function(t,e){let r=DOe(t),n=wV.createCipheriv(r,t,e),i=wV.createDecipheriv(r,t,e);return{async encrypt(o){return n.update(o)},async decrypt(o){return i.update(o)}}}});var SV=g((k0t,EV)=>{"use strict";var NOe=P9(),BOe=Tr(),LOe=oe(),vV={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function MOe(t,e,r,n,i){let s=vV[i];if(!s){let a=Object.keys(vV).join(" / ");throw LOe(new Error(`Hash '${i}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=NOe(t,e,r,n,s);return BOe.encode64(o)}EV.exports=MOe});var oc=g(c0=>{"use strict";var UOe=iS(),qOe=_V(),FOe=t5();c0.aes=qOe;c0.hmac=UOe;c0.keys=FOe;c0.randomBytes=M2();c0.pbkdf2=SV()});var NV=g((N0t,DV)=>{DV.exports=Pr;var fo=null;try{fo=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Pr(t,e,r){this.low=t|0,this.high=e|0,this.unsigned=!!r}Pr.prototype.__isLong__;Object.defineProperty(Pr.prototype,"__isLong__",{value:!0});function cs(t){return(t&&t.__isLong__)===!0}Pr.isLong=cs;var AV={},RV={};function dh(t,e){var r,n,i;return e?(t>>>=0,(i=0<=t&&t<256)&&(n=RV[t],n)?n:(r=Cr(t,(t|0)<0?-1:0,!0),i&&(RV[t]=r),r)):(t|=0,(i=-128<=t&&t<128)&&(n=AV[t],n)?n:(r=Cr(t,t<0?-1:0,!1),i&&(AV[t]=r),r))}Pr.fromInt=dh;function ho(t,e){if(isNaN(t))return e?hh:po;if(e){if(t<0)return hh;if(t>=PV)return kV}else{if(t<=-TV)return as;if(t+1>=TV)return OV}return t<0?ho(-t,e).neg():Cr(t%l0|0,t/l0|0,e)}Pr.fromNumber=ho;function Cr(t,e,r){return new Pr(t,e,r)}Pr.fromBits=Cr;var s5=Math.pow;function gS(t,e,r){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return po;if(typeof e=="number"?(r=e,e=!1):e=!!e,r=r||10,r<2||36<r)throw RangeError("radix");var n;if((n=t.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return gS(t.substring(1),e,r).neg();for(var i=ho(s5(r,8)),s=po,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+a),r);if(a<8){var u=ho(s5(r,a));s=s.mul(u).add(ho(c))}else s=s.mul(i),s=s.add(ho(c))}return s.unsigned=e,s}Pr.fromString=gS;function ua(t,e){return typeof t=="number"?ho(t,e):typeof t=="string"?gS(t,e):Cr(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Pr.fromValue=ua;var IV=1<<16,KOe=1<<24,l0=IV*IV,PV=l0*l0,TV=PV/2,xV=dh(KOe),po=dh(0);Pr.ZERO=po;var hh=dh(0,!0);Pr.UZERO=hh;var u0=dh(1);Pr.ONE=u0;var CV=dh(1,!0);Pr.UONE=CV;var yS=dh(-1);Pr.NEG_ONE=yS;var OV=Cr(-1,2147483647,!1);Pr.MAX_VALUE=OV;var kV=Cr(-1,-1,!0);Pr.MAX_UNSIGNED_VALUE=kV;var as=Cr(0,-2147483648,!1);Pr.MIN_VALUE=as;var Te=Pr.prototype;Te.toInt=function(){return this.unsigned?this.low>>>0:this.low};Te.toNumber=function(){return this.unsigned?(this.high>>>0)*l0+(this.low>>>0):this.high*l0+(this.low>>>0)};Te.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(as)){var r=ho(e),n=this.div(r),i=n.mul(r).sub(this);return n.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=ho(s5(e,6),this.unsigned),o=this,a="";;){var c=o.div(s),u=o.sub(c.mul(s)).toInt()>>>0,l=u.toString(e);if(o=c,o.isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}};Te.getHighBits=function(){return this.high};Te.getHighBitsUnsigned=function(){return this.high>>>0};Te.getLowBits=function(){return this.low};Te.getLowBitsUnsigned=function(){return this.low>>>0};Te.getNumBitsAbs=function(){if(this.isNegative())return this.eq(as)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,r=31;r>0&&(e&1<<r)==0;r--);return this.high!=0?r+33:r+1};Te.isZero=function(){return this.high===0&&this.low===0};Te.eqz=Te.isZero;Te.isNegative=function(){return!this.unsigned&&this.high<0};Te.isPositive=function(){return this.unsigned||this.high>=0};Te.isOdd=function(){return(this.low&1)===1};Te.isEven=function(){return(this.low&1)===0};Te.equals=function(e){return cs(e)||(e=ua(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Te.eq=Te.equals;Te.notEquals=function(e){return!this.eq(e)};Te.neq=Te.notEquals;Te.ne=Te.notEquals;Te.lessThan=function(e){return this.comp(e)<0};Te.lt=Te.lessThan;Te.lessThanOrEqual=function(e){return this.comp(e)<=0};Te.lte=Te.lessThanOrEqual;Te.le=Te.lessThanOrEqual;Te.greaterThan=function(e){return this.comp(e)>0};Te.gt=Te.greaterThan;Te.greaterThanOrEqual=function(e){return this.comp(e)>=0};Te.gte=Te.greaterThanOrEqual;Te.ge=Te.greaterThanOrEqual;Te.compare=function(e){if(cs(e)||(e=ua(e)),this.eq(e))return 0;var r=this.isNegative(),n=e.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Te.comp=Te.compare;Te.negate=function(){return!this.unsigned&&this.eq(as)?as:this.not().add(u0)};Te.neg=Te.negate;Te.add=function(e){cs(e)||(e=ua(e));var r=this.high>>>16,n=this.high&65535,i=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,u=e.low&65535,l=0,f=0,h=0,d=0;return d+=s+u,h+=d>>>16,d&=65535,h+=i+c,f+=h>>>16,h&=65535,f+=n+a,l+=f>>>16,f&=65535,l+=r+o,l&=65535,Cr(h<<16|d,l<<16|f,this.unsigned)};Te.subtract=function(e){return cs(e)||(e=ua(e)),this.add(e.neg())};Te.sub=Te.subtract;Te.multiply=function(e){if(this.isZero())return po;if(cs(e)||(e=ua(e)),fo){var r=fo.mul(this.low,this.high,e.low,e.high);return Cr(r,fo.get_high(),this.unsigned)}if(e.isZero())return po;if(this.eq(as))return e.isOdd()?as:po;if(e.eq(as))return this.isOdd()?as:po;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(xV)&&e.lt(xV))return ho(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,i=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,u=e.low>>>16,l=e.low&65535,f=0,h=0,d=0,p=0;return p+=o*l,d+=p>>>16,p&=65535,d+=s*l,h+=d>>>16,d&=65535,d+=o*u,h+=d>>>16,d&=65535,h+=i*l,f+=h>>>16,h&=65535,h+=s*u,f+=h>>>16,h&=65535,h+=o*c,f+=h>>>16,h&=65535,f+=n*l+i*u+s*c+o*a,f&=65535,Cr(d<<16|p,f<<16|h,this.unsigned)};Te.mul=Te.multiply;Te.divide=function(e){if(cs(e)||(e=ua(e)),e.isZero())throw Error("division by zero");if(fo){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var r=(this.unsigned?fo.div_u:fo.div_s)(this.low,this.high,e.low,e.high);return Cr(r,fo.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?hh:po;var n,i,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return hh;if(e.gt(this.shru(1)))return CV;s=hh}else{if(this.eq(as)){if(e.eq(u0)||e.eq(yS))return as;if(e.eq(as))return u0;var o=this.shr(1);return n=o.div(e).shl(1),n.eq(po)?e.isNegative()?u0:yS:(i=this.sub(e.mul(n)),s=n.add(i.div(e)),s)}else if(e.eq(as))return this.unsigned?hh:po;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=po}for(i=this;i.gte(e);){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(n)/Math.LN2),c=a<=48?1:s5(2,a-48),u=ho(n),l=u.mul(e);l.isNegative()||l.gt(i);)n-=c,u=ho(n,this.unsigned),l=u.mul(e);u.isZero()&&(u=u0),s=s.add(u),i=i.sub(l)}return s};Te.div=Te.divide;Te.modulo=function(e){if(cs(e)||(e=ua(e)),fo){var r=(this.unsigned?fo.rem_u:fo.rem_s)(this.low,this.high,e.low,e.high);return Cr(r,fo.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Te.mod=Te.modulo;Te.rem=Te.modulo;Te.not=function(){return Cr(~this.low,~this.high,this.unsigned)};Te.and=function(e){return cs(e)||(e=ua(e)),Cr(this.low&e.low,this.high&e.high,this.unsigned)};Te.or=function(e){return cs(e)||(e=ua(e)),Cr(this.low|e.low,this.high|e.high,this.unsigned)};Te.xor=function(e){return cs(e)||(e=ua(e)),Cr(this.low^e.low,this.high^e.high,this.unsigned)};Te.shiftLeft=function(e){return cs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Cr(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Cr(0,this.low<<e-32,this.unsigned)};Te.shl=Te.shiftLeft;Te.shiftRight=function(e){return cs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Cr(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Cr(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Te.shr=Te.shiftRight;Te.shiftRightUnsigned=function(e){if(cs(e)&&(e=e.toInt()),e&=63,e===0)return this;var r=this.high;if(e<32){var n=this.low;return Cr(n>>>e|r<<32-e,r>>>e,this.unsigned)}else return e===32?Cr(r,0,this.unsigned):Cr(r>>>e-32,0,this.unsigned)};Te.shru=Te.shiftRightUnsigned;Te.shr_u=Te.shiftRightUnsigned;Te.toSigned=function(){return this.unsigned?Cr(this.low,this.high,!1):this};Te.toUnsigned=function(){return this.unsigned?this:Cr(this.low,this.high,!0)};Te.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Te.toBytesLE=function(){var e=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Te.toBytesBE=function(){var e=this.high,r=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,r>>>24,r>>>16&255,r>>>8&255,r&255]};Pr.fromBytes=function(e,r,n){return n?Pr.fromBytesLE(e,r):Pr.fromBytesBE(e,r)};Pr.fromBytesLE=function(e,r){return new Pr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,r)};Pr.fromBytesBE=function(e,r){return new Pr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],r)}});var ph,BV,jOe,nt,og,f0,LV=w(()=>{ph=A(Kr(),1),BV=ph.default.Reader,jOe=ph.default.Writer,nt=ph.default.util,og=ph.default.roots["ipfs-ipns"]||(ph.default.roots["ipfs-ipns"]={}),f0=og.IpnsEntry=(()=>{function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.value=nt.newBuffer([]),t.prototype.signature=nt.newBuffer([]),t.prototype.validityType=0,t.prototype.validity=nt.newBuffer([]),t.prototype.sequence=nt.Long?nt.Long.fromBits(0,0,!0):0,t.prototype.ttl=nt.Long?nt.Long.fromBits(0,0,!0):0,t.prototype.pubKey=nt.newBuffer([]),t.prototype.signatureV2=nt.newBuffer([]),t.prototype.data=nt.newBuffer([]),t.encode=function(r,n){return n||(n=jOe.create()),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&n.uint32(10).bytes(r.value),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&n.uint32(18).bytes(r.signature),r.validityType!=null&&Object.hasOwnProperty.call(r,"validityType")&&n.uint32(24).int32(r.validityType),r.validity!=null&&Object.hasOwnProperty.call(r,"validity")&&n.uint32(34).bytes(r.validity),r.sequence!=null&&Object.hasOwnProperty.call(r,"sequence")&&n.uint32(40).uint64(r.sequence),r.ttl!=null&&Object.hasOwnProperty.call(r,"ttl")&&n.uint32(48).uint64(r.ttl),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&n.uint32(58).bytes(r.pubKey),r.signatureV2!=null&&Object.hasOwnProperty.call(r,"signatureV2")&&n.uint32(66).bytes(r.signatureV2),r.data!=null&&Object.hasOwnProperty.call(r,"data")&&n.uint32(74).bytes(r.data),n},t.decode=function(r,n){r instanceof BV||(r=BV.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new og.IpnsEntry;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.value=r.bytes();break;case 2:s.signature=r.bytes();break;case 3:s.validityType=r.int32();break;case 4:s.validity=r.bytes();break;case 5:s.sequence=r.uint64();break;case 6:s.ttl=r.uint64();break;case 7:s.pubKey=r.bytes();break;case 8:s.signatureV2=r.bytes();break;case 9:s.data=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof og.IpnsEntry)return r;var n=new og.IpnsEntry;switch(r.value!=null&&(typeof r.value=="string"?nt.base64.decode(r.value,n.value=nt.newBuffer(nt.base64.length(r.value)),0):r.value.length&&(n.value=r.value)),r.signature!=null&&(typeof r.signature=="string"?nt.base64.decode(r.signature,n.signature=nt.newBuffer(nt.base64.length(r.signature)),0):r.signature.length&&(n.signature=r.signature)),r.validityType){case"EOL":case 0:n.validityType=0;break}return r.validity!=null&&(typeof r.validity=="string"?nt.base64.decode(r.validity,n.validity=nt.newBuffer(nt.base64.length(r.validity)),0):r.validity.length&&(n.validity=r.validity)),r.sequence!=null&&(nt.Long?(n.sequence=nt.Long.fromValue(r.sequence)).unsigned=!0:typeof r.sequence=="string"?n.sequence=parseInt(r.sequence,10):typeof r.sequence=="number"?n.sequence=r.sequence:typeof r.sequence=="object"&&(n.sequence=new nt.LongBits(r.sequence.low>>>0,r.sequence.high>>>0).toNumber(!0))),r.ttl!=null&&(nt.Long?(n.ttl=nt.Long.fromValue(r.ttl)).unsigned=!0:typeof r.ttl=="string"?n.ttl=parseInt(r.ttl,10):typeof r.ttl=="number"?n.ttl=r.ttl:typeof r.ttl=="object"&&(n.ttl=new nt.LongBits(r.ttl.low>>>0,r.ttl.high>>>0).toNumber(!0))),r.pubKey!=null&&(typeof r.pubKey=="string"?nt.base64.decode(r.pubKey,n.pubKey=nt.newBuffer(nt.base64.length(r.pubKey)),0):r.pubKey.length&&(n.pubKey=r.pubKey)),r.signatureV2!=null&&(typeof r.signatureV2=="string"?nt.base64.decode(r.signatureV2,n.signatureV2=nt.newBuffer(nt.base64.length(r.signatureV2)),0):r.signatureV2.length&&(n.signatureV2=r.signatureV2)),r.data!=null&&(typeof r.data=="string"?nt.base64.decode(r.data,n.data=nt.newBuffer(nt.base64.length(r.data)),0):r.data.length&&(n.data=r.data)),n},t.toObject=function(r,n){n||(n={});var i={};if(n.defaults){if(n.bytes===String?i.value="":(i.value=[],n.bytes!==Array&&(i.value=nt.newBuffer(i.value))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=nt.newBuffer(i.signature))),i.validityType=n.enums===String?"EOL":0,n.bytes===String?i.validity="":(i.validity=[],n.bytes!==Array&&(i.validity=nt.newBuffer(i.validity))),nt.Long){var s=new nt.Long(0,0,!0);i.sequence=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.sequence=n.longs===String?"0":0;if(nt.Long){var s=new nt.Long(0,0,!0);i.ttl=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.ttl=n.longs===String?"0":0;n.bytes===String?i.pubKey="":(i.pubKey=[],n.bytes!==Array&&(i.pubKey=nt.newBuffer(i.pubKey))),n.bytes===String?i.signatureV2="":(i.signatureV2=[],n.bytes!==Array&&(i.signatureV2=nt.newBuffer(i.signatureV2))),n.bytes===String?i.data="":(i.data=[],n.bytes!==Array&&(i.data=nt.newBuffer(i.data)))}return r.value!=null&&r.hasOwnProperty("value")&&(i.value=n.bytes===String?nt.base64.encode(r.value,0,r.value.length):n.bytes===Array?Array.prototype.slice.call(r.value):r.value),r.signature!=null&&r.hasOwnProperty("signature")&&(i.signature=n.bytes===String?nt.base64.encode(r.signature,0,r.signature.length):n.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),r.validityType!=null&&r.hasOwnProperty("validityType")&&(i.validityType=n.enums===String?og.IpnsEntry.ValidityType[r.validityType]:r.validityType),r.validity!=null&&r.hasOwnProperty("validity")&&(i.validity=n.bytes===String?nt.base64.encode(r.validity,0,r.validity.length):n.bytes===Array?Array.prototype.slice.call(r.validity):r.validity),r.sequence!=null&&r.hasOwnProperty("sequence")&&(typeof r.sequence=="number"?i.sequence=n.longs===String?String(r.sequence):r.sequence:i.sequence=n.longs===String?nt.Long.prototype.toString.call(r.sequence):n.longs===Number?new nt.LongBits(r.sequence.low>>>0,r.sequence.high>>>0).toNumber(!0):r.sequence),r.ttl!=null&&r.hasOwnProperty("ttl")&&(typeof r.ttl=="number"?i.ttl=n.longs===String?String(r.ttl):r.ttl:i.ttl=n.longs===String?nt.Long.prototype.toString.call(r.ttl):n.longs===Number?new nt.LongBits(r.ttl.low>>>0,r.ttl.high>>>0).toNumber(!0):r.ttl),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(i.pubKey=n.bytes===String?nt.base64.encode(r.pubKey,0,r.pubKey.length):n.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.signatureV2!=null&&r.hasOwnProperty("signatureV2")&&(i.signatureV2=n.bytes===String?nt.base64.encode(r.signatureV2,0,r.signatureV2.length):n.bytes===Array?Array.prototype.slice.call(r.signatureV2):r.signatureV2),r.data!=null&&r.hasOwnProperty("data")&&(i.data=n.bytes===String?nt.base64.encode(r.data,0,r.data.length):n.bytes===Array?Array.prototype.slice.call(r.data):r.data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ph.default.util.toJSONOptions)},t.ValidityType=function(){let e={},r=Object.create(e);return r[e[0]="EOL"]=0,r}(),t})()});function o5(t){let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(t).trim().match(e);if(!r)throw new Error("Invalid format");let n=parseInt(r[1],10),i=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,i,s,o,a,c,u))}var MV=w(()=>{});var UV,mS,qV,yh,FV,KV,jV,a5,VV,zV,HV=w(()=>{UV="ERR_IPNS_EXPIRED_RECORD",mS="ERR_UNRECOGNIZED_VALIDITY",qV="ERR_SIGNATURE_CREATION",yh="ERR_SIGNATURE_VERIFICATION",FV="ERR_UNRECOGNIZED_FORMAT",KV="ERR_PEER_ID_FROM_PUBLIC_KEY",jV="ERR_PUBLIC_KEY_FROM_ID",a5="ERR_UNDEFINED_PARAMETER",VV="ERR_INVALID_RECORD_DATA",zV="ERR_INVALID_EMBEDDED_KEY"});var $V,c5,u5,Vn,wS,bS,ks,zOe,HOe,ag,l5,GV,$Oe,GOe,vS,WOe,WV,ES,_S,cg,gh,YOe,XOe,YV,XV,QOe,SS,cu,mh,wh=w(()=>{$V=A(fV(),1);Vr();c5=A(oc(),1),u5=A(ft(),1);li();Zc();Vn=A(oe(),1);fi();dt();st();Pn();bn();sl();wS=A(NV(),1),bS=A(he(),1);LV();MV();HV();ks=Object.assign((0,bS.default)("jsipns"),{error:(0,bS.default)("jsipns:error")}),zOe=Cs.code,HOe=tt("/ipns/"),ag="/ipns/",l5=ag.length,GV=(t,e,r,n)=>{let i=new $V.default(Date.now()+Number(n)),s=f0.ValidityType.EOL,[o,a]=n.toString().split("."),c=BigInt(o)*BigInt(1e5)+BigInt(a||0);return $Oe(t,e,r,s,i,c)},$Oe=async(t,e,r,n,i,s)=>{r=BigInt(r);let o=tt(i.toString()),a=await YOe(t,e,n,o),c=GOe(e,o,n,r,s),u=XV(c),l=await t.sign(u),f={value:e,signature:a,validityType:n,validity:o,sequence:r,ttl:s,signatureV2:l,data:c};return ks(`ipns entry for ${e} created`),f},GOe=(t,e,r,n,i)=>es({Value:t,Validity:e,ValidityType:r,Sequence:n,TTL:i}),vS=async(t,e)=>{let{value:r,validityType:n,validity:i}=e,s,o;e.signatureV2&&e.data?(o=e.signatureV2,s=XV(e.data),WOe(e)):(o=e.signature,s=YV(r,n,i));let a;try{a=await t.verify(s,o)}catch{a=!1}if(!a)throw ks.error("record signature verification failed"),(0,Vn.default)(new Error("record signature verification failed"),yh);if(n===f0.ValidityType.EOL){let c;try{c=o5(Xe(i))}catch{throw ks.error("unrecognized validity format (not an rfc3339 format)"),(0,Vn.default)(new Error("unrecognized validity format (not an rfc3339 format)"),FV)}if(c.getTime()<Date.now())throw ks.error("record has expired"),(0,Vn.default)(new Error("record has expired"),UV)}else if(n)throw ks.error("unrecognized validity type"),(0,Vn.default)(new Error("unrecognized validity type"),mS);ks(`ipns entry for ${r} is valid`)},WOe=t=>{if(!t.data)throw(0,Vn.default)(new Error("Record data is missing"),VV);let e=Rn(t.data);if(Number.isInteger(e.Sequence)&&(e.Sequence=BigInt(e.Sequence)),Number.isInteger(e.TTL)&&(e.TTL=BigInt(e.TTL)),!ro(e.Value,t.value))throw(0,Vn.default)(new Error('Field "value" did not match between protobuf and CBOR'),yh);if(!ro(e.Validity,t.validity))throw(0,Vn.default)(new Error('Field "validity" did not match between protobuf and CBOR'),yh);if(e.ValidityType!==t.validityType)throw(0,Vn.default)(new Error('Field "validityType" did not match between protobuf and CBOR'),yh);if(e.Sequence!==t.sequence)throw(0,Vn.default)(new Error('Field "sequence" did not match between protobuf and CBOR'),yh);if(e.TTL!==t.ttl)throw(0,Vn.default)(new Error('Field "ttl" did not match between protobuf and CBOR'),yh)},WV=async(t,e)=>{if(!t||!t.bytes||!e){let i=new Error("one or more of the provided parameters are not defined");throw ks.error(i),(0,Vn.default)(i,a5)}let r;try{r=await u5.default.createFromPubKey(t.bytes)}catch(i){throw(0,Vn.default)(i,KV)}let n;try{n=QOe(r)}catch(i){throw ks.error(i),(0,Vn.default)(i,jV)}if(n)return null;try{e.pubKey=c5.default.keys.marshalPublicKey(t)}catch(i){throw ks.error(i),i}return e},ES=async(t,e)=>{if(!e||!t){let n=new Error("one or more of the provided parameters are not defined");throw ks.error(n),(0,Vn.default)(n,a5)}let r;if(e.pubKey){try{r=c5.default.keys.unmarshalPublicKey(e.pubKey)}catch(i){throw ks.error(i),i}if(!(await u5.default.createFromPubKey(e.pubKey)).equals(t))throw(0,Vn.default)(new Error("Embedded public key did not match PeerID"),zV)}else t.pubKey&&(r=t.pubKey);if(r)return r;throw(0,Vn.default)(new Error("no public key is available"),a5)},_S=t=>q7.encode(t).slice(1),cg=t=>new Oe(`/ipns/${_S(t)}`),gh=t=>{let e=tt("/pk/"),r=tt("/ipns/");return{routingPubKey:new Oe(Kn([e,t]),!1),pkKey:new Oe(_S(Kn([e,t]))),routingKey:new Oe(Kn([r,t]),!1),ipnsKey:new Oe(_S(Kn([r,t])))}},YOe=(t,e,r,n)=>{try{let i=YV(e,r,n);return t.sign(i)}catch(i){throw ks.error("record signature creation failed"),(0,Vn.default)(new Error("record signature creation failed: "+i.message),qV)}},XOe=t=>{if(t.toString()==="0")return"EOL";let e=new Error(`unrecognized validity type ${t.toString()}`);throw ks.error(e),(0,Vn.default)(e,mS)},YV=(t,e,r)=>{let n=tt(XOe(e));return Kn([t,r,n])},XV=t=>{let e=tt("ipns-signature:");return Kn([e,t])},QOe=t=>{let e=mn(t.id);return e.code!==zOe?null:c5.default.keys.unmarshalPublicKey(e.digest)},SS=t=>f0.encode({...t,sequence:wS.default.fromString(t.sequence.toString()),ttl:t.ttl==null?void 0:wS.default.fromString(t.ttl.toString())}).finish(),cu=t=>{let e=f0.decode(t),r=f0.toObject(e,{defaults:!1,arrays:!0,objects:!1});return{value:r.value,signature:r.signature,validityType:r.validityType,validity:r.validity,sequence:Object.hasOwnProperty.call(r,"sequence")?BigInt(`${r.sequence}`):0,pubKey:r.pubKey,ttl:Object.hasOwnProperty.call(r,"ttl")?BigInt(`${r.ttl}`):void 0,signatureV2:r.signatureV2,data:r.data}},mh={validate:async(t,e)=>{let r=cu(t),n=e.slice(HOe.length),i=u5.default.createFromBytes(n),s=await ES(i,r);await vS(s,r)},select:(t,e)=>{let r=cu(t),n=cu(e);if(r.signatureV2&&!n.signatureV2)return 0;if(n.signatureV2&&!r.signatureV2)return 1;if(r.sequence>n.sequence)return 0;if(r.sequence<n.sequence)return 1;let i=o5(Xe(r.validity));return o5(Xe(n.validity)).getTime()>i.getTime()?1:0}}});var ug,Ds,AS,us,QV,ZV,d0,JV=w(()=>{ug=A(ft(),1);Vr();lo();Ds=A(oe(),1),AS=A(he(),1);st();bn();wh();us=Object.assign((0,AS.default)("ipfs:ipns:publisher"),{error:(0,AS.default)("ipfs:ipns:publisher:error")}),QV=Cn().code,ZV=60*60*1e3,d0=class{constructor(e,r){this._routing=e,this._datastore=r}async publishWithEOL(e,r,n){if(!e||!e.bytes)throw(0,Ds.default)(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");let i=await ug.default.createFromPrivKey(e.bytes),s=await this._updateOrCreateRecord(e,r,n,i);return this._putRecordToRouting(s,i)}publish(e,r){return this.publishWithEOL(e,r,ZV)}async _putRecordToRouting(e,r){if(!ug.default.isPeerId(r)){let o="peerId received is not valid";throw us.error(o),(0,Ds.default)(new Error(o),"ERR_INVALID_PEER_ID")}let n=r.pubKey,i=await WV(n,e),s=gh(r.toBytes());return await this._publishEntry(s.routingKey,i||e),i||e}async _publishEntry(e,r){let n=Oe.asKey(e);if(!n){let s="datastore key does not have a valid format";throw us.error(s),(0,Ds.default)(new Error(s),"ERR_INVALID_DATASTORE_KEY")}let i;try{i=SS(r)}catch(s){throw us.error(s),s}try{let s=await this._routing.put(n.uint8Array(),i);return us(`ipns record for ${Xe(n.uint8Array(),"base32")} was stored in the routing`),s}catch(s){let o=`ipns record for ${Xe(n.uint8Array(),"base32")} could not be stored in the routing - ${s.stack}`;throw us.error(o),us.error(s),(0,Ds.default)(new Error(o),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,r={}){if(!ug.default.isPeerId(e)){let i="peerId received is not valid";throw us.error(i),(0,Ds.default)(new Error(i),"ERR_INVALID_PEER_ID")}let n=r.checkRouting!==!1;try{let i=await this._datastore.get(cg(e.id));return this._unmarshalData(i)}catch(i){if(i.code!==QV){let s=`unexpected error getting the ipns record ${e.id} from datastore`;throw us.error(s),(0,Ds.default)(new Error(s),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!n)throw(0,Ds.default)(i,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let s=gh(e.toBytes()),o=await this._routing.get(s.routingKey.uint8Array());return this._unmarshalData(o)}catch(s){throw us.error(s),s}}}_unmarshalData(e){try{return cu(e)}catch(r){throw(0,Ds.default)(r,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,r,n,i){if(!ug.default.isPeerId(i)){let u="peerId received is not valid";throw us.error(u),(0,Ds.default)(new Error(u),"ERR_INVALID_PEER_ID")}let s={checkRouting:!0},o;try{o=await this._getPublished(i,s)}catch(u){if(u.code!==QV){let l=`unexpected error when determining the last published IPNS record for ${i.id} ${u.stack}`;throw us.error(l),(0,Ds.default)(new Error(l),"ERR_DETERMINING_PUBLISHED_RECORD")}}let a=0;o&&o.sequence!==void 0&&(a=ro(o.value,r)?BigInt(o.sequence):BigInt(o.sequence)+BigInt(1));let c;try{c=await GV(e,r,a,n)}catch(u){let l=`ipns record for ${r} could not be created`;throw us.error(u),(0,Ds.default)(new Error(l),"ERR_CREATING_IPNS_RECORD")}try{let u=SS(c);return await this._datastore.put(cg(i.id),u),us(`ipns record for ${Xe(r,"base32")} was stored in the datastore`),c}catch{let l=`ipns record for ${r} could not be stored in the datastore`;throw us.error(l),(0,Ds.default)(new Error(l),"ERR_STORING_IN_DATASTORE")}}};d0.defaultRecordLifetime=ZV});var ez,RS,Cl,IS,f5,tz,rz,ZOe,JOe,TS,nz=w(()=>{wh();ez=A(oc(),1),RS=A(ft(),1),Cl=A(oe(),1),IS=A(he(),1),f5=Object.assign((0,IS.default)("ipfs:ipns:republisher"),{error:(0,IS.default)("ipfs:ipns:republisher:error")}),tz=60*1e3,rz=60*tz,ZOe=4*rz,JOe=24*rz,TS=class{constructor(e,r,n,i,s={pass:""}){this._publisher=e,this._datastore=r,this._peerId=n,this._keychain=i,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw(0,Cl.default)(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:s=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(s)}catch(o){f5.error(o)}},s())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{privKey:r}=this._peerId,{pass:n}=this._options,i=!0;e._task=()=>this._republishEntries(r,n),e.runPeriodically(()=>i?(i=!1,this._options.initialBroadcastInterval||tz):this._options.broadcastInterval||ZOe),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw(0,Cl.default)(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,r){try{await this._republishEntry(e)}catch{let i="cannot republish entry for the node's private key";f5.error(i);return}if(r)try{let n=await this._keychain.listKeys();for(let i of n){if(i.name==="self")continue;let s=await this._keychain.exportKey(i.name,r),o=await ez.default.keys.import(s,r);await this._republishEntry(o)}}catch(n){f5.error(n)}}async _republishEntry(e){if(!e||!e.bytes)throw(0,Cl.default)(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{let r=await RS.default.createFromPrivKey(e.bytes),n=await this._getPreviousValue(r);await this._publisher.publishWithEOL(e,n,JOe)}catch(r){if(r.code==="ERR_NO_ENTRY_FOUND")return;throw r}}async _getPreviousValue(e){if(!RS.default.isPeerId(e))throw(0,Cl.default)(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let r=await this._datastore.get(cg(e.id));if(!(r instanceof Uint8Array))throw(0,Cl.default)(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return cu(r).value}catch(n){throw f5.error(n),(0,Cl.default)(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(r){throw r&&r.notFound?(0,Cl.default)(new Error(`no previous entry for record with id: ${e.id}`),"ERR_NO_ENTRY_FOUND"):r}}}});var sz,bh,xS,h5,eke,iz,PS,oz=w(()=>{wh();sz=A(ft(),1),bh=A(oe(),1),xS=A(he(),1);st();lo();h5=Object.assign((0,xS.default)("ipfs:ipns:resolver"),{error:(0,xS.default)("ipfs:ipns:resolver:error")}),eke=Cn().code,iz=32,PS=class{constructor(e){this._routing=e}async resolve(e,r={}){if(typeof e!="string")throw(0,bh.default)(new Error("invalid name"),"ERR_INVALID_NAME");let n=r.recursive&&r.recursive.toString()==="true",i=e.split("/");if(i.length!==3||i[0]!=="")throw(0,bh.default)(new Error("invalid name"),"ERR_INVALID_NAME");let s=i[2],o=1/0;n&&(o=iz);let a=await this.resolver(s,o);return h5(`${e} was locally resolved correctly`),a}async resolver(e,r){if(r===0){let s=`could not resolve name (recursion limit of ${iz} exceeded)`;throw h5.error(s),(0,bh.default)(new Error(s),"ERR_RESOLVE_RECURSION_LIMIT")}let n=await this._resolveName(e),i=n.split("/");return i[1]==="ipfs"||!r?n:this.resolver(i[2],r-1)}async _resolveName(e){let r=sz.default.parse(e),{routingKey:n}=gh(r.toBytes()),i;try{i=await this._routing.get(n.uint8Array())}catch(o){throw h5.error("could not get record from routing",o),o.code===eke?(0,bh.default)(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):(0,bh.default)(new Error(`unexpected error getting the ipns record ${r.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s;try{s=cu(i)}catch(o){throw h5.error("could not unmarshal record",o),(0,bh.default)(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(r,s)}async _validateRecord(e,r){let n=await ES(e,r);return await vS(n,r),Xe(r.value)}}});var az,CS,cz=w(()=>{az=A(qp(),1),CS=class{constructor(e){this.lru=(0,az.default)(e)}get(e){let r=this.lru.get(e);if(r){if(r.expire&&r.expire<Date.now()){this.lru.remove(e);return}return r.value}}set(e,r,n){this.lru.set(e,{value:r,expire:Date.now()+n})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}});var lz,fz,OS,lg,uz,d5,hz=w(()=>{lz=A(ft(),1),fz=A(oe(),1),OS=A(he(),1);JV();nz();oz();cz();st();lg=Object.assign((0,OS.default)("ipfs:ipns"),{error:(0,OS.default)("ipfs:ipns:error")}),uz=60*1e3,d5=class{constructor(e,r,n,i,s){this.publisher=new d0(e,r),this.republisher=new TS(this.publisher,r,n,i,s),this.resolver=new PS(e),this.cache=new CS(1e3),this.routing=e}async publish(e,r,n=d0.defaultRecordLifetime){try{let i=await(0,lz.createFromPrivKey)(e.bytes);await this.publisher.publishWithEOL(e,r,n),lg(`IPNS value ${Xe(r,"base32")} was published correctly`);let s=i.toB58String(),o=parseFloat(n),a=o<uz?o:uz;return this.cache.set(s,r,a),lg(`IPNS value ${Xe(r,"base32")} was cached correctly`),{name:s,value:r}}catch(i){throw lg.error(i),i}}async resolve(e,r={}){if(typeof e!="string")throw(0,fz.default)(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!r.nocache&&!r.recursive){let n=e.split("/")[2],i=this.cache.get(n);if(i)return i}try{let n=await this.resolver.resolve(e,r);return lg(`IPNS record from ${e} was resolved correctly`),n}catch(n){throw lg.error(n),n}}async initializeKeyspace(e,r){return this.publish(e,r,d0.defaultRecordLifetime)}}});var yo=g((a1t,dz)=>{"use strict";var tke=async t=>{let e=[];for await(let r of t)e.push(r);return e};dz.exports=tke});var pz,p0,kS=w(()=>{pz=A(yo(),1),p0=(t,e)=>async function*(){yield*(await(0,pz.default)(t)).sort(e)}()});var ls=g((u1t,yz)=>{"use strict";var rke=async t=>{for await(let e of t);};yz.exports=rke});var fs=g((l1t,gz)=>{"use strict";var nke=async function*(t,e){for await(let r of t)await e(r)&&(yield r)};gz.exports=nke});var _h=g((f1t,mz)=>{"use strict";var ike=async function*(t,e){let r=0;if(!(e<1)){for await(let n of t)if(yield n,r++,r===e)return}};mz.exports=ike});var DS,vh,NS,pi,Eh=w(()=>{kS();DS=A(ls(),1),vh=A(fs(),1),NS=A(_h(),1),pi=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,n){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:n,value:i}of e)await this.put(n,i,r),yield{key:n,value:i}}async*getMany(e,r={}){for await(let n of e)yield this.get(n,r)}async*deleteMany(e,r={}){for await(let n of e)await this.delete(n,r),yield n}batch(){let e=[],r=[];return{put(n,i){e.push({key:n,value:i})},delete(n){r.push(n)},commit:async n=>{await(0,DS.default)(this.putMany(e,n)),e=[],await(0,DS.default)(this.deleteMany(r,n)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let n=this._all(e,r);if(e.prefix!=null&&(n=(0,vh.default)(n,i=>i.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,s)=>(0,vh.default)(i,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,s)=>p0(i,s),n)),e.offset!=null){let i=0;n=(0,vh.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,NS.default)(n,e.limit)),n}queryKeys(e,r){let n=this._allKeys(e,r);if(e.prefix!=null&&(n=(0,vh.default)(n,i=>i.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,s)=>(0,vh.default)(i,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,s)=>p0(i,s),n)),e.offset!=null){let i=0;n=(0,vh.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,NS.default)(n,e.limit)),n}}});var bz=g((y1t,wz)=>{wz.exports=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var BS=g((m1t,vz)=>{var _z=bz();vz.exports=class{constructor(e){this.hwm=e||16,this.head=new _z(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new _z(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var ac=g((w1t,Ez)=>{var LS=BS();Ez.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new LS,n,i,s,o=()=>{if(!r.isEmpty()){if(t.writev){let y,b=[];for(;!r.isEmpty();){if(y=r.shift(),y.error)throw y.error;b.push(y.value)}return{done:y.done,value:b}}let p=r.shift();if(p.error)throw p.error;return p}return s?{done:!0}:new Promise((p,y)=>{i=b=>(i=null,b.error?y(b.error):t.writev&&!b.done?p({done:b.done,value:[b.value]}):p(b),n)})},a=p=>i?i(p):(r.push(p),n),c=p=>(r=new LS,i?i({error:p}):(r.push({error:p}),n)),u=p=>s?n:a({done:!1,value:p}),l=p=>s?n:(s=!0,p?c(p):a({done:!0})),f=()=>(r=new LS,l(),{done:!0}),h=p=>(l(p),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:o,return:f,throw:h,push:u,end:l},!e)return n;let d=n;return n={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(p){return d.throw(p),e&&(e(p),e=null),{done:!0}},return(){return d.return(),e&&(e(),e=null),{done:!0}},push:u,end(p){return d.end(p),e&&(e(p),e=null),n}},n}});var Sz,MS,US,ske,fg,qS=w(()=>{Eh();lo();Sz=A(he(),1),MS=A(ac(),1),US=A(ls(),1),ske=(0,Sz.default)("datastore:core:tiered"),fg=class extends pi{constructor(e){super();this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch{throw ng()}}async put(e,r){try{await Promise.all(this.stores.map(n=>n.put(e,r)))}catch{throw sg()}}async get(e,r){for(let n of this.stores)try{let i=await n.get(e,r);if(i)return i}catch(i){ske(i)}throw Cn()}async has(e,r){for(let n of this.stores)if(await n.has(e,r))return!0;return!1}async delete(e,r){try{await Promise.all(this.stores.map(n=>n.delete(e,r)))}catch{throw ig()}}async*putMany(e,r={}){let n,i=this.stores.map(s=>{let o=(0,MS.default)();return(0,US.default)(s.putMany(o,r)).catch(a=>{n=a}),o});try{for await(let s of e){if(n)throw n;i.forEach(o=>o.push(s)),yield s}}finally{i.forEach(s=>s.end())}}async*deleteMany(e,r={}){let n,i=this.stores.map(s=>{let o=(0,MS.default)();return(0,US.default)(s.deleteMany(o,r)).catch(a=>{n=a}),o});try{for await(let s of e){if(n)throw n;i.forEach(o=>o.push(s)),yield s}}finally{i.forEach(s=>s.end())}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(r=>r.batch());return{put:(r,n)=>{e.forEach(i=>i.put(r,n))},delete:r=>{e.forEach(n=>n.delete(r))},commit:async r=>{for(let n of e)await n.commit(r)}}}query(e,r){return this.stores[this.stores.length-1].query(e,r)}queryKeys(e,r){return this.stores[this.stores.length-1].queryKeys(e,r)}}});var hg=g((FS,KS)=>{(function(t,e){typeof FS=="object"&&typeof KS<"u"?KS.exports=function(r,n,i,s,o){for(n=n.split?n.split("."):n,s=0;s<n.length;s++)r=r?r[n[s]]:o;return r===o?i:r}:typeof define=="function"&&define.amd?define(function(){return function(r,n,i,s,o){for(n=n.split?n.split("."):n,s=0;s<n.length;s++)r=r?r[n[s]]:o;return r===o?i:r}}):t.dlv=function(r,n,i,s,o){for(n=n.split?n.split("."):n,s=0;s<n.length;s++)r=r?r[n[s]]:o;return r===o?i:r}})(FS)});var y0=w(()=>{Vr()});var p5,jS=w(()=>{p5=`This is a repository of IPLD objects. Each IPLD object is in a single file,
named <base32 encoding of cid>.data. Where <base32 encoding of cid> is the
"base32" encoding of the CID (as specified in
https://github.com/multiformats/multibase) without the 'B' prefix.
All the object files are placed in a tree of directories, based on a
function of the CID. This is a form of sharding similar to
the objects directory in git repositories. Previously, we used
prefixes, we now use the next-to-last two charters.
    func NextToLast(base32cid string) {
      nextToLastLen := 2
      offset := len(base32cid) - nextToLastLen - 1
      return str[offset : offset+nextToLastLen]
    }
For example, an object with a base58 CIDv1 of
    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f
has a base32 CIDv1 of
    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA
and will be placed at
    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data
with 'SC' being the last-to-next two characters and the 'B' at the
beginning of the CIDv1 string is the multibase prefix that is not
stored in the filename.
`});var GS={};Tt(GS,{NextToLast:()=>$S,PREFIX:()=>y5,Prefix:()=>zS,README_FN:()=>VS,SHARDING_FN:()=>g5,ShardBase:()=>dg,Suffix:()=>HS,parseShardFun:()=>Az,readShardFun:()=>m5,readme:()=>p5});function Az(t){if(t=t.trim(),t.length===0)throw new Error("empty shard string");if(!t.startsWith(y5))throw new Error(`invalid or no path prefix: ${t}`);let e=t.slice(y5.length).split("/"),r=e[0];if(r!=="v1")throw new Error(`expect 'v1' version, got '${r}'`);let n=e[1];if(!e[2])throw new Error("missing param");let i=parseInt(e[2],10);switch(n){case"prefix":return new zS(i);case"suffix":return new HS(i);case"next-to-last":return new $S(i);default:throw new Error(`unkown sharding function: ${n}`)}}var y5,g5,VS,dg,zS,HS,$S,m5,WS=w(()=>{Vr();jS();jS();y5="/repo/flatfs/shard/",g5="SHARDING",VS="_README",dg=class{constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${y5}v1/${this.name}/${this.param}`}},zS=class extends dg{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},HS=class extends dg{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let r=this._padding+e;return r.slice(r.length-this.param)}},$S=class extends dg{constructor(e){super(e);this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let r=this._padding+e,n=r.length-this.param-1;return r.slice(n,n+this.param)}};m5=async(t,e)=>{let r=new Oe(t).child(new Oe(g5)),i=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(r);return Az(new TextDecoder().decode(i||"").trim())}});var YS={};Tt(YS,{MemoryDatastore:()=>w5});var w5,b5=w(()=>{Eh();Vr();lo();w5=class extends pi{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,r){this.data[e.toString()]=r}async get(e){if(!await this.has(e))throw Cn();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,r])=>({key:new Oe(e),value:r}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new Oe(e))}}});var xi=g((C1t,Rz)=>{"use strict";var oke=async function*(t,e){for await(let r of t)yield e(r)};Rz.exports=oke});var br=g((O1t,g0)=>{var Iz=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},XS=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),_5=t=>t&&typeof t.sink=="function"&&XS(t.source),ake=t=>e=>(t.sink(e),t.source),Tz=(...t)=>{if(_5(t[0])){let e=t[0];t[0]=()=>e.source}else if(XS(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&_5(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)_5(t[e])&&(t[e]=ake(t[e]));return Iz(...t)};g0.exports=Tz;g0.exports.pipe=Tz;g0.exports.rawPipe=Iz;g0.exports.isIterable=XS;g0.exports.isDuplex=_5});var Ol,v5,Sh,E5=w(()=>{Eh();Ol=A(xi(),1),v5=A(br(),1),Sh=class extends pi{constructor(e,r){super();this.child=e,this.transform=r}open(){return this.child.open()}put(e,r,n){return this.child.put(this.transform.convert(e),r,n)}get(e,r){return this.child.get(this.transform.convert(e),r)}has(e,r){return this.child.has(this.transform.convert(e),r)}delete(e,r){return this.child.delete(this.transform.convert(e),r)}async*putMany(e,r={}){let n=this.transform,i=this.child;yield*(0,v5.pipe)(e,async function*(s){yield*(0,Ol.default)(s,({key:o,value:a})=>({key:n.convert(o),value:a}))},async function*(s){yield*i.putMany(s,r)},async function*(s){yield*(0,Ol.default)(s,({key:o,value:a})=>({key:n.invert(o),value:a}))})}async*getMany(e,r={}){let n=this.transform,i=this.child;yield*(0,v5.pipe)(e,async function*(s){yield*(0,Ol.default)(s,o=>n.convert(o))},async function*(s){yield*i.getMany(s,r)})}async*deleteMany(e,r={}){let n=this.transform,i=this.child;yield*(0,v5.pipe)(e,async function*(s){yield*(0,Ol.default)(s,o=>n.convert(o))},async function*(s){yield*i.deleteMany(s,r)},async function*(s){yield*(0,Ol.default)(s,o=>n.invert(o))})}batch(){let e=this.child.batch();return{put:(r,n)=>{e.put(this.transform.convert(r),n)},delete:r=>{e.delete(this.transform.convert(r))},commit:r=>e.commit(r)}}query(e,r){let n={...e};n.filters=(n.filters||[]).map(s=>({key:o,value:a})=>s({key:this.transform.convert(o),value:a}));let{prefix:i}=e;return i!=null&&i!=="/"&&(delete n.prefix,n.filters.push(({key:s})=>this.transform.invert(s).toString().startsWith(i))),n.orders&&(n.orders=n.orders.map(s=>(o,a)=>s({key:this.transform.invert(o.key),value:o.value},{key:this.transform.invert(a.key),value:a.value}))),(0,Ol.default)(this.child.query(n,r),({key:s,value:o})=>({key:this.transform.invert(s),value:o}))}queryKeys(e,r){let n={...e};n.filters=(n.filters||[]).map(s=>o=>s(this.transform.convert(o)));let{prefix:i}=e;return i!=null&&i!=="/"&&(delete n.prefix,n.filters.push(s=>this.transform.invert(s).toString().startsWith(i))),n.orders&&(n.orders=n.orders.map(s=>(o,a)=>s(this.transform.invert(o),this.transform.invert(a)))),(0,Ol.default)(this.child.queryKeys(n,r),s=>this.transform.invert(s))}close(){return this.child.close()}}});var m0,pg,kl,xz=w(()=>{y0();WS();Eh();E5();lo();m0=new Oe(g5),pg=new Oe(VS),kl=class extends pi{constructor(e,r){super();this.child=new Sh(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=r}async open(){await this.child.open(),this.shard=await kl.create(this.child,this.shard)}_convertKey(e){let r=e.toString();return r===m0.toString()||r===pg.toString()?e:new Oe(this.shard.fun(r)).child(e)}_invertKey(e){let r=e.toString();return r===m0.toString()||r===pg.toString()?e:Oe.withNamespaces(e.list().slice(1))}static async createOrOpen(e,r){try{await kl.create(e,r)}catch(n){if(n&&n.message!=="datastore exists")throw n}return kl.open(e)}static async open(e){let r=await m5("/",e);return new kl(e,r)}static async create(e,r){let n=await e.has(m0);if(!n&&!r)throw ng(Error("Shard is required when datastore doesn't have a shard key already."));if(!n){let a=typeof e.putRaw=="function"?e.putRaw.bind(e):e.put.bind(e);return await Promise.all([a(m0,new TextEncoder().encode(r.toString()+`
`)),a(pg,new TextEncoder().encode(p5))]),r}let i=await m5("/",e),s=(i||"").toString(),o=r.toString();if(s!==o)throw new Error(`specified fun ${o} does not match repo shard fun ${s}`);return i}put(e,r,n){return this.child.put(e,r,n)}get(e,r){return this.child.get(e,r)}has(e,r){return this.child.has(e,r)}delete(e,r){return this.child.delete(e,r)}async*putMany(e,r={}){yield*this.child.putMany(e,r)}async*getMany(e,r={}){yield*this.child.getMany(e,r)}async*deleteMany(e,r={}){yield*this.child.deleteMany(e,r)}batch(){return this.child.batch()}query(e,r){let n={...e,filters:[({key:i})=>i.toString()!==m0.toString(),({key:i})=>i.toString()!==pg.toString()].concat(e.filters||[])};return this.child.query(n,r)}queryKeys(e,r){let n={...e,filters:[i=>i.toString()!==m0.toString(),i=>i.toString()!==pg.toString()].concat(e.filters||[])};return this.child.queryKeys(n,r)}close(){return this.child.close()}}});var Dl=g((q1t,Pz)=>{"use strict";var cke=ac(),uke=async function*(...t){let e=cke();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let n of r)e.push(n)})),e.end()}catch(r){e.end(r)}},0),yield*e};Pz.exports=uke});var yg,QS,ZS,JS,Cz=w(()=>{yg=A(fs(),1),QS=A(_h(),1),ZS=A(Dl(),1);Eh();lo();kS();JS=class extends pi{constructor(e){super();this.mounts=e.slice()}async open(){await Promise.all(this.mounts.map(e=>e.datastore.open()))}_lookup(e){for(let r of this.mounts)if(r.prefix.toString()===e.toString()||r.prefix.isAncestorOf(e))return{datastore:r.datastore,mountpoint:r.prefix}}put(e,r,n){let i=this._lookup(e);if(i==null)throw sg(new Error("No datastore mounted for this key"));return i.datastore.put(e,r,n)}get(e,r){let n=this._lookup(e);if(n==null)throw Cn(new Error("No datastore mounted for this key"));return n.datastore.get(e,r)}has(e,r){let n=this._lookup(e);return n==null?Promise.resolve(!1):n.datastore.has(e,r)}delete(e,r){let n=this._lookup(e);if(n==null)throw ig(new Error("No datastore mounted for this key"));return n.datastore.delete(e,r)}async close(){await Promise.all(this.mounts.map(e=>e.datastore.close()))}batch(){let e={},r=n=>{let i=this._lookup(n);if(i==null)throw new Error("No datastore mounted for this key");let s=i.mountpoint.toString();return e[s]==null&&(e[s]=i.datastore.batch()),{batch:e[s]}};return{put:(n,i)=>{r(n).batch.put(n,i)},delete:n=>{r(n).batch.delete(n)},commit:async n=>{await Promise.all(Object.keys(e).map(i=>e[i].commit(n)))}}}query(e,r){let n=this.mounts.map(s=>s.datastore.query({prefix:e.prefix,filters:e.filters},r)),i=(0,ZS.default)(...n);if(e.filters&&e.filters.forEach(s=>{i=(0,yg.default)(i,s)}),e.orders&&e.orders.forEach(s=>{i=p0(i,s)}),e.offset!=null){let s=0;i=(0,yg.default)(i,()=>s++>=e.offset)}return e.limit!=null&&(i=(0,QS.default)(i,e.limit)),i}queryKeys(e,r){let n=this.mounts.map(s=>s.datastore.queryKeys({prefix:e.prefix,filters:e.filters},r)),i=(0,ZS.default)(...n);if(e.filters&&e.filters.forEach(s=>{i=(0,yg.default)(i,s)}),e.orders&&e.orders.forEach(s=>{i=p0(i,s)}),e.offset!=null){let s=0;i=(0,yg.default)(i,()=>s++>=e.offset)}return e.limit!=null&&(i=(0,QS.default)(i,e.limit)),i}}});var eA,Oz=w(()=>{y0();E5();eA=class extends Sh{constructor(e,r){super(e,{convert(n){return r.child(n)},invert(n){if(r.toString()==="/")return n;if(!r.isAncestorOf(n))throw new Error(`Expected prefix: (${r.toString()}) in key: ${n.toString()}`);return new Oe(n.toString().slice(r.toString().length),!1)}})}}});var kz={};Tt(kz,{BaseDatastore:()=>pi,Errors:()=>Ah,KeyTransformDatastore:()=>Sh,MemoryDatastore:()=>w5,MountDatastore:()=>JS,NamespaceDatastore:()=>eA,ShardingDatastore:()=>kl,TieredDatastore:()=>fg,shard:()=>lke});var Ah,lke,S5=w(()=>{lo();WS();Eh();b5();E5();xz();Cz();qS();Oz();Ah=Pl,lke=GS});function tA(t){return Xe(t,"base32")}function gg(t){(typeof t=="string"||t instanceof String)&&(t=tt(t.toString()));let e=Xe(t,"base64url");return`${A5}${e}`}function Nz(t){if(t.substring(0,A5.length)!==A5)throw(0,Dz.default)(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let e=t.substring(A5.length);return tt(e,"base64url")}var Dz,A5,Bz=w(()=>{Dz=A(oe(),1);st();dt();A5="/record/"});var Ns,rA,Pi,nA,Lz=w(()=>{y0();S5();Bz();bn();Ns=A(oe(),1),rA=A(he(),1),Pi=Object.assign((0,rA.default)("datastore-pubsub:publisher"),{error:(0,rA.default)("datastore-pubsub:publisher:error")}),nA=class extends pi{constructor(e,r,n,i,s){super();if(!i)throw(0,Ns.default)(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof i.validate!="function")throw(0,Ns.default)(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof i.select!="function")throw(0,Ns.default)(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw(0,Ns.default)(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=r,this._peerId=n,this._validator=i,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this)}async put(e,r){if(!(e instanceof Uint8Array)){let i="datastore key does not have a valid format";throw Pi.error(i),(0,Ns.default)(new Error(i),"ERR_INVALID_DATASTORE_KEY")}if(!(r instanceof Uint8Array)){let i="received value is not a Uint8Array";throw Pi.error(i),(0,Ns.default)(new Error(i),"ERR_INVALID_VALUE_RECEIVED")}let n=gg(e);Pi(`publish value for topic ${n}`),await this._pubsub.publish(n,r)}async get(e){if(!(e instanceof Uint8Array)){let i="datastore key does not have a valid format";throw Pi.error(i),(0,Ns.default)(new Error(i),"ERR_INVALID_DATASTORE_KEY")}let r=gg(e),n=await this._pubsub.getTopics();if(n&&Array.isArray(n)&&n.indexOf(r)>-1)return this._getLocal(e);try{this._pubsub.on(r,this._onMessage),await this._pubsub.subscribe(r)}catch{let s=`cannot subscribe topic ${r}`;throw Pi.error(s),(0,Ns.default)(new Error(s),"ERR_SUBSCRIBING_TOPIC")}return Pi(`subscribed values for key ${r}`),this._getLocal(e)}unsubscribe(e){let r=gg(e);return this._pubsub.removeListener(r,this._onMessage),this._pubsub.unsubscribe(r)}async _getLocal(e){let r=new Oe("/"+tA(e),!1),n;try{n=await this._datastore.get(r)}catch(i){if(i.code!=="ERR_NOT_FOUND"){let o=`unexpected error getting the ipns record for ${r.toString()}`;throw Pi.error(o),(0,Ns.default)(new Error(o),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s=`local record requested was not found for ${r.toString()}`;throw Pi.error(s),(0,Ns.default)(new Error(s),"ERR_NOT_FOUND")}if(!(n instanceof Uint8Array)){let i="found record that we couldn't convert to a value";throw Pi.error(i),(0,Ns.default)(new Error(i),"ERR_INVALID_RECORD_RECEIVED")}return n}async _onMessage(e){let{data:r,from:n,topicIDs:i}=e,s;try{s=Nz(i[0])}catch(o){Pi.error(o);return}if(Pi(`message received for topic ${i[0]}`),n===this._peerId.toB58String()){Pi("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let o;try{o=await this._handleSubscriptionKeyFn(s)}catch{Pi.error("message discarded by the subscriptionKeyFn");return}s=o}try{await this._storeIfSubscriptionIsBetter(s,r)}catch(o){Pi.error(o)}}async _storeIfSubscriptionIsBetter(e,r){let n=!1;try{n=await this._isBetter(e,r)}catch(i){if(i.code!=="ERR_NOT_VALID_RECORD")throw i}n&&await this._storeRecord(e,r)}async _validateRecord(e,r){return this._validator.validate(e,r)}async _selectRecord(e,r){return await this._validator.select(e,r)===0}async _isBetter(e,r){try{await this._validateRecord(r,e)}catch{let o="record received through pubsub is not valid";throw Pi.error(o),(0,Ns.default)(new Error(o),"ERR_NOT_VALID_RECORD")}let n=new Oe(e),i;try{i=await this._getLocal(n.uint8Array())}catch{return!0}return ro(i,r)?!1:this._selectRecord(e,[i,r])}async _storeRecord(e,r){let n=new Oe("/"+tA(e),!1);await this._datastore.put(n,r),Pi(`record for ${gg(e)} was stored in the datastore`)}}});var iA,sA,R5,w0,oA=w(()=>{wh();wn();Lz();dt();st();iA=A(oe(),1),sA=A(he(),1),R5=Object.assign((0,sA.default)("ipfs:ipns:pubsub"),{error:(0,sA.default)("ipfs:ipns:pubsub:error")}),w0=class{constructor(e,r,n){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new nA(e,r,n,mh,this._handleSubscriptionKey)}async put(e,r){try{await this._pubsubDs.put(e,r)}catch(n){throw R5.error(n),n}}async get(e){let r,n;try{r=await this._pubsubDs.get(e)}catch(s){n=s}let i=e.slice(0,l5);if(Xe(i)===ag){let s=bt.encode(e).substring(1),o=bt.encode(e.slice(l5)).substring(1);this._subscriptions[s]=o,R5(`subscribed to pubsub topic ${s}, id ${o}`)}if(n)throw n;return r}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=Xe(e,"base58btc"));let r=this._subscriptions[e];if(!r)throw(0,iA.default)(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");let n;try{n=gh(tt(r,"base58btc"))}catch(i){throw R5.error(i),i}return n.routingKey.uint8Array()}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(r=>`${ag}${r}`)}async cancel(e){if(typeof e!="string")throw(0,iA.default)(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(ag)&&(e=e.substring(l5));let r=Object.keys(this._subscriptions).find(i=>this._subscriptions[i]===e);if(!r)return{canceled:!1};let n=tt(r);return this._pubsubDs.unsubscribe(n),delete this._subscriptions[r],R5(`unsubscribed pubsub ${r}: ${e}`),{canceled:!0}}}});var qz=g((hyt,Uz)=>{"use strict";var b0=Kr(),Mz=b0.Reader,fke=b0.Writer,go=b0.util,mg=b0.roots["libp2p-record"]||(b0.roots["libp2p-record"]={});mg.Record=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.key=go.newBuffer([]),t.prototype.value=go.newBuffer([]),t.prototype.timeReceived="",t.encode=function(r,n){return n||(n=fke.create()),r.key!=null&&Object.hasOwnProperty.call(r,"key")&&n.uint32(10).bytes(r.key),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&n.uint32(18).bytes(r.value),r.timeReceived!=null&&Object.hasOwnProperty.call(r,"timeReceived")&&n.uint32(42).string(r.timeReceived),n},t.decode=function(r,n){r instanceof Mz||(r=Mz.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new mg.Record;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.key=r.bytes();break;case 2:s.value=r.bytes();break;case 5:s.timeReceived=r.string();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof mg.Record)return r;var n=new mg.Record;return r.key!=null&&(typeof r.key=="string"?go.base64.decode(r.key,n.key=go.newBuffer(go.base64.length(r.key)),0):r.key.length&&(n.key=r.key)),r.value!=null&&(typeof r.value=="string"?go.base64.decode(r.value,n.value=go.newBuffer(go.base64.length(r.value)),0):r.value.length&&(n.value=r.value)),r.timeReceived!=null&&(n.timeReceived=String(r.timeReceived)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.key="":(i.key=[],n.bytes!==Array&&(i.key=go.newBuffer(i.key))),n.bytes===String?i.value="":(i.value=[],n.bytes!==Array&&(i.value=go.newBuffer(i.value))),i.timeReceived=""),r.key!=null&&r.hasOwnProperty("key")&&(i.key=n.bytes===String?go.base64.encode(r.key,0,r.key.length):n.bytes===Array?Array.prototype.slice.call(r.key):r.key),r.value!=null&&r.hasOwnProperty("value")&&(i.value=n.bytes===String?go.base64.encode(r.value,0,r.value.length):n.bytes===Array?Array.prototype.slice.call(r.value):r.value),r.timeReceived!=null&&r.hasOwnProperty("timeReceived")&&(i.timeReceived=r.timeReceived),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,b0.util.toJSONOptions)},t}();Uz.exports=mg});var Fz=g((dyt,aA)=>{"use strict";aA.exports.toRFC3339=t=>{let e=t.getUTCFullYear(),r=String(t.getUTCMonth()+1).padStart(2,"0"),n=String(t.getUTCDate()).padStart(2,"0"),i=String(t.getUTCHours()).padStart(2,"0"),s=String(t.getUTCMinutes()).padStart(2,"0"),o=String(t.getUTCSeconds()).padStart(2,"0"),c=t.getUTCMilliseconds()*1e3*1e3;return`${e}-${r}-${n}T${i}:${s}:${o}.${c}Z`};aA.exports.parseRFC3339=t=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(t).trim().match(e);if(!r)throw new Error("Invalid format");let n=parseInt(r[1],10),i=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,i,s,o,a,c,u))}});var Vz=g((pyt,jz)=>{"use strict";var{Record:cA}=qz(),Kz=Fz(),wg=class{constructor(e,r,n){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(r instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=r,this.timeReceived=n}serialize(){return cA.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&Kz.toRFC3339(this.timeReceived)}}static deserialize(e){let r=cA.decode(e);return wg.fromDeserialized(cA.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(e){let r;return e.timeReceived&&(r=Kz.parseRFC3339(e.timeReceived)),new wg(e.key,e.value,r)}};jz.exports=wg});var Hz=g((yyt,zz)=>{"use strict";var{sha256:hke}=(Tn(),se(Js)),I5=oe(),{toString:dke}=(st(),se(hr)),{equals:pke}=(bn(),se(Ei)),yke=async(t,e)=>{if(!(t instanceof Uint8Array))throw I5(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(t.byteLength<5)throw I5(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(dke(t.subarray(0,4))!=="/pk/")throw I5(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let n=t.slice(4),i=await hke.digest(e);if(!pke(n,i.bytes))throw I5(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")};zz.exports={func:yke,sign:!1}});var Gz=g((gyt,$z)=>{"use strict";$z.exports={pk:Hz()}});var Yz=g((myt,Wz)=>{"use strict";var gke=oe(),{toString:mke}=(st(),se(hr)),wke=(t,e)=>{let r=e.key,i=mke(r).split("/");if(i.length<3)return;let s=t[i[1].toString()];if(!s){let o="Invalid record keytype";throw gke(new Error(o),"ERR_INVALID_RECORD_KEY_TYPE")}return s.func(r,e.value)};Wz.exports={verifyRecord:wke,validators:Gz()}});var Qz=g((wyt,Xz)=>{"use strict";var bke=(t,e)=>0;Xz.exports=bke});var Jz=g((byt,Zz)=>{"use strict";Zz.exports={pk:Qz()}});var tH=g((_yt,eH)=>{"use strict";var uA=oe(),{toString:_ke}=(st(),se(hr)),vke=(t,e,r)=>{if(r.length===0){let o="No records given";throw uA(new Error(o),"ERR_NO_RECORDS_RECEIVED")}let i=_ke(e).split("/");if(i.length<3){let o="Record key does not have a selector function";throw uA(new Error(o),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let s=t[i[1].toString()];if(!s){let o=`Unrecognized key prefix: ${i[1]}`;throw uA(new Error(o),"ERR_UNRECOGNIZED_KEY_PREFIX")}return r.length===1?0:s(e,r)};eH.exports={bestRecord:vke,selectors:Jz()}});var cc=g((vyt,rH)=>{"use strict";rH.exports={Record:Vz(),validator:Yz(),selection:tH()}});var fA,_0,hA,lA,bg,dA=w(()=>{Vr();fA=A(cc(),1),_0=A(oe(),1),hA=A(he(),1);st();lA=Object.assign((0,hA.default)("ipfs:ipns:offline-datastore"),{error:(0,hA.default)("ipfs:ipns:offline-datastore:error")}),bg=class{constructor(e){this._repo=e,this.stores=[]}async put(e,r){if(!(e instanceof Uint8Array))throw(0,_0.default)(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(r instanceof Uint8Array))throw(0,_0.default)(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let n;try{n=this._routingKey(e)}catch(s){throw lA.error(s),(0,_0.default)(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let i=new fA.Record(e,r);return this._repo.datastore.put(n,i.serialize())}async get(e){if(!(e instanceof Uint8Array))throw(0,_0.default)(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let r;try{r=this._routingKey(e)}catch(s){throw lA.error(s),(0,_0.default)(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=await this._repo.datastore.get(r),i;try{i=fA.Record.deserialize(n)}catch(s){throw lA.error(s),s}return i.value}_routingKey(e){return new Oe("/dht/record/"+Xe(e,"base32"),!1)}}});var nH,pA,Eke,yA,iH=w(()=>{nH=A(ls(),1);lo();pA=A(he(),1),Eke=Object.assign((0,pA.default)("ipfs:ipns:dht-datastore"),{error:(0,pA.default)("ipfs:ipns:dht-datastore:error")}),yA=class{constructor(e){this._dht=e}async put(e,r){try{await(0,nH.default)(this._dht.put(e,r))}catch(n){throw Eke.error(n),n}}async get(e){for await(let r of this._dht.get(e))if(r.name==="VALUE")return r.value;throw Cn()}}});function sH({libp2p:t,repo:e,peerId:r,options:n}){let i=[],s;if((0,T5.default)(n,"EXPERIMENTAL.ipnsPubsub",!1)){let o=t.pubsub,a=e.datastore;s=new w0(o,a,r),i.push(s)}if(!(0,T5.default)(n,"offline",!1)&&t._config&&t._config.dht&&t._config.dht.enabled&&i.push(new yA(t._dht)),(0,T5.default)(n,"offline",!1)||i.length===0){let o=new bg(e);i.push(o)}return new fg(i)}var T5,oH=w(()=>{qS();T5=A(hg(),1);oA();dA();iH()});var aH,Ske,gA,cH=w(()=>{hz();oH();dA();ul();aH=A(he(),1),Ske=(0,aH.default)("ipfs:components:ipns"),gA=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new al}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:r,keychain:n}){if(this.offline!=null)throw new ja;Ske("initializing IPNS keyspace");let i=new bg(e),s=new d5(i,e.datastore,r,n,this.options);this.offline=s}async startOnline({libp2p:e,repo:r,peerId:n,keychain:i}){if(this.online!=null)throw new ja;let s=sH({libp2p:e,repo:r,peerId:n,options:this.options}),o=new d5(s,r.datastore,n,i,this.options);await o.republisher.start(),this.online=o}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,r,n){return this.getIPNS().publish(e,r,n)}resolve(e,r){return this.getIPNS().resolve(e,r)}initializeKeyspace(e,r){return this.getIPNS().initializeKeyspace(e,r)}}});async function fH({ipns:t,repo:e,codecs:r},n,i){if(uH.default.ipnsPath(n))return t.resolve(n);let{cid:s,path:o}=eu(n);await(0,lH.default)(yl(s,o||"",r,e,i))}var uH,lH,hH=w(()=>{uH=A(Lp(),1);R2();lH=A(ls(),1);ti()});function pH({ipns:t,repo:e,codecs:r,peerId:n,isOnline:i,keychain:s}){let o=async c=>{if(c==="self")return n.privKey;try{let u=await s.exportKey(c,"temp");return await dH.default.keys.import(u,"temp")}catch(u){throw mA.error(u),(0,bA.default)(u,"ERR_CANNOT_GET_KEY")}};async function a(c,u={}){let l=u.resolve!==!1,f=u.lifetime||"24h",h=u.key||"self";if(!i())throw(0,bA.default)(new Error(p6),"OFFLINE_ERROR");try{c=YU(c)}catch(m){throw mA.error(m),m}let d=0;try{d=hl(f)||0,d=parseFloat(d.toFixed(6))}catch(m){throw mA.error(m),m}let p=await Promise.all([o(h),l?fH({ipns:t,repo:e,codecs:r},c):Promise.resolve()]),y=tt(c),b=await t.publish(p[0],y,d);return{name:b.name,value:Xe(b.value)}}return Q(a)}var wA,dH,bA,mA,yH=w(()=>{wA=A(he(),1);A2();dH=A(oc(),1),bA=A(oe(),1);dt();st();ti();Ce();hH();mA=Object.assign((0,wA.default)("ipfs:name:publish"),{error:(0,wA.default)("ipfs:name:publish:error")})});var mH=g((Gyt,gH)=>{"use strict";var Ake=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;gH.exports=function(e,r){if(r==null&&(r=!1),e.length<2||e.length>255)return!1;var n=e[e.length-1];if(r){if(n!==".")return!1}else if(n===".")return!1;return Ake.test(e)}});function vH({dns:t,ipns:e,peerId:r,isOnline:n,options:{offline:i}}){async function*s(o,a={}){if(a=Rke({nocache:!1,recursive:!0},a),i&&a&&a.nocache)throw(0,x5.default)(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!n()&&!i)throw(0,x5.default)(new Error(p6),"OFFLINE_ERROR");o||(o=r.toB58String()),o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[c,u,...l]=o.slice(1).split("/");try{if(u.substring(0,1)==="1"){let h=bH.default.parse(u),d=mn(h.toBytes());u=L.createV1(114,d).toString(Ap)}else{let h=L.parse(u);h.version===1&&(u=h.toString(Ap))}}catch(h){if((0,_H.default)(u)){yield wH(await t(u,a),l);return}throw Ike.error(h),(0,x5.default)(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}let f=await e.resolve(`/${c}/${u}`,a);yield wH(f instanceof Uint8Array?Xe(f):f,l)}return Q(s)}var _A,x5,bH,_H,Rke,Ike,wH,EH=w(()=>{_A=A(he(),1),x5=A(oe(),1);Fn();Se();li();d2();bH=A(ft(),1),_H=A(mH(),1);st();ti();Ce();Rke=Bt.bind({ignoreUndefined:!0}),Ike=Object.assign((0,_A.default)("ipfs:name:resolve"),{error:(0,_A.default)("ipfs:name:resolve:error")}),wH=(t,e)=>e.length>0?t+"/"+e.join("/"):t});function v0(t,e){if(!t||!(e&&e.ipnsPubsub))throw(0,vA.default)(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(t.routing instanceof w0)return t.routing;let r=(t.routing.stores||[]).find(n=>n instanceof w0);if(!r)throw(0,vA.default)(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return r}var vA,P5=w(()=>{oA();vA=A(oe(),1)});function SH({ipns:t,options:e}){let r=e.EXPERIMENTAL;async function n(i,s={}){return v0(t,r).cancel(i,s)}return Q(n)}var AH=w(()=>{P5();Ce()});function RH({ipns:t,options:e}){let r=e.EXPERIMENTAL;async function n(i={}){try{return{enabled:Boolean(v0(t,r))}}catch{return{enabled:!1}}}return Q(n)}var IH=w(()=>{P5();Ce()});function TH({ipns:t,options:e}){let r=e.EXPERIMENTAL;async function n(i={}){return v0(t,r).getSubscriptions(i)}return Q(n)}var xH=w(()=>{P5();Ce()});var EA,PH=w(()=>{AH();IH();xH();EA=class{constructor({ipns:e,options:r}){this.cancel=SH({ipns:e,options:r}),this.state=RH({ipns:e,options:r}),this.subs=TH({ipns:e,options:r})}}});var SA,CH=w(()=>{yH();EH();PH();SA=class{constructor({dns:e,ipns:r,repo:n,codecs:i,peerId:s,isOnline:o,keychain:a,options:c}){this.publish=pH({ipns:r,repo:n,codecs:i,peerId:s,isOnline:o,keychain:a}),this.resolve=vH({dns:e,ipns:r,peerId:s,isOnline:o,options:c}),this.pubsub=new EA({ipns:r,options:c})}}});function DH({repo:t,codecs:e,resolve:r,preload:n}){async function*i(s,o={}){if(o.maxDepth===0)return;if(o.edges&&o.format&&o.format!==AA.default)throw new Error("Cannot set edges to true and also specify format");if(o.format=o.edges?AA.edges:o.format,typeof o.maxDepth!="number"&&(o.maxDepth=o.recursive?1/0:1),o.timeout){let l=[new OH.TimeoutController(o.timeout).signal];o.signal&&l.push(o.signal),o.signal=(0,kH.anySignal)(l)}let c=(Array.isArray(s)?s:[s]).map(u=>xke(n,u,o));for(let u of c)try{yield*Pke(r,t,e,u,o)}catch(l){yield{ref:"",err:l.message}}}return i}function xke(t,e,r){let{cid:n,path:i}=eu(e);return r.preload!==!1&&t(n),`/ipfs/${n}${i||""}`}async function*Pke(t,e,r,n,i){let s=await t(n,i),{cid:o}=eu(s),a=i.maxDepth!=null?i.maxDepth:1/0,c=i.unique||!1;for await(let u of Oke(e,r,o,a,c,i))!u.parent||u.isDuplicate||(yield{ref:Cke(u.parent.cid,u.node.cid,u.node.name,i.format)})}function Cke(t,e,r="",n=AA.default){let i=n.replace(/<src>/g,t.toString());return i=i.replace(/<dst>/g,e.toString()),i=i.replace(/<linkname>/g,r),i}async function*Oke(t,e,r,n,i,s){let o=new Set;async function*a(c,u){let l=u+1;if(!(l>n))try{for await(let f of kke(t,e,c.cid,s))yield{parent:c,node:f,isDuplicate:i&&o.has(f.cid.toString())},i&&o.add(f.cid.toString()),yield*a(f,l)}catch(f){throw f.code===Tke&&(f.message=`Could not find object with CID: ${c.cid}`),f}}yield*a({cid:r},0)}async function*kke(t,e,r,n){let i=await t.blocks.get(r,n),o=(await e.getCodec(r.code)).decode(i),a=r.code===St,c=[];for(let[u,l]of RA(o,c)){if(a){let f=u.match(/^Links\/(\d+)\/Hash$/);if(f){let h=Number(f[1]);if(h<o.Links.length){yield{name:o.Links[h].Name,cid:l};continue}}}yield{name:u,cid:l}}}var OH,kH,Tke,AA,RA,NH=w(()=>{xt();lo();R2();Se();OH=A(za(),1),kH=A(na(),1),Tke=Cn().code,AA={default:"<dst>",edges:"<src> -> <dst>"};RA=function*(t,e){if(t!=null&&!(t instanceof Uint8Array)){for(let[r,n]of Object.entries(t)){let i=[...e,r];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[s,o]of n.entries()){let a=[...i,s],c=L.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*RA(o,a))}else{let s=L.asCID(n);s?yield[i.join("/"),s]:yield*RA(n,i)}}return[]}}});function BH({repo:t}){async function*e(r={}){for await(let n of t.blocks.queryKeys({},{signal:r.signal}))yield{ref:n.toString()}}return Q(e)}var LH=w(()=>{Ce()});function MH({network:t}){async function e(r={}){let{bitswap:n}=await t.use(r),i=n.getWantlist();return Array.from(i).map(s=>s[1].cid)}return Q(e)}var UH=w(()=>{Ce()});function FH({network:t}){async function e(r,n={}){let{bitswap:i}=await t.use(n),s=i.wantlistForPeer(qH.default.createFromB58String(r));return Array.from(s).map(o=>o[1].cid)}return Q(e)}var qH,KH=w(()=>{qH=A(ft(),1);Ce()});function jH({network:t}){async function e(r,n={}){let{bitswap:i}=await t.use(n);return Array.isArray(r)||(r=[r]),i.unwant(r)}return Q(e)}var VH=w(()=>{Ce()});function C5({network:t}){async function e(r={}){let n=(await t.use(r)).bitswap,i=n.stat().snapshot;return{provideBufLen:parseInt(i.providesBufferLength.toString()),blocksReceived:BigInt(i.blocksReceived.toString()),wantlist:Array.from(n.getWantlist()).map(s=>s[1].cid),peers:n.peers().map(s=>s.toB58String()),dupBlksReceived:BigInt(i.dupBlksReceived.toString()),dupDataReceived:BigInt(i.dupDataReceived.toString()),dataReceived:BigInt(i.dataReceived.toString()),blocksSent:BigInt(i.blocksSent.toString()),dataSent:BigInt(i.dataSent.toString())}}return Q(e)}var IA=w(()=>{Ce()});var TA,zH=w(()=>{UH();KH();VH();IA();TA=class{constructor({network:e}){this.wantlist=MH({network:e}),this.wantlistForPeer=FH({network:e}),this.unwant=jH({network:e}),this.stat=C5({network:e})}}});function O5(t){try{return HH.default.IPFS.matches(t)}catch{return!1}}var HH,xA=w(()=>{HH=A(eh(),1)});function $H({repo:t}){async function e(r,n={}){if(!O5(r))throw new Error(`${r} is not a valid Multiaddr`);let i=await t.config.getAll(n),s=i.Bootstrap||[];return s.push(r.toString()),i.Bootstrap=Array.from(new Set(s)).sort((o,a)=>o.localeCompare(a)),await t.config.replace(i),{Peers:[r]}}return Q(e)}var GH=w(()=>{xA();Ce()});function YH({repo:t}){async function e(r={}){let n=await t.config.getAll(r),i=n.Bootstrap||[];return n.Bootstrap=[],await t.config.replace(n),{Peers:i.map(s=>new WH.Multiaddr(s))}}return Q(e)}var WH,XH=w(()=>{Ce();WH=A(yt(),1)});function ZH({repo:t}){async function e(r={}){return{Peers:(await t.config.get("Bootstrap",r)||[]).map(i=>new QH.Multiaddr(i))}}return Q(e)}var QH,JH=w(()=>{Ce();QH=A(yt(),1)});var uu,k5=w(()=>{uu=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}})});function t$({repo:t}){async function e(r={}){let n=await t.config.getAll(r);return n.Bootstrap=uu().Bootstrap,await t.config.replace(n),{Peers:uu().Bootstrap.map(i=>new e$.Multiaddr(i))}}return Q(e)}var e$,r$=w(()=>{k5();Ce();e$=A(yt(),1)});function n$({repo:t}){async function e(r,n={}){if(!O5(r))throw new Error(`${r} is not a valid Multiaddr`);let i=await t.config.getAll(n);return i.Bootstrap=(i.Bootstrap||[]).filter(s=>s.toString()!==r.toString()),await t.config.replace(i),{Peers:[r]}}return Q(e)}var i$=w(()=>{xA();Ce()});var PA,s$=w(()=>{GH();XH();JH();r$();i$();PA=class{constructor({repo:e}){this.add=$H({repo:e}),this.list=ZH({repo:e}),this.rm=n$({repo:e}),this.clear=YH({repo:e}),this.reset=t$({repo:e})}}});function o$({preload:t,repo:e}){async function r(n,i={}){return i.preload!==!1&&t(n),e.blocks.get(n,i)}return Q(r)}var a$=w(()=>{Ce()});function c$({codecs:t,hashers:e,repo:r,preload:n}){async function i(s,o={}){let a=o.pin?await r.gcLock.readLock():null;try{let c=o.version!=null?o.version:0,u=o.format||(c===0?"dag-pb":"raw"),f=await(await e.getHasher(o.mhtype||"sha2-256")).digest(s),h=await t.getCodec(u),d=L.create(c,h.code,f);return await r.blocks.put(d,s,{signal:o.signal}),o.preload!==!1&&n(d),o.pin===!0&&await r.pins.pinRecursively(d,{signal:o.signal}),d}finally{a&&a()}}return Q(i)}var u$=w(()=>{Se();Ce()});var uc=g((fgt,l$)=>{"use strict";var Dke=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};l$.exports=Dke});var Gt=g((hgt,CA)=>{"use strict";var E0=typeof Reflect=="object"?Reflect:null,f$=E0&&typeof E0.apply=="function"?E0.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},D5;E0&&typeof E0.ownKeys=="function"?D5=E0.ownKeys:Object.getOwnPropertySymbols?D5=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:D5=function(e){return Object.getOwnPropertyNames(e)};function Nke(t){console&&console.warn&&console.warn(t)}var d$=Number.isNaN||function(e){return e!==e};function _r(){_r.init.call(this)}CA.exports=_r;CA.exports.once=Uke;_r.EventEmitter=_r;_r.prototype._events=void 0;_r.prototype._eventsCount=0;_r.prototype._maxListeners=void 0;var h$=10;function N5(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(_r,"defaultMaxListeners",{enumerable:!0,get:function(){return h$},set:function(t){if(typeof t!="number"||t<0||d$(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");h$=t}});_r.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};_r.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||d$(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function p$(t){return t._maxListeners===void 0?_r.defaultMaxListeners:t._maxListeners}_r.prototype.getMaxListeners=function(){return p$(this)};_r.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")f$(c,this,r);else for(var u=c.length,l=b$(c,u),n=0;n<u;++n)f$(l[n],this,r);return!0};function y$(t,e,r,n){var i,s,o;if(N5(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=p$(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Nke(a)}return t}_r.prototype.addListener=function(e,r){return y$(this,e,r,!1)};_r.prototype.on=_r.prototype.addListener;_r.prototype.prependListener=function(e,r){return y$(this,e,r,!0)};function Bke(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g$(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Bke.bind(n);return i.listener=r,n.wrapFn=i,i}_r.prototype.once=function(e,r){return N5(r),this.on(e,g$(this,e,r)),this};_r.prototype.prependOnceListener=function(e,r){return N5(r),this.prependListener(e,g$(this,e,r)),this};_r.prototype.removeListener=function(e,r){var n,i,s,o,a;if(N5(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():Lke(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};_r.prototype.off=_r.prototype.removeListener;_r.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function m$(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Mke(i):b$(i,i.length)}_r.prototype.listeners=function(e){return m$(this,e,!0)};_r.prototype.rawListeners=function(e){return m$(this,e,!1)};_r.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):w$.call(t,e)};_r.prototype.listenerCount=w$;function w$(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}_r.prototype.eventNames=function(){return this._eventsCount>0?D5(this._events):[]};function b$(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Lke(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Mke(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Uke(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}_$(t,e,s,{once:!0}),e!=="error"&&qke(t,i,{once:!0})})}function qke(t,e,r){typeof t.on=="function"&&_$(t,"error",e,r)}function _$(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var L5=g((dgt,v$)=>{"use strict";var B5=uc(),Fke=Gt().EventEmitter;async function*Kke(t,e={}){let r=e.concurrency||1/0;r<1&&(r=1/0);let n=e.ordered==null?!1:e.ordered,i=new Fke,s=[],o=B5(),a=B5(),c=!1,u,l=!1;i.on("task-complete",()=>{a.resolve()}),Promise.resolve().then(async()=>{try{for await(let p of t){if(s.length===r&&(o=B5(),await o.promise),l)break;let y={done:!1};s.push(y),p().then(b=>{y.done=!0,y.ok=!0,y.value=b,i.emit("task-complete")},b=>{y.done=!0,y.err=b,i.emit("task-complete")})}c=!0,i.emit("task-complete")}catch(p){u=p,i.emit("task-complete")}});function f(){return Boolean(n?s[0]&&s[0].done:s.find(p=>p.done))}function*h(){for(;s.length&&s[0].done;){let p=s[0];if(s.shift(),p.ok)yield p.value;else throw l=!0,o.resolve(),p.err;o.resolve()}}function*d(){for(;f();)for(let p=0;p<s.length;p++)if(s[p].done){let y=s[p];if(s.splice(p,1),p--,y.ok)yield y.value;else throw l=!0,o.resolve(),y.err;o.resolve()}}for(;;){if(f()||(a=B5(),await a.promise),u)throw u;if(n?yield*h():yield*d(),c&&s.length===0)break}}v$.exports=Kke});function M5(t){return t instanceof Uint8Array?L.decode(t):L.parse(t.toString())}var OA=w(()=>{Se()});function T$({repo:t}){async function*e(r,n={}){Array.isArray(r)||(r=[r]);let i=await t.gcLock.writeLock();try{yield*(0,I$.pipe)(r,s=>(0,A$.default)(s,o=>async()=>{o=M5(o);let a={cid:o};try{if(!await t.blocks.has(o))throw(0,E$.default)(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await t.blocks.delete(o)}catch(c){n.force||(c.message=`cannot remove ${o}: ${c.message}`,a.error=c)}return a}),s=>(0,S$.default)(s,{concurrency:jke}),s=>(0,R$.default)(s,()=>!n.quiet))}finally{i()}}return Q(e)}var E$,S$,A$,R$,I$,jke,x$=w(()=>{E$=A(oe(),1),S$=A(L5(),1),A$=A(xi(),1),R$=A(fs(),1),I$=A(br(),1);OA();Ce();jke=8});function P$({repo:t,preload:e}){async function r(n,i={}){n=M5(n),i.preload!==!1&&e(n);let s=await t.blocks.get(n);return{cid:n,size:s.length}}return Q(r)}var C$=w(()=>{OA();Ce()});var kA,O$=w(()=>{a$();u$();x$();C$();kA=class{constructor({codecs:e,hashers:r,preload:n,repo:i}){this.get=o$({preload:n,repo:i}),this.put=c$({codecs:e,hashers:r,preload:n,repo:i}),this.rm=T$({repo:i}),this.stat=P$({preload:n,repo:i})}}});var S0=g((Tgt,k$)=>{"use strict";async function*Vke(t,e={}){let r=t.getReader();try{for(;;){let n=await r.read();if(n.done)return;yield n.value}}finally{e.preventCancel!==!0&&r.cancel(),r.releaseLock()}}k$.exports=Vke});var B$=g((xgt,N$)=>{"use strict";var D$=S0();function zke(t){return typeof t.stream=="function"?D$(t.stream()):D$(new Response(t).body)}N$.exports=zke});var A0=g((Pgt,L$)=>{"use strict";function Hke(t){let[e,r]=t[Symbol.asyncIterator]?[t[Symbol.asyncIterator](),Symbol.asyncIterator]:[t[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:i=>{n.push(i)},next:()=>n.length?{done:!1,value:n.shift()}:e.next(),[r](){return this}}}L$.exports=Hke});function mo(t){return ArrayBuffer.isView(t)||t instanceof ArrayBuffer}function lu(t){return t.constructor&&(t.constructor.name==="Blob"||t.constructor.name==="File")&&typeof t.stream=="function"}function _g(t){return typeof t=="object"&&(t.path||t.content)}var fu,vg=w(()=>{fu=t=>t&&typeof t.getReader=="function"});async function*U5(t){yield t}async function q5(t){if(mo(t))return U5(DA(t));if(typeof t=="string"||t instanceof String)return U5(DA(t.toString()));if(lu(t))return(0,q$.default)(t);if(fu(t)&&(t=(0,U$.default)(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let e=(0,F$.default)(t),{value:r,done:n}=await e.peek();if(n)return U5(new Uint8Array(0));if(e.push(r),Number.isInteger(r))return U5(Uint8Array.from(await(0,K$.default)(e)));if(mo(r)||typeof r=="string"||r instanceof String)return(0,j$.default)(e,DA)}throw(0,M$.default)(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT")}function DA(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new Uint8Array(t):Array.isArray(t)?Uint8Array.from(t):tt(t.toString())}var M$,U$,q$,F$,K$,j$,NA=w(()=>{M$=A(oe(),1);dt();U$=A(S0(),1),q$=A(B$(),1),F$=A(A0(),1),K$=A(yo(),1),j$=A(xi(),1);vg()});async function*H$(t,e){if(t==null)throw(0,K5.default)(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT");if(typeof t=="string"||t instanceof String){yield F5(t.toString(),e);return}if(mo(t)||lu(t)){yield F5(t,e);return}if(fu(t)&&(t=(0,V$.default)(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let r=(0,z$.default)(t),{value:n,done:i}=await r.peek();if(i){yield{content:[]};return}if(r.push(n),Number.isInteger(n)||mo(n)||typeof n=="string"||n instanceof String){yield F5(r,e);return}throw(0,K5.default)(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(_g(t)){yield F5(t,e);return}throw(0,K5.default)(new Error('Unexpected input: cannot convert "'+typeof t+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function F5(t,e){let{path:r,mode:n,mtime:i,content:s}=t,o={path:r||"",mode:Gc(n),mtime:Zu(i)};return s?o.content=await e(s):r||(o.content=await e(t)),o}var K5,V$,z$,$$=w(()=>{K5=A(oe(),1),V$=A(S0(),1),z$=A(A0(),1);vg();gn()});function j5(t){return H$(t,q5)}var BA=w(()=>{NA();$$()});function W$({addAll:t}){async function e(r,n={}){let i=await(0,G$.default)(t(j5(r),n));if(i==null)throw Error("Failed to add a file, if you see this please report a bug");return i}return e}var G$,Y$=w(()=>{G$=A(os(),1);BA()});var V5=g((jgt,X$)=>{"use strict";async function*$ke(t,e=1){let r=[];e<1&&(e=1);for await(let n of t)for(r.push(n);r.length>=e;)yield r.slice(0,e),r=r.slice(e);for(;r.length;)yield r.slice(0,e),r=r.slice(e)}X$.exports=$ke});var z5=g((Vgt,Q$)=>{"use strict";var Gke=V5();async function*Wke(t,e=1){for await(let r of Gke(t,e)){let n=r.map(i=>i().then(s=>({ok:!0,value:s}),s=>({ok:!1,err:s})));for(let i=0;i<n.length;i++){let s=await n[i];if(s.ok)yield s.value;else throw s.err}}}Q$.exports=Wke});var Z$=g((Eg,H5)=>{(function(t,e){"use strict";var r={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function n(d){if(!Array.isArray(d)&&!ArrayBuffer.isView(d))return!1;for(var p=0;p<d.length;p++)if(!Number.isInteger(d[p])||d[p]<0||d[p]>255)return!1;return!0}function i(d,p){return(d&65535)*p+(((d>>>16)*p&65535)<<16)}function s(d,p){return d<<p|d>>>32-p}function o(d){return d^=d>>>16,d=i(d,2246822507),d^=d>>>13,d=i(d,3266489909),d^=d>>>16,d}function a(d,p){d=[d[0]>>>16,d[0]&65535,d[1]>>>16,d[1]&65535],p=[p[0]>>>16,p[0]&65535,p[1]>>>16,p[1]&65535];var y=[0,0,0,0];return y[3]+=d[3]+p[3],y[2]+=y[3]>>>16,y[3]&=65535,y[2]+=d[2]+p[2],y[1]+=y[2]>>>16,y[2]&=65535,y[1]+=d[1]+p[1],y[0]+=y[1]>>>16,y[1]&=65535,y[0]+=d[0]+p[0],y[0]&=65535,[y[0]<<16|y[1],y[2]<<16|y[3]]}function c(d,p){d=[d[0]>>>16,d[0]&65535,d[1]>>>16,d[1]&65535],p=[p[0]>>>16,p[0]&65535,p[1]>>>16,p[1]&65535];var y=[0,0,0,0];return y[3]+=d[3]*p[3],y[2]+=y[3]>>>16,y[3]&=65535,y[2]+=d[2]*p[3],y[1]+=y[2]>>>16,y[2]&=65535,y[2]+=d[3]*p[2],y[1]+=y[2]>>>16,y[2]&=65535,y[1]+=d[1]*p[3],y[0]+=y[1]>>>16,y[1]&=65535,y[1]+=d[2]*p[2],y[0]+=y[1]>>>16,y[1]&=65535,y[1]+=d[3]*p[1],y[0]+=y[1]>>>16,y[1]&=65535,y[0]+=d[0]*p[3]+d[1]*p[2]+d[2]*p[1]+d[3]*p[0],y[0]&=65535,[y[0]<<16|y[1],y[2]<<16|y[3]]}function u(d,p){return p%=64,p===32?[d[1],d[0]]:p<32?[d[0]<<p|d[1]>>>32-p,d[1]<<p|d[0]>>>32-p]:(p-=32,[d[1]<<p|d[0]>>>32-p,d[0]<<p|d[1]>>>32-p])}function l(d,p){return p%=64,p===0?d:p<32?[d[0]<<p|d[1]>>>32-p,d[1]<<p]:[d[1]<<p-32,0]}function f(d,p){return[d[0]^p[0],d[1]^p[1]]}function h(d){return d=f(d,[0,d[0]>>>1]),d=c(d,[4283543511,3981806797]),d=f(d,[0,d[0]>>>1]),d=c(d,[3301882366,444984403]),d=f(d,[0,d[0]>>>1]),d}r.x86.hash32=function(d,p){if(r.inputValidation&&!n(d))return e;p=p||0;for(var y=d.length%4,b=d.length-y,m=p,_=0,R=3432918353,k=461845907,P=0;P<b;P=P+4)_=d[P]|d[P+1]<<8|d[P+2]<<16|d[P+3]<<24,_=i(_,R),_=s(_,15),_=i(_,k),m^=_,m=s(m,13),m=i(m,5)+3864292196;switch(_=0,y){case 3:_^=d[P+2]<<16;case 2:_^=d[P+1]<<8;case 1:_^=d[P],_=i(_,R),_=s(_,15),_=i(_,k),m^=_}return m^=d.length,m=o(m),m>>>0},r.x86.hash128=function(d,p){if(r.inputValidation&&!n(d))return e;p=p||0;for(var y=d.length%16,b=d.length-y,m=p,_=p,R=p,k=p,P=0,x=0,D=0,U=0,M=597399067,ae=2869860233,ne=951274213,de=2716044179,me=0;me<b;me=me+16)P=d[me]|d[me+1]<<8|d[me+2]<<16|d[me+3]<<24,x=d[me+4]|d[me+5]<<8|d[me+6]<<16|d[me+7]<<24,D=d[me+8]|d[me+9]<<8|d[me+10]<<16|d[me+11]<<24,U=d[me+12]|d[me+13]<<8|d[me+14]<<16|d[me+15]<<24,P=i(P,M),P=s(P,15),P=i(P,ae),m^=P,m=s(m,19),m+=_,m=i(m,5)+1444728091,x=i(x,ae),x=s(x,16),x=i(x,ne),_^=x,_=s(_,17),_+=R,_=i(_,5)+197830471,D=i(D,ne),D=s(D,17),D=i(D,de),R^=D,R=s(R,15),R+=k,R=i(R,5)+2530024501,U=i(U,de),U=s(U,18),U=i(U,M),k^=U,k=s(k,13),k+=m,k=i(k,5)+850148119;switch(P=0,x=0,D=0,U=0,y){case 15:U^=d[me+14]<<16;case 14:U^=d[me+13]<<8;case 13:U^=d[me+12],U=i(U,de),U=s(U,18),U=i(U,M),k^=U;case 12:D^=d[me+11]<<24;case 11:D^=d[me+10]<<16;case 10:D^=d[me+9]<<8;case 9:D^=d[me+8],D=i(D,ne),D=s(D,17),D=i(D,de),R^=D;case 8:x^=d[me+7]<<24;case 7:x^=d[me+6]<<16;case 6:x^=d[me+5]<<8;case 5:x^=d[me+4],x=i(x,ae),x=s(x,16),x=i(x,ne),_^=x;case 4:P^=d[me+3]<<24;case 3:P^=d[me+2]<<16;case 2:P^=d[me+1]<<8;case 1:P^=d[me],P=i(P,M),P=s(P,15),P=i(P,ae),m^=P}return m^=d.length,_^=d.length,R^=d.length,k^=d.length,m+=_,m+=R,m+=k,_+=m,R+=m,k+=m,m=o(m),_=o(_),R=o(R),k=o(k),m+=_,m+=R,m+=k,_+=m,R+=m,k+=m,("00000000"+(m>>>0).toString(16)).slice(-8)+("00000000"+(_>>>0).toString(16)).slice(-8)+("00000000"+(R>>>0).toString(16)).slice(-8)+("00000000"+(k>>>0).toString(16)).slice(-8)},r.x64.hash128=function(d,p){if(r.inputValidation&&!n(d))return e;p=p||0;for(var y=d.length%16,b=d.length-y,m=[0,p],_=[0,p],R=[0,0],k=[0,0],P=[2277735313,289559509],x=[1291169091,658871167],D=0;D<b;D=D+16)R=[d[D+4]|d[D+5]<<8|d[D+6]<<16|d[D+7]<<24,d[D]|d[D+1]<<8|d[D+2]<<16|d[D+3]<<24],k=[d[D+12]|d[D+13]<<8|d[D+14]<<16|d[D+15]<<24,d[D+8]|d[D+9]<<8|d[D+10]<<16|d[D+11]<<24],R=c(R,P),R=u(R,31),R=c(R,x),m=f(m,R),m=u(m,27),m=a(m,_),m=a(c(m,[0,5]),[0,1390208809]),k=c(k,x),k=u(k,33),k=c(k,P),_=f(_,k),_=u(_,31),_=a(_,m),_=a(c(_,[0,5]),[0,944331445]);switch(R=[0,0],k=[0,0],y){case 15:k=f(k,l([0,d[D+14]],48));case 14:k=f(k,l([0,d[D+13]],40));case 13:k=f(k,l([0,d[D+12]],32));case 12:k=f(k,l([0,d[D+11]],24));case 11:k=f(k,l([0,d[D+10]],16));case 10:k=f(k,l([0,d[D+9]],8));case 9:k=f(k,[0,d[D+8]]),k=c(k,x),k=u(k,33),k=c(k,P),_=f(_,k);case 8:R=f(R,l([0,d[D+7]],56));case 7:R=f(R,l([0,d[D+6]],48));case 6:R=f(R,l([0,d[D+5]],40));case 5:R=f(R,l([0,d[D+4]],32));case 4:R=f(R,l([0,d[D+3]],24));case 3:R=f(R,l([0,d[D+2]],16));case 2:R=f(R,l([0,d[D+1]],8));case 1:R=f(R,[0,d[D]]),R=c(R,P),R=u(R,31),R=c(R,x),m=f(m,R)}return m=f(m,[0,d.length]),_=f(_,[0,d.length]),m=a(m,_),_=a(_,m),m=h(m),_=h(_),m=a(m,_),_=a(_,m),("00000000"+(m[0]>>>0).toString(16)).slice(-8)+("00000000"+(m[1]>>>0).toString(16)).slice(-8)+("00000000"+(_[0]>>>0).toString(16)).slice(-8)+("00000000"+(_[1]>>>0).toString(16)).slice(-8)},typeof Eg<"u"?(typeof H5<"u"&&H5.exports&&(Eg=H5.exports=r),Eg.murmurHash3=r):typeof define=="function"&&define.amd?define([],function(){return r}):(r._murmurHash3=t.murmurHash3,r.noConflict=function(){return t.murmurHash3=r._murmurHash3,r._murmurHash3=e,r.noConflict=e,r},t.murmurHash3=r)})(Eg)});var eG=g((zgt,J$)=>{J$.exports=Z$()});function Yke(t){let e=new Array(4);for(let r=0;r<4;r++)e[r]=t&255,t=t>>8;return new Uint8Array(e)}var LA,Ggt,Rh,$5=w(()=>{j4();vp();LA=A(eG(),1);Ggt=_p({name:"murmur3-32",code:35,encode:t=>Yke(LA.default.x86.hash32(t))}),Rh=_p({name:"murmur3-128",code:34,encode:t=>up.fromHex(LA.default.x64.hash128(t))})});async function Xke(t){return(await Rh.encode(t)).slice(0,8).reverse()}var Qke,tG,rG=w(()=>{Fn();Tn();$5();Qke={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:jr,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:17437180132763652,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:Xke,hamtHashCode:34,hamtBucketBits:8},tG=(t={})=>Bt.bind({ignoreUndefined:!0})(Qke,t)});var Zke,la,R0=w(()=>{Se();xt();Tn();Zke=async(t,e,r)=>{r.codec||(r.codec=Kt),r.hasher||(r.hasher=jr),r.cidVersion===void 0&&(r.cidVersion=1),r.codec===Kt&&r.hasher!==jr&&(r.cidVersion=1);let n=await r.hasher.digest(t),i=L.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await e.put(i,t,{signal:r.signal}),i},la=Zke});var Jke,nG,iG=w(()=>{gn();R0();xt();Jke=async(t,e,r)=>{let n=new mt({type:"directory",mtime:t.mtime,mode:t.mode}),i=lt(Zn({Data:n.marshal()})),s=await la(i,e,r),o=t.path;return{cid:s,path:o,unixfs:n,size:i.length}},nG=Jke});async function eDe(t,e){return e(await(0,sG.default)(t))}var sG,oG,aG=w(()=>{sG=A(yo(),1);oG=eDe});function tDe(t,e,r){return uG(t,e,r)}async function uG(t,e,r){let n=[];for await(let i of(0,cG.default)(t,r.maxChildrenPerNode))n.push(await e(i));return n.length>1?uG(n,e,r):n[0]}var cG,lG,fG=w(()=>{cG=A(V5(),1);lG=tDe});async function rDe(t,e,r){let n=new pG(r.layerRepeat),i=0,s=1,o=n;for await(let a of(0,hG.default)(t,r.maxChildrenPerNode))o.isFull()&&(o!==n&&n.addChild(await o.reduce(e)),i&&i%r.layerRepeat===0&&s++,o=new MA(s,r.layerRepeat,i),i++),o.append(a);return o&&o!==n&&n.addChild(await o.reduce(e)),n.reduce(e)}var hG,dG,MA,pG,yG=w(()=>{hG=A(V5(),1);dG=rDe,MA=class{constructor(e,r,n=0){this.maxDepth=e,this.layerRepeat=r,this.currentDepth=1,this.iteration=n,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let r={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(r),this.currentDepth=r.depth,this.node=r}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,r){let n=[];return e.children.length&&(n=await Promise.all(e.children.filter(i=>i.data).map(i=>this._reduce(i,r)))),r((e.data||[]).concat(n))}_findParent(e,r){let n=e.parent;if(!(!n||n.depth===0))return n.children.length===n.maxChildren||!n.maxChildren?this._findParent(n,r):n}},pG=class extends MA{constructor(e){super(0,e);this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}});async function*nDe(t,e,r){for await(let n of t.content)yield async()=>{r.progress(n.length,t.path);let i,s={codec:Kt,cidVersion:r.cidVersion,hasher:r.hasher,onlyHash:r.onlyHash};return r.rawLeaves?(s.codec=ts,s.cidVersion=1):(i=new mt({type:r.leafType,data:n}),n=lt({Data:i.marshal(),Links:[]})),{cid:await la(n,e,s),unixfs:i,size:n.length}}}var gG,mG=w(()=>{gn();R0();xt();eo();gG=nDe});async function*sDe(t,e,r){let n=-1,i,s;typeof r.bufferImporter=="function"?s=r.bufferImporter:s=gG;for await(let o of(0,bG.default)(s(t,e,r),r.blockWriteConcurrency)){if(n++,n===0){i=o;continue}else n===1&&i&&(yield i,i=null);yield o}i&&(i.single=!0,yield i)}function aDe(t,e,r){let n=iDe[r.strategy];if(!n)throw(0,wG.default)(new Error(`Unknown importer build strategy name: ${r.strategy}`),"ERR_BAD_STRATEGY");return n(sDe(t,e,r),oDe(t,e,r),r)}var wG,bG,iDe,oDe,_G,vG=w(()=>{wG=A(oe(),1);gn();R0();xt();bG=A(z5(),1);eo();xt();aG();fG();yG();mG();iDe={flat:oG,balanced:lG,trickle:dG};oDe=(t,e,r)=>{async function n(i){if(i.length===1&&i[0].single&&r.reduceSingleLeafToSelf){let l=i[0];if(t.mtime!==void 0||t.mode!==void 0){let f=await e.get(l.cid);l.unixfs=new mt({type:"file",mtime:t.mtime,mode:t.mode,data:f}),f=lt(Zn({Data:l.unixfs.marshal()})),l.cid=await la(f,e,{...r,codec:Kt,hasher:r.hasher,cidVersion:r.cidVersion}),l.size=f.length}return{cid:l.cid,path:t.path,unixfs:l.unixfs,size:l.size}}let s=new mt({type:"file",mtime:t.mtime,mode:t.mode}),o=i.filter(l=>l.cid.code===ei&&l.size||l.unixfs&&!l.unixfs.data&&l.unixfs.fileSize()?!0:Boolean(l.unixfs&&l.unixfs.data&&l.unixfs.data.length)).map(l=>l.cid.code===ei?(s.addBlockSize(l.size),{Name:"",Tsize:l.size,Hash:l.cid}):(!l.unixfs||!l.unixfs.data?s.addBlockSize(l.unixfs&&l.unixfs.fileSize()||0):s.addBlockSize(l.unixfs.data.length),{Name:"",Tsize:l.size,Hash:l.cid})),a={Data:s.marshal(),Links:o},c=lt(Zn(a));return{cid:await la(c,e,r),path:t.path,unixfs:s,size:c.length+a.Links.reduce((l,f)=>l+f.Tsize,0)}}return n};_G=aDe});var AG=g(G5=>{"use strict";G5.byteLength=uDe;G5.toByteArray=fDe;G5.fromByteArray=pDe;var lc=[],wo=[],cDe=typeof Uint8Array<"u"?Uint8Array:Array,UA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Ih=0,EG=UA.length;Ih<EG;++Ih)lc[Ih]=UA[Ih],wo[UA.charCodeAt(Ih)]=Ih;var Ih,EG;wo["-".charCodeAt(0)]=62;wo["_".charCodeAt(0)]=63;function SG(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function uDe(t){var e=SG(t),r=e[0],n=e[1];return(r+n)*3/4-n}function lDe(t,e,r){return(e+r)*3/4-r}function fDe(t){var e,r=SG(t),n=r[0],i=r[1],s=new cDe(lDe(t,n,i)),o=0,a=i>0?n-4:n,c;for(c=0;c<a;c+=4)e=wo[t.charCodeAt(c)]<<18|wo[t.charCodeAt(c+1)]<<12|wo[t.charCodeAt(c+2)]<<6|wo[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=wo[t.charCodeAt(c)]<<2|wo[t.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=wo[t.charCodeAt(c)]<<10|wo[t.charCodeAt(c+1)]<<4|wo[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function hDe(t){return lc[t>>18&63]+lc[t>>12&63]+lc[t>>6&63]+lc[t&63]}function dDe(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(hDe(n));return i.join("")}function pDe(t){for(var e,r=t.length,n=r%3,i=[],s=16383,o=0,a=r-n;o<a;o+=s)i.push(dDe(t,o,o+s>a?a:o+s));return n===1?(e=t[r-1],i.push(lc[e>>2]+lc[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(lc[e>>10]+lc[e>>4&63]+lc[e<<2&63]+"=")),i.join("")}});var RG=g(qA=>{qA.read=function(t,e,r,n,i){var s,o,a=i*8-n-1,c=(1<<a)-1,u=c>>1,l=-7,f=r?i-1:0,h=r?-1:1,d=t[e+f];for(f+=h,s=d&(1<<-l)-1,d>>=-l,l+=a;l>0;s=s*256+t[e+f],f+=h,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=n;l>0;o=o*256+t[e+f],f+=h,l-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(d?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-u}return(d?-1:1)*o*Math.pow(2,s-n)};qA.write=function(t,e,r,n,i,s){var o,a,c,u=s*8-i-1,l=(1<<u)-1,f=l>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+f>=1?e+=h/c:e+=h*Math.pow(2,1-f),e*c>=2&&(o++,c/=2),o+f>=l?(a=0,o=l):o+f>=1?(a=(e*c-1)*Math.pow(2,i),o=o+f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[r+d]=a&255,d+=p,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[r+d]=o&255,d+=p,o/=256,u-=8);t[r+d-p]|=y*128}});var On=g(P0=>{"use strict";var FA=AG(),T0=RG(),IG=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;P0.Buffer=ue;P0.SlowBuffer=_De;P0.INSPECT_MAX_BYTES=50;var W5=2147483647;P0.kMaxLength=W5;ue.TYPED_ARRAY_SUPPORT=yDe();!ue.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function yDe(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch{return!1}}Object.defineProperty(ue.prototype,"parent",{enumerable:!0,get:function(){if(!!ue.isBuffer(this))return this.buffer}});Object.defineProperty(ue.prototype,"offset",{enumerable:!0,get:function(){if(!!ue.isBuffer(this))return this.byteOffset}});function hu(t){if(t>W5)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,ue.prototype),e}function ue(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return zA(t)}return CG(t,e,r)}ue.poolSize=8192;function CG(t,e,r){if(typeof t=="string")return mDe(t,e);if(ArrayBuffer.isView(t))return wDe(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(fc(t,ArrayBuffer)||t&&fc(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(fc(t,SharedArrayBuffer)||t&&fc(t.buffer,SharedArrayBuffer)))return jA(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return ue.from(n,e,r);let i=bDe(t);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return ue.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}ue.from=function(t,e,r){return CG(t,e,r)};Object.setPrototypeOf(ue.prototype,Uint8Array.prototype);Object.setPrototypeOf(ue,Uint8Array);function OG(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function gDe(t,e,r){return OG(t),t<=0?hu(t):e!==void 0?typeof r=="string"?hu(t).fill(e,r):hu(t).fill(e):hu(t)}ue.alloc=function(t,e,r){return gDe(t,e,r)};function zA(t){return OG(t),hu(t<0?0:HA(t)|0)}ue.allocUnsafe=function(t){return zA(t)};ue.allocUnsafeSlow=function(t){return zA(t)};function mDe(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!ue.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=kG(t,e)|0,n=hu(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function KA(t){let e=t.length<0?0:HA(t.length)|0,r=hu(e);for(let n=0;n<e;n+=1)r[n]=t[n]&255;return r}function wDe(t){if(fc(t,Uint8Array)){let e=new Uint8Array(t);return jA(e.buffer,e.byteOffset,e.byteLength)}return KA(t)}function jA(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,ue.prototype),n}function bDe(t){if(ue.isBuffer(t)){let e=HA(t.length)|0,r=hu(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||GA(t.length)?hu(0):KA(t);if(t.type==="Buffer"&&Array.isArray(t.data))return KA(t.data)}function HA(t){if(t>=W5)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+W5.toString(16)+" bytes");return t|0}function _De(t){return+t!=t&&(t=0),ue.alloc(+t)}ue.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==ue.prototype};ue.compare=function(e,r){if(fc(e,Uint8Array)&&(e=ue.from(e,e.offset,e.byteLength)),fc(r,Uint8Array)&&(r=ue.from(r,r.offset,r.byteLength)),!ue.isBuffer(e)||!ue.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let n=e.length,i=r.length;for(let s=0,o=Math.min(n,i);s<o;++s)if(e[s]!==r[s]){n=e[s],i=r[s];break}return n<i?-1:i<n?1:0};ue.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};ue.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return ue.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;let i=ue.allocUnsafe(r),s=0;for(n=0;n<e.length;++n){let o=e[n];if(fc(o,Uint8Array))s+o.length>i.length?(ue.isBuffer(o)||(o=ue.from(o)),o.copy(i,s)):Uint8Array.prototype.set.call(i,o,s);else if(ue.isBuffer(o))o.copy(i,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return i};function kG(t,e){if(ue.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||fc(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return VA(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return KG(t).length;default:if(i)return n?-1:VA(t).length;e=(""+e).toLowerCase(),i=!0}}ue.byteLength=kG;function vDe(t,e,r){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return ODe(this,e,r);case"utf8":case"utf-8":return NG(this,e,r);case"ascii":return PDe(this,e,r);case"latin1":case"binary":return CDe(this,e,r);case"base64":return TDe(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return kDe(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}ue.prototype._isBuffer=!0;function Th(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}ue.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)Th(this,r,r+1);return this};ue.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)Th(this,r,r+3),Th(this,r+1,r+2);return this};ue.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)Th(this,r,r+7),Th(this,r+1,r+6),Th(this,r+2,r+5),Th(this,r+3,r+4);return this};ue.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?NG(this,0,e):vDe.apply(this,arguments)};ue.prototype.toLocaleString=ue.prototype.toString;ue.prototype.equals=function(e){if(!ue.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:ue.compare(this,e)===0};ue.prototype.inspect=function(){let e="",r=P0.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};IG&&(ue.prototype[IG]=ue.prototype.inspect);ue.prototype.compare=function(e,r,n,i,s){if(fc(e,Uint8Array)&&(e=ue.from(e,e.offset,e.byteLength)),!ue.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),s===void 0&&(s=this.length),r<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&r>=n)return 0;if(i>=s)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;let o=s-i,a=n-r,c=Math.min(o,a),u=this.slice(i,s),l=e.slice(r,n);for(let f=0;f<c;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0};function DG(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,GA(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=ue.from(e,n)),ue.isBuffer(e))return e.length===0?-1:TG(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):TG(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function TG(t,e,r,n,i){let s=1,o=t.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,a/=2,r/=2}function c(l,f){return s===1?l[f]:l.readUInt16BE(f*s)}let u;if(i){let l=-1;for(u=r;u<o;u++)if(c(t,u)===c(e,l===-1?0:u-l)){if(l===-1&&(l=u),u-l+1===a)return l*s}else l!==-1&&(u-=u-l),l=-1}else for(r+a>o&&(r=o-a),u=r;u>=0;u--){let l=!0;for(let f=0;f<a;f++)if(c(t,u+f)!==c(e,f)){l=!1;break}if(l)return u}return-1}ue.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};ue.prototype.indexOf=function(e,r,n){return DG(this,e,r,n,!0)};ue.prototype.lastIndexOf=function(e,r,n){return DG(this,e,r,n,!1)};function EDe(t,e,r,n){r=Number(r)||0;let i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;let s=e.length;n>s/2&&(n=s/2);let o;for(o=0;o<n;++o){let a=parseInt(e.substr(o*2,2),16);if(GA(a))return o;t[r+o]=a}return o}function SDe(t,e,r,n){return Y5(VA(e,t.length-r),t,r,n)}function ADe(t,e,r,n){return Y5(LDe(e),t,r,n)}function RDe(t,e,r,n){return Y5(KG(e),t,r,n)}function IDe(t,e,r,n){return Y5(MDe(e,t.length-r),t,r,n)}ue.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((n===void 0||n>s)&&(n=s),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let o=!1;for(;;)switch(i){case"hex":return EDe(this,e,r,n);case"utf8":case"utf-8":return SDe(this,e,r,n);case"ascii":case"latin1":case"binary":return ADe(this,e,r,n);case"base64":return RDe(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return IDe(this,e,r,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}};ue.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function TDe(t,e,r){return e===0&&r===t.length?FA.fromByteArray(t):FA.fromByteArray(t.slice(e,r))}function NG(t,e,r){r=Math.min(t.length,r);let n=[],i=e;for(;i<r;){let s=t[i],o=null,a=s>239?4:s>223?3:s>191?2:1;if(i+a<=r){let c,u,l,f;switch(a){case 1:s<128&&(o=s);break;case 2:c=t[i+1],(c&192)===128&&(f=(s&31)<<6|c&63,f>127&&(o=f));break;case 3:c=t[i+1],u=t[i+2],(c&192)===128&&(u&192)===128&&(f=(s&15)<<12|(c&63)<<6|u&63,f>2047&&(f<55296||f>57343)&&(o=f));break;case 4:c=t[i+1],u=t[i+2],l=t[i+3],(c&192)===128&&(u&192)===128&&(l&192)===128&&(f=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,f>65535&&f<1114112&&(o=f))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),i+=a}return xDe(n)}var xG=4096;function xDe(t){let e=t.length;if(e<=xG)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=xG));return r}function PDe(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function CDe(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function ODe(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let s=e;s<r;++s)i+=UDe[t[s]];return i}function kDe(t,e,r){let n=t.slice(e,r),i="";for(let s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+n[s+1]*256);return i}ue.prototype.slice=function(e,r){let n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);let i=this.subarray(e,r);return Object.setPrototypeOf(i,ue.prototype),i};function si(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}ue.prototype.readUintLE=ue.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||si(e,r,this.length);let i=this[e],s=1,o=0;for(;++o<r&&(s*=256);)i+=this[e+o]*s;return i};ue.prototype.readUintBE=ue.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||si(e,r,this.length);let i=this[e+--r],s=1;for(;r>0&&(s*=256);)i+=this[e+--r]*s;return i};ue.prototype.readUint8=ue.prototype.readUInt8=function(e,r){return e=e>>>0,r||si(e,1,this.length),this[e]};ue.prototype.readUint16LE=ue.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||si(e,2,this.length),this[e]|this[e+1]<<8};ue.prototype.readUint16BE=ue.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||si(e,2,this.length),this[e]<<8|this[e+1]};ue.prototype.readUint32LE=ue.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||si(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};ue.prototype.readUint32BE=ue.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||si(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};ue.prototype.readBigUInt64LE=Nl(function(e){e=e>>>0,x0(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Sg(e,this.length-8);let i=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(s)<<BigInt(32))});ue.prototype.readBigUInt64BE=Nl(function(e){e=e>>>0,x0(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Sg(e,this.length-8);let i=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(s)});ue.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||si(e,r,this.length);let i=this[e],s=1,o=0;for(;++o<r&&(s*=256);)i+=this[e+o]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*r)),i};ue.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||si(e,r,this.length);let i=r,s=1,o=this[e+--i];for(;i>0&&(s*=256);)o+=this[e+--i]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};ue.prototype.readInt8=function(e,r){return e=e>>>0,r||si(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};ue.prototype.readInt16LE=function(e,r){e=e>>>0,r||si(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};ue.prototype.readInt16BE=function(e,r){e=e>>>0,r||si(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};ue.prototype.readInt32LE=function(e,r){return e=e>>>0,r||si(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};ue.prototype.readInt32BE=function(e,r){return e=e>>>0,r||si(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};ue.prototype.readBigInt64LE=Nl(function(e){e=e>>>0,x0(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Sg(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});ue.prototype.readBigInt64BE=Nl(function(e){e=e>>>0,x0(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Sg(e,this.length-8);let i=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});ue.prototype.readFloatLE=function(e,r){return e=e>>>0,r||si(e,4,this.length),T0.read(this,e,!0,23,4)};ue.prototype.readFloatBE=function(e,r){return e=e>>>0,r||si(e,4,this.length),T0.read(this,e,!1,23,4)};ue.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||si(e,8,this.length),T0.read(this,e,!0,52,8)};ue.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||si(e,8,this.length),T0.read(this,e,!1,52,8)};function hs(t,e,r,n,i,s){if(!ue.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}ue.prototype.writeUintLE=ue.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;hs(this,e,r,n,a,0)}let s=1,o=0;for(this[r]=e&255;++o<n&&(s*=256);)this[r+o]=e/s&255;return r+n};ue.prototype.writeUintBE=ue.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;hs(this,e,r,n,a,0)}let s=n-1,o=1;for(this[r+s]=e&255;--s>=0&&(o*=256);)this[r+s]=e/o&255;return r+n};ue.prototype.writeUint8=ue.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||hs(this,e,r,1,255,0),this[r]=e&255,r+1};ue.prototype.writeUint16LE=ue.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||hs(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};ue.prototype.writeUint16BE=ue.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||hs(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};ue.prototype.writeUint32LE=ue.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||hs(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};ue.prototype.writeUint32BE=ue.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||hs(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function BG(t,e,r,n,i){FG(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,r}function LG(t,e,r,n,i){FG(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o=o>>8,t[r+2]=o,o=o>>8,t[r+1]=o,o=o>>8,t[r]=o,r+8}ue.prototype.writeBigUInt64LE=Nl(function(e,r=0){return BG(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});ue.prototype.writeBigUInt64BE=Nl(function(e,r=0){return LG(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});ue.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let c=Math.pow(2,8*n-1);hs(this,e,r,n,c-1,-c)}let s=0,o=1,a=0;for(this[r]=e&255;++s<n&&(o*=256);)e<0&&a===0&&this[r+s-1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+n};ue.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let c=Math.pow(2,8*n-1);hs(this,e,r,n,c-1,-c)}let s=n-1,o=1,a=0;for(this[r+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[r+s+1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+n};ue.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||hs(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};ue.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||hs(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};ue.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||hs(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};ue.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||hs(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};ue.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||hs(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};ue.prototype.writeBigInt64LE=Nl(function(e,r=0){return BG(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});ue.prototype.writeBigInt64BE=Nl(function(e,r=0){return LG(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function MG(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function UG(t,e,r,n,i){return e=+e,r=r>>>0,i||MG(t,e,r,4,34028234663852886e22,-34028234663852886e22),T0.write(t,e,r,n,23,4),r+4}ue.prototype.writeFloatLE=function(e,r,n){return UG(this,e,r,!0,n)};ue.prototype.writeFloatBE=function(e,r,n){return UG(this,e,r,!1,n)};function qG(t,e,r,n,i){return e=+e,r=r>>>0,i||MG(t,e,r,8,17976931348623157e292,-17976931348623157e292),T0.write(t,e,r,n,52,8),r+8}ue.prototype.writeDoubleLE=function(e,r,n){return qG(this,e,r,!0,n)};ue.prototype.writeDoubleBE=function(e,r,n){return qG(this,e,r,!1,n)};ue.prototype.copy=function(e,r,n,i){if(!ue.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);let s=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),s};ue.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!ue.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let o=e.charCodeAt(0);(i==="utf8"&&o<128||i==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<n;++s)this[s]=e;else{let o=ue.isBuffer(e)?e:ue.from(e,i),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-r;++s)this[s+r]=o[s%a]}return this};var I0={};function $A(t,e,r){I0[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}$A("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);$A("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);$A("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=PG(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=PG(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function PG(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function DDe(t,e,r){x0(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&Sg(e,t.length-(r+1))}function FG(t,e,r,n,i,s){if(t>r||t<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${r}${o}`,new I0.ERR_OUT_OF_RANGE("value",a,t)}DDe(n,i,s)}function x0(t,e){if(typeof t!="number")throw new I0.ERR_INVALID_ARG_TYPE(e,"number",t)}function Sg(t,e,r){throw Math.floor(t)!==t?(x0(t,r),new I0.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new I0.ERR_BUFFER_OUT_OF_BOUNDS:new I0.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var NDe=/[^+/0-9A-Za-z-_]/g;function BDe(t){if(t=t.split("=")[0],t=t.trim().replace(NDe,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function VA(t,e){e=e||1/0;let r,n=t.length,i=null,s=[];for(let o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function LDe(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function MDe(t,e){let r,n,i,s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}function KG(t){return FA.toByteArray(BDe(t))}function Y5(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function fc(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function GA(t){return t!==t}var UDe=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let n=r*16;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function Nl(t){return typeof BigInt>"u"?qDe:t}function qDe(){throw new Error("BigInt not supported")}});var yi=g((Amt,VG)=>{"use strict";var{Buffer:fa}=On(),jG=Symbol.for("BufferList");function Or(t){if(!(this instanceof Or))return new Or(t);Or._init.call(this,t)}Or._init=function(e){Object.defineProperty(this,jG,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Or.prototype._new=function(e){return new Or(e)};Or.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let n=0;n<this._bufs.length;n++){let i=r+this._bufs[n].length;if(e<i||n===this._bufs.length-1)return[n,e-r];r=i}};Or.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let n=0;n<e;n++)r+=this._bufs[n].length;return r};Or.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};Or.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};Or.prototype.copy=function(e,r,n,i){if((typeof n!="number"||n<0)&&(n=0),(typeof i!="number"||i>this.length)&&(i=this.length),n>=this.length||i<=0)return e||fa.alloc(0);let s=!!e,o=this._offset(n),a=i-n,c=a,u=s&&r||0,l=o[1];if(n===0&&i===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:fa.concat(this._bufs,this.length);for(let f=0;f<this._bufs.length;f++)this._bufs[f].copy(e,u),u+=this._bufs[f].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,r,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=fa.allocUnsafe(a));for(let f=o[0];f<this._bufs.length;f++){let h=this._bufs[f].length-l;if(c>h)this._bufs[f].copy(e,u,l),u+=h;else{this._bufs[f].copy(e,u,l,l+c),u+=h;break}c-=h,l&&(l=0)}return e.length>u?e.slice(0,u):e};Or.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let n=this._offset(e),i=this._offset(r),s=this._bufs.slice(n[0],i[0]+1);return i[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,i[1]),n[1]!==0&&(s[0]=s[0].slice(n[1])),this._new(s)};Or.prototype.toString=function(e,r,n){return this.slice(r,n).toString(e)};Or.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Or.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};Or.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(fa.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(fa.from(e));return this};Or.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Or.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=fa.from([t]):typeof t=="string"?t=fa.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=fa.from(t.buffer,t.byteOffset,t.byteLength):fa.isBuffer(t)||(t=fa.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let n=this._offset(e),i=n[0],s=n[1];for(;i<this._bufs.length;i++){let o=this._bufs[i];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([i,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([i,s]);if(this._match(c,t))return c;s++}s=0}return-1};Or.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?Or.prototype[r]=function(n,i){return this.slice(n,n+i)[r](0,i)}:Or.prototype[r]=function(n=0){return this.slice(n,n+t[r])[r](0)}})(e)})();Or.prototype._isBufferList=function(e){return e instanceof Or||Or.isBufferList(e)};Or.isBufferList=function(e){return e!=null&&e[jG]};VG.exports=Or});var $G=g((Rmt,HG)=>{var zG=class{constructor(e,r=12,n=8*1024,i=32*1024,s=64,o){this.bits=r,this.min=n,this.max=i,this.asModule=e,this.rabin=new e.Rabin(r,n,i,s,o),this.polynomial=o}fingerprint(e){let{__retain:r,__release:n,__allocArray:i,__getInt32Array:s,Int32Array_ID:o,Uint8Array_ID:a}=this.asModule,c=new Int32Array(Math.ceil(e.length/this.min)),u=r(i(o,c)),l=r(i(a,e)),f=this.rabin.fingerprint(l,u),h=s(f);n(l),n(u);let d=h.indexOf(0);return d>=0?h.subarray(0,d):h}};HG.exports=zG});var ZG=g(Ig=>{"use strict";var FDe=typeof BigUint64Array<"u",Ag=Symbol(),Rg=1024;function GG(t,e){let r=new Uint32Array(t),n=new Uint16Array(t);var i=r[e+-4>>>2]>>>1,s=e>>>1;if(i<=Rg)return String.fromCharCode.apply(String,n.subarray(s,s+i));let o=[];do{let a=n[s+Rg-1],c=a>=55296&&a<56320?Rg-1:Rg;o.push(String.fromCharCode.apply(String,n.subarray(s,s+=c))),i-=c}while(i>Rg);return o.join("")+String.fromCharCode.apply(String,n.subarray(s,s+i))}function WA(t){let e={};function r(i,s){return i?GG(i.buffer,s):"<yet unknown>"}let n=t.env=t.env||{};return n.abort=n.abort||function(s,o,a,c){let u=e.memory||n.memory;throw Error("abort: "+r(u,s)+" at "+r(u,o)+":"+a+":"+c)},n.trace=n.trace||function(s,o){let a=e.memory||n.memory;console.log("trace: "+r(a,s)+(o?" ":"")+Array.prototype.slice.call(arguments,2,2+o).join(", "))},t.Math=t.Math||Math,t.Date=t.Date||Date,e}function YA(t,e){let r=e.exports,n=r.memory,i=r.table,s=r.__alloc,o=r.__retain,a=r.__rtti_base||-1;function c(x){let D=new Uint32Array(n.buffer),U=D[a>>>2];if((x>>>=0)>=U)throw Error("invalid id: "+x);return D[(a+4>>>2)+x*2]}function u(x){let D=new Uint32Array(n.buffer),U=D[a>>>2];if((x>>>=0)>=U)throw Error("invalid id: "+x);return D[(a+4>>>2)+x*2+1]}function l(x){return 31-Math.clz32(x>>>5&31)}function f(x){return 31-Math.clz32(x>>>14&31)}function h(x){let D=x.length,U=s(D<<1,1),M=new Uint16Array(n.buffer);for(var ae=0,ne=U>>>1;ae<D;++ae)M[ne+ae]=x.charCodeAt(ae);return U}t.__allocString=h;function d(x){let D=n.buffer;if(new Uint32Array(D)[x+-8>>>2]!==1)throw Error("not a string: "+x);return GG(D,x)}t.__getString=d;function p(x,D,U){let M=n.buffer;if(U)switch(x){case 2:return new Float32Array(M);case 3:return new Float64Array(M)}else switch(x){case 0:return new(D?Int8Array:Uint8Array)(M);case 1:return new(D?Int16Array:Uint16Array)(M);case 2:return new(D?Int32Array:Uint32Array)(M);case 3:return new(D?BigInt64Array:BigUint64Array)(M)}throw Error("unsupported align: "+x)}function y(x,D){let U=c(x);if(!(U&3))throw Error("not an array: "+x+" @ "+U);let M=l(U),ae=D.length,ne=s(ae<<M,0),de=s(U&2?16:12,x),me=new Uint32Array(n.buffer);me[de+0>>>2]=o(ne),me[de+4>>>2]=ne,me[de+8>>>2]=ae<<M,U&2&&(me[de+12>>>2]=ae);let Ke=p(M,U&1024,U&2048);if(U&8192)for(let xe=0;xe<ae;++xe)Ke[(ne>>>M)+xe]=o(D[xe]);else Ke.set(D,ne>>>M);return de}t.__allocArray=y;function b(x){let D=new Uint32Array(n.buffer),U=D[x+-8>>>2],M=c(U);if(!(M&1))throw Error("not an array: "+U);let ae=l(M);var ne=D[x+4>>>2];let de=M&2?D[x+12>>>2]:D[ne+-4>>>2]>>>ae;return p(ae,M&1024,M&2048).subarray(ne>>>=ae,ne+de)}t.__getArrayView=b;function m(x){let D=b(x),U=D.length,M=new Array(U);for(let ae=0;ae<U;ae++)M[ae]=D[ae];return M}t.__getArray=m;function _(x){let D=n.buffer,U=new Uint32Array(D)[x+-4>>>2];return D.slice(x,x+U)}t.__getArrayBuffer=_;function R(x,D,U){return new x(k(x,D,U))}function k(x,D,U){let M=n.buffer,ae=new Uint32Array(M),ne=ae[U+4>>>2];return new x(M,ne,ae[ne+-4>>>2]>>>D)}t.__getInt8Array=R.bind(null,Int8Array,0),t.__getInt8ArrayView=k.bind(null,Int8Array,0),t.__getUint8Array=R.bind(null,Uint8Array,0),t.__getUint8ArrayView=k.bind(null,Uint8Array,0),t.__getUint8ClampedArray=R.bind(null,Uint8ClampedArray,0),t.__getUint8ClampedArrayView=k.bind(null,Uint8ClampedArray,0),t.__getInt16Array=R.bind(null,Int16Array,1),t.__getInt16ArrayView=k.bind(null,Int16Array,1),t.__getUint16Array=R.bind(null,Uint16Array,1),t.__getUint16ArrayView=k.bind(null,Uint16Array,1),t.__getInt32Array=R.bind(null,Int32Array,2),t.__getInt32ArrayView=k.bind(null,Int32Array,2),t.__getUint32Array=R.bind(null,Uint32Array,2),t.__getUint32ArrayView=k.bind(null,Uint32Array,2),FDe&&(t.__getInt64Array=R.bind(null,BigInt64Array,3),t.__getInt64ArrayView=k.bind(null,BigInt64Array,3),t.__getUint64Array=R.bind(null,BigUint64Array,3),t.__getUint64ArrayView=k.bind(null,BigUint64Array,3)),t.__getFloat32Array=R.bind(null,Float32Array,2),t.__getFloat32ArrayView=k.bind(null,Float32Array,2),t.__getFloat64Array=R.bind(null,Float64Array,3),t.__getFloat64ArrayView=k.bind(null,Float64Array,3);function P(x,D){let U=new Uint32Array(n.buffer);var M=U[x+-8>>>2];if(M<=U[a>>>2])do if(M==D)return!0;while(M=u(M));return!1}return t.__instanceof=P,t.memory=t.memory||n,t.table=t.table||i,QG(r,t)}function WG(t){return typeof Response<"u"&&t instanceof Response}async function YG(t,e){return WG(t=await t)?XG(t,e):YA(WA(e||(e={})),await WebAssembly.instantiate(t instanceof WebAssembly.Module?t:await WebAssembly.compile(t),e))}Ig.instantiate=YG;function KDe(t,e){return YA(WA(e||(e={})),new WebAssembly.Instance(t instanceof WebAssembly.Module?t:new WebAssembly.Module(t),e))}Ig.instantiateSync=KDe;async function XG(t,e){return WebAssembly.instantiateStreaming?YA(WA(e||(e={})),(await WebAssembly.instantiateStreaming(t,e)).instance):YG(WG(t=await t)?t.arrayBuffer():t,e)}Ig.instantiateStreaming=XG;function QG(t,e){var r=e?Object.create(e):{},n=t.__argumentsLength?function(i){t.__argumentsLength.value=i}:t.__setArgumentsLength||t.__setargc||function(){};for(let i in t){if(!Object.prototype.hasOwnProperty.call(t,i))continue;let s=t[i],o=i.split("."),a=r;for(;o.length>1;){let l=o.shift();Object.prototype.hasOwnProperty.call(a,l)||(a[l]={}),a=a[l]}let c=o[0],u=c.indexOf("#");if(u>=0){let l=c.substring(0,u),f=a[l];if(typeof f>"u"||!f.prototype){let h=function(...d){return h.wrap(h.prototype.constructor(0,...d))};h.prototype={valueOf:function(){return this[Ag]}},h.wrap=function(d){return Object.create(h.prototype,{[Ag]:{value:d,writable:!1}})},f&&Object.getOwnPropertyNames(f).forEach(d=>Object.defineProperty(h,d,Object.getOwnPropertyDescriptor(f,d))),a[l]=h}if(c=c.substring(u+1),a=a[l].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let h=t[i.replace("set:","get:")],d=t[i.replace("get:","set:")];Object.defineProperty(a,c,{get:function(){return h(this[Ag])},set:function(p){d(this[Ag],p)},enumerable:!0})}}else c==="constructor"?(a[c]=(...h)=>(n(h.length),s(...h))).original=s:(a[c]=function(...h){return n(h.length),s(this[Ag],...h)}).original=s}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:t[i.replace("set:","get:")],set:t[i.replace("get:","set:")],enumerable:!0}):typeof s=="function"&&s!==n?(a[c]=(...l)=>(n(l.length),s(...l))).original=s:a[c]=s}return r}Ig.demangle=QG});var eW=g((Tmt,JG)=>{var{instantiate:jDe}=ZG();XA.supported=typeof WebAssembly<"u";function XA(t={}){if(!XA.supported)return null;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return jDe(new Response(new Blob([e],{type:"application/wasm"})),t)}JG.exports=XA});var nW=g((xmt,rW)=>{var tW=$G(),VDe=eW(),zDe=async(t,e,r,n,i)=>{let s=await VDe();return new tW(s,t,e,r,n,i)};rW.exports={Rabin:tW,create:zDe}});async function*HDe(t,e){let r,n,i;if(e.minChunkSize&&e.maxChunkSize&&e.avgChunkSize)i=e.avgChunkSize,r=e.minChunkSize,n=e.maxChunkSize;else if(e.avgChunkSize)i=e.avgChunkSize,r=i/3,n=i+i/2;else throw(0,QA.default)(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(r<16)throw(0,QA.default)(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<r&&(n=r),i<r&&(i=r);let s=Math.floor(Math.log2(i));for await(let o of $De(t,{min:r,max:n,bits:s,window:e.window,polynomial:e.polynomial}))yield o}async function*$De(t,e){let r=await(0,sW.create)(e.bits,e.min,e.max,e.window),n=new iW.default;for await(let i of t){n.append(i);let s=r.fingerprint(i);for(let o=0;o<s.length;o++){let a=s[o],c=n.slice(0,a);n.consume(a),yield c}}n.length&&(yield n.slice(0))}var iW,sW,QA,oW,aW=w(()=>{iW=A(yi(),1),sW=A(nW(),1),QA=A(oe(),1);oW=HDe});async function*GDe(t,e){let r=new X5.default,n=0,i=!1,s=e.maxChunkSize;for await(let o of t)for(r.append(o),n+=o.length;n>=s;)if(yield r.slice(0,s),i=!0,s===r.length)r=new X5.default,n=0;else{let a=new X5.default;a.append(r.shallowSlice(s)),r=a,n-=s}(!i||n)&&(yield r.slice(0,n))}var X5,cW,uW=w(()=>{X5=A(yi(),1);cW=GDe});async function*WDe(t){for await(let e of t){if(e.length===void 0)throw(0,ZA.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield tt(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw(0,ZA.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}var ZA,lW,fW=w(()=>{ZA=A(oe(),1);dt();lW=WDe});function YDe(t){return Symbol.iterator in t}function XDe(t){return Symbol.asyncIterator in t}function QDe(t){try{if(t instanceof Uint8Array)return async function*(){yield t}();if(YDe(t))return async function*(){yield*t}();if(XDe(t))return t}catch{throw(0,JA.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,JA.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*ZDe(t,e,r){for await(let n of t)if(n.path&&(n.path.substring(0,2)==="./"&&(r.wrapWithDirectory=!0),n.path=n.path.split("/").filter(i=>i&&i!==".").join("/")),n.content){let i;typeof r.chunker=="function"?i=r.chunker:r.chunker==="rabin"?i=oW:i=cW;let s;typeof r.chunkValidator=="function"?s=r.chunkValidator:s=lW;let o={path:n.path,mtime:n.mtime,mode:n.mode,content:i(s(QDe(n.content),r),r)};yield()=>_G(o,e,r)}else if(n.path){let i={path:n.path,mtime:n.mtime,mode:n.mode};yield()=>nG(i,e,r)}else throw new Error("Import candidate must have content or path or both")}var JA,hW,dW=w(()=>{iG();vG();JA=A(oe(),1);aW();uW();fW();hW=ZDe});var pW,Bl,Q5=w(()=>{pW=class{constructor(e,r){this.options=r||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,r){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},Bl=pW});var yW,Tg,eR=w(()=>{xt();gn();Q5();R0();yW=class extends Bl{constructor(e,r){super(e,r);this._children={}}async put(e,r){this.cid=void 0,this.size=void 0,this._children[e]=r}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let r=0;r<e.length;r++){let n=e[r];yield{key:n,child:this._children[n]}}}async*flush(e){let r=Object.keys(this._children),n=[];for(let u=0;u<r.length;u++){let l=this._children[r[u]];if(l instanceof Bl)for await(let f of l.flush(e))l=f,yield l;l.size!=null&&l.cid&&n.push({Name:r[u],Tsize:l.size,Hash:l.cid})}let i=new mt({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:i.marshal(),Links:n},o=lt(Zn(s)),a=await la(o,e,this.options),c=o.length+s.Links.reduce((u,l)=>u+(l.Tsize==null?0:l.Tsize),0);this.cid=a,this.size=c,yield{cid:a,unixfs:i,path:this.path,size:c}}},Tg=yW});var wW=g(($mt,mW)=>{"use strict";mW.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,r){let n=this._internalPositionFor(e,!1);if(r===void 0)n!==-1&&(this._unsetInternalPos(n),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let i=!1;n===-1?(n=this._data.length,this._setBit(e),this._changedData=!0):i=!0,this._setInternalPos(n,e,r,i),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let r=this._internalPositionFor(e,!0);if(r!==-1)return this._data[r][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let r=0;for(;r<this.length;)e(this.get(r),r,this),r++}map(e){let r=0,n=new Array(this.length);for(;r<this.length;)n[r]=e(this.get(r),r,this),r++;return n}reduce(e,r){let n=0,i=r;for(;n<this.length;){let s=this.get(n);i=e(i,s,n),n++}return i}find(e){let r=0,n,i;for(;r<this.length&&!n;)i=this.get(r),n=e(i),r++;return n?i:void 0}_internalPositionFor(e,r){let n=this._bytePosFor(e,r);if(n>=this._bitArrays.length)return-1;let i=this._bitArrays[n],s=e-n*7;if(!((i&1<<s)>0))return-1;let a=this._bitArrays.slice(0,n).reduce(JDe,0),c=~(4294967295<<s+1),u=gW(i&c);return a+u-1}_bytePosFor(e,r){let n=Math.floor(e/7),i=n+1;for(;!r&&this._bitArrays.length<i;)this._bitArrays.push(0);return n}_setBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]|=1<<e-r*7}_unsetBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]&=~(1<<e-r*7)}_setInternalPos(e,r,n,i){let s=this._data,o=[r,n];if(i)this._sortData(),s[e]=o;else{if(s.length)if(s[s.length-1][0]>=r)s.push(o);else if(s[0][0]<=r)s.unshift(o);else{let a=Math.round(s.length/2);this._data=s.slice(0,a).concat(o).concat(s.slice(a))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(eNe),this._changedData=!1}bitField(){let e=[],r=8,n=0,i=0,s,o=this._bitArrays.slice();for(;o.length||n;){n===0&&(s=o.shift(),n=7);let c=Math.min(n,r),u=~(255<<c);i|=(s&u)<<8-r,s=s>>>c,n-=c,r-=c,(!r||!n&&!o.length)&&(e.push(i),i=0,r=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(tNe)}};function JDe(t,e){return t+gW(e)}function gW(t){let e=t;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function eNe(t,e){return t[0]-e[0]}function tNe(t){return t[1]}});var vW=g((Gmt,_W)=>{"use strict";var rNe=wW(),{fromString:nNe}=(dt(),se(nn)),ha=class{constructor(e,r,n=0){this._options=e,this._popCount=0,this._parent=r,this._posAtParent=n,this._children=new rNe,this.key=null}async put(e,r){let n=await this._findNewBucketAndPos(e);await n.bucket._putAt(n,e,r)}async get(e){let r=await this._findChild(e);if(r)return r.value}async del(e){let r=await this._findPlace(e),n=r.bucket._at(r.pos);n&&n.key===e&&r.bucket._delAt(r.pos)}leafCount(){return this._children.compactArray().reduce((r,n)=>n instanceof ha?r+n.leafCount():r+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let r of e)r instanceof ha?yield*r.eachLeafSeries():yield r;return[]}serialize(e,r){let n=[];return r(this._children.reduce((i,s,o)=>(s&&(s instanceof ha?i.push(s.serialize(e,r)):i.push(e(s,o))),i),n))}asyncTransform(e,r){return bW(this,e,r)}toJSON(){return this.serialize(sNe,oNe)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let r=await this._findPlace(e),n=r.bucket._at(r.pos);if(!(n instanceof ha)&&n&&n.key===e)return n}async _findPlace(e){let r=this._options.hash(typeof e=="string"?nNe(e):e),n=await r.take(this._options.bits),i=this._children.get(n);return i instanceof ha?i._findPlace(r):{bucket:this,pos:n,hash:r,existingChild:i}}async _findNewBucketAndPos(e){let r=await this._findPlace(e);if(r.existingChild&&r.existingChild.key!==e){let n=new ha(this._options,r.bucket,r.pos);r.bucket._putObjectAt(r.pos,n);let i=await n._findPlace(r.existingChild.hash);return i.bucket._putAt(i,r.existingChild.key,r.existingChild.value),n._findNewBucketAndPos(r.hash)}return r}_putAt(e,r,n){this._putObjectAt(e.pos,{key:r,value:n,hash:e.hash})}_putObjectAt(e,r){this._children.get(e)||this._popCount++,this._children.set(e,r)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let e=this._children.find(iNe);if(e&&!(e instanceof ha)){let r=e.hash;r.untake(this._options.bits);let n={pos:this._posAtParent,hash:r,bucket:this._parent};this._parent._putAt(n,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function iNe(t){return Boolean(t)}function sNe(t,e){return t.key}function oNe(t){return t}async function bW(t,e,r){let n=[];for(let i of t._children.compactArray())if(i instanceof ha)await bW(i,e,r);else{let s=await e(i);n.push({bitField:t._children.bitField(),children:s})}return r(n)}_W.exports=ha});var SW=g((Ymt,EW)=>{"use strict";var aNe=[255,254,252,248,240,224,192,128],cNe=[1,3,7,15,31,63,127,255];EW.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let r=e,n=0;for(;r&&this._haveBits();){let i=this._value[this._currentBytePos],s=this._currentBitPos+1,o=Math.min(s,r),a=uNe(i,s-o,o);n=(n<<o)+a,r-=o,this._currentBitPos-=o,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function uNe(t,e,r){let n=lNe(e,r);return(t&n)>>>e}function lNe(t,e){return aNe[t]&cNe[Math.min(e+t-1,7)]}});var AW=g((Xmt,tR)=>{"use strict";var fNe=SW(),{concat:hNe}=(Pn(),se(Ui));function dNe(t){function e(r){return r instanceof Z5?r:new Z5(r,t)}return e}var Z5=class{constructor(e,r){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=r,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let r=e;for(;this._availableBits<r;)await this._produceMoreBits();let n=0;for(;r>0;){let i=this._buffers[this._currentBufferIndex],s=Math.min(i.availableBits(),r),o=i.take(s);n=(n<<s)+o,r-=s,this._availableBits-=s,i.availableBits()===0&&this._currentBufferIndex++}return n}untake(e){let r=e;for(;r>0;){let n=this._buffers[this._currentBufferIndex],i=Math.min(n.totalBits()-n.availableBits(),r);n.untake(i),r-=i,this._availableBits+=i,this._currentBufferIndex>0&&n.totalBits()===n.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth?hNe([this._value,Uint8Array.from([this._depth])]):this._value,r=await this._hashFn(e),n=new fNe(r);this._buffers.push(n),this._availableBits+=n.availableBits()}};tR.exports=dNe;tR.exports.InfiniteHash=Z5});var xg=g((Qmt,IW)=>{"use strict";var RW=vW(),pNe=AW();function yNe(t){if(!t||!t.hashFn)throw new Error("please define an options.hashFn");let e={bits:t.bits||8,hash:pNe(t.hashFn)};return new RW(e)}IW.exports={createHAMT:yNe,Bucket:RW}});async function*PW(t,e,r,n){let i=t._children,s=[],o=0;for(let d=0;d<i.length;d++){let p=i.get(d);if(!p)continue;let y=d.toString(16).toUpperCase().padStart(2,"0");if(p instanceof J5.Bucket){let b;for await(let m of await PW(p,e,null,n))b=m;if(!b)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:y,Tsize:b.size,Hash:b.cid}),o+=b.size}else if(typeof p.value.flush=="function"){let b=p.value,m;for await(let R of b.flush(e))m=R,yield m;let _=y+p.key;s.push({Name:_,Tsize:m.size,Hash:m.cid}),o+=m.size}else{let b=p.value;if(!b.cid)continue;let m=y+p.key,_=b.size;s.push({Name:m,Tsize:_,Hash:b.cid}),o+=_}}let a=Uint8Array.from(i.bitField().reverse()),c=new mt({type:"hamt-sharded-directory",data:a,fanout:t.tableSize(),hashType:n.hamtHashCode,mtime:r&&r.mtime,mode:r&&r.mode}),u={Data:c.marshal(),Links:s},l=lt(Zn(u)),f=await la(l,e,n),h=l.length+o;yield{cid:f,unixfs:c,size:h}}var J5,TW,xW,CW=w(()=>{xt();gn();Q5();R0();J5=A(xg(),1),TW=class extends Bl{constructor(e,r){super(e,r);this._bucket=(0,J5.createHAMT)({hashFn:r.hamtHashFn,bits:r.hamtBucketBits})}async put(e,r){await this._bucket.put(e,r)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:r}of this._bucket.eachLeafSeries())yield{key:e,child:r}}async*flush(e){for await(let r of PW(this._bucket,e,this,this.options))yield{...r,path:this.path}}},xW=TW});async function OW(t,e,r,n){let i=e;e instanceof Tg&&e.directChildrenCount()>=r&&(i=await gNe(e,n));let s=i.parent;if(s){if(i!==e){if(t&&(t.parent=i),!i.parentKey)throw new Error("No parent key found");await s.put(i.parentKey,i)}return OW(i,s,r,n)}return i}async function gNe(t,e){let r=new xW({root:t.root,dir:!0,parent:t.parent,parentKey:t.parentKey,path:t.path,dirty:t.dirty,flat:!1,mtime:t.mtime,mode:t.mode},e);for await(let{key:n,child:i}of t.eachChildSeries())await r.put(n,i);return r}var kW,DW=w(()=>{CW();eR();kW=OW});var mNe,NW,BW=w(()=>{mNe=(t="")=>(t.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean),NW=mNe});async function wNe(t,e,r){let n=NW(t.path||""),i=n.length-1,s=e,o="";for(let a=0;a<n.length;a++){let c=n[a];o+=`${o?"/":""}${c}`;let u=a===i;if(s.dirty=!0,s.cid=void 0,s.size=void 0,u)await s.put(c,t),e=await kW(null,s,r.shardSplitThreshold,r);else{let l=await s.get(c);(!l||!(l instanceof Bl))&&(l=new Tg({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:l&&l.unixfs&&l.unixfs.mtime,mode:l&&l.unixfs&&l.unixfs.mode},r)),await s.put(c,l),s=l}}return e}async function*LW(t,e){if(!(t instanceof Bl)){t&&t.unixfs&&t.unixfs.isDirectory()&&(yield t);return}yield*t.flush(e)}async function*bNe(t,e,r){let n=new Tg({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r);for await(let i of t)!i||(n=await wNe(i,n,r),(!i.unixfs||!i.unixfs.isDirectory())&&(yield i));if(r.wrapWithDirectory)yield*LW(n,e);else for await(let i of n.eachChildSeries())!i||(yield*LW(i.child,e))}var MW,UW=w(()=>{eR();DW();Q5();BW();MW=bNe});async function*C0(t,e,r={}){let n=tG(r),i;typeof r.dagBuilder=="function"?i=r.dagBuilder:i=hW;let s;typeof r.treeBuilder=="function"?s=r.treeBuilder:s=MW;let o;Symbol.asyncIterator in t||Symbol.iterator in t?o=t:o=[t];for await(let a of s((0,qW.default)(i(o,e,n),n.fileImportConcurrency),e,n))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}var qW,ew=w(()=>{qW=A(z5(),1);rG();dW();UW()});async function*tw(t,e){if(typeof t=="string"||t instanceof String||mo(t)||lu(t)||t._readableState)throw(0,Pg.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(fu(t)&&(t=(0,FW.default)(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let r=(0,KW.default)(t),{value:n,done:i}=await r.peek();if(i){yield*[];return}if(r.push(n),Number.isInteger(n))throw(0,Pg.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState){yield*(0,nR.default)(r,s=>rR({content:s},e));return}if(mo(n)){yield rR({content:r},e);return}if(_g(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||fu(n)||lu(n)){yield*(0,nR.default)(r,s=>rR(s,e));return}}throw _g(t)?(0,Pg.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):(0,Pg.default)(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}async function rR(t,e){let{path:r,mode:n,mtime:i,content:s}=t,o={path:r||"",mode:Gc(n),mtime:Zu(i)};return s?o.content=await e(s):r||(o.content=await e(t)),o}var Pg,FW,KW,nR,iR=w(()=>{Pg=A(oe(),1),FW=A(S0(),1),KW=A(A0(),1),nR=A(xi(),1);vg();gn()});function jW(t){return tw(t,q5)}var VW=w(()=>{NA();iR()});var zW,_Ne,rw,HW=w(()=>{zW=t=>{if(t)if(t.startsWith("size-")){let e=t.split("-")[1],r=parseInt(e);if(isNaN(r))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:r}}else{if(t.startsWith("rabin"))return{chunker:"rabin",..._Ne(t)};throw new Error(`Unrecognized chunker option: ${t}`)}else return{chunker:"fixed"}},_Ne=t=>{let e={},r=t.split("-");switch(r.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=rw(r[1],"avg");break;case 4:e.minChunkSize=rw(r[1],"min"),e.avgChunkSize=rw(r[2],"avg"),e.maxChunkSize=rw(r[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},rw=(t,e)=>{let r=parseInt(t);if(isNaN(r))throw new Error(`Chunker parameter ${e} must be an integer`);return r}});function GW({repo:t,preload:e,hashers:r,options:n}){let i=n&&n.sharding;async function*s(o,a={}){let c=vNe({shardSplitThreshold:i?1e3:1/0,strategy:"balanced"},a,{...zW(a.chunker)});c.hashAlg&&c.hashAlg!=="sha2-256"&&c.cidVersion!==1&&(c.cidVersion=1),c.trickle&&(c.strategy="trickle"),c.strategy==="trickle"&&(c.leafType="raw",c.reduceSingleLeafToSelf=!1),c.cidVersion>0&&c.rawLeaves===void 0&&(c.rawLeaves=!0),c.hashAlg!==void 0&&c.rawLeaves===void 0&&(c.rawLeaves=!0),delete c.trickle;let u={};if(c.progress){let d=c.progress;c.progress=(p,y)=>{u[y]||(u[y]=0),u[y]+=p,d(u[y],y)}}let l;c.hashAlg!=null&&(l=await r.getHasher(c.hashAlg));let f=(0,$W.pipe)(jW(o),d=>C0(d,t.blocks,{...c,hasher:l,pin:!1}),ENe(c),SNe(e,c),ANe(t,c)),h=await t.gcLock.readLock();try{for await(let d of f)delete u[d.path],yield d}finally{h()}}return Q(s)}function ENe(t){async function*e(r){for await(let n of r){let i=n.cid;t.cidVersion===1&&(i=i.toV1());let s=n.path?n.path:i.toString();t.wrapWithDirectory&&!n.path&&(s=""),yield{path:s,cid:i,size:n.size,mode:n.unixfs&&n.unixfs.mode,mtime:n.unixfs&&n.unixfs.mtime}}}return e}function SNe(t,e){async function*r(n){for await(let i of n)(!i.path||e.wrapWithDirectory?i.path==="":!i.path.includes("/"))&&!e.onlyHash&&e.preload!==!1&&t(i.cid),yield i}return r}function ANe(t,e){async function*r(n){for await(let i of n){let s=!(i.path&&i.path.includes("/"));(e.pin==null?!0:e.pin)&&s&&!e.onlyHash&&await t.pins.pinRecursively(i.cid),yield i}}return r}var $W,vNe,WW=w(()=>{ew();VW();HW();$W=A(br(),1);Ce();Fn();vNe=Bt.bind({ignoreUndefined:!0})});function INe(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return L.decode(t.subarray(1))}var RNe,YW,nw,iw,sw=w(()=>{sl();Se();RNe=42;YW={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};YW.tags[RNe]=INe;nw=113,iw=t=>Rn(t,YW)});var ow,TNe,xNe,XW,PNe,QW,ZW,JW=w(()=>{ow=A(xg(),1);xt();$5();TNe=async function(t){return(await Rh.encode(t)).slice(0,8).reverse()},xNe=(t,e,r)=>Promise.all(t.map(n=>{if(n.Name==null)throw new Error("Unexpected Link without a Name");if(n.Name.length===2){let i=parseInt(n.Name,16);return e._putObjectAt(i,new ow.Bucket({hash:r._options.hash,bits:r._options.bits},e,i))}return r.put(n.Name.substring(2),!0)})),XW=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),PNe=t=>{let e=t.bucket,r=[];for(;e._parent;)r.push(e),e=e._parent;return r.push(e),r.reverse()},QW=async(t,e,r,n,i)=>{if(!n){let l=(0,ow.createHAMT)({hashFn:TNe});n={rootBucket:l,hamtDepth:1,lastBucket:l}}await xNe(t.Links,n.lastBucket,n.rootBucket);let s=await n.rootBucket._findNewBucketAndPos(e),o=XW(s.pos),a=PNe(s);a.length>n.hamtDepth&&(n.lastBucket=a[n.hamtDepth],o=XW(n.lastBucket._posAtParent));let c=t.Links.find(l=>{if(l.Name==null)return!1;let f=l.Name.substring(0,2),h=l.Name.substring(2);return!(f!==o||h&&h!==e)});if(!c)return null;if(c.Name!=null&&c.Name.substring(2)===e)return c.Hash;n.hamtDepth++;let u=await r.get(c.Hash,i);return t=Ft(u),QW(t,e,r,n,i)},ZW=QW});function CNe(t,e,r,n){let i=t.length,s=e+i;return r>=s||n<e?new Uint8Array(0):(n>=e&&n<s&&(t=t.slice(0,n-e)),r>=e&&r<s&&(t=t.slice(r-e)),t)}var xh,aw=w(()=>{xh=CNe});var cw,ONe,O0,uw=w(()=>{cw=A(oe(),1),ONe=(t,e,r)=>{if(e||(e=0),e<0)throw(0,cw.default)(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>t)throw(0,cw.default)(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!r&&r!==0&&(r=t-e),r<0)throw(0,cw.default)(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+r>t&&(r=t-e),{offset:e,length:r}},O0=ONe});async function*eY(t,e,r,n,i=0,s){if(e instanceof Uint8Array){let c=xh(e,i,r,n);return c.length&&(yield c),i+=c.length,i}if(e.Data==null)throw(0,oR.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let o;try{o=mt.unmarshal(e.Data)}catch(c){throw(0,oR.default)(c,"ERR_NOT_UNIXFS")}if(o.data&&o.data.length){let c=xh(o.data,i,r,n);c.length&&(yield c),i+=o.data.length}let a=i;for(let c=0;c<e.Links.length;c++){let u=e.Links[c],l=i+o.blockSizes[c];if(r>=a&&r<l||n>a&&n<=l||r<a&&n>l){let f=await t.get(u.Hash,{signal:s.signal}),h;switch(u.Hash.code){case St:h=await Ft(f);break;case ei:h=f;break;case nw:h=await iw(f);break;default:throw Error(`Unsupported codec: ${u.Hash.code}`)}for await(let d of eY(t,h,r,n,i,s))i+=d.length,yield d}i=l,a=l+1}}var oR,kNe,aR,tY=w(()=>{aw();uw();gn();oR=A(oe(),1);xt();sw();eo();kNe=(t,e,r,n,i,s,o)=>{function a(c={}){let u=r.fileSize();if(u===void 0)throw new Error("File was a directory");let{offset:l,length:f}=O0(u,c.offset,c.length),h=l,d=l+f;return eY(o,e,h,d,0,c)}return a},aR=kNe});var DNe,rY,nY=w(()=>{DNe=(t,e,r,n,i,s,o)=>{async function*a(c={}){let u=c.offset||0,l=c.length||e.Links.length,f=e.Links.slice(u,l);for(let h of f){let d=await i(h.Hash,h.Name||"",`${n}/${h.Name||""}`,[],s+1,o,c);d.entry&&(yield d.entry)}}return a},rY=DNe});async function*iY(t,e,r,n,i,s){let o=t.Links;for(let a of o){let c=a.Name!=null?a.Name.substring(2):null;if(c)yield(await r(a.Hash,c,`${e}/${c}`,[],n+1,i,s)).entry;else{let u=await i.get(a.Hash);t=Ft(u);for await(let l of iY(t,e,r,n,i,s))yield l}}}var NNe,sY,oY=w(()=>{xt();NNe=(t,e,r,n,i,s,o)=>{function a(c={}){return iY(e,n,i,s,o,c)}return a};sY=NNe});var lw,BNe,LNe,MNe,aY,cY=w(()=>{lw=A(oe(),1);gn();JW();xt();tY();nY();oY();BNe=(t,e)=>{let r=t.Links.find(n=>n.Name===e);return r&&r.Hash},LNe={raw:aR,file:aR,directory:rY,"hamt-sharded-directory":sY,metadata:(t,e,r,n,i,s,o)=>()=>[],symlink:(t,e,r,n,i,s,o)=>()=>[]},MNe=async(t,e,r,n,i,s,o,a)=>{let c=await o.get(t,a),u=Ft(c),l,f;if(e||(e=t.toString()),u.Data==null)throw(0,lw.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{l=mt.unmarshal(u.Data)}catch(h){throw(0,lw.default)(h,"ERR_NOT_UNIXFS")}if(r||(r=e),n.length){let h;if(l&&l.type==="hamt-sharded-directory"?h=await ZW(u,n[0],o):h=BNe(u,n[0]),!h)throw(0,lw.default)(new Error("file does not exist"),"ERR_NOT_FOUND");let d=n.shift(),p=`${r}/${d}`;f={cid:h,toResolve:n,name:d||"",path:p}}return{entry:{type:l.isDirectory()?"directory":"file",name:e,path:r,cid:t,content:LNe[l.type](t,u,l,r,i,s,o),unixfs:l,depth:s,node:u,size:l.fileSize()},next:f}},aY=MNe});var uY,UNe,qNe,lY,fY=w(()=>{uY=A(oe(),1);aw();uw();UNe=t=>{async function*e(r={}){let{offset:n,length:i}=O0(t.length,r.offset,r.length);yield xh(t,0,n,n+i)}return e},qNe=async(t,e,r,n,i,s,o,a)=>{if(n.length)throw(0,uY.default)(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let c=await o.get(t,a);return{entry:{type:"raw",name:e,path:r,cid:t,content:UNe(c),depth:s,size:c.length,node:c}}},lY=qNe});var hY,FNe,dY,pY=w(()=>{Se();hY=A(oe(),1);sw();FNe=async(t,e,r,n,i,s,o,a)=>{let c=await o.get(t),u=iw(c),l=u,f=r;for(;n.length;){let h=n[0];if(h in l){n.shift(),f=`${f}/${h}`;let d=L.asCID(l[h]);if(d)return{entry:{type:"object",name:e,path:r,cid:t,node:c,depth:s,size:c.length,content:async function*(){yield u}},next:{cid:d,name:h,path:f,toResolve:n}};l=l[h]}else throw(0,hY.default)(new Error(`No property named ${h} found in cbor node ${t}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:r,cid:t,node:c,depth:s,size:c.length,content:async function*(){yield u}}}},dY=FNe});var yY,KNe,jNe,gY,mY=w(()=>{yY=A(oe(),1);aw();uw();li();KNe=t=>{async function*e(r={}){let{offset:n,length:i}=O0(t.length,r.offset,r.length);yield xh(t,0,n,n+i)}return e},jNe=async(t,e,r,n,i,s,o,a)=>{if(n.length)throw(0,yY.default)(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let c=await mn(t.multihash.bytes);return{entry:{type:"identity",name:e,path:r,cid:t,content:KNe(c.digest),depth:s,size:c.digest.length,node:c.digest}}},gY=jNe});function bY(t,e,r,n,i,s,o){let a=VNe[t.code];if(!a)throw(0,wY.default)(new Error(`No resolver for code ${t.code}`),"ERR_NO_RESOLVER");return a(t,e,r,n,bY,i,s,o)}var wY,VNe,_Y,vY=w(()=>{wY=A(oe(),1);xt();sw();eo();Zc();cY();fY();pY();mY();VNe={[St]:aY,[ei]:lY,[nw]:dY,[Cs.code]:gY};_Y=bY});async function*cR(t,e,r={}){let{cid:n,toResolve:i}=HNe(t),s=n.toString(),o=s,a=i.length;for(;;){let c=await _Y(n,s,o,i,a,e,r);if(!c.entry&&!c.next)throw(0,fw.default)(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;i=c.next.toResolve,n=c.next.cid,s=c.next.name,o=c.next.path}}async function gi(t,e,r={}){let n=await(0,EY.default)(cR(t,e,r));if(!n)throw(0,fw.default)(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");return n}async function*hw(t,e,r={}){let n=await gi(t,e,r);if(!n)return;if(yield n,n.type==="directory")for await(let s of i(n,r))yield s;async function*i(s,o){for await(let a of s.content(o))yield a,!(a instanceof Uint8Array)&&a.type==="directory"&&(yield*i(a,o))}}var fw,EY,zNe,HNe,da=w(()=>{fw=A(oe(),1);Se();vY();EY=A(os(),1),zNe=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),HNe=t=>{if(t instanceof Uint8Array)return{cid:L.decode(t),toResolve:[]};let e=L.asCID(t);if(e)return{cid:e,toResolve:[]};if(typeof t=="string"){t.indexOf("/ipfs/")===0&&(t=t.substring(6));let r=zNe(t);return{cid:L.parse(r[0]),toResolve:r.slice(1)}}throw(0,fw.default)(new Error(`Unknown path type ${t}`),"ERR_BAD_PATH")}});function SY({repo:t,preload:e}){async function*r(n,i={}){if(n=Up(n),i.preload!==!1){let o=n.split("/");e(L.parse(o[0]))}let s=await gi(n,t.blocks,i);if(s.type==="directory")throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(i)}return Q(r)}var AY=w(()=>{da();ti();Ce();Se()});var TY=g(pw=>{var{Buffer:uR}=On(),D0=yi(),$Ne="0".charCodeAt(0),GNe=uR.from("ustar\0","binary"),WNe=uR.from("ustar ","binary"),YNe=uR.from(" \0","binary"),dw=257,RY=263,XNe=function(t,e,r){return typeof t!="number"?r:(t=~~t,t>=e?e:t>=0||(t+=e,t>=0)?t:0)},QNe=function(t){switch(t){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-globalThis-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},IY=function(t,e,r,n){for(;r<n;r++)if(t.get(r)===e)return r;return n},ZNe=function(t){let e=256;for(let r=0;r<148;r++)e+=t.get(r);for(let r=156;r<512;r++)e+=t.get(r);return e};function JNe(t){let e;if(t.get(0)===128)e=!0;else if(t.get(0)===255)e=!1;else return null;let r=!1,n=[];for(let o=t.length-1;o>0;o--){let a=t.get(o);e?n.push(a):r&&a===0?n.push(0):r?(r=!1,n.push(256-a)):n.push(255-a)}let i=0,s=n.length;for(let o=0;o<s;o++)i+=n[o]*Math.pow(256,o);return e?i:-1*i}var Ll=function(t,e,r){if(t=t.shallowSlice(e,e+r),e=0,t.get(e)&128)return JNe(t);{for(;e<t.length&&t.get(e)===32;)e++;let n=XNe(IY(t,32,e,t.length),t.length,t.length);for(;e<n&&t.get(e)===0;)e++;return n===e?0:parseInt(t.shallowSlice(e,n).toString(),8)}},k0=function(t,e,r,n){return t.shallowSlice(e,IY(t,0,e,e+r)).toString(n)};pw.decodeLongPath=function(t,e){return t=D0.isBufferList(t)?t:new D0(t),k0(t,0,t.length,e)};pw.decodePax=function(t){t=D0.isBufferList(t)?t:new D0(t);let e={};for(;t.length;){let r=0;for(;r<t.length&&t.get(r)!==32;)r++;let n=parseInt(t.shallowSlice(0,r).toString(),10);if(!n)return e;let i=t.shallowSlice(r+1,n-1).toString(),s=i.indexOf("=");if(s===-1)return e;e[i.slice(0,s)]=i.slice(s+1),t=t.shallowSlice(n)}return e};pw.decode=function(t,e){t=D0.isBufferList(t)?t:new D0(t);let r=t.get(156)===0?0:t.get(156)-$Ne,n=k0(t,0,100,e),i=Ll(t,100,8),s=Ll(t,108,8),o=Ll(t,116,8),a=Ll(t,124,12),c=Ll(t,136,12),u=QNe(r),l=t.get(157)===0?null:k0(t,157,100,e),f=k0(t,265,32),h=k0(t,297,32),d=Ll(t,329,8),p=Ll(t,337,8),y=ZNe(t);if(y===8*32)return null;if(y!==Ll(t,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(GNe.compare(t.slice(dw,dw+6))===0)t.get(345)&&(n=k0(t,345,155,e)+"/"+n);else if(!(WNe.compare(t.slice(dw,dw+6))===0&&YNe.compare(t.slice(RY,RY+2))===0))throw new Error("Invalid tar header: unknown format.");return r===0&&n&&n[n.length-1]==="/"&&(r=5),{name:n,mode:i,uid:s,gid:o,size:a,mtime:new Date(1e3*c),type:u,linkname:l,uname:f,gname:h,devmajor:d,devminor:p}}});var yw=g((w4t,xY)=>{var lR=yi();xY.exports=t=>{let e=async function*(){let r=yield,n=new lR;for await(let i of t){if(!r){r=yield n.append(i),n=new lR;continue}for(n.append(i);n.length>=r;){let s=n.shallowSlice(0,r);if(n.consume(r),r=yield s,!r){n.length&&(r=yield n,n=new lR);break}}}if(r)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return e.next(),e}});var CY=g((b4t,PY)=>{var fR=yi(),eBe=yw();PY.exports=function(e){let r=eBe(e),n,i={[Symbol.asyncIterator]:()=>i,async next(s){if(n){let o;if(s==null||n.length===s)o=n,n=null;else if(n.length>s)o=n.shallowSlice(0,s),n=n.shallowSlice(s);else if(n.length<s){let{value:a,done:c}=await r.next(s-n.length);if(c)throw Object.assign(new Error(`stream ended before ${s-n.length} bytes became available`),{code:"ERR_UNDER_READ"});o=new fR([n,a]),n=null}return{value:o}}return r.next(s)},async nextLte(s){let{done:o,value:a}=await i.next();return o?{done:o}:a.length<=s?{value:a}:(a=fR.isBufferList(a)?a:new fR(a),n?n.append(a.shallowSlice(s)):n=a.shallowSlice(s),{value:a.shallowSlice(0,s)})},return(){return r.return()}};return i}});var kY=g((_4t,OY)=>{var tBe=uc(),Cg=TY(),rBe=CY();function nBe(t){return t&=511,t&&512-t}async function Og(t,e){let r=nBe(e);r&&await t.next(r)}OY.exports=t=>(t=t||{},t.highWaterMark=t.highWaterMark||1024*16,e=>async function*(){let r=rBe(e),n,i,s,o;try{for(;;){let a;try{let{done:d,value:p}=await r.next(512);if(d)return;a=p}catch(d){if(d.code==="ERR_UNDER_READ")return;throw d}let c=Cg.decode(a,t.filenameEncoding);if(!c)continue;if(c.type==="gnu-long-path"){let{done:d,value:p}=await r.next(c.size);if(d)return;n=Cg.decodeLongPath(p,t.filenameEncoding),await Og(r,c.size);continue}if(c.type==="gnu-long-link-path"){let{done:d,value:p}=await r.next(c.size);if(d)return;i=Cg.decodeLongPath(p,t.filenameEncoding),await Og(r,c.size);continue}if(c.type==="pax-globalThis-header"){let{done:d,value:p}=await r.next(c.size);if(d)return;s=Cg.decodePax(p,t.filenameEncoding),await Og(r,c.size);continue}if(c.type==="pax-header"){let{done:d,value:p}=await r.next(c.size);if(d)return;o=Cg.decodePax(p,t.filenameEncoding),s&&(o={...s,...o}),await Og(r,c.size);continue}if(n&&(c.name=n,n=null),i&&(c.linkname=i,i=null),o&&(o.path&&(c.name=o.path),o.linkpath&&(c.linkname=o.linkpath),o.size&&(c.size=parseInt(o.size,10)),c.pax=o,o=null),!c.size||c.type==="directory"){yield{header:c,body:async function*(){}()};continue}let u=c.size,l=tBe(),f=await r.nextLte(Math.min(u,t.highWaterMark));u-=f.value.length,u||l.resolve();let h=async function*(){try{for(yield f.value;u;){let{done:d,value:p}=await r.nextLte(u);if(d){u=0;return}u-=p.length,yield p}}finally{l.resolve()}}();if(yield{header:c,body:h},await l.promise,u)for await(let d of h);await Og(r,c.size)}}finally{await r.return()}}())});var NY=g((v4t,DY)=>{"use strict";DY.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_globalThis:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,SIGUNUSED:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:805306400,SSL_OP_ALL:2147485776,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}});var LY=g((E4t,BY)=>{var iBe=yi(),hR={string:()=>"",buffer:()=>iBe()};BY.exports=async(t,e)=>{if(e=e||{},e.type&&!hR[e.type])throw new Error(`invalid type "${e.type}"`);let r,n;for await(let i of t)r||(n=e.type||(typeof i=="string"?"string":"buffer"),r=hR[n]()),n==="string"?r+=i:r.append(i);return r||hR[e.type||"buffer"]()}});var MY=g(pR=>{var{Buffer:hc}=On(),sBe=hc.alloc,oBe="0000000000000000000",aBe="7777777777777777777",cBe="0".charCodeAt(0),uBe=hc.from("ustar\0","binary"),lBe=hc.from("00","binary"),fBe=parseInt("7777",8),hBe=257,dBe=263,pBe=function(t){switch(t){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},yBe=function(t){let e=256;for(let r=0;r<148;r++)e+=t[r];for(let r=156;r<512;r++)e+=t[r];return e},Ml=function(t,e){return t=t.toString(8),t.length>e?aBe.slice(0,e)+" ":oBe.slice(0,e-t.length)+t+" "},dR=function(t){let e=hc.byteLength(t),r=Math.floor(Math.log(e)/Math.log(10))+1;return e+r>=Math.pow(10,r)&&r++,e+r+t};pR.encodePax=function(t){let e="";t.name&&(e+=dR(" path="+t.name+`
`)),t.linkname&&(e+=dR(" linkpath="+t.linkname+`
`));let r=t.pax;if(r)for(let n in r)e+=dR(" "+n+"="+r[n]+`
`);return hc.from(e)};pR.encode=function(t){let e=sBe(512),r=t.name,n="";if(t.typeflag===5&&r[r.length-1]!=="/"&&(r+="/"),hc.byteLength(r)!==r.length)return null;for(;hc.byteLength(r)>100;){let i=r.indexOf("/");if(i===-1)return null;n+=n?"/"+r.slice(0,i):r.slice(0,i),r=r.slice(i+1)}return hc.byteLength(r)>100||hc.byteLength(n)>155||t.linkname&&hc.byteLength(t.linkname)>100?null:(e.write(r),e.write(Ml(t.mode&fBe,6),100),e.write(Ml(t.uid,6),108),e.write(Ml(t.gid,6),116),e.write(Ml(t.size,11),124),e.write(Ml(t.mtime.getTime()/1e3|0,11),136),e[156]=cBe+pBe(t.type),t.linkname&&e.write(t.linkname,157),uBe.copy(e,hBe),lBe.copy(e,dBe),t.uname&&e.write(t.uname,265),t.gname&&e.write(t.gname,297),e.write(Ml(t.devmajor||0,6),329),e.write(Ml(t.devminor||0,6),337),n&&e.write(n,345),e.write(Ml(yBe(e),6),148),e)}});var FY=g((A4t,qY)=>{var{Buffer:gR}=On(),Ph=yi(),{S_IFMT:gBe,S_IFBLK:mBe,S_IFCHR:wBe,S_IFDIR:bBe,S_IFIFO:_Be,S_IFLNK:vBe}=NY(),EBe=LY(),gw=MY(),SBe=parseInt("755",8),ABe=parseInt("644",8),UY=gR.alloc(1024);function RBe(t){switch(t&gBe){case mBe:return"block-device";case wBe:return"character-device";case bBe:return"directory";case _Be:return"fifo";case vBe:return"symlink"}return"file"}function mR(t){if(t&=511,t)return new Ph(UY.slice(0,512-t))}function yR(t){if(!t.pax){let e=gw.encode(t);if(e)return e}return IBe(t)}function IBe(t){let e=gw.encodePax({name:t.name,linkname:t.linkname,pax:t.pax}),r={name:"PaxHeader",mode:t.mode,uid:t.uid,gid:t.gid,size:e.length,mtime:t.mtime,type:"pax-header",linkname:t.linkname&&"PaxHeader",uname:t.uname,gname:t.gname,devmajor:t.devmajor,devminor:t.devminor};return new Ph([gw.encode(r),e,mR(e.length),gw.encode({...r,size:t.size,type:t.type})])}qY.exports=()=>async function*(t){for await(let{header:e,body:r}of t){if((!e.size||e.type==="symlink")&&(e.size=0),e.type||(e.type=RBe(e.mode)),e.mode||(e.mode=e.type==="directory"?SBe:ABe),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),typeof r=="string"&&(r=gR.from(r)),gR.isBuffer(r)||Ph.isBufferList(r)){e.size=r.length,yield new Ph([yR(e),r,mR(e.size)]);continue}if(e.type==="symlink"&&!e.linkname){e.linkname=(await EBe(r)).toString(),yield yR(e);continue}if(yield yR(e),e.type!=="file"&&e.type!=="contiguous-file")continue;let n=0;for await(let s of r)n+=s.length,yield Ph.isBufferList(s)?s:new Ph(s);if(n!==e.size)throw new Error("size mismatch");let i=mR(e.size);i&&(yield i)}yield new Ph(UY)}});var KY=g(wR=>{wR.extract=kY();wR.pack=FY()});var du=g(Hi=>{"use strict";var TBe=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function xBe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}Hi.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(var n in r)xBe(r,n)&&(t[n]=r[n])}}return t};Hi.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var PBe={arraySet:function(t,e,r,n,i){if(e.subarray&&t.subarray){t.set(e.subarray(r,r+n),i);return}for(var s=0;s<n;s++)t[i+s]=e[r+s]},flattenChunks:function(t){var e,r,n,i,s,o;for(n=0,e=0,r=t.length;e<r;e++)n+=t[e].length;for(o=new Uint8Array(n),i=0,e=0,r=t.length;e<r;e++)s=t[e],o.set(s,i),i+=s.length;return o}},CBe={arraySet:function(t,e,r,n,i){for(var s=0;s<n;s++)t[i+s]=e[r+s]},flattenChunks:function(t){return[].concat.apply([],t)}};Hi.setTyped=function(t){t?(Hi.Buf8=Uint8Array,Hi.Buf16=Uint16Array,Hi.Buf32=Int32Array,Hi.assign(Hi,PBe)):(Hi.Buf8=Array,Hi.Buf16=Array,Hi.Buf32=Array,Hi.assign(Hi,CBe))};Hi.setTyped(TBe)});var lX=g(L0=>{"use strict";var OBe=du(),kBe=4,jY=0,VY=1,DBe=2;function B0(t){for(var e=t.length;--e>=0;)t[e]=0}var NBe=0,YY=1,BBe=2,LBe=3,MBe=258,RR=29,Mg=256,Dg=Mg+1+RR,N0=30,IR=19,XY=2*Dg+1,Ch=15,bR=16,UBe=7,TR=256,QY=16,ZY=17,JY=18,SR=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],mw=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],qBe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],eX=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],FBe=512,pu=new Array((Dg+2)*2);B0(pu);var kg=new Array(N0*2);B0(kg);var Ng=new Array(FBe);B0(Ng);var Bg=new Array(MBe-LBe+1);B0(Bg);var xR=new Array(RR);B0(xR);var ww=new Array(N0);B0(ww);function _R(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}var tX,rX,nX;function vR(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function iX(t){return t<256?Ng[t]:Ng[256+(t>>>7)]}function Lg(t,e){t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255}function ds(t,e,r){t.bi_valid>bR-r?(t.bi_buf|=e<<t.bi_valid&65535,Lg(t,t.bi_buf),t.bi_buf=e>>bR-t.bi_valid,t.bi_valid+=r-bR):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function dc(t,e,r){ds(t,r[e*2],r[e*2+1])}function sX(t,e){var r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1}function KBe(t){t.bi_valid===16?(Lg(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)}function jBe(t,e){var r=e.dyn_tree,n=e.max_code,i=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length,u,l,f,h,d,p,y=0;for(h=0;h<=Ch;h++)t.bl_count[h]=0;for(r[t.heap[t.heap_max]*2+1]=0,u=t.heap_max+1;u<XY;u++)l=t.heap[u],h=r[r[l*2+1]*2+1]+1,h>c&&(h=c,y++),r[l*2+1]=h,!(l>n)&&(t.bl_count[h]++,d=0,l>=a&&(d=o[l-a]),p=r[l*2],t.opt_len+=p*(h+d),s&&(t.static_len+=p*(i[l*2+1]+d)));if(y!==0){do{for(h=c-1;t.bl_count[h]===0;)h--;t.bl_count[h]--,t.bl_count[h+1]+=2,t.bl_count[c]--,y-=2}while(y>0);for(h=c;h!==0;h--)for(l=t.bl_count[h];l!==0;)f=t.heap[--u],!(f>n)&&(r[f*2+1]!==h&&(t.opt_len+=(h-r[f*2+1])*r[f*2],r[f*2+1]=h),l--)}}function oX(t,e,r){var n=new Array(Ch+1),i=0,s,o;for(s=1;s<=Ch;s++)n[s]=i=i+r[s-1]<<1;for(o=0;o<=e;o++){var a=t[o*2+1];a!==0&&(t[o*2]=sX(n[a]++,a))}}function VBe(){var t,e,r,n,i,s=new Array(Ch+1);for(r=0,n=0;n<RR-1;n++)for(xR[n]=r,t=0;t<1<<SR[n];t++)Bg[r++]=n;for(Bg[r-1]=n,i=0,n=0;n<16;n++)for(ww[n]=i,t=0;t<1<<mw[n];t++)Ng[i++]=n;for(i>>=7;n<N0;n++)for(ww[n]=i<<7,t=0;t<1<<mw[n]-7;t++)Ng[256+i++]=n;for(e=0;e<=Ch;e++)s[e]=0;for(t=0;t<=143;)pu[t*2+1]=8,t++,s[8]++;for(;t<=255;)pu[t*2+1]=9,t++,s[9]++;for(;t<=279;)pu[t*2+1]=7,t++,s[7]++;for(;t<=287;)pu[t*2+1]=8,t++,s[8]++;for(oX(pu,Dg+1,s),t=0;t<N0;t++)kg[t*2+1]=5,kg[t*2]=sX(t,5);tX=new _R(pu,SR,Mg+1,Dg,Ch),rX=new _R(kg,mw,0,N0,Ch),nX=new _R(new Array(0),qBe,0,IR,UBe)}function aX(t){var e;for(e=0;e<Dg;e++)t.dyn_ltree[e*2]=0;for(e=0;e<N0;e++)t.dyn_dtree[e*2]=0;for(e=0;e<IR;e++)t.bl_tree[e*2]=0;t.dyn_ltree[TR*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function cX(t){t.bi_valid>8?Lg(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function zBe(t,e,r,n){cX(t),n&&(Lg(t,r),Lg(t,~r)),OBe.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}function zY(t,e,r,n){var i=e*2,s=r*2;return t[i]<t[s]||t[i]===t[s]&&n[e]<=n[r]}function ER(t,e,r){for(var n=t.heap[r],i=r<<1;i<=t.heap_len&&(i<t.heap_len&&zY(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!zY(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n}function HY(t,e,r){var n,i,s=0,o,a;if(t.last_lit!==0)do n=t.pending_buf[t.d_buf+s*2]<<8|t.pending_buf[t.d_buf+s*2+1],i=t.pending_buf[t.l_buf+s],s++,n===0?dc(t,i,e):(o=Bg[i],dc(t,o+Mg+1,e),a=SR[o],a!==0&&(i-=xR[o],ds(t,i,a)),n--,o=iX(n),dc(t,o,r),a=mw[o],a!==0&&(n-=ww[o],ds(t,n,a)));while(s<t.last_lit);dc(t,TR,e)}function AR(t,e){var r=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,s=e.stat_desc.elems,o,a,c=-1,u;for(t.heap_len=0,t.heap_max=XY,o=0;o<s;o++)r[o*2]!==0?(t.heap[++t.heap_len]=c=o,t.depth[o]=0):r[o*2+1]=0;for(;t.heap_len<2;)u=t.heap[++t.heap_len]=c<2?++c:0,r[u*2]=1,t.depth[u]=0,t.opt_len--,i&&(t.static_len-=n[u*2+1]);for(e.max_code=c,o=t.heap_len>>1;o>=1;o--)ER(t,r,o);u=s;do o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],ER(t,r,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,r[u*2]=r[o*2]+r[a*2],t.depth[u]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,r[o*2+1]=r[a*2+1]=u,t.heap[1]=u++,ER(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],jBe(t,e),oX(r,c,t.bl_count)}function $Y(t,e,r){var n,i=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),e[(r+1)*2+1]=65535,n=0;n<=r;n++)s=o,o=e[(n+1)*2+1],!(++a<c&&s===o)&&(a<u?t.bl_tree[s*2]+=a:s!==0?(s!==i&&t.bl_tree[s*2]++,t.bl_tree[QY*2]++):a<=10?t.bl_tree[ZY*2]++:t.bl_tree[JY*2]++,a=0,i=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4))}function GY(t,e,r){var n,i=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),n=0;n<=r;n++)if(s=o,o=e[(n+1)*2+1],!(++a<c&&s===o)){if(a<u)do dc(t,s,t.bl_tree);while(--a!==0);else s!==0?(s!==i&&(dc(t,s,t.bl_tree),a--),dc(t,QY,t.bl_tree),ds(t,a-3,2)):a<=10?(dc(t,ZY,t.bl_tree),ds(t,a-3,3)):(dc(t,JY,t.bl_tree),ds(t,a-11,7));a=0,i=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4)}}function HBe(t){var e;for($Y(t,t.dyn_ltree,t.l_desc.max_code),$Y(t,t.dyn_dtree,t.d_desc.max_code),AR(t,t.bl_desc),e=IR-1;e>=3&&t.bl_tree[eX[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e}function $Be(t,e,r,n){var i;for(ds(t,e-257,5),ds(t,r-1,5),ds(t,n-4,4),i=0;i<n;i++)ds(t,t.bl_tree[eX[i]*2+1],3);GY(t,t.dyn_ltree,e-1),GY(t,t.dyn_dtree,r-1)}function GBe(t){var e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return jY;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return VY;for(r=32;r<Mg;r++)if(t.dyn_ltree[r*2]!==0)return VY;return jY}var WY=!1;function WBe(t){WY||(VBe(),WY=!0),t.l_desc=new vR(t.dyn_ltree,tX),t.d_desc=new vR(t.dyn_dtree,rX),t.bl_desc=new vR(t.bl_tree,nX),t.bi_buf=0,t.bi_valid=0,aX(t)}function uX(t,e,r,n){ds(t,(NBe<<1)+(n?1:0),3),zBe(t,e,r,!0)}function YBe(t){ds(t,YY<<1,3),dc(t,TR,pu),KBe(t)}function XBe(t,e,r,n){var i,s,o=0;t.level>0?(t.strm.data_type===DBe&&(t.strm.data_type=GBe(t)),AR(t,t.l_desc),AR(t,t.d_desc),o=HBe(t),i=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=i&&(i=s)):i=s=r+5,r+4<=i&&e!==-1?uX(t,e,r,n):t.strategy===kBe||s===i?(ds(t,(YY<<1)+(n?1:0),3),HY(t,pu,kg)):(ds(t,(BBe<<1)+(n?1:0),3),$Be(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),HY(t,t.dyn_ltree,t.dyn_dtree)),aX(t),n&&cX(t)}function QBe(t,e,r){return t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(Bg[r]+Mg+1)*2]++,t.dyn_dtree[iX(e)*2]++),t.last_lit===t.lit_bufsize-1}L0._tr_init=WBe;L0._tr_stored_block=uX;L0._tr_flush_block=XBe;L0._tr_tally=QBe;L0._tr_align=YBe});var PR=g((x4t,fX)=>{"use strict";function ZBe(t,e,r,n){for(var i=t&65535|0,s=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+e[n++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0}fX.exports=ZBe});var CR=g((P4t,hX)=>{"use strict";function JBe(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e}var eLe=JBe();function tLe(t,e,r,n){var i=eLe,s=n+r;t^=-1;for(var o=n;o<s;o++)t=t>>>8^i[(t^e[o])&255];return t^-1}hX.exports=tLe});var bw=g((C4t,dX)=>{"use strict";dX.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var EX=g(gc=>{"use strict";var $i=du(),bo=lX(),mX=PR(),Ul=CR(),rLe=bw(),Nh=0,nLe=1,iLe=3,Vl=4,pX=5,yc=0,yX=1,_o=-2,sLe=-3,OR=-5,oLe=-1,aLe=1,_w=2,cLe=3,uLe=4,lLe=0,fLe=2,Aw=8,hLe=9,dLe=15,pLe=8,yLe=29,gLe=256,DR=gLe+1+yLe,mLe=30,wLe=19,bLe=2*DR+1,_Le=15,Vt=3,Kl=258,pa=Kl+Vt+1,vLe=32,Rw=42,NR=69,vw=73,Ew=91,Sw=103,Oh=113,qg=666,zn=1,Fg=2,kh=3,q0=4,ELe=3;function jl(t,e){return t.msg=rLe[e],e}function gX(t){return(t<<1)-(t>4?9:0)}function Fl(t){for(var e=t.length;--e>=0;)t[e]=0}function ql(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&($i.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))}function mi(t,e){bo._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,ql(t.strm)}function nr(t,e){t.pending_buf[t.pending++]=e}function Ug(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255}function SLe(t,e,r,n){var i=t.avail_in;return i>n&&(i=n),i===0?0:(t.avail_in-=i,$i.arraySet(e,t.input,t.next_in,i,r),t.state.wrap===1?t.adler=mX(t.adler,e,i,r):t.state.wrap===2&&(t.adler=Ul(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)}function wX(t,e){var r=t.max_chain_length,n=t.strstart,i,s,o=t.prev_length,a=t.nice_match,c=t.strstart>t.w_size-pa?t.strstart-(t.w_size-pa):0,u=t.window,l=t.w_mask,f=t.prev,h=t.strstart+Kl,d=u[n+o-1],p=u[n+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do if(i=e,!(u[i+o]!==p||u[i+o-1]!==d||u[i]!==u[n]||u[++i]!==u[n+1])){n+=2,i++;do;while(u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&n<h);if(s=Kl-(h-n),n=h-Kl,s>o){if(t.match_start=e,o=s,s>=a)break;d=u[n+o-1],p=u[n+o]}}while((e=f[e&l])>c&&--r!==0);return o<=t.lookahead?o:t.lookahead}function Dh(t){var e=t.w_size,r,n,i,s,o;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-pa)){$i.arraySet(t.window,t.window,e,e,0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,r=n;do i=t.head[--r],t.head[r]=i>=e?i-e:0;while(--n);n=e,r=n;do i=t.prev[--r],t.prev[r]=i>=e?i-e:0;while(--n);s+=e}if(t.strm.avail_in===0)break;if(n=SLe(t.strm,t.window,t.strstart+t.lookahead,s),t.lookahead+=n,t.lookahead+t.insert>=Vt)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+Vt-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<Vt)););}while(t.lookahead<pa&&t.strm.avail_in!==0)}function ALe(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Dh(t),t.lookahead===0&&e===Nh)return zn;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+r;if((t.strstart===0||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,mi(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-pa&&(mi(t,!1),t.strm.avail_out===0))return zn}return t.insert=0,e===Vl?(mi(t,!0),t.strm.avail_out===0?kh:q0):(t.strstart>t.block_start&&(mi(t,!1),t.strm.avail_out===0),zn)}function kR(t,e){for(var r,n;;){if(t.lookahead<pa){if(Dh(t),t.lookahead<pa&&e===Nh)return zn;if(t.lookahead===0)break}if(r=0,t.lookahead>=Vt&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Vt-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-pa&&(t.match_length=wX(t,r)),t.match_length>=Vt)if(n=bo._tr_tally(t,t.strstart-t.match_start,t.match_length-Vt),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Vt){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Vt-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=bo._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(mi(t,!1),t.strm.avail_out===0))return zn}return t.insert=t.strstart<Vt-1?t.strstart:Vt-1,e===Vl?(mi(t,!0),t.strm.avail_out===0?kh:q0):t.last_lit&&(mi(t,!1),t.strm.avail_out===0)?zn:Fg}function M0(t,e){for(var r,n,i;;){if(t.lookahead<pa){if(Dh(t),t.lookahead<pa&&e===Nh)return zn;if(t.lookahead===0)break}if(r=0,t.lookahead>=Vt&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Vt-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Vt-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-pa&&(t.match_length=wX(t,r),t.match_length<=5&&(t.strategy===aLe||t.match_length===Vt&&t.strstart-t.match_start>4096)&&(t.match_length=Vt-1)),t.prev_length>=Vt&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-Vt,n=bo._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-Vt),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Vt-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=Vt-1,t.strstart++,n&&(mi(t,!1),t.strm.avail_out===0))return zn}else if(t.match_available){if(n=bo._tr_tally(t,0,t.window[t.strstart-1]),n&&mi(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return zn}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=bo._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Vt-1?t.strstart:Vt-1,e===Vl?(mi(t,!0),t.strm.avail_out===0?kh:q0):t.last_lit&&(mi(t,!1),t.strm.avail_out===0)?zn:Fg}function RLe(t,e){for(var r,n,i,s,o=t.window;;){if(t.lookahead<=Kl){if(Dh(t),t.lookahead<=Kl&&e===Nh)return zn;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Vt&&t.strstart>0&&(i=t.strstart-1,n=o[i],n===o[++i]&&n===o[++i]&&n===o[++i])){s=t.strstart+Kl;do;while(n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&i<s);t.match_length=Kl-(s-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Vt?(r=bo._tr_tally(t,1,t.match_length-Vt),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=bo._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(mi(t,!1),t.strm.avail_out===0))return zn}return t.insert=0,e===Vl?(mi(t,!0),t.strm.avail_out===0?kh:q0):t.last_lit&&(mi(t,!1),t.strm.avail_out===0)?zn:Fg}function ILe(t,e){for(var r;;){if(t.lookahead===0&&(Dh(t),t.lookahead===0)){if(e===Nh)return zn;break}if(t.match_length=0,r=bo._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(mi(t,!1),t.strm.avail_out===0))return zn}return t.insert=0,e===Vl?(mi(t,!0),t.strm.avail_out===0?kh:q0):t.last_lit&&(mi(t,!1),t.strm.avail_out===0)?zn:Fg}function pc(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}var U0;U0=[new pc(0,0,0,0,ALe),new pc(4,4,8,4,kR),new pc(4,5,16,8,kR),new pc(4,6,32,32,kR),new pc(4,4,16,16,M0),new pc(8,16,32,32,M0),new pc(8,16,128,128,M0),new pc(8,32,128,256,M0),new pc(32,128,258,1024,M0),new pc(32,258,258,4096,M0)];function TLe(t){t.window_size=2*t.w_size,Fl(t.head),t.max_lazy_match=U0[t.level].max_lazy,t.good_match=U0[t.level].good_length,t.nice_match=U0[t.level].nice_length,t.max_chain_length=U0[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Vt-1,t.match_available=0,t.ins_h=0}function xLe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Aw,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new $i.Buf16(bLe*2),this.dyn_dtree=new $i.Buf16((2*mLe+1)*2),this.bl_tree=new $i.Buf16((2*wLe+1)*2),Fl(this.dyn_ltree),Fl(this.dyn_dtree),Fl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new $i.Buf16(_Le+1),this.heap=new $i.Buf16(2*DR+1),Fl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new $i.Buf16(2*DR+1),Fl(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function bX(t){var e;return!t||!t.state?jl(t,_o):(t.total_in=t.total_out=0,t.data_type=fLe,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?Rw:Oh,t.adler=e.wrap===2?0:1,e.last_flush=Nh,bo._tr_init(e),yc)}function _X(t){var e=bX(t);return e===yc&&TLe(t.state),e}function PLe(t,e){return!t||!t.state||t.state.wrap!==2?_o:(t.state.gzhead=e,yc)}function vX(t,e,r,n,i,s){if(!t)return _o;var o=1;if(e===oLe&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),i<1||i>hLe||r!==Aw||n<8||n>15||e<0||e>9||s<0||s>uLe)return jl(t,_o);n===8&&(n=9);var a=new xLe;return t.state=a,a.strm=t,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Vt-1)/Vt),a.window=new $i.Buf8(a.w_size*2),a.head=new $i.Buf16(a.hash_size),a.prev=new $i.Buf16(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new $i.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=e,a.strategy=s,a.method=r,_X(t)}function CLe(t,e){return vX(t,e,Aw,dLe,pLe,lLe)}function OLe(t,e){var r,n,i,s;if(!t||!t.state||e>pX||e<0)return t?jl(t,_o):_o;if(n=t.state,!t.output||!t.input&&t.avail_in!==0||n.status===qg&&e!==Vl)return jl(t,t.avail_out===0?OR:_o);if(n.strm=t,r=n.last_flush,n.last_flush=e,n.status===Rw)if(n.wrap===2)t.adler=0,nr(n,31),nr(n,139),nr(n,8),n.gzhead?(nr(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),nr(n,n.gzhead.time&255),nr(n,n.gzhead.time>>8&255),nr(n,n.gzhead.time>>16&255),nr(n,n.gzhead.time>>24&255),nr(n,n.level===9?2:n.strategy>=_w||n.level<2?4:0),nr(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(nr(n,n.gzhead.extra.length&255),nr(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=Ul(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=NR):(nr(n,0),nr(n,0),nr(n,0),nr(n,0),nr(n,0),nr(n,n.level===9?2:n.strategy>=_w||n.level<2?4:0),nr(n,ELe),n.status=Oh);else{var o=Aw+(n.w_bits-8<<4)<<8,a=-1;n.strategy>=_w||n.level<2?a=0:n.level<6?a=1:n.level===6?a=2:a=3,o|=a<<6,n.strstart!==0&&(o|=vLe),o+=31-o%31,n.status=Oh,Ug(n,o),n.strstart!==0&&(Ug(n,t.adler>>>16),Ug(n,t.adler&65535)),t.adler=1}if(n.status===NR)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(n.gzhead.extra.length&65535)&&!(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(t.adler=Ul(t.adler,n.pending_buf,n.pending-i,i)),ql(t),i=n.pending,n.pending===n.pending_buf_size));)nr(n,n.gzhead.extra[n.gzindex]&255),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(t.adler=Ul(t.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=vw)}else n.status=vw;if(n.status===vw)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(t.adler=Ul(t.adler,n.pending_buf,n.pending-i,i)),ql(t),i=n.pending,n.pending===n.pending_buf_size)){s=1;break}n.gzindex<n.gzhead.name.length?s=n.gzhead.name.charCodeAt(n.gzindex++)&255:s=0,nr(n,s)}while(s!==0);n.gzhead.hcrc&&n.pending>i&&(t.adler=Ul(t.adler,n.pending_buf,n.pending-i,i)),s===0&&(n.gzindex=0,n.status=Ew)}else n.status=Ew;if(n.status===Ew)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(t.adler=Ul(t.adler,n.pending_buf,n.pending-i,i)),ql(t),i=n.pending,n.pending===n.pending_buf_size)){s=1;break}n.gzindex<n.gzhead.comment.length?s=n.gzhead.comment.charCodeAt(n.gzindex++)&255:s=0,nr(n,s)}while(s!==0);n.gzhead.hcrc&&n.pending>i&&(t.adler=Ul(t.adler,n.pending_buf,n.pending-i,i)),s===0&&(n.status=Sw)}else n.status=Sw;if(n.status===Sw&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&ql(t),n.pending+2<=n.pending_buf_size&&(nr(n,t.adler&255),nr(n,t.adler>>8&255),t.adler=0,n.status=Oh)):n.status=Oh),n.pending!==0){if(ql(t),t.avail_out===0)return n.last_flush=-1,yc}else if(t.avail_in===0&&gX(e)<=gX(r)&&e!==Vl)return jl(t,OR);if(n.status===qg&&t.avail_in!==0)return jl(t,OR);if(t.avail_in!==0||n.lookahead!==0||e!==Nh&&n.status!==qg){var c=n.strategy===_w?ILe(n,e):n.strategy===cLe?RLe(n,e):U0[n.level].func(n,e);if((c===kh||c===q0)&&(n.status=qg),c===zn||c===kh)return t.avail_out===0&&(n.last_flush=-1),yc;if(c===Fg&&(e===nLe?bo._tr_align(n):e!==pX&&(bo._tr_stored_block(n,0,0,!1),e===iLe&&(Fl(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),ql(t),t.avail_out===0))return n.last_flush=-1,yc}return e!==Vl?yc:n.wrap<=0?yX:(n.wrap===2?(nr(n,t.adler&255),nr(n,t.adler>>8&255),nr(n,t.adler>>16&255),nr(n,t.adler>>24&255),nr(n,t.total_in&255),nr(n,t.total_in>>8&255),nr(n,t.total_in>>16&255),nr(n,t.total_in>>24&255)):(Ug(n,t.adler>>>16),Ug(n,t.adler&65535)),ql(t),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?yc:yX)}function kLe(t){var e;return!t||!t.state?_o:(e=t.state.status,e!==Rw&&e!==NR&&e!==vw&&e!==Ew&&e!==Sw&&e!==Oh&&e!==qg?jl(t,_o):(t.state=null,e===Oh?jl(t,sLe):yc))}function DLe(t,e){var r=e.length,n,i,s,o,a,c,u,l;if(!t||!t.state||(n=t.state,o=n.wrap,o===2||o===1&&n.status!==Rw||n.lookahead))return _o;for(o===1&&(t.adler=mX(t.adler,e,r,0)),n.wrap=0,r>=n.w_size&&(o===0&&(Fl(n.head),n.strstart=0,n.block_start=0,n.insert=0),l=new $i.Buf8(n.w_size),$i.arraySet(l,e,r-n.w_size,n.w_size,0),e=l,r=n.w_size),a=t.avail_in,c=t.next_in,u=t.input,t.avail_in=r,t.next_in=0,t.input=e,Dh(n);n.lookahead>=Vt;){i=n.strstart,s=n.lookahead-(Vt-1);do n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+Vt-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++;while(--s);n.strstart=i,n.lookahead=Vt-1,Dh(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Vt-1,n.match_available=0,t.next_in=c,t.input=u,t.avail_in=a,n.wrap=o,yc}gc.deflateInit=CLe;gc.deflateInit2=vX;gc.deflateReset=_X;gc.deflateResetKeep=bX;gc.deflateSetHeader=PLe;gc.deflate=OLe;gc.deflateEnd=kLe;gc.deflateSetDictionary=DLe;gc.deflateInfo="pako deflate (from Nodeca project)"});var BR=g(F0=>{"use strict";var Iw=du(),SX=!0,AX=!0;try{String.fromCharCode.apply(null,[0])}catch{SX=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{AX=!1}var Kg=new Iw.Buf8(256);for(yu=0;yu<256;yu++)Kg[yu]=yu>=252?6:yu>=248?5:yu>=240?4:yu>=224?3:yu>=192?2:1;var yu;Kg[254]=Kg[254]=1;F0.string2buf=function(t){var e,r,n,i,s,o=t.length,a=0;for(i=0;i<o;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Iw.Buf8(a),s=0,i=0;s<a;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};function RX(t,e){if(e<65534&&(t.subarray&&AX||!t.subarray&&SX))return String.fromCharCode.apply(null,Iw.shrinkBuf(t,e));for(var r="",n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r}F0.buf2binstring=function(t){return RX(t,t.length)};F0.binstring2buf=function(t){for(var e=new Iw.Buf8(t.length),r=0,n=e.length;r<n;r++)e[r]=t.charCodeAt(r);return e};F0.buf2string=function(t,e){var r,n,i,s,o=e||t.length,a=new Array(o*2);for(n=0,r=0;r<o;){if(i=t[r++],i<128){a[n++]=i;continue}if(s=Kg[i],s>4){a[n++]=65533,r+=s-1;continue}for(i&=s===2?31:s===3?15:7;s>1&&r<o;)i=i<<6|t[r++]&63,s--;if(s>1){a[n++]=65533;continue}i<65536?a[n++]=i:(i-=65536,a[n++]=55296|i>>10&1023,a[n++]=56320|i&1023)}return RX(a,n)};F0.utf8border=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Kg[t[r]]>e?r:e}});var LR=g((D4t,IX)=>{"use strict";function NLe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}IX.exports=NLe});var CX=g(zg=>{"use strict";var jg=EX(),Vg=du(),UR=BR(),qR=bw(),BLe=LR(),PX=Object.prototype.toString,LLe=0,MR=4,K0=0,TX=1,xX=2,MLe=-1,ULe=0,qLe=8;function Bh(t){if(!(this instanceof Bh))return new Bh(t);this.options=Vg.assign({level:MLe,method:qLe,chunkSize:16384,windowBits:15,memLevel:8,strategy:ULe,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new BLe,this.strm.avail_out=0;var r=jg.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==K0)throw new Error(qR[r]);if(e.header&&jg.deflateSetHeader(this.strm,e.header),e.dictionary){var n;if(typeof e.dictionary=="string"?n=UR.string2buf(e.dictionary):PX.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,r=jg.deflateSetDictionary(this.strm,n),r!==K0)throw new Error(qR[r]);this._dict_set=!0}}Bh.prototype.push=function(t,e){var r=this.strm,n=this.options.chunkSize,i,s;if(this.ended)return!1;s=e===~~e?e:e===!0?MR:LLe,typeof t=="string"?r.input=UR.string2buf(t):PX.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new Vg.Buf8(n),r.next_out=0,r.avail_out=n),i=jg.deflate(r,s),i!==TX&&i!==K0)return this.onEnd(i),this.ended=!0,!1;(r.avail_out===0||r.avail_in===0&&(s===MR||s===xX))&&(this.options.to==="string"?this.onData(UR.buf2binstring(Vg.shrinkBuf(r.output,r.next_out))):this.onData(Vg.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||r.avail_out===0)&&i!==TX);return s===MR?(i=jg.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===K0):(s===xX&&(this.onEnd(K0),r.avail_out=0),!0)};Bh.prototype.onData=function(t){this.chunks.push(t)};Bh.prototype.onEnd=function(t){t===K0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Vg.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function FR(t,e){var r=new Bh(e);if(r.push(t,!0),r.err)throw r.msg||qR[r.err];return r.result}function FLe(t,e){return e=e||{},e.raw=!0,FR(t,e)}function KLe(t,e){return e=e||{},e.gzip=!0,FR(t,e)}zg.Deflate=Bh;zg.deflate=FR;zg.deflateRaw=FLe;zg.gzip=KLe});var kX=g((B4t,OX)=>{"use strict";var Tw=30,jLe=12;OX.exports=function(e,r){var n,i,s,o,a,c,u,l,f,h,d,p,y,b,m,_,R,k,P,x,D,U,M,ae,ne;n=e.state,i=e.next_in,ae=e.input,s=i+(e.avail_in-5),o=e.next_out,ne=e.output,a=o-(r-e.avail_out),c=o+(e.avail_out-257),u=n.dmax,l=n.wsize,f=n.whave,h=n.wnext,d=n.window,p=n.hold,y=n.bits,b=n.lencode,m=n.distcode,_=(1<<n.lenbits)-1,R=(1<<n.distbits)-1;e:do{y<15&&(p+=ae[i++]<<y,y+=8,p+=ae[i++]<<y,y+=8),k=b[p&_];t:for(;;){if(P=k>>>24,p>>>=P,y-=P,P=k>>>16&255,P===0)ne[o++]=k&65535;else if(P&16){x=k&65535,P&=15,P&&(y<P&&(p+=ae[i++]<<y,y+=8),x+=p&(1<<P)-1,p>>>=P,y-=P),y<15&&(p+=ae[i++]<<y,y+=8,p+=ae[i++]<<y,y+=8),k=m[p&R];r:for(;;){if(P=k>>>24,p>>>=P,y-=P,P=k>>>16&255,P&16){if(D=k&65535,P&=15,y<P&&(p+=ae[i++]<<y,y+=8,y<P&&(p+=ae[i++]<<y,y+=8)),D+=p&(1<<P)-1,D>u){e.msg="invalid distance too far back",n.mode=Tw;break e}if(p>>>=P,y-=P,P=o-a,D>P){if(P=D-P,P>f&&n.sane){e.msg="invalid distance too far back",n.mode=Tw;break e}if(U=0,M=d,h===0){if(U+=l-P,P<x){x-=P;do ne[o++]=d[U++];while(--P);U=o-D,M=ne}}else if(h<P){if(U+=l+h-P,P-=h,P<x){x-=P;do ne[o++]=d[U++];while(--P);if(U=0,h<x){P=h,x-=P;do ne[o++]=d[U++];while(--P);U=o-D,M=ne}}}else if(U+=h-P,P<x){x-=P;do ne[o++]=d[U++];while(--P);U=o-D,M=ne}for(;x>2;)ne[o++]=M[U++],ne[o++]=M[U++],ne[o++]=M[U++],x-=3;x&&(ne[o++]=M[U++],x>1&&(ne[o++]=M[U++]))}else{U=o-D;do ne[o++]=ne[U++],ne[o++]=ne[U++],ne[o++]=ne[U++],x-=3;while(x>2);x&&(ne[o++]=ne[U++],x>1&&(ne[o++]=ne[U++]))}}else if((P&64)===0){k=m[(k&65535)+(p&(1<<P)-1)];continue r}else{e.msg="invalid distance code",n.mode=Tw;break e}break}}else if((P&64)===0){k=b[(k&65535)+(p&(1<<P)-1)];continue t}else if(P&32){n.mode=jLe;break e}else{e.msg="invalid literal/length code",n.mode=Tw;break e}break}}while(i<s&&o<c);x=y>>3,i-=x,y-=x<<3,p&=(1<<y)-1,e.next_in=i,e.next_out=o,e.avail_in=i<s?5+(s-i):5-(i-s),e.avail_out=o<c?257+(c-o):257-(o-c),n.hold=p,n.bits=y}});var qX=g((L4t,UX)=>{"use strict";var DX=du(),j0=15,NX=852,BX=592,LX=0,KR=1,MX=2,VLe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],zLe=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],HLe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],$Le=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];UX.exports=function(e,r,n,i,s,o,a,c){var u=c.bits,l=0,f=0,h=0,d=0,p=0,y=0,b=0,m=0,_=0,R=0,k,P,x,D,U,M=null,ae=0,ne,de=new DX.Buf16(j0+1),me=new DX.Buf16(j0+1),Ke=null,xe=0,Ue,ie,Ve;for(l=0;l<=j0;l++)de[l]=0;for(f=0;f<i;f++)de[r[n+f]]++;for(p=u,d=j0;d>=1&&de[d]===0;d--);if(p>d&&(p=d),d===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,c.bits=1,0;for(h=1;h<d&&de[h]===0;h++);for(p<h&&(p=h),m=1,l=1;l<=j0;l++)if(m<<=1,m-=de[l],m<0)return-1;if(m>0&&(e===LX||d!==1))return-1;for(me[1]=0,l=1;l<j0;l++)me[l+1]=me[l]+de[l];for(f=0;f<i;f++)r[n+f]!==0&&(a[me[r[n+f]]++]=f);if(e===LX?(M=Ke=a,ne=19):e===KR?(M=VLe,ae-=257,Ke=zLe,xe-=257,ne=256):(M=HLe,Ke=$Le,ne=-1),R=0,f=0,l=h,U=o,y=p,b=0,x=-1,_=1<<p,D=_-1,e===KR&&_>NX||e===MX&&_>BX)return 1;for(;;){Ue=l-b,a[f]<ne?(ie=0,Ve=a[f]):a[f]>ne?(ie=Ke[xe+a[f]],Ve=M[ae+a[f]]):(ie=32+64,Ve=0),k=1<<l-b,P=1<<y,h=P;do P-=k,s[U+(R>>b)+P]=Ue<<24|ie<<16|Ve|0;while(P!==0);for(k=1<<l-1;R&k;)k>>=1;if(k!==0?(R&=k-1,R+=k):R=0,f++,--de[l]===0){if(l===d)break;l=r[n+a[f]]}if(l>p&&(R&D)!==x){for(b===0&&(b=p),U+=h,y=l-b,m=1<<y;y+b<d&&(m-=de[y+b],!(m<=0));)y++,m<<=1;if(_+=1<<y,e===KR&&_>NX||e===MX&&_>BX)return 1;x=R&D,s[x]=p<<24|y<<16|U-o|0}}return R!==0&&(s[U+R]=l-b<<24|64<<16|0),c.bits=p,0}});var _Q=g(ya=>{"use strict";var Bs=du(),GR=PR(),mc=CR(),GLe=kX(),Hg=qX(),WLe=0,fQ=1,hQ=2,FX=4,YLe=5,xw=6,Lh=0,XLe=1,QLe=2,vo=-2,dQ=-3,WR=-4,ZLe=-5,KX=8,pQ=1,jX=2,VX=3,zX=4,HX=5,$X=6,GX=7,WX=8,YX=9,XX=10,Ow=11,gu=12,jR=13,QX=14,VR=15,ZX=16,JX=17,eQ=18,tQ=19,Pw=20,Cw=21,rQ=22,nQ=23,iQ=24,sQ=25,oQ=26,zR=27,aQ=28,cQ=29,$r=30,YR=31,JLe=32,eMe=852,tMe=592,rMe=15,nMe=rMe;function uQ(t){return(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24)}function iMe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Bs.Buf16(320),this.work=new Bs.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function yQ(t){var e;return!t||!t.state?vo:(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=pQ,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Bs.Buf32(eMe),e.distcode=e.distdyn=new Bs.Buf32(tMe),e.sane=1,e.back=-1,Lh)}function gQ(t){var e;return!t||!t.state?vo:(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,yQ(t))}function mQ(t,e){var r,n;return!t||!t.state||(n=t.state,e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?vo:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,gQ(t))}function wQ(t,e){var r,n;return t?(n=new iMe,t.state=n,n.window=null,r=mQ(t,e),r!==Lh&&(t.state=null),r):vo}function sMe(t){return wQ(t,nMe)}var lQ=!0,HR,$R;function oMe(t){if(lQ){var e;for(HR=new Bs.Buf32(512),$R=new Bs.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Hg(fQ,t.lens,0,288,HR,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Hg(hQ,t.lens,0,32,$R,0,t.work,{bits:5}),lQ=!1}t.lencode=HR,t.lenbits=9,t.distcode=$R,t.distbits=5}function bQ(t,e,r,n){var i,s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Bs.Buf8(s.wsize)),n>=s.wsize?(Bs.arraySet(s.window,e,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>n&&(i=n),Bs.arraySet(s.window,e,r-n,i,s.wnext),n-=i,n?(Bs.arraySet(s.window,e,r-n,n,0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0}function aMe(t,e){var r,n,i,s,o,a,c,u,l,f,h,d,p,y,b=0,m,_,R,k,P,x,D,U,M=new Bs.Buf8(4),ae,ne,de=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return vo;r=t.state,r.mode===gu&&(r.mode=jR),o=t.next_out,i=t.output,c=t.avail_out,s=t.next_in,n=t.input,a=t.avail_in,u=r.hold,l=r.bits,f=a,h=c,U=Lh;e:for(;;)switch(r.mode){case pQ:if(r.wrap===0){r.mode=jR;break}for(;l<16;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}if(r.wrap&2&&u===35615){r.check=0,M[0]=u&255,M[1]=u>>>8&255,r.check=mc(r.check,M,2,0),u=0,l=0,r.mode=jX;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=$r;break}if((u&15)!==KX){t.msg="unknown compression method",r.mode=$r;break}if(u>>>=4,l-=4,D=(u&15)+8,r.wbits===0)r.wbits=D;else if(D>r.wbits){t.msg="invalid window size",r.mode=$r;break}r.dmax=1<<D,t.adler=r.check=1,r.mode=u&512?XX:gu,u=0,l=0;break;case jX:for(;l<16;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}if(r.flags=u,(r.flags&255)!==KX){t.msg="unknown compression method",r.mode=$r;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=$r;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,r.check=mc(r.check,M,2,0)),u=0,l=0,r.mode=VX;case VX:for(;l<32;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}r.head&&(r.head.time=u),r.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,M[2]=u>>>16&255,M[3]=u>>>24&255,r.check=mc(r.check,M,4,0)),u=0,l=0,r.mode=zX;case zX:for(;l<16;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,r.check=mc(r.check,M,2,0)),u=0,l=0,r.mode=HX;case HX:if(r.flags&1024){for(;l<16;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,r.check=mc(r.check,M,2,0)),u=0,l=0}else r.head&&(r.head.extra=null);r.mode=$X;case $X:if(r.flags&1024&&(d=r.length,d>a&&(d=a),d&&(r.head&&(D=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),Bs.arraySet(r.head.extra,n,s,d,D)),r.flags&512&&(r.check=mc(r.check,n,d,s)),a-=d,s+=d,r.length-=d),r.length))break e;r.length=0,r.mode=GX;case GX:if(r.flags&2048){if(a===0)break e;d=0;do D=n[s+d++],r.head&&D&&r.length<65536&&(r.head.name+=String.fromCharCode(D));while(D&&d<a);if(r.flags&512&&(r.check=mc(r.check,n,d,s)),a-=d,s+=d,D)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=WX;case WX:if(r.flags&4096){if(a===0)break e;d=0;do D=n[s+d++],r.head&&D&&r.length<65536&&(r.head.comment+=String.fromCharCode(D));while(D&&d<a);if(r.flags&512&&(r.check=mc(r.check,n,d,s)),a-=d,s+=d,D)break e}else r.head&&(r.head.comment=null);r.mode=YX;case YX:if(r.flags&512){for(;l<16;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}if(u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=$r;break}u=0,l=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=gu;break;case XX:for(;l<32;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}t.adler=r.check=uQ(u),u=0,l=0,r.mode=Ow;case Ow:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=u,r.bits=l,QLe;t.adler=r.check=1,r.mode=gu;case gu:if(e===YLe||e===xw)break e;case jR:if(r.last){u>>>=l&7,l-=l&7,r.mode=zR;break}for(;l<3;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}switch(r.last=u&1,u>>>=1,l-=1,u&3){case 0:r.mode=QX;break;case 1:if(oMe(r),r.mode=Pw,e===xw){u>>>=2,l-=2;break e}break;case 2:r.mode=JX;break;case 3:t.msg="invalid block type",r.mode=$r}u>>>=2,l-=2;break;case QX:for(u>>>=l&7,l-=l&7;l<32;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=$r;break}if(r.length=u&65535,u=0,l=0,r.mode=VR,e===xw)break e;case VR:r.mode=ZX;case ZX:if(d=r.length,d){if(d>a&&(d=a),d>c&&(d=c),d===0)break e;Bs.arraySet(i,n,s,d,o),a-=d,s+=d,c-=d,o+=d,r.length-=d;break}r.mode=gu;break;case JX:for(;l<14;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}if(r.nlen=(u&31)+257,u>>>=5,l-=5,r.ndist=(u&31)+1,u>>>=5,l-=5,r.ncode=(u&15)+4,u>>>=4,l-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=$r;break}r.have=0,r.mode=eQ;case eQ:for(;r.have<r.ncode;){for(;l<3;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}r.lens[de[r.have++]]=u&7,u>>>=3,l-=3}for(;r.have<19;)r.lens[de[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,ae={bits:r.lenbits},U=Hg(WLe,r.lens,0,19,r.lencode,0,r.work,ae),r.lenbits=ae.bits,U){t.msg="invalid code lengths set",r.mode=$r;break}r.have=0,r.mode=tQ;case tQ:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[u&(1<<r.lenbits)-1],m=b>>>24,_=b>>>16&255,R=b&65535,!(m<=l);){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}if(R<16)u>>>=m,l-=m,r.lens[r.have++]=R;else{if(R===16){for(ne=m+2;l<ne;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}if(u>>>=m,l-=m,r.have===0){t.msg="invalid bit length repeat",r.mode=$r;break}D=r.lens[r.have-1],d=3+(u&3),u>>>=2,l-=2}else if(R===17){for(ne=m+3;l<ne;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}u>>>=m,l-=m,D=0,d=3+(u&7),u>>>=3,l-=3}else{for(ne=m+7;l<ne;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}u>>>=m,l-=m,D=0,d=11+(u&127),u>>>=7,l-=7}if(r.have+d>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=$r;break}for(;d--;)r.lens[r.have++]=D}}if(r.mode===$r)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=$r;break}if(r.lenbits=9,ae={bits:r.lenbits},U=Hg(fQ,r.lens,0,r.nlen,r.lencode,0,r.work,ae),r.lenbits=ae.bits,U){t.msg="invalid literal/lengths set",r.mode=$r;break}if(r.distbits=6,r.distcode=r.distdyn,ae={bits:r.distbits},U=Hg(hQ,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,ae),r.distbits=ae.bits,U){t.msg="invalid distances set",r.mode=$r;break}if(r.mode=Pw,e===xw)break e;case Pw:r.mode=Cw;case Cw:if(a>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=u,r.bits=l,GLe(t,h),o=t.next_out,i=t.output,c=t.avail_out,s=t.next_in,n=t.input,a=t.avail_in,u=r.hold,l=r.bits,r.mode===gu&&(r.back=-1);break}for(r.back=0;b=r.lencode[u&(1<<r.lenbits)-1],m=b>>>24,_=b>>>16&255,R=b&65535,!(m<=l);){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}if(_&&(_&240)===0){for(k=m,P=_,x=R;b=r.lencode[x+((u&(1<<k+P)-1)>>k)],m=b>>>24,_=b>>>16&255,R=b&65535,!(k+m<=l);){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}u>>>=k,l-=k,r.back+=k}if(u>>>=m,l-=m,r.back+=m,r.length=R,_===0){r.mode=oQ;break}if(_&32){r.back=-1,r.mode=gu;break}if(_&64){t.msg="invalid literal/length code",r.mode=$r;break}r.extra=_&15,r.mode=rQ;case rQ:if(r.extra){for(ne=r.extra;l<ne;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=nQ;case nQ:for(;b=r.distcode[u&(1<<r.distbits)-1],m=b>>>24,_=b>>>16&255,R=b&65535,!(m<=l);){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}if((_&240)===0){for(k=m,P=_,x=R;b=r.distcode[x+((u&(1<<k+P)-1)>>k)],m=b>>>24,_=b>>>16&255,R=b&65535,!(k+m<=l);){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}u>>>=k,l-=k,r.back+=k}if(u>>>=m,l-=m,r.back+=m,_&64){t.msg="invalid distance code",r.mode=$r;break}r.offset=R,r.extra=_&15,r.mode=iQ;case iQ:if(r.extra){for(ne=r.extra;l<ne;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=$r;break}r.mode=sQ;case sQ:if(c===0)break e;if(d=h-c,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=$r;break}d>r.wnext?(d-=r.wnext,p=r.wsize-d):p=r.wnext-d,d>r.length&&(d=r.length),y=r.window}else y=i,p=o-r.offset,d=r.length;d>c&&(d=c),c-=d,r.length-=d;do i[o++]=y[p++];while(--d);r.length===0&&(r.mode=Cw);break;case oQ:if(c===0)break e;i[o++]=r.length,c--,r.mode=Cw;break;case zR:if(r.wrap){for(;l<32;){if(a===0)break e;a--,u|=n[s++]<<l,l+=8}if(h-=c,t.total_out+=h,r.total+=h,h&&(t.adler=r.check=r.flags?mc(r.check,i,h,o-h):GR(r.check,i,h,o-h)),h=c,(r.flags?u:uQ(u))!==r.check){t.msg="incorrect data check",r.mode=$r;break}u=0,l=0}r.mode=aQ;case aQ:if(r.wrap&&r.flags){for(;l<32;){if(a===0)break e;a--,u+=n[s++]<<l,l+=8}if(u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=$r;break}u=0,l=0}r.mode=cQ;case cQ:U=XLe;break e;case $r:U=dQ;break e;case YR:return WR;case JLe:default:return vo}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=u,r.bits=l,(r.wsize||h!==t.avail_out&&r.mode<$r&&(r.mode<zR||e!==FX))&&bQ(t,t.output,t.next_out,h-t.avail_out)?(r.mode=YR,WR):(f-=t.avail_in,h-=t.avail_out,t.total_in+=f,t.total_out+=h,r.total+=h,r.wrap&&h&&(t.adler=r.check=r.flags?mc(r.check,i,h,t.next_out-h):GR(r.check,i,h,t.next_out-h)),t.data_type=r.bits+(r.last?64:0)+(r.mode===gu?128:0)+(r.mode===Pw||r.mode===VR?256:0),(f===0&&h===0||e===FX)&&U===Lh&&(U=ZLe),U)}function cMe(t){if(!t||!t.state)return vo;var e=t.state;return e.window&&(e.window=null),t.state=null,Lh}function uMe(t,e){var r;return!t||!t.state||(r=t.state,(r.wrap&2)===0)?vo:(r.head=e,e.done=!1,Lh)}function lMe(t,e){var r=e.length,n,i,s;return!t||!t.state||(n=t.state,n.wrap!==0&&n.mode!==Ow)?vo:n.mode===Ow&&(i=1,i=GR(i,e,r,0),i!==n.check)?dQ:(s=bQ(t,e,r,r),s?(n.mode=YR,WR):(n.havedict=1,Lh))}ya.inflateReset=gQ;ya.inflateReset2=mQ;ya.inflateResetKeep=yQ;ya.inflateInit=sMe;ya.inflateInit2=wQ;ya.inflate=aMe;ya.inflateEnd=cMe;ya.inflateGetHeader=uMe;ya.inflateSetDictionary=lMe;ya.inflateInfo="pako inflate (from Nodeca project)"});var XR=g((U4t,vQ)=>{"use strict";vQ.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var SQ=g((q4t,EQ)=>{"use strict";function fMe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}EQ.exports=fMe});var RQ=g(Gg=>{"use strict";var V0=_Q(),$g=du(),kw=BR(),vn=XR(),QR=bw(),hMe=LR(),dMe=SQ(),AQ=Object.prototype.toString;function Mh(t){if(!(this instanceof Mh))return new Mh(t);this.options=$g.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new hMe,this.strm.avail_out=0;var r=V0.inflateInit2(this.strm,e.windowBits);if(r!==vn.Z_OK)throw new Error(QR[r]);if(this.header=new dMe,V0.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=kw.string2buf(e.dictionary):AQ.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=V0.inflateSetDictionary(this.strm,e.dictionary),r!==vn.Z_OK)))throw new Error(QR[r])}Mh.prototype.push=function(t,e){var r=this.strm,n=this.options.chunkSize,i=this.options.dictionary,s,o,a,c,u,l=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?vn.Z_FINISH:vn.Z_NO_FLUSH,typeof t=="string"?r.input=kw.binstring2buf(t):AQ.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new $g.Buf8(n),r.next_out=0,r.avail_out=n),s=V0.inflate(r,vn.Z_NO_FLUSH),s===vn.Z_NEED_DICT&&i&&(s=V0.inflateSetDictionary(this.strm,i)),s===vn.Z_BUF_ERROR&&l===!0&&(s=vn.Z_OK,l=!1),s!==vn.Z_STREAM_END&&s!==vn.Z_OK)return this.onEnd(s),this.ended=!0,!1;r.next_out&&(r.avail_out===0||s===vn.Z_STREAM_END||r.avail_in===0&&(o===vn.Z_FINISH||o===vn.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=kw.utf8border(r.output,r.next_out),c=r.next_out-a,u=kw.buf2string(r.output,a),r.next_out=c,r.avail_out=n-c,c&&$g.arraySet(r.output,r.output,a,c,0),this.onData(u)):this.onData($g.shrinkBuf(r.output,r.next_out))),r.avail_in===0&&r.avail_out===0&&(l=!0)}while((r.avail_in>0||r.avail_out===0)&&s!==vn.Z_STREAM_END);return s===vn.Z_STREAM_END&&(o=vn.Z_FINISH),o===vn.Z_FINISH?(s=V0.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===vn.Z_OK):(o===vn.Z_SYNC_FLUSH&&(this.onEnd(vn.Z_OK),r.avail_out=0),!0)};Mh.prototype.onData=function(t){this.chunks.push(t)};Mh.prototype.onEnd=function(t){t===vn.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=$g.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function ZR(t,e){var r=new Mh(e);if(r.push(t,!0),r.err)throw r.msg||QR[r.err];return r.result}function pMe(t,e){return e=e||{},e.raw=!0,ZR(t,e)}Gg.Inflate=Mh;Gg.inflate=ZR;Gg.inflateRaw=pMe;Gg.ungzip=ZR});var xQ=g((K4t,TQ)=>{"use strict";var yMe=du().assign,gMe=CX(),mMe=RQ(),wMe=XR(),IQ={};yMe(IQ,gMe,mMe,wMe);TQ.exports=IQ});var CQ=g((j4t,PQ)=>{"use strict";var{concat:bMe}=(Pn(),se(Ui));async function _Me(t){let e=new Uint8Array(0);for await(let r of t)e=bMe([e,r],e.length+r.length);return e}PQ.exports=_Me});function kQ({repo:t,preload:e}){async function*r(n,i={}){if(i.compressionLevel!=null&&(i.compressionLevel<-1||i.compressionLevel>9))throw(0,z0.default)(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(i.preload!==!1){let a;try{a=Up(n).split("/")}catch(c){throw(0,z0.default)(c,"ERR_INVALID_PATH")}e(L.parse(a[0]))}let s=L.asCID(n)||n,o=await gi(s,t.blocks,i);if(o.type==="file"||o.type==="raw"){let a=[];!i.compress||i.archive===!0?a.push([{header:{name:o.path,mode:o.type==="file"&&o.unixfs.mode,mtime:o.type==="file"&&o.unixfs.mtime?new Date(o.unixfs.mtime.secs*1e3):void 0,size:o.size,type:"file"},body:o.content()}],(0,JR.pack)(),c=>(0,rI.default)(c,u=>u.slice())):a.push(o.content),i.compress&&a.push(async function*(c){let u=await(0,nI.default)(c);yield tI.default.gzip(u,{level:i.compressionLevel||OQ})}),yield*(0,eI.pipe)(...a);return}if(o.type==="directory"){let a=[hw(s,t.blocks,i),async function*(c){for await(let u of c){let l={header:{name:u.path,size:u.size}};if(u.type==="file")l.header.type="file",l.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,l.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0,l.body=u.content();else if(u.type==="raw")l.header.type="file",l.body=u.content();else if(u.type==="directory")l.header.type="directory",l.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,l.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0;else throw(0,z0.default)(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield l}},(0,JR.pack)(),c=>(0,rI.default)(c,u=>u.slice())];if(i.compress){if(!i.archive)throw(0,z0.default)(new Error("file is not regular"),"ERR_INVALID_PATH");i.compress&&a.push(async function*(c){let u=await(0,nI.default)(c);yield tI.default.gzip(u,{level:i.compressionLevel||OQ})})}yield*(0,eI.pipe)(...a);return}throw(0,z0.default)(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return Q(r)}var z0,JR,eI,tI,rI,nI,OQ,DQ=w(()=>{da();z0=A(oe(),1);ti();Ce();Se();JR=A(KY(),1),eI=A(br(),1),tI=A(xQ(),1),rI=A(xi(),1),nI=A(CQ(),1),OQ=6});function BQ({repo:t,preload:e}){async function*r(n,i={}){let s=Up(n),o=s.split("/");i.preload!==!1&&e(L.parse(o[0]));let a=L.asCID(s)||s,c=await gi(a,t.blocks,i);if(c.type==="file"){yield n9(c);return}if(c.type==="directory"){for await(let u of c.content())yield n9(u);return}throw(0,NQ.default)(new Error(`Unknown UnixFS type ${c.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return Q(r)}var NQ,LQ=w(()=>{da();NQ=A(oe(),1);ti();Ce();Se()});var iI,MQ=w(()=>{Y$();WW();AY();DQ();LQ();iI=class{constructor({preload:e,repo:r,hashers:n,options:i}){let s=GW({preload:e,repo:r,options:i,hashers:n});this.addAll=s,this.add=W$({addAll:s}),this.cat=SY({repo:r,preload:e}),this.get=kQ({repo:r,preload:e}),this.ls=BQ({repo:r,preload:e})}}});var Uh,UQ,qQ,Dw=w(()=>{Uh="0.14.3",UQ="",qQ="^0.154.3"});function FQ({repo:t}){async function e(r={}){let n=await t.version.get();return{version:Uh,commit:UQ,repo:`${n}`,"ipfs-core":Uh,"interface-ipfs-core":qQ}}return Q(e)}var KQ=w(()=>{Dw();Ce()});function HQ({peerId:t,network:e}){async function r(n={}){let i=e.try();if(!i){if(n.peerId)throw new cl;return{id:t.toB58String(),publicKey:Xe(t.pubKey.bytes,"base64pad"),addresses:[],agentVersion:`js-ipfs/${Uh}`,protocolVersion:"9000",protocols:[]}}let{libp2p:s}=i,o=n.peerId?VQ.default.parse(n.peerId):t,a=await EMe(o,s,n),c=Xe(a.metadata.get("AgentVersion")||new Uint8Array),u=Xe(a.metadata.get("ProtocolVersion")||new Uint8Array),l=a.id.toB58String(),f=a.publicKey?Xe(a.publicKey.bytes,"base64pad"):"";return{id:l,publicKey:f,addresses:(a.addresses||[]).map(h=>{let d=h.toString();return d.endsWith(`/p2p/${l}`)?d:`${d}/p2p/${l}`}).sort().map(h=>new jQ.Multiaddr(h)),agentVersion:c,protocolVersion:u,protocols:(a.protocols||[]).sort()}}return Q(r)}async function EMe(t,e,r){let n=await e.peerStore.get(t);n||(n=await SMe(t,e,r));let i=t.pubKey?t.pubKey:await e.peerStore.keyBook.get(t);if(!i)try{i=await e._dht.getPublicKey(t,r)}catch(s){vMe.error("Could not load public key for",t.toB58String(),s)}return{...n,publicKey:i,metadata:n.metadata||new Map,addresses:n.addresses.map(s=>s.multiaddr)}}async function SMe(t,e,r){for await(let i of e._dht.findPeer(t,r))if(i.name==="FINAL_PEER")break;let n=await e.peerStore.get(t);if(!n)throw(0,zQ.default)(new Error("Could not find peer"),"ERR_NOT_FOUND");return n}var jQ,VQ,zQ,sI,vMe,$Q=w(()=>{Dw();jQ=A(yt(),1);Ce();st();VQ=A(ft(),1);ul();zQ=A(oe(),1),sI=A(he(),1),vMe=Object.assign((0,sI.default)("ipfs:components:id"),{error:(0,sI.default)("ipfs:components:id:error")})});var oI=g((p6t,WQ)=>{WQ.exports=AMe;function AMe(t,e,r){var n,i;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(i=n.pop(),!i)return!1;GQ(i);for(var s;s=n.shift();)if(GQ(s),typeof t[s]>"u"&&(t[s]={}),t=t[s],!t||typeof t!="object")return!1;return t[i]=r,!0}function GQ(t){if(t==="__proto__"||t==="constructor"||t==="prototype")throw new Error("setting of prototype values not supported")}});var sn,H0,aI=w(()=>{sn=A(oI(),1);k5();H0={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:t=>((0,sn.default)(t,"Discovery.MDNS.Enabled",!1),(0,sn.default)(t,"Discovery.webRTCStar.Enabled",!1),t.Swarm={...t.Swarm||{},DisableNatPortMap:!0},t)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:t=>((0,sn.default)(t,"Discovery.MDNS.Enabled",!0),(0,sn.default)(t,"Discovery.webRTCStar.Enabled",!0),(0,sn.default)(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!1}),t)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:t=>{let e=uu();return(0,sn.default)(t,"Addresses.API",e.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),(0,sn.default)(t,"Addresses.Gateway",e.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),(0,sn.default)(t,"Addresses.Swarm",e.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),(0,sn.default)(t,"Addresses.Delegates",[]),(0,sn.default)(t,"Bootstrap",[]),(0,sn.default)(t,"Discovery.MDNS.Enabled",!1),(0,sn.default)(t,"Discovery.webRTCStar.Enabled",!1),(0,sn.default)(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!0}),t}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:t=>{let e=uu();return(0,sn.default)(t,"Addresses.API",e.Addresses.API),(0,sn.default)(t,"Addresses.Gateway",e.Addresses.Gateway),(0,sn.default)(t,"Addresses.Swarm",e.Addresses.Swarm),(0,sn.default)(t,"Addresses.Delegates",e.Addresses.Delegates),(0,sn.default)(t,"Bootstrap",e.Bootstrap),(0,sn.default)(t,"Discovery.MDNS.Enabled",e.Discovery.MDNS.Enabled),(0,sn.default)(t,"Discovery.webRTCStar.Enabled",e.Discovery.webRTCStar.Enabled),(0,sn.default)(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!1}),t}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:t=>{let e=t.Swarm||{},r=e.ConnMgr||{};return r.LowWater=20,r.HighWater=40,e.ConnMgr=r,t.Swarm=e,t}},"default-power":{description:'Inverse of "lowpower" profile.',transform:t=>{let e=uu();return t.Swarm=e.Swarm,t}}}});function XQ({repo:t}){return{getAll:Q(e),get:Q(r),set:Q(n),replace:Q(i),profiles:{apply:Q(s),list:Q(IMe)}};async function e(o={}){return t.config.getAll(o)}async function r(o,a){return o?t.config.get(o,a):Promise.reject(new Error("key argument is required"))}async function n(o,a,c){return t.config.set(o,a,c)}async function i(o,a){return t.config.replace(o,a)}async function s(o,a={dryRun:!1}){let{dryRun:c}=a,u=H0[o];if(!u)throw new Error(`No profile with name '${o}' exists`);try{let l=await t.config.getAll(a),f=JSON.parse(JSON.stringify(l));return f=u.transform(f),c||await t.config.replace(f,a),delete l.Identity.PrivKey,delete f.Identity.PrivKey,{original:l,updated:f}}catch(l){throw RMe(l),new Error(`Could not apply profile '${o}' to config: ${l.message}`)}}}async function IMe(t){return Object.keys(H0).map(e=>({name:e,description:H0[e].description}))}var YQ,RMe,QQ=w(()=>{Ce();YQ=A(he(),1);aI();RMe=(0,YQ.default)("ipfs:core:config")});var Nw,cI,uI,TMe,ZQ,$0,Bw=w(()=>{vp();Nw=({enumerable:t=!0,configurable:e=!1}={})=>({enumerable:t,configurable:e,writable:!1}),cI=function*(t,e){if(t!=null&&!(t instanceof Uint8Array))for(let[r,n]of Object.entries(t)){let i=[...e,r];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[s,o]of n.entries()){let a=[...i,s],c=L.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*cI(o,a))}else{let s=L.asCID(n);s?yield[i.join("/"),s]:yield*cI(n,i)}}},uI=function*(t,e){if(t!=null)for(let[r,n]of Object.entries(t)){let i=[...e,r];if(yield i.join("/"),n!=null&&!(n instanceof Uint8Array)&&typeof n=="object"&&!L.asCID(n))if(Array.isArray(n))for(let[s,o]of n.entries()){let a=[...i,s];yield a.join("/"),typeof o=="object"&&!L.asCID(o)&&(yield*uI(o,a))}else yield*uI(n,i)}},TMe=(t,e)=>{let r=t;for(let[n,i]of e.entries()){if(r=r[i],r==null)throw new Error(`Object has no property at ${e.slice(0,n+1).map(o=>`[${JSON.stringify(o)}]`).join("")}`);let s=L.asCID(r);if(s)return{value:s,remaining:e.slice(n+1).join("/")}}return{value:r}},ZQ=class{constructor({cid:e,bytes:r,value:n}){if(!e||!r||typeof n>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=r,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:Nw(),bytes:Nw(),value:Nw(),asBlock:Nw()})}links(){return cI(this.value,[])}tree(){return uI(this.value,[])}get(e="/"){return TMe(this.value,e.split("/").filter(Boolean))}},$0=({bytes:t,cid:e,value:r,codec:n})=>{let i=r!==void 0?r:n&&n.decode(t);if(i===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new ZQ({cid:e,bytes:t,value:i})}});function fI(t){let e=aE({version:1,roots:t}),r=lI.default.encode(e.length),n=new Uint8Array(r.length+e.length);return n.set(r,0),n.set(e,r.length),n}function JQ(t){return{async setRoots(e){let r=fI(e);await t.write(r)},async writeBlock(e){let{cid:r,bytes:n}=e;await t.write(new Uint8Array(lI.default.encode(r.bytes.length+n.length))),await t.write(r.bytes),n.length&&await t.write(n)},async close(){await t.end()}}}var lI,eZ=w(()=>{lI=A(ns(),1);bp()});function Lw(){}function tZ(){let t=[],e=null,r=Lw,n=!1,i=null,s=Lw,o=()=>(e||(e=new Promise(u=>{r=()=>{e=null,r=Lw,u()}})),e),a={write(u){t.push(u);let l=o();return s(),l},async end(){n=!0;let u=o();s(),await u}},c={async next(){let u=t.shift();return u?(t.length===0&&r(),{done:!1,value:u}):n?(r(),{done:!0,value:void 0}):(i||(i=new Promise(l=>{s=()=>(i=null,s=Lw,l(c.next()))})),i)}};return{writer:a,iterator:c}}var rZ=w(()=>{});var zl,G0,nZ,iZ=w(()=>{zl={Null:t=>t===null,Int:t=>Number.isInteger(t),Float:t=>typeof t=="number"&&Number.isFinite(t),String:t=>typeof t=="string",Bool:t=>typeof t=="boolean",Bytes:t=>t instanceof Uint8Array,Link:t=>!zl.Null(t)&&typeof t=="object"&&t.asCID===t,List:t=>Array.isArray(t),Map:t=>!zl.Null(t)&&typeof t=="object"&&t.asCID!==t&&!zl.List(t)&&!zl.Bytes(t)},G0={Int:zl.Int,"CarHeader > version":t=>G0.Int(t),"CarHeader > roots (anon) > valueType (anon)":zl.Link,"CarHeader > roots (anon)":t=>zl.List(t)&&Array.prototype.every.call(t,G0["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":t=>G0["CarHeader > roots (anon)"](t),CarHeader:t=>{let e=t&&Object.keys(t);return zl.Map(t)&&["version"].every(r=>e.includes(r))&&Object.entries(t).every(([r,n])=>G0["CarHeader > "+r]&&G0["CarHeader > "+r](n))}},nZ=G0.CarHeader});async function Mw(t){let e=await t.upTo(8);if(!e.length)throw new Error("Unexpected end of data");let r=Hl.default.decode(e);return t.seek(Hl.default.decode.bytes),r}async function xMe(t){let e=await t.exactly(sZ),r=new DataView(e.buffer,e.byteOffset,e.byteLength),n=0,i={version:2,characteristics:[r.getBigUint64(n,!0),r.getBigUint64(n+=8,!0)],dataOffset:Number(r.getBigUint64(n+=8,!0)),dataSize:Number(r.getBigUint64(n+=8,!0)),indexOffset:Number(r.getBigUint64(n+=8,!0))};return t.seek(sZ),i}async function Uw(t,e){let r=await Mw(t);if(r===0)throw new Error("Invalid CAR header (zero length)");let n=await t.exactly(r);t.seek(r);let i=cE(n);if(!nZ(i))throw new Error("Invalid CAR header format");if(i.version!==1&&i.version!==2||e!==void 0&&i.version!==e)throw new Error(`Invalid CAR version: ${i.version}${e!==void 0?` (expected ${e})`:""}`);let s=Array.isArray(i.roots);if(i.version===1&&!s||i.version===2&&s)throw new Error("Invalid CAR header format");if(i.version===1)return i;let o=await xMe(t);t.seek(o.dataOffset-t.pos);let a=await Uw(t,1);return Object.assign(a,o)}async function PMe(t){let e=await t.upTo(8);Hl.default.decode(e);let r=Hl.default.decode.bytes,n=Hl.default.decode(e.subarray(Hl.default.decode.bytes)),i=Hl.default.decode.bytes,s=r+i+n,o=await t.exactly(s);return t.seek(s),o}async function CMe(t){let e=await t.exactly(2);if(e[0]===hI.SHA2_256&&e[1]===hI.LENGTH){let o=await t.exactly(34);t.seek(34);let a=mn(o);return L.create(0,hI.DAG_PB,a)}let r=await Mw(t);if(r!==1)throw new Error(`Unexpected CID version (${r})`);let n=await Mw(t),i=await PMe(t),s=mn(i);return L.create(r,n,s)}async function oZ(t){let e=t.pos,r=await Mw(t);if(r===0)throw new Error("Invalid CAR section (zero length)");r+=t.pos-e;let n=await CMe(t),i=r-Number(t.pos-e);return{cid:n,length:r,blockLength:i}}async function OMe(t){let{cid:e,blockLength:r}=await oZ(t),n=await t.exactly(r);return t.seek(r),{bytes:n,cid:e}}async function kMe(t){let e=t.pos,{cid:r,length:n,blockLength:i}=await oZ(t),s={cid:r,length:n,blockLength:i,offset:e,blockOffset:t.pos};return t.seek(s.blockLength),s}function aZ(t){let e=(async()=>{let r=await Uw(t);if(r.version===2){let n=t.pos-r.dataOffset;t=NMe(t,r.dataSize-n)}return r})();return{header:()=>e,async*blocks(){for(await e;(await t.upTo(8)).length>0;)yield await OMe(t)},async*blocksIndex(){for(await e;(await t.upTo(8)).length>0;)yield await kMe(t)}}}function qw(t){let e=0;return{async upTo(r){return t.subarray(e,e+Math.min(r,t.length-e))},async exactly(r){if(r>t.length-e)throw new Error("Unexpected end of data");return t.subarray(e,e+r)},seek(r){e+=r},get pos(){return e}}}function DMe(t){let e=0,r=0,n=0,i=new Uint8Array(0),s=async o=>{r=i.length-n;let a=[i.subarray(n)];for(;r<o;){let u=await t();if(u==null)break;r<0?u.length>r&&a.push(u.subarray(-r)):a.push(u),r+=u.length}i=new Uint8Array(a.reduce((u,l)=>u+l.length,0));let c=0;for(let u of a)i.set(u,c),c+=u.length;n=0};return{async upTo(o){return i.length-n<o&&await s(o),i.subarray(n,n+Math.min(i.length-n,o))},async exactly(o){if(i.length-n<o&&await s(o),i.length-n<o)throw new Error("Unexpected end of data");return i.subarray(n,n+o)},seek(o){e+=o,n+=o},get pos(){return e}}}function cZ(t){let e=t[Symbol.asyncIterator]();async function r(){let n=await e.next();return n.done?null:n.value}return DMe(r)}function NMe(t,e){let r=0;return{async upTo(n){let i=await t.upTo(n);return i.length+r>e&&(i=i.subarray(0,e-r)),i},async exactly(n){let i=await t.exactly(n);if(i.length+r>e)throw new Error("Unexpected end of data");return i},seek(n){r+=n,t.seek(n)},get pos(){return t.pos}}}var Hl,hI,sZ,dI=w(()=>{Hl=A(ns(),1);Se();li();bp();iZ();hI={SHA2_256:18,LENGTH:32,DAG_PB:112},sZ=16+8+8+8});function uZ(){let t=tZ(),{writer:e,iterator:r}=t;return{encoder:JQ(e),iterator:r}}function BMe(t){if(t===void 0)return[];if(!Array.isArray(t)){let r=L.asCID(t);if(!r)throw new TypeError("roots must be a single CID or an array of CIDs");return[r]}let e=[];for(let r of t){let n=L.asCID(r);if(!n)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(n)}return e}var W0,pI,lZ=w(()=>{Se();eZ();rZ();dI();W0=class{constructor(e,r){this._encoder=r,this._mutex=r.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let r=L.asCID(e.cid);if(!r)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:r,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=BMe(e);let{encoder:r,iterator:n}=uZ(),i=new W0(e,r),s=new pI(n);return{writer:i,out:s}}static createAppender(){let{encoder:e,iterator:r}=uZ();e.setRoots=()=>Promise.resolve();let n=new W0([],e),i=new pI(r);return{writer:n,out:i}}static async updateRootsInBytes(e,r){let n=qw(e);await Uw(n);let i=fI(r);if(Number(n.pos)!==i.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${n.pos} bytes, new header is ${i.length} bytes)`);return e.set(i,0),e}},pI=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}}});var yI,fZ=w(()=>{wn();yI=async({cid:t,load:e,seen:r})=>{r=r||new Set;let n=t.toString(bt);if(r.has(n))return;let i=await e(t);if(r.add(n),i!==null)for(let[,s]of i.links())await yI({cid:s,load:e,seen:r})}});function pZ({repo:t,preload:e,codecs:r}){async function*n(i,s={}){s.preload!==!1&&e(i);let o=L.asCID(i);if(!o)throw new Error(`Unexpected error converting CID type: ${i}`);dZ(`Exporting ${o} as car`);let{writer:a,out:c}=await W0.create([o]),u=null;(async()=>{try{let l=MMe(t,a,{signal:s.signal,timeout:s.timeout},r);await yI({cid:o,load:l})}catch(l){u=l}finally{a.close()}})();for await(let l of c){if(u)break;yield l}if(u)throw u}return Q(n)}function MMe(t,e,r,n){return async i=>{let s=await n.getCodec(i.code);if(!s)throw new Error(`Can't decode links in block with codec 0x${i.code.toString(16)} to form complete DAG`);let o=await t.blocks.get(i,r);return dZ(`Adding block ${i} to car`),await e.put({cid:i,bytes:o}),LMe.includes(i.code)?null:$0({bytes:o,cid:i,codec:s})}}var hZ,dZ,LMe,yZ=w(()=>{Se();Bw();lZ();Ce();hZ=A(he(),1);eo();IE();fZ();dZ=(0,hZ.default)("ipfs:components:dag:import"),LMe=[ei,RE]});var qh=g((V6t,gZ)=>{"use strict";var UMe=async t=>{for await(let e of t)return e};gZ.exports=UMe});function _Z({codecs:t,repo:e,preload:r}){return Q(async function(s,o={}){if(o.preload!==!1&&r(s),o.path){let f=o.localResolve?await(0,mZ.default)(yl(s,o.path,t,e,o)):await(0,wZ.default)(yl(s,o.path,t,e,o));if(!f)throw(0,bZ.default)(new Error("Not found"),"ERR_NOT_FOUND");return f}let a=await t.getCodec(s.code),c=await e.blocks.get(s,o);return{value:a.decode(c),remainderPath:""}})}var mZ,wZ,bZ,vZ=w(()=>{Ce();mZ=A(qh(),1),wZ=A(os(),1);ti();bZ=A(oe(),1)});async function EZ(t){if(!(t instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return AZ(qw(t))}async function SZ(t){if(!t||typeof t[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return AZ(cZ(t))}async function AZ(t){let e=aZ(t),{version:r,roots:n}=await e.header();return{version:r,roots:n,iterator:e.blocks()}}var gI,Y0,Fw,RZ=w(()=>{dI();gI=class{constructor(e,r,n){this._version=e,this._roots=r,this._iterable=n,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},Y0=class extends gI{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:r,roots:n,iterator:i}=await EZ(e);return new Y0(r,n,i)}static async fromIterable(e){let{version:r,roots:n,iterator:i}=await SZ(e);return new Y0(r,n,i)}},Fw=class extends gI{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let r=await e.next();return r.done?r:{done:!1,value:r.value.cid}}}}static async fromBytes(e){let{version:r,roots:n,iterator:i}=await EZ(e);return new Fw(r,n,i)}static async fromIterable(e){let{version:r,roots:n,iterator:i}=await SZ(e);return new Fw(r,n,i)}}});function OZ({repo:t}){async function*e(r,n={}){let i=await t.gcLock.readLock();try{let s={signal:n.signal,timeout:n.timeout},o=(0,IZ.default)(r),{value:a,done:c}=await o.peek();if(c)return;a&&o.push(a);let u;a instanceof Uint8Array?u=[o]:u=o;for await(let l of u){let f=await qMe(t,s,l);if(n.pinRoots!==!1)for(let h of f){let d="";try{await t.blocks.has(h)?(CZ(`Pinning root ${h}`),await t.pins.pinRecursively(h)):d="blockstore: block not found"}catch(p){d=p.message}yield{root:{cid:h,pinErrorMsg:d}}}}}finally{i()}}return Q(e)}async function qMe(t,e,r){let n=await Y0.fromIterable(r),i=await n.getRoots();return await(0,TZ.default)(t.blocks.putMany((0,xZ.default)(n,({cid:s,bytes:o})=>(CZ(`Import block ${s}`),{key:s,value:o})),{signal:e.signal})),i}var IZ,TZ,xZ,PZ,CZ,kZ=w(()=>{RZ();Ce();IZ=A(A0(),1),TZ=A(ls(),1),xZ=A(xi(),1),PZ=A(he(),1),CZ=(0,PZ.default)("ipfs:components:dag:import")});function DZ({repo:t,codecs:e,hashers:r,preload:n}){async function i(s,o={}){let a=o.pin?await t.gcLock.readLock():null;try{let c=await e.getCodec(o.storeCodec||"dag-cbor");if(!c)throw new Error(`Unknown storeCodec ${o.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(o.inputCodec){if(!(s instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");let p=await e.getCodec(o.inputCodec);if(!p)throw new Error(`Unknown inputCodec ${o.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);s=p.decode(s)}let u=o.version!=null?o.version:1,l=await r.getHasher(o.hashAlg||"sha2-256");if(!l)throw new Error(`Unknown hash algorithm ${o.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let f=c.encode(s),h=await l.digest(f),d=L.create(u,c.code,h);return await t.blocks.put(d,f,{signal:o.signal}),o.pin&&await t.pins.pinRecursively(d),o.preload!==!1&&n(d),d}finally{a&&a()}}return Q(i)}var NZ=w(()=>{Se();Ce()});function BZ({repo:t,codecs:e,preload:r}){async function n(i,s={}){let{cid:o}=eu(i);return s.preload!==!1&&r(o),pl(t,e,i,s)}return Q(n)}var LZ=w(()=>{Ce();R2();ti()});var mI,MZ=w(()=>{yZ();vZ();kZ();NZ();LZ();mI=class{constructor({repo:e,codecs:r,hashers:n,preload:i}){this.export=pZ({repo:e,preload:i,codecs:r}),this.get=_Z({codecs:r,repo:e,preload:i}),this.import=OZ({repo:e}),this.resolve=BZ({repo:e,codecs:r,preload:i}),this.put=DZ({repo:e,codecs:r,hashers:n,preload:i})}}});var jw=g((f5t,UZ)=>{var{Multiaddr:FMe}=yt(),Kw=(t,e)=>e,KMe=(t,e,r,n)=>{if(n&&n.assumeHttp===!1)return`tcp://${t}:${e}`;let i="tcp",s=`:${e}`;return r[r.length-1].protocol==="tcp"&&(i=e==="443"?"https":"http",s=e==="443"||e==="80"?"":s),`${i}://${t}${s}`},jMe={ip4:Kw,ip6:(t,e,r,n)=>n.length===1&&n[0].protocol==="ip6"?e:`[${e}]`,tcp:(t,e,r,n,i)=>n.some(s=>["http","https","ws","wss"].includes(s.protocol))?`${t}:${e}`:KMe(t,e,n,i),udp:(t,e)=>`udp://${t}:${e}`,dnsaddr:Kw,dns4:Kw,dns6:Kw,ipfs:(t,e)=>`${t}/ipfs/${e}`,p2p:(t,e)=>`${t}/p2p/${e}`,http:t=>`http://${t}`,https:t=>`https://${t}`,ws:t=>`ws://${t}`,wss:t=>`wss://${t}`,"p2p-websocket-star":t=>`${t}/p2p-websocket-star`,"p2p-webrtc-star":t=>`${t}/p2p-webrtc-star`,"p2p-webrtc-direct":t=>`${t}/p2p-webrtc-direct`};UZ.exports=(t,e)=>{let r=new FMe(t),n=t.toString().split("/").slice(1);return r.tuples().map(i=>({protocol:n.shift(),content:i[1]?n.shift():null})).reduce((i,s,o,a)=>{let c=jMe[s.protocol];if(!c)throw new Error(`Unsupported protocol ${s.protocol}`);return c(i,s.content,o,a,e)},"")}});var FZ=g((h5t,qZ)=>{"use strict";qZ.exports=t=>{if(!Array.isArray(t))throw new TypeError(`Expected an array, got ${typeof t}`);t=[...t];for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}});function jZ(t,e={}){return VMe(t),HMe.add(async()=>{let n=(await KZ.default.post(t,{signal:e.signal})).body.getReader();try{for(;;){let{done:i}=await n.read();if(i)return}}finally{n.releaseLock()}})}var KZ,wI,Vw,VMe,zMe,HMe,VZ=w(()=>{KZ=A(Kp(),1),wI=A(he(),1),Vw=A(ia(),1),VMe=Object.assign((0,wI.default)("ipfs:preload"),{error:(0,wI.default)("ipfs:preload:error")}),zMe=Vw.default.default?Vw.default.default:Vw.default,HMe=new zMe({concurrency:4})});function GZ(t={}){if(t.enabled=Boolean(t.enabled),t.addresses=t.addresses||[],t.cache=t.cache||1e3,!t.enabled||!t.addresses.length)return Wg("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,r=[],n=t.addresses.map(zZ.default),i=(0,$Z.default)(t.cache),s=async o=>{try{if(e)throw new Error(`preload ${o} but preloader is not started`);let a=o.toString();if(i.has(a))return;i.set(a,!0);let c=(0,HZ.default)(n),u=!1,l=Date.now();for(let f of c){if(e)throw new Error(`preload aborted for ${a}`);let h;try{h=new AbortController,r=r.concat(h),await jZ(`${f}/api/v0/refs?r=true&arg=${encodeURIComponent(a)}`,{signal:h.signal}),u=!0}catch(d){d.type!=="aborted"&&Wg.error(d)}finally{r=r.filter(d=>d!==h)}if(u)break}Wg(`${u?"":"un"}successfully preloaded ${a} in ${Date.now()-l}ms`)}catch(a){Wg.error(a)}};return s.start=()=>{e=!1},s.stop=()=>{e=!0,Wg(`aborting ${r.length} pending preload request(s)`),r.forEach(o=>o.abort()),r=[]},s}var zZ,bI,HZ,$Z,Wg,WZ=w(()=>{zZ=A(jw(),1),bI=A(he(),1),HZ=A(FZ(),1);VZ();$Z=A(qp(),1),Wg=Object.assign((0,bI.default)("ipfs:preload"),{error:(0,bI.default)("ipfs:preload:error")})});function YZ({preload:t,files:e,options:r={}}){if(r.interval=r.interval||30*1e3,!r.enabled){zw("MFS preload disabled");let o=async()=>{};return{start:o,stop:o}}let n="",i,s=async()=>{try{let o=await e.stat("/"),a=o.cid.toString();n!==a&&(zw(`preloading updated MFS root ${n} -> ${o.cid}`),await t(o.cid),n=a)}catch(o){zw.error("failed to preload MFS root",o)}finally{i=setTimeout(s,r.interval)}};return{async start(){let o=await e.stat("/");n=o.cid.toString(),zw(`monitoring MFS root ${o.cid}`),i=setTimeout(s,r.interval)},stop(){clearTimeout(i)}}}var _I,zw,XZ=w(()=>{_I=A(he(),1),zw=Object.assign((0,_I.default)("ipfs:mfs-preload"),{error:(0,_I.default)("ipfs:mfs-preload:error")})});var vI=g((m5t,QZ)=>{QZ.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var ZZ=g(()=>{});var cJ=g((_5t,aJ)=>{var $Me=Gt().EventEmitter,{nanoid:GMe}=(u6(),se(e9)),{WORKER_REQUEST_READ_LOCK:JZ,WORKER_RELEASE_READ_LOCK:eJ,MASTER_GRANT_READ_LOCK:tJ,WORKER_REQUEST_WRITE_LOCK:rJ,WORKER_RELEASE_WRITE_LOCK:nJ,MASTER_GRANT_WRITE_LOCK:iJ}=vI(),Yg,sJ=(t,e,r,n,i)=>(s,o)=>{o&&o.type===r&&t.emit(e,o.name,()=>(s.send({type:i,name:o.name,identifier:o.identifier}),new Promise(a=>{let c=u=>{u&&u.type===n&&u.identifier===o.identifier&&(s.removeListener("message",c),a())};s.on("message",c)})))},oJ=(t,e,r,n)=>()=>{let i=GMe();return process.send({type:e,identifier:i,name:t}),new Promise(s=>{let o=a=>{a&&a.type===r&&a.identifier===i&&(process.removeListener("message",o),s(()=>{process.send({type:n,identifier:i,name:t})}))};process.on("message",o)})};aJ.exports=t=>{try{if(Yg=ZZ(),!Object.keys(Yg).length)return}catch{return}if(Yg.isMaster||t.singleProcess){let e=new $Me;return Yg.on("message",sJ(e,"requestReadLock",JZ,eJ,tJ)),Yg.on("message",sJ(e,"requestWriteLock",rJ,nJ,iJ)),e}return{isWorker:!0,readLock:e=>oJ(e,JZ,tJ,eJ),writeLock:e=>oJ(e,rJ,iJ,nJ)}}});var EI=g((v5t,uJ)=>{var $l={},X0=t=>{t.addEventListener("message",e=>{X0.dispatchEvent("message",t,e)}),t.port&&t.port.addEventListener("message",e=>{X0.dispatchEvent("message",t,e)})};X0.addEventListener=(t,e)=>{$l[t]||($l[t]=[]),$l[t].push(e)};X0.removeEventListener=(t,e)=>{!$l[t]||($l[t]=$l[t].filter(r=>r===e))};X0.dispatchEvent=function(){let t=Array.prototype.slice.call(arguments),e=t.shift();!$l[e]||$l[e].forEach(r=>r.apply(null,t))};uJ.exports=X0});var _J=g((E5t,bJ)=>{var WMe=Gt().EventEmitter,{nanoid:YMe}=(u6(),se(e9)),{WORKER_REQUEST_READ_LOCK:lJ,WORKER_RELEASE_READ_LOCK:fJ,MASTER_GRANT_READ_LOCK:hJ,WORKER_REQUEST_WRITE_LOCK:dJ,WORKER_RELEASE_WRITE_LOCK:pJ,MASTER_GRANT_WRITE_LOCK:yJ}=vI(),gJ=EI(),mJ=(t,e,r,n,i)=>(s,o)=>{if(!o||!o.data||o.data.type!==r)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};t.emit(e,a.name,()=>(s.postMessage({type:i,name:a.name,identifier:a.identifier}),new Promise(c=>{let u=l=>{if(!l||!l.data)return;let f={type:l.data.type,name:l.data.name,identifier:l.data.identifier};f&&f.type===n&&f.identifier===a.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)})))},wJ=(t,e,r,n)=>()=>{let i=YMe();return globalThis.postMessage({type:e,identifier:i,name:t}),new Promise(s=>{let o=a=>{if(!a||!a.data)return;let c={type:a.data.type,identifier:a.data.identifier};c&&c.type===r&&c.identifier===i&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:n,identifier:i,name:t})}))};globalThis.addEventListener("message",o)})},XMe={singleProcess:!1};bJ.exports=t=>{if(t=Object.assign({},XMe,t),!!globalThis.document||t.singleProcess){let r=new WMe;return gJ.addEventListener("message",mJ(r,"requestReadLock",lJ,fJ,hJ)),gJ.addEventListener("message",mJ(r,"requestWriteLock",dJ,pJ,yJ)),r}return{isWorker:!0,readLock:r=>wJ(r,lJ,hJ,fJ),writeLock:r=>wJ(r,dJ,yJ,pJ)}}});var vJ=g((A5t,SI)=>{"use strict";var Hw,S5t=SI.exports.timeout=function(t,e){var r=new Hw,n;return Promise.race([t,new Promise(function(i,s){n=setTimeout(function(){s(r)},e)})]).then(function(i){return clearTimeout(n),i},function(i){throw clearTimeout(n),i})};Hw=SI.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};Hw.prototype=Object.create(Error.prototype);Hw.prototype.name="TimeoutError"});var $w=g((R5t,RI)=>{var QMe=cJ(),ZMe=_J(),{default:EJ}=ia(),{timeout:JMe}=vJ(),eUe=EI(),Fh={},Gl;function AI(t,e){let r,n=new Promise(i=>{r=i});return t.add(()=>JMe((()=>new Promise(i=>{r(()=>{i()})}))(),e.timeout)),n}var tUe=(t,e)=>{if(Gl.isWorker)return{readLock:Gl.readLock(t,e),writeLock:Gl.writeLock(t,e)};let r=new EJ({concurrency:1}),n=null;return{readLock:()=>{if(n)return AI(n,e);n=new EJ({concurrency:e.concurrency,autoStart:!1});let i=n,s=AI(n,e);return r.add(()=>(i.start(),i.onIdle().then(()=>{n===i&&(n=null)}))),s},writeLock:()=>(n=null,AI(r,e))}},rUe={concurrency:1/0,timeout:846e5,globalThis,singleProcess:!1};RI.exports=(t,e)=>(e||(e={}),typeof t=="object"&&(e=t,t="lock"),t||(t="lock"),e=Object.assign({},rUe,e),Gl||(Gl=QMe(e)||ZMe(e),Gl.isWorker||(Gl.on("requestReadLock",(r,n)=>{!Fh[r]||Fh[r].readLock().then(i=>n().finally(()=>i()))}),Gl.on("requestWriteLock",async(r,n)=>{!Fh[r]||Fh[r].writeLock().then(i=>n().finally(()=>i()))}))),Fh[t]||(Fh[t]=tUe(t,e)),Fh[t]);RI.exports.Worker=function(t,e){e=e||globalThis.Worker;let r;try{r=new e(t)}catch(n){n.message.includes("not a constructor")&&(r=e(t))}if(!r)throw new Error("Could not create Worker from",e);return eUe(r),r}});function Xg(t=!1){if(Gw)return Gw;let e=(0,SJ.default)({singleProcess:t});return Gw={readLock:r=>async(...n)=>{let i=await e.readLock();try{return await r.apply(null,n)}finally{i()}},writeLock:r=>async(...n)=>{let i=await e.writeLock();try{return await r.apply(null,n)}finally{i()}}},Gw}var SJ,Gw,II=w(()=>{SJ=A($w(),1)});async function Q0(t,e){if(e&&e.signal&&e.signal.aborted)throw(0,TI.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await t.repo.datastore.open();let r;try{let n=await t.repo.datastore.get(I2);r=L.decode(n)}catch(n){if(n.code!=="ERR_NOT_FOUND")throw n;AJ("Creating new MFS root");let i=lt({Data:new mt({type:"directory"}).marshal(),Links:[]}),s=await jr.digest(i);if(r=L.createV0(s),await t.repo.blocks.put(r,i),e&&e.signal&&e.signal.aborted)throw(0,TI.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await t.repo.datastore.put(I2,r.bytes)}return AJ(`Loaded MFS root /ipfs/${r}`),r}var RJ,TI,AJ,Ww=w(()=>{Se();gn();xt();Tn();RJ=A(he(),1),TI=A(oe(),1);ti();AJ=(0,RJ.default)("ipfs:mfs:utils:with-mfs-root")});function Z0(t=""){return(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}var Yw=w(()=>{});var PI,xI,on,mu=w(()=>{Ww();Yw();da();PI=A(oe(),1);Se();xI="ipfs",on=async(t,e,r)=>{let n=await Q0(t,r),i={entryType:"file"},s="";if(L.asCID(e)?s=`/ipfs/${e}`:s=e.toString(),s=s.trim(),s=s.replace(/(\/\/+)/g,"/"),s.endsWith("/")&&s.length>1&&(s=s.substring(0,s.length-1)),!s)throw(0,PI.default)(new Error("paths must not be empty"),"ERR_NO_PATH");if(s.substring(0,1)!=="/")throw(0,PI.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");s.substring(s.length-1)==="/"&&(s=s.substring(0,s.length-1));let o=Z0(s);if(o[0]===xI){let c;o.length===2?c=`/${o.join("/")}`:c=`/${o.slice(0,o.length-1).join("/")}`,i={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{let c=`/${xI}/${n}${o.length?"/"+o.join("/"):""}`,u=`/${xI}/${n}/${o.slice(0,o.length-1).join("/")}`;i={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:u,mfsPath:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}let a=i.type==="mfs"?i.mfsPath:i.path;try{let c=await gi(a,t.repo.blocks,r);i.cid=c.cid,i.mfsPath=`/ipfs/${c.path}`,i.entryType=c.type,i.content=c.content,(i.entryType==="file"||i.entryType==="directory")&&(c.type==="file"||c.type==="directory")&&(i.unixfs=c.unixfs)}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}return i.exists=Boolean(i.cid),i}});function Wl(t){async function e(r,n={}){n=nUe(sUe,n),iUe(`Fetching stats for ${r}`);let{type:i,cid:s,mfsPath:o}=await on(t,r,n),a=i==="ipfs"&&s?s:o,c;try{c=await gi(a,t.repo.blocks)}catch(u){throw u.code==="ERR_NOT_FOUND"?(0,xJ.default)(new Error(`${r} does not exist`),"ERR_NOT_FOUND"):u}if(!IJ[c.type])throw new Error(`Cannot stat codec ${c.cid.code}`);return IJ[c.type](c)}return Q(e)}var TJ,xJ,nUe,iUe,sUe,IJ,Qg=w(()=>{Fn();mu();da();TJ=A(he(),1),xJ=A(oe(),1);Ce();xt();nUe=Bt.bind({ignoreUndefined:!0}),iUe=(0,TJ.default)("ipfs:mfs:stat"),sUe={withLocal:!1};IJ={raw:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:t=>{let e={cid:t.cid,type:"file",size:t.unixfs.fileSize(),cumulativeSize:lt(t.node).length+(t.node.Links||[]).reduce((r,n)=>r+(n.Tsize||0),0),blocks:t.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:t.unixfs.mode};return t.unixfs.mtime&&(e.mtime=t.unixfs.mtime),e},directory:t=>{let e={cid:t.cid,type:"directory",size:0,cumulativeSize:lt(t.node).length+(t.node.Links||[]).reduce((r,n)=>r+(n.Tsize||0),0),blocks:t.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:t.unixfs.mode};return t.unixfs.mtime&&(e.mtime=t.unixfs.mtime),e},object:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})}});async function wc(t,e){oUe(`Creating trail for path ${e}`);let r=[];for await(let n of cR(e,t.repo.blocks))r.push({name:n.name,cid:n.cid,size:n.size,type:n.type});return r}var PJ,oUe,J0=w(()=>{da();PJ=A(he(),1),oUe=(0,PJ.default)("ipfs:mfs:utils:to-trail")});var Xw,CI=w(()=>{Se();xt();Tn();Xw=async(t,e,r)=>{r.codec||(r.codec=Kt),r.hasher||(r.hasher=jr),r.cidVersion===void 0&&(r.cidVersion=1),r.codec===Kt&&r.hasher!==jr&&(r.cidVersion=1);let n=await r.hasher.digest(t),i=L.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await e.put(i,t,{signal:r.signal}),i}});async function Jw(t){return(await Rh.encode(t)).slice(0,8).reverse()}var Qw,Zw,OI=w(()=>{$5();Qw=Rh.code,Zw=8});async function*OJ(t,e,r,n){let i=t._children,s=[],o=0;for(let d=0;d<i.length;d++){let p=i.get(d);if(!p)continue;let y=d.toString(16).toUpperCase().padStart(2,"0");if(p instanceof eb.Bucket){let b;for await(let m of await OJ(p,e,null,n))b=m;if(!b)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:y,Tsize:b.size,Hash:b.cid}),o+=b.size}else if(typeof p.value.flush=="function"){let b=p.value,m;for await(let R of b.flush(e))m=R,yield m;let _=y+p.key;s.push({Name:_,Tsize:m.size,Hash:m.cid}),o+=m.size}else{let b=p.value;if(!b.cid)continue;let m=y+p.key,_=b.size;s.push({Name:m,Tsize:_,Hash:b.cid}),o+=_}}let a=Uint8Array.from(i.bitField().reverse()),u={Data:new mt({type:"hamt-sharded-directory",data:a,fanout:t.tableSize(),hashType:Qw,mtime:r&&r.mtime,mode:r&&r.mode}).marshal(),Links:s},l=lt(Zn(u)),f=await Xw(l,e,n),h=l.length+o;yield{cid:f,node:u,size:h}}var eb,CJ,Zg,kI=w(()=>{xt();gn();CI();eb=A(xg(),1);OI();CJ=class{constructor(e,r){this.options=r||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,r){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},Zg=class extends CJ{constructor(e,r){super(e,r);this._bucket=(0,eb.createHAMT)({hashFn:Jw,bits:Zw})}async put(e,r){await this._bucket.put(e,r)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:r}of this._bucket.eachLeafSeries())yield{key:e,child:r}}async*flush(e){yield*OJ(this._bucket,e,this,this.options)}}});var e1,kJ,DJ,Jg,t1,DI,NI,em,Kh,NJ,BJ,BI=w(()=>{xt();e1=A(xg(),1);kI();kJ=A(he(),1);gn();DJ=A(os(),1);Se();OI();Jg=(0,kJ.default)("ipfs:mfs:core:utils:hamt-utils"),t1=async(t,e,r,n)=>{if(!n.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");let i=Uint8Array.from(r._children.bitField().reverse()),s=mt.unmarshal(n.parent.Data),o=new mt({type:"hamt-sharded-directory",data:i,fanout:r.tableSize(),hashType:Qw,mode:s.mode,mtime:s.mtime}),a=await t.hashers.getHasher(n.hashAlg),c={Data:o.marshal(),Links:e.sort((h,d)=>(h.Name||"").localeCompare(d.Name||""))},u=lt(c),l=await a.digest(u),f=L.create(n.cidVersion,St,l);return n.flush&&await t.repo.blocks.put(f,u),{node:c,cid:f,size:e.reduce((h,d)=>h+(d.Tsize||0),u.length)}},DI=async(t,e,r,n,i)=>{let s=new e1.Bucket({hash:r._options.hash,bits:r._options.bits},n,i);return n._putObjectAt(i,s),await em(t,e,s,r),s},NI=async t=>{let e=(0,e1.createHAMT)({hashFn:Jw,bits:Zw});return await Promise.all(t.map(async r=>{let n=r.Name||"";if(n.length===2){let i=parseInt(n,16),s=new e1.Bucket({hash:e._options.hash,bits:e._options.bits},e,i);return e._putObjectAt(i,s),Promise.resolve()}return e.put(n.substring(2),{size:r.Tsize,cid:r.Hash})})),e},em=async(t,e,r,n)=>{await Promise.all(e.map(async i=>{let s=i.Name||"";if(s.length===2){Jg("Populating sub bucket",s);let o=parseInt(s,16),a=await t.repo.blocks.get(i.Hash),c=Ft(a),u=new e1.Bucket({hash:n._options.hash,bits:n._options.bits},r,o);return r._putObjectAt(o,u),await em(t,c.Links,u,n),Promise.resolve()}return n.put(s.substring(2),{size:i.Tsize,cid:i.Hash})}))},Kh=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),NJ=async(t,e,r)=>{let n=await NI(r.Links),i=await n._findNewBucketAndPos(e),s=[{bucket:i.bucket,prefix:Kh(i.pos)}],o=i.bucket;for(;o!==n;)s.push({bucket:o,prefix:Kh(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=r;for(let a=0;a<s.length;a++){let c=s[a];if(!c.node)throw new Error("Could not generate HAMT path");let u=c.node.Links.filter(d=>(d.Name||"").substring(0,2)===c.prefix).pop();if(!u){Jg(`Link ${c.prefix}${e} will be added`);continue}if(u.Name===`${c.prefix}${e}`){Jg(`Link ${c.prefix}${e} will be replaced`);continue}Jg(`Found subshard ${c.prefix}`);let l=await t.repo.blocks.get(u.Hash),f=Ft(l);if(!s[a+1]){Jg(`Loaded new subshard ${c.prefix}`),await DI(t,f.Links,n,c.bucket,parseInt(c.prefix,16));let d=await n._findNewBucketAndPos(e);s.push({bucket:d.bucket,prefix:Kh(d.pos),node:f});continue}let h=s[a+1];await em(t,f.Links,h.bucket,n),h.node=f}return await n.put(e,!0),s.reverse(),{rootBucket:n,path:s}},BJ=async(t,e,r={})=>{let n=new Zg({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},r);for(let s=0;s<e.length;s++)await n._bucket.put(e[s].name,{size:e[s].size,cid:e[s].cid});let i=await(0,DJ.default)(n.flush(t.repo.blocks));if(!i)throw new Error("Flushing shard yielded no result");return i}});async function Eo(t,e){let r=e.parent;if(e.parentCid){let i=L.asCID(e.parentCid);if(i===null)throw(0,bc.default)(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(i.code!==St)throw(0,bc.default)(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");_c(`Loading parent node ${i}`);let s=await t.repo.blocks.get(i);r=Ft(s)}if(!r)throw(0,bc.default)(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw(0,bc.default)(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw(0,bc.default)(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!e.size&&e.size!==0)throw(0,bc.default)(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!r.Data)throw(0,bc.default)(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let n=mt.unmarshal(r.Data);return n.type==="hamt-sharded-directory"?(_c("Adding link to sharded directory"),uUe(t,{...e,parent:r})):r.Links.length>=e.shardSplitThreshold?(_c("Converting directory to sharded directory"),aUe(t,{...e,parent:r,mtime:n.mtime,mode:n.mode})):(_c(`Adding ${e.name} (${e.cid}) to regular directory`),cUe(t,{...e,parent:r}))}var LJ,bc,MJ,_c,aUe,cUe,uUe,lUe,fUe,jh=w(()=>{xt();Se();LJ=A(he(),1);gn();kI();BI();bc=A(oe(),1),MJ=A(os(),1),_c=(0,LJ.default)("ipfs:mfs:core:utils:add-link");aUe=async(t,e)=>{let r=await BJ(t,e.parent.Links.map(n=>({name:n.Name||"",size:n.Tsize||0,cid:n.Hash})).concat({name:e.name,size:e.size,cid:e.cid}),e);return _c(`Converted directory to sharded directory ${r.cid}`),r},cUe=async(t,e)=>{let r=e.parent.Links.filter(u=>u.Name!==e.name);if(r.push({Name:e.name,Tsize:e.size,Hash:e.cid}),!e.parent.Data)throw(0,bc.default)(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let n=mt.unmarshal(e.parent.Data),i;if(n.mtime){let u=Date.now(),l=Math.floor(u/1e3);n.mtime={secs:l,nsecs:(u-l*1e3)*1e3},i=n.marshal()}else i=e.parent.Data;e.parent=Zn({Data:i,Links:r});let s=await t.hashers.getHasher(e.hashAlg),o=lt(e.parent),a=await s.digest(o),c=L.create(e.cidVersion,St,a);return e.flush&&await t.repo.blocks.put(c,o),{node:e.parent,cid:c,size:o.length}},uUe=async(t,e)=>{let{shard:r,path:n}=await lUe(t,e),i=await(0,MJ.default)(r.flush(t.repo.blocks));if(!i)throw new Error("No result from flushing shard");let s=await t.repo.blocks.get(i.cid),o=Ft(s),a=e.parent.Links.filter(u=>(u.Name||"").substring(0,2)!==n[0].prefix),c=o.Links.find(u=>(u.Name||"").substring(0,2)===n[0].prefix);if(!c)throw new Error(`No link found with prefix ${n[0].prefix}`);return a.push(c),t1(t,a,n[0].bucket,e)},lUe=async(t,e)=>{let r={name:e.name,cid:e.cid,size:e.size};if(!e.parent.Data)throw(0,bc.default)(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let n=await NI(e.parent.Links),i=mt.unmarshal(e.parent.Data),s=new Zg({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:i.mode},e);s._bucket=n,i.mtime&&(s.mtime={secs:Math.round(Date.now()/1e3)});let o=await n._findNewBucketAndPos(r.name),a=fUe(o);a[0].node=e.parent;let c=0;for(;c<a.length;){let u=a[c];c++;let l=u.node;if(!l)throw new Error("Segment had no node");let f=l.Links.find(y=>(y.Name||"").substring(0,2)===u.prefix);if(!f){_c(`Link ${u.prefix}${r.name} will be added`),c=a.length;break}if(f.Name===`${u.prefix}${r.name}`){_c(`Link ${u.prefix}${r.name} will be replaced`),c=a.length;break}if((f.Name||"").length>2){_c(`Link ${f.Name} ${f.Hash} will be replaced with a subshard`),c=a.length;break}_c(`Found subshard ${u.prefix}`);let h=await t.repo.blocks.get(f.Hash),d=Ft(h);if(!a[c]){_c(`Loaded new subshard ${u.prefix}`),await DI(t,d.Links,n,u.bucket,parseInt(u.prefix,16));let y=await n._findNewBucketAndPos(r.name);a.push({bucket:y.bucket,prefix:Kh(y.pos),node:d});break}let p=a[c];await em(t,d.Links,p.bucket,n),p.node=d}return await s._bucket.put(r.name,{size:r.size,cid:r.cid}),{shard:s,path:a}},fUe=t=>{let e=[{bucket:t.bucket,prefix:Kh(t.pos)}],r=t.bucket._parent,n=t.bucket._posAtParent;for(;r;)e.push({bucket:r,prefix:Kh(n)}),n=r._posAtParent,r=r._parent;return e.reverse(),e}});async function Ls(t,e,r){r=Object.assign({},hUe,r),UJ("Trail",e),e=e.slice().reverse();let n=0,i;for await(let o of t.repo.blocks.getMany(e.map(a=>a.cid))){let a=Ft(o),c=e[n].cid,u=e[n].name;if(n++,!i){i={cid:c,name:u,size:o.length};continue}let l=await Eo(t,{parent:a,name:i.name,cid:i.cid,size:i.size,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold,hashAlg:r.hashAlg,cidVersion:r.cidVersion});i={cid:l.cid,name:u,size:l.size}}let{cid:s}=i;return UJ(`Final CID ${s}`),s}var qJ,UJ,hUe,Vh=w(()=>{qJ=A(he(),1);jh();xt();UJ=(0,qJ.default)("ipfs:mfs:utils:update-tree"),hUe={shardSplitThreshold:1e3}});async function Ms(t,e,r){if(r&&r.signal&&r.signal.aborted)throw(0,KJ.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return dUe(`New MFS root will be ${e}`),await t.repo.datastore.put(I2,e.bytes),e}var FJ,KJ,dUe,zh=w(()=>{FJ=A(he(),1);ti();KJ=A(oe(),1),dUe=(0,FJ.default)("ipfs:mfs:utils:update-mfs-root")});async function jJ(t,e,r){let n=new mt({type:e,mode:r.mode,mtime:r.mtime}),i=await t.hashers.getHasher(r.hashAlg),s={Data:n.marshal(),Links:[]},o=lt(s),a=await i.digest(o),c=L.create(r.cidVersion,St,a);return r.flush&&await t.repo.blocks.put(c,o),{cid:c,node:s}}var VJ=w(()=>{gn();xt();Se()});function $h(t){async function e(r,n={}){let i=pUe(yUe,n);if(!r)throw new Error("no path given to Mkdir");if(r=r.trim(),r==="/"){if(i.parents)return;throw(0,Hh.default)(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(r.substring(0,1)!=="/")throw(0,Hh.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");HJ(`Creating ${r}`);let s=Z0(r);if(s[0]==="ipfs")throw(0,Hh.default)(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let o=await Q0(t,i),a,c=[],u=await jJ(t,"directory",i);for(let f=0;f<=s.length;f++){let h=s.slice(0,f),d=`/ipfs/${o}/${h.join("/")}`;try{if(a=await gi(d,t.repo.blocks),a.type!=="file"&&a.type!=="directory")throw(0,Hh.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(f===s.length){if(i.parents)return;throw(0,Hh.default)(new Error("file already exists"),"ERR_ALREADY_EXISTS")}c.push({name:a.name,cid:a.cid})}catch(p){if(p.code==="ERR_NOT_FOUND"){if(f<s.length&&!i.parents)throw(0,Hh.default)(new Error(`Intermediate directory path ${d} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await gUe(t,h[h.length-1],u,c[c.length-1],c,i)}else throw p}}let l=await Ls(t,c,i);await Ms(t,l,i)}return Q(e)}var Hh,zJ,pUe,HJ,yUe,gUe,tb=w(()=>{Hh=A(oe(),1),zJ=A(he(),1);da();VJ();Yw();zh();Vh();jh();Ww();Fn();Ce();pUe=Bt.bind({ignoreUndefined:!0}),HJ=(0,zJ.default)("ipfs:mfs:mkdir"),yUe={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};gUe=async(t,e,r,n,i,s)=>{HJ(`Adding empty dir called ${e} to ${n.cid}`);let o=await Eo(t,{parent:n.node,parentCid:n.cid,size:0,cid:r.cid,name:e,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});i[i.length-1].cid=o.cid,i.push({name:e,cid:r.cid})}});function r1(t){async function e(r,n,i={}){let s=mUe(wUe,i);Array.isArray(r)||(r=[r]);let o=await Promise.all(r.map(h=>on(t,h,s))),a=await on(t,n,s);if(!o.length||!a)throw(0,Yl.default)(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let c=o.find(h=>!h.exists);if(c)throw(0,Yl.default)(new Error(`${c.path} does not exist`),"ERR_INVALID_PARAMS");let u=$J(a);if(a.exists){if(rb("Destination exists"),o.length===1&&!u)throw(0,Yl.default)(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(rb("Destination does not exist"),o.length>1){if(!s.parents)throw(0,Yl.default)(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await $h(t)(a.path,s),a=await on(t,a.path,s)}else if(a.parts.length>1){let h=`/${a.parts.slice(0,-1).join("/")}`;try{await Wl(t)(h,s)}catch(d){if(d.code!=="ERR_NOT_FOUND")throw d;if(!s.parents)throw(0,Yl.default)(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await $h(t)(h,s),a=await on(t,a.path,s)}}let l=$J(a)?a.mfsPath:a.mfsDirectory,f=await wc(t,l);if(o.length===1){let h=o.pop();if(!h)throw(0,Yl.default)(new Error("could not find source"),"ERR_INVALID_PARAMS");let d=u?h.name:a.name;return rb(`Only one source, copying to destination ${u?"directory":"file"} ${d}`),bUe(t,h,d,f,s)}return rb("Multiple sources, wrapping in a directory"),_Ue(t,o,a,f,s)}return Q(e)}var GJ,Yl,mUe,rb,wUe,$J,bUe,_Ue,WJ,nb=w(()=>{tb();Qg();GJ=A(he(),1),Yl=A(oe(),1);Vh();zh();jh();mu();Fn();J0();Ce();mUe=Bt.bind({ignoreUndefined:!0}),rb=(0,GJ.default)("ipfs:mfs:cp"),wUe={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};$J=t=>t.unixfs&&t.unixfs.type&&t.unixfs.type.includes("directory"),bUe=async(t,e,r,n,i)=>{let s=n.pop();if(!s)throw(0,Yl.default)(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await WJ(t,e,r,s,i),n.push(s);let o=await Ls(t,n,i);await Ms(t,o,i)},_Ue=async(t,e,r,n,i)=>{for(let o=0;o<e.length;o++){let a=e[o];r=await WJ(t,a,a.name,r,i)}n[n.length-1]=r;let s=await Ls(t,n,i);await Ms(t,s,i)},WJ=async(t,e,r,n,i)=>{let s=await t.repo.blocks.get(e.cid),{node:o,cid:a,size:c}=await Eo(t,{parentCid:n.cid,size:s.length,cid:e.cid,name:r,hashAlg:i.hashAlg,cidVersion:i.cidVersion,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold});return n.node=o,n.cid=a,n.size=c,n}});async function XJ(t,e){let r=e.parent;if(e.parentCid){let i=L.asCID(e.parentCid);if(i===null)throw(0,Xl.default)(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");Ql(`Loading parent node ${i}`);let s=await t.repo.blocks.get(i);r=Ft(s)}if(!r)throw(0,Xl.default)(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw(0,Xl.default)(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!r.Data)throw(0,Xl.default)(new Error("Parent node had no data"),"ERR_INVALID_NODE");return mt.unmarshal(r.Data).type==="hamt-sharded-directory"?(Ql(`Removing ${e.name} from sharded directory`),EUe(t,{...e,parent:r})):(Ql(`Removing link ${e.name} regular directory`),vUe(t,{...e,parent:r}))}var YJ,Xl,Ql,vUe,EUe,QJ,SUe,ZJ=w(()=>{xt();Se();YJ=A(he(),1);gn();BI();Xl=A(oe(),1),Ql=(0,YJ.default)("ipfs:mfs:core:utils:remove-link");vUe=async(t,e)=>{e.parent.Links=e.parent.Links.filter(o=>o.Name!==e.name);let r=await lt(e.parent),i=await(await t.hashers.getHasher(e.hashAlg)).digest(r),s=L.create(e.cidVersion,St,i);return await t.repo.blocks.put(s,r),Ql(`Updated regular directory ${s}`),{node:e.parent,cid:s}},EUe=async(t,e)=>{let{rootBucket:r,path:n}=await NJ(t,e.name,e.parent);await r.del(e.name);let{node:i}=await QJ(t,n,e.name,e);return t1(t,i.Links,r,e)},QJ=async(t,e,r,n)=>{let i=e.pop();if(!i)throw(0,Xl.default)(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:s,prefix:o,node:a}=i;if(!a)throw(0,Xl.default)(new Error("Could not find parent"),"EINVALIDPARENT");let c=a.Links.find(d=>(d.Name||"").substring(0,2)===o);if(!c)throw(0,Xl.default)(new Error(`No link found with prefix ${o} for file ${r}`),"ERR_NOT_FOUND");if(c.Name===`${o}${r}`){Ql(`Removing existing link ${c.Name}`);let d=a.Links.filter(p=>p.Name!==c.Name);return await s.del(r),t1(t,d,s,n)}Ql(`Descending into sub-shard ${c.Name} for ${o}${r}`);let u=await QJ(t,e,r,n),l=u.cid,f=u.size,h=o;if(u.node.Links.length===1){Ql(`Removing subshard for ${o}`);let d=u.node.Links[0];h=`${o}${(d.Name||"").substring(2)}`,l=d.Hash,f=d.Tsize||0}return Ql(`Updating shard ${o} with name ${h}`),SUe(t,s,a,o,h,f,l,n)},SUe=(t,e,r,n,i,s,o,a)=>{let c=r.Links.filter(u=>u.Name!==n);return c.push({Name:i,Tsize:s,Hash:o}),t1(t,c,e,a)}});function n1(t){async function e(r,n={}){let i=AUe(RUe,n);Array.isArray(r)||(r=[r]);let s=await Promise.all(r.map(o=>on(t,o,i)));if(!s.length)throw(0,tm.default)(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach(o=>{if(o.path==="/")throw(0,tm.default)(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let o of s)await IUe(t,o.path,i)}return Q(e)}var tm,AUe,RUe,IUe,ib=w(()=>{tm=A(oe(),1);Vh();zh();ZJ();mu();J0();Ce();Fn();AUe=Bt.bind({ignoreUndefined:!0}),RUe={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};IUe=async(t,e,r)=>{let n=await on(t,e,r),i=await wc(t,n.mfsPath),s=i[i.length-1];i.pop();let o=i[i.length-1];if(!o)throw(0,tm.default)(new Error(`${e} does not exist`),"ERR_NOT_FOUND");if(s.type==="directory"&&!r.recursive)throw(0,tm.default)(new Error(`${e} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:a}=await XJ(t,{parentCid:o.cid,name:s.name,hashAlg:r.hashAlg,cidVersion:r.cidVersion,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold});o.cid=a;let c=await Ls(t,i,r);await Ms(t,c,r)}});function PUe(t,e,r){let n=0;return(t.includes("x")||t.includes("X")&&(r||e&1||e&8||e&64))&&(n+=1),t.includes("w")&&(n+=2),t.includes("r")&&(n+=4),n}function CUe(t,e){let r=0;return t.includes("u")&&(r+=e<<6),t.includes("g")&&(r+=e<<3),t.includes("o")&&(r+=e),r}function OUe(t,e,r){return e.includes("t")&&(r+=parseInt("1000",8)),e.includes("s")&&(t.includes("u")&&(r+=parseInt("4000",8)),t.includes("g")&&(r+=parseInt("2000",8))),r}function kUe(t,e,r){e||(e=0);let n=t.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!n)throw new Error(`Invalid file mode: ${t}`);let[,i,s,o]=n;(i==="a"||!i)&&(i="ugo");let a=PUe(o,e,r);return a=CUe(i,a),a=OUe(i,o,a),s==="="?(i.includes("u")&&(e=e&parseInt("7077",8),e=e|a),i.includes("g")&&(e=e&parseInt("7707",8),e=e|a),i.includes("o")&&(e=e&parseInt("7770",8),e=e|a),e):s==="+"?a|e:s==="-"?a^e:e}function eee(t,e){if(t instanceof String||typeof t=="string"){let r=`${t}`;r.match(/^\d+$/g)?t=parseInt(r,8):t=0+r.split(",").reduce((n,i)=>kUe(i,n,e.isDirectory()),e.mode||0)}return t}function iee(t){async function e(r,n,i={}){let s=TUe(JJ,i);xUe(`Fetching stats for ${r}`);let{cid:o,mfsDirectory:a,name:c}=await on(t,r,s);if(o.code!==St)throw(0,i1.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){let U=await(0,ree.pipe)(async function*(){for await(let M of hw(o,t.repo.blocks)){if(M.type!=="file"&&M.type!=="directory")throw(0,i1.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");M.unixfs.mode=eee(n,M.unixfs);let ae=Zn({Data:M.unixfs.marshal(),Links:M.node.Links});yield{path:M.path,content:ae}}},M=>C0(M,t.repo.blocks,{...s,pin:!1,dagBuilder:async function*(ae,ne,de){for await(let me of ae)yield async function(){let Ke=me.content,xe=lt(Ke),Ue=await Xw(xe,ne,de);if(!Ke.Data)throw(0,i1.default)(new Error(`${Ue} had no data`),"ERR_INVALID_NODE");let ie=mt.unmarshal(Ke.Data);return{cid:Ue,size:xe.length,path:me.path,unixfs:ie}}}}),M=>(0,nee.default)(M));if(!U)throw(0,i1.default)(new Error(`Could not chmod ${r}`),"ERR_COULD_NOT_CHMOD");await n1(t)(r,s),await r1(t)(`/ipfs/${U.cid}`,r,s);return}let u=await t.repo.blocks.get(o),l=Ft(u);if(!l.Data)throw(0,i1.default)(new Error(`${o} had no data`),"ERR_INVALID_NODE");let f=mt.unmarshal(l.Data);f.mode=eee(n,f);let h=lt({Data:f.marshal(),Links:l.Links}),d=s.hashAlg||JJ.hashAlg,y=await(await t.hashers.getHasher(d)).digest(h),b=L.create(s.cidVersion,St,y);s.flush&&await t.repo.blocks.put(b,h);let m=await wc(t,a),_=m[m.length-1],R=L.decode(_.cid.bytes),k=await t.repo.blocks.get(R),P=Ft(k),x=await Eo(t,{parent:P,name:c,cid:b,size:h.length,flush:s.flush,hashAlg:d,cidVersion:o.version,shardSplitThreshold:1/0});_.cid=x.cid;let D=await Ls(t,m,s);await Ms(t,D,s)}return Q(e)}var tee,i1,ree,nee,TUe,xUe,JJ,see=w(()=>{Fn();mu();tee=A(he(),1),i1=A(oe(),1);gn();J0();jh();Vh();zh();xt();Se();ree=A(br(),1);ew();da();nee=A(os(),1);nb();ib();CI();Ce();TUe=Bt.bind({ignoreUndefined:!0}),xUe=(0,tee.default)("ipfs:mfs:touch"),JJ={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1}});function oee(t){async function e(r,n={}){n=DUe(NUe,n);let{cid:i}=await Wl(t)(r,n);return i}return Q(e)}var DUe,NUe,aee=w(()=>{Qg();Ce();Fn();DUe=Bt.bind({ignoreUndefined:!0}),NUe={}});function cee(t){async function e(r,n,i={}){let s=BUe(LUe,i);await r1(t)(r,n,s),await n1(t)(r,{...s,recursive:!0})}return Q(e)}var BUe,LUe,uee=w(()=>{nb();ib();Fn();Ce();BUe=Bt.bind({ignoreUndefined:!0}),LUe={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3}});function hee(t){async function e(r,n={}){let i=MUe(lee,n);i.mtime=i.mtime||new Date,UUe(`Touching ${r} mtime: ${i.mtime}`);let{cid:s,mfsDirectory:o,name:a,exists:c}=await on(t,r,i),u=n.hashAlg||lee.hashAlg,l=await t.hashers.getHasher(u),f,h,d=i.cidVersion;if(c){if(s.code!==St)throw(0,LI.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");d=s.version;let P=await t.repo.blocks.get(s),x=Ft(P);if(!x.Data)throw(0,LI.default)(new Error(`${r} had no data`),"ERR_INVALID_NODE");let D=mt.unmarshal(x.Data);D.mtime=i.mtime,f=lt({Data:D.marshal(),Links:x.Links});let U=await l.digest(f);h=L.create(i.cidVersion,St,U),i.flush&&await t.repo.blocks.put(h,f)}else{let P=new mt({type:"file",mtime:i.mtime});f=lt({Data:P.marshal(),Links:[]});let x=await l.digest(f);h=L.create(i.cidVersion,St,x),i.flush&&await t.repo.blocks.put(h,f)}let p=await wc(t,o),y=p[p.length-1],b=y.cid,m=await t.repo.blocks.get(b),_=Ft(m),R=await Eo(t,{parent:_,name:a,cid:h,size:f.length,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold,hashAlg:i.hashAlg,cidVersion:d});y.cid=R.cid;let k=await Ls(t,p,i);await Ms(t,k,i)}return Q(e)}var fee,LI,MUe,UUe,lee,dee=w(()=>{Fn();mu();fee=A(he(),1),LI=A(oe(),1);gn();J0();jh();Vh();zh();xt();Se();Ce();MUe=Bt.bind({ignoreUndefined:!0}),UUe=(0,fee.default)("ipfs:mfs:touch"),lee={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"}});function pee(t){function e(r,n={}){return n=qUe(FUe,n),{[Symbol.asyncIterator]:async function*(){let s=await on(t,r,n),o=await gi(s.mfsPath,t.repo.blocks);if(o.type!=="file")throw(0,MI.default)(new Error(`${r} was not a file`),"ERR_NOT_FILE");if(!o.content)throw(0,MI.default)(new Error(`Could not load content stream from ${r}`),"ERR_NO_CONTENT");for await(let a of o.content({offset:n.offset,length:n.length}))yield a}}}return Q(e)}var MI,qUe,FUe,yee=w(()=>{da();Fn();mu();MI=A(oe(),1);Ce();qUe=Bt.bind({ignoreUndefined:!0}),FUe={offset:0,length:1/0}});function mee(t){if(!t)throw(0,UI.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof t=="string"||t instanceof String)&&(rm("Content was a string"),t=tt(t.toString())),t.length)return rm("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield t}};if(t[Symbol.asyncIterator])return rm("Content was an async iterator"),t;if(t[Symbol.iterator])return rm("Content was an iterator"),t;if(globalThis.Blob&&t instanceof globalThis.Blob){rm("Content was an HTML5 Blob");let e=0,r={next:()=>e>t.size?{done:!0}:new Promise((n,i)=>{let s=t.slice(e,T2);e+=T2;let o=new globalThis.FileReader,a=c=>{if(o.removeEventListener("loadend",a,!1),c.error)return i(c.error);n({done:!1,value:new Uint8Array(o.result)})};o.addEventListener("loadend",a),o.readAsArrayBuffer(s)})};return{[Symbol.asyncIterator]:()=>r}}throw(0,UI.default)(new Error(`Don't know how to convert ${t} into an async iterator`),"ERR_INVALID_PARAMS")}var UI,gee,rm,wee=w(()=>{UI=A(oe(),1),gee=A(he(),1);ti();dt();rm=(0,gee.default)("ipfs:mfs:utils:to-async-iterator")});function Eee(t){async function e(r,n,i={}){let s=KUe(jUe,i),o,a,c;if(vc("Reading source, destination and parent"),await Xg().readLock(async()=>{o=await mee(n),a=await on(t,r,s),c=await on(t,a.mfsDirectory,s)})(),vc("Read source, destination and parent"),!s.parents&&!c.exists)throw(0,Ec.default)(new Error("directory does not exist"),"ERR_NO_EXIST");if(o==null)throw(0,Ec.default)(new Error("could not create source"),"ERR_NO_SOURCE");if(a==null)throw(0,Ec.default)(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!a.exists)throw(0,Ec.default)(new Error("file does not exist"),"ERR_NO_EXIST");if(a.entryType!=="file")throw(0,Ec.default)(new Error("not a file"),"ERR_NOT_A_FILE");return VUe(t,r,o,a,s)}return Q(e)}var _ee,Ec,vee,KUe,vc,jUe,VUe,zUe,See,bee,HUe,$Ue,Aee=w(()=>{_ee=A(he(),1);ew();xt();Qg();tb();jh();Fn();II();wee();mu();Yw();J0();Vh();zh();Ec=A(oe(),1);ti();vee=A(os(),1);Ce();gn();KUe=Bt.bind({ignoreUndefined:!0}),vc=(0,_ee.default)("ipfs:mfs:write"),jUe={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(t,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};VUe=async(t,e,r,n,i)=>{let s=await zUe(t,r,n,i);await Xg().writeLock(async()=>{let o=Z0(e),a=o.pop();if(a==null)throw(0,Ec.default)(new Error("source does not exist"),"ERR_NO_EXIST");let c=!1;try{await Wl(t)(`/${o.join("/")}`,i),c=!0}catch(b){if(b.code!=="ERR_NOT_FOUND")throw b}c||await $h(t)(`/${o.join("/")}`,i);let u=await on(t,e,i),l=await wc(t,u.mfsDirectory),f=l[l.length-1];if(!f)throw(0,Ec.default)(new Error("directory does not exist"),"ERR_NO_EXIST");if(!f.type||!f.type.includes("directory"))throw(0,Ec.default)(new Error(`cannot write to ${f.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let h=await t.repo.blocks.get(f.cid),d=Ft(h),p=await Eo(t,{parent:d,name:a,cid:s.cid,size:s.size,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold,hashAlg:i.hashAlg,cidVersion:i.cidVersion});f.cid=p.cid;let y=await Ls(t,l,i);await Ms(t,y,i)})()},zUe=async(t,e,r,n)=>{r.exists?vc(`Overwriting file ${r.cid} offset ${n.offset} length ${n.length}`):vc(`Writing file offset ${n.offset} length ${n.length}`);let i=[];if(n.offset>0)if(r.unixfs){if(vc(`Writing first ${n.offset} bytes of original file`),i.push(()=>r.content({offset:0,length:n.offset})),r.unixfs.fileSize()<n.offset){let l=n.offset-r.unixfs.fileSize();vc(`Writing zeros for extra ${l} bytes`),i.push(bee(l))}}else vc(`Writing zeros for first ${n.offset} bytes`),i.push(bee(n.offset));i.push(See(e,n.length));let s=$Ue(HUe(i),l=>{if(r.unixfs&&!n.truncate){let f=r.unixfs.fileSize();if(f>l)return vc(`Writing last ${f-l} of ${f} bytes from original file starting at offset ${l}`),r.content({offset:l});vc("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),o;n.mode!==void 0&&n.mode!==null?o=Gc(n.mode):r&&r.unixfs&&(o=r.unixfs.mode);let a;n.mtime!=null?a=Zu(n.mtime):r&&r.unixfs&&(a=r.unixfs.mtime);let c=await t.hashers.getHasher(n.hashAlg),u=await(0,vee.default)(C0([{content:s,mode:o,mtime:a}],t.repo.blocks,{progress:n.progress,hasher:c,cidVersion:n.cidVersion,strategy:n.strategy,rawLeaves:n.rawLeaves,reduceSingleLeafToSelf:n.reduceSingleLeafToSelf,leafType:n.leafType}));if(!u)throw(0,Ec.default)(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return vc(`Wrote ${u.cid}`),{cid:u.cid,size:u.size}},See=(t,e)=>async function*(){let n=0;for await(let i of t){if(n+=i.length,n>e){yield i.slice(0,e-n);return}yield i}},bee=(t,e=T2)=>{let r=new Uint8Array(e);async function*n(){for(;;)yield r.slice()}return See(n(),t)},HUe=async function*(t){for(let e=0;e<t.length;e++)yield*t[e]()},$Ue=async function*(t,e){let r=0;for await(let n of t)r+=n.length,yield n;for await(let n of e(r))r+=n.length,yield n}});function Tee(t){async function*e(r,n={}){let i=await on(t,r,n),s=await gi(i.mfsPath,t.repo.blocks);if(s.type==="directory"){yield*(0,Iee.default)(s.content(n),Ree);return}yield Ree(s)}return Q(e)}var Iee,Ree,xee=w(()=>{da();mu();Ce();Iee=A(xi(),1),Ree=t=>{let e={cid:t.cid,name:t.name,type:t.type==="directory"?"directory":"file",size:t.size};return(t.type==="file"||t.type==="directory")&&(e.mode=t.unixfs.mode,e.mtime=t.unixfs.mtime),e}});function XUe(t){let{repoOwner:e}=Object.assign({},YUe||{},t),r=Xg(e),n=o=>r.readLock(o),i=o=>r.writeLock(o),s={};return Cee({options:t,mfs:s,operations:GUe,lock:n}),Cee({options:t,mfs:s,operations:WUe,lock:i}),Object.keys(Pee).forEach(o=>{s[o]=Pee[o](t)}),s}function Oee({repo:t,preload:e,hashers:r,options:n}){let i=XUe({repo:t,repoOwner:Boolean(n.repoOwner),hashers:r}),s=o=>(...c)=>{let u=c.filter(l=>qI.default.ipfsPath(l)||qI.default.cid(l));if(u.length){let l=c[c.length-1];l&&l.preload!==!1&&u.forEach(f=>e(f))}return o(...c)};return{...i,chmod:i.chmod,cp:s(i.cp),mkdir:i.mkdir,stat:s(i.stat),rm:i.rm,read:s(i.read),touch:i.touch,write:i.write,mv:s(i.mv),flush:i.flush,ls:s(async function*(...o){for await(let a of i.ls(...o))yield{...a,size:a.size||0}})}}var qI,GUe,WUe,Pee,Cee,YUe,kee=w(()=>{II();qI=A(Lp(),1);Qg();see();nb();aee();tb();uee();ib();dee();yee();Aee();xee();GUe={stat:Wl},WUe={chmod:iee,cp:r1,flush:oee,mkdir:$h,mv:cee,rm:n1,touch:hee},Pee={write:Eee,read:pee,ls:Tee},Cee=({options:t,mfs:e,operations:r,lock:n})=>{Object.keys(r).forEach(i=>{e[i]=n(r[i](t))})},YUe={repoOwner:!0,repo:null}});function Dee({keychain:t}){return Q((r,n)=>t.exportKey(r,n))}var Nee=w(()=>{Ce()});function Mee({keychain:t}){return Q((r,n={type:Bee,size:Lee})=>t.createKey(r,n.type||Bee,n.size||Lee))}var Bee,Lee,Uee=w(()=>{Ce();Bee="ed25519",Lee=2048});function qee({keychain:t}){return Q((r,n,i)=>t.importKey(r,n,i))}var Fee=w(()=>{Ce()});function Kee({keychain:t}){return Q(r=>t.findKeyByName(r))}var jee=w(()=>{Ce()});function Vee({keychain:t}){return Q(()=>t.listKeys())}var zee=w(()=>{Ce()});function Hee({keychain:t}){return Q(async(r,n)=>{let i=await t.renameKey(r,n);return{was:r,now:i.name,id:i.id,overwrite:!1}})}var $ee=w(()=>{Ce()});function Gee({keychain:t}){return Q(r=>t.removeKey(r))}var Wee=w(()=>{Ce()});var FI,Yee=w(()=>{Nee();Uee();Fee();jee();zee();$ee();Wee();FI=class{constructor({keychain:e}){this.gen=Mee({keychain:e}),this.list=Vee({keychain:e}),this.rm=Gee({keychain:e}),this.rename=Hee({keychain:e}),this.export=Dee({keychain:e}),this.import=qee({keychain:e}),this.info=Kee({keychain:e})}}});function ps({repo:t,preload:e}){async function r(n,i={}){i.preload!==!1&&e(n);let s=await t.blocks.get(n,i);return Ft(s)}return Q(r)}var Zl=w(()=>{xt();Ce()});function Xee({repo:t,preload:e}){let r=ps({repo:t,preload:e});async function n(i,s={}){return(await r(i,s)).Data||new Uint8Array(0)}return Q(n)}var Qee=w(()=>{Ce();Zl()});function KI(t,e=[]){for(let r in t){let n=t[r];if(r==="/"&&Object.keys(t).length===1)try{e.push({Name:"",Tsize:0,Hash:L.parse(n)});continue}catch{}let i=L.asCID(n);if(i){e.push({Name:"",Tsize:0,Hash:i});continue}Array.isArray(n)&&KI(n,e),n&&typeof n=="object"&&KI(n,e)}return e}function Zee({repo:t,codecs:e}){async function r(n,i={}){let s=await e.getCodec(n.code),o=await t.blocks.get(n,i),a=s.decode(o);switch(n.code){case ei:return[];case St:return a.Links;case oE:case hE:return KI(a);default:throw new Error(`Cannot resolve links from codec ${n.code}`)}}return Q(r)}var Jee=w(()=>{xt();bp();H4();eo();Se();Ce()});function ete({repo:t,preload:e}){async function r(n={}){let i;if(n.template)if(n.template==="unixfs-dir")i=new mt({type:"directory"}).marshal();else throw new Error("unknown template");let s=lt({Data:i,Links:[]}),o=await jr.digest(s),a=L.createV0(o);return await t.blocks.put(a,s,{signal:n.signal}),n.preload!==!1&&e(a),a}return Q(r)}var tte=w(()=>{xt();Tn();gn();Ce();Se()});function Sc({repo:t,preload:e}){async function r(n,i={}){let s=await t.gcLock.readLock();try{let o=lt(n),a=await jr.digest(o),c=L.createV1(St,a);return await t.blocks.put(c,o,{signal:i.signal}),i.preload!==!1&&e(c),i.pin&&await t.pins.pinRecursively(c,{signal:i.signal}),c}finally{s()}}return Q(r)}var s1=w(()=>{xt();Se();Tn();Ce()});function rte({repo:t,preload:e}){let r=ps({repo:t,preload:e});async function n(i,s={}){let o=await r(i,s),c=lt(o).length,u=o.Links.reduce((l,f)=>l+(f.Tsize||0),0);return{Hash:i,NumLinks:o.Links.length,BlockSize:c,LinksSize:c-(o.Data||[]).length,DataSize:(o.Data||[]).length,CumulativeSize:c+u}}return Q(n)}var nte=w(()=>{xt();Ce();Zl()});function ite({repo:t,preload:e}){let r=ps({repo:t,preload:e}),n=Sc({repo:t,preload:e});async function i(s,o,a={}){let c=await r(s,a);return n({...c,Links:c.Links.concat([o])},a)}return Q(i)}var ste=w(()=>{Ce();Zl();s1()});function ote({repo:t,preload:e}){let r=ps({repo:t,preload:e}),n=Sc({repo:t,preload:e});async function i(s,o,a={}){let c=await r(s,a),u=Kn([c.Data||[],o]);return n({...c,Data:u},a)}return Q(i)}var ate=w(()=>{Ce();Pn();Zl();s1()});function cte({repo:t,preload:e}){let r=ps({repo:t,preload:e}),n=Sc({repo:t,preload:e});async function i(s,o,a={}){let c=await r(s,a),u=(typeof o=="string"?o:o.Name)||"";return c.Links=c.Links.filter(l=>l.Name!==u),n(c,a)}return Q(i)}var ute=w(()=>{Ce();Zl();s1()});function lte({repo:t,preload:e}){let r=ps({repo:t,preload:e}),n=Sc({repo:t,preload:e});async function i(s,o,a={}){let c=await r(s,a);return n({...c,Data:o},a)}return Q(i)}var fte=w(()=>{Ce();Zl();s1()});var jI,hte=w(()=>{ste();ate();ute();fte();jI=class{constructor({repo:e,preload:r}){this.addLink=ite({repo:e,preload:r}),this.appendData=ote({repo:e,preload:r}),this.rmLink=cte({repo:e,preload:r}),this.setData=lte({repo:e,preload:r})}}});var VI,dte=w(()=>{Qee();Zl();Jee();tte();s1();nte();hte();VI=class{constructor({repo:e,codecs:r,preload:n}){this.data=Xee({repo:e,preload:n}),this.get=ps({repo:e,preload:n}),this.links=Zee({repo:e,codecs:r}),this.new=ete({repo:e,preload:n}),this.put=Sc({repo:e,preload:n}),this.stat=rte({repo:e,preload:n}),this.patch=new jI({repo:e,preload:n})}}});function yte({repo:t,hashers:e}){async function*r(n={}){let i=Date.now(),s;try{s=await Q0({repo:t,hashers:e},n),await t.pins.pinRecursively(s),yield*t.gc()}finally{s&&await t.pins.unpin(s)}QUe(`Complete (${Date.now()-i}ms)`)}return Q(r)}var pte,QUe,gte=w(()=>{pte=A(he(),1);Ce();Ww();QUe=(0,pte.default)("ipfs:repo:gc")});function sb({repo:t}){async function e(r={}){let n=await t.stat();return{numObjects:BigInt(n.numObjects.toString()),repoSize:BigInt(n.repoSize.toString()),repoPath:n.repoPath,version:`${n.version}`,storageMax:BigInt(n.storageMax.toString())}}return Q(e)}var zI=w(()=>{Ce()});var HI=w(()=>{});function mte({repo:t}){async function e(r={}){try{await t._checkInitialized(r)}catch(n){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(s=>s.test(n.message)))return 12;throw n}return t.version.get()}return Q(e)}var wte=w(()=>{Ce();HI()});var $I,bte=w(()=>{gte();zI();wte();$I=class{constructor({repo:e,hashers:r}){this.gc=yte({repo:e,hashers:r}),this.stat=sb({repo:e}),this.version=mte({repo:e}),this.setApiAddr=n=>e.apiAddr.set(n)}}});function _te(t,e){let r;if(t.metrics?e.peer?r=t.metrics.forPeer(Ete.default.parse(e.peer)):e.proto?r=t.metrics.forProtocol(e.proto):r=t.metrics.globalThis:r=void 0,!r)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};let{movingAverages:n,snapshot:i}=r;return{totalIn:BigInt(i.dataReceived.integerValue().toString()),totalOut:BigInt(i.dataSent.integerValue().toString()),rateIn:n.dataReceived[6e4].movingAverage()/60,rateOut:n.dataSent[6e4].movingAverage()/60}}function Ste({network:t}){return Q(async function*(r={}){let{libp2p:n}=await t.use(r);if(!r.poll){yield _te(n,r);return}let i=r.interval||1e3,s=-1;try{if(s=typeof i=="string"?hl(i)||-1:i,!s||s<0)throw new Error("invalid duration")}catch(a){throw(0,vte.default)(a,"ERR_INVALID_POLL_INTERVAL")}let o;try{for(;;)yield _te(n,r),await new Promise(a=>{o=setTimeout(a,s)})}finally{clearTimeout(o)}})}var vte,Ete,Ate=w(()=>{A2();vte=A(oe(),1);Ce();Ete=A(ft(),1)});var GI,Rte=w(()=>{Ate();zI();IA();GI=class{constructor({repo:e,network:r}){this.repo=sb({repo:e}),this.bw=Ste({network:r}),this.bitswap=C5({network:r})}}});var WI=g((rvt,Ite)=>{Ite.exports=JUe;function JUe(t,e,r){if(!t)return r;var n,i;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;)if(i=n.shift(),!t||(t=t[i],t===void 0))return r;return t}});var im=g((nvt,Tte)=>{"use strict";var eqe=async t=>{let e=0;for await(let r of t)e++;return e};Tte.exports=eqe});function Ote(t){return t.child?Ote(t.child):t}function rqe(t){try{let e=gr.decode(`b${t.toString().toLowerCase().slice(1)}`),r=L.decode(e).multihash.bytes,n=gr.encode(r).slice(1).toUpperCase();return new Oe(`/${n}`,!1)}catch{return t}}function nqe(t){try{let e=gr.decode(`b${t.toString().toLowerCase().slice(1)}`),r=mn(e),n=gr.encode(L.createV1(ei,r).bytes).slice(1);return new Oe(`/${n.toUpperCase()}`,!1)}catch{return t}}async function xte(t,e,r){let n=t.blocks;await n.open();let i=Ote(n),s=await(0,Cte.default)(i.queryKeys({filters:[o=>r(o).toString()!==o.toString()]}));try{let o=0;for await(let a of i.query({})){let c=r(a.key);c.toString()!==a.key.toString()&&(o+=1,tqe(`Migrating Block from ${a.key} to ${c}`,await i.has(a.key)),await i.delete(a.key),await i.put(c,a.value),e(o/s*100,`Migrated Block from ${a.key} to ${c}`))}}finally{await n.close()}}var Pte,Cte,tqe,kte,Dte=w(()=>{Se();Vr();Pte=A(he(),1),Cte=A(im(),1);fi();eo();li();tqe=(0,Pte.default)("ipfs:repo:migrator:migration-8");kte={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(t,e=()=>{})=>xte(t,e,rqe),revert:(t,e=()=>{})=>xte(t,e,nqe)}});var Gh,Nte,iqe,cvt,ob,Bte,Lte=w(()=>{Gh=A(Kr(),1),Nte=Gh.default.Reader,iqe=Gh.default.Writer,cvt=Gh.default.util,ob=Gh.default.roots.default||(Gh.default.roots.default={}),Bte=ob.ipfs=(()=>{let t={};return t.pin=function(){let e={};return e.Set=function(){function r(n){if(n)for(var i=Object.keys(n),s=0;s<i.length;++s)n[i[s]]!=null&&(this[i[s]]=n[i[s]])}return r.prototype.version=0,r.prototype.fanout=0,r.prototype.seed=0,r.encode=function(i,s){return s||(s=iqe.create()),i.version!=null&&Object.hasOwnProperty.call(i,"version")&&s.uint32(8).uint32(i.version),i.fanout!=null&&Object.hasOwnProperty.call(i,"fanout")&&s.uint32(16).uint32(i.fanout),i.seed!=null&&Object.hasOwnProperty.call(i,"seed")&&s.uint32(29).fixed32(i.seed),s},r.decode=function(i,s){i instanceof Nte||(i=Nte.create(i));for(var o=s===void 0?i.len:i.pos+s,a=new ob.ipfs.pin.Set;i.pos<o;){var c=i.uint32();switch(c>>>3){case 1:a.version=i.uint32();break;case 2:a.fanout=i.uint32();break;case 3:a.seed=i.fixed32();break;default:i.skipType(c&7);break}}return a},r.fromObject=function(i){if(i instanceof ob.ipfs.pin.Set)return i;var s=new ob.ipfs.pin.Set;return i.version!=null&&(s.version=i.version>>>0),i.fanout!=null&&(s.fanout=i.fanout>>>0),i.seed!=null&&(s.seed=i.seed>>>0),s},r.toObject=function(i,s){s||(s={});var o={};return s.defaults&&(o.version=0,o.fanout=0,o.seed=0),i.version!=null&&i.hasOwnProperty("version")&&(o.version=i.version),i.fanout!=null&&i.hasOwnProperty("fanout")&&(o.fanout=i.fanout),i.seed!=null&&i.hasOwnProperty("seed")&&(o.seed=i.seed),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,Gh.default.util.toJSONOptions)},r}(),e}(),t})()});var Ute=g((YI,Mte)=>{"use strict";Object.defineProperty(YI,"__esModule",{value:!0});ab.BASE=2166136261;function ab(t,e=ab.BASE){let r=t.length;for(let n=0;n<r;n++)e^=t.charCodeAt(n),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}YI.default=ab;Mte.exports=ab});function QI(t){return new Oe(`/${gr.encode(t.multihash.bytes).toUpperCase().substring(1)}`)}var sm,cb,qte,XI,Wh,ZI=w(()=>{Vr();fi();Se();sm=new Oe("/local/pins"),cb=256,qte=8192,XI=L.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),Wh={direct:"direct",recursive:"recursive"}});var Fte={};Tt(Fte,{compare:()=>om});function om(t,e){for(let r=0;r<t.byteLength;r++){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0}var ub=w(()=>{});function sqe(t){let e=t.Data;if(!e)throw new Error("No data present");let r=lb.default.decode(e),n=lb.default.decode.bytes;if(n<=0)throw new Error("Invalid Set header length");if(n+r>e.length)throw new Error("Impossibly large set header length");let i=e.slice(n,r+n),s=JI.toObject(JI.decode(i),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(s.version!==1)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>t.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:e.slice(r+n)}}function oqe(t,e){let r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,t,!0);let i=tt(e.toString()),s=Kn([r,i],r.byteLength+i.byteLength);return(0,Kte.default)(Xe(s))}async function*jte(t,e){let r=sqe(e),n=0;for(let i of e.Links){if(n<r.header.fanout){let s=i.Hash;if(!XI.equals(s)){let o=await t.get(s),a=Ft(o);yield*jte(t,a)}}else yield i.Hash;n++}}async function*am(t,e,r){let n=e.Links.find(o=>o.Name===r);if(!n)throw new Error("No link found with name "+r);let i=await t.get(n.Hash),s=Ft(i);yield*jte(t,s)}function aqe(t,e){return r(e,0);async function r(n,i){let s=JI.encode({version:1,fanout:cb,seed:i}).finish(),o=lb.default.encode(s.length),a=Kn([o,s]),c=[];for(let l=0;l<cb;l++)c.push({Name:"",Tsize:1,Hash:XI});if(n.length<=qte){let l=n.map(d=>({link:{Name:"",Tsize:1,Hash:d.key},data:d.data||new Uint8Array})).sort((d,p)=>om(d.link.Hash.bytes,p.link.Hash.bytes)),f=c.concat(l.map(d=>d.link));return{Data:Kn([a,...l.map(d=>d.data)]),Links:f}}else{let l=n.reduce((h,d)=>{let p=oqe(i,d.key)%cb;return h[p]=p in h?h[p].concat([d]):[d],h},[]),f=0;for(let h of l){let d=await r(h,i+1);await u(d,f),f++}return{Data:a,Links:c}}async function u(l,f){let h=lt(l),d=await jr.digest(h),p=L.createV0(d);await t.put(p,h);let y=l.Links.reduce((b,m)=>b+(m.Tsize||0),0)+h.length;c[f]={Name:"",Tsize:y,Hash:p}}}}async function eT(t,e,r){let n=await aqe(t,r.map(c=>({key:c}))),i=lt(n),s=await jr.digest(i),o=L.createV0(s);await t.put(o,i);let a=n.Links.reduce((c,u)=>c+u.Tsize,0)+i.length;return{Name:e,Tsize:a,Hash:o}}var Kte,lb,JI,Vte=w(()=>{Se();Lte();Kte=A(Ute(),1),lb=A(ns(),1);xt();ZI();Pn();ub();st();dt();Tn();JI=Bte.pin.Set});async function uqe(t,e,r,n){if(!await e.has(sm))return;let i=await e.get(sm),s=L.decode(i),o=await t.get(s),a=Ft(o),c=0,u=await(0,fb.default)(am(t,a,Wh.recursive))+await(0,fb.default)(am(t,a,Wh.direct));for await(let l of am(t,a,Wh.recursive)){c++;let f={depth:1/0};l.version!==0&&(f.version=l.version),l.code!==St&&(f.codec=l.code),await r.put(QI(l),es(f)),n(c/u*100,`Migrated recursive pin ${l}`)}for await(let l of am(t,a,Wh.direct)){c++;let f={depth:0};l.version!==0&&(f.version=l.version),l.code!==St&&(f.codec=l.code),await r.put(QI(l),es(f)),n(c/u*100,`Migrated direct pin ${l}`)}await t.delete(s),await e.delete(sm)}async function lqe(t,e,r,n){let i=[],s=[],o=0,a=await(0,fb.default)(r.queryKeys({}));for await(let{key:h,value:d}of r.query({})){o++;let p=Rn(d),y=L.create(p.version||0,p.codec||St,mn(gr.decode("b"+h.toString().toLowerCase().split("/").pop())));p.depth===0?(n(o/a*100,`Reverted direct pin ${y}`),s.push(y)):(n(o/a*100,`Reverted recursive pin ${y}`),i.push(y))}n(100,"Updating pin root");let c={Links:[await eT(t,Wh.direct,s),await eT(t,Wh.recursive,i)]},u=lt(c),l=await jr.digest(u),f=L.createV0(l);await t.put(f,u),await e.put(sm,f.bytes)}async function zte(t,e,r){let n=t.blocks,i=t.datastore,s=t.pins;await n.open(),await i.open(),await s.open();try{await r(n,i,s,e)}finally{await s.close(),await i.close(),await n.close()}}var fb,Hte,$te=w(()=>{Se();xt();sl();Vte();ZI();fb=A(im(),1);Tn();li();fi();Hte={version:9,description:"Migrates pins to datastore",migrate:(t,e=()=>{})=>zte(t,e,uqe),revert:(t,e=()=>{})=>zte(t,e,lqe)}});function um(t){let e=t;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function fqe(t,e,r){let n=await e(t);if(n)return n;let i=um(r);return i?new Promise((s,o)=>{let a=i.store("readonly").get(t.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function hqe(t,e,r,n){if(await r(t))return e(t);let i=um(n);if(!i)throw Cn();return new Promise((s,o)=>{let a=i.store("readonly").get(t.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(Cn())}})}function hb(t){let e=t.get.bind(t),r=t.has.bind(t);return t.get=n=>hqe(n,e,r,t),t.has=n=>fqe(n,r,t),t}function tT(t){return{...t,root:hb(t.root),datastore:hb(t.datastore),pins:hb(t.pins),keys:hb(t.keys)}}var Gte,cm,lm=w(()=>{Vr();lo();Gte=new Oe("/config"),cm=new Oe("/version")});async function dqe(t,e,r=()=>{}){let n=um(e);if(!n){r(`${t} did not need an upgrade`);return}r(`Upgrading ${t}`),await Qte(n,(s,o)=>[{type:"del",key:s},{type:"put",key:tt(s),value:o}])}async function pqe(t,e,r=()=>{}){let n=um(e);if(!n){r(`${t} did not need a downgrade`);return}r(`Downgrading ${t}`),await Qte(n,(s,o)=>[{type:"del",key:s},{type:"put",key:Xe(s),value:o}])}function Yte(t){return t.child?Yte(t.child):t}async function Wte(t,e,r){let n=Object.entries(t).map(([o,a])=>({key:o,backend:Yte(a)})).filter(({key:o,backend:a})=>a.constructor.name==="LevelDatastore").map(({key:o,backend:a})=>({name:o,store:a}));e(0,`Migrating ${n.length} dbs`);let i=0,s=o=>{e(Math.round(i/n.length*100),o)};for(let{name:o,store:a}of n){await a.open();try{await r(o,a,s)}finally{i++,await a.close()}}e(100,`Migrated ${n.length} dbs`)}function Qte(t,e){function r(n,i){let s=t.store("readwrite"),o=s.transaction,a=0,c;o.onabort=()=>i(c||o.error||new Error("aborted by user")),o.oncomplete=()=>i();function u(){let l=n[a++],f=l.key,h;try{h=l.type==="del"?s.delete(f):s.put(l.value,f)}catch(d){c=d,o.abort();return}a<n.length&&(h.onsuccess=u)}u()}return new Promise((n,i)=>{let s=t.iterator(),o=c=>c;s._deserializeKey=s._deserializeValue=o,a();function a(){let c=(u,l,f)=>{if(u||l===void 0){let h=d=>{if(d){i(d);return}n()};s.end(h);return}r(e(l,f),a)};s.next(c)}})}var Xte,Zte=w(()=>{lm();dt();st();Xte={version:10,description:"Migrates datastore-level keys to binary",migrate:(t,e=()=>{})=>Wte(t,e,dqe),revert:(t,e=()=>{})=>Wte(t,e,pqe)}});async function yqe(t,e=()=>{}){if(e(100,"Migrating MFS root to repo datastore"),await t.root.open(),await t.datastore.open(),await t.root.has(Jl)){let r=await t.root.get(Jl);await t.datastore.put(Jl,r),await t.root.delete(Jl)}await t.datastore.close(),await t.root.close(),e(100,"Stored MFS root in repo datastore")}async function gqe(t,e=()=>{}){if(e(100,"Migrating MFS root to repo root datastore"),await t.root.open(),await t.datastore.open(),await t.datastore.has(Jl)){let r=await t.datastore.get(Jl);await t.root.put(Jl,r),await t.datastore.delete(Jl)}await t.datastore.close(),await t.root.close(),e(100,"Stored MFS root in repo root datastore")}var Jl,Jte,ere=w(()=>{Vr();Jl=new Oe("/local/filesroot");Jte={version:11,description:"Store mfs root in the datastore",migrate:yqe,revert:gqe}});var Yh,tre,mqe,wqe,db,rT,rre=w(()=>{Yh=A(Kr(),1),tre=Yh.default.Reader,mqe=Yh.default.Writer,wqe=Yh.default.util,db=Yh.default.roots.default||(Yh.default.roots.default={}),rT=db.Protocols=(()=>{function t(e){if(this.protocols=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.protocols=wqe.emptyArray,t.encode=function(r,n){if(n||(n=mqe.create()),r.protocols!=null&&r.protocols.length)for(var i=0;i<r.protocols.length;++i)n.uint32(10).string(r.protocols[i]);return n},t.decode=function(r,n){r instanceof tre||(r=tre.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new db.Protocols;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof db.Protocols)return r;var n=new db.Protocols;if(r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Protocols.protocols: array expected");n.protocols=[];for(var i=0;i<r.protocols.length;++i)n.protocols[i]=String(r.protocols[i])}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.protocols=[]),r.protocols&&r.protocols.length){i.protocols=[];for(var s=0;s<r.protocols.length;++s)i.protocols[s]=r.protocols[s]}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Yh.default.util.toJSONOptions)},t})()});var wu,o1,nT,Gr,oi,iT,nre=w(()=>{wu=A(Kr(),1),o1=wu.default.Reader,nT=wu.default.Writer,Gr=wu.default.util,oi=wu.default.roots.default||(wu.default.roots.default={}),iT=oi.Addresses=(()=>{function t(e){if(this.addrs=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.addrs=Gr.emptyArray,t.prototype.certifiedRecord=null,t.encode=function(r,n){if(n||(n=nT.create()),r.addrs!=null&&r.addrs.length)for(var i=0;i<r.addrs.length;++i)oi.Addresses.Address.encode(r.addrs[i],n.uint32(10).fork()).ldelim();return r.certifiedRecord!=null&&Object.hasOwnProperty.call(r,"certifiedRecord")&&oi.Addresses.CertifiedRecord.encode(r.certifiedRecord,n.uint32(18).fork()).ldelim(),n},t.decode=function(r,n){r instanceof o1||(r=o1.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new oi.Addresses;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(oi.Addresses.Address.decode(r,r.uint32()));break;case 2:s.certifiedRecord=oi.Addresses.CertifiedRecord.decode(r,r.uint32());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof oi.Addresses)return r;var n=new oi.Addresses;if(r.addrs){if(!Array.isArray(r.addrs))throw TypeError(".Addresses.addrs: array expected");n.addrs=[];for(var i=0;i<r.addrs.length;++i){if(typeof r.addrs[i]!="object")throw TypeError(".Addresses.addrs: object expected");n.addrs[i]=oi.Addresses.Address.fromObject(r.addrs[i])}}if(r.certifiedRecord!=null){if(typeof r.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");n.certifiedRecord=oi.Addresses.CertifiedRecord.fromObject(r.certifiedRecord)}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addrs=[]),n.defaults&&(i.certifiedRecord=null),r.addrs&&r.addrs.length){i.addrs=[];for(var s=0;s<r.addrs.length;++s)i.addrs[s]=oi.Addresses.Address.toObject(r.addrs[s],n)}return r.certifiedRecord!=null&&r.hasOwnProperty("certifiedRecord")&&(i.certifiedRecord=oi.Addresses.CertifiedRecord.toObject(r.certifiedRecord,n)),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,wu.default.util.toJSONOptions)},t.Address=function(){function e(n){if(n)for(var i=Object.keys(n),s=0;s<i.length;++s)n[i[s]]!=null&&(this[i[s]]=n[i[s]])}e.prototype.multiaddr=Gr.newBuffer([]),e.prototype.isCertified=null;let r;return Object.defineProperty(e.prototype,"_isCertified",{get:Gr.oneOfGetter(r=["isCertified"]),set:Gr.oneOfSetter(r)}),e.encode=function(i,s){return s||(s=nT.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&s.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&s.uint32(16).bool(i.isCertified),s},e.decode=function(i,s){i instanceof o1||(i=o1.create(i));for(var o=s===void 0?i.len:i.pos+s,a=new oi.Addresses.Address;i.pos<o;){var c=i.uint32();switch(c>>>3){case 1:a.multiaddr=i.bytes();break;case 2:a.isCertified=i.bool();break;default:i.skipType(c&7);break}}return a},e.fromObject=function(i){if(i instanceof oi.Addresses.Address)return i;var s=new oi.Addresses.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?Gr.base64.decode(i.multiaddr,s.multiaddr=Gr.newBuffer(Gr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(s.multiaddr=i.multiaddr)),i.isCertified!=null&&(s.isCertified=Boolean(i.isCertified)),s},e.toObject=function(i,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.multiaddr="":(o.multiaddr=[],s.bytes!==Array&&(o.multiaddr=Gr.newBuffer(o.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(o.multiaddr=s.bytes===String?Gr.base64.encode(i.multiaddr,0,i.multiaddr.length):s.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(o.isCertified=i.isCertified,s.oneofs&&(o._isCertified="isCertified")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,wu.default.util.toJSONOptions)},e}(),t.CertifiedRecord=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.seq=Gr.Long?Gr.Long.fromBits(0,0,!0):0,e.prototype.raw=Gr.newBuffer([]),e.encode=function(n,i){return i||(i=nT.create()),n.seq!=null&&Object.hasOwnProperty.call(n,"seq")&&i.uint32(8).uint64(n.seq),n.raw!=null&&Object.hasOwnProperty.call(n,"raw")&&i.uint32(18).bytes(n.raw),i},e.decode=function(n,i){n instanceof o1||(n=o1.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new oi.Addresses.CertifiedRecord;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.seq=n.uint64();break;case 2:o.raw=n.bytes();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof oi.Addresses.CertifiedRecord)return n;var i=new oi.Addresses.CertifiedRecord;return n.seq!=null&&(Gr.Long?(i.seq=Gr.Long.fromValue(n.seq)).unsigned=!0:typeof n.seq=="string"?i.seq=parseInt(n.seq,10):typeof n.seq=="number"?i.seq=n.seq:typeof n.seq=="object"&&(i.seq=new Gr.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0))),n.raw!=null&&(typeof n.raw=="string"?Gr.base64.decode(n.raw,i.raw=Gr.newBuffer(Gr.base64.length(n.raw)),0):n.raw.length&&(i.raw=n.raw)),i},e.toObject=function(n,i){i||(i={});var s={};if(i.defaults){if(Gr.Long){var o=new Gr.Long(0,0,!0);s.seq=i.longs===String?o.toString():i.longs===Number?o.toNumber():o}else s.seq=i.longs===String?"0":0;i.bytes===String?s.raw="":(s.raw=[],i.bytes!==Array&&(s.raw=Gr.newBuffer(s.raw)))}return n.seq!=null&&n.hasOwnProperty("seq")&&(typeof n.seq=="number"?s.seq=i.longs===String?String(n.seq):n.seq:s.seq=i.longs===String?Gr.Long.prototype.toString.call(n.seq):i.longs===Number?new Gr.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0):n.seq),n.raw!=null&&n.hasOwnProperty("raw")&&(s.raw=i.bytes===String?Gr.base64.encode(n.raw,0,n.raw.length):i.bytes===Array?Array.prototype.slice.call(n.raw):n.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,wu.default.util.toJSONOptions)},e}(),t})()});var bu,a1,sT,dr,kn,oT,Uvt,qvt,ire=w(()=>{bu=A(Kr(),1),a1=bu.default.Reader,sT=bu.default.Writer,dr=bu.default.util,kn=bu.default.roots.default||(bu.default.roots.default={}),oT=kn.Peer=(()=>{function t(r){if(this.addresses=[],this.protocols=[],this.metadata=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}t.prototype.addresses=dr.emptyArray,t.prototype.protocols=dr.emptyArray,t.prototype.metadata=dr.emptyArray,t.prototype.pubKey=null,t.prototype.peerRecordEnvelope=null;let e;return Object.defineProperty(t.prototype,"_pubKey",{get:dr.oneOfGetter(e=["pubKey"]),set:dr.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_peerRecordEnvelope",{get:dr.oneOfGetter(e=["peerRecordEnvelope"]),set:dr.oneOfSetter(e)}),t.encode=function(n,i){if(i||(i=sT.create()),n.addresses!=null&&n.addresses.length)for(var s=0;s<n.addresses.length;++s)kn.Address.encode(n.addresses[s],i.uint32(10).fork()).ldelim();if(n.protocols!=null&&n.protocols.length)for(var s=0;s<n.protocols.length;++s)i.uint32(18).string(n.protocols[s]);if(n.metadata!=null&&n.metadata.length)for(var s=0;s<n.metadata.length;++s)kn.Metadata.encode(n.metadata[s],i.uint32(26).fork()).ldelim();return n.pubKey!=null&&Object.hasOwnProperty.call(n,"pubKey")&&i.uint32(34).bytes(n.pubKey),n.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(n,"peerRecordEnvelope")&&i.uint32(42).bytes(n.peerRecordEnvelope),i},t.decode=function(n,i){n instanceof a1||(n=a1.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new kn.Peer;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(kn.Address.decode(n,n.uint32()));break;case 2:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(n.string());break;case 3:o.metadata&&o.metadata.length||(o.metadata=[]),o.metadata.push(kn.Metadata.decode(n,n.uint32()));break;case 4:o.pubKey=n.bytes();break;case 5:o.peerRecordEnvelope=n.bytes();break;default:n.skipType(a&7);break}}return o},t.fromObject=function(n){if(n instanceof kn.Peer)return n;var i=new kn.Peer;if(n.addresses){if(!Array.isArray(n.addresses))throw TypeError(".Peer.addresses: array expected");i.addresses=[];for(var s=0;s<n.addresses.length;++s){if(typeof n.addresses[s]!="object")throw TypeError(".Peer.addresses: object expected");i.addresses[s]=kn.Address.fromObject(n.addresses[s])}}if(n.protocols){if(!Array.isArray(n.protocols))throw TypeError(".Peer.protocols: array expected");i.protocols=[];for(var s=0;s<n.protocols.length;++s)i.protocols[s]=String(n.protocols[s])}if(n.metadata){if(!Array.isArray(n.metadata))throw TypeError(".Peer.metadata: array expected");i.metadata=[];for(var s=0;s<n.metadata.length;++s){if(typeof n.metadata[s]!="object")throw TypeError(".Peer.metadata: object expected");i.metadata[s]=kn.Metadata.fromObject(n.metadata[s])}}return n.pubKey!=null&&(typeof n.pubKey=="string"?dr.base64.decode(n.pubKey,i.pubKey=dr.newBuffer(dr.base64.length(n.pubKey)),0):n.pubKey.length&&(i.pubKey=n.pubKey)),n.peerRecordEnvelope!=null&&(typeof n.peerRecordEnvelope=="string"?dr.base64.decode(n.peerRecordEnvelope,i.peerRecordEnvelope=dr.newBuffer(dr.base64.length(n.peerRecordEnvelope)),0):n.peerRecordEnvelope.length&&(i.peerRecordEnvelope=n.peerRecordEnvelope)),i},t.toObject=function(n,i){i||(i={});var s={};if((i.arrays||i.defaults)&&(s.addresses=[],s.protocols=[],s.metadata=[]),n.addresses&&n.addresses.length){s.addresses=[];for(var o=0;o<n.addresses.length;++o)s.addresses[o]=kn.Address.toObject(n.addresses[o],i)}if(n.protocols&&n.protocols.length){s.protocols=[];for(var o=0;o<n.protocols.length;++o)s.protocols[o]=n.protocols[o]}if(n.metadata&&n.metadata.length){s.metadata=[];for(var o=0;o<n.metadata.length;++o)s.metadata[o]=kn.Metadata.toObject(n.metadata[o],i)}return n.pubKey!=null&&n.hasOwnProperty("pubKey")&&(s.pubKey=i.bytes===String?dr.base64.encode(n.pubKey,0,n.pubKey.length):i.bytes===Array?Array.prototype.slice.call(n.pubKey):n.pubKey,i.oneofs&&(s._pubKey="pubKey")),n.peerRecordEnvelope!=null&&n.hasOwnProperty("peerRecordEnvelope")&&(s.peerRecordEnvelope=i.bytes===String?dr.base64.encode(n.peerRecordEnvelope,0,n.peerRecordEnvelope.length):i.bytes===Array?Array.prototype.slice.call(n.peerRecordEnvelope):n.peerRecordEnvelope,i.oneofs&&(s._peerRecordEnvelope="peerRecordEnvelope")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,bu.default.util.toJSONOptions)},t})(),Uvt=kn.Address=(()=>{function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}t.prototype.multiaddr=dr.newBuffer([]),t.prototype.isCertified=null;let e;return Object.defineProperty(t.prototype,"_isCertified",{get:dr.oneOfGetter(e=["isCertified"]),set:dr.oneOfSetter(e)}),t.encode=function(n,i){return i||(i=sT.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&i.uint32(16).bool(n.isCertified),i},t.decode=function(n,i){n instanceof a1||(n=a1.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new kn.Address;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;case 2:o.isCertified=n.bool();break;default:n.skipType(a&7);break}}return o},t.fromObject=function(n){if(n instanceof kn.Address)return n;var i=new kn.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?dr.base64.decode(n.multiaddr,i.multiaddr=dr.newBuffer(dr.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),n.isCertified!=null&&(i.isCertified=Boolean(n.isCertified)),i},t.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=dr.newBuffer(s.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?dr.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(s.isCertified=n.isCertified,i.oneofs&&(s._isCertified="isCertified")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,bu.default.util.toJSONOptions)},t})(),qvt=kn.Metadata=(()=>{function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.key="",t.prototype.value=dr.newBuffer([]),t.encode=function(r,n){return n||(n=sT.create()),r.key!=null&&Object.hasOwnProperty.call(r,"key")&&n.uint32(10).string(r.key),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&n.uint32(18).bytes(r.value),n},t.decode=function(r,n){r instanceof a1||(r=a1.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new kn.Metadata;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.key=r.string();break;case 2:s.value=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof kn.Metadata)return r;var n=new kn.Metadata;return r.key!=null&&(n.key=String(r.key)),r.value!=null&&(typeof r.value=="string"?dr.base64.decode(r.value,n.value=dr.newBuffer(dr.base64.length(r.value)),0):r.value.length&&(n.value=r.value)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.key="",n.bytes===String?i.value="":(i.value=[],n.bytes!==Array&&(i.value=dr.newBuffer(i.value)))),r.key!=null&&r.hasOwnProperty("key")&&(i.key=r.key),r.value!=null&&r.hasOwnProperty("value")&&(i.value=n.bytes===String?dr.base64.encode(r.value,0,r.value.length):n.bytes===Array?Array.prototype.slice.call(r.value):r.value),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,bu.default.util.toJSONOptions)},t})()});var Xh,sre,bqe,Wr,pb,ore,are=w(()=>{Xh=A(Kr(),1),sre=Xh.default.Reader,bqe=Xh.default.Writer,Wr=Xh.default.util,pb=Xh.default.roots.default||(Xh.default.roots.default={}),ore=pb.Envelope=(()=>{function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.publicKey=Wr.newBuffer([]),t.prototype.payloadType=Wr.newBuffer([]),t.prototype.payload=Wr.newBuffer([]),t.prototype.signature=Wr.newBuffer([]),t.encode=function(r,n){return n||(n=bqe.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&n.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&n.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&n.uint32(42).bytes(r.signature),n},t.decode=function(r,n){r instanceof sre||(r=sre.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new pb.Envelope;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof pb.Envelope)return r;var n=new pb.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?Wr.base64.decode(r.publicKey,n.publicKey=Wr.newBuffer(Wr.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?Wr.base64.decode(r.payloadType,n.payloadType=Wr.newBuffer(Wr.base64.length(r.payloadType)),0):r.payloadType.length&&(n.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?Wr.base64.decode(r.payload,n.payload=Wr.newBuffer(Wr.base64.length(r.payload)),0):r.payload.length&&(n.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?Wr.base64.decode(r.signature,n.signature=Wr.newBuffer(Wr.base64.length(r.signature)),0):r.signature.length&&(n.signature=r.signature)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=Wr.newBuffer(i.publicKey))),n.bytes===String?i.payloadType="":(i.payloadType=[],n.bytes!==Array&&(i.payloadType=Wr.newBuffer(i.payloadType))),n.bytes===String?i.payload="":(i.payload=[],n.bytes!==Array&&(i.payload=Wr.newBuffer(i.payload))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=Wr.newBuffer(i.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?Wr.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(i.payloadType=n.bytes===String?Wr.base64.encode(r.payloadType,0,r.payloadType.length):n.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(i.payload=n.bytes===String?Wr.base64.encode(r.payload,0,r.payload.length):n.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(i.signature=n.bytes===String?Wr.base64.encode(r.signature,0,r.signature.length):n.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Xh.default.util.toJSONOptions)},t})()});var ef,yb,cre,an,ga,ure,lre=w(()=>{ef=A(Kr(),1),yb=ef.default.Reader,cre=ef.default.Writer,an=ef.default.util,ga=ef.default.roots.default||(ef.default.roots.default={}),ure=ga.PeerRecord=(()=>{function t(e){if(this.addresses=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.peerId=an.newBuffer([]),t.prototype.seq=an.Long?an.Long.fromBits(0,0,!0):0,t.prototype.addresses=an.emptyArray,t.encode=function(r,n){if(n||(n=cre.create()),r.peerId!=null&&Object.hasOwnProperty.call(r,"peerId")&&n.uint32(10).bytes(r.peerId),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&n.uint32(16).uint64(r.seq),r.addresses!=null&&r.addresses.length)for(var i=0;i<r.addresses.length;++i)ga.PeerRecord.AddressInfo.encode(r.addresses[i],n.uint32(26).fork()).ldelim();return n},t.decode=function(r,n){r instanceof yb||(r=yb.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ga.PeerRecord;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.peerId=r.bytes();break;case 2:s.seq=r.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(ga.PeerRecord.AddressInfo.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof ga.PeerRecord)return r;var n=new ga.PeerRecord;if(r.peerId!=null&&(typeof r.peerId=="string"?an.base64.decode(r.peerId,n.peerId=an.newBuffer(an.base64.length(r.peerId)),0):r.peerId.length&&(n.peerId=r.peerId)),r.seq!=null&&(an.Long?(n.seq=an.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?n.seq=parseInt(r.seq,10):typeof r.seq=="number"?n.seq=r.seq:typeof r.seq=="object"&&(n.seq=new an.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".PeerRecord.addresses: array expected");n.addresses=[];for(var i=0;i<r.addresses.length;++i){if(typeof r.addresses[i]!="object")throw TypeError(".PeerRecord.addresses: object expected");n.addresses[i]=ga.PeerRecord.AddressInfo.fromObject(r.addresses[i])}}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addresses=[]),n.defaults)if(n.bytes===String?i.peerId="":(i.peerId=[],n.bytes!==Array&&(i.peerId=an.newBuffer(i.peerId))),an.Long){var s=new an.Long(0,0,!0);i.seq=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.seq=n.longs===String?"0":0;if(r.peerId!=null&&r.hasOwnProperty("peerId")&&(i.peerId=n.bytes===String?an.base64.encode(r.peerId,0,r.peerId.length):n.bytes===Array?Array.prototype.slice.call(r.peerId):r.peerId),r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?i.seq=n.longs===String?String(r.seq):r.seq:i.seq=n.longs===String?an.Long.prototype.toString.call(r.seq):n.longs===Number?new an.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.addresses&&r.addresses.length){i.addresses=[];for(var o=0;o<r.addresses.length;++o)i.addresses[o]=ga.PeerRecord.AddressInfo.toObject(r.addresses[o],n)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ef.default.util.toJSONOptions)},t.AddressInfo=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.multiaddr=an.newBuffer([]),e.encode=function(n,i){return i||(i=cre.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),i},e.decode=function(n,i){n instanceof yb||(n=yb.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new ga.PeerRecord.AddressInfo;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof ga.PeerRecord.AddressInfo)return n;var i=new ga.PeerRecord.AddressInfo;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?an.base64.decode(n.multiaddr,i.multiaddr=an.newBuffer(an.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),i},e.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=an.newBuffer(s.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?an.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,ef.default.util.toJSONOptions)},e}(),t})()});async function _qe(t,e=()=>{}){e(0,"Storing each peerstore key under a single datastore key"),await t.datastore.open();let r={},n=[];for await(let{key:i,value:s}of t.datastore.query({prefix:"/peers"})){n.push(i);let o=i.toString(),[a,c,u,l,f]=o.split("/");if(c==="peers"&&!!["protos","addrs","metadata","keys"].includes(u)&&!!l)if(r[l]=r[l]||{addresses:[],protocols:[],metadata:[]},u==="protos"){let h=rT.decode(s);r[l].protocols=h.protocols.sort()}else if(u==="addrs"){let h=iT.decode(s);r[l].addresses=h.addrs.sort((d,p)=>new aT.Multiaddr(d.multiaddr).toString().localeCompare(new aT.Multiaddr(p.multiaddr).toString())),h.certifiedRecord&&h.certifiedRecord.raw&&(r[l].peerRecordEnvelope=h.certifiedRecord.raw)}else u==="metadata"?r[l].metadata.push({key:f,value:s}):u==="keys"&&(r[l].pubKey=s)}e(33,"Read peer data from store");for(let i of n)await t.datastore.delete(i);e(66,"Removed existing peer data from store");for(let i of Object.keys(r)){let s=r[i];s.metadata=s.metadata.sort((a,c)=>a.key.localeCompare(c.key));let o=oT.encode(s).finish();await t.datastore.put(new Oe(`/peers/${i}`),o)}await t.datastore.close(),e(100,"Stored each peerstore key under a single datastore key")}async function vqe(t,e=()=>{}){e(0,"Storing each peerstore key under a multiple datastore keys"),await t.datastore.open();let r={},n=[];for await(let{key:i,value:s}of t.datastore.query({prefix:"/peers"})){n.push(i);let o=i.toString(),[a,c,u]=o.split("/");r[u]=oT.decode(s)}e(33,"Read peer data from store");for(let i of n)await t.datastore.delete(i);e(66,"Removed existing peer data from store");for(let[i,s]of Object.entries(r)){if(s.protocols&&s.protocols.length>0&&await t.datastore.put(new Oe(`/peers/protos/${i}`),rT.encode({protocols:s.protocols}).finish()),s.addresses&&s.addresses.length>0){let o=s.peerRecordEnvelope,a;if(o){let c=ore.decode(o),u=ure.decode(c.payload);a={raw:o,seq:u.seq}}await t.datastore.put(new Oe(`/peers/addrs/${i}`),iT.encode({addrs:s.addresses,certifiedRecord:a}).finish())}if(s.metadata&&s.metadata.length>0)for(let{key:o,value:a}of s.metadata)await t.datastore.put(new Oe(`/peers/metadata/${i}/${o}`),a);s.pubKey&&await t.datastore.put(new Oe(`/peers/keys/${i}`),s.pubKey)}await t.datastore.close(),e(100,"Stored each peerstore key under multiple datastore keys")}var cT,aT,fre,hre=w(()=>{cT=A(Kr(),1);Vr();rre();nre();ire();are();lre();aT=A(yt(),1);cT.default.util.Long=void 0;cT.default.configure();fre={version:12,description:"Store each peerstore peer under a single datastore key",migrate:_qe,revert:vqe}});var Qh,gb,dre=w(()=>{Dte();$te();Zte();ere();hre();Qh={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},gb=[Object.assign({version:1},Qh),Object.assign({version:2},Qh),Object.assign({version:3},Qh),Object.assign({version:4},Qh),Object.assign({version:5},Qh),Object.assign({version:6},Qh),Object.assign({version:7},Qh),kte,Hte,Xte,Jte,fre]});var uT={};Tt(uT,{InvalidValueError:()=>dm,MissingRepoOptionsError:()=>_u,NonReversibleMigrationError:()=>fm,NotInitializedRepoError:()=>Zh,RequiredParameterError:()=>hm});var fm,Zh,hm,dm,_u,mb=w(()=>{fm=class extends Error{constructor(e){super(e);this.name="NonReversibleMigrationError",this.code=fm.code,this.message=e}};fm.code="ERR_NON_REVERSIBLE_MIGRATION";Zh=class extends Error{constructor(e){super(e);this.name="NotInitializedRepoError",this.code=Zh.code,this.message=e}};Zh.code="ERR_NOT_INITIALIZED_REPO";hm=class extends Error{constructor(e){super(e);this.name="RequiredParameterError",this.code=hm.code,this.message=e}};hm.code="ERR_REQUIRED_PARAMETER";dm=class extends Error{constructor(e){super(e);this.name="InvalidValueError",this.code=dm.code,this.message=e}};dm.code="ERR_INVALID_VALUE";_u=class extends Error{constructor(e){super(e);this.name="MissingRepoOptionsError",this.code=_u.code,this.message=e}};_u.code="ERR_MISSING_REPO_OPTIONS"});async function yre(t){if(!t)throw new _u("Please pass repo options when trying to open a repo");let e=t.root;try{await e.open();let r=await e.has(cm),n=await e.has(Gte);return!r||!n?(lT(`Version entry present: ${r}`),lT(`Config entry present: ${n}`),!1):!0}catch(r){return lT("While checking if repo is initialized error was thrown: "+r.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}var pre,lT,gre=w(()=>{pre=A(he(),1);lm();mb();lT=(0,pre.default)("ipfs:repo:migrator:repo:init")});async function fT(t){if(!await yre(t))throw new Zh("Repo is not initialized!");let e=t.root;await e.open();try{return parseInt(Xe(await e.get(cm)))}finally{await e.close()}}async function pm(t,e){if(!e)throw new _u("Please pass repo options when trying to open a repo");let r=e.root;await r.open(),await r.put(cm,tt(String(t))),await r.close()}var mre=w(()=>{gre();mb();lm();dt();st()});function Sqe(t){return t=t||gb,!Array.isArray(t)||t.length===0?0:t[t.length-1].version}async function bre(t,e,r,n,{ignoreLock:i=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||gb,!t)throw new So.RequiredParameterError("Path argument is required!");if(!r)throw new So.RequiredParameterError("repoOptions argument is required!");if(!n)throw new So.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new So.InvalidValueError("Version has to be positive integer!");e=tT(e);let c=await fT(e);if(c===n){ma("Nothing to migrate.");return}if(c>n)throw new So.InvalidValueError(`Current repo's version (${c}) is higher then toVersion (${n}), you probably wanted to revert it?`);vre(a,c,n);let u;!o&&!i&&(u=await r.repoLock.lock(t));try{for(let l of a){if(n!==void 0&&l.version>n)break;if(!(l.version<=c)){ma(`Migrating version ${l.version}`);try{if(!o){let f=()=>{};s&&(f=(h,d)=>s(l.version,h.toFixed(2),d)),await l.migrate(e,f)}}catch(f){let h=l.version-1;throw ma(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${h}`),await pm(h,e),new Error(`During migration to version ${l.version} exception was raised: ${f.stack||f.message||f}`)}ma(`Migrating to version ${l.version} finished`)}}o||await pm(n||Sqe(a),e),ma("Repo successfully migrated",n!==void 0?`to version ${n}!`:"to latest version!")}finally{!o&&!i&&u&&await u.close()}}async function _re(t,e,r,n,{ignoreLock:i=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||gb,!t)throw new So.RequiredParameterError("Path argument is required!");if(!r)throw new So.RequiredParameterError("repoOptions argument is required!");if(!n)throw new So.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new So.InvalidValueError("Version has to be positive integer!");e=tT(e);let c=await fT(e);if(c===n){ma("Nothing to revert.");return}if(c<n)throw new So.InvalidValueError(`Current repo's version (${c}) is lower then toVersion (${n}), you probably wanted to migrate it?`);vre(a,n,c,!0);let u;!o&&!i&&(u=await r.repoLock.lock(t)),ma(`Reverting from version ${c} to ${n}`);try{let l=a.slice().reverse();for(let f of l){if(f.version<=n)break;if(!(f.version>c)){ma(`Reverting migration version ${f.version}`);try{if(!o){let h=()=>{};s&&(h=(d,p)=>s(f.version,d.toFixed(2),p)),await f.revert(e,h)}}catch(h){let d=f.version;throw ma(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${d}`),await pm(d,e),h.message=`During reversion to version ${f.version} exception was raised: ${h.message}`,h}ma(`Reverting to version ${f.version} finished`)}}o||await pm(n,e),ma(`All migrations successfully reverted to version ${n}!`)}finally{!o&&!i&&u&&await u.close()}}function vre(t,e,r,n=!1){let i=0;for(let s of t){if(s.version>r)break;if(s.version>e){if(n&&!s.revert)throw new So.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${s.version} is not reversible. Cancelling reversion.`);i++}}if(i!==r-e)throw new So.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${r}`)}var wre,ma,So,Ere=w(()=>{dre();mre();mb();lm();wre=A(he(),1),ma=(0,wre.default)("ipfs:repo:migrator");So=uT});var Rre=g((h7t,wb)=>{"use strict";wb.exports=xqe;wb.exports.format=Sre;wb.exports.parse=Are;var Rqe=/\B(?=(\d{3})+(?!\d))/g,Iqe=/(?:\.0*|(\.[^0]+)0+)$/,tf={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},Tqe=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function xqe(t,e){return typeof t=="string"?Are(t):typeof t=="number"?Sre(t,e):null}function Sre(t,e){if(!Number.isFinite(t))return null;var r=Math.abs(t),n=e&&e.thousandsSeparator||"",i=e&&e.unitSeparator||"",s=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,o=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!tf[a.toLowerCase()])&&(r>=tf.pb?a="PB":r>=tf.tb?a="TB":r>=tf.gb?a="GB":r>=tf.mb?a="MB":r>=tf.kb?a="KB":a="B");var c=t/tf[a.toLowerCase()],u=c.toFixed(s);return o||(u=u.replace(Iqe,"$1")),n&&(u=u.split(".").map(function(l,f){return f===0?l.replace(Rqe,n):l}).join(".")),u+i+a}function Are(t){if(typeof t=="number"&&!isNaN(t))return t;if(typeof t!="string")return null;var e=Tqe.exec(t),r,n="b";return e?(r=parseFloat(e[1]),n=e[4].toLowerCase()):(r=parseInt(t,10),n="b"),isNaN(r)?null:Math.floor(tf[n]*r)}});var c1,Ao,u1,Jh,Ire,Tre,l1=w(()=>{c1=class extends Error{constructor(e){super(e);this.name="LockExistsError",this.code=c1.code}};c1.code="ERR_LOCK_EXISTS";Ao=class extends Error{constructor(e){super(e);this.name="NotFoundError",this.code=Ao.code}};Ao.code="ERR_NOT_FOUND";u1=class extends Error{constructor(e){super(e);this.name="InvalidRepoVersionError",this.code=u1.code}};u1.code="ERR_INVALID_REPO_VERSION";Jh="ERR_REPO_NOT_INITIALIZED",Ire="ERR_REPO_ALREADY_OPEN",Tre="ERR_REPO_ALREADY_CLOSED"});async function bb(t,e,r){let n=await e(t);if(n)return n;let i=xre(r);return i?new Promise((s,o)=>{let a=i.store("readonly").get(t.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function _b(t,e,r,n){if(await r(t))return e(t);let i=xre(n);if(!i)throw new Ao;return new Promise((s,o)=>{let a=i.store("readonly").get(t.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(new Ao)}})}function xre(t){let e=t;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}var hT=w(()=>{l1()});function Cre(t){return{async exists(){return bb(dT,t.has.bind(t),t)},async get(){let e=await _b(dT,t.get.bind(t),t.has.bind(t),t);return parseInt(Xe(e),10)},set(e){return t.put(dT,tt(String(e)))},async check(e){let r=await this.get();return Cqe("comparing version: %s and %s",r,e),r===e||(r===6&&e===7||e===6&&r===7)}}}var Pre,Cqe,dT,Ore=w(()=>{Vr();Pre=A(he(),1);st();dt();hT();Cqe=(0,Pre.default)("ipfs:repo:version"),dT=new Oe("version")});function Nre(t){let e=new Oqe({concurrency:1}),r={async getAll(s={}){let o=await _b(pT,t.get.bind(t),t.has.bind(t),t);return JSON.parse(Xe(o))},async get(s,o={}){if(s==null)throw new Ao(`Key ${s} does not exist in config`);let a=await this.getAll(o),c=(0,kre.default)(a,s);if(c===void 0)throw new Ao(`Key ${s} does not exist in config`);return c},set(s,o,a={}){if(typeof s!="string"&&!(s instanceof String))throw(0,Eb.default)(new Error("Invalid key type: "+typeof s),"ERR_INVALID_KEY");if(o===void 0||o instanceof Uint8Array)throw(0,Eb.default)(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>n({key:s,value:o},a.signal))},replace(s,o={}){if(!s||s instanceof Uint8Array)throw(0,Eb.default)(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>n({key:void 0,value:s},o.signal))},async exists(){return bb(pT,t.has.bind(t),t)}};return r;async function n(s,o){if(o&&o.aborted)return;let a=s.key,c=s.value;if(a){let u=await r.getAll();return typeof u=="object"&&u!==null&&(0,Dre.default)(u,a,c),i(u)}return i(c)}function i(s){let o=tt(JSON.stringify(s,null,2));return t.put(pT,o)}}var vb,kre,Dre,Eb,Oqe,pT,Bre=w(()=>{Vr();vb=A(ia(),1),kre=A(WI(),1),Dre=A(oI(),1),Eb=A(oe(),1);l1();st();dt();hT();Oqe=vb.default.default?vb.default.default:vb.default,pT=new Oe("config")});var Mre=g((I7t,Lre)=>{"use strict";var yT=m7();Lre.exports=(t,e={})=>{if(!yT(t)&&!Array.isArray(t))throw new TypeError("Expected a plain object or array");let{deep:r}=e,n=[],i=[],s=a=>{let c=n.indexOf(a);if(c!==-1)return i[c];let u=[];return n.push(a),i.push(u),u.push(...a.map(l=>Array.isArray(l)?s(l):yT(l)?o(l):l)),u},o=a=>{let c=n.indexOf(a);if(c!==-1)return i[c];let u={},l=Object.keys(a).sort(e.compare);n.push(a),i.push(u);for(let f of l){let h=a[f],d;r&&Array.isArray(h)?d=s(h):d=r&&yT(h)?o(h):h,Object.defineProperty(u,f,{...Object.getOwnPropertyDescriptor(a,f),value:d})}return u};return Array.isArray(t)?r?s(t):t.slice():o(t)}});function qre(t){return{exists(){return t.has(gT)},async get(){let e=await t.get(gT);return JSON.parse(Xe(e))},async set(e){return t.put(gT,tt(JSON.stringify((0,Ure.default)(e,{deep:!0}))))}}}var Ure,gT,Fre=w(()=>{y0();Ure=A(Mre(),1);st();dt();gT=new Oe("datastore_spec")});function Kre(t){return{async get(){let e=await t.get(mT);return e&&e.toString()},set(e){return t.put(mT,tt(e.toString()))},delete(){return t.delete(mT)}}}var mT,jre=w(()=>{Vr();dt();mT=new Oe("api")});function Gre(t){return{open(){return t.open()},close(){return t.close()},query(e,r){return t.query(e,r)},queryKeys(e,r){return t.queryKeys(e,r)},async get(e,r){let n=rf(e);return n.isIdentity?Promise.resolve(n.digest):t.get(e,r)},async*getMany(e,r){for await(let n of e)yield this.get(n,r)},async put(e,r,n){let{isIdentity:i}=rf(e);i||await t.put(e,r,n)},async*putMany(e,r){let n=(0,zre.default)();(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await(0,Hre.default)(t.putMany(async function*(){for await(let{key:s,value:o}of e)rf(s).isIdentity||(yield{key:s,value:o}),n.push({key:s,value:o})}())),n.end()}catch(s){n.end(s)}}),yield*n},has(e,r){let{isIdentity:n}=rf(e);return n?Promise.resolve(!0):t.has(e,r)},delete(e,r){let{isIdentity:n}=rf(e);return n?Promise.resolve():t.delete(e,r)},deleteMany(e,r){return t.deleteMany((0,Vre.default)(e,n=>!rf(n).isIdentity),r)},batch(){let e=t.batch();return{put(r,n){let{isIdentity:i}=rf(r);i||e.put(r,n)},delete(r){let{isIdentity:n}=rf(r);n||e.delete(r)},commit:r=>e.commit(r)}}}}function rf(t){let e=L.asCID(t);if(e==null)throw(0,$re.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==Cs.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}var Vre,zre,Hre,$re,Wre=w(()=>{Vre=A(fs(),1),zre=A(ac(),1),Hre=A(ls(),1);Se();$re=A(oe(),1);Zc()});async function kqe(t){let e=t+"/"+Qre;if(Xre("locking %s",e),ym[e]===!0)throw new c1(`Lock already being held for file: ${e}`);return ym[e]=!0,{async close(){ym[e]&&delete ym[e]}}}async function Dqe(t){let e=t+"/"+Qre;return Xre(`checking lock: ${e}`),Boolean(ym[e])}var Yre,Xre,Qre,ym,Sb,wT=w(()=>{l1();Yre=A(he(),1),Xre=(0,Yre.default)("ipfs:repo:lock:memory"),Qre="repo.lock",ym={};Sb={lock:kqe,locked:Dqe}});var Zre,Jre=w(()=>{wT();Zre={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:Sb}});var bT,ene=w(()=>{bT={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}}});function gm(t){let e=L.asCID(t);if(e==null)throw(0,tne.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");let r=gr.encode(e.multihash.bytes);return new Oe("/"+r.slice(1).toUpperCase(),!1)}function _T(t){return mn(gr.decode(`b${t.toString().toLowerCase().substring(1)}`))}var tne,rne=w(()=>{Vr();vp();eo();tne=A(oe(),1);fi();li()});async function*f1(t,e,r,n){try{let i=await e.get(t,n),s=await r(t.code),o=$0({bytes:i,cid:t,codec:s});for(let[,a]of o.links())yield a,yield*f1(a,e,r,n)}catch(i){throw Nqe("Could not walk DAG for CID",t.toString(),i),i}}var nne,Nqe,vT=w(()=>{nne=A(he(),1);Bw();Nqe=(0,nne.default)("ipfs:repo:utils:walk-dag")});function Bqe(t){let e=`Invalid type '${t}', must be one of {direct, indirect, recursive, all}`;return(0,ine.default)(new Error(e),"ERR_INVALID_PIN_TYPE")}var ine,sne,ET,ST,one=w(()=>{Se();ine=A(oe(),1),sne=A(he(),1),ET=A(qh(),1);Bw();sl();xt();rne();vT();s0();ST=class{constructor({pinstore:e,blockstore:r,loadCodec:n}){this.pinstore=e,this.blockstore=r,this.loadCodec=n,this.log=(0,sne.default)("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,r={}){await this.blockstore.get(e,r);let n={depth:0};return e.version!==0&&(n.version=e.version),e.code!==St&&(n.codec=e.code),r.metadata&&(n.metadata=r.metadata),this.pinstore.put(gm(e),es(n))}unpin(e,r){return this.pinstore.delete(gm(e),r)}async pinRecursively(e,r={}){await this.fetchCompleteDag(e,r);let n={depth:1/0};e.version!==0&&(n.version=e.version),e.code!==St&&(n.codec=e.code),r.metadata&&(n.metadata=r.metadata),await this.pinstore.put(gm(e),es(n))}async*directKeys(e){for await(let r of this.pinstore.query({filters:[n=>Rn(n.value).depth===0]})){let n=Rn(r.value),i=n.version||0,s=n.codec!=null?n.codec:St,o=_T(r.key);yield{cid:L.create(i,s,o),metadata:n.metadata}}}async*recursiveKeys(e){for await(let r of this.pinstore.query({filters:[n=>Rn(n.value).depth===1/0]})){let n=Rn(r.value),i=n.version||0,s=n.codec!=null?n.codec:St,o=_T(r.key);yield{cid:L.create(i,s,o),metadata:n.metadata}}}async*indirectKeys(e){for await(let{cid:r}of this.recursiveKeys())for await(let n of f1(r,this.blockstore,this.loadCodec,e)){let i=[Mt.recursive];(await this.isPinnedWithType(n,i)).pinned||(yield n)}}async isPinnedWithType(e,r,n){Array.isArray(r)||(r=[r]);let i=r.includes(Mt.all),s=r.includes(Mt.direct),o=r.includes(Mt.recursive),a=r.includes(Mt.indirect);if(o||s||i){let l=await(0,ET.default)(this.pinstore.query({prefix:gm(e).toString(),filters:[f=>{if(i)return!0;let h=Rn(f.value);return r.includes(h.depth===0?Mt.direct:Mt.recursive)}],limit:1}));if(l){let f=Rn(l.value);return{cid:e,pinned:!0,reason:f.depth===0?Mt.direct:Mt.recursive,metadata:f.metadata}}}let c=this;async function*u(l,f){for await(let{cid:h}of f)for await(let d of f1(h,c.blockstore,c.loadCodec))if(d.equals(l)){yield h;return}}if(i||a){let l=await(0,ET.default)(u(e,this.recursiveKeys()));if(l)return{cid:e,pinned:!0,reason:Mt.indirect,parent:l}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,r){let n=new Set,i=async(s,o)=>{if(n.has(s.toString()))return;n.add(s.toString());let a=await this.blockstore.get(s,o),c=await this.loadCodec(s.code),u=$0({bytes:a,cid:s,codec:c});await Promise.all([...u.links()].map(([,l])=>i(l,o)))};await i(e,r)}static checkPinType(e){if(typeof e!="string"||!Object.keys(Mt).includes(e))throw Bqe(e);return!0}}});function lne(t,e){return{open(){return e.open()},close(){return e.close()},query(r,n){return e.query(r,n)},queryKeys(r,n){return e.queryKeys(r,n)},async get(r,n){return e.get(r,n)},async*getMany(r,n){yield*e.getMany(r,n)},async put(r,n,i){await e.put(r,n,i)},async*putMany(r,n){yield*e.putMany(r,n)},has(r,n){return e.has(r,n)},async delete(r,n){return await ane(r,t),e.delete(r,n)},deleteMany(r,n){return e.deleteMany((0,cne.default)(r,async i=>(await ane(i,t),i)),n)},batch(){return e.batch()}}}async function ane(t,e){let{pinned:r,reason:n}=await e.isPinnedWithType(t,Mt.all);if(r)throw(0,une.default)(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}var cne,une,fne=w(()=>{cne=A(xi(),1),une=A(oe(),1);s0()});function gne({gcLock:t,pins:e,blockstore:r,root:n,loadCodec:i}){async function*s(){let o=Date.now();mm("Creating set of marked blocks");let a=await t.writeLock();try{let c=await qqe({pins:e,blockstore:r,root:n,loadCodec:i}),u=r.queryKeys({});yield*Fqe({blockstore:r},c,u),mm(`Complete (${Date.now()-o}ms)`)}finally{a()}}return s}async function qqe({pins:t,blockstore:e,loadCodec:r,root:n}){let i=async function*(){let a;try{a=await n.get(Uqe)}catch(u){if(u.code===Lqe){mm("No blocks in MFS");return}throw u}let c=L.decode(a);yield c,yield*f1(c,e,r)}(),s=(0,AT.default)((0,Ab.default)(t.recursiveKeys(),({cid:a})=>a),t.indirectKeys(),(0,Ab.default)(t.directKeys(),({cid:a})=>a),i),o=new Set;for await(let a of(0,AT.default)(s,i))o.add(gr.encode(a.multihash.bytes));return o}async function*Fqe({blockstore:t},e,r){let n=0,i=0;yield*(0,pne.pipe)((0,dne.default)((0,Ab.default)(r,async o=>async function(){n++;try{let c=gr.encode(o.multihash.bytes);if(e.has(c))return null;try{await t.delete(o),i++}catch(u){return{err:new Error(`Could not delete block with CID ${o}: ${u.message}`)}}return{cid:o}}catch(c){let u=`Could delete block with CID ${o}`;return mm(u,c),{err:new Error(u+`: ${c.message}`)}}}),Mqe),o=>(0,yne.default)(o,Boolean)),mm(`Marked set has ${e.size} unique blocks. Blockstore has ${n} blocks. Deleted ${i} blocks.`)}var hne,dne,pne,AT,Ab,yne,mm,Lqe,Mqe,Uqe,mne=w(()=>{Se();hne=A(he(),1);lo();dne=A(z5(),1),pne=A(br(),1),AT=A(Dl(),1),Ab=A(xi(),1),yne=A(fs(),1);Vr();fi();vT();mm=(0,hne.default)("ipfs:repo:gc"),Lqe=Cn().code,Mqe=256,Uqe=new Oe("/local/filesroot")});async function wne(t){let e=BigInt(0);for await(let r of t.query({}))e+=BigInt(r.value.byteLength),e+=BigInt(r.key.uint8Array().byteLength);return e}function Sne(t,e,r,n){return new Ene(t,e,r,n)}function Vqe(t){return t.Datastore=Object.assign({},bT,(0,RT.default)(t,"datastore")),t}function zqe(t){let e={...bT.Spec,...(0,RT.default)(t,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(r=>({mountpoint:r.mountpoint,type:r.child.type,path:r.child.path,shardFunc:r.child.shardFunc}))}}var RT,bne,ed,_ne,vne,ys,Kqe,jqe,Ene,Ane=w(()=>{RT=A(WI(),1),bne=A(he(),1),ed=A(oe(),1);Ere();_ne=A(Rre(),1);Fn();HI();Ore();Bre();Fre();jre();Wre();Jre();ene();l1();one();fne();vne=A($w(),1);mne();ys=(0,bne.default)("ipfs:repo"),Kqe=Number.MAX_SAFE_INTEGER,jqe="repoAutoMigrate",Ene=class{constructor(e,r,n,i){if(typeof e!="string")throw new Error("missing repo path");if(typeof r!="function")throw new Error("missing codec loader");this.options=Bt(Zre,i),this.closed=!0,this.path=e,this.root=n.root,this.datastore=n.datastore,this.keys=n.keys;let s=n.blocks,o=n.pins;this.pins=new ST({pinstore:o,blockstore:s,loadCodec:r});let a=lne(this.pins,s);this.blocks=Gre(a),this.version=Cre(this.root),this.config=Nre(this.root),this.spec=qre(this.root),this.apiAddr=Kre(this.root),this.gcLock=(0,vne.default)(e,{singleProcess:this.options.repoOwner!==!1}),this.gc=gne({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:r})}async init(e){ys("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(Vqe(e)),await this.spec.set(zqe(e)),await this.version.set(12)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw(0,ed.default)(new Error("repo is already open"),Ire);ys("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),ys("acquired repo.lock"),!await this.version.check(12))if(await this._isAutoMigrationEnabled())await this._migrate(12,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new u1("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");ys("creating datastore"),await this.datastore.open(),ys("creating blocks"),await this.blocks.open(),ys("creating keystore"),await this.keys.open(),ys("creating pins"),await this.pins.pinstore.open(),this.closed=!1,ys("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(r){ys("error removing lock",r)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw(0,ed.default)(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){ys("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(r){throw r.code==="ERR_NOT_FOUND"?(0,ed.default)(new Error("repo is not initialized yet"),Jh,{path:this.path}):r}if(!e)throw(0,ed.default)(new Error("repo is not initialized yet"),Jh,{path:this.path})}async close(){if(this.closed)throw(0,ed.default)(new Error("repo is already closed"),Tre);ys("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Jh&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),ys("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,r,n,i,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),wne(this.datastore),wne(this.keys)]),o=r.size+i+s;return{repoPath:this.path,storageMax:e,version:n,numObjects:r.count,repoSize:o}}throw(0,ed.default)(new Error("repo is not initialized yet"),Jh,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(jqe)}catch(r){if(r.code===Ao.code)e=!0;else throw r}return e}async _migrate(e,r){return await this.version.get()>e?(ys(`reverting to version ${e}`),_re(this.path,r,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(ys(`migrating to version ${e}`),bre(this.path,r,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt((0,_ne.default)(e))}catch{return BigInt(Kqe)}}async _blockStat(){let e=BigInt(0),r=BigInt(0);if(this.blocks)for await(let{key:n,value:i}of this.blocks.query({}))e+=BigInt(1),r+=BigInt(i.byteLength),r+=BigInt(n.bytes.byteLength);return{count:e,size:r}}}});var IT=g((_Et,Rne)=>{"use strict";var Hqe=yo(),$qe=async function*(t,e){yield*(await Hqe(t)).sort(e)};Rne.exports=$qe});var TT=g((vEt,Ine)=>{"use strict";Ine.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,r);if(o.value!==i||o.enumerable!==!0)return!1}return!0}});var wm=g((EEt,Tne)=>{"use strict";var Gqe=TT();Tne.exports=function(){return Gqe()&&!!Symbol.toStringTag}});var Cne=g((SEt,Pne)=>{"use strict";var xne=typeof Symbol<"u"&&Symbol,Wqe=TT();Pne.exports=function(){return typeof xne!="function"||typeof Symbol!="function"||typeof xne("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Wqe()}});var kne=g((AEt,One)=>{"use strict";var Yqe="Function.prototype.bind called on incompatible ",xT=Array.prototype.slice,Xqe=Object.prototype.toString,Qqe="[object Function]";One.exports=function(e){var r=this;if(typeof r!="function"||Xqe.call(r)!==Qqe)throw new TypeError(Yqe+r);for(var n=xT.call(arguments,1),i,s=function(){if(this instanceof i){var l=r.apply(this,n.concat(xT.call(arguments)));return Object(l)===l?l:this}else return r.apply(e,n.concat(xT.call(arguments)))},o=Math.max(0,r.length-n.length),a=[],c=0;c<o;c++)a.push("$"+c);if(i=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),r.prototype){var u=function(){};u.prototype=r.prototype,i.prototype=new u,u.prototype=null}return i}});var Rb=g((REt,Dne)=>{"use strict";var Zqe=kne();Dne.exports=Function.prototype.bind||Zqe});var Bne=g((IEt,Nne)=>{"use strict";var Jqe=Rb();Nne.exports=Jqe.call(Function.call,Object.prototype.hasOwnProperty)});var Pb=g((TEt,qne)=>{"use strict";var Wt,bm=SyntaxError,Une=Function,p1=TypeError,PT=function(t){try{return Une('"use strict"; return ('+t+").constructor;")()}catch{}},td=Object.getOwnPropertyDescriptor;if(td)try{td({},"")}catch{td=null}var CT=function(){throw new p1},eFe=td?function(){try{return arguments.callee,CT}catch{try{return td(arguments,"callee").get}catch{return CT}}}():CT,h1=Cne()(),nf=Object.getPrototypeOf||function(t){return t.__proto__},d1={},tFe=typeof Uint8Array>"u"?Wt:nf(Uint8Array),y1={"%AggregateError%":typeof AggregateError>"u"?Wt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Wt:ArrayBuffer,"%ArrayIteratorPrototype%":h1?nf([][Symbol.iterator]()):Wt,"%AsyncFromSyncIteratorPrototype%":Wt,"%AsyncFunction%":d1,"%AsyncGenerator%":d1,"%AsyncGeneratorFunction%":d1,"%AsyncIteratorPrototype%":d1,"%Atomics%":typeof Atomics>"u"?Wt:Atomics,"%BigInt%":typeof BigInt>"u"?Wt:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Wt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Wt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Wt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Wt:FinalizationRegistry,"%Function%":Une,"%GeneratorFunction%":d1,"%Int8Array%":typeof Int8Array>"u"?Wt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Wt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Wt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h1?nf(nf([][Symbol.iterator]())):Wt,"%JSON%":typeof JSON=="object"?JSON:Wt,"%Map%":typeof Map>"u"?Wt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!h1?Wt:nf(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Wt:Promise,"%Proxy%":typeof Proxy>"u"?Wt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Wt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Wt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!h1?Wt:nf(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Wt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h1?nf(""[Symbol.iterator]()):Wt,"%Symbol%":h1?Symbol:Wt,"%SyntaxError%":bm,"%ThrowTypeError%":eFe,"%TypedArray%":tFe,"%TypeError%":p1,"%Uint8Array%":typeof Uint8Array>"u"?Wt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Wt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Wt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Wt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Wt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Wt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Wt:WeakSet},rFe=function t(e){var r;if(e==="%AsyncFunction%")r=PT("async function () {}");else if(e==="%GeneratorFunction%")r=PT("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=PT("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&(r=nf(i.prototype))}return y1[e]=r,r},Lne={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},xb=Rb(),Ib=Bne(),nFe=xb.call(Function.call,Array.prototype.concat),iFe=xb.call(Function.apply,Array.prototype.splice),Mne=xb.call(Function.call,String.prototype.replace),Tb=xb.call(Function.call,String.prototype.slice),sFe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,oFe=/\\(\\)?/g,aFe=function(e){var r=Tb(e,0,1),n=Tb(e,-1);if(r==="%"&&n!=="%")throw new bm("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new bm("invalid intrinsic syntax, expected opening `%`");var i=[];return Mne(e,sFe,function(s,o,a,c){i[i.length]=a?Mne(c,oFe,"$1"):o||s}),i},cFe=function(e,r){var n=e,i;if(Ib(Lne,n)&&(i=Lne[n],n="%"+i[0]+"%"),Ib(y1,n)){var s=y1[n];if(s===d1&&(s=rFe(n)),typeof s>"u"&&!r)throw new p1("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new bm("intrinsic "+e+" does not exist!")};qne.exports=function(e,r){if(typeof e!="string"||e.length===0)throw new p1("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new p1('"allowMissing" argument must be a boolean');var n=aFe(e),i=n.length>0?n[0]:"",s=cFe("%"+i+"%",r),o=s.name,a=s.value,c=!1,u=s.alias;u&&(i=u[0],iFe(n,nFe([0,1],u)));for(var l=1,f=!0;l<n.length;l+=1){var h=n[l],d=Tb(h,0,1),p=Tb(h,-1);if((d==='"'||d==="'"||d==="`"||p==='"'||p==="'"||p==="`")&&d!==p)throw new bm("property names with quotes must have matching quotes");if((h==="constructor"||!f)&&(c=!0),i+="."+h,o="%"+i+"%",Ib(y1,o))a=y1[o];else if(a!=null){if(!(h in a)){if(!r)throw new p1("base intrinsic for "+e+" exists, but the property is not available.");return}if(td&&l+1>=n.length){var y=td(a,h);f=!!y,f&&"get"in y&&!("originalValue"in y.get)?a=y.get:a=a[h]}else f=Ib(a,h),a=a[h];f&&!c&&(y1[o]=a)}}return a}});var Hne=g((xEt,Cb)=>{"use strict";var OT=Rb(),g1=Pb(),jne=g1("%Function.prototype.apply%"),Vne=g1("%Function.prototype.call%"),zne=g1("%Reflect.apply%",!0)||OT.call(Vne,jne),Fne=g1("%Object.getOwnPropertyDescriptor%",!0),rd=g1("%Object.defineProperty%",!0),uFe=g1("%Math.max%");if(rd)try{rd({},"a",{value:1})}catch{rd=null}Cb.exports=function(e){var r=zne(OT,Vne,arguments);if(Fne&&rd){var n=Fne(r,"length");n.configurable&&rd(r,"length",{value:1+uFe(0,e.length-(arguments.length-1))})}return r};var Kne=function(){return zne(OT,jne,arguments)};rd?rd(Cb.exports,"apply",{value:Kne}):Cb.exports.apply=Kne});var Ob=g((PEt,Wne)=>{"use strict";var $ne=Pb(),Gne=Hne(),lFe=Gne($ne("String.prototype.indexOf"));Wne.exports=function(e,r){var n=$ne(e,!!r);return typeof n=="function"&&lFe(e,".prototype.")>-1?Gne(n):n}});var Qne=g((CEt,Xne)=>{"use strict";var fFe=wm()(),hFe=Ob(),kT=hFe("Object.prototype.toString"),kb=function(e){return fFe&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:kT(e)==="[object Arguments]"},Yne=function(e){return kb(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&kT(e)!=="[object Array]"&&kT(e.callee)==="[object Function]"},dFe=function(){return kb(arguments)}();kb.isLegacyArguments=Yne;Xne.exports=dFe?kb:Yne});var eie=g((OEt,Jne)=>{"use strict";var pFe=Object.prototype.toString,yFe=Function.prototype.toString,gFe=/^\s*(?:function)?\*/,Zne=wm()(),DT=Object.getPrototypeOf,mFe=function(){if(!Zne)return!1;try{return Function("return function*() {}")()}catch{}},NT;Jne.exports=function(e){if(typeof e!="function")return!1;if(gFe.test(yFe.call(e)))return!0;if(!Zne){var r=pFe.call(e);return r==="[object GeneratorFunction]"}if(!DT)return!1;if(typeof NT>"u"){var n=mFe();NT=n?DT(n):!1}return DT(e)===NT}});var BT=g((kEt,tie)=>{var wFe=Object.prototype.hasOwnProperty,bFe=Object.prototype.toString;tie.exports=function(e,r,n){if(bFe.call(r)!=="[object Function]")throw new TypeError("iterator must be a function");var i=e.length;if(i===+i)for(var s=0;s<i;s++)r.call(n,e[s],s,e);else for(var o in e)wFe.call(e,o)&&r.call(n,e[o],o,e)}});var MT=g((DEt,rie)=>{"use strict";var LT=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],_Fe=typeof globalThis>"u"?globalThis:globalThis;rie.exports=function(){for(var e=[],r=0;r<LT.length;r++)typeof _Fe[LT[r]]=="function"&&(e[e.length]=LT[r]);return e}});var UT=g((NEt,nie)=>{"use strict";var vFe=Pb(),Db=vFe("%Object.getOwnPropertyDescriptor%",!0);if(Db)try{Db([],"length")}catch{Db=null}nie.exports=Db});var KT=g((BEt,cie)=>{"use strict";var iie=BT(),EFe=MT(),FT=Ob(),SFe=FT("Object.prototype.toString"),sie=wm()(),AFe=typeof globalThis>"u"?globalThis:globalThis,oie=EFe(),RFe=FT("Array.prototype.indexOf",!0)||function(e,r){for(var n=0;n<e.length;n+=1)if(e[n]===r)return n;return-1},IFe=FT("String.prototype.slice"),aie={},Nb=UT(),qT=Object.getPrototypeOf;sie&&Nb&&qT&&iie(oie,function(t){var e=new AFe[t];if(Symbol.toStringTag in e){var r=qT(e),n=Nb(r,Symbol.toStringTag);if(!n){var i=qT(r);n=Nb(i,Symbol.toStringTag)}aie[t]=n.get}});var TFe=function(e){var r=!1;return iie(aie,function(n,i){if(!r)try{r=n.call(e)===i}catch{}}),r};cie.exports=function(e){if(!e||typeof e!="object")return!1;if(!sie||!(Symbol.toStringTag in e)){var r=IFe(SFe(e),8,-1);return RFe(oie,r)>-1}return Nb?TFe(e):!1}});var yie=g((LEt,pie)=>{"use strict";var lie=BT(),xFe=MT(),fie=Ob(),PFe=fie("Object.prototype.toString"),hie=wm()(),uie=typeof globalThis>"u"?globalThis:globalThis,CFe=xFe(),OFe=fie("String.prototype.slice"),die={},jT=UT(),VT=Object.getPrototypeOf;hie&&jT&&VT&&lie(CFe,function(t){if(typeof uie[t]=="function"){var e=new uie[t];if(Symbol.toStringTag in e){var r=VT(e),n=jT(r,Symbol.toStringTag);if(!n){var i=VT(r);n=jT(i,Symbol.toStringTag)}die[t]=n.get}}});var kFe=function(e){var r=!1;return lie(die,function(n,i){if(!r)try{var s=n.call(e);s===i&&(r=s)}catch{}}),r},DFe=KT();pie.exports=function(e){return DFe(e)?!hie||!(Symbol.toStringTag in e)?OFe(PFe(e),8,-1):kFe(e):!1}});var Pie=g(kt=>{"use strict";var NFe=Qne(),BFe=eie(),wa=yie(),gie=KT();function m1(t){return t.call.bind(t)}var mie=typeof BigInt<"u",wie=typeof Symbol<"u",Ro=m1(Object.prototype.toString),LFe=m1(Number.prototype.valueOf),MFe=m1(String.prototype.valueOf),UFe=m1(Boolean.prototype.valueOf);mie&&(bie=m1(BigInt.prototype.valueOf));var bie;wie&&(_ie=m1(Symbol.prototype.valueOf));var _ie;function vm(t,e){if(typeof t!="object")return!1;try{return e(t),!0}catch{return!1}}kt.isArgumentsObject=NFe;kt.isGeneratorFunction=BFe;kt.isTypedArray=gie;function qFe(t){return typeof Promise<"u"&&t instanceof Promise||t!==null&&typeof t=="object"&&typeof t.then=="function"&&typeof t.catch=="function"}kt.isPromise=qFe;function FFe(t){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(t):gie(t)||Eie(t)}kt.isArrayBufferView=FFe;function KFe(t){return wa(t)==="Uint8Array"}kt.isUint8Array=KFe;function jFe(t){return wa(t)==="Uint8ClampedArray"}kt.isUint8ClampedArray=jFe;function VFe(t){return wa(t)==="Uint16Array"}kt.isUint16Array=VFe;function zFe(t){return wa(t)==="Uint32Array"}kt.isUint32Array=zFe;function HFe(t){return wa(t)==="Int8Array"}kt.isInt8Array=HFe;function $Fe(t){return wa(t)==="Int16Array"}kt.isInt16Array=$Fe;function GFe(t){return wa(t)==="Int32Array"}kt.isInt32Array=GFe;function WFe(t){return wa(t)==="Float32Array"}kt.isFloat32Array=WFe;function YFe(t){return wa(t)==="Float64Array"}kt.isFloat64Array=YFe;function XFe(t){return wa(t)==="BigInt64Array"}kt.isBigInt64Array=XFe;function QFe(t){return wa(t)==="BigUint64Array"}kt.isBigUint64Array=QFe;function Bb(t){return Ro(t)==="[object Map]"}Bb.working=typeof Map<"u"&&Bb(new Map);function ZFe(t){return typeof Map>"u"?!1:Bb.working?Bb(t):t instanceof Map}kt.isMap=ZFe;function Lb(t){return Ro(t)==="[object Set]"}Lb.working=typeof Set<"u"&&Lb(new Set);function JFe(t){return typeof Set>"u"?!1:Lb.working?Lb(t):t instanceof Set}kt.isSet=JFe;function Mb(t){return Ro(t)==="[object WeakMap]"}Mb.working=typeof WeakMap<"u"&&Mb(new WeakMap);function eKe(t){return typeof WeakMap>"u"?!1:Mb.working?Mb(t):t instanceof WeakMap}kt.isWeakMap=eKe;function HT(t){return Ro(t)==="[object WeakSet]"}HT.working=typeof WeakSet<"u"&&HT(new WeakSet);function tKe(t){return HT(t)}kt.isWeakSet=tKe;function Ub(t){return Ro(t)==="[object ArrayBuffer]"}Ub.working=typeof ArrayBuffer<"u"&&Ub(new ArrayBuffer);function vie(t){return typeof ArrayBuffer>"u"?!1:Ub.working?Ub(t):t instanceof ArrayBuffer}kt.isArrayBuffer=vie;function qb(t){return Ro(t)==="[object DataView]"}qb.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&qb(new DataView(new ArrayBuffer(1),0,1));function Eie(t){return typeof DataView>"u"?!1:qb.working?qb(t):t instanceof DataView}kt.isDataView=Eie;var zT=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function _m(t){return Ro(t)==="[object SharedArrayBuffer]"}function Sie(t){return typeof zT>"u"?!1:(typeof _m.working>"u"&&(_m.working=_m(new zT)),_m.working?_m(t):t instanceof zT)}kt.isSharedArrayBuffer=Sie;function rKe(t){return Ro(t)==="[object AsyncFunction]"}kt.isAsyncFunction=rKe;function nKe(t){return Ro(t)==="[object Map Iterator]"}kt.isMapIterator=nKe;function iKe(t){return Ro(t)==="[object Set Iterator]"}kt.isSetIterator=iKe;function sKe(t){return Ro(t)==="[object Generator]"}kt.isGeneratorObject=sKe;function oKe(t){return Ro(t)==="[object WebAssembly.Module]"}kt.isWebAssemblyCompiledModule=oKe;function Aie(t){return vm(t,LFe)}kt.isNumberObject=Aie;function Rie(t){return vm(t,MFe)}kt.isStringObject=Rie;function Iie(t){return vm(t,UFe)}kt.isBooleanObject=Iie;function Tie(t){return mie&&vm(t,bie)}kt.isBigIntObject=Tie;function xie(t){return wie&&vm(t,_ie)}kt.isSymbolObject=xie;function aKe(t){return Aie(t)||Rie(t)||Iie(t)||Tie(t)||xie(t)}kt.isBoxedPrimitive=aKe;function cKe(t){return typeof Uint8Array<"u"&&(vie(t)||Sie(t))}kt.isAnyArrayBuffer=cKe;["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(t){Object.defineProperty(kt,t,{enumerable:!1,value:function(){throw new Error(t+" is not supported in userland")}})})});var Oie=g((UEt,Cie)=>{Cie.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var Us=g((qEt,$T)=>{typeof Object.create=="function"?$T.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:$T.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}});var Mie=g(Dt=>{var kie=Object.getOwnPropertyDescriptors||function(e){for(var r=Object.keys(e),n={},i=0;i<r.length;i++)n[r[i]]=Object.getOwnPropertyDescriptor(e,r[i]);return n},uKe=/%[sdj%]/g;Dt.format=function(t){if(!$b(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(sf(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,i=n.length,s=String(t).replace(uKe,function(a){if(a==="%%")return"%";if(r>=i)return a;switch(a){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch{return"[Circular]"}default:return a}}),o=n[r];r<i;o=n[++r])Hb(o)||!w1(o)?s+=" "+o:s+=" "+sf(o);return s};Dt.deprecate=function(t,e){if(typeof process<"u"&&process.noDeprecation===!0)return t;if(typeof process>"u")return function(){return Dt.deprecate(t,e).apply(this,arguments)};var r=!1;function n(){if(!r){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),r=!0}return t.apply(this,arguments)}return n};var Fb={},Die=/^$/;process.env.NODE_DEBUG&&(Kb=process.env.NODE_DEBUG,Kb=Kb.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),Die=new RegExp("^"+Kb+"$","i"));var Kb;Dt.debuglog=function(t){if(t=t.toUpperCase(),!Fb[t])if(Die.test(t)){var e=process.pid;Fb[t]=function(){var r=Dt.format.apply(Dt,arguments);console.error("%s %d: %s",t,e,r)}}else Fb[t]=function(){};return Fb[t]};function sf(t,e){var r={seen:[],stylize:fKe};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),XT(e)?r.showHidden=e:e&&Dt._extend(r,e),id(r.showHidden)&&(r.showHidden=!1),id(r.depth)&&(r.depth=2),id(r.colors)&&(r.colors=!1),id(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=lKe),Vb(r,t,r.depth)}Dt.inspect=sf;sf.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};sf.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function lKe(t,e){var r=sf.styles[e];return r?"\x1B["+sf.colors[r][0]+"m"+t+"\x1B["+sf.colors[r][1]+"m":t}function fKe(t,e){return t}function hKe(t){var e={};return t.forEach(function(r,n){e[r]=!0}),e}function Vb(t,e,r){if(t.customInspect&&e&&jb(e.inspect)&&e.inspect!==Dt.inspect&&!(e.constructor&&e.constructor.prototype===e)){var n=e.inspect(r,t);return $b(n)||(n=Vb(t,n,r)),n}var i=dKe(t,e);if(i)return i;var s=Object.keys(e),o=hKe(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),Sm(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return GT(e);if(s.length===0){if(jb(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if(Em(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(zb(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Sm(e))return GT(e)}var c="",u=!1,l=["{","}"];if(Nie(e)&&(u=!0,l=["[","]"]),jb(e)){var f=e.name?": "+e.name:"";c=" [Function"+f+"]"}if(Em(e)&&(c=" "+RegExp.prototype.toString.call(e)),zb(e)&&(c=" "+Date.prototype.toUTCString.call(e)),Sm(e)&&(c=" "+GT(e)),s.length===0&&(!u||e.length==0))return l[0]+c+l[1];if(r<0)return Em(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var h;return u?h=pKe(t,e,r,o,s):h=s.map(function(d){return YT(t,e,r,o,d,u)}),t.seen.pop(),yKe(h,c,l)}function dKe(t,e){if(id(e))return t.stylize("undefined","undefined");if($b(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(Bie(e))return t.stylize(""+e,"number");if(XT(e))return t.stylize(""+e,"boolean");if(Hb(e))return t.stylize("null","null")}function GT(t){return"["+Error.prototype.toString.call(t)+"]"}function pKe(t,e,r,n,i){for(var s=[],o=0,a=e.length;o<a;++o)Lie(e,String(o))?s.push(YT(t,e,r,n,String(o),!0)):s.push("");return i.forEach(function(c){c.match(/^\d+$/)||s.push(YT(t,e,r,n,c,!0))}),s}function YT(t,e,r,n,i,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?c.set?a=t.stylize("[Getter/Setter]","special"):a=t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),Lie(n,i)||(o="["+i+"]"),a||(t.seen.indexOf(c.value)<0?(Hb(r)?a=Vb(t,c.value,null):a=Vb(t,c.value,r-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(u){return"  "+u}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(u){return"   "+u}).join(`
`))):a=t.stylize("[Circular]","special")),id(o)){if(s&&i.match(/^\d+$/))return a;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function yKe(t,e,r){var n=0,i=t.reduce(function(s,o){return n++,o.indexOf(`
`)>=0&&n++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}Dt.types=Pie();function Nie(t){return Array.isArray(t)}Dt.isArray=Nie;function XT(t){return typeof t=="boolean"}Dt.isBoolean=XT;function Hb(t){return t===null}Dt.isNull=Hb;function gKe(t){return t==null}Dt.isNullOrUndefined=gKe;function Bie(t){return typeof t=="number"}Dt.isNumber=Bie;function $b(t){return typeof t=="string"}Dt.isString=$b;function mKe(t){return typeof t=="symbol"}Dt.isSymbol=mKe;function id(t){return t===void 0}Dt.isUndefined=id;function Em(t){return w1(t)&&QT(t)==="[object RegExp]"}Dt.isRegExp=Em;Dt.types.isRegExp=Em;function w1(t){return typeof t=="object"&&t!==null}Dt.isObject=w1;function zb(t){return w1(t)&&QT(t)==="[object Date]"}Dt.isDate=zb;Dt.types.isDate=zb;function Sm(t){return w1(t)&&(QT(t)==="[object Error]"||t instanceof Error)}Dt.isError=Sm;Dt.types.isNativeError=Sm;function jb(t){return typeof t=="function"}Dt.isFunction=jb;function wKe(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t>"u"}Dt.isPrimitive=wKe;Dt.isBuffer=Oie();function QT(t){return Object.prototype.toString.call(t)}function WT(t){return t<10?"0"+t.toString(10):t.toString(10)}var bKe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _Ke(){var t=new Date,e=[WT(t.getHours()),WT(t.getMinutes()),WT(t.getSeconds())].join(":");return[t.getDate(),bKe[t.getMonth()],e].join(" ")}Dt.log=function(){console.log("%s - %s",_Ke(),Dt.format.apply(Dt,arguments))};Dt.inherits=Us();Dt._extend=function(t,e){if(!e||!w1(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t};function Lie(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var nd=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;Dt.promisify=function(e){if(typeof e!="function")throw new TypeError('The "original" argument must be of type Function');if(nd&&e[nd]){var r=e[nd];if(typeof r!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(r,nd,{value:r,enumerable:!1,writable:!1,configurable:!0}),r}function r(){for(var n,i,s=new Promise(function(c,u){n=c,i=u}),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push(function(c,u){c?i(c):n(u)});try{e.apply(this,o)}catch(c){i(c)}return s}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),nd&&Object.defineProperty(r,nd,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,kie(e))};Dt.promisify.custom=nd;function vKe(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}function EKe(t){if(typeof t!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var i=r.pop();if(typeof i!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return i.apply(s,arguments)};t.apply(this,r).then(function(a){process.nextTick(o.bind(null,null,a))},function(a){process.nextTick(vKe.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),Object.defineProperties(e,kie(t)),e}Dt.callbackify=EKe});var ZT=g((KEt,qie)=>{"use strict";qie.exports=function(...e){let r=e.reduce((n,i)=>Object.assign(n,i),{});return Object.assign(r,{bufferKeys:r.bufferKeys||!1,snapshots:r.snapshots||!1,permanence:r.permanence||!1,seek:r.seek||!1,clear:r.clear||!1,getMany:r.getMany||!1,keyIterator:r.keyIterator||!1,valueIterator:r.valueIterator||!1,iteratorNextv:r.iteratorNextv||!1,iteratorAll:r.iteratorAll||!1,status:r.status||!1,idempotentOpen:r.idempotentOpen||!1,passiveOpen:r.passiveOpen||!1,serialize:r.serialize||!1,createIfMissing:r.createIfMissing||!1,errorIfExists:r.errorIfExists||!1,deferredOpen:r.deferredOpen||!1,openCallback:r.openCallback||!1,promises:r.promises||!1,streams:r.streams||!1,encodings:Uie(r.encodings),events:Uie(r.events),additionalMethods:Object.assign({},r.additionalMethods)})};function Uie(t){return t?Object.assign({},t):!1}});var Kie=g((jEt,Fie)=>{Fie.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var Vie=g((VEt,jie)=>{jie.exports=typeof queueMicrotask=="function"?queueMicrotask:t=>Promise.resolve().then(t)});var Gb=g(JT=>{"use strict";var zie=Vie();JT.fromCallback=function(t,e){if(t===void 0){var r=new Promise(function(n,i){t=function(s,o){s?i(s):n(o)}});t[e!==void 0?e:"promise"]=r}else if(typeof t!="function")throw new TypeError("Callback must be a function");return t};JT.fromPromise=function(t,e){if(e===void 0)return t;t.then(function(r){zie(()=>e(null,r))}).catch(function(r){zie(()=>e(r))})}});var Am=g((HEt,$ie)=>{var Hie;$ie.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:globalThis):t=>(Hie||(Hie=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0))});var Wb=g(($Et,Wie)=>{"use strict";var Gie=Am();Wie.exports=function(t,...e){e.length===0?Gie(t):Gie(()=>t(...e))}});var ex=g((GEt,Yie)=>{"use strict";function vu(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._ended=!1,this._nexting=!1}vu.prototype.next=function(t){let e=this;if(t===void 0)e=new Promise(function(r,n){t=function(i,s,o){i?n(i):s===void 0&&o===void 0?r():r([s,o])}});else if(typeof t!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(t,new Error("cannot call next() after end()")),e):this._nexting?(this._nextTick(t,new Error("cannot call next() before previous next() has completed")),e):(this._nexting=!0,this._next((r,...n)=>{this._nexting=!1,t(r,...n)}),e)};vu.prototype._next=function(t){this._nextTick(t)};vu.prototype.seek=function(t){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");t=this.db._serializeKey(t),this._seek(t)};vu.prototype._seek=function(t){};vu.prototype.end=function(t){let e;if(t===void 0)e=new Promise(function(r,n){t=function(i){i?n(i):r()}});else if(typeof t!="function")throw new Error("end() requires a callback argument");return this._ended?(this._nextTick(t,new Error("end() already called on iterator")),e):(this._ended=!0,this._end(t),e)};vu.prototype._end=function(t){this._nextTick(t)};vu.prototype[Symbol.asyncIterator]=async function*(){try{let t;for(;(t=await this.next())!==void 0;)yield t}finally{this._ended||await this.end()}};vu.prototype._nextTick=Wb();Yie.exports=vu});var tx=g((WEt,Qie)=>{"use strict";var Xie=Object.freeze({});function ba(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._operations=[],this._written=!1}ba.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")};ba.prototype.put=function(t,e,r){this._checkWritten();let n=this.db._checkKey(t)||this.db._checkValue(e);if(n)throw n;return t=this.db._serializeKey(t),e=this.db._serializeValue(e),this._put(t,e,r??Xie),this};ba.prototype._put=function(t,e,r){this._operations.push({...r,type:"put",key:t,value:e})};ba.prototype.del=function(t,e){this._checkWritten();let r=this.db._checkKey(t);if(r)throw r;return t=this.db._serializeKey(t),this._del(t,e??Xie),this};ba.prototype._del=function(t,e){this._operations.push({...e,type:"del",key:t})};ba.prototype.clear=function(){return this._checkWritten(),this._clear(),this};ba.prototype._clear=function(){this._operations=[]};ba.prototype.write=function(t,e){if(this._checkWritten(),typeof t=="function"&&(e=t),typeof e!="function")throw new Error("write() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),this._written=!0,this._write(t,e)};ba.prototype._write=function(t,e){this.db._batch(this._operations,t,e)};ba.prototype._nextTick=Wb();Qie.exports=ba});var nx=g(rx=>{"use strict";rx.getCallback=function(t,e){return typeof t=="function"?t:e};rx.getOptions=function(t){return typeof t=="object"&&t!==null?t:{}}});var ese=g((XEt,Jie)=>{"use strict";var SKe=ZT(),AKe=Kie(),RKe=Gb(),IKe=ex(),TKe=tx(),xKe=nx().getCallback,PKe=nx().getOptions,CKe=Object.prototype.hasOwnProperty,OKe=["lt","lte","gt","gte"];function vr(t){this.status="new",this.supports=SKe(t,{status:!0})}vr.prototype.open=function(t,e){let r=this.status;if(typeof t=="function"&&(e=t),typeof e!="function")throw new Error("open() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),t.createIfMissing=t.createIfMissing!==!1,t.errorIfExists=!!t.errorIfExists,this.status="opening",this._open(t,n=>{if(n)return this.status=r,e(n);this.status="open",e()})};vr.prototype._open=function(t,e){this._nextTick(e)};vr.prototype.close=function(t){let e=this.status;if(typeof t!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(r=>{if(r)return this.status=e,t(r);this.status="closed",t()})};vr.prototype._close=function(t){this._nextTick(t)};vr.prototype.get=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("get() requires a callback argument");let n=this._checkKey(t);if(n)return this._nextTick(r,n);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(t,e,r)};vr.prototype._get=function(t,e,r){this._nextTick(function(){r(new Error("NotFound"))})};vr.prototype.getMany=function(t,e,r){if(r=xKe(e,r),r=RKe.fromCallback(r),e=PKe(e),DKe(this,r))return r.promise;if(!Array.isArray(t))return this._nextTick(r,new Error("getMany() requires an array argument")),r.promise;if(t.length===0)return this._nextTick(r,null,[]),r.promise;typeof e.asBuffer!="boolean"&&(e={...e,asBuffer:!0});let n=new Array(t.length);for(let i=0;i<t.length;i++){let s=t[i],o=this._checkKey(s);if(o)return this._nextTick(r,o),r.promise;n[i]=this._serializeKey(s)}return this._getMany(n,e,r),r.promise};vr.prototype._getMany=function(t,e,r){this._nextTick(r,null,new Array(t.length).fill(void 0))};vr.prototype.put=function(t,e,r,n){if(typeof r=="function"&&(n=r),typeof n!="function")throw new Error("put() requires a callback argument");let i=this._checkKey(t)||this._checkValue(e);if(i)return this._nextTick(n,i);t=this._serializeKey(t),e=this._serializeValue(e),(typeof r!="object"||r===null)&&(r={}),this._put(t,e,r,n)};vr.prototype._put=function(t,e,r,n){this._nextTick(n)};vr.prototype.del=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("del() requires a callback argument");let n=this._checkKey(t);if(n)return this._nextTick(r,n);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),this._del(t,e,r)};vr.prototype._del=function(t,e,r){this._nextTick(r)};vr.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(r=e),typeof t=="function"&&(r=t),typeof r!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return this._nextTick(r,new Error("batch(array) requires an array argument"));if(t.length===0)return this._nextTick(r);(typeof e!="object"||e===null)&&(e={});let n=new Array(t.length);for(let i=0;i<t.length;i++){if(typeof t[i]!="object"||t[i]===null)return this._nextTick(r,new Error("batch(array) element must be an object and not `null`"));let s=Object.assign({},t[i]);if(s.type!=="put"&&s.type!=="del")return this._nextTick(r,new Error("`type` must be 'put' or 'del'"));let o=this._checkKey(s.key);if(o)return this._nextTick(r,o);if(s.key=this._serializeKey(s.key),s.type==="put"){let a=this._checkValue(s.value);if(a)return this._nextTick(r,a);s.value=this._serializeValue(s.value)}n[i]=s}this._batch(n,e,r)};vr.prototype._batch=function(t,e,r){this._nextTick(r)};vr.prototype.clear=function(t,e){if(typeof t=="function")e=t;else if(typeof e!="function")throw new Error("clear() requires a callback argument");t=Zie(this,t),t.reverse=!!t.reverse,t.limit="limit"in t?t.limit:-1,this._clear(t,e)};vr.prototype._clear=function(t,e){t.keys=!0,t.values=!1,t.keyAsBuffer=!0,t.valueAsBuffer=!0;let r=this._iterator(t),n={},i=s=>{if(s)return r.end(function(){e(s)});r.next((o,a)=>{if(o)return i(o);if(a===void 0)return r.end(e);this._del(a,n,i)})};i()};vr.prototype._setupIteratorOptions=function(t){return t=Zie(this,t),t.reverse=!!t.reverse,t.keys=t.keys!==!1,t.values=t.values!==!1,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=t.keyAsBuffer!==!1,t.valueAsBuffer=t.valueAsBuffer!==!1,t};function Zie(t,e){let r={};for(let n in e){if(!CKe.call(e,n))continue;if(n==="start"||n==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let i=e[n];kKe(n)&&(i=t._serializeKey(i)),r[n]=i}return r}function kKe(t){return OKe.indexOf(t)!==-1}vr.prototype.iterator=function(t){return(typeof t!="object"||t===null)&&(t={}),t=this._setupIteratorOptions(t),this._iterator(t)};vr.prototype._iterator=function(t){return new IKe(this)};vr.prototype._chainedBatch=function(){return new TKe(this)};vr.prototype._serializeKey=function(t){return t};vr.prototype._serializeValue=function(t){return t};vr.prototype._checkKey=function(t){if(t==null)return new Error("key cannot be `null` or `undefined`");if(AKe(t)&&t.length===0)return new Error("key cannot be an empty Buffer");if(t==="")return new Error("key cannot be an empty String");if(Array.isArray(t)&&t.length===0)return new Error("key cannot be an empty Array")};vr.prototype._checkValue=function(t){if(t==null)return new Error("value cannot be `null` or `undefined`")};vr.prototype.isOperational=function(){return this.status==="open"||this._isOperational()};vr.prototype._isOperational=function(){return!1};vr.prototype._nextTick=Wb();Jie.exports=vr;function DKe(t,e){return t.isOperational()?!1:(t._nextTick(e,new Error("Database is not open")),!0)}});var Eu=g(Yb=>{"use strict";Yb.AbstractLevelDOWN=ese();Yb.AbstractIterator=ex();Yb.AbstractChainedBatch=tx()});var ix=g(tse=>{"use strict";tse.getCallback=function(t,e,r){let n=t[t.length-1];if(typeof n!="function"){let i=new Promise((s,o)=>{t.push(n=function(a,...c){a?o(a):s(r?r(...c):c[0])})});n[e]=i}return n}});var ose=g((JEt,sse)=>{"use strict";var{AbstractIterator:rse}=Eu(),NKe=Us(),nse=ix().getCallback,ise=Symbol("options"),b1=Symbol("iterator"),_1=Symbol("operations"),Xb=Symbol("promise");function sd(t,e){rse.call(this,t),this[ise]=e,this[b1]=null,this[_1]=[]}NKe(sd,rse);sd.prototype.setDb=function(t){this[b1]=t.iterator(this[ise]);for(let e of this[_1].splice(0,this[_1].length))this[b1][e.method](...e.args)};sd.prototype.next=function(...t){if(this.db.status==="open")return this[b1].next(...t);let e=nse(t,Xb,function(n,i){if(!(n===void 0&&i===void 0))return[n,i]});return this.db.status==="opening"?this[_1].push({method:"next",args:t}):this._nextTick(e,new Error("Database is not open")),e[Xb]||this};sd.prototype.seek=function(...t){if(this.db.status==="open")this[b1].seek(...t);else if(this.db.status==="opening")this[_1].push({method:"seek",args:t});else throw new Error("Database is not open")};sd.prototype.end=function(...t){if(this.db.status==="open")return this[b1].end(...t);let e=nse(t,Xb);return this.db.status==="opening"?this[_1].push({method:"end",args:t}):this._nextTick(e,new Error("Database is not open")),e[Xb]||this};for(let t of["next","seek","end"])sd.prototype["_"+t]=function(){throw new Error("Did not expect private method to be called: "+t)};sse.exports=sd});var cse=g((t9t,ase)=>{"use strict";var{AbstractChainedBatch:BKe}=Eu(),Rm=Symbol("operations");ase.exports=class extends BKe{constructor(e){super(e);this[Rm]=[]}_put(e,r,n){this[Rm].push({...n,type:"put",key:e,value:r})}_del(e,r){this[Rm].push({...r,type:"del",key:e})}_clear(){this[Rm]=[]}_write(e,r){this.db.batch(this[Rm],e,r)}}});var dse=g((r9t,sx)=>{"use strict";var{AbstractLevelDOWN:fse}=Eu(),LKe=Us(),hse=ose(),MKe=cse(),UKe=ix().getCallback,use=["put","get","getMany","del","batch","clear"],qKe=["approximateSize","compactRange"],_a=Symbol("innerDb"),v1=Symbol("operations"),lse=Symbol("promise");function od(t){fse.call(this,t.supports||{});for(let e of qKe)typeof t[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0);this[_a]=t,this[v1]=[],FKe(this)}LKe(od,fse);od.prototype.type="deferred-leveldown";Object.defineProperty(od.prototype,"_db",{enumerable:!0,get(){return this[_a]}});od.prototype._open=function(t,e){let r=n=>{if(n||this[_a].status!=="open")return e(n||new Error("Database is not open"));let i=this[v1];this[v1]=[];for(let s of i)s.iterator?s.iterator.setDb(this[_a]):this[_a][s.method](...s.args);if(this[v1].length>0)throw new Error("Did not expect further operations");e()};this[_a].status==="new"||this[_a].status==="closed"?this[_a].open(t,r):this._nextTick(r)};od.prototype._close=function(t){this[_a].close(t)};od.prototype._isOperational=function(){return this.status==="opening"};function FKe(t){let e=Object.keys(t.supports.additionalMethods);for(let r of use.concat(e))t[r]=function(...n){if(r==="batch"&&n.length===0)return new MKe(this);if(this.status==="open")return this[_a][r](...n);let i=UKe(n,lse);return this.status==="opening"?this[v1].push({method:r,args:n}):this._nextTick(i,new Error("Database is not open")),i[lse]};t.iterator=function(r){if(this.status==="open")return this[_a].iterator(r);if(this.status==="opening"){let n=new hse(this,r);return this[v1].push({iterator:n}),n}else throw new Error("Database is not open")};for(let r of use.concat(["iterator"]))t["_"+r]=function(){throw new Error("Did not expect private method to be called: "+r)}}sx.exports=od;sx.exports.DeferredIterator=hse});var ox=g((n9t,pse)=>{pse.exports=Gt().EventEmitter});var ax=g(()=>{});var wse=g((o9t,mse)=>{"use strict";function yse(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function KKe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yse(Object(r),!0).forEach(function(n){jKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yse(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jKe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VKe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gse(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zKe(t,e,r){return e&&gse(t.prototype,e),r&&gse(t,r),t}var HKe=On(),Qb=HKe.Buffer,$Ke=ax(),cx=$Ke.inspect,GKe=cx&&cx.custom||"inspect";function WKe(t,e,r){Qb.prototype.copy.call(t,e,r)}mse.exports=function(){function t(){VKe(this,t),this.head=null,this.tail=null,this.length=0}return zKe(t,[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i}},{key:"concat",value:function(r){if(this.length===0)return Qb.alloc(0);for(var n=Qb.allocUnsafe(r>>>0),i=this.head,s=0;i;)WKe(i.data,n,s),s+=i.data.length,i=i.next;return n}},{key:"consume",value:function(r,n){var i;return r<this.head.data.length?(i=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?i=this.shift():i=n?this._getString(r):this._getBuffer(r),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,i=1,s=n.data;for(r-=s.length;n=n.next;){var o=n.data,a=r>o.length?o.length:r;if(a===o.length?s+=o:s+=o.slice(0,r),r-=a,r===0){a===o.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(a));break}++i}return this.length-=i,s}},{key:"_getBuffer",value:function(r){var n=Qb.allocUnsafe(r),i=this.head,s=1;for(i.data.copy(n),r-=i.data.length;i=i.next;){var o=i.data,a=r>o.length?o.length:r;if(o.copy(n,n.length-r,0,a),r-=a,r===0){a===o.length?(++s,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(a));break}++s}return this.length-=s,n}},{key:GKe,value:function(r,n){return cx(this,KKe({},n,{depth:0,customInspect:!1}))}}]),t}()});var lx=g((a9t,_se)=>{"use strict";function YKe(t,e){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(ux,this,t)):process.nextTick(ux,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted?process.nextTick(Zb,r):(r._writableState.errorEmitted=!0,process.nextTick(bse,r,s)):process.nextTick(bse,r,s):e?(process.nextTick(Zb,r),e(s)):process.nextTick(Zb,r)}),this)}function bse(t,e){ux(t,e),Zb(t)}function Zb(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function XKe(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function ux(t,e){t.emit("error",e)}function QKe(t,e){var r=t._readableState,n=t._writableState;r&&r.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}_se.exports={destroy:YKe,undestroy:XKe,errorOrDestroy:QKe}});var ad=g((c9t,Sse)=>{"use strict";function ZKe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Ese={};function Io(t,e,r){r||(r=Error);function n(s,o,a){return typeof e=="string"?e:e(s,o,a)}var i=function(s){ZKe(o,s);function o(a,c,u){return s.call(this,n(a,c,u))||this}return o}(r);i.prototype.name=r.name,i.prototype.code=t,Ese[t]=i}function vse(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(n){return String(n)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function JKe(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function eje(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function tje(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}Io("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Io("ERR_INVALID_ARG_TYPE",function(t,e,r){var n;typeof e=="string"&&JKe(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";var i;if(eje(t," argument"))i="The ".concat(t," ").concat(n," ").concat(vse(e,"type"));else{var s=tje(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(s," ").concat(n," ").concat(vse(e,"type"))}return i+=". Received type ".concat(typeof r),i},TypeError);Io("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Io("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Io("ERR_STREAM_PREMATURE_CLOSE","Premature close");Io("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Io("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Io("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Io("ERR_STREAM_WRITE_AFTER_END","write after end");Io("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Io("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Io("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");Sse.exports.codes=Ese});var fx=g((u9t,Ase)=>{"use strict";var rje=ad().codes.ERR_INVALID_OPT_VALUE;function nje(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function ije(t,e,r,n){var i=nje(e,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var s=n?r:"highWaterMark";throw new rje(s,i)}return Math.floor(i)}return t.objectMode?16:16*1024}Ase.exports={getHighWaterMark:ije}});var Ise=g((l9t,Rse)=>{Rse.exports=sje;function sje(t,e){if(hx("noDeprecation"))return t;var r=!1;function n(){if(!r){if(hx("throwDeprecation"))throw new Error(e);hx("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return n}function hx(t){try{if(!globalThis.localStorage)return!1}catch{return!1}var e=globalThis.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}});var yx=g((f9t,kse)=>{"use strict";kse.exports=cn;function xse(t){var e=this;this.next=null,this.entry=null,this.finish=function(){kje(e,t)}}var E1;cn.WritableState=Tm;var oje={deprecate:Ise()},Pse=ox(),e8=On().Buffer,aje=globalThis.Uint8Array||function(){};function cje(t){return e8.from(t)}function uje(t){return e8.isBuffer(t)||t instanceof aje}var px=lx(),lje=fx(),fje=lje.getHighWaterMark,of=ad().codes,hje=of.ERR_INVALID_ARG_TYPE,dje=of.ERR_METHOD_NOT_IMPLEMENTED,pje=of.ERR_MULTIPLE_CALLBACK,yje=of.ERR_STREAM_CANNOT_PIPE,gje=of.ERR_STREAM_DESTROYED,mje=of.ERR_STREAM_NULL_VALUES,wje=of.ERR_STREAM_WRITE_AFTER_END,bje=of.ERR_UNKNOWN_ENCODING,S1=px.errorOrDestroy;Us()(cn,Pse);function _je(){}function Tm(t,e,r){E1=E1||cd(),t=t||{},typeof r!="boolean"&&(r=e instanceof E1),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=fje(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){Tje(e,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new xse(this)}Tm.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(Tm.prototype,"buffer",{get:oje.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var Jb;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Jb=Function.prototype[Symbol.hasInstance],Object.defineProperty(cn,Symbol.hasInstance,{value:function(e){return Jb.call(this,e)?!0:this!==cn?!1:e&&e._writableState instanceof Tm}})):Jb=function(e){return e instanceof this};function cn(t){E1=E1||cd();var e=this instanceof E1;if(!e&&!Jb.call(cn,this))return new cn(t);this._writableState=new Tm(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),Pse.call(this)}cn.prototype.pipe=function(){S1(this,new yje)};function vje(t,e){var r=new wje;S1(t,r),process.nextTick(e,r)}function Eje(t,e,r,n){var i;return r===null?i=new mje:typeof r!="string"&&!e.objectMode&&(i=new hje("chunk",["string","Buffer"],r)),i?(S1(t,i),process.nextTick(n,i),!1):!0}cn.prototype.write=function(t,e,r){var n=this._writableState,i=!1,s=!n.objectMode&&uje(t);return s&&!e8.isBuffer(t)&&(t=cje(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=_je),n.ending?vje(this,r):(s||Eje(this,n,t,r))&&(n.pendingcb++,i=Aje(this,n,s,t,e,r)),i};cn.prototype.cork=function(){this._writableState.corked++};cn.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&Cse(this,t))};cn.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new bje(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(cn.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Sje(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=e8.from(e,r)),e}Object.defineProperty(cn.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Aje(t,e,r,n,i,s){if(!r){var o=Sje(e,n,i);n!==o&&(r=!0,i="buffer",n=o)}var a=e.objectMode?1:n.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else dx(t,e,!1,a,n,i,s);return c}function dx(t,e,r,n,i,s,o){e.writelen=n,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new gje("write")):r?t._writev(i,e.onwrite):t._write(i,s,e.onwrite),e.sync=!1}function Rje(t,e,r,n,i){--e.pendingcb,r?(process.nextTick(i,n),process.nextTick(Im,t,e),t._writableState.errorEmitted=!0,S1(t,n)):(i(n),t._writableState.errorEmitted=!0,S1(t,n),Im(t,e))}function Ije(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function Tje(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function")throw new pje;if(Ije(r),e)Rje(t,r,n,e,i);else{var s=Ose(r)||t.destroyed;!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&Cse(t,r),n?process.nextTick(Tse,t,r,s,i):Tse(t,r,s,i)}}function Tse(t,e,r,n){r||xje(t,e),e.pendingcb--,n(),Im(t,e)}function xje(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function Cse(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),s=e.corkedRequestsFree;s.entry=r;for(var o=0,a=!0;r;)i[o]=r,r.isBuf||(a=!1),r=r.next,o+=1;i.allBuffers=a,dx(t,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new xse(e),e.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,l=r.callback,f=e.objectMode?1:c.length;if(dx(t,e,!1,f,c,u,l),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}cn.prototype._write=function(t,e,r){r(new dje("_write()"))};cn.prototype._writev=null;cn.prototype.end=function(t,e,r){var n=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||Oje(this,n,r),this};Object.defineProperty(cn.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Ose(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function Pje(t,e){t._final(function(r){e.pendingcb--,r&&S1(t,r),e.prefinished=!0,t.emit("prefinish"),Im(t,e)})}function Cje(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(Pje,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function Im(t,e){var r=Ose(e);if(r&&(Cje(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return r}function Oje(t,e,r){e.ending=!0,Im(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function kje(t,e,r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree.next=t}Object.defineProperty(cn.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});cn.prototype.destroy=px.destroy;cn.prototype._undestroy=px.undestroy;cn.prototype._destroy=function(t,e){e(t)}});var cd=g((h9t,Nse)=>{"use strict";var Dje=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};Nse.exports=Ac;var Dse=wx(),mx=yx();Us()(Ac,Dse);for(gx=Dje(mx.prototype),t8=0;t8<gx.length;t8++)r8=gx[t8],Ac.prototype[r8]||(Ac.prototype[r8]=mx.prototype[r8]);var gx,r8,t8;function Ac(t){if(!(this instanceof Ac))return new Ac(t);Dse.call(this,t),mx.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",Nje)))}Object.defineProperty(Ac.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(Ac.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Ac.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Nje(){this._writableState.ended||process.nextTick(Bje,this)}function Bje(t){t.end()}Object.defineProperty(Ac.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var _x=g((bx,Lse)=>{var n8=On(),Rc=n8.Buffer;function Bse(t,e){for(var r in t)e[r]=t[r]}Rc.from&&Rc.alloc&&Rc.allocUnsafe&&Rc.allocUnsafeSlow?Lse.exports=n8:(Bse(n8,bx),bx.Buffer=ud);function ud(t,e,r){return Rc(t,e,r)}ud.prototype=Object.create(Rc.prototype);Bse(Rc,ud);ud.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Rc(t,e,r)};ud.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=Rc(t);return e!==void 0?typeof r=="string"?n.fill(e,r):n.fill(e):n.fill(0),n};ud.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Rc(t)};ud.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return n8.SlowBuffer(t)}});var Sx=g(Use=>{"use strict";var Ex=_x().Buffer,Mse=Ex.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Lje(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function Mje(t){var e=Lje(t);if(typeof e!="string"&&(Ex.isEncoding===Mse||!Mse(t)))throw new Error("Unknown encoding: "+t);return e||t}Use.StringDecoder=xm;function xm(t){this.encoding=Mje(t);var e;switch(this.encoding){case"utf16le":this.text=Vje,this.end=zje,e=4;break;case"utf8":this.fillLast=Fje,e=4;break;case"base64":this.text=Hje,this.end=$je,e=3;break;default:this.write=Gje,this.end=Wje;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Ex.allocUnsafe(e)}xm.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};xm.prototype.end=jje;xm.prototype.text=Kje;xm.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function vx(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function Uje(t,e,r){var n=e.length-1;if(n<r)return 0;var i=vx(e[n]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--n<r||i===-2?0:(i=vx(e[n]),i>=0?(i>0&&(t.lastNeed=i-2),i):--n<r||i===-2?0:(i=vx(e[n]),i>=0?(i>0&&(i===2?i=0:t.lastNeed=i-3),i):0))}function qje(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function Fje(t){var e=this.lastTotal-this.lastNeed,r=qje(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function Kje(t,e){var r=Uje(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function jje(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function Vje(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function zje(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function Hje(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function $je(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Gje(t){return t.toString(this.encoding)}function Wje(t){return t&&t.length?this.write(t):""}});var i8=g((p9t,Kse)=>{"use strict";var qse=ad().codes.ERR_STREAM_PREMATURE_CLOSE;function Yje(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}}function Xje(){}function Qje(t){return t.setHeader&&typeof t.abort=="function"}function Fse(t,e,r){if(typeof e=="function")return Fse(t,null,e);e||(e={}),r=Yje(r||Xje);var n=e.readable||e.readable!==!1&&t.readable,i=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||a()},o=t._writableState&&t._writableState.finished,a=function(){i=!1,o=!0,n||r.call(t)},c=t._readableState&&t._readableState.endEmitted,u=function(){n=!1,c=!0,i||r.call(t)},l=function(p){r.call(t,p)},f=function(){var p;if(n&&!c)return(!t._readableState||!t._readableState.ended)&&(p=new qse),r.call(t,p);if(i&&!o)return(!t._writableState||!t._writableState.ended)&&(p=new qse),r.call(t,p)},h=function(){t.req.on("finish",a)};return Qje(t)?(t.on("complete",a),t.on("abort",f),t.req?h():t.on("request",h)):i&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",u),t.on("finish",a),e.error!==!1&&t.on("error",l),t.on("close",f),function(){t.removeListener("complete",a),t.removeListener("abort",f),t.removeListener("request",h),t.req&&t.req.removeListener("finish",a),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",a),t.removeListener("end",u),t.removeListener("error",l),t.removeListener("close",f)}}Kse.exports=Fse});var Vse=g((y9t,jse)=>{"use strict";var s8;function af(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Zje=i8(),cf=Symbol("lastResolve"),ld=Symbol("lastReject"),Pm=Symbol("error"),o8=Symbol("ended"),fd=Symbol("lastPromise"),Ax=Symbol("handlePromise"),hd=Symbol("stream");function uf(t,e){return{value:t,done:e}}function Jje(t){var e=t[cf];if(e!==null){var r=t[hd].read();r!==null&&(t[fd]=null,t[cf]=null,t[ld]=null,e(uf(r,!1)))}}function eVe(t){process.nextTick(Jje,t)}function tVe(t,e){return function(r,n){t.then(function(){if(e[o8]){r(uf(void 0,!0));return}e[Ax](r,n)},n)}}var rVe=Object.getPrototypeOf(function(){}),nVe=Object.setPrototypeOf((s8={get stream(){return this[hd]},next:function(){var e=this,r=this[Pm];if(r!==null)return Promise.reject(r);if(this[o8])return Promise.resolve(uf(void 0,!0));if(this[hd].destroyed)return new Promise(function(o,a){process.nextTick(function(){e[Pm]?a(e[Pm]):o(uf(void 0,!0))})});var n=this[fd],i;if(n)i=new Promise(tVe(n,this));else{var s=this[hd].read();if(s!==null)return Promise.resolve(uf(s,!1));i=new Promise(this[Ax])}return this[fd]=i,i}},af(s8,Symbol.asyncIterator,function(){return this}),af(s8,"return",function(){var e=this;return new Promise(function(r,n){e[hd].destroy(null,function(i){if(i){n(i);return}r(uf(void 0,!0))})})}),s8),rVe),iVe=function(e){var r,n=Object.create(nVe,(r={},af(r,hd,{value:e,writable:!0}),af(r,cf,{value:null,writable:!0}),af(r,ld,{value:null,writable:!0}),af(r,Pm,{value:null,writable:!0}),af(r,o8,{value:e._readableState.endEmitted,writable:!0}),af(r,Ax,{value:function(s,o){var a=n[hd].read();a?(n[fd]=null,n[cf]=null,n[ld]=null,s(uf(a,!1))):(n[cf]=s,n[ld]=o)},writable:!0}),r));return n[fd]=null,Zje(e,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=n[ld];s!==null&&(n[fd]=null,n[cf]=null,n[ld]=null,s(i)),n[Pm]=i;return}var o=n[cf];o!==null&&(n[fd]=null,n[cf]=null,n[ld]=null,o(uf(void 0,!0))),n[o8]=!0}),e.on("readable",eVe.bind(null,n)),n};jse.exports=iVe});var Hse=g((g9t,zse)=>{zse.exports=function(){throw new Error("Readable.from is not available in the browser")}});var wx=g((w9t,toe)=>{"use strict";toe.exports=Jt;var A1;Jt.ReadableState=Yse;var m9t=Gt().EventEmitter,Wse=function(e,r){return e.listeners(r).length},Om=ox(),a8=On().Buffer,sVe=globalThis.Uint8Array||function(){};function oVe(t){return a8.from(t)}function aVe(t){return a8.isBuffer(t)||t instanceof sVe}var Rx=ax(),Rt;Rx&&Rx.debuglog?Rt=Rx.debuglog("stream"):Rt=function(){};var cVe=wse(),kx=lx(),uVe=fx(),lVe=uVe.getHighWaterMark,c8=ad().codes,fVe=c8.ERR_INVALID_ARG_TYPE,hVe=c8.ERR_STREAM_PUSH_AFTER_EOF,dVe=c8.ERR_METHOD_NOT_IMPLEMENTED,pVe=c8.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,R1,Ix,Tx;Us()(Jt,Om);var Cm=kx.errorOrDestroy,xx=["error","close","destroy","pause","resume"];function yVe(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function Yse(t,e,r){A1=A1||cd(),t=t||{},typeof r!="boolean"&&(r=e instanceof A1),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=lVe(this,t,"readableHighWaterMark",r),this.buffer=new cVe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(R1||(R1=Sx().StringDecoder),this.decoder=new R1(t.encoding),this.encoding=t.encoding)}function Jt(t){if(A1=A1||cd(),!(this instanceof Jt))return new Jt(t);var e=this instanceof A1;this._readableState=new Yse(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),Om.call(this)}Object.defineProperty(Jt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});Jt.prototype.destroy=kx.destroy;Jt.prototype._undestroy=kx.undestroy;Jt.prototype._destroy=function(t,e){e(t)};Jt.prototype.push=function(t,e){var r=this._readableState,n;return r.objectMode?n=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=a8.from(t,e),e=""),n=!0),Xse(this,t,e,!1,n)};Jt.prototype.unshift=function(t){return Xse(this,t,null,!0,!1)};function Xse(t,e,r,n,i){Rt("readableAddChunk",e);var s=t._readableState;if(e===null)s.reading=!1,wVe(t,s);else{var o;if(i||(o=gVe(s,e)),o)Cm(t,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==a8.prototype&&(e=oVe(e)),n)s.endEmitted?Cm(t,new pVe):Px(t,s,e,!0);else if(s.ended)Cm(t,new hVe);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?Px(t,s,e,!1):Ox(t,s)):Px(t,s,e,!1)}else n||(s.reading=!1,Ox(t,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function Px(t,e,r,n){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&u8(t)),Ox(t,e)}function gVe(t,e){var r;return!aVe(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new fVe("chunk",["string","Buffer","Uint8Array"],e)),r}Jt.prototype.isPaused=function(){return this._readableState.flowing===!1};Jt.prototype.setEncoding=function(t){R1||(R1=Sx().StringDecoder);var e=new R1(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";r!==null;)n+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var $se=1073741824;function mVe(t){return t>=$se?t=$se:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function Gse(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=mVe(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Jt.prototype.read=function(t){Rt("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return Rt("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Cx(this):u8(this),null;if(t=Gse(t,e),t===0&&e.ended)return e.length===0&&Cx(this),null;var n=e.needReadable;Rt("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,Rt("length less than watermark",n)),e.ended||e.reading?(n=!1,Rt("reading or ended",n)):n&&(Rt("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=Gse(r,e)));var i;return t>0?i=Jse(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&Cx(this)),i!==null&&this.emit("data",i),i};function wVe(t,e){if(Rt("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?u8(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,Qse(t)))}}function u8(t){var e=t._readableState;Rt("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(Rt("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(Qse,t))}function Qse(t){var e=t._readableState;Rt("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,Dx(t)}function Ox(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(bVe,t,e))}function bVe(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(Rt("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}Jt.prototype._read=function(t){Cm(this,new dVe("_read()"))};Jt.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,Rt("pipe count=%d opts=%j",n.pipesCount,e);var i=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=i?a:y;n.endEmitted?process.nextTick(s):r.once("end",s),t.on("unpipe",o);function o(b,m){Rt("onunpipe"),b===r&&m&&m.hasUnpiped===!1&&(m.hasUnpiped=!0,l())}function a(){Rt("onend"),t.end()}var c=_Ve(r);t.on("drain",c);var u=!1;function l(){Rt("cleanup"),t.removeListener("close",d),t.removeListener("finish",p),t.removeListener("drain",c),t.removeListener("error",h),t.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",y),r.removeListener("data",f),u=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}r.on("data",f);function f(b){Rt("ondata");var m=t.write(b);Rt("dest.write",m),m===!1&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&eoe(n.pipes,t)!==-1)&&!u&&(Rt("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function h(b){Rt("onerror",b),y(),t.removeListener("error",h),Wse(t,"error")===0&&Cm(t,b)}yVe(t,"error",h);function d(){t.removeListener("finish",p),y()}t.once("close",d);function p(){Rt("onfinish"),t.removeListener("close",d),y()}t.once("finish",p);function y(){Rt("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||(Rt("pipe resume"),r.resume()),t};function _Ve(t){return function(){var r=t._readableState;Rt("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&Wse(t,"data")&&(r.flowing=!0,Dx(t))}}Jt.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=eoe(e.pipes,t);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};Jt.prototype.on=function(t,e){var r=Om.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,Rt("on readable",n.length,n.reading),n.length?u8(this):n.reading||process.nextTick(vVe,this)),r};Jt.prototype.addListener=Jt.prototype.on;Jt.prototype.removeListener=function(t,e){var r=Om.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(Zse,this),r};Jt.prototype.removeAllListeners=function(t){var e=Om.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(Zse,this),e};function Zse(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function vVe(t){Rt("readable nexttick read 0"),t.read(0)}Jt.prototype.resume=function(){var t=this._readableState;return t.flowing||(Rt("resume"),t.flowing=!t.readableListening,EVe(this,t)),t.paused=!1,this};function EVe(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(SVe,t,e))}function SVe(t,e){Rt("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),Dx(t),e.flowing&&!e.reading&&t.read(0)}Jt.prototype.pause=function(){return Rt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Rt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Dx(t){var e=t._readableState;for(Rt("flow",e.flowing);e.flowing&&t.read()!==null;);}Jt.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;t.on("end",function(){if(Rt("wrapped end"),r.decoder&&!r.ended){var o=r.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),t.on("data",function(o){if(Rt("wrapped data"),r.decoder&&(o=r.decoder.write(o)),!(r.objectMode&&o==null)&&!(!r.objectMode&&(!o||!o.length))){var a=e.push(o);a||(n=!0,t.pause())}});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(a){return function(){return t[a].apply(t,arguments)}}(i));for(var s=0;s<xx.length;s++)t.on(xx[s],this.emit.bind(this,xx[s]));return this._read=function(o){Rt("wrapped _read",o),n&&(n=!1,t.resume())},this};typeof Symbol=="function"&&(Jt.prototype[Symbol.asyncIterator]=function(){return Ix===void 0&&(Ix=Vse()),Ix(this)});Object.defineProperty(Jt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Jt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Jt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Jt._fromList=Jse;Object.defineProperty(Jt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Jse(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function Cx(t){var e=t._readableState;Rt("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(AVe,e,t))}function AVe(t,e){if(Rt("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(Jt.from=function(t,e){return Tx===void 0&&(Tx=Hse()),Tx(Jt,t,e)});function eoe(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}});var Nx=g((b9t,noe)=>{"use strict";noe.exports=Su;var l8=ad().codes,RVe=l8.ERR_METHOD_NOT_IMPLEMENTED,IVe=l8.ERR_MULTIPLE_CALLBACK,TVe=l8.ERR_TRANSFORM_ALREADY_TRANSFORMING,xVe=l8.ERR_TRANSFORM_WITH_LENGTH_0,f8=cd();Us()(Su,f8);function PVe(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new IVe);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Su(t){if(!(this instanceof Su))return new Su(t);f8.call(this,t),this._transformState={afterTransform:PVe.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",CVe)}function CVe(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){roe(t,e,r)}):roe(this,null,null)}Su.prototype.push=function(t,e){return this._transformState.needTransform=!1,f8.prototype.push.call(this,t,e)};Su.prototype._transform=function(t,e,r){r(new RVe("_transform()"))};Su.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};Su.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Su.prototype._destroy=function(t,e){f8.prototype._destroy.call(this,t,function(r){e(r)})};function roe(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new xVe;if(t._transformState.transforming)throw new TVe;return t.push(null)}});var ooe=g((_9t,soe)=>{"use strict";soe.exports=km;var ioe=Nx();Us()(km,ioe);function km(t){if(!(this instanceof km))return new km(t);ioe.call(this,t)}km.prototype._transform=function(t,e,r){r(null,t)}});var foe=g((v9t,loe)=>{"use strict";var Bx;function OVe(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var uoe=ad().codes,kVe=uoe.ERR_MISSING_ARGS,DVe=uoe.ERR_STREAM_DESTROYED;function aoe(t){if(t)throw t}function NVe(t){return t.setHeader&&typeof t.abort=="function"}function BVe(t,e,r,n){n=OVe(n);var i=!1;t.on("close",function(){i=!0}),Bx===void 0&&(Bx=i8()),Bx(t,{readable:e,writable:r},function(o){if(o)return n(o);i=!0,n()});var s=!1;return function(o){if(!i&&!s){if(s=!0,NVe(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();n(o||new DVe("pipe"))}}}function coe(t){t()}function LVe(t,e){return t.pipe(e)}function MVe(t){return!t.length||typeof t[t.length-1]!="function"?aoe:t.pop()}function UVe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=MVe(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new kVe("streams");var i,s=e.map(function(o,a){var c=a<e.length-1,u=a>0;return BVe(o,c,u,function(l){i||(i=l),l&&s.forEach(coe),!c&&(s.forEach(coe),n(i))})});return e.reduce(LVe)}loe.exports=UVe});var Lx=g((To,hoe)=>{To=hoe.exports=wx();To.Stream=To;To.Readable=To;To.Writable=yx();To.Duplex=cd();To.Transform=Nx();To.PassThrough=ooe();To.finished=i8();To.pipeline=foe()});var yoe=g((E9t,poe)=>{"use strict";var qVe=Us(),{Readable:doe}=Lx();poe.exports=I1;qVe(I1,doe);function I1(t,e){if(!(this instanceof I1))return new I1(t,e);e=e||{},doe.call(this,Object.assign({},e,{objectMode:!0})),this._iterator=t,this._options=e,this.on("end",this.destroy.bind(this,null,null))}I1.prototype._read=function(){this.destroyed||this._iterator.next((t,e,r)=>{if(!this.destroyed){if(t)return this.destroy(t);e===void 0&&r===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(e):this._options.keys===!1&&this._options.values!==!1?this.push(r):this.push({key:e,value:r})}})};I1.prototype._destroy=function(t,e){this._iterator.end(function(r){e(t||r)})}});var d8=g((S9t,h8)=>{"use strict";function pd(t,e){let r=function(n,i){if(typeof n=="object"&&n!==null&&(i=i||n,n=n.message||n.name),n=n||"",i=i||void 0,typeof i=="object"&&i.type===t&&i.message===n)return i;Object.defineProperty(this,"type",{value:t,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"name",{value:t,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"cause",{value:i,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"message",{value:n,enumerable:!1,writable:!0,configurable:!0}),Error.call(this),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,r)};return r.prototype=new e,r}var dd=pd("LevelUPError",Error);h8.exports={LevelUPError:dd,InitializationError:pd("InitializationError",dd),OpenError:pd("OpenError",dd),ReadError:pd("ReadError",dd),WriteError:pd("WriteError",dd),NotFoundError:pd("NotFoundError",dd),EncodingError:pd("EncodingError",dd)};h8.exports.NotFoundError.prototype.notFound=!0;h8.exports.NotFoundError.prototype.status=404});var Dm=g(Mx=>{"use strict";Mx.getCallback=function(t,e){return typeof t=="function"?t:e};Mx.getOptions=function(t){return typeof t=="object"&&t!==null?t:{}}});var moe=g((R9t,goe)=>{"use strict";var Nm=d8().WriteError,FVe=Gb(),KVe=Dm().getCallback,jVe=Dm().getOptions;function Bm(t){this.db=t,this.batch=t.db.batch(),this.ops=[],this.length=0}Bm.prototype.put=function(t,e,r){try{this.batch.put(t,e,r)}catch(n){throw new Nm(n)}return this.ops.push({...r,type:"put",key:t,value:e}),this.length++,this};Bm.prototype.del=function(t,e){try{this.batch.del(t,e)}catch(r){throw new Nm(r)}return this.ops.push({...e,type:"del",key:t}),this.length++,this};Bm.prototype.clear=function(){try{this.batch.clear()}catch(t){throw new Nm(t)}return this.ops=[],this.length=0,this};Bm.prototype.write=function(t,e){let r=this.db,n=this.ops;e=KVe(t,e),e=FVe.fromCallback(e),t=jVe(t);try{this.batch.write(t,function(i){if(i)return e(new Nm(i));r.emit("batch",n),e()})}catch(i){throw new Nm(i)}return e.promise};goe.exports=Bm});var _oe=g((I9t,boe)=>{"use strict";var woe=Am();boe.exports=function(t,...e){e.length===0?woe(t):woe(()=>t(...e))}});var Soe=g((T9t,Eoe)=>{"use strict";var p8=Gt().EventEmitter,VVe=Mie().inherits,zVe=dse(),HVe=yoe(),$Ve=moe(),T1=d8(),GVe=ZT(),yd=Gb(),Lm=Dm().getCallback,x1=Dm().getOptions,Mm=_oe(),y8=T1.WriteError,voe=T1.ReadError,WVe=T1.NotFoundError,YVe=T1.OpenError,XVe=T1.InitializationError;function cr(t,e,r){if(!(this instanceof cr))return new cr(t,e,r);let n;if(p8.call(this),this.setMaxListeners(1/0),typeof e=="function"&&(r=e,e={}),e=e||{},!t||typeof t!="object"){if(n=new XVe("First argument must be an abstract-leveldown compliant store"),typeof r=="function")return Mm(r,n);throw n}if(typeof t.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=x1(e),this._db=t,this.db=null,this.open(r||(i=>{i&&this.emit("error",i)})),this.supports=GVe(this.db.supports,{status:!0,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let i of Object.keys(this.supports.additionalMethods))this[i]==null&&(this[i]=function(...s){return this.db[i](...s)})}cr.prototype.emit=p8.prototype.emit;cr.prototype.once=p8.prototype.once;VVe(cr,p8);Object.defineProperty(cr.prototype,"status",{enumerable:!0,get(){return this.db.status}});cr.prototype.isOperational=function(){return this.db.status==="open"||this.db.status==="opening"};cr.prototype.open=function(t,e){return typeof t=="function"&&(e=t,t=null),e=yd.fromCallback(e),t||(t=this.options),this.db&&this.isOpen()?(Mm(e,null,this),e.promise):this.db&&this._isOpening()?(this.once("open",()=>{e(null,this)}),e.promise):(this.db=new zVe(this._db),this.emit("opening"),this.db.open(t,r=>{if(r)return e(new YVe(r));this.db=this._db,e(null,this),this.emit("open"),this.emit("ready")}),e.promise)};cr.prototype.close=function(t){return t=yd.fromCallback(t),this.isOpen()?(this.db.close((e,...r)=>{this.emit("closed"),t(e,...r)}),this.emit("closing")):this.isClosed()?Mm(t):this.db.status==="closing"?this.once("closed",t):this._isOpening()&&this.once("open",()=>{this.close(t)}),t.promise};cr.prototype.isOpen=function(){return this.db.status==="open"};cr.prototype._isOpening=function(){return this.db.status==="opening"};cr.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)};cr.prototype.get=function(t,e,r){return r=Lm(e,r),r=yd.fromCallback(r),Um(this,r)||(e=x1(e),this.db.get(t,e,function(n,i){if(n)return/notfound/i.test(n)||n.notFound?n=new WVe("Key not found in database ["+t+"]",n):n=new voe(n),r(n);r(null,i)})),r.promise};cr.prototype.getMany=function(t,e,r){return this.db.getMany(t,e,r)};cr.prototype.put=function(t,e,r,n){return n=Lm(r,n),n=yd.fromCallback(n),Um(this,n)||(r=x1(r),this.db.put(t,e,r,i=>{if(i)return n(new y8(i));this.emit("put",t,e),n()})),n.promise};cr.prototype.del=function(t,e,r){return r=Lm(e,r),r=yd.fromCallback(r),Um(this,r)||(e=x1(e),this.db.del(t,e,n=>{if(n)return r(new y8(n));this.emit("del",t),r()})),r.promise};cr.prototype.batch=function(t,e,r){return arguments.length?(typeof t=="function"?r=t:r=Lm(e,r),r=yd.fromCallback(r),Um(this,r)||(e=x1(e),this.db.batch(t,e,n=>{if(n)return r(new y8(n));this.emit("batch",t),r()})),r.promise):new $Ve(this)};cr.prototype.iterator=function(t){return this.db.iterator(t)};cr.prototype.clear=function(t,e){return e=Lm(t,e),t=x1(t),e=yd.fromCallback(e),Um(this,e)||this.db.clear(t,r=>{if(r)return e(new y8(r));this.emit("clear",t),e()}),e.promise};cr.prototype.readStream=cr.prototype.createReadStream=function(t){return t=Object.assign({keys:!0,values:!0},t),typeof t.limit!="number"&&(t.limit=-1),new HVe(this.db.iterator(t),t)};cr.prototype.keyStream=cr.prototype.createKeyStream=function(t){return this.createReadStream(Object.assign({},t,{keys:!0,values:!1}))};cr.prototype.valueStream=cr.prototype.createValueStream=function(t){return this.createReadStream(Object.assign({},t,{keys:!1,values:!0}))};cr.prototype.toString=function(){return"LevelUP"};cr.prototype.type="levelup";cr.prototype._nextTick=Mm;function Um(t,e){return t.isOperational()?!1:(Mm(e,new voe("Database is not open")),!0)}cr.errors=T1;Eoe.exports=cr});var Aoe=g(Au=>{"use strict";var{Buffer:Ux}=On();Au.utf8=Au["utf-8"]={encode:function(t){return qx(t)?t:String(t)},decode:g8,buffer:!1,type:"utf8"};Au.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"};Au.binary={encode:function(t){return qx(t)?t:Ux.from(t)},decode:g8,buffer:!0,type:"binary"};Au.none={encode:g8,decode:g8,buffer:!1,type:"id"};Au.id=Au.none;var QVe=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let t of QVe)Au[t]={encode:function(e){return qx(e)?e:Ux.from(e,t)},decode:function(e){return e.toString(t)},buffer:!0,type:t};function g8(t){return t}function qx(t){return t==null||Ux.isBuffer(t)}});var Ioe=g((P9t,Roe)=>{"use strict";var Fx=Aoe(),ZVe=new Set(["lt","gt","lte","gte"]);Roe.exports=Gi;function Gi(t){if(!(this instanceof Gi))return new Gi(t);this.opts=t||{},this.encodings=Fx}Gi.prototype._encoding=function(t){return typeof t=="string"&&(t=Fx[t]),t||(t=Fx.id),t};Gi.prototype._keyEncoding=function(t,e){return this._encoding(e&&e.keyEncoding||t&&t.keyEncoding||this.opts.keyEncoding)};Gi.prototype._valueEncoding=function(t,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||t&&(t.valueEncoding||t.encoding)||this.opts.valueEncoding||this.opts.encoding)};Gi.prototype.encodeKey=function(t,e,r){return this._keyEncoding(e,r).encode(t)};Gi.prototype.encodeValue=function(t,e,r){return this._valueEncoding(e,r).encode(t)};Gi.prototype.decodeKey=function(t,e){return this._keyEncoding(e).decode(t)};Gi.prototype.decodeValue=function(t,e){return this._valueEncoding(e).decode(t)};Gi.prototype.encodeBatch=function(t,e){return t.map(r=>{let n={type:r.type,key:this.encodeKey(r.key,e,r)};return this.keyAsBuffer(e,r)&&(n.keyEncoding="binary"),r.prefix&&(n.prefix=r.prefix),"value"in r&&(n.value=this.encodeValue(r.value,e,r),this.valueAsBuffer(e,r)&&(n.valueEncoding="binary")),n})};Gi.prototype.encodeLtgt=function(t){let e={};for(let r of Object.keys(t)){if(r==="start"||r==="end")throw new Error('Legacy range options ("start" and "end") have been removed');e[r]=ZVe.has(r)?this.encodeKey(t[r],t):t[r]}return e};Gi.prototype.createStreamDecoder=function(t){return t.keys&&t.values?(e,r)=>({key:this.decodeKey(e,t),value:this.decodeValue(r,t)}):t.keys?e=>this.decodeKey(e,t):t.values?(e,r)=>this.decodeValue(r,t):function(){}};Gi.prototype.keyAsBuffer=function(t){return this._keyEncoding(t).buffer};Gi.prototype.valueAsBuffer=function(t){return this._valueEncoding(t).buffer}});var Ooe=g((C9t,Coe)=>{"use strict";var Toe=Eu().AbstractLevelDOWN,xoe=Eu().AbstractChainedBatch,Poe=Eu().AbstractIterator,Kx=Us(),JVe=Ioe(),jx=d8().EncodingError,eze=["approximateSize","compactRange"];Coe.exports=wi;function wi(t,e){if(!(this instanceof wi))return new wi(t,e);let r=t.supports||{},n=r.additionalMethods||{};Toe.call(this,r),this.supports.encodings=!0,this.supports.additionalMethods={},eze.forEach(function(i){let s=typeof t[i]=="function";(n[i]||s)&&(this.supports.additionalMethods[i]=!0,this[i]=function(o,a,c,u){return o=this.codec.encodeKey(o,c),a=this.codec.encodeKey(a,c),this.db[i](o,a,c,u)})},this),e=e||{},typeof e.keyEncoding>"u"&&(e.keyEncoding="utf8"),typeof e.valueEncoding>"u"&&(e.valueEncoding="utf8"),this.db=t,this.codec=new JVe(e)}Kx(wi,Toe);wi.prototype.type="encoding-down";wi.prototype._serializeKey=wi.prototype._serializeValue=function(t){return t};wi.prototype._open=function(t,e){this.db.open(t,e)};wi.prototype._close=function(t){this.db.close(t)};wi.prototype._put=function(t,e,r,n){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.db.put(t,e,r,n)};wi.prototype._get=function(t,e,r){t=this.codec.encodeKey(t,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(t,e,(n,i)=>{if(n)return r(n);try{i=this.codec.decodeValue(i,e)}catch(s){return r(new jx(s))}r(null,i)})};wi.prototype._getMany=function(t,e,r){t=t.map(n=>this.codec.encodeKey(n,e)),e.asBuffer=this.codec.valueAsBuffer(e),this.db.getMany(t,e,(n,i)=>{if(n)return r(n);let s=new Array(i.length);for(let o=0;o<i.length;o++){if(i[o]===void 0){s[o]=void 0;continue}try{s[o]=this.codec.decodeValue(i[o],e)}catch(a){return r(new jx(a))}}r(null,s)})};wi.prototype._del=function(t,e,r){t=this.codec.encodeKey(t,e),this.db.del(t,e,r)};wi.prototype._chainedBatch=function(){return new P1(this)};wi.prototype._batch=function(t,e,r){t=this.codec.encodeBatch(t,e),this.db.batch(t,e,r)};wi.prototype._iterator=function(t){return t.keyAsBuffer=this.codec.keyAsBuffer(t),t.valueAsBuffer=this.codec.valueAsBuffer(t),new qm(this,t)};wi.prototype._clear=function(t,e){t=this.codec.encodeLtgt(t),this.db.clear(t,e)};function qm(t,e){Poe.call(this,t),this.codec=t.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=t.db.iterator(this.opts)}Kx(qm,Poe);qm.prototype._next=function(t){this.it.next((e,r,n)=>{if(e)return t(e);try{this.keys&&typeof r<"u"?r=this.codec.decodeKey(r,this.opts):r=void 0,this.values&&typeof n<"u"?n=this.codec.decodeValue(n,this.opts):n=void 0}catch(i){return t(new jx(i))}t(null,r,n)})};qm.prototype._seek=function(t){t=this.codec.encodeKey(t,this.opts),this.it.seek(t)};qm.prototype._end=function(t){this.it.end(t)};function P1(t,e){xoe.call(this,t),this.codec=t.codec,this.batch=t.db.batch()}Kx(P1,xoe);P1.prototype._put=function(t,e,r){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.batch.put(t,e)};P1.prototype._del=function(t,e){t=this.codec.encodeKey(t,e),this.batch.del(t)};P1.prototype._clear=function(){this.batch.clear()};P1.prototype._write=function(t,e){this.batch.write(t,e)}});var Noe=g((O9t,Doe)=>{"use strict";var koe=Soe(),tze=Ooe();function rze(t){function e(n,i,s){return typeof n=="function"?s=n:typeof i=="function"&&(s=i),r(i)||(i=r(n)?n:{}),koe(tze(t(n,i),i),i,s)}function r(n){return typeof n=="object"&&n!==null}for(let n of["destroy","repair"])typeof t[n]=="function"&&(e[n]=function(...i){t[n](...i)});return e.errors=koe.errors,e}Doe.exports=rze});var Loe=g((k9t,Boe)=>{Boe.exports=ize;var nze=Am();function ize(t,e,r){if(typeof e!="number")throw new Error("second argument must be a Number");let n,i,s,o,a,c=!0,u;Array.isArray(t)?(n=[],s=i=t.length):(o=Object.keys(t),n={},s=i=o.length);function l(h){function d(){r&&r(h,n),r=null}c?nze(d):d()}function f(h,d,p){if(n[h]=p,d&&(a=!0),--s===0||d)l(d);else if(!a&&u<i){let y;o?(y=o[u],u+=1,t[y](function(b,m){f(y,b,m)})):(y=u,u+=1,t[y](function(b,m){f(y,b,m)}))}}u=e,s?o?o.some(function(h,d){return t[h](function(p,y){f(h,p,y)}),d===e-1}):t.some(function(h,d){return h(function(p,y){f(d,p,y)}),d===e-1}):l(null),c=!1}});var Uoe=g(En=>{En.compare=function(t,e){if(Buffer.isBuffer(t)){for(var r=Math.min(t.length,e.length),n=0;n<r;n++){var i=t[n]-e[n];if(i)return i}return t.length-e.length}return t<e?-1:t>e?1:0};function Moe(t){return t!==void 0&&t!==""}function C1(t,e){return Object.hasOwnProperty.call(t,e)}function Ic(t,e){return Object.hasOwnProperty.call(t,e)&&e}var sze=En.lowerBoundKey=function(t){return Ic(t,"gt")||Ic(t,"gte")||Ic(t,"min")||(t.reverse?Ic(t,"end"):Ic(t,"start"))||void 0},Vx=En.lowerBound=function(t,e){var r=sze(t);return r?t[r]:e},zx=En.lowerBoundInclusive=function(t){return!C1(t,"gt")},Hx=En.upperBoundInclusive=function(t){return!C1(t,"lt")},oze=En.lowerBoundExclusive=function(t){return!zx(t)},aze=En.upperBoundExclusive=function(t){return!Hx(t)},cze=En.upperBoundKey=function(t){return Ic(t,"lt")||Ic(t,"lte")||Ic(t,"max")||(t.reverse?Ic(t,"start"):Ic(t,"end"))||void 0},$x=En.upperBound=function(t,e){var r=cze(t);return r?t[r]:e};En.start=function(t,e){return t.reverse?$x(t,e):Vx(t,e)};En.end=function(t,e){return t.reverse?Vx(t,e):$x(t,e)};En.startInclusive=function(t){return t.reverse?Hx(t):zx(t)};En.endInclusive=function(t){return t.reverse?zx(t):Hx(t)};function uze(t){return t}En.toLtgt=function(t,e,r,n,i){e=e||{},r=r||uze;var s=arguments.length>3,o=En.lowerBoundKey(t),a=En.upperBoundKey(t);return o?o==="gt"?e.gt=r(t.gt,!1):e.gte=r(t[o],!1):s&&(e.gte=r(n,!1)),a?a==="lt"?e.lt=r(t.lt,!0):e.lte=r(t[a],!0):s&&(e.lte=r(i,!0)),t.reverse!=null&&(e.reverse=!!t.reverse),C1(e,"max")&&delete e.max,C1(e,"min")&&delete e.min,C1(e,"start")&&delete e.start,C1(e,"end")&&delete e.end,e};En.contains=function(t,e,r){r=r||En.compare;var n=Vx(t);if(Moe(n)){var i=r(e,n);if(i<0||i===0&&oze(t))return!1}var s=$x(t);if(Moe(s)){var i=r(e,s);if(i>0||i===0&&aze(t))return!1}return!0};En.filter=function(t,e){return function(r){return En.contains(t,r,e)}}});var Gx=g((N9t,qoe)=>{"use strict";var m8=Uoe(),lf=Symbol("none");qoe.exports=function(e){let r=m8.lowerBound(e,lf),n=m8.upperBound(e,lf),i=m8.lowerBoundExclusive(e,lf),s=m8.upperBoundExclusive(e,lf);return r!==lf&&n!==lf?IDBKeyRange.bound(r,n,i,s):r!==lf?IDBKeyRange.lowerBound(r,i):n!==lf?IDBKeyRange.upperBound(n,s):null}});var Wx=g((B9t,Koe)=>{"use strict";var w8=On().Buffer,lze=function(){if(globalThis.TextDecoder){let t=new TextDecoder("utf-8");return t.decode.bind(t)}else return function(e){return Foe(e).toString()}}(),fze=function(){if(globalThis.TextDecoder){let t=new TextDecoder("utf-8");return t.decode.bind(t)}else return function(e){return w8.from(e).toString()}}();function Foe(t){let e=w8.from(t.buffer);return t.byteLength===t.buffer.byteLength?e:e.slice(t.byteOffset,t.byteOffset+t.byteLength)}Koe.exports=function(t,e){return t instanceof Uint8Array?e?Foe(t):lze(t):t instanceof ArrayBuffer?e?w8.from(t):fze(t):e?w8.from(String(t)):String(t)}});var Hoe=g((L9t,zoe)=>{"use strict";var hze=Us(),joe=Eu().AbstractIterator,dze=Gx(),Voe=Wx(),pze=function(){};zoe.exports=va;function va(t,e,r){if(joe.call(this,t),this._limit=r.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=r.keys,this._values=r.values,this._keyAsBuffer=r.keyAsBuffer,this._valueAsBuffer=r.valueAsBuffer,this._limit===0){this._completed=!0;return}let n;try{n=dze(r)}catch{this._completed=!0;return}this.createIterator(e,n,r.reverse)}hze(va,joe);va.prototype.createIterator=function(t,e,r){let n=this.db.db.transaction([t],"readonly"),s=n.objectStore(t).openCursor(e,r?"prev":"next");s.onsuccess=o=>{let a=o.target.result;a&&this.onItem(a)},this._transaction=n,n.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},n.oncomplete=()=>{this.onComplete()}};va.prototype.onItem=function(t){this._cache.push(t.key,t.value),(this._limit<=0||++this._count<this._limit)&&t.continue(),this.maybeNext()};va.prototype.onAbort=function(t){this._aborted=!0,this._error=t,this.maybeNext()};va.prototype.onComplete=function(){this._completed=!0,this.maybeNext()};va.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)};va.prototype._next=function(t){if(this._aborted){let e=this._error;this._error=null,this._nextTick(t,e)}else if(this._cache.length>0){let e=this._cache.shift(),r=this._cache.shift();this._keys&&e!==void 0?e=this._deserializeKey(e,this._keyAsBuffer):e=void 0,this._values&&r!==void 0?r=this._deserializeValue(r,this._valueAsBuffer):r=void 0,this._nextTick(t,null,e,r)}else this._completed?this._nextTick(t):this._callback=t};va.prototype._deserializeKey=Voe;va.prototype._deserializeValue=Voe;va.prototype._end=function(t){if(this._aborted||this._completed)return this._nextTick(t,this._error);this.onItem=pze,this.onAbort=t,this.onComplete=t}});var Woe=g((M9t,Goe)=>{"use strict";var $oe=On().Buffer,yze=function(){if(globalThis.TextEncoder){let t=new TextEncoder("utf-8");return t.encode.bind(t)}else return $oe.from}();Goe.exports=function(t,e){return e?$oe.isBuffer(t)?t:yze(String(t)):String(t)}});var Yoe=g(b8=>{"use strict";var gze=On().Buffer;b8.test=function(t){return function(r){try{return r.cmp(t,0),!0}catch{return!1}}};b8.bufferKeys=b8.test(gze.alloc(0))});var Qoe=g((q9t,Xoe)=>{"use strict";Xoe.exports=function(e,r,n,i,s){if(i.limit===0)return e._nextTick(s);let o=e.db.transaction([r],"readwrite"),a=o.objectStore(r),c=0;o.oncomplete=function(){s()},o.onabort=function(){s(o.error||new Error("aborted by user"))};let u=a.openKeyCursor?"openKeyCursor":"openCursor",l=i.reverse?"prev":"next";a[u](n,l).onsuccess=function(f){let h=f.target.result;h&&(a.delete(h.key).onsuccess=function(){(i.limit<=0||++c<i.limit)&&h.continue()})}}});var rae=g((F9t,tae)=>{"use strict";tae.exports=Dn;var Zoe=Eu().AbstractLevelDOWN,mze=Us(),wze=Loe(),bze=Hoe(),Joe=Woe(),_8=Wx(),_ze=Yoe(),vze=Qoe(),Eze=Gx(),eae="level-js-";function Dn(t,e){if(!(this instanceof Dn))return new Dn(t,e);if(Zoe.call(this,{bufferKeys:_ze.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0,getMany:!0}),e=e||{},typeof t!="string")throw new Error("constructor requires a location string argument");this.location=t,this.prefix=e.prefix==null?eae:e.prefix,this.version=parseInt(e.version||1,10)}mze(Dn,Zoe);Dn.prototype.type="level-js";Dn.prototype._open=function(t,e){let r=indexedDB.open(this.prefix+this.location,this.version);r.onerror=function(){e(r.error||new Error("unknown error"))},r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=n=>{let i=n.target.result;i.objectStoreNames.contains(this.location)||i.createObjectStore(this.location)}};Dn.prototype.store=function(t){return this.db.transaction([this.location],t).objectStore(this.location)};Dn.prototype.await=function(t,e){let r=t.transaction;r.onabort=function(){e(r.error||new Error("aborted by user"))},r.oncomplete=function(){e(null,t.result)}};Dn.prototype._get=function(t,e,r){let n=this.store("readonly"),i;try{i=n.get(t)}catch(s){return this._nextTick(r,s)}this.await(i,function(s,o){if(s)return r(s);if(o===void 0)return r(new Error("NotFound"));r(null,_8(o,e.asBuffer))})};Dn.prototype._getMany=function(t,e,r){let n=e.asBuffer,i=this.store("readonly"),s=t.map(o=>a=>{let c;try{c=i.get(o)}catch(u){return a(u)}c.onsuccess=()=>{let u=c.result;a(null,u===void 0?u:_8(u,n))},c.onerror=u=>{u.stopPropagation(),a(c.error)}});wze(s,16,r)};Dn.prototype._del=function(t,e,r){let n=this.store("readwrite"),i;try{i=n.delete(t)}catch(s){return this._nextTick(r,s)}this.await(i,r)};Dn.prototype._put=function(t,e,r,n){let i=this.store("readwrite"),s;try{s=i.put(e,t)}catch(o){return this._nextTick(n,o)}this.await(s,n)};Dn.prototype._serializeKey=function(t){return Joe(t,this.supports.bufferKeys)};Dn.prototype._serializeValue=function(t){return Joe(t,!0)};Dn.prototype._iterator=function(t){return new bze(this,this.location,t)};Dn.prototype._batch=function(t,e,r){if(t.length===0)return this._nextTick(r);let n=this.store("readwrite"),i=n.transaction,s=0,o;i.onabort=function(){r(o||i.error||new Error("aborted by user"))},i.oncomplete=function(){r()};function a(){let c=t[s++],u=c.key,l;try{l=c.type==="del"?n.delete(u):n.put(c.value,u)}catch(f){o=f,i.abort();return}s<t.length&&(l.onsuccess=a)}a()};Dn.prototype._clear=function(t,e){let r,n;try{r=Eze(t)}catch{return this._nextTick(e)}if(t.limit>=0)return vze(this,this.location,r,t,e);try{let i=this.store("readwrite");n=r?i.delete(r):i.clear()}catch(i){return this._nextTick(e,i)}this.await(n,e)};Dn.prototype._close=function(t){this.db.close(),this._nextTick(t)};Dn.prototype.upgrade=function(t){if(this.status!=="open")return this._nextTick(t,new Error("cannot upgrade() before open()"));let e=this.iterator(),r={},n=this;e._deserializeKey=e._deserializeValue=a,i();function i(c){if(c)return o(c);e.next(s)}function s(c,u,l){if(c||u===void 0)return o(c);let f=n._serializeKey(_8(u,!0)),h=n._serializeValue(_8(l,!0));n._batch([{type:"del",key:u},{type:"put",key:f,value:h}],r,i)}function o(c){e.end(function(u){t(c||u)})}function a(c){return c}};Dn.destroy=function(t,e,r){typeof e=="function"&&(r=e,e=eae);let n=indexedDB.deleteDatabase(e+t);n.onsuccess=function(){r()},n.onerror=function(i){r(i)}}});var iae=g((K9t,nae)=>{nae.exports=Noe()(rae())});function Sze(t){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,r)=>{t.next((n,i,s)=>{if(n)return r(n);if(i==null)return t.end(o=>{if(o)return r(o);e({done:!0,value:void 0})});e({done:!1,value:{key:new Oe(i,!1),value:s}})})}),return:()=>new Promise((e,r)=>{t.end(n=>{if(n)return r(n);e({done:!0,value:void 0})})})}}}}var Fm,sae,Yx,Xx,oae,gd,aae=w(()=>{y0();S5();Fm=A(fs(),1),sae=A(xi(),1),Yx=A(_h(),1),Xx=A(IT(),1),oae=A(iae(),1),gd=class extends pi{constructor(e,r){super();this.path=e,this.opts=r,r&&r.db?(this.database=r.db,delete r.db):this.database=oae.default}_initDb(){return new Promise((e,r)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},n=>{if(n)return r(n);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw Ah.dbOpenFailedError(e)}}async put(e,r){try{await this.db.put(e.toString(),r)}catch(n){throw Ah.dbWriteFailedError(n)}}async get(e){let r;try{r=await this.db.get(e.toString())}catch(n){throw n.notFound?Ah.notFoundError(n):Ah.dbWriteFailedError(n)}return r}async has(e){try{await this.db.get(e.toString())}catch(r){if(r.notFound)return!1;throw r}return!0}async delete(e){try{await this.db.del(e.toString())}catch(r){throw Ah.dbDeleteFailedError(r)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(r,n)=>{e.push({type:"put",key:r.toString(),value:n})},delete:r=>{e.push({type:"del",key:r.toString()})},commit:()=>this.db.batch(e)}}query(e){let r=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(r=e.filters.reduce((s,o)=>(0,Fm.default)(s,o),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((s,o)=>(0,Xx.default)(s,o),r));let{offset:n,limit:i}=e;if(n){let s=0;r=(0,Fm.default)(r,()=>s++>=n)}return i&&(r=(0,Yx.default)(r,i)),r}queryKeys(e){let r=(0,sae.default)(this._query({values:!1,prefix:e.prefix}),({key:s})=>s);Array.isArray(e.filters)&&(r=e.filters.reduce((s,o)=>(0,Fm.default)(s,o),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((s,o)=>(0,Xx.default)(s,o),r));let{offset:n,limit:i}=e;if(n){let s=0;r=(0,Fm.default)(r,()=>s++>=n)}return i&&(r=(0,Yx.default)(r,i)),r}_query(e){let r={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let n=e.prefix.toString();r.gte=n,r.lt=n+"\xFF"}return Sze(this.db.iterator(r))}}});var Qx,md,Zx,uae,cae,Ru,Km=w(()=>{Qx=A(ls(),1),md=A(fs(),1),Zx=A(_h(),1),uae=A(yo(),1),cae=(t,e)=>async function*(){yield*(await(0,uae.default)(t)).sort(e)}(),Ru=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,n){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:n,value:i}of e)await this.put(n,i,r),yield{key:n,value:i}}async*getMany(e,r={}){for await(let n of e)yield this.get(n,r)}async*deleteMany(e,r={}){for await(let n of e)await this.delete(n,r),yield n}batch(){let e=[],r=[];return{put(n,i){e.push({key:n,value:i})},delete(n){r.push(n)},commit:async n=>{await(0,Qx.default)(this.putMany(e,n)),e=[],await(0,Qx.default)(this.deleteMany(r,n)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let n=this._all(e,r);if(e.prefix!=null&&(n=(0,md.default)(n,i=>i.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,s)=>(0,md.default)(i,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,s)=>cae(i,s),n)),e.offset!=null){let i=0;n=(0,md.default)(n,()=>i++>=(e.offset||0))}return e.limit!=null&&(n=(0,Zx.default)(n,e.limit)),n}queryKeys(e,r){let n=this._allKeys(e,r);if(e.prefix!=null&&(n=(0,md.default)(n,i=>i.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,s)=>(0,md.default)(i,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,s)=>cae(i,s),n)),e.offset!=null){let i=0;n=(0,md.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,Zx.default)(n,e.limit)),n}}});function O1(t){let e=L.asCID(t);if(!e)throw(0,lae.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return new Oe("/"+gr.encode(e.multihash.bytes).slice(1).toUpperCase(),!1)}function ff(t){return L.createV1(ei,mn(gr.decode("b"+t.toString().slice(1).toLowerCase())))}function tP(t){let e=t.substring(0,1);if(e==="/")return tP(t.substring(1));let r;e.toLowerCase()==="b"?r=s=>gr.decode(s.toLowerCase()).subarray(2):e.toLowerCase()==="c"?r=s=>F7.decode(s.toLowerCase()).subarray(2):e==="z"?r=s=>bt.decode(s).subarray(2):e==="Q"?r=s=>bt.decode("z"+s):r=s=>gr.decode("b"+s.toLowerCase()).subarray(2);let n;for(let s=1;s<t.length;s++)try{n=r(t.substring(0,s))}catch(o){if(o.message!=="Unexpected end of data")throw o}let i="/C";return n&&(i=`/${gr.encode(n).slice(1,-1).toUpperCase()||"C"}`),i}function Aze(t){return{...t,prefix:t.prefix?tP(t.prefix):void 0,filters:t.filters?t.filters.map(e=>r=>e({key:ff(r.key),value:r.value})):void 0,orders:t.orders?t.orders.map(e=>(r,n)=>e({key:ff(r.key),value:r.value},{key:ff(n.key),value:n.value})):void 0}}function Rze(t){return{...t,prefix:t.prefix?tP(t.prefix):void 0,filters:t.filters?t.filters.map(e=>r=>e(ff(r))):void 0,orders:t.orders?t.orders.map(e=>(r,n)=>e(ff(r),ff(n))):void 0}}var Jx,eP,lae,rP,fae=w(()=>{Jx=A(ls(),1),eP=A(ac(),1);Vr();Se();eo();li();fi();wn();lae=A(oe(),1);Km();rP=class extends Ru{constructor(e){super();this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,r){for await(let{key:n,value:i}of this.child.query(Aze(e),r))yield{key:ff(n),value:i}}async*queryKeys(e,r){for await(let n of this.child.queryKeys(Rze(e),r))yield ff(n)}async get(e,r){return this.child.get(O1(e),r)}async*getMany(e,r){for await(let n of e)yield this.get(n,r)}async put(e,r,n){await this.child.put(O1(e),r,n)}async*putMany(e,r){let n=(0,eP.default)();(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{let s=this.child;await(0,Jx.default)(this.child.putMany(async function*(){for await(let o of e){let a=O1(o.key);await s.has(a,r)||(yield{key:a,value:o.value}),n.push(o)}}())),n.end()}catch(s){n.end(s)}}),yield*n}has(e,r){return this.child.has(O1(e),r)}delete(e,r){return this.child.delete(O1(e),r)}deleteMany(e,r){let n=(0,eP.default)();return(0,Jx.default)(this.child.deleteMany(async function*(){for await(let i of e)yield O1(i),n.push(i);n.end()}(),r)).catch(i=>{n.end(i)}),n}}});function hae(t,e,r){let n=r.path||"ipfs";return Sne(n,i=>e.getCodec(i),{root:new gd(n,{prefix:"",version:2}),blocks:new rP(new gd(`${n}/blocks`,{prefix:"",version:2})),datastore:new gd(`${n}/datastore`,{prefix:"",version:2}),keys:new gd(`${n}/keys`,{prefix:"",version:2}),pins:new gd(`${n}/pins`,{prefix:"",version:2})},{autoMigrate:r.autoMigrate,onMigrationProgress:r.onMigrationProgress||t,repoLock:Sb})}var dae=w(()=>{Ane();aae();fae();wT()});var nP=g((nSt,mae)=>{"use strict";var pae=()=>{},yae=Symbol.for("@libp2p/js-interfaces/topology"),gae=class{constructor({min:e=0,max:r=1/0,handlers:n={}}){this.min=e,this.max=r,this._onConnect=n.onConnect||pae,this._onDisconnect=n.onDisconnect||pae,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[yae](){return!0}static isTopology(e){return Boolean(e&&e[yae])}async setRegistrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};mae.exports=gae});var v8=g((iSt,Eae)=>{"use strict";var Ize=nP(),wae=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),bae=he(),_ae=Object.assign(bae("libp2p:topology:multicodec-topology"),{error:bae("libp2p:topology:multicodec-topology:error")}),vae=class extends Ize{constructor({min:e,max:r,multicodecs:n,handlers:i}){super({min:e,max:r,handlers:i});if(!n)throw new Error("one or more multicodec should be provided");if(!i)throw new Error("the handlers should be provided");if(typeof i.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof i.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(n)?n:[n],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[wae](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[wae])}async setRegistrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),await this._updatePeers(this._registrar.peerStore.getPeers())}async _updatePeers(e){for await(let{id:r,protocols:n}of e)if(this.multicodecs.filter(i=>n.includes(i)).length){this.peers.add(r.toB58String());let i=this._registrar.getConnection(r);i&&this._onConnect(r,i)}else this.peers.delete(r.toB58String())}async _onProtocolChange({peerId:e,protocols:r}){try{let n=this.peers.has(e.toB58String()),i=r.filter(s=>this.multicodecs.includes(s));n&&i.length===0&&this._onDisconnect(e);for(let s of r)if(this.multicodecs.includes(s)){let o=await this._registrar.peerStore.get(e);await this._updatePeers([o]);return}}catch(n){_ae.error(n)}}async _onPeerConnect(e){try{let r=e.remotePeer,n=await this._registrar.peerStore.protoBook.get(r);if(!n)return;this.multicodecs.find(i=>n.includes(i))&&(this.peers.add(r.toB58String()),this._onConnect(r,e))}catch(r){_ae.error(r)}}};Eae.exports=vae});var E8=g(Sae=>{"use strict";Sae.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var sP=g((oSt,Aae)=>{"use strict";var hf=Kr(),k1=hf.Reader,iP=hf.Writer,Nt=hf.util,Hn=hf.roots["libp2p-pubsub-rpc"]||(hf.roots["libp2p-pubsub-rpc"]={});Hn.RPC=function(){function t(e){if(this.subscriptions=[],this.msgs=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.subscriptions=Nt.emptyArray,t.prototype.msgs=Nt.emptyArray,t.encode=function(r,n){if(n||(n=iP.create()),r.subscriptions!=null&&r.subscriptions.length)for(var i=0;i<r.subscriptions.length;++i)Hn.RPC.SubOpts.encode(r.subscriptions[i],n.uint32(10).fork()).ldelim();if(r.msgs!=null&&r.msgs.length)for(var i=0;i<r.msgs.length;++i)Hn.RPC.Message.encode(r.msgs[i],n.uint32(18).fork()).ldelim();return n},t.decode=function(r,n){r instanceof k1||(r=k1.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Hn.RPC;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(Hn.RPC.SubOpts.decode(r,r.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(Hn.RPC.Message.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Hn.RPC)return r;var n=new Hn.RPC;if(r.subscriptions){if(!Array.isArray(r.subscriptions))throw TypeError(".RPC.subscriptions: array expected");n.subscriptions=[];for(var i=0;i<r.subscriptions.length;++i){if(typeof r.subscriptions[i]!="object")throw TypeError(".RPC.subscriptions: object expected");n.subscriptions[i]=Hn.RPC.SubOpts.fromObject(r.subscriptions[i])}}if(r.msgs){if(!Array.isArray(r.msgs))throw TypeError(".RPC.msgs: array expected");n.msgs=[];for(var i=0;i<r.msgs.length;++i){if(typeof r.msgs[i]!="object")throw TypeError(".RPC.msgs: object expected");n.msgs[i]=Hn.RPC.Message.fromObject(r.msgs[i])}}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.subscriptions=[],i.msgs=[]),r.subscriptions&&r.subscriptions.length){i.subscriptions=[];for(var s=0;s<r.subscriptions.length;++s)i.subscriptions[s]=Hn.RPC.SubOpts.toObject(r.subscriptions[s],n)}if(r.msgs&&r.msgs.length){i.msgs=[];for(var s=0;s<r.msgs.length;++s)i.msgs[s]=Hn.RPC.Message.toObject(r.msgs[s],n)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,hf.util.toJSONOptions)},t.SubOpts=function(){function e(n){if(n)for(var i=Object.keys(n),s=0;s<i.length;++s)n[i[s]]!=null&&(this[i[s]]=n[i[s]])}e.prototype.subscribe=null,e.prototype.topicID=null;var r;return Object.defineProperty(e.prototype,"_subscribe",{get:Nt.oneOfGetter(r=["subscribe"]),set:Nt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_topicID",{get:Nt.oneOfGetter(r=["topicID"]),set:Nt.oneOfSetter(r)}),e.encode=function(i,s){return s||(s=iP.create()),i.subscribe!=null&&Object.hasOwnProperty.call(i,"subscribe")&&s.uint32(8).bool(i.subscribe),i.topicID!=null&&Object.hasOwnProperty.call(i,"topicID")&&s.uint32(18).string(i.topicID),s},e.decode=function(i,s){i instanceof k1||(i=k1.create(i));for(var o=s===void 0?i.len:i.pos+s,a=new Hn.RPC.SubOpts;i.pos<o;){var c=i.uint32();switch(c>>>3){case 1:a.subscribe=i.bool();break;case 2:a.topicID=i.string();break;default:i.skipType(c&7);break}}return a},e.fromObject=function(i){if(i instanceof Hn.RPC.SubOpts)return i;var s=new Hn.RPC.SubOpts;return i.subscribe!=null&&(s.subscribe=Boolean(i.subscribe)),i.topicID!=null&&(s.topicID=String(i.topicID)),s},e.toObject=function(i,s){s||(s={});var o={};return i.subscribe!=null&&i.hasOwnProperty("subscribe")&&(o.subscribe=i.subscribe,s.oneofs&&(o._subscribe="subscribe")),i.topicID!=null&&i.hasOwnProperty("topicID")&&(o.topicID=i.topicID,s.oneofs&&(o._topicID="topicID")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,hf.util.toJSONOptions)},e}(),t.Message=function(){function e(n){if(this.topicIDs=[],n)for(var i=Object.keys(n),s=0;s<i.length;++s)n[i[s]]!=null&&(this[i[s]]=n[i[s]])}e.prototype.from=null,e.prototype.data=null,e.prototype.seqno=null,e.prototype.topicIDs=Nt.emptyArray,e.prototype.signature=null,e.prototype.key=null;var r;return Object.defineProperty(e.prototype,"_from",{get:Nt.oneOfGetter(r=["from"]),set:Nt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_data",{get:Nt.oneOfGetter(r=["data"]),set:Nt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_seqno",{get:Nt.oneOfGetter(r=["seqno"]),set:Nt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_signature",{get:Nt.oneOfGetter(r=["signature"]),set:Nt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_key",{get:Nt.oneOfGetter(r=["key"]),set:Nt.oneOfSetter(r)}),e.encode=function(i,s){if(s||(s=iP.create()),i.from!=null&&Object.hasOwnProperty.call(i,"from")&&s.uint32(10).bytes(i.from),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&s.uint32(18).bytes(i.data),i.seqno!=null&&Object.hasOwnProperty.call(i,"seqno")&&s.uint32(26).bytes(i.seqno),i.topicIDs!=null&&i.topicIDs.length)for(var o=0;o<i.topicIDs.length;++o)s.uint32(34).string(i.topicIDs[o]);return i.signature!=null&&Object.hasOwnProperty.call(i,"signature")&&s.uint32(42).bytes(i.signature),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&s.uint32(50).bytes(i.key),s},e.decode=function(i,s){i instanceof k1||(i=k1.create(i));for(var o=s===void 0?i.len:i.pos+s,a=new Hn.RPC.Message;i.pos<o;){var c=i.uint32();switch(c>>>3){case 1:a.from=i.bytes();break;case 2:a.data=i.bytes();break;case 3:a.seqno=i.bytes();break;case 4:a.topicIDs&&a.topicIDs.length||(a.topicIDs=[]),a.topicIDs.push(i.string());break;case 5:a.signature=i.bytes();break;case 6:a.key=i.bytes();break;default:i.skipType(c&7);break}}return a},e.fromObject=function(i){if(i instanceof Hn.RPC.Message)return i;var s=new Hn.RPC.Message;if(i.from!=null&&(typeof i.from=="string"?Nt.base64.decode(i.from,s.from=Nt.newBuffer(Nt.base64.length(i.from)),0):i.from.length&&(s.from=i.from)),i.data!=null&&(typeof i.data=="string"?Nt.base64.decode(i.data,s.data=Nt.newBuffer(Nt.base64.length(i.data)),0):i.data.length&&(s.data=i.data)),i.seqno!=null&&(typeof i.seqno=="string"?Nt.base64.decode(i.seqno,s.seqno=Nt.newBuffer(Nt.base64.length(i.seqno)),0):i.seqno.length&&(s.seqno=i.seqno)),i.topicIDs){if(!Array.isArray(i.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");s.topicIDs=[];for(var o=0;o<i.topicIDs.length;++o)s.topicIDs[o]=String(i.topicIDs[o])}return i.signature!=null&&(typeof i.signature=="string"?Nt.base64.decode(i.signature,s.signature=Nt.newBuffer(Nt.base64.length(i.signature)),0):i.signature.length&&(s.signature=i.signature)),i.key!=null&&(typeof i.key=="string"?Nt.base64.decode(i.key,s.key=Nt.newBuffer(Nt.base64.length(i.key)),0):i.key.length&&(s.key=i.key)),s},e.toObject=function(i,s){s||(s={});var o={};if((s.arrays||s.defaults)&&(o.topicIDs=[]),i.from!=null&&i.hasOwnProperty("from")&&(o.from=s.bytes===String?Nt.base64.encode(i.from,0,i.from.length):s.bytes===Array?Array.prototype.slice.call(i.from):i.from,s.oneofs&&(o._from="from")),i.data!=null&&i.hasOwnProperty("data")&&(o.data=s.bytes===String?Nt.base64.encode(i.data,0,i.data.length):s.bytes===Array?Array.prototype.slice.call(i.data):i.data,s.oneofs&&(o._data="data")),i.seqno!=null&&i.hasOwnProperty("seqno")&&(o.seqno=s.bytes===String?Nt.base64.encode(i.seqno,0,i.seqno.length):s.bytes===Array?Array.prototype.slice.call(i.seqno):i.seqno,s.oneofs&&(o._seqno="seqno")),i.topicIDs&&i.topicIDs.length){o.topicIDs=[];for(var a=0;a<i.topicIDs.length;++a)o.topicIDs[a]=i.topicIDs[a]}return i.signature!=null&&i.hasOwnProperty("signature")&&(o.signature=s.bytes===String?Nt.base64.encode(i.signature,0,i.signature.length):s.bytes===Array?Array.prototype.slice.call(i.signature):i.signature,s.oneofs&&(o._signature="signature")),i.key!=null&&i.hasOwnProperty("key")&&(o.key=s.bytes===String?Nt.base64.encode(i.key,0,i.key.length):s.bytes===Array?Array.prototype.slice.call(i.key):i.key,s.oneofs&&(o._key="key")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,hf.util.toJSONOptions)},e}(),t}();Aae.exports=Hn});var oP=g((aSt,Tae)=>{"use strict";var Rae=ns(),{Buffer:Tze}=On(),Iae=(t,e,r)=>{let n=Rae.encode(t,e,r);return Iae.bytes=Rae.encode.bytes,e||Tze.from(n)};Tae.exports=Iae});var Dae=g((cSt,S8)=>{"use strict";var{Buffer:xae}=On(),Pae=yi(),Cae=oP(),aP=8,Oae=10*1024;function kae(t){t=t||{};let e=Math.max(t.poolSize||Oae,t.minPoolSize||aP),r=t.lengthEncoder||Cae;return async function*(i){let s=xae.alloc(e),o=0;for await(let a of i){r(a.length,s,o);let c=s.slice(o,o+r.bytes);o+=r.bytes,s.length-o<aP&&(s=xae.alloc(e),o=0),yield new Pae().append(c).append(a)}}}kae.single=(t,e)=>{e=e||{};let r=e.lengthEncoder||Cae;return new Pae([r(t.length),t.slice()])};S8.exports=kae;S8.exports.MIN_POOL_SIZE=aP;S8.exports.DEFAULT_POOL_SIZE=Oae});var cP=g((uSt,Lae)=>{"use strict";var Nae=ns(),{Buffer:xze}=On(),Pze=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),Bae=t=>{let e=Nae.decode(xze.isBuffer(t)?t:Pze(t));return Bae.bytes=Nae.decode.bytes,e};Lae.exports=Bae});var Fae=g((lSt,A8)=>{"use strict";var{Buffer:Cze}=On(),uP=yi(),Oze=cP(),Uae=8,qae=1024*1024*4,Mae=Cze.alloc(0),df={LENGTH:"readLength",DATA:"readData"},kze={[df.LENGTH]:(t,e,r,n)=>{e=e.append(t);let i;try{i=n.lengthDecoder(e)}catch(s){if(e.length>n.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:df.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(i>n.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(n.lengthDecoder.bytes),e=new uP,n.onLength&&n.onLength(i),i<=0?(n.onData&&n.onData(Mae),{mode:df.LENGTH,chunk:t,buffer:e,data:Mae}):{mode:df.DATA,chunk:t,buffer:e,state:{dataLength:i},data:void 0}},[df.DATA]:(t,e,r,n)=>{if(e=e.append(t),!r)throw new Error("state is required");if(e.length<r.dataLength)return{mode:df.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:i}=r,s=e.shallowSlice(0,i),o=e.length>i?e.shallowSlice(i):void 0;return e=new uP,n.onData&&n.onData(s),{mode:df.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function lP(t){t=t||{};let e={lengthDecoder:t.lengthDecoder||Oze,maxLengthLength:t.maxLengthLength||Uae,maxDataLength:t.maxDataLength||qae,onLength:t.onLength,onData:t.onData};return async function*(n){let i=new uP,s=df.LENGTH,o;for await(let a of n){let c=a;for(;c;){let u=kze[s](c,i,o,e);s=u.mode,c=u.chunk,i=u.buffer,o=u.state,u.data&&(yield u.data)}}if(i.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}lP.fromReader=(t,e)=>{let r=1,n={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}};return lP({...e||{},onLength:s=>{r=s}})(n)};A8.exports=lP;A8.exports.MAX_LENGTH_LENGTH=Uae;A8.exports.MAX_DATA_LENGTH=qae});var Vae=g((fSt,jae)=>{"use strict";var{Buffer:Dze}=On(),Kae=(t,e,r)=>(e=e||Dze.allocUnsafe(4),e.writeInt32BE(t,r),e);Kae.bytes=4;jae.exports=Kae});var $ae=g((hSt,Hae)=>{"use strict";var zae=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};zae.bytes=4;Hae.exports=zae});var xo=g(wd=>{"use strict";wd.encode=Dae();wd.decode=Fae();wd.varintEncode=oP();wd.varintDecode=cP();wd.int32BEEncode=Vae();wd.int32BEDecode=$ae()});var R8=g((pSt,Gae)=>{Gae.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var Yae=g((gSt,Wae)=>{Wae.exports=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}}});var Ea=g((mSt,bd)=>{var Nze=R8(),fP=Yae(),Xae=(t,e,r)=>hP(t,Array.isArray(e)?e:[{signal:e,options:r}]),hP=(t,e)=>{t=Nze(t),e=e.map(({signal:n,options:i})=>({signal:n,options:i||{}}));async function*r(){let n,i=()=>{n&&n()};for(let{signal:s}of e)s.addEventListener("abort",i);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:u,abortCode:l}=c;throw new fP(u,l)}let o=new Promise((a,c)=>{n=()=>{let{options:u}=e.find(({signal:h})=>h.aborted),{abortMessage:l,abortCode:f}=u;c(new fP(l,f))}});s=await Promise.race([o,t.next()]),n=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",i);let a=e.find(({signal:u})=>u.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(t),typeof t.return=="function")try{let u=t.return();u instanceof Promise&&u.catch(l=>{a.options.onReturnError!=null&&a.options.onReturnError(l)})}catch(u){a.options.onReturnError!=null&&a.options.onReturnError(u)}if(c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",i)}return r()},Qae=(t,e,r)=>Zae(t,Array.isArray(e)?e:[{signal:e,options:r}]),Zae=(t,e)=>r=>t(hP(r,e)),Bze=(t,e,r)=>Lze(t,Array.isArray(e)?e:[{signal:e,options:r}]),Lze=(t,e)=>({sink:Zae(t.sink,e),source:hP(t.source,e)});bd.exports=Xae;bd.exports.AbortError=fP;bd.exports.source=Xae;bd.exports.sink=Qae;bd.exports.transform=Qae;bd.exports.duplex=Bze});var ice=g((wSt,nce)=>{"use strict";var Jae=he(),Mze=Object.assign(Jae("libp2p-pubsub:peer-streams"),{error:Jae("libp2p-pubsub:peer-streams:err")}),{EventEmitter:Uze}=Gt(),ece=xo(),qze=ac(),{pipe:tce}=br(),{source:Fze}=Ea(),rce=class extends Uze{constructor({id:e,protocol:r}){super();this.id=e,this.protocol=r,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new AbortController,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let r=this.id.toB58String();throw new Error("No writable connection to "+r)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=Fze(tce(this._rawInboundStream,ece.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let r=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=qze({onEnd:n=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,n&&this.emit("close")}}),tce(this.outboundStream,ece.encode(),this._rawOutboundStream).catch(n=>{Mze.error(n)}),r||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};nce.exports=rce});var oce=g(sce=>{"use strict";var Kze={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};sce.SignaturePolicy=Kze});var dP=g((_St,uce)=>{"use strict";var jze=M2(),{toString:Vze}=(st(),se(hr)),{fromString:ace}=(dt(),se(nn)),cce=ft(),{sha256:zze}=(Tn(),se(Js)),Hze=()=>jze(8),$ze=(t,e)=>{let r;t instanceof Uint8Array?r=cce.createFromBytes(t).id:r=cce.parse(t).id;let n=new Uint8Array(r.length+e.length);return n.set(r,0),n.set(e,r.length),n},Gze=t=>zze.encode(t),Wze=(t,e)=>{let r;Array.isArray(e)?r=n=>e.indexOf(n)>-1:r=n=>e.has(n);for(let n of t)if(r(n))return!0;return!1},Yze=t=>Array.isArray(t)?t:[t],Xze=(t,e)=>{let r=Object.assign({},t);return t.from instanceof Uint8Array&&(r.from=Vze(t.from,"base58btc")),e&&(r.receivedFrom=e),r},Qze=t=>{let e=Object.assign({},t);return typeof t.from=="string"&&(e.from=ace(t.from,"base58btc")),typeof t.data=="string"&&(e.data=ace(t.data)),e};uce.exports={randomSeqno:Hze,msgId:$ze,noSignMsgId:Gze,anyMatch:Wze,ensureArray:Yze,normalizeInRpcMessage:Xze,normalizeOutRpcMessage:Qze}});var pce=g((vSt,dce)=>{"use strict";var pP=ft(),{RPC:lce}=sP(),{concat:fce}=(Pn(),se(Ui)),{fromString:Zze}=(dt(),se(nn)),yP=Zze("libp2p-pubsub:"),{normalizeOutRpcMessage:Jze}=dP();async function eHe(t,e){let r=fce([yP,lce.Message.encode(Jze(e)).finish()]),n=await t.privKey.sign(r);return{...e,signature:n,key:t.pubKey.bytes}}async function tHe(t){if(!t.signature)throw new Error("Message must contain a signature to be verified");if(!t.from)throw new Error("Message must contain a from property to be verified");let e=fce([yP,lce.Message.encode({...t,from:pP.createFromB58String(t.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await hce(t)).verify(e,t.signature)}async function hce(t){if(!t.from)throw new Error("Could not get the public key from the originator id");let e=pP.createFromB58String(t.from);if(t.key){let r=await pP.createFromPubKey(t.key);if(r.equals(e))return r.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}dce.exports={messagePublicKey:hce,signMessage:eHe,SignPrefix:yP,verifySignature:tHe}});var wce=g((ESt,mce)=>{"use strict";var yce=he(),{EventEmitter:rHe}=Gt(),gs=oe(),{pipe:nHe}=br(),{default:iHe}=ia(),sHe=v8(),{codes:Sa}=E8(),{RPC:gce}=sP(),oHe=ice(),{SignaturePolicy:Iu}=oce(),pf=dP(),{signMessage:aHe,verifySignature:cHe}=pce(),I8=class extends rHe{constructor({debugName:e,multicodecs:r,libp2p:n,globalThisSignaturePolicy:i=Iu.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1,messageProcessingConcurrency:a=10}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!r)throw new Error("multicodecs are required");if(!n)throw new Error("libp2p is required");super();if(this.log=Object.assign(yce(e),{err:yce(`${e}:error`)}),this.multicodecs=pf.ensureArray(r),this._libp2p=n,this.registrar=n.registrar,this.peerId=n.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!Iu[i])throw gs(new Error("Invalid globalThis signature policy"),Sa.ERR_INVALID_SIGNATURE_POLICY);this.globalThisSignaturePolicy=i,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this.queue=new iHe({concurrency:a}),this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}async start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new sHe({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=await this.registrar.register(e),this.log("started"),this.started=!0}async stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:r,connection:n}){let i=n.remotePeer,s=i.toB58String(),o=this._addPeer(i,e),a=o.attachInboundStream(r);this._processMessages(s,a,o)}async _onPeerConnected(e,r){let n=e.toB58String();this.log("connected",n);try{let{stream:i,protocol:s}=await r.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(i)}catch(i){this.log.err(i)}this._sendSubscriptions(n,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,r){let n=e.toB58String();this.log("connection ended",n,r?r.message:""),this._removePeer(e)}_addPeer(e,r){let n=e.toB58String(),i=this.peers.get(n);if(i)return i;this.log("new peer",n);let s=new oHe({id:e,protocol:r});return this.peers.set(n,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let r=e.toB58String(),n=this.peers.get(r);if(!!n){n.removeAllListeners(),n.close(),this.log("delete peer",r),this.peers.delete(r);for(let i of this.topics.values())i.delete(r);return n}}async _processMessages(e,r,n){try{await nHe(r,async i=>{for await(let s of i){let o=s instanceof Uint8Array?s:s.slice(),a=this._decodeRpc(o);(async()=>{try{await this._processRpc(e,n,a)}catch(c){this.log.err(c)}})()}})}catch(i){this._onPeerDisconnected(n.id,i)}}async _processRpc(e,r,n){this.log("rpc from",e);let i=n.subscriptions,s=n.msgs;return i.length&&(i.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",r.id,i)),this._acceptFrom(e)?(s.length&&this.queue.addAll(s.map(o=>async()=>{if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(a=>this.subscriptions.has(a)))){this.log("received message we didn't subscribe to. Dropping.");return}try{let a=pf.normalizeInRpcMessage(o,e);await this._processRpcMessage(a)}catch(a){this.log.err(a)}})),!0):(this.log("received message from unacceptable peer %s",e),!1)}_processRpcSubOpt(e,r){let n=r.topicID;if(!n)return;let i=this.topics.get(n);i||(i=new Set,this.topics.set(n,i)),r.subscribe?i.add(e):i.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(r){this.log("Message is invalid, dropping it. %O",r);return}return this._emitMessage(e),this._publish(pf.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(r=>{this.subscriptions.has(r)&&this.emit(r,e)})}getMsgId(e){let r=this.globalThisSignaturePolicy;switch(r){case Iu.StrictSign:return pf.msgId(e.from,e.seqno);case Iu.StrictNoSign:return pf.noSignMsgId(e.data);default:throw gs(new Error("Cannot get message id: unhandled signature policy: "+r),Sa.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return gce.decode(e)}_encodeRpc(e){return gce.encode(e).finish()}_sendRpc(e,r){let n=this.peers.get(e);if(!n||!n.isWritable){let i=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(i);return}n.write(this._encodeRpc(r))}_sendSubscriptions(e,r,n){return this._sendRpc(e,{subscriptions:r.map(i=>({topicID:i,subscribe:n}))})}async validate(e){let r=this.globalThisSignaturePolicy;switch(r){case Iu.StrictNoSign:if(e.from)throw gs(new Error("StrictNoSigning: from should not be present"),Sa.ERR_UNEXPECTED_FROM);if(e.signature)throw gs(new Error("StrictNoSigning: signature should not be present"),Sa.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw gs(new Error("StrictNoSigning: key should not be present"),Sa.ERR_UNEXPECTED_KEY);if(e.seqno)throw gs(new Error("StrictNoSigning: seqno should not be present"),Sa.ERR_UNEXPECTED_SEQNO);break;case Iu.StrictSign:if(!e.signature)throw gs(new Error("StrictSigning: Signing required and no signature was present"),Sa.ERR_MISSING_SIGNATURE);if(!e.seqno)throw gs(new Error("StrictSigning: Signing required and no seqno was present"),Sa.ERR_MISSING_SEQNO);if(!await cHe(e))throw gs(new Error("StrictSigning: Invalid message signature"),Sa.ERR_INVALID_SIGNATURE);break;default:throw gs(new Error("Cannot validate message: unhandled signature policy: "+r),Sa.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let n of e.topicIDs){let i=this.topicValidators.get(n);i&&await i(n,e)}}_buildMessage(e){let r=this.globalThisSignaturePolicy;switch(r){case Iu.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=pf.randomSeqno(),aHe(this.peerId,e);case Iu.StrictNoSign:return Promise.resolve(e);default:throw gs(new Error("Cannot build message: unhandled signature policy: "+r),Sa.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw gs(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw gs(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let r=this.topics.get(e);return r?Array.from(r):[]}async publish(e,r){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,r);let i={receivedFrom:this.peerId.toB58String(),data:r,topicIDs:[e]},s=await this._buildMessage(i),o=pf.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw gs(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((r,n)=>this._sendSubscriptions(n,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((r,n)=>this._sendSubscriptions(n,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};I8.utils=pf;I8.SignaturePolicy=Iu;mce.exports=I8});var bce=g(T8=>{"use strict";Object.defineProperty(T8,"__esModule",{value:!0});T8.createGossipRpc=void 0;function uHe(t=[],e={}){return{subscriptions:[],msgs:t,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}T8.createGossipRpc=uHe});var _ce=g(x8=>{"use strict";Object.defineProperty(x8,"__esModule",{value:!0});x8.shuffle=void 0;function lHe(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let n=e(),i=t[r];t[r]=t[n],t[n]=i}return t}x8.shuffle=lHe});var yf=g(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.ACCEPT_FROM_WHITELIST_DURATION_MS=Ae.ACCEPT_FROM_WHITELIST_MAX_MESSAGES=Ae.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=Ae.ERR_TOPIC_VALIDATOR_IGNORE=Ae.ERR_TOPIC_VALIDATOR_REJECT=Ae.TimeCacheDuration=Ae.GossipsubSeenTTL=Ae.GossipsubIWantFollowupTime=Ae.GossipsubMaxIHaveMessages=Ae.GossipsubMaxIHaveLength=Ae.GossipsubGraftFloodThreshold=Ae.GossipsubOpportunisticGraftPeers=Ae.GossipsubOpportunisticGraftTicks=Ae.GossipsubDirectConnectInitialDelay=Ae.GossipsubDirectConnectTicks=Ae.GossipsubConnectionTimeout=Ae.GossipsubMaxPendingConnections=Ae.GossipsubConnectors=Ae.GossipsubPruneBackoffTicks=Ae.GossipsubPruneBackoff=Ae.GossipsubPrunePeers=Ae.GossipsubFanoutTTL=Ae.GossipsubHeartbeatInterval=Ae.GossipsubHeartbeatInitialDelay=Ae.GossipsubGossipRetransmission=Ae.GossipsubGossipFactor=Ae.GossipsubDlazy=Ae.GossipsubHistoryGossip=Ae.GossipsubHistoryLength=Ae.GossipsubDout=Ae.GossipsubDscore=Ae.GossipsubDhi=Ae.GossipsubDlo=Ae.GossipsubD=Ae.GossipsubIDv11=Ae.GossipsubIDv10=Ae.FloodsubID=Ae.minute=Ae.second=void 0;Ae.second=1e3;Ae.minute=60*Ae.second;Ae.FloodsubID="/floodsub/1.0.0";Ae.GossipsubIDv10="/meshsub/1.0.0";Ae.GossipsubIDv11="/meshsub/1.1.0";Ae.GossipsubD=6;Ae.GossipsubDlo=4;Ae.GossipsubDhi=12;Ae.GossipsubDscore=4;Ae.GossipsubDout=2;Ae.GossipsubHistoryLength=5;Ae.GossipsubHistoryGossip=3;Ae.GossipsubDlazy=6;Ae.GossipsubGossipFactor=.25;Ae.GossipsubGossipRetransmission=3;Ae.GossipsubHeartbeatInitialDelay=100;Ae.GossipsubHeartbeatInterval=Ae.second;Ae.GossipsubFanoutTTL=Ae.minute;Ae.GossipsubPrunePeers=16;Ae.GossipsubPruneBackoff=Ae.minute;Ae.GossipsubPruneBackoffTicks=15;Ae.GossipsubConnectors=8;Ae.GossipsubMaxPendingConnections=128;Ae.GossipsubConnectionTimeout=30*Ae.second;Ae.GossipsubDirectConnectTicks=300;Ae.GossipsubDirectConnectInitialDelay=Ae.second;Ae.GossipsubOpportunisticGraftTicks=60;Ae.GossipsubOpportunisticGraftPeers=2;Ae.GossipsubGraftFloodThreshold=10*Ae.second;Ae.GossipsubMaxIHaveLength=5e3;Ae.GossipsubMaxIHaveMessages=10;Ae.GossipsubIWantFollowupTime=3*Ae.second;Ae.GossipsubSeenTTL=30*Ae.second;Ae.TimeCacheDuration=120*1e3;Ae.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";Ae.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE";Ae.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=0;Ae.ACCEPT_FROM_WHITELIST_MAX_MESSAGES=128;Ae.ACCEPT_FROM_WHITELIST_DURATION_MS=1e3});var Ece=g(P8=>{"use strict";Object.defineProperty(P8,"__esModule",{value:!0});P8.hasGossipProtocol=void 0;var vce=yf();function fHe(t){return t===vce.GossipsubIDv10||t===vce.GossipsubIDv11}P8.hasGossipProtocol=fHe});var Sce=g(D1=>{"use strict";Object.defineProperty(D1,"__esModule",{value:!0});D1.messageIdFromString=D1.messageIdToString=void 0;var hHe=(dt(),se(nn)),dHe=(st(),se(hr));function pHe(t){return dHe.toString(t,"base64")}D1.messageIdToString=pHe;function yHe(t){return hHe.fromString(t,"base64")}D1.messageIdFromString=yHe});var N1=g(Tc=>{"use strict";var gHe=Tc&&Tc.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),C8=Tc&&Tc.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&gHe(e,t,r)};Object.defineProperty(Tc,"__esModule",{value:!0});C8(bce(),Tc);C8(_ce(),Tc);C8(Ece(),Tc);C8(Sce(),Tc)});var Rce=g(B1=>{"use strict";var mHe=B1&&B1.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(f){o(f)}}function c(l){try{u(n.throw(l))}catch(f){o(f)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(t,e||[])).next())})};Object.defineProperty(B1,"__esModule",{value:!0});B1.MessageCache=void 0;var gP=N1(),Ace=class{constructor(e,r){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let n=0;n<r;n++)this.history[n]=[];this.gossip=e}put(e,r){return mHe(this,void 0,void 0,function*(){this.msgs.set(r,e);let n=gP.messageIdFromString(r);this.history[0].push({msgId:n,topics:e.topicIDs})})}get(e){return this.msgs.get(gP.messageIdToString(e))}getForPeer(e,r){let n=this.msgs.get(e);if(!n)return[void 0,0];let i=this.peertx.get(e);i||(i=new Map,this.peertx.set(e,i));let s=(i.get(r)||0)+1;return i.set(r,s),[n,s]}getGossipIDs(e){let r=[];for(let n=0;n<this.gossip;n++)this.history[n].forEach(i=>{for(let s of i.topics)if(s===e){r.push(i.msgId);break}});return r}shift(){this.history[this.history.length-1].forEach(r=>{let n=gP.messageIdToString(r.msgId);this.msgs.delete(n),this.peertx.delete(n)}),this.history.pop(),this.history.unshift([])}};B1.MessageCache=Ace});var Tce=g((Ice,jm)=>{(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof La=="function"&&typeof jm=="object"&&jm&&jm.exports&&(jm.exports=e(Kr()))})(Ice,function(t){"use strict";var e=t.Reader,r=t.Writer,n=t.util,i=t.roots.default||(t.roots.default={});return i.RPC=function(){function s(a){if(this.subscriptions=[],this.msgs=[],a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}s.prototype.subscriptions=n.emptyArray,s.prototype.msgs=n.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),s.encode=function(c,u){if(u||(u=r.create()),c.subscriptions!=null&&c.subscriptions.length)for(var l=0;l<c.subscriptions.length;++l)i.RPC.SubOpts.encode(c.subscriptions[l],u.uint32(10).fork()).ldelim();if(c.msgs!=null&&c.msgs.length)for(var l=0;l<c.msgs.length;++l)i.RPC.Message.encode(c.msgs[l],u.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&i.RPC.ControlMessage.encode(c.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,f=new i.RPC;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:f.subscriptions&&f.subscriptions.length||(f.subscriptions=[]),f.subscriptions.push(i.RPC.SubOpts.decode(c,c.uint32()));break;case 2:f.msgs&&f.msgs.length||(f.msgs=[]),f.msgs.push(i.RPC.Message.decode(c,c.uint32()));break;case 3:f.control=i.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(h&7);break}}return f},s.fromObject=function(c){if(c instanceof i.RPC)return c;var u=new i.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var l=0;l<c.subscriptions.length;++l){if(typeof c.subscriptions[l]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[l]=i.RPC.SubOpts.fromObject(c.subscriptions[l])}}if(c.msgs){if(!Array.isArray(c.msgs))throw TypeError(".RPC.msgs: array expected");u.msgs=[];for(var l=0;l<c.msgs.length;++l){if(typeof c.msgs[l]!="object")throw TypeError(".RPC.msgs: object expected");u.msgs[l]=i.RPC.Message.fromObject(c.msgs[l])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");u.control=i.RPC.ControlMessage.fromObject(c.control)}return u},s.toObject=function(c,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.subscriptions=[],l.msgs=[]),c.subscriptions&&c.subscriptions.length){l.subscriptions=[];for(var f=0;f<c.subscriptions.length;++f)l.subscriptions[f]=i.RPC.SubOpts.toObject(c.subscriptions[f],u)}if(c.msgs&&c.msgs.length){l.msgs=[];for(var f=0;f<c.msgs.length;++f)l.msgs[f]=i.RPC.Message.toObject(c.msgs[f],u)}return c.control!=null&&c.hasOwnProperty("control")&&(l.control=i.RPC.ControlMessage.toObject(c.control,u),u.oneofs&&(l._control="control")),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s.SubOpts=function(){function a(u){if(u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}a.prototype.subscribe=null,a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:n.oneOfGetter(c=["subscribe"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(c=["topicID"]),set:n.oneOfSetter(c)}),a.encode=function(l,f){return f||(f=r.create()),l.subscribe!=null&&Object.hasOwnProperty.call(l,"subscribe")&&f.uint32(8).bool(l.subscribe),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&f.uint32(18).string(l.topicID),f},a.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,d=new i.RPC.SubOpts;l.pos<h;){var p=l.uint32();switch(p>>>3){case 1:d.subscribe=l.bool();break;case 2:d.topicID=l.string();break;default:l.skipType(p&7);break}}return d},a.fromObject=function(l){if(l instanceof i.RPC.SubOpts)return l;var f=new i.RPC.SubOpts;return l.subscribe!=null&&(f.subscribe=Boolean(l.subscribe)),l.topicID!=null&&(f.topicID=String(l.topicID)),f},a.toObject=function(l,f){f||(f={});var h={};return l.subscribe!=null&&l.hasOwnProperty("subscribe")&&(h.subscribe=l.subscribe,f.oneofs&&(h._subscribe="subscribe")),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,f.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.Message=function(){function a(u){if(this.topicIDs=[],u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topicIDs=n.emptyArray,a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:n.oneOfGetter(c=["from"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:n.oneOfGetter(c=["data"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:n.oneOfGetter(c=["seqno"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:n.oneOfGetter(c=["signature"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:n.oneOfGetter(c=["key"]),set:n.oneOfSetter(c)}),a.encode=function(l,f){if(f||(f=r.create()),l.from!=null&&Object.hasOwnProperty.call(l,"from")&&f.uint32(10).bytes(l.from),l.data!=null&&Object.hasOwnProperty.call(l,"data")&&f.uint32(18).bytes(l.data),l.seqno!=null&&Object.hasOwnProperty.call(l,"seqno")&&f.uint32(26).bytes(l.seqno),l.topicIDs!=null&&l.topicIDs.length)for(var h=0;h<l.topicIDs.length;++h)f.uint32(34).string(l.topicIDs[h]);return l.signature!=null&&Object.hasOwnProperty.call(l,"signature")&&f.uint32(42).bytes(l.signature),l.key!=null&&Object.hasOwnProperty.call(l,"key")&&f.uint32(50).bytes(l.key),f},a.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,d=new i.RPC.Message;l.pos<h;){var p=l.uint32();switch(p>>>3){case 1:d.from=l.bytes();break;case 2:d.data=l.bytes();break;case 3:d.seqno=l.bytes();break;case 4:d.topicIDs&&d.topicIDs.length||(d.topicIDs=[]),d.topicIDs.push(l.string());break;case 5:d.signature=l.bytes();break;case 6:d.key=l.bytes();break;default:l.skipType(p&7);break}}return d},a.fromObject=function(l){if(l instanceof i.RPC.Message)return l;var f=new i.RPC.Message;if(l.from!=null&&(typeof l.from=="string"?n.base64.decode(l.from,f.from=n.newBuffer(n.base64.length(l.from)),0):l.from.length&&(f.from=l.from)),l.data!=null&&(typeof l.data=="string"?n.base64.decode(l.data,f.data=n.newBuffer(n.base64.length(l.data)),0):l.data.length&&(f.data=l.data)),l.seqno!=null&&(typeof l.seqno=="string"?n.base64.decode(l.seqno,f.seqno=n.newBuffer(n.base64.length(l.seqno)),0):l.seqno.length&&(f.seqno=l.seqno)),l.topicIDs){if(!Array.isArray(l.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");f.topicIDs=[];for(var h=0;h<l.topicIDs.length;++h)f.topicIDs[h]=String(l.topicIDs[h])}return l.signature!=null&&(typeof l.signature=="string"?n.base64.decode(l.signature,f.signature=n.newBuffer(n.base64.length(l.signature)),0):l.signature.length&&(f.signature=l.signature)),l.key!=null&&(typeof l.key=="string"?n.base64.decode(l.key,f.key=n.newBuffer(n.base64.length(l.key)),0):l.key.length&&(f.key=l.key)),f},a.toObject=function(l,f){f||(f={});var h={};if((f.arrays||f.defaults)&&(h.topicIDs=[]),l.from!=null&&l.hasOwnProperty("from")&&(h.from=f.bytes===String?n.base64.encode(l.from,0,l.from.length):f.bytes===Array?Array.prototype.slice.call(l.from):l.from,f.oneofs&&(h._from="from")),l.data!=null&&l.hasOwnProperty("data")&&(h.data=f.bytes===String?n.base64.encode(l.data,0,l.data.length):f.bytes===Array?Array.prototype.slice.call(l.data):l.data,f.oneofs&&(h._data="data")),l.seqno!=null&&l.hasOwnProperty("seqno")&&(h.seqno=f.bytes===String?n.base64.encode(l.seqno,0,l.seqno.length):f.bytes===Array?Array.prototype.slice.call(l.seqno):l.seqno,f.oneofs&&(h._seqno="seqno")),l.topicIDs&&l.topicIDs.length){h.topicIDs=[];for(var d=0;d<l.topicIDs.length;++d)h.topicIDs[d]=l.topicIDs[d]}return l.signature!=null&&l.hasOwnProperty("signature")&&(h.signature=f.bytes===String?n.base64.encode(l.signature,0,l.signature.length):f.bytes===Array?Array.prototype.slice.call(l.signature):l.signature,f.oneofs&&(h._signature="signature")),l.key!=null&&l.hasOwnProperty("key")&&(h.key=f.bytes===String?n.base64.encode(l.key,0,l.key.length):f.bytes===Array?Array.prototype.slice.call(l.key):l.key,f.oneofs&&(h._key="key")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return a.prototype.ihave=n.emptyArray,a.prototype.iwant=n.emptyArray,a.prototype.graft=n.emptyArray,a.prototype.prune=n.emptyArray,a.encode=function(u,l){if(l||(l=r.create()),u.ihave!=null&&u.ihave.length)for(var f=0;f<u.ihave.length;++f)i.RPC.ControlIHave.encode(u.ihave[f],l.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var f=0;f<u.iwant.length;++f)i.RPC.ControlIWant.encode(u.iwant[f],l.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var f=0;f<u.graft.length;++f)i.RPC.ControlGraft.encode(u.graft[f],l.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var f=0;f<u.prune.length;++f)i.RPC.ControlPrune.encode(u.prune[f],l.uint32(34).fork()).ldelim();return l},a.decode=function(u,l){u instanceof e||(u=e.create(u));for(var f=l===void 0?u.len:u.pos+l,h=new i.RPC.ControlMessage;u.pos<f;){var d=u.uint32();switch(d>>>3){case 1:h.ihave&&h.ihave.length||(h.ihave=[]),h.ihave.push(i.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:h.iwant&&h.iwant.length||(h.iwant=[]),h.iwant.push(i.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:h.graft&&h.graft.length||(h.graft=[]),h.graft.push(i.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:h.prune&&h.prune.length||(h.prune=[]),h.prune.push(i.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(d&7);break}}return h},a.fromObject=function(u){if(u instanceof i.RPC.ControlMessage)return u;var l=new i.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");l.ihave=[];for(var f=0;f<u.ihave.length;++f){if(typeof u.ihave[f]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");l.ihave[f]=i.RPC.ControlIHave.fromObject(u.ihave[f])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");l.iwant=[];for(var f=0;f<u.iwant.length;++f){if(typeof u.iwant[f]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");l.iwant[f]=i.RPC.ControlIWant.fromObject(u.iwant[f])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");l.graft=[];for(var f=0;f<u.graft.length;++f){if(typeof u.graft[f]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");l.graft[f]=i.RPC.ControlGraft.fromObject(u.graft[f])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");l.prune=[];for(var f=0;f<u.prune.length;++f){if(typeof u.prune[f]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");l.prune[f]=i.RPC.ControlPrune.fromObject(u.prune[f])}}return l},a.toObject=function(u,l){l||(l={});var f={};if((l.arrays||l.defaults)&&(f.ihave=[],f.iwant=[],f.graft=[],f.prune=[]),u.ihave&&u.ihave.length){f.ihave=[];for(var h=0;h<u.ihave.length;++h)f.ihave[h]=i.RPC.ControlIHave.toObject(u.ihave[h],l)}if(u.iwant&&u.iwant.length){f.iwant=[];for(var h=0;h<u.iwant.length;++h)f.iwant[h]=i.RPC.ControlIWant.toObject(u.iwant[h],l)}if(u.graft&&u.graft.length){f.graft=[];for(var h=0;h<u.graft.length;++h)f.graft[h]=i.RPC.ControlGraft.toObject(u.graft[h],l)}if(u.prune&&u.prune.length){f.prune=[];for(var h=0;h<u.prune.length;++h)f.prune[h]=i.RPC.ControlPrune.toObject(u.prune[h],l)}return f},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(u){if(this.messageIDs=[],u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}a.prototype.topicID=null,a.prototype.messageIDs=n.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(c=["topicID"]),set:n.oneOfSetter(c)}),a.encode=function(l,f){if(f||(f=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&f.uint32(10).string(l.topicID),l.messageIDs!=null&&l.messageIDs.length)for(var h=0;h<l.messageIDs.length;++h)f.uint32(18).bytes(l.messageIDs[h]);return f},a.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,d=new i.RPC.ControlIHave;l.pos<h;){var p=l.uint32();switch(p>>>3){case 1:d.topicID=l.string();break;case 2:d.messageIDs&&d.messageIDs.length||(d.messageIDs=[]),d.messageIDs.push(l.bytes());break;default:l.skipType(p&7);break}}return d},a.fromObject=function(l){if(l instanceof i.RPC.ControlIHave)return l;var f=new i.RPC.ControlIHave;if(l.topicID!=null&&(f.topicID=String(l.topicID)),l.messageIDs){if(!Array.isArray(l.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");f.messageIDs=[];for(var h=0;h<l.messageIDs.length;++h)typeof l.messageIDs[h]=="string"?n.base64.decode(l.messageIDs[h],f.messageIDs[h]=n.newBuffer(n.base64.length(l.messageIDs[h])),0):l.messageIDs[h].length&&(f.messageIDs[h]=l.messageIDs[h])}return f},a.toObject=function(l,f){f||(f={});var h={};if((f.arrays||f.defaults)&&(h.messageIDs=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,f.oneofs&&(h._topicID="topicID")),l.messageIDs&&l.messageIDs.length){h.messageIDs=[];for(var d=0;d<l.messageIDs.length;++d)h.messageIDs[d]=f.bytes===String?n.base64.encode(l.messageIDs[d],0,l.messageIDs[d].length):f.bytes===Array?Array.prototype.slice.call(l.messageIDs[d]):l.messageIDs[d]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return a.prototype.messageIDs=n.emptyArray,a.encode=function(u,l){if(l||(l=r.create()),u.messageIDs!=null&&u.messageIDs.length)for(var f=0;f<u.messageIDs.length;++f)l.uint32(10).bytes(u.messageIDs[f]);return l},a.decode=function(u,l){u instanceof e||(u=e.create(u));for(var f=l===void 0?u.len:u.pos+l,h=new i.RPC.ControlIWant;u.pos<f;){var d=u.uint32();switch(d>>>3){case 1:h.messageIDs&&h.messageIDs.length||(h.messageIDs=[]),h.messageIDs.push(u.bytes());break;default:u.skipType(d&7);break}}return h},a.fromObject=function(u){if(u instanceof i.RPC.ControlIWant)return u;var l=new i.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");l.messageIDs=[];for(var f=0;f<u.messageIDs.length;++f)typeof u.messageIDs[f]=="string"?n.base64.decode(u.messageIDs[f],l.messageIDs[f]=n.newBuffer(n.base64.length(u.messageIDs[f])),0):u.messageIDs[f].length&&(l.messageIDs[f]=u.messageIDs[f])}return l},a.toObject=function(u,l){l||(l={});var f={};if((l.arrays||l.defaults)&&(f.messageIDs=[]),u.messageIDs&&u.messageIDs.length){f.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)f.messageIDs[h]=l.bytes===String?n.base64.encode(u.messageIDs[h],0,u.messageIDs[h].length):l.bytes===Array?Array.prototype.slice.call(u.messageIDs[h]):u.messageIDs[h]}return f},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(u){if(u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(c=["topicID"]),set:n.oneOfSetter(c)}),a.encode=function(l,f){return f||(f=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&f.uint32(10).string(l.topicID),f},a.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,d=new i.RPC.ControlGraft;l.pos<h;){var p=l.uint32();switch(p>>>3){case 1:d.topicID=l.string();break;default:l.skipType(p&7);break}}return d},a.fromObject=function(l){if(l instanceof i.RPC.ControlGraft)return l;var f=new i.RPC.ControlGraft;return l.topicID!=null&&(f.topicID=String(l.topicID)),f},a.toObject=function(l,f){f||(f={});var h={};return l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,f.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(u){if(this.peers=[],u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}a.prototype.topicID=null,a.prototype.peers=n.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(c=["topicID"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:n.oneOfGetter(c=["backoff"]),set:n.oneOfSetter(c)}),a.encode=function(l,f){if(f||(f=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&f.uint32(10).string(l.topicID),l.peers!=null&&l.peers.length)for(var h=0;h<l.peers.length;++h)i.RPC.PeerInfo.encode(l.peers[h],f.uint32(18).fork()).ldelim();return l.backoff!=null&&Object.hasOwnProperty.call(l,"backoff")&&f.uint32(24).uint64(l.backoff),f},a.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,d=new i.RPC.ControlPrune;l.pos<h;){var p=l.uint32();switch(p>>>3){case 1:d.topicID=l.string();break;case 2:d.peers&&d.peers.length||(d.peers=[]),d.peers.push(i.RPC.PeerInfo.decode(l,l.uint32()));break;case 3:d.backoff=l.uint64();break;default:l.skipType(p&7);break}}return d},a.fromObject=function(l){if(l instanceof i.RPC.ControlPrune)return l;var f=new i.RPC.ControlPrune;if(l.topicID!=null&&(f.topicID=String(l.topicID)),l.peers){if(!Array.isArray(l.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");f.peers=[];for(var h=0;h<l.peers.length;++h){if(typeof l.peers[h]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");f.peers[h]=i.RPC.PeerInfo.fromObject(l.peers[h])}}return l.backoff!=null&&(n.Long?(f.backoff=n.Long.fromValue(l.backoff)).unsigned=!0:typeof l.backoff=="string"?f.backoff=parseInt(l.backoff,10):typeof l.backoff=="number"?f.backoff=l.backoff:typeof l.backoff=="object"&&(f.backoff=new n.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0))),f},a.toObject=function(l,f){f||(f={});var h={};if((f.arrays||f.defaults)&&(h.peers=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,f.oneofs&&(h._topicID="topicID")),l.peers&&l.peers.length){h.peers=[];for(var d=0;d<l.peers.length;++d)h.peers[d]=i.RPC.PeerInfo.toObject(l.peers[d],f)}return l.backoff!=null&&l.hasOwnProperty("backoff")&&(typeof l.backoff=="number"?h.backoff=f.longs===String?String(l.backoff):l.backoff:h.backoff=f.longs===String?n.Long.prototype.toString.call(l.backoff):f.longs===Number?new n.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0):l.backoff,f.oneofs&&(h._backoff="backoff")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(u){if(u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:n.oneOfGetter(c=["peerID"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:n.oneOfGetter(c=["signedPeerRecord"]),set:n.oneOfSetter(c)}),a.encode=function(l,f){return f||(f=r.create()),l.peerID!=null&&Object.hasOwnProperty.call(l,"peerID")&&f.uint32(10).bytes(l.peerID),l.signedPeerRecord!=null&&Object.hasOwnProperty.call(l,"signedPeerRecord")&&f.uint32(18).bytes(l.signedPeerRecord),f},a.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,d=new i.RPC.PeerInfo;l.pos<h;){var p=l.uint32();switch(p>>>3){case 1:d.peerID=l.bytes();break;case 2:d.signedPeerRecord=l.bytes();break;default:l.skipType(p&7);break}}return d},a.fromObject=function(l){if(l instanceof i.RPC.PeerInfo)return l;var f=new i.RPC.PeerInfo;return l.peerID!=null&&(typeof l.peerID=="string"?n.base64.decode(l.peerID,f.peerID=n.newBuffer(n.base64.length(l.peerID)),0):l.peerID.length&&(f.peerID=l.peerID)),l.signedPeerRecord!=null&&(typeof l.signedPeerRecord=="string"?n.base64.decode(l.signedPeerRecord,f.signedPeerRecord=n.newBuffer(n.base64.length(l.signedPeerRecord)),0):l.signedPeerRecord.length&&(f.signedPeerRecord=l.signedPeerRecord)),f},a.toObject=function(l,f){f||(f={});var h={};return l.peerID!=null&&l.hasOwnProperty("peerID")&&(h.peerID=f.bytes===String?n.base64.encode(l.peerID,0,l.peerID.length):f.bytes===Array?Array.prototype.slice.call(l.peerID):l.peerID,f.oneofs&&(h._peerID="peerID")),l.signedPeerRecord!=null&&l.hasOwnProperty("signedPeerRecord")&&(h.signedPeerRecord=f.bytes===String?n.base64.encode(l.signedPeerRecord,0,l.signedPeerRecord.length):f.bytes===Array?Array.prototype.slice.call(l.signedPeerRecord):l.signedPeerRecord,f.oneofs&&(h._signedPeerRecord="signedPeerRecord")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s}(),i})});var mP=g(O8=>{"use strict";Object.defineProperty(O8,"__esModule",{value:!0});O8.getGossipPeers=void 0;var xce=N1();function wHe(t,e,r,n=()=>!0){let i=t.topics.get(e);if(!i)return new Set;let s=[];return i.forEach(o=>{let a=t.peers.get(o);!a||xce.hasGossipProtocol(a.protocol)&&n(o)&&s.push(o)}),s=xce.shuffle(s),r>0&&s.length>r&&(s=s.slice(0,r)),new Set(s)}O8.getGossipPeers=wHe});var Cce=g(xc=>{"use strict";var bHe=xc&&xc.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_He=xc&&xc.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vHe=xc&&xc.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bHe(e,t,r);return _He(e,t),e};Object.defineProperty(xc,"__esModule",{value:!0});xc.Heartbeat=void 0;var wP=vHe(yf()),k8=mP(),EHe=N1(),Pce=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),r=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,this.gossipsub._options.heartbeatInterval)},wP.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(n,i)=>{this._heartbeatTimer._intervalId=setInterval(n,i)},cancel:()=>{clearTimeout(r),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:r,Dhi:n,Dscore:i,Dout:s,fanoutTTL:o}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let a=new Map,c=d=>{let p=a.get(d);return p===void 0&&(p=this.gossipsub.score.score(d),a.set(d,p)),p},u=new Map,l=new Map,f=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((d,p)=>{let y=m=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",m,p),this.gossipsub.score.prune(m,p),this.gossipsub._addBackoff(m,p),d.delete(m);let _=l.get(m);_?_.push(p):l.set(m,[p])},b=m=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",m,p),this.gossipsub.score.graft(m,p),d.add(m);let _=u.get(m);_?_.push(p):u.set(m,[p])};if(d.forEach(m=>{let _=c(m);_<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",m,_,p),y(m),f.set(m,!0))}),d.size<r){let m=this.gossipsub.backoff.get(p),_=e-d.size;k8.getGossipPeers(this.gossipsub,p,_,k=>!d.has(k)&&!this.gossipsub.direct.has(k)&&(!m||!m.has(k))&&c(k)>=0).forEach(b)}if(d.size>n){let m=Array.from(d);m.sort((R,k)=>c(k)-c(R)),m=m.slice(0,i).concat(EHe.shuffle(m.slice(i)));let _=0;if(m.slice(0,e).forEach(R=>{this.gossipsub.outbound.get(R)&&_++}),_<s){let R=P=>{let x=m[P];for(let D=P;D>0;D--)m[D]=m[D-1];m[0]=x};if(_>0){let P=_;for(let x=1;x<e&&P>0;x++)this.gossipsub.outbound.get(m[x])&&(R(x),P--)}let k=e-_;for(let P=e;P<m.length&&k>0;P++)this.gossipsub.outbound.get(m[P])&&(R(P),k--)}m.slice(e).forEach(y)}if(d.size>=r){let m=0;if(d.forEach(_=>{this.gossipsub.outbound.get(_)&&m++}),m<s){let _=s-m,R=this.gossipsub.backoff.get(p);k8.getGossipPeers(this.gossipsub,p,_,k=>!d.has(k)&&!this.gossipsub.direct.has(k)&&(!R||!R.has(k))&&c(k)>=0).forEach(b)}}if(this.gossipsub.heartbeatTicks%wP.GossipsubOpportunisticGraftTicks===0&&d.size>1){let m=Array.from(d).sort((k,P)=>c(k)-c(P)),_=Math.floor(d.size/2),R=c(m[_]);if(R<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let k=this.gossipsub.backoff.get(p);k8.getGossipPeers(this.gossipsub,p,wP.GossipsubOpportunisticGraftPeers,x=>d.has(x)&&!this.gossipsub.direct.has(x)&&(!k||!k.has(x))&&c(x)>R).forEach(x=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",x,p),b(x)})}}this.gossipsub._emitGossip(p,d)});let h=this.gossipsub._now();this.gossipsub.lastpub.forEach((d,p)=>{d+o<h&&(this.gossipsub.fanout.delete(p),this.gossipsub.lastpub.delete(p))}),this.gossipsub.fanout.forEach((d,p)=>{let y=this.gossipsub.topics.get(p);if(d.forEach(b=>{(!y.has(b)||c(b)<this.gossipsub._options.scoreThresholds.publishThreshold)&&d.delete(b)}),d.size<e){let b=e-d.size;k8.getGossipPeers(this.gossipsub,p,b,_=>!d.has(_)&&!this.gossipsub.direct.has(_)&&c(_)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(_=>{d.add(_)})}this.gossipsub._emitGossip(p,d)}),this.gossipsub._sendGraftPrune(u,l,f),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};xc.Heartbeat=Pce});var bP=g(L1=>{"use strict";Object.defineProperty(L1,"__esModule",{value:!0});L1.ERR_INVALID_PEER_SCORE_THRESHOLDS=L1.ERR_INVALID_PEER_SCORE_PARAMS=void 0;L1.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";L1.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var _P=g(Ci=>{"use strict";Object.defineProperty(Ci,"__esModule",{value:!0});Ci.validateTopicScoreParams=Ci.validatePeerScoreParams=Ci.createTopicScoreParams=Ci.createPeerScoreParams=Ci.defaultTopicScoreParams=Ci.defaultPeerScoreParams=void 0;var Sr=bP(),Ar=oe();Ci.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};Ci.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function SHe(t={}){return Object.assign(Object.assign(Object.assign({},Ci.defaultPeerScoreParams),t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,n])=>(e[r]=Oce(n),e),{}):{}})}Ci.createPeerScoreParams=SHe;function Oce(t={}){return Object.assign(Object.assign({},Ci.defaultTopicScoreParams),t)}Ci.createTopicScoreParams=Oce;function AHe(t){for(let[e,r]of Object.entries(t.topics))try{kce(r)}catch(n){throw Ar(new Error(`invalid score parameters for topic ${e}: ${n.message}`),Sr.ERR_INVALID_PEER_SCORE_PARAMS)}if(t.topicScoreCap<0)throw Ar(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw Ar(new Error("missing application specific score function"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight>0)throw Ar(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw Ar(new Error("invalid IPColocationFactorThreshold; must be at least 1"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight>0)throw Ar(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw Ar(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayInterval<1e3)throw Ar(new Error("invalid DecayInterval; must be at least 1s"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayToZero<=0||t.decayToZero>=1)throw Ar(new Error("invalid DecayToZero; must be between 0 and 1"),Sr.ERR_INVALID_PEER_SCORE_PARAMS)}Ci.validatePeerScoreParams=AHe;function kce(t){if(t.topicWeight<0)throw Ar(new Error("invalid topic weight; must be >= 0"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshQuantum===0)throw Ar(new Error("invalid TimeInMeshQuantum; must be non zero"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight<0)throw Ar(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw Ar(new Error("invalid TimeInMeshQuantum; must be positive"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw Ar(new Error("invalid TimeInMeshCap; must be positive"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight<0)throw Ar(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw Ar(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw Ar(new Error("invalid FirstMessageDeliveriesCap; must be positive"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight>0)throw Ar(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw Ar(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw Ar(new Error("invalid MeshMessageDeliveriesCap; must be positive"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw Ar(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWindow<0)throw Ar(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw Ar(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight>0)throw Ar(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw Ar(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesWeight>0)throw Ar(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),Sr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw Ar(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),Sr.ERR_INVALID_PEER_SCORE_PARAMS)}Ci.validateTopicScoreParams=kce});var Dce=g(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});Tu.validatePeerScoreThresholds=Tu.createPeerScoreThresholds=Tu.defaultPeerScoreThresholds=void 0;var Vm=bP(),zm=oe();Tu.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function RHe(t={}){return Object.assign(Object.assign({},Tu.defaultPeerScoreThresholds),t)}Tu.createPeerScoreThresholds=RHe;function IHe(t){if(t.gossipThreshold>0)throw zm(new Error("invalid gossip threshold; it must be <= 0"),Vm.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.publishThreshold>0||t.publishThreshold>t.gossipThreshold)throw zm(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),Vm.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.graylistThreshold>0||t.graylistThreshold>t.publishThreshold)throw zm(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),Vm.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.acceptPXThreshold<0)throw zm(new Error("invalid accept PX threshold; it must be >= 0"),Vm.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.opportunisticGraftThreshold<0)throw zm(new Error("invalid opportunistic grafting threshold; it must be >= 0"),Vm.ERR_INVALID_PEER_SCORE_THRESHOLDS)}Tu.validatePeerScoreThresholds=IHe});var Nce=g(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});gf.ensureTopicStats=gf.createTopicStats=gf.createPeerStats=void 0;function THe(t={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,n])=>(e[r]=vP(n),e),{}):{}})}gf.createPeerStats=THe;function vP(t={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},t)}gf.createTopicStats=vP;function xHe(t,e,r){let n=e.topics[t];if(n)return n;if(!!r.topics[t])return e.topics[t]=n=vP(),n}gf.ensureTopicStats=xHe});var Bce=g(D8=>{"use strict";Object.defineProperty(D8,"__esModule",{value:!0});D8.computeScore=void 0;function PHe(t,e,r,n){let i=0;return Object.entries(e.topics).forEach(([a,c])=>{let u=r.topics[a];if(!u)return;let l=0;if(c.inMesh){let p=c.meshTime/u.timeInMeshQuantum;p>u.timeInMeshCap&&(p=u.timeInMeshCap),l+=p*u.timeInMeshWeight}if(l+=c.firstMessageDeliveries*u.firstMessageDeliveriesWeight,c.meshMessageDeliveriesActive&&c.meshMessageDeliveries<u.meshMessageDeliveriesThreshold){let p=u.meshMessageDeliveriesThreshold-c.meshMessageDeliveries;l+=p*p*u.meshMessageDeliveriesWeight}l+=c.meshFailurePenalty*u.meshFailurePenaltyWeight,l+=c.invalidMessageDeliveries*c.invalidMessageDeliveries*u.invalidMessageDeliveriesWeight,i+=l*u.topicWeight}),r.topicScoreCap>0&&i>r.topicScoreCap&&(i=r.topicScoreCap),i+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(a=>{if(r.IPColocationFactorWhitelist.has(a))return;let c=n.get(a),u=c?c.size:0;if(u>r.IPColocationFactorThreshold){let l=u-r.IPColocationFactorThreshold;i+=l*l*r.IPColocationFactorWeight}}),i+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,i}D8.computeScore=PHe});var Mce=g((MSt,Lce)=>{"use strict";function un(t,r){var r=r||{};this._head=0,this._tail=0,this._capacity=r.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}un.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var n=this.size();if(!(r>=n||r<-n))return r<0&&(r+=n),r=this._head+r&this._capacityMask,this._list[r]}};un.prototype.get=function(e){return this.peekAt(e)};un.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};un.prototype.peekFront=function(){return this.peek()};un.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(un.prototype,"length",{get:function(){return this.size()}});un.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};un.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};un.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};un.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};un.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),n}};un.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var n=this.size(),i=this._list.length;if(!(r>=n||r<-n)){r<0&&(r+=n),r=this._head+r&this._capacityMask;var s=this._list[r],o;if(e<n/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+i&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+i&this._capacityMask}else{for(o=n-1-e;o>0;o--)this._list[r]=this._list[r=r+1+i&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+i&this._capacityMask}return s}}};un.prototype.remove=function(e,r){var n=e,i,s=r;if(n===(n|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(n>=o||n<-o||r<1)){if(n<0&&(n+=o),r===1||!r)return i=new Array(1),i[0]=this.removeOne(n),i;if(n===0&&n+r>=o)return i=this.toArray(),this.clear(),i;n+r>o&&(r=o-n);var c;for(i=new Array(r),c=0;c<r;c++)i[c]=this._list[this._head+n+c&this._capacityMask];if(n=this._head+n&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,c=r;c>0;c--)this._list[n=n+1+a&this._capacityMask]=void 0;return i}if(e===0){for(this._head=this._head+r+a&this._capacityMask,c=r-1;c>0;c--)this._list[n=n+1+a&this._capacityMask]=void 0;return i}if(n<o/2){for(this._head=this._head+e+r+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[n=n-1+a&this._capacityMask]);for(n=this._head-1+a&this._capacityMask;s>0;)this._list[n=n-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+r+a&this._capacityMask,c=o-(r+e);c>0;c--)this.push(this._list[n++]);for(n=this._tail;s>0;)this._list[n=n+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),i}}};un.prototype.splice=function(e,r){var n=e;if(n===(n|0)){var i=this.size();if(n<0&&(n+=i),!(n>i))if(arguments.length>2){var s,o,a,c=arguments.length,u=this._list.length,l=2;if(!i||n<i/2){for(o=new Array(n),s=0;s<n;s++)o[s]=this._list[this._head+s&this._capacityMask];for(r===0?(a=[],n>0&&(this._head=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._head=this._head+n+u&this._capacityMask);c>l;)this.unshift(arguments[--c]);for(s=n;s>0;s--)this.unshift(o[s-1])}else{o=new Array(i-(n+r));var f=o.length;for(s=0;s<f;s++)o[s]=this._list[this._head+n+r+s&this._capacityMask];for(r===0?(a=[],n!=i&&(this._tail=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._tail=this._tail-f+u&this._capacityMask);l<c;)this.push(arguments[l++]);for(s=0;s<f;s++)this.push(o[s])}return a}else return this.remove(n,r)}};un.prototype.clear=function(){this._head=0,this._tail=0};un.prototype.isEmpty=function(){return this._head===this._tail};un.prototype.toArray=function(){return this._copyArray(!1)};un.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};un.prototype._copyArray=function(e){var r=[],n=this._list,i=n.length,s;if(e||this._head>this._tail){for(s=this._head;s<i;s++)r.push(n[s]);for(s=0;s<this._tail;s++)r.push(n[s])}else for(s=this._head;s<this._tail;s++)r.push(n[s]);return r};un.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};un.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Lce.exports=un});var Fce=g(xu=>{"use strict";var CHe=xu&&xu.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xu,"__esModule",{value:!0});xu.MessageDeliveries=xu.DeliveryRecordStatus=void 0;var OHe=yf(),kHe=CHe(Mce()),Uce;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(Uce=xu.DeliveryRecordStatus||(xu.DeliveryRecordStatus={}));var qce=class{constructor(){this.records=new Map,this.queue=new kHe.default}ensureRecord(e){let r=this.records.get(e);if(r)return r;r={status:Uce.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,r);let n={msgId:e,expire:Date.now()+OHe.TimeCacheDuration};return this.queue.push(n),r}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};xu.MessageDeliveries=qce});var jce=g(mf=>{"use strict";var N8=mf&&mf.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(f){o(f)}}function c(l){try{u(n.throw(l))}catch(f){o(f)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},DHe=mf&&mf.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(mf,"__esModule",{value:!0});mf.PeerScore=void 0;var NHe=_P(),M1=Nce(),BHe=Bce(),Aa=Fce(),LHe=yf(),MHe=DHe(ft()),UHe=he(),qHe=E8(),{ERR_INVALID_SIGNATURE:FHe,ERR_MISSING_SIGNATURE:KHe}=qHe.codes,U1=UHe("libp2p:gossipsub:score"),Kce=class{constructor(e,r){NHe.validatePeerScoreParams(e),this.params=e,this._connectionManager=r,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new Aa.MessageDeliveries}start(){if(this._backgroundInterval){U1("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),U1("started")}stop(){if(!this._backgroundInterval){U1("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),U1("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((n,i)=>{if(!n.connected){e>n.expire&&(this._removeIPs(i,n.ips),this.peerStats.delete(i));return}Object.entries(n.topics).forEach(([s,o])=>{let a=this.params.topics[s];!a||(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<r&&(n.behaviourPenalty=0),this.scoreCache.set(i,{score:null,cacheUntil:0})})}score(e){let r=this.peerStats.get(e);if(!r)return 0;let n=Date.now(),i=this.scoreCache.get(e);i===void 0&&(i={score:null,cacheUntil:0},this.scoreCache.set(e,i));let{score:s,cacheUntil:o}=i;return o>n&&s!==null?s:(i.score=BHe.computeScore(e,r,this.params,this.peerIPs),i.cacheUntil=n+this.params.decayInterval,i.score)}addPenalty(e,r){let n=this.peerStats.get(e);!n||(n.behaviourPenalty+=r,this.scoreCache.set(e,{score:null,cacheUntil:0}))}addPeer(e){let r=M1.createPeerStats({connected:!0});this.peerStats.set(e,r);let n=this._getIPs(e);this._setIPs(e,n,r.ips),r.ips=n}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this._removeIPs(e,r.ips),this.peerStats.delete(e);return}this.scoreCache.delete(e),Object.entries(r.topics).forEach(([n,i])=>{i.firstMessageDeliveries=0;let s=this.params.topics[n].meshMessageDeliveriesThreshold;if(i.inMesh&&i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<s){let o=s-i.meshMessageDeliveries;i.meshFailurePenalty+=o*o}i.inMesh=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let n=this.peerStats.get(e);if(!n)return;let i=M1.ensureTopicStats(r,n,this.params);!i||(i.inMesh=!0,i.graftTime=Date.now(),i.meshTime=0,i.meshMessageDeliveriesActive=!1,this.scoreCache.set(e,{score:null,cacheUntil:0}))}prune(e,r){let n=this.peerStats.get(e);if(!n)return;let i=M1.ensureTopicStats(r,n,this.params);if(!i)return;let s=this.params.topics[r].meshMessageDeliveriesThreshold;if(i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<s){let o=s-i.meshMessageDeliveries;i.meshFailurePenalty+=o*o}i.inMesh=!1,this.scoreCache.set(e,{score:null,cacheUntil:0})}validateMessage(e){return N8(this,void 0,void 0,function*(){this.deliveryRecords.ensureRecord(e)})}deliverMessage(e,r){return N8(this,void 0,void 0,function*(){let n=e.receivedFrom;this._markFirstMessageDelivery(n,e);let i=this.deliveryRecords.ensureRecord(r),s=Date.now();if(i.status!==Aa.DeliveryRecordStatus.unknown){U1("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",n,s-i.firstSeen,Aa.DeliveryRecordStatus[i.status]);return}i.status=Aa.DeliveryRecordStatus.valid,i.validated=s,i.peers.forEach(o=>{o!==n&&this._markDuplicateMessageDelivery(o,e)})})}rejectMessage(e,r,n){return N8(this,void 0,void 0,function*(){let i=e.receivedFrom;switch(n){case KHe:case FHe:this._markInvalidMessageDelivery(i,e);return}let s=this.deliveryRecords.ensureRecord(r);if(s.status!==Aa.DeliveryRecordStatus.unknown){U1("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",i,Date.now()-s.firstSeen,Aa.DeliveryRecordStatus[s.status]);return}switch(n){case LHe.ERR_TOPIC_VALIDATOR_IGNORE:s.status=Aa.DeliveryRecordStatus.ignored;return}s.status=Aa.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(i,e),s.peers.forEach(o=>{this._markInvalidMessageDelivery(o,e)})})}duplicateMessage(e,r){return N8(this,void 0,void 0,function*(){let n=e.receivedFrom,i=this.deliveryRecords.ensureRecord(r);if(!i.peers.has(n))switch(i.status){case Aa.DeliveryRecordStatus.unknown:i.peers.add(n);break;case Aa.DeliveryRecordStatus.valid:i.peers.add(n),this._markDuplicateMessageDelivery(n,e,i.validated);break;case Aa.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(n,e);break}})}_markInvalidMessageDelivery(e,r){let n=this.peerStats.get(e);!n||(r.topicIDs.forEach(i=>{let s=M1.ensureTopicStats(i,n,this.params);!s||(s.invalidMessageDeliveries+=1)}),this.scoreCache.set(e,{score:null,cacheUntil:0}))}_markFirstMessageDelivery(e,r){let n=this.peerStats.get(e);!n||(r.topicIDs.forEach(i=>{let s=M1.ensureTopicStats(i,n,this.params);if(!s)return;let o=this.params.topics[i].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[i].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))}),this.scoreCache.set(e,{score:null,cacheUntil:0}))}_markDuplicateMessageDelivery(e,r,n=0){let i=this.peerStats.get(e);if(!i)return;let s=n?Date.now():0;r.topicIDs.forEach(o=>{let a=M1.ensureTopicStats(o,i,this.params);if(!a||!a.inMesh)return;let c=this.params.topics[o];if(n&&s>n+c.meshMessageDeliveriesWindow)return;let u=c.meshMessageDeliveriesCap;a.meshMessageDeliveries+=1,a.meshMessageDeliveries>u&&(a.meshMessageDeliveries=u)}),this.scoreCache.set(e,{score:null,cacheUntil:0})}_getIPs(e){return this._connectionManager.getAll(MHe.default.createFromB58String(e)).map(r=>r.remoteAddr.toOptions().host)}_setIPs(e,r,n){e:for(let i of r){for(let o of n)if(i===o)continue e;let s=this.peerIPs.get(i);s||(s=new Set,this.peerIPs.set(i,s)),s.add(e)}e:for(let i of n){for(let o of r)if(i===o)continue e;let s=this.peerIPs.get(i);!s||(s.delete(e),s.size||this.peerIPs.delete(i))}this.scoreCache.set(e,{score:null,cacheUntil:0})}_removeIPs(e,r){r.forEach(n=>{let i=this.peerIPs.get(n);!i||(i.delete(e),i.size||this.peerIPs.delete(n))}),this.scoreCache.set(e,{score:null,cacheUntil:0})}_updateIPs(){this.peerStats.forEach((e,r)=>{let n=this._getIPs(r);this._setIPs(r,n,e.ips),e.ips=n,this.scoreCache.set(r,{score:null,cacheUntil:0})})}};mf.PeerScore=Kce});var Vce=g(Pu=>{"use strict";var jHe=Pu&&Pu.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),EP=Pu&&Pu.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&jHe(e,t,r)};Object.defineProperty(Pu,"__esModule",{value:!0});EP(_P(),Pu);EP(Dce(),Pu);EP(jce(),Pu)});var $ce=g(q1=>{"use strict";var zce=q1&&q1.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(f){o(f)}}function c(l){try{u(n.throw(l))}catch(f){o(f)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(t,e||[])).next())})};Object.defineProperty(q1,"__esModule",{value:!0});q1.IWantTracer=void 0;var VHe=yf(),zHe=N1(),HHe=E8(),{ERR_INVALID_SIGNATURE:$He,ERR_MISSING_SIGNATURE:GHe}=HHe.codes,Hce=class{constructor(){this.promises=new Map}addPromise(e,r){let n=Math.floor(Math.random()*r.length),i=r[n],s=zHe.messageIdToString(i),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+VHe.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),r=new Map;return this.promises.forEach((n,i)=>{n.forEach((s,o)=>{s<e&&(r.set(o,(r.get(o)||0)+1),n.delete(o))}),n.size||this.promises.delete(i)}),r}deliverMessage(e){return zce(this,void 0,void 0,function*(){this.promises.delete(e)})}rejectMessage(e,r){return zce(this,void 0,void 0,function*(){switch(r){case $He:case GHe:return}this.promises.delete(e)})}clear(){this.promises.clear()}};q1.IWantTracer=Hce});var Wce=g(B8=>{"use strict";Object.defineProperty(B8,"__esModule",{value:!0});B8.SimpleTimeCache=void 0;var Gce=class{constructor(e){this.lastPruneTime=0,this.entries=new Map,this.validityMs=e.validityMs}put(e,r){this.entries.set(e,{value:r,validUntilMs:Date.now()+this.validityMs}),this.prune()}prune(){let e=Date.now();if(!(e-this.lastPruneTime<200)){this.lastPruneTime=e;for(let[r,n]of this.entries.entries())if(n.validUntilMs<e)this.entries.delete(r);else break}}has(e){return this.entries.has(e)}get(e){let r=this.entries.get(e);return r&&r.validUntilMs>=Date.now()?r.value:void 0}clear(){this.entries=new Map,this.lastPruneTime=0}};B8.SimpleTimeCache=Gce});var Rr=g(SP=>{"use strict";SP.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required",NOT_FOUND:"Not found"};SP.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_PEER_DIAL_INTERCEPTED:"ERR_PEER_DIAL_INTERCEPTED",ERR_CONNECTION_INTERCEPTED:"ERR_CONNECTION_INTERCEPTED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_NOT_FOUND:"ERR_NOT_FOUND",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID",ERR_FIND_SELF:"ERR_FIND_SELF",ERR_NO_ROUTERS_AVAILABLE:"ERR_NO_ROUTERS_AVAILABLE",ERR_CONNECTION_NOT_MULTIPLEXED:"ERR_CONNECTION_NOT_MULTIPLEXED",ERR_NO_DIAL_TOKENS:"ERR_NO_DIAL_TOKENS",ERR_KEYCHAIN_REQUIRED:"ERR_KEYCHAIN_REQUIRED",ERR_INVALID_CMS:"ERR_INVALID_CMS",ERR_MISSING_KEYS:"ERR_MISSING_KEYS",ERR_NO_KEY:"ERR_NO_KEY",ERR_INVALID_KEY_NAME:"ERR_INVALID_KEY_NAME",ERR_INVALID_KEY_TYPE:"ERR_INVALID_KEY_TYPE",ERR_KEY_ALREADY_EXISTS:"ERR_KEY_ALREADY_EXISTS",ERR_INVALID_KEY_SIZE:"ERR_INVALID_KEY_SIZE",ERR_KEY_NOT_FOUND:"ERR_KEY_NOT_FOUND",ERR_OLD_KEY_NAME_INVALID:"ERR_OLD_KEY_NAME_INVALID",ERR_NEW_KEY_NAME_INVALID:"ERR_NEW_KEY_NAME_INVALID",ERR_PASSWORD_REQUIRED:"ERR_PASSWORD_REQUIRED",ERR_PEM_REQUIRED:"ERR_PEM_REQUIRED",ERR_CANNOT_READ_KEY:"ERR_CANNOT_READ_KEY",ERR_MISSING_PRIVATE_KEY:"ERR_MISSING_PRIVATE_KEY",ERR_INVALID_OLD_PASS_TYPE:"ERR_INVALID_OLD_PASS_TYPE",ERR_INVALID_NEW_PASS_TYPE:"ERR_INVALID_NEW_PASS_TYPE",ERR_INVALID_PASS_LENGTH:"ERR_INVALID_PASS_LENGTH",ERR_NOT_IMPLEMENTED:"ERR_NOT_IMPLEMENTED",ERR_WRONG_PING_ACK:"ERR_WRONG_PING_ACK"}});var Qce=g((zSt,Xce)=>{"use strict";var F1=Kr(),Yce=F1.Reader,WHe=F1.Writer,Yr=F1.util,Hm=F1.roots["libp2p-envelope"]||(F1.roots["libp2p-envelope"]={});Hm.Envelope=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.publicKey=Yr.newBuffer([]),t.prototype.payloadType=Yr.newBuffer([]),t.prototype.payload=Yr.newBuffer([]),t.prototype.signature=Yr.newBuffer([]),t.encode=function(r,n){return n||(n=WHe.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&n.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&n.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&n.uint32(42).bytes(r.signature),n},t.decode=function(r,n){r instanceof Yce||(r=Yce.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Hm.Envelope;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Hm.Envelope)return r;var n=new Hm.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?Yr.base64.decode(r.publicKey,n.publicKey=Yr.newBuffer(Yr.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?Yr.base64.decode(r.payloadType,n.payloadType=Yr.newBuffer(Yr.base64.length(r.payloadType)),0):r.payloadType.length&&(n.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?Yr.base64.decode(r.payload,n.payload=Yr.newBuffer(Yr.base64.length(r.payload)),0):r.payload.length&&(n.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?Yr.base64.decode(r.signature,n.signature=Yr.newBuffer(Yr.base64.length(r.signature)),0):r.signature.length&&(n.signature=r.signature)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=Yr.newBuffer(i.publicKey))),n.bytes===String?i.payloadType="":(i.payloadType=[],n.bytes!==Array&&(i.payloadType=Yr.newBuffer(i.payloadType))),n.bytes===String?i.payload="":(i.payload=[],n.bytes!==Array&&(i.payload=Yr.newBuffer(i.payload))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=Yr.newBuffer(i.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?Yr.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(i.payloadType=n.bytes===String?Yr.base64.encode(r.payloadType,0,r.payloadType.length):n.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(i.payload=n.bytes===String?Yr.base64.encode(r.payload,0,r.payload.length):n.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(i.signature=n.bytes===String?Yr.base64.encode(r.signature,0,r.signature.length):n.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,F1.util.toJSONOptions)},t}();Xce.exports=Hm});var $m=g((HSt,eue)=>{"use strict";var YHe=oe(),{concat:XHe}=(Pn(),se(Ui)),{fromString:QHe}=(dt(),se(nn)),ZHe=t5(),JHe=ft(),AP=ns(),{equals:L8}=(bn(),se(Ei)),{codes:e$e}=Rr(),{Envelope:Zce}=Qce(),wf=class{constructor({peerId:e,payloadType:r,payload:n,signature:i}){this.peerId=e,this.payloadType=r,this.payload=n,this.signature=i,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=ZHe.marshalPublicKey(this.peerId.pubKey);return this._marshal=Zce.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return L8(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&L8(this.payloadType,e.payloadType)&&L8(this.payload,e.payload)&&L8(this.signature,e.signature)}validate(e){let r=Jce(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(r,this.signature)}},Jce=(t,e,r)=>{let n=QHe(t),i=AP.encode(n.byteLength),s=AP.encode(e.length),o=AP.encode(r.length);return XHe([new Uint8Array(i),n,new Uint8Array(s),e,new Uint8Array(o),r])};wf.createFromProtobuf=async t=>{let e=Zce.decode(t),r=await JHe.createFromPubKey(e.publicKey);return new wf({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};wf.seal=async(t,e)=>{let r=t.domain,n=t.codec,i=t.marshal(),s=Jce(r,n,i),o=await e.privKey.sign(s);return new wf({peerId:e,payloadType:n,payload:i,signature:o})};wf.openAndCertify=async(t,e)=>{let r=await wf.createFromProtobuf(t);if(!await r.validate(e))throw YHe(new Error("envelope signature is not valid for the given domain"),e$e.ERR_SIGNATURE_NOT_VALID);return r};eue.exports=wf});var OP=g((Cu,nue)=>{"use strict";var t$e=Cu&&Cu.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),r$e=Cu&&Cu.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),rue=Cu&&Cu.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&t$e(e,t,r);return r$e(e,t),e},Wi=Cu&&Cu.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(f){o(f)}}function c(l){try{u(n.throw(l))}catch(f){o(f)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},RP=rue(wce()),n$e=Rce(),IP=Tce(),Ut=rue(yf()),i$e=Cce(),M8=mP(),Nn=N1(),TP=Vce(),s$e=$ce(),tue=Wce(),xP=ft(),o$e=$m(),PP=yf(),CP=class extends RP.default{constructor(e,r={}){var n;let i=[Ut.GossipsubIDv11,Ut.GossipsubIDv10],s=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:Ut.GossipsubD,Dlo:Ut.GossipsubDlo,Dhi:Ut.GossipsubDhi,Dscore:Ut.GossipsubDscore,Dout:Ut.GossipsubDout,Dlazy:Ut.GossipsubDlazy,heartbeatInterval:Ut.GossipsubHeartbeatInterval,fanoutTTL:Ut.GossipsubFanoutTTL,mcacheLength:Ut.GossipsubHistoryLength,mcacheGossip:Ut.GossipsubHistoryGossip,seenTTL:Ut.GossipsubSeenTTL},r),{scoreParams:TP.createPeerScoreParams(r.scoreParams),scoreThresholds:TP.createPeerScoreThresholds(r.scoreThresholds)});s.fallbackToFloodsub&&i.push(Ut.FloodsubID);super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:i,libp2p:e},s));this._options=s,this.direct=new Set(s.directPeers.map(o=>o.id.toB58String())),this.acceptFromWhitelist=new Map,s.directPeers.forEach(o=>{e.peerStore.addressBook.add(o.id,o.addrs)}),this.seenCache=new tue.SimpleTimeCache({validityMs:s.seenTTL}),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=r.messageCache||new n$e.MessageCache(s.mcacheGossip,s.mcacheLength),this.getFastMsgIdStr=(n=r.fastMsgIdFn)!==null&&n!==void 0?n:void 0,this.fastMsgIdCache=r.fastMsgIdFn?new tue.SimpleTimeCache({validityMs:s.seenTTL}):void 0,this.heartbeat=new i$e.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new s$e.IWantTracer,this._libp2p=e,this.score=new TP.PeerScore(this._options.scoreParams,e.connectionManager)}_decodeRpc(e){return IP.RPC.decode(e)}_encodeRpc(e){return IP.RPC.encode(e).finish()}_addPeer(e,r){let n=super._addPeer(e,r);this.score.addPeer(e.toB58String());let i=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>r===o.protocol)){i=!0;break}return this.outbound.set(n.id.toB58String(),i),n}_removePeer(e){let r=super._removePeer(e),n=e.toB58String();for(let i of this.mesh.values())i.delete(n);for(let i of this.fanout.values())i.delete(n);return this.gossip.delete(n),this.control.delete(n),this.outbound.delete(n),this.score.removePeer(n),this.acceptFromWhitelist.delete(n),r}_processRpc(e,r,n){let i=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return Wi(this,void 0,void 0,function*(){return(yield i._processRpc.call(this,e,r,n))?(n.control&&(yield this._processRpcControlMessage(e,n.control)),!0):!1})}_processRpcControlMessage(e,r){return Wi(this,void 0,void 0,function*(){if(!r)return;let n=r.ihave?this._handleIHave(e,r.ihave):[],i=r.iwant?this._handleIWant(e,r.iwant):[],s=r.graft?yield this._handleGraft(e,r.graft):[];if(r.prune&&this._handlePrune(e,r.prune),!n.length&&!i.length&&!s.length)return;let o=Nn.createGossipRpc(i,{iwant:n,prune:s});this._sendRpc(e,o)})}_processRpcMessage(e){let r=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return Wi(this,void 0,void 0,function*(){let n;if(this.getFastMsgIdStr&&this.fastMsgIdCache){let i=yield this.getFastMsgIdStr(e);if(n=this.fastMsgIdCache.get(i),n!==void 0){this.score.duplicateMessage(e,n);return}n=Nn.messageIdToString(yield this.getMsgId(e)),this.fastMsgIdCache.put(i,n)}else if(n=Nn.messageIdToString(yield this.getMsgId(e)),this.seenCache.has(n)){this.score.duplicateMessage(e,n);return}this.seenCache.put(n),yield this.score.validateMessage(n),yield r._processRpcMessage.call(this,e)})}_acceptFrom(e){if(this.direct.has(e))return!0;let r=Date.now(),n=this.acceptFromWhitelist.get(e);if(n&&n.messagesAccepted<PP.ACCEPT_FROM_WHITELIST_MAX_MESSAGES&&n.acceptUntil>=r)return n.messagesAccepted+=1,!0;let i=this.score.score(e);return i>=PP.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:r+PP.ACCEPT_FROM_WHITELIST_DURATION_MS}):this.acceptFromWhitelist.delete(e),i>=this._options.scoreThresholds.graylistThreshold}validate(e){let r=Object.create(null,{validate:{get:()=>super.validate}});return Wi(this,void 0,void 0,function*(){try{yield r.validate.call(this,e)}catch(n){let i=yield this.getCanonicalMsgIdStr(e);throw this.score.rejectMessage(e,i,n.code),this.gossipTracer.rejectMessage(i,n.code),n}})}_handleIHave(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,n),[];let i=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,i),i>Ut.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,i),[];let s=this.iasked.get(e)||0;if(s>=Ut.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(r.forEach(({topicID:u,messageIDs:l})=>{!u||!l||!this.mesh.has(u)||l.forEach(f=>{let h=Nn.messageIdToString(f);this.seenCache.has(h)||o.set(h,f)})}),!o.size)return[];let a=o.size;a+s>Ut.GossipsubMaxIHaveLength&&(a=Ut.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return Nn.shuffle(c),c=c.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}_handleIWant(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,n),[];let i=new Map;return r.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let a=Nn.messageIdToString(o),[c,u]=this.messageCache.getForPeer(a,e);if(!!c){if(u>Ut.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}i.set(a,c)}})}),i.size?(this.log("IWANT: Sending %d messages to %s",i.size,e),Array.from(i.values()).map(RP.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,r){return Wi(this,void 0,void 0,function*(){let n=[],i=this.score.score(e),s=this._now(),o=this._options.doPX;return r.forEach(({topicID:a})=>{var c;if(!a)return;let u=this.mesh.get(a);if(!u){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),n.push(a),o=!1;return}let l=(c=this.backoff.get(a))===null||c===void 0?void 0:c.get(e);if(typeof l=="number"&&s<l){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let f=l+Ut.GossipsubGraftFloodThreshold-Ut.GossipsubPruneBackoff;s<f&&this.score.addPenalty(e,1),this._addBackoff(e,a),n.push(a);return}if(i<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,i,a),n.push(a),o=!1,this._addBackoff(e,a);return}if(u.size>=this._options.Dhi&&!this.outbound.get(e)){n.push(a),this._addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),u.add(e)}),n.length?Promise.all(n.map(a=>this._makePrune(e,a,o))):[]})}_handlePrune(e,r){let n=this.score.score(e);r.forEach(({topicID:i,backoff:s,peers:o})=>{if(!i)return;let a=this.mesh.get(i);if(!!a&&(this.log("PRUNE: Remove mesh link to %s in %s",e,i),this.score.prune(e,i),a.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,i,s*1e3):this._addBackoff(e,i),o&&o.length)){if(n<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,n,i);return}this._pxConnect(o)}})}_addBackoff(e,r){this._doAddBackoff(e,r,Ut.GossipsubPruneBackoff)}_doAddBackoff(e,r,n){let i=this.backoff.get(r);i||(i=new Map,this.backoff.set(r,i));let s=this._now()+n;(i.get(e)||0)<s&&i.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e)})}_clearBackoff(){if(this.heartbeatTicks%Ut.GossipsubPruneBackoffTicks!==0)return;let e=this._now();this.backoff.forEach((r,n)=>{r.forEach((i,s)=>{i<e&&r.delete(s)}),r.size===0&&this.backoff.delete(n)})}_directConnect(){if(this.heartbeatTicks%Ut.GossipsubDirectConnectTicks!==0)return;let e=[];this.direct.forEach(r=>{let n=this.peers.get(r);(!n||!n.isWritable)&&e.push(r)}),e.length&&e.forEach(r=>{this._connect(r)})}_pxConnect(e){return Wi(this,void 0,void 0,function*(){e.length>Ut.GossipsubPrunePeers&&(Nn.shuffle(e),e=e.slice(0,Ut.GossipsubPrunePeers));let r=[];yield Promise.all(e.map(n=>Wi(this,void 0,void 0,function*(){if(!n.peerID)return;let s=xP.createFromBytes(n.peerID).toB58String();if(!this.peers.has(s)){if(!n.signedPeerRecord){r.push(s);return}try{let o=yield o$e.openAndCertify(n.signedPeerRecord,"libp2p-peer-record"),a=o.peerId.toB58String();if(s!==a){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",a,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(s)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!r.length&&r.forEach(n=>this._connect(n))})}start(){let e=Object.create(null,{start:{get:()=>super.start}});return Wi(this,void 0,void 0,function*(){yield e.start.call(this),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(r=>{this._connect(r)})},Ut.GossipsubDirectConnectInitialDelay)})}stop(){let e=Object.create(null,{stop:{get:()=>super.stop}});return Wi(this,void 0,void 0,function*(){yield e.stop.call(this),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),clearTimeout(this._directPeerInitial)})}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(xP.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let r=this.fanout.get(e);if(r)r.forEach(n=>{this.score.score(n)<0&&r.delete(n)}),r.size<this._options.D&&M8.getGossipPeers(this,e,this._options.D-r.size,n=>!r.has(n)&&!this.direct.has(n)&&this.score.score(n)>=0).forEach(n=>r.add(n)),this.mesh.set(e,r),this.fanout.delete(e),this.lastpub.delete(e);else{let n=M8.getGossipPeers(this,e,this._options.D,i=>!this.direct.has(i)&&this.score.score(i)>=0);this.mesh.set(e,n)}this.mesh.get(e).forEach(n=>{this.log("JOIN: Add mesh link to %s in %s",n,e),this._sendGraft(n,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let r=this.mesh.get(e);r&&(r.forEach(n=>{this.log("LEAVE: Remove mesh link to %s in %s",n,e),this._sendPrune(n,e)}),this.mesh.delete(e))}getCanonicalMsgIdStr(e){var r,n;return Wi(this,void 0,void 0,function*(){return this.fastMsgIdCache&&this.getFastMsgIdStr?(n=(r=this.getCachedMsgIdStr(e))!==null&&r!==void 0?r:this.fastMsgIdCache.get(this.getFastMsgIdStr(e)))!==null&&n!==void 0?n:Nn.messageIdToString(yield this.getMsgId(e)):Nn.messageIdToString(yield this.getMsgId(e))})}getCachedMsgIdStr(e){}_publish(e){return Wi(this,void 0,void 0,function*(){let r=yield this.getCanonicalMsgIdStr(e);e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e,r),this.gossipTracer.deliverMessage(r)),this.seenCache.put(r),this.messageCache.put(e,r);let n=new Set;e.topicIDs.forEach(s=>{let o=this.topics.get(s);if(!!o)if(this._options.floodPublish&&e.from===this.peerId.toB58String())o.forEach(a=>{(this.direct.has(a)||this.score.score(a)>=this._options.scoreThresholds.publishThreshold)&&n.add(a)});else{this.direct.forEach(c=>{n.add(c)}),o.forEach(c=>{let u=this.score.score(c),l=this.peers.get(c);!l||l.protocol===Ut.FloodsubID&&u>=this._options.scoreThresholds.publishThreshold&&n.add(c)});let a=this.mesh.get(s);if(!a||!a.size){if(a=this.fanout.get(s),!a){let c=M8.getGossipPeers(this,s,this._options.D,u=>this.score.score(u)>=this._options.scoreThresholds.publishThreshold);c.size>0?(a=c,this.fanout.set(s,c)):a=new Set}this.lastpub.set(s,this._now())}a.forEach(c=>{n.add(c)})}});let i=Nn.createGossipRpc([RP.utils.normalizeOutRpcMessage(e)]);n.forEach(s=>{s!==e.from&&this._sendRpc(s,i)})})}_sendGraft(e,r){let n=[{topicID:r}],i=Nn.createGossipRpc([],{graft:n});this._sendRpc(e,i)}_sendPrune(e,r){return Wi(this,void 0,void 0,function*(){let n=[yield this._makePrune(e,r,this._options.doPX)],i=Nn.createGossipRpc([],{prune:n});this._sendRpc(e,i)})}_sendRpc(e,r){let n=this.peers.get(e);if(!n||!n.isWritable)return;let i=this.control.get(e);i&&(this._piggybackControl(e,r,i),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,r,s),this.gossip.delete(e)),n.write(IP.RPC.encode(r).finish())}_piggybackControl(e,r,n){let i=(n.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(n.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!i.length&&!s.length||(r.control?(r.control.graft=r.control.graft&&r.control.graft.concat(i),r.control.prune=r.control.prune&&r.control.prune.concat(s)):r.control={ihave:[],iwant:[],graft:i,prune:s})}_piggybackGossip(e,r,n){r.control||(r.control={ihave:[],iwant:[],graft:[],prune:[]}),r.control.ihave=n}_sendGraftPrune(e,r,n){return Wi(this,void 0,void 0,function*(){let i=this._options.doPX;for(let[s,o]of e){let a=o.map(f=>({topicID:f})),c=[],u=r.get(s);u&&(c=yield Promise.all(u.map(f=>this._makePrune(s,f,i&&!n.get(s)))),r.delete(s));let l=Nn.createGossipRpc([],{graft:a,prune:c});this._sendRpc(s,l)}for(let[s,o]of r){let a=yield Promise.all(o.map(u=>this._makePrune(s,u,i&&!n.get(s)))),c=Nn.createGossipRpc([],{prune:a});this._sendRpc(s,c)}})}_emitGossip(e,r){let n=this.messageCache.getGossipIDs(e);if(!n.length)return;Nn.shuffle(n),n.length>Ut.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length);let i=[],s=this.topics.get(e);if(!s)return;s.forEach(c=>{let u=this.peers.get(c);!u||!r.has(c)&&!this.direct.has(c)&&Nn.hasGossipProtocol(u.protocol)&&this.score.score(c)>=this._options.scoreThresholds.gossipThreshold&&i.push(c)});let o=this._options.Dlazy,a=Ut.GossipsubGossipFactor*i.length;a>o&&(o=a),o>i.length?o=i.length:Nn.shuffle(i),i.slice(0,o).forEach(c=>{let u=n;n.length>Ut.GossipsubMaxIHaveLength&&(u=Nn.shuffle(u.slice()).slice(0,Ut.GossipsubMaxIHaveLength)),this._pushGossip(c,{topicID:e,messageIDs:u})})}_flush(){for(let[e,r]of this.gossip.entries()){this.gossip.delete(e);let n=Nn.createGossipRpc([],{ihave:r});this._sendRpc(e,n)}for(let[e,r]of this.control.entries()){this.control.delete(e);let n=Nn.createGossipRpc([],{graft:r.graft,prune:r.prune});this._sendRpc(e,n)}}_pushGossip(e,r){this.log("Add gossip to %s",e);let n=this.gossip.get(e)||[];this.gossip.set(e,n.concat(r))}_now(){return Date.now()}_makePrune(e,r,n){return Wi(this,void 0,void 0,function*(){if(this.peers.get(e).protocol===Ut.GossipsubIDv10)return{topicID:r,peers:[]};let i=Ut.GossipsubPruneBackoff/1e3;if(!n)return{topicID:r,peers:[],backoff:i};let s=M8.getGossipPeers(this,r,Ut.GossipsubPrunePeers,a=>a!==e&&this.score.score(a)>=0),o=yield Promise.all(Array.from(s).map(a=>Wi(this,void 0,void 0,function*(){let c=xP.createFromB58String(a);return{peerID:c.toBytes(),signedPeerRecord:yield this._libp2p.peerStore.addressBook.getRawEnvelope(c)}})));return{topicID:r,peers:o,backoff:i}})}};CP.multicodec=Ut.GossipsubIDv11;nue.exports=CP});var iue,kP,sue=w(()=>{iue=A(OP(),1),kP={gossipsub:iue.default}});var hue=g((GSt,fue)=>{"use strict";var oue=ft(),{base58btc:a$e}=(wn(),se(Zo)),{default:c$e}=ia(),aue=uc(),uue=he(),bf=uue("libp2p-delegated-peer-routing");bf.error=uue("libp2p-delegated-peer-routing:error");var cue=3e4,u$e=4,lue=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this._client=e,this._httpQueue=new c$e({concurrency:u$e});let{protocol:r,host:n,port:i}=e.getEndpointConfig();bf(`enabled DelegatedPeerRouting via ${r}://${n}:${i}`)}async findPeer(e,r={}){let n=e;oue.isPeerId(n)&&(n=e.toB58String()),bf("findPeer starts: "+e),r.timeout=r.timeout||cue;try{return await this._httpQueue.add(async()=>{let{addrs:i}=await this._client.dht.findPeer(n,{timeout:r.timeout});return{id:e,multiaddrs:i}})}catch(i){if(i.message.includes("not found"))return;throw i}finally{bf("findPeer finished: "+e)}}async*getClosestPeers(e,r={}){let n=a$e.encode(e).substring(1);bf("getClosestPeers starts:",n),r.timeout=r.timeout||cue;let i=aue(),s=aue();this._httpQueue.add(()=>(i.resolve(),s.promise));try{await i.promise;for await(let o of this._client.dht.query(n,{timeout:r.timeout}))switch(o.type){case 1:for(let a of o.responses)yield{id:oue.parse(a.id),multiaddrs:a.addrs};break;default:bf("getClosestPeers unhandled response",o)}}catch(o){throw bf.error("getClosestPeers errored:",o),o}finally{s.resolve(),bf("getClosestPeers finished:",n)}}};fue.exports=lue});var wue=g((WSt,mue)=>{"use strict";var yue=he(),l$e=ft(),f$e=ls(),{default:due}=ia(),pue=uc(),_d=yue("libp2p-delegated-content-routing");_d.error=yue("libp2p-delegated-content-routing:error");var h$e=3e4,d$e=4,gue=class{constructor(e,r){if(e==null)throw new Error("missing self peerId");if(r==null)throw new Error("missing ipfs http client");this._client=r,this.peerId=e;let n={concurrency:d$e};this._httpQueue=new due(n),this._httpQueueRefs=new due(Object.assign({},n,{concurrency:2}));let{protocol:i,host:s,port:o}=r.getEndpointConfig();_d(`enabled DelegatedContentRouting via ${i}://${s}:${o}`)}async*findProviders(e,r={}){_d(`findProviders starts: ${e}`),r.timeout=r.timeout||h$e;let n=0,i=pue(),s=pue();this._httpQueue.add(()=>(i.resolve(),s.promise));try{await i.promise;for await(let{id:o,addrs:a}of this._client.dht.findProvs(e,{numProviders:r.numProviders,timeout:r.timeout}))yield{id:l$e.parse(o),multiaddrs:a},n++}catch(o){throw _d.error("findProviders errored:",o),o}finally{s.resolve(),_d(`findProviders finished: ${e} found ${n} providers`)}}async provide(e){_d(`provide starts: ${e}`),await this._httpQueueRefs.add(async()=>{await this._client.block.stat(e),await f$e(this._client.dht.provide(e))}),_d(`provide finished: ${e}`)}};mue.exports=gue});var p$e,Gm,DP=w(()=>{p$e=t=>Promise.reject(new Error(`No base found for "${t}"`)),Gm=class{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||p$e;for(let r of e.bases)this.addBase(r)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];let r=await this._loadBase(e);return this._basesByName[r.name]==null&&this._basesByPrefix[r.prefix]==null&&this.addBase(r),r}listBases(){return Object.values(this._basesByName)}}});var y$e,Wm,NP=w(()=>{y$e=t=>Promise.reject(new Error(`No codec found for "${t}"`)),Wm=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||y$e;for(let r of e.codecs)this.addCodec(r)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let r=typeof e=="string"?this._codecsByName:this._codecsByCode;if(r[e])return r[e];let n=await this._loadCodec(e);return r[e]==null&&this.addCodec(n),n}listCodecs(){return Object.values(this._codecsByName)}}});var g$e,Ym,BP=w(()=>{g$e=t=>Promise.reject(new Error(`No hasher found for "${t}"`)),Ym=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||g$e;for(let r of e.hashers)this.addHasher(r)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let r=typeof e=="string"?this._hashersByName:this._hashersByCode;if(r[e])return r[e];let n=await this._loadHasher(e);return r[e]==null&&this.addHasher(n),n}listHashers(){return Object.values(this._hashersByName)}}});function LP(t){try{t=(0,_ue.default)(new bue.Multiaddr(t))}catch{}return t=t.toString(),t}var bue,_ue,vue=w(()=>{bue=A(yt(),1),_ue=A(jw(),1)});var Eue,Sue=w(()=>{Eue=()=>{}});var MP,Pc,Iue,vd,Aue,m$e,w$e,b$e,_$e,v$e,E$e,S$e,Rue,A$e,Ed,iAt,U8=w(()=>{MP=A(yt(),1),Pc=A(Xy(),1);A2();Iue=A(he(),1),vd=A(Kp(),1);Fn();vue();Sue();Aue=(0,Iue.default)("ipfs-http-client:lib:error-handler"),m$e=Bt.bind({ignoreUndefined:!0}),w$e=Pc.isBrowser||Pc.isWebWorker?location.protocol:"http",b$e=Pc.isBrowser||Pc.isWebWorker?location.hostname:"localhost",_$e=Pc.isBrowser||Pc.isWebWorker?location.port:"5001",v$e=(t={})=>{let e,r={},n;if(typeof t=="string"||MP.Multiaddr.isMultiaddr(t))e=new URL(LP(t));else if(t instanceof URL)e=t;else if(typeof t.url=="string"||MP.Multiaddr.isMultiaddr(t.url))e=new URL(LP(t.url)),r=t;else if(t.url instanceof URL)e=t.url,r=t;else{r=t||{};let i=(r.protocol||w$e).replace(":",""),s=(r.host||b$e).split(":")[0],o=r.port||_$e;e=new URL(`${i}://${s}:${o}`)}if(r.apiPath?e.pathname=r.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),Pc.isNode){let i=Eue(e);n=r.agent||new i({keepAlive:!0,maxSockets:6})}return{...r,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:n}},E$e=async t=>{let e;try{if((t.headers.get("Content-Type")||"").startsWith("application/json")){let n=await t.json();Aue(n),e=n.Message||n.message}else e=await t.text()}catch(n){Aue("Failed to parse error response",n),e=n.message}let r=new vd.default.HTTPError(t);throw e&&(e.includes("deadline has elapsed")&&(r=new vd.default.TimeoutError),e&&e.includes("context deadline exceeded")&&(r=new vd.default.TimeoutError)),e&&e.includes("request timed out")&&(r=new vd.default.TimeoutError),e&&(r.message=e),r},S$e=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,Rue=t=>t.replace(S$e,function(e){return"-"+e.toLowerCase()}),A$e=t=>typeof t=="string"?hl(t):t,Ed=class extends vd.default{constructor(e={}){let r=v$e(e);super({timeout:A$e(r.timeout||0)||void 0,headers:r.headers,base:`${r.url}`,handleError:E$e,transformSearchParams:i=>{let s=new URLSearchParams;for(let[o,a]of i)a!=="undefined"&&a!=="null"&&o!=="signal"&&s.append(Rue(o),a),o==="timeout"&&!isNaN(a)&&s.append(Rue(o),a);return s},agent:r.agent});delete this.get,delete this.put,delete this.delete,delete this.options;let n=this.fetch;this.fetch=(i,s={})=>(typeof i=="string"&&!i.startsWith("/")&&(i=`${r.url}/${i}`),n.call(this,i,m$e(s,{method:"POST"})))}},iAt=vd.default.HTTPError});var q,ge=w(()=>{U8();q=t=>e=>t(new Ed(e),e)});function q8(t){if(t!=null)return typeof t=="string"?t:t.toString(8).padStart(4,"0")}var UP=w(()=>{});function F8(t){if(t==null)return;let e;if(t.secs!=null&&(e={secs:t.secs,nsecs:t.nsecs}),t.Seconds!=null&&(e={secs:t.Seconds,nsecs:t.FractionalNanoseconds}),Array.isArray(t)&&(e={secs:t[0],nsecs:t[1]}),t instanceof Date){let r=t.getTime(),n=Math.floor(r/1e3);e={secs:n,nsecs:(r-n*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw(0,Tue.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var Tue,qP=w(()=>{Tue=A(oe(),1)});function j({arg:t,searchParams:e,hashAlg:r,mtime:n,mode:i,...s}={}){e&&(s={...s,...e}),r&&(s.hash=r),n!=null&&(n=F8(n),s.mtime=n.secs,s.mtimeNsecs=n.nsecs),i!=null&&(s.mode=q8(i)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),t==null?t=[]:Array.isArray(t)||(t=[t]);let o=new URLSearchParams(s);return t.forEach(a=>o.append("arg",a)),o}var _e=w(()=>{UP();qP()});var xue,Pue=w(()=>{Se();ge();_e();xue=q(t=>{async function e(r={}){return((await(await t.post("bitswap/wantlist",{signal:r.signal,searchParams:j(r),headers:r.headers})).json()).Keys||[]).map(i=>L.parse(i["/"]))}return e})});var Cue,Oue=w(()=>{Se();ge();_e();Cue=q(t=>{async function e(r,n={}){return((await(await t.post("bitswap/wantlist",{signal:n.signal,searchParams:j({...n,peer:r.toString()}),headers:n.headers})).json()).Keys||[]).map(s=>L.parse(s["/"]))}return e})});function R$e(t){return{provideBufLen:t.ProvideBufLen,wantlist:(t.Wantlist||[]).map(e=>L.parse(e["/"])),peers:t.Peers||[],blocksReceived:BigInt(t.BlocksReceived),dataReceived:BigInt(t.DataReceived),blocksSent:BigInt(t.BlocksSent),dataSent:BigInt(t.DataSent),dupBlksReceived:BigInt(t.DupBlksReceived),dupDataReceived:BigInt(t.DupDataReceived)}}var K8,FP=w(()=>{Se();ge();_e();K8=q(t=>{async function e(r={}){let n=await t.post("bitswap/stat",{searchParams:j(r),signal:r.signal,headers:r.headers});return R$e(await n.json())}return e})});var kue,Due=w(()=>{ge();_e();kue=q(t=>{async function e(r,n={}){return(await t.post("bitswap/unwant",{signal:n.signal,searchParams:j({arg:r.toString(),...n}),headers:n.headers})).json()}return e})});function Nue(t){return{wantlist:xue(t),wantlistForPeer:Cue(t),unwant:kue(t),stat:K8(t)}}var Bue=w(()=>{Pue();Oue();FP();Due()});var j8,KP=w(()=>{ge();_e();j8=q(t=>{async function e(r,n={}){let i=await t.post("block/get",{signal:n.signal,searchParams:j({arg:r.toString(),...n}),headers:n.headers});return new Uint8Array(await i.arrayBuffer())}return e})});async function Kue(t){if(mo(t))return new Blob([t]);if(typeof t=="string"||t instanceof String)return new Blob([t.toString()]);if(lu(t))return t;if(fu(t)&&(t=(0,que.default)(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let e=(0,Uue.default)(t),{value:r,done:n}=await e.peek();if(n)return Lue(e);if(e.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await(0,Fue.default)(e))]);if(mo(r)||typeof r=="string"||r instanceof String)return Lue(e)}throw(0,Mue.default)(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT")}async function Lue(t){let e=[];for await(let r of t)e.push(r);return new Blob(e)}var Mue,Uue,que,Fue,jue=w(()=>{Mue=A(oe(),1),Uue=A(A0(),1),que=A(S0(),1),Fue=A(yo(),1);vg()});function Vue(t){return tw(t,Kue,!0)}var zue=w(()=>{jue();iR()});function Hue(t){if(t!=null)return typeof t=="string"?t:t.toString(8).padStart(4,"0")}var $ue=w(()=>{});async function Bn(t,e,r={}){let n=[],i=new FormData,s=0,o=0;for await(let{content:a,path:c,mode:u,mtime:l}of Vue(t)){let f="",h=a?"file":"dir";s>0&&(f=`-${s}`);let d=h+f,p=[];if(u!=null&&p.push(`mode=${Hue(u)}`),l!=null){let{secs:y,nsecs:b}=l;p.push(`mtime=${y}`),b!=null&&p.push(`mtime-nsecs=${b}`)}if(p.length&&(d=`${d}?${p.join("&")}`),a){i.set(d,a,c!=null?encodeURIComponent(c):void 0);let y=o+a.size;n.push({name:c,start:o,end:y}),o=y}else if(c!=null)i.set(d,new File([""],encodeURIComponent(c),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");s++}return{total:o,parts:n,headers:r,body:i}}var Ra=w(()=>{zue();$ue()});function I$e(t){return t.filter(Boolean)}function Ln(...t){return(0,Gue.anySignal)(I$e(t))}var Gue,Ia=w(()=>{Gue=A(na(),1)});var Wue,Yue=w(()=>{Se();Ra();ge();_e();Ia();Wue=q(t=>{async function e(r,n={}){let i=new AbortController,s=Ln(i.signal,n.signal),o;try{o=await(await t.post("block/put",{signal:s,searchParams:j(n),...await Bn([r],i,n.headers)})).json()}catch(a){if(n.format==="dag-pb")return e(r,{...n,format:"protobuf"});if(n.format==="dag-cbor")return e(r,{...n,format:"cbor"});throw a}return L.parse(o.Key)}return e})});function T$e(t){let e={cid:L.parse(t.Hash)};return t.Error&&(e.error=new Error(t.Error)),e}var Xue,Que=w(()=>{Se();ge();_e();Xue=q(t=>{async function*e(r,n={}){Array.isArray(r)||(r=[r]);let i=await t.post("block/rm",{signal:n.signal,searchParams:j({arg:r.map(s=>s.toString()),"stream-channels":!0,...n}),headers:n.headers});for await(let s of i.ndjson())yield T$e(s)}return e})});var Zue,Jue=w(()=>{Se();ge();_e();Zue=q(t=>{async function e(r,n={}){let s=await(await t.post("block/stat",{signal:n.signal,searchParams:j({arg:r.toString(),...n}),headers:n.headers})).json();return{cid:L.parse(s.Key),size:s.Size}}return e})});function ele(t){return{get:j8(t),put:Wue(t),rm:Xue(t),stat:Zue(t)}}var tle=w(()=>{KP();Yue();Que();Jue()});var rle,nle,ile=w(()=>{ge();_e();rle=A(yt(),1),nle=q(t=>{async function e(r,n={}){let i=await t.post("bootstrap/add",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers}),{Peers:s}=await i.json();return{Peers:s.map(o=>new rle.Multiaddr(o))}}return e})});var sle,ole,ale=w(()=>{ge();_e();sle=A(yt(),1),ole=q(t=>{async function e(r={}){let n=await t.post("bootstrap/rm",{signal:r.signal,searchParams:j({...r,all:!0}),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map(s=>new sle.Multiaddr(s))}}return e})});var cle,ule,lle=w(()=>{ge();_e();cle=A(yt(),1),ule=q(t=>{async function e(r={}){let n=await t.post("bootstrap/list",{signal:r.signal,searchParams:j(r),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map(s=>new cle.Multiaddr(s))}}return e})});var fle,hle,dle=w(()=>{ge();_e();fle=A(yt(),1),hle=q(t=>{async function e(r={}){let n=await t.post("bootstrap/add",{signal:r.signal,searchParams:j({...r,default:!0}),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map(s=>new fle.Multiaddr(s))}}return e})});var ple,yle,gle=w(()=>{ge();_e();ple=A(yt(),1),yle=q(t=>{async function e(r,n={}){let i=await t.post("bootstrap/rm",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers}),{Peers:s}=await i.json();return{Peers:s.map(o=>new ple.Multiaddr(o))}}return e})});function mle(t){return{add:nle(t),clear:ole(t),list:ule(t),reset:hle(t),rm:yle(t)}}var wle=w(()=>{ile();ale();lle();dle();gle()});var ble,_le=w(()=>{ge();_e();ble=q(t=>{async function e(r,n={}){let s=await(await t.post("config/profile/apply",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}return e})});function qt(t){if(t==null)return t;let e=/^[A-Z]+$/,r={};return Object.keys(t).reduce((n,i)=>(e.test(i)?n[i.toLowerCase()]=t[i]:e.test(i[0])?n[i[0].toLowerCase()+i.slice(1)]=t[i]:n[i]=t[i],n),r)}var $n=w(()=>{});var vle,Ele=w(()=>{$n();ge();_e();vle=q(t=>{async function e(r={}){return(await(await t.post("config/profile/list",{signal:r.signal,searchParams:j(r),headers:r.headers})).json()).map(s=>qt(s))}return e})});function Sle(t){return{apply:ble(t),list:vle(t)}}var Ale=w(()=>{_le();Ele()});var Rle,Ile=w(()=>{ge();_e();Rle=q(t=>async(r,n={})=>{if(!r)throw new Error("key argument is required");return(await(await t.post("config",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers})).json()).Value})});var Tle,xle=w(()=>{ge();_e();Tle=q(t=>async(r={})=>await(await t.post("config/show",{signal:r.signal,searchParams:j({...r}),headers:r.headers})).json())});var Ple,Cle=w(()=>{dt();Ra();ge();_e();Ia();Ple=q(t=>async(r,n={})=>{let i=new AbortController,s=Ln(i.signal,n.signal);await(await t.post("config/replace",{signal:s,searchParams:j(n),...await Bn([tt(JSON.stringify(r))],i,n.headers)})).text()})});var Ole,x$e,kle=w(()=>{ge();_e();Ole=q(t=>async(r,n,i={})=>{if(typeof r!="string")throw new Error("Invalid key type");let s={...i,...x$e(r,n)};await(await t.post("config",{signal:i.signal,searchParams:j(s),headers:i.headers})).text()}),x$e=(t,e)=>{switch(typeof e){case"boolean":return{arg:[t,e.toString()],bool:!0};case"string":return{arg:[t,e]};default:return{arg:[t,JSON.stringify(e)],json:!0}}}});function Dle(t){return{getAll:Tle(t),get:Rle(t),set:Ole(t),replace:Ple(t),profiles:Sle(t)}}var Nle=w(()=>{Ale();Ile();xle();Cle();kle()});var Ble,Lle=w(()=>{ge();_e();Ble=q(t=>{async function*e(r,n={}){yield*(await t.post("dag/export",{signal:n.signal,searchParams:j({arg:r.toString()}),headers:n.headers})).iterator()}return e})});async function*VP(t,e,r,n,i){let s=async u=>{let l=await r.getCodec(u.code),f=await n(u,i);return l.decode(f)},o=e.split("/").filter(Boolean),a=await s(t),c=t;for(;o.length;){let u=o.shift();if(!u)throw(0,jP.default)(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw(0,jP.default)(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");let l=L.asCID(a);l&&(c=l,a=await s(a))}yield{value:a,remainderPath:""}}var jP,Mle=w(()=>{Se();jP=A(oe(),1)});var Ule,qle,Fle,Kle,jle=w(()=>{ge();Mle();Ule=A(qh(),1),qle=A(os(),1),Fle=A(oe(),1);KP();Kle=(t,e)=>q((n,i)=>{let s=j8(i);return async(a,c={})=>{if(c.path){let d=c.localResolve?await(0,Ule.default)(VP(a,c.path,t,s,c)):await(0,qle.default)(VP(a,c.path,t,s,c));if(!d)throw(0,Fle.default)(new Error("Not found"),"ERR_NOT_FOUND");return d}let u=await t.getCodec(a.code),l=await s(a,c);return{value:u.decode(l),remainderPath:""}}})(e)});var Vle,zle=w(()=>{ge();_e();Ia();Ra();Se();Vle=q(t=>{async function*e(r,n={}){let i=new AbortController,s=Ln(i.signal,n.signal),{headers:o,body:a}=await Bn(r,i,n.headers),c=await t.post("dag/import",{signal:s,headers:o,body:a,searchParams:j({"pin-roots":n.pinRoots})});for await(let{Root:u}of c.ndjson())if(u!==void 0){let{Cid:{"/":l},PinErrorMsg:f}=u;yield{root:{cid:L.parse(l),pinErrorMsg:f}}}}return e})});var V8,zP=w(()=>{Se();ge();Ra();_e();Ia();V8=(t,e)=>q(n=>async(s,o={})=>{let a={storeCodec:"dag-cbor",hashAlg:"sha2-256",...o},c;if(a.inputCodec){if(!(s instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");c=s}else c=(await t.getCodec(a.storeCodec)).encode(s),a.inputCodec=a.storeCodec;let u=new AbortController,l=Ln(u.signal,a.signal),h=await(await n.post("dag/put",{timeout:a.timeout,signal:l,searchParams:j(a),...await Bn([c],u,a.headers)})).json();return L.parse(h.Cid["/"])})(e)});var Hle,$le=w(()=>{Se();ge();_e();Hle=q(t=>async(r,n={})=>{let s=await(await t.post("dag/resolve",{signal:n.signal,searchParams:j({arg:`${r}${n.path?`/${n.path}`.replace(/\/[/]+/g,"/"):""}`,...n}),headers:n.headers})).json();return{cid:L.parse(s.Cid["/"]),remainderPath:s.RemPath}})});function Gle(t,e){return{export:Ble(e),get:Kle(t,e),import:Vle(e),put:V8(t,e),resolve:Hle(e)}}var Wle=w(()=>{Lle();jle();zle();zP();$le()});var Yle=w(()=>{});var Xm,Po,Sd=w(()=>{dt();Yle();Xm=A(yt(),1),Po=t=>{if(t.Type===0)return{to:t.ID,name:"SENDING_QUERY",type:t.Type};if(t.Type===1)return{from:t.ID,name:"PEER_RESPONSE",type:t.Type,messageType:0,messageName:"PUT_VALUE",closer:(t.Responses||[]).map(({ID:e,Addrs:r})=>({id:e,multiaddrs:r.map(n=>new Xm.Multiaddr(n))})),providers:(t.Responses||[]).map(({ID:e,Addrs:r})=>({id:e,multiaddrs:r.map(n=>new Xm.Multiaddr(n))}))};if(t.Type===2){let e={id:t.ID,multiaddrs:[]};return t.Responses&&t.Responses.length&&(e={id:t.Responses[0].ID,multiaddrs:t.Responses[0].Addrs.map(r=>new Xm.Multiaddr(r))}),{from:t.ID,name:"FINAL_PEER",type:t.Type,peer:e}}if(t.Type===3)return{from:t.ID,name:"QUERY_ERROR",type:t.Type,error:new Error(t.Extra)};if(t.Type===4)return{from:t.ID,name:"PROVIDER",type:t.Type,providers:t.Responses.map(({ID:e,Addrs:r})=>({id:e,multiaddrs:r.map(n=>new Xm.Multiaddr(n))}))};if(t.Type===5)return{from:t.ID,name:"VALUE",type:t.Type,value:tt(t.Extra,"base64pad")};if(t.Type===6){let e=t.Responses.map(({ID:r})=>r);if(!e.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:t.Type,peer:e[0]}}if(t.Type===7)return{name:"DIALING_PEER",type:t.Type,peer:t.ID};throw new Error("Unknown DHT event type")}});var Xle,Qle=w(()=>{ge();_e();Sd();Xle=q(t=>{async function*e(r,n={}){let i=await t.post("dht/findpeer",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers});for await(let s of i.ndjson())yield Po(s)}return e})});var Zle,Jle=w(()=>{ge();_e();Sd();Zle=q(t=>{async function*e(r,n={}){let i=await t.post("dht/findprovs",{signal:n.signal,searchParams:j({arg:r.toString(),...n}),headers:n.headers});for await(let s of i.ndjson())yield Po(s)}return e})});var efe,tfe=w(()=>{ge();_e();Sd();st();efe=q(t=>{async function*e(r,n={}){let i=await t.post("dht/get",{signal:n.signal,searchParams:j({arg:r instanceof Uint8Array?Xe(r):r.toString(),...n}),headers:n.headers});for await(let s of i.ndjson())yield Po(s)}return e})});var rfe,nfe=w(()=>{ge();_e();Sd();rfe=q(t=>{async function*e(r,n={recursive:!1}){let i=Array.isArray(r)?r:[r],s=await t.post("dht/provide",{signal:n.signal,searchParams:j({arg:i.map(o=>o.toString()),...n}),headers:n.headers});for await(let o of s.ndjson())yield Po(o)}return e})});var ife,sfe=w(()=>{ge();_e();Ra();Ia();st();Sd();ife=q(t=>{async function*e(r,n,i={}){let s=new AbortController,o=Ln(s.signal,i.signal),a=await t.post("dht/put",{signal:o,searchParams:j({arg:r instanceof Uint8Array?Xe(r):r.toString(),...i}),...await Bn([n],s,i.headers)});for await(let c of a.ndjson())yield Po(c)}return e})});var ofe,afe=w(()=>{ge();_e();Sd();ofe=q(t=>{async function*e(r,n={}){let i=await t.post("dht/query",{signal:n.signal,searchParams:j({arg:r.toString(),...n}),headers:n.headers});for await(let s of i.ndjson())yield Po(s)}return e})});function cfe(t){return{findPeer:Xle(t),findProvs:Zle(t),get:efe(t),provide:rfe(t),put:ife(t),query:ofe(t)}}var ufe=w(()=>{Qle();Jle();tfe();nfe();sfe();afe()});var lfe,ffe=w(()=>{ge();_e();lfe=q(t=>{async function e(r={}){return(await t.post("diag/cmds",{signal:r.signal,searchParams:j(r),headers:r.headers})).json()}return e})});var hfe,dfe=w(()=>{ge();_e();hfe=q(t=>{async function e(r={}){return(await t.post("diag/net",{signal:r.signal,searchParams:j(r),headers:r.headers})).json()}return e})});var pfe,yfe=w(()=>{ge();_e();pfe=q(t=>{async function e(r={}){return(await t.post("diag/sys",{signal:r.signal,searchParams:j(r),headers:r.headers})).json()}return e})});function gfe(t){return{cmds:lfe(t),net:hfe(t),sys:pfe(t)}}var mfe=w(()=>{ffe();dfe();yfe()});var wfe,bfe=w(()=>{ge();_e();wfe=q(t=>{async function e(r,n,i={}){await(await t.post("files/chmod",{signal:i.signal,searchParams:j({arg:r,mode:n,...i}),headers:i.headers})).text()}return e})});var _fe,vfe=w(()=>{Se();ge();_e();_fe=q(t=>{async function e(r,n,i={}){let s=Array.isArray(r)?r:[r];await(await t.post("files/cp",{signal:i.signal,searchParams:j({arg:s.concat(n).map(a=>L.asCID(a)?`/ipfs/${a}`:a),...i}),headers:i.headers})).text()}return e})});var Efe,Sfe=w(()=>{Se();ge();_e();Efe=q(t=>{async function e(r,n={}){if(!r||typeof r!="string")throw new Error("ipfs.files.flush requires a path");let s=await(await t.post("files/flush",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers})).json();return L.parse(s.Cid)}return e})});function Qm(t){let e=qt(t);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}var HP=w(()=>{$n()});function Afe(t){return t.hash&&(t.cid=L.parse(t.hash)),delete t.hash,t.type=t.type===1?"directory":"file",t}var Rfe,Ife=w(()=>{Se();HP();ge();_e();Rfe=q(t=>{async function*e(r,n={}){if(!r)throw new Error("ipfs.files.ls requires a path");let i=await t.post("files/ls",{signal:n.signal,searchParams:j({arg:L.asCID(r)?`/ipfs/${r}`:r,long:!0,...n,stream:!0}),headers:n.headers});for await(let s of i.ndjson())if("Entries"in s)for(let o of s.Entries||[])yield Afe(Qm(o));else yield Afe(Qm(s))}return e})});var Tfe,xfe=w(()=>{ge();_e();Tfe=q(t=>{async function e(r,n={}){await(await t.post("files/mkdir",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers})).text()}return e})});var Pfe,Cfe=w(()=>{ge();_e();Pfe=q(t=>{async function e(r,n,i={}){Array.isArray(r)||(r=[r]),await(await t.post("files/mv",{signal:i.signal,searchParams:j({arg:r.concat(n),...i}),headers:i.headers})).text()}return e})});var Zm=g((uxt,Ofe)=>{Ofe.exports=t=>{if(t[Symbol.asyncIterator])return t;if(t.getReader)return async function*(){let e=t.getReader();try{for(;;){let{done:r,value:n}=await e.read();if(r)return;yield n}}finally{e.releaseLock()}}();throw new Error("unknown stream")}});var kfe,Dfe,Nfe=w(()=>{ge();_e();kfe=A(Zm(),1),Dfe=q(t=>{async function*e(r,n={}){let i=await t.post("files/read",{signal:n.signal,searchParams:j({arg:r,count:n.length,...n}),headers:n.headers});yield*(0,kfe.default)(i.body)}return e})});var Bfe,Lfe,Mfe=w(()=>{ge();_e();Bfe=A(Kp(),1),Lfe=q(t=>{async function e(r,n={}){let i=await t.post("files/rm",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers}),s=await i.text();if(s!==""){let o=new Bfe.default.HTTPError(i);throw o.message=s,o}}return e})});function M$e(t){return t.cid=L.parse(t.hash),delete t.hash,t}var z8,$P=w(()=>{Se();HP();ge();_e();z8=q(t=>{async function e(r,n={}){let s=await(await t.post("files/stat",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers})).json();return s.WithLocality=s.WithLocality||!1,M$e(Qm(s))}return e})});var Ufe,qfe=w(()=>{ge();_e();Ufe=q(t=>{async function e(r,n={}){await(await t.post("files/touch",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers})).text()}return e})});var Ffe,Kfe=w(()=>{UP();qP();ge();Ra();_e();Ia();Ffe=q(t=>{async function e(r,n,i={}){let s=new AbortController,o=Ln(s.signal,i.signal);await(await t.post("files/write",{signal:o,searchParams:j({arg:r,streamChannels:!0,count:i.length,...i}),...await Bn([{content:n,path:"arg",mode:q8(i.mode),mtime:F8(i.mtime)}],s,i.headers)})).text()}return e})});function jfe(t){return{chmod:wfe(t),cp:_fe(t),flush:Efe(t),ls:Rfe(t),mkdir:Tfe(t),mv:Pfe(t),read:Dfe(t),rm:Lfe(t),stat:z8(t),touch:Ufe(t),write:Ffe(t)}}var Vfe=w(()=>{bfe();vfe();Sfe();Ife();xfe();Cfe();Nfe();Mfe();$P();qfe();Kfe()});var zfe,Hfe,$fe=w(()=>{ge();zfe=A(oe(),1),Hfe=q(t=>async(r,n,i={})=>{throw(0,zfe.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var Gfe,Wfe=w(()=>{$n();ge();_e();Gfe=q(t=>{async function e(r,n={type:"rsa",size:2048}){let s=await(await t.post("key/gen",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers})).json();return qt(s)}return e})});var Yfe,Xfe=w(()=>{$n();ge();_e();Yfe=q(t=>{async function e(r,n,i,s={}){let a=await(await t.post("key/import",{signal:s.signal,searchParams:j({arg:r,pem:n,password:i,...s}),headers:s.headers})).json();return qt(a)}return e})});var Qfe,Zfe,Jfe=w(()=>{ge();Qfe=A(oe(),1),Zfe=q(t=>async(r,n={})=>{throw(0,Qfe.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var ehe,the=w(()=>{$n();ge();_e();ehe=q(t=>{async function e(r={}){return((await(await t.post("key/list",{signal:r.signal,searchParams:j(r),headers:r.headers})).json()).Keys||[]).map(s=>qt(s))}return e})});var rhe,nhe=w(()=>{$n();ge();_e();rhe=q(t=>{async function e(r,n,i={}){let s=await t.post("key/rename",{signal:i.signal,searchParams:j({arg:[r,n],...i}),headers:i.headers});return qt(await s.json())}return e})});var ihe,she=w(()=>{$n();ge();_e();ihe=q(t=>{async function e(r,n={}){let s=await(await t.post("key/rm",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers})).json();return qt(s.Keys[0])}return e})});function ohe(t){return{export:Hfe(t),gen:Gfe(t),import:Yfe(t),info:Zfe(t),list:ehe(t),rename:rhe(t),rm:ihe(t)}}var ahe=w(()=>{$fe();Wfe();Xfe();Jfe();the();nhe();she()});var che,uhe=w(()=>{$n();ge();_e();che=q(t=>{async function e(r,n,i={}){let s=await t.post("log/level",{signal:i.signal,searchParams:j({arg:[r,n],...i}),headers:i.headers});return qt(await s.json())}return e})});var lhe,fhe=w(()=>{ge();_e();lhe=q(t=>{async function e(r={}){return(await(await t.post("log/ls",{signal:r.signal,searchParams:j(r),headers:r.headers})).json()).Strings}return e})});var hhe,dhe=w(()=>{ge();_e();hhe=q(t=>{async function*e(r={}){yield*(await t.post("log/tail",{signal:r.signal,searchParams:j(r),headers:r.headers})).ndjson()}return e})});function phe(t){return{level:che(t),ls:lhe(t),tail:hhe(t)}}var yhe=w(()=>{uhe();fhe();dhe()});var ghe,mhe=w(()=>{$n();ge();_e();ghe=q(t=>{async function e(r,n={}){let i=await t.post("name/publish",{signal:n.signal,searchParams:j({arg:`${r}`,...n}),headers:n.headers});return qt(await i.json())}return e})});var whe,bhe=w(()=>{ge();_e();whe=q(t=>{async function*e(r,n={}){let i=await t.post("name/resolve",{signal:n.signal,searchParams:j({arg:r,stream:!0,...n}),headers:n.headers});for await(let s of i.ndjson())yield s.Path}return e})});var _he,vhe=w(()=>{$n();ge();_e();_he=q(t=>{async function e(r,n={}){let i=await t.post("name/pubsub/cancel",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers});return qt(await i.json())}return e})});var Ehe,She=w(()=>{$n();ge();_e();Ehe=q(t=>{async function e(r={}){let n=await t.post("name/pubsub/state",{signal:r.signal,searchParams:j(r),headers:r.headers});return qt(await n.json())}return e})});var Ahe,Rhe=w(()=>{ge();_e();Ahe=q(t=>{async function e(r={}){return(await(await t.post("name/pubsub/subs",{signal:r.signal,searchParams:j(r),headers:r.headers})).json()).Strings||[]}return e})});function Ihe(t){return{cancel:_he(t),state:Ehe(t),subs:Ahe(t)}}var The=w(()=>{vhe();She();Rhe()});function xhe(t){return{publish:ghe(t),resolve:whe(t),pubsub:Ihe(t)}}var Phe=w(()=>{mhe();bhe();The()});var Che,Ohe=w(()=>{Se();ge();_e();Che=q(t=>{async function e(r,n={}){let s=await(await t.post("object/data",{signal:n.signal,searchParams:j({arg:`${r instanceof Uint8Array?L.decode(r):r}`,...n}),headers:n.headers})).arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return e})});var khe,Dhe=w(()=>{Se();ge();_e();dt();khe=q(t=>{async function e(r,n={}){let s=await(await t.post("object/get",{signal:n.signal,searchParams:j({arg:`${r instanceof Uint8Array?L.decode(r):r}`,dataEncoding:"base64",...n}),headers:n.headers})).json();return{Data:tt(s.Data,"base64pad"),Links:(s.Links||[]).map(o=>({Name:o.Name,Hash:L.parse(o.Hash),Tsize:o.Size}))}}return e})});var Nhe,Bhe=w(()=>{Se();ge();_e();Nhe=q(t=>{async function e(r,n={}){return((await(await t.post("object/links",{signal:n.signal,searchParams:j({arg:`${r instanceof Uint8Array?L.decode(r):r}`,...n}),headers:n.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:L.parse(o.Hash)}))}return e})});var Lhe,Mhe=w(()=>{Se();ge();_e();Lhe=q(t=>{async function e(r={}){let n=await t.post("object/new",{signal:r.signal,searchParams:j({arg:r.template,...r}),headers:r.headers}),{Hash:i}=await n.json();return L.parse(i)}return e})});var Uhe,qhe=w(()=>{ge();zP();Uhe=(t,e)=>q(n=>{let i=V8(t,e);async function s(o,a={}){return i(o,{...a,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return s})(e)});var Fhe,Khe=w(()=>{Se();ge();_e();Fhe=q(t=>{async function e(r,n={}){let s=await(await t.post("object/stat",{signal:n.signal,searchParams:j({arg:`${r}`,...n}),headers:n.headers})).json();return{...s,Hash:L.parse(s.Hash)}}return e})});var jhe,Vhe=w(()=>{Se();ge();_e();jhe=q(t=>{async function e(r,n,i={}){let s=await t.post("object/patch/add-link",{signal:i.signal,searchParams:j({arg:[`${r}`,n.Name||n.name||"",(n.Hash||n.cid||"").toString()||null],...i}),headers:i.headers}),{Hash:o}=await s.json();return L.parse(o)}return e})});var zhe,Hhe=w(()=>{Se();Ra();ge();_e();Ia();zhe=q(t=>{async function e(r,n,i={}){let s=new AbortController,o=Ln(s.signal,i.signal),a=await t.post("object/patch/append-data",{signal:o,searchParams:j({arg:`${r}`,...i}),...await Bn([n],s,i.headers)}),{Hash:c}=await a.json();return L.parse(c)}return e})});var $he,Ghe=w(()=>{Se();ge();_e();$he=q(t=>{async function e(r,n,i={}){let s=await t.post("object/patch/rm-link",{signal:i.signal,searchParams:j({arg:[`${r}`,n.Name||n.name||null],...i}),headers:i.headers}),{Hash:o}=await s.json();return L.parse(o)}return e})});var Whe,Yhe=w(()=>{Se();Ra();ge();_e();Ia();Whe=q(t=>{async function e(r,n,i={}){let s=new AbortController,o=Ln(s.signal,i.signal),a=await t.post("object/patch/set-data",{signal:o,searchParams:j({arg:[`${r}`],...i}),...await Bn([n],s,i.headers)}),{Hash:c}=await a.json();return L.parse(c)}return e})});function Xhe(t){return{addLink:jhe(t),appendData:zhe(t),rmLink:$he(t),setData:Whe(t)}}var Qhe=w(()=>{Vhe();Hhe();Ghe();Yhe()});function Zhe(t,e){return{data:Che(e),get:khe(e),links:Nhe(e),new:Lhe(e),put:Uhe(t,e),stat:Fhe(e),patch:Xhe(e)}}var Jhe=w(()=>{Ohe();Dhe();Bhe();Mhe();qhe();Khe();Qhe()});var H8,GP=w(()=>{Se();ge();i0();_e();H8=q(t=>{async function*e(r,n={}){for await(let{path:i,recursive:s,metadata:o}of sc(r)){let a=await t.post("pin/add",{signal:n.signal,searchParams:j({...n,arg:i,recursive:s,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:n.headers});for await(let c of a.ndjson()){if(c.Pins){for(let u of c.Pins)yield L.parse(u);continue}yield L.parse(c)}}}return e})});function tde(t){let e=H8(t);return q(()=>{async function r(n,i={}){return(0,ede.default)(e([{path:n,...i}],i))}return r})(t)}var ede,rde=w(()=>{GP();ede=A(os(),1);ge()});function nde(t,e,r){let n={type:t,cid:L.parse(e)};return r&&(n.metadata=r),n}var ide,sde=w(()=>{Se();ge();_e();ide=q(t=>{async function*e(r={}){let n=[];r.paths&&(n=Array.isArray(r.paths)?r.paths:[r.paths]);let i=await t.post("pin/ls",{signal:r.signal,searchParams:j({...r,arg:n.map(s=>`${s}`),stream:!0}),headers:r.headers});for await(let s of i.ndjson()){if(s.Keys){for(let o of Object.keys(s.Keys))yield nde(s.Keys[o].Type,o,s.Keys[o].Metadata);return}yield nde(s.Type,s.Cid,s.Metadata)}}return e})});var $8,WP=w(()=>{Se();ge();i0();_e();$8=q(t=>{async function*e(r,n={}){for await(let{path:i,recursive:s}of sc(r)){let o=new URLSearchParams(n.searchParams);o.append("arg",`${i}`),s!=null&&o.set("recursive",String(s));let a=await t.post("pin/rm",{signal:n.signal,headers:n.headers,searchParams:j({...n,arg:`${i}`,recursive:s})});for await(let c of a.ndjson()){if(c.Pins){yield*c.Pins.map(u=>L.parse(u));continue}yield L.parse(c)}}}return e})});var ode,ade,cde=w(()=>{WP();ode=A(os(),1);ge();ade=t=>{let e=$8(t);return q(()=>{async function r(n,i={}){return(0,ode.default)(e([{path:n,...i}],i))}return r})(t)}});var G8,ude,lde,K1,fde,Jm=w(()=>{Se();_e();G8=({Name:t,Status:e,Cid:r})=>({cid:L.parse(r),name:t,status:e}),ude=t=>{if(typeof t=="string"&&t!=="")return t;throw new TypeError("service name must be passed")},lde=t=>{if(L.asCID(t))return t.toString();throw new TypeError(`CID instance expected instead of ${typeof t}`)},K1=({service:t,cid:e,name:r,status:n,all:i})=>{let s=j({service:ude(t),name:r,force:i?!0:void 0});if(e)for(let o of e)s.append("cid",lde(o));if(n)for(let o of n)s.append("status",o);return s},fde=({cid:t,service:e,background:r,name:n,origins:i})=>{let s=j({arg:lde(t),service:ude(e),name:n,background:r?!0:void 0});if(i)for(let o of i)s.append("origin",o.toString());return s}});function hde(t){async function e(r,{timeout:n,signal:i,headers:s,...o}){let a=await t.post("pin/remote/add",{timeout:n,signal:i,headers:s,searchParams:fde({cid:r,...o})});return G8(await a.json())}return e}var dde=w(()=>{Jm()});function pde(t){async function*e({timeout:r,signal:n,headers:i,...s}){let o=await t.post("pin/remote/ls",{timeout:r,signal:n,headers:i,searchParams:K1(s)});for await(let a of o.ndjson())yield G8(a)}return e}var yde=w(()=>{Jm()});function gde(t){async function e({timeout:r,signal:n,headers:i,...s}){await t.post("pin/remote/rm",{timeout:r,signal:n,headers:i,searchParams:K1({...s,all:!1})})}return e}var mde=w(()=>{Jm()});function wde(t){async function e({timeout:r,signal:n,headers:i,...s}){await t.post("pin/remote/rm",{timeout:r,signal:n,headers:i,searchParams:K1({...s,all:!0})})}return e}var bde=w(()=>{Jm()});function _de(t){let e=String(t);if(e==="undefined")throw Error("endpoint is required");return e[e.length-1]==="/"?e.slice(0,-1):e}function vde(t){return{service:t.Service,endpoint:new URL(t.ApiEndpoint),...t.Stat&&{stat:U$e(t.Stat)}}}function U$e(t){switch(t.Status){case"valid":{let{Pinning:e,Pinned:r,Queued:n,Failed:i}=t.PinCount;return{status:"valid",pinCount:{queued:n,pinning:e,pinned:r,failed:i}}}case"invalid":return{status:"invalid"};default:return{status:t.Status}}}var YP=w(()=>{});function Ede(t){async function e(r,n){let{endpoint:i,key:s,headers:o,timeout:a,signal:c}=n;await t.post("pin/remote/service/add",{timeout:a,signal:c,searchParams:j({arg:[r,_de(i),s]}),headers:o})}return e}var Sde=w(()=>{_e();YP()});function Ade(t){async function e(r={}){let{stat:n,headers:i,timeout:s,signal:o}=r,a=await t.post("pin/remote/service/ls",{timeout:s,signal:o,headers:i,searchParams:n===!0?j({stat:n}):void 0}),{RemoteServices:c}=await a.json();return c.map(vde)}return e}var Rde=w(()=>{_e();YP()});function Ide(t){async function e(r,n={}){await t.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:j({arg:r})})}return e}var Tde=w(()=>{_e()});function xde(t){let e=new Ed(t);return{add:Ede(e),ls:Ade(e),rm:Ide(e)}}var Pde=w(()=>{U8();Sde();Rde();Tde()});function Cde(t){let e=new Ed(t);return{add:hde(e),ls:pde(e),rm:gde(e),rmAll:wde(e),service:xde(t)}}var Ode=w(()=>{U8();dde();yde();mde();bde();Pde()});function kde(t){return{addAll:H8(t),add:tde(t),ls:ide(t),rmAll:$8(t),rm:ade(t),remote:Cde(t)}}var Dde=w(()=>{GP();rde();sde();WP();cde();Ode()});var W8,q$e,Y8,j1,e3=w(()=>{dt();st();ol();W8=t=>Array.isArray(t)?t.map(q$e):t,q$e=t=>Xe(Y8(t)),Y8=t=>z4.decode(t),j1=t=>z4.encode(tt(t))});var Nde,Bde=w(()=>{ge();_e();e3();Nde=q(t=>{async function e(r={}){let{Strings:n}=await(await t.post("pubsub/ls",{signal:r.signal,searchParams:j(r),headers:r.headers})).json();return W8(n)||[]}return e})});var Lde,Mde=w(()=>{ge();_e();e3();Lde=q(t=>{async function e(r,n={}){let i=await t.post("pubsub/peers",{signal:n.signal,searchParams:j({arg:j1(r),...n}),headers:n.headers}),{Strings:s}=await i.json();return s||[]}return e})});var Ude,qde=w(()=>{ge();_e();Ra();Ia();e3();Ude=q(t=>{async function e(r,n,i={}){let s=j({arg:j1(r),...i}),o=new AbortController,a=Ln(o.signal,i.signal);await(await t.post("pubsub/pub",{signal:a,searchParams:s,...await Bn([n],o,i.headers)})).text()}return e})});async function K$e(t,{onMessage:e,onEnd:r,onError:n}){n=n||F$e;try{for await(let i of t.ndjson())try{if(!i.from)continue;e({from:i.from,data:Y8(i.data),seqno:Y8(i.seqno),topicIDs:W8(i.topicIDs)})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,n(s,!1,i)}}catch(i){j$e(i)||n(i,!0)}finally{r()}}var Fde,F$e,Kde,j$e,jde=w(()=>{Fde=A(he(),1);ge();_e();e3();F$e=(0,Fde.default)("ipfs-http-client:pubsub:subscribe"),Kde=(t,e)=>q(r=>{async function n(i,s,o={}){o.signal=e.subscribe(i,s,o.signal);let a,c,u=new Promise((f,h)=>{a=f,c=h}),l=setTimeout(()=>a(),1e3);return r.post("pubsub/sub",{signal:o.signal,searchParams:j({arg:j1(i),...o}),headers:o.headers}).catch(f=>{e.unsubscribe(i,s),c(f)}).then(f=>{clearTimeout(l),!!f&&(K$e(f,{onMessage:s,onEnd:()=>e.unsubscribe(i,s),onError:o.onError}),a())}),u}return n})(t);j$e=t=>{switch(t.type){case"aborted":return!0;case"abort":return!0;default:return t.name==="AbortError"}}});var Vde,zde=w(()=>{Vde=(t,e)=>{async function r(n,i){e.unsubscribe(n,i)}return r}});var XP,Hde=w(()=>{XP=class{constructor(){this._subs=new Map}subscribe(e,r,n){let i=this._subs.get(e)||[];if(i.find(o=>o.handler===r))throw new Error(`Already subscribed to ${e} with this handler`);let s=new AbortController;return this._subs.set(e,[{handler:r,controller:s}].concat(i)),n&&n.addEventListener("abort",()=>this.unsubscribe(e,r)),s.signal}unsubscribe(e,r){let n=this._subs.get(e)||[],i;r?(this._subs.set(e,n.filter(s=>s.handler!==r)),i=n.filter(s=>s.handler===r)):(this._subs.set(e,[]),i=n),(this._subs.get(e)||[]).length||this._subs.delete(e),i.forEach(s=>s.controller.abort())}}});function $de(t){let e=new XP;return{ls:Nde(t),peers:Lde(t),publish:Ude(t),subscribe:Kde(t,e),unsubscribe:Vde(t,e)}}var Gde=w(()=>{Bde();Mde();qde();jde();zde();Hde()});var Wde,Yde=w(()=>{$n();ge();_e();Wde=q(t=>{async function*e(r={}){yield*(await t.post("refs/local",{signal:r.signal,transform:qt,searchParams:j(r),headers:r.headers})).ndjson()}return e})});var Xde,Qde=w(()=>{Se();$n();ge();_e();Yde();Xde=q((t,e)=>Object.assign(async function*(n,i={}){let s=Array.isArray(n)?n:[n];yield*(await t.post("refs",{signal:i.signal,searchParams:j({arg:s.map(a=>`${a instanceof Uint8Array?L.decode(a):a}`),...i}),headers:i.headers,transform:qt})).ndjson()},{local:Wde(e)}))});var Zde,Jde=w(()=>{Se();ge();_e();Zde=q(t=>{async function*e(r={}){yield*(await t.post("repo/gc",{signal:r.signal,searchParams:j(r),headers:r.headers,transform:i=>({err:i.Error?new Error(i.Error):null,cid:(i.Key||{})["/"]?L.parse(i.Key["/"]):null})})).ndjson()}return e})});var X8,QP=w(()=>{ge();_e();X8=q(t=>{async function e(r={}){let i=await(await t.post("repo/stat",{signal:r.signal,searchParams:j(r),headers:r.headers})).json();return{numObjects:BigInt(i.NumObjects),repoSize:BigInt(i.RepoSize),repoPath:i.RepoPath,version:i.Version,storageMax:BigInt(i.StorageMax)}}return e})});var epe,tpe=w(()=>{ge();_e();epe=q(t=>{async function e(r={}){return(await(await t.post("repo/version",{signal:r.signal,searchParams:j(r),headers:r.headers})).json()).Version}return e})});function rpe(t){return{gc:Zde(t),stat:X8(t),version:epe(t)}}var npe=w(()=>{Jde();QP();tpe()});var ipe,spe=w(()=>{ge();_e();ipe=q(t=>{async function*e(r={}){yield*(await t.post("stats/bw",{signal:r.signal,searchParams:j(r),headers:r.headers,transform:i=>({totalIn:BigInt(i.TotalIn),totalOut:BigInt(i.TotalOut),rateIn:parseFloat(i.RateIn),rateOut:parseFloat(i.RateOut)})})).ndjson()}return e})});function ope(t){return{bitswap:K8(t),repo:X8(t),bw:ipe(t)}}var ape=w(()=>{FP();QP();spe()});var cpe,upe,lpe=w(()=>{cpe=A(yt(),1);ge();_e();upe=q(t=>{async function e(r={}){let n=await t.post("swarm/addrs",{signal:r.signal,searchParams:j(r),headers:r.headers}),{Addrs:i}=await n.json();return Object.keys(i).map(s=>({id:s,addrs:(i[s]||[]).map(o=>new cpe.Multiaddr(o))}))}return e})});var fpe,hpe=w(()=>{ge();_e();fpe=q(t=>{async function e(r,n={}){let i=await t.post("swarm/connect",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers}),{Strings:s}=await i.json();return s||[]}return e})});var dpe,ppe=w(()=>{ge();_e();dpe=q(t=>{async function e(r,n={}){let i=await t.post("swarm/disconnect",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers}),{Strings:s}=await i.json();return s||[]}return e})});var ype,gpe,mpe=w(()=>{ype=A(yt(),1);ge();_e();gpe=q(t=>{async function e(r={}){let n=await t.post("swarm/addrs/local",{signal:r.signal,searchParams:j(r),headers:r.headers}),{Strings:i}=await n.json();return(i||[]).map(s=>new ype.Multiaddr(s))}return e})});var wpe,bpe,_pe=w(()=>{wpe=A(yt(),1);ge();_e();bpe=q(t=>{async function e(r={}){let n=await t.post("swarm/peers",{signal:r.signal,searchParams:j(r),headers:r.headers}),{Peers:i}=await n.json();return(i||[]).map(s=>({addr:new wpe.Multiaddr(s.Addr),peer:s.Peer,muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}return e})});function vpe(t){return{addrs:upe(t),connect:fpe(t),disconnect:dpe(t),localAddrs:gpe(t),peers:bpe(t)}}var Epe=w(()=>{lpe();hpe();ppe();mpe();_pe()});function H$e({name:t,hash:e,size:r,mode:n,mtime:i,mtimeNsecs:s}){let o={path:t,cid:L.parse(e),size:parseInt(r)};return n!=null&&(o.mode=parseInt(n,8)),i!=null&&(o.mtime={secs:i,nsecs:s||0}),o}var Q8,V$e,z$e,ZP=w(()=>{Se();$n();ge();Ra();_e();Ia();Q8=q(t=>{async function*e(r,n={}){let i=new AbortController,s=Ln(i.signal,n.signal),{headers:o,body:a,total:c,parts:u}=await Bn(r,i,n.headers),[l,f]=typeof n.progress=="function"?V$e(c,u,n.progress):[void 0,void 0],h=await t.post("add",{searchParams:j({"stream-channels":!0,...n,progress:Boolean(l)}),onUploadProgress:f,signal:s,headers:o,body:a});for await(let d of h.ndjson())d=qt(d),d.hash!==void 0?yield H$e(d):l&&l(d.bytes||0,d.name)}return e}),V$e=(t,e,r)=>e?[void 0,z$e(t,e,r)]:[r,void 0],z$e=(t,e,r)=>{let n=0,i=e.length;return({loaded:s,total:o})=>{let a=Math.floor(s/o*t);for(;n<i;){let{start:c,end:u,name:l}=e[n];if(a<u){r(a-c,l);break}else r(u-c,l),n+=1}}}});function Ape(t){let e=Q8(t);return q(()=>{async function r(n,i={}){return await(0,Spe.default)(e(j5(n),i))}return r})(t)}var Spe,Rpe=w(()=>{ZP();Spe=A(os(),1);ge();BA()});var Ipe,Tpe=w(()=>{ge();_e();Ipe=q(t=>{async function*e(r,n={}){yield*(await t.post("cat",{signal:n.signal,searchParams:j({arg:r.toString(),...n}),headers:n.headers})).iterator()}return e})});var xpe,Ppe=w(()=>{ge();_e();xpe=q(t=>async(r={})=>(await t.post("commands",{signal:r.signal,searchParams:j(r),headers:r.headers})).json())});var Cpe,Ope=w(()=>{ge();_e();Cpe=q(t=>async(r,n={})=>(await(await t.post("dns",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers})).json()).Path)});var kpe,Dpe=w(()=>{ge();kpe=q(t=>()=>{let e=new URL(t.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}})});var Npe,Bpe=w(()=>{Se();ge();_e();Npe=q(t=>{async function*e(r,n={}){let i={arg:`${r instanceof Uint8Array?L.decode(r):r}`,...n};i.compressionLevel&&(i["compression-level"]=i.compressionLevel,delete i.compressionLevel),yield*(await t.post("get",{signal:n.signal,searchParams:j(i),headers:n.headers})).iterator()}return e})});var Lpe,Z8,JP=w(()=>{$n();Lpe=A(yt(),1);ge();_e();Z8=q(t=>{async function e(r={}){let i=await(await t.post("id",{signal:r.signal,searchParams:j({arg:r.peerId?r.peerId.toString():void 0,...r}),headers:r.headers})).json(),s={...qt(i)};return s.addresses&&(s.addresses=s.addresses.map(o=>new Lpe.Multiaddr(o))),s}return e})});var Mpe,Upe=w(()=>{JP();Mpe=t=>{let e=Z8(t);async function r(n={}){let i=await e(n);return Boolean(i&&i.addresses&&i.addresses.length)}return r}});function $$e(t){switch(t.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}var qpe,Fpe=w(()=>{Se();ge();_e();$P();qpe=q((t,e)=>{async function*r(n,i={}){let s=`${n instanceof Uint8Array?L.decode(n):n}`;async function o(c){let u=c.Hash;if(u.includes("/")){let f=u.startsWith("/ipfs/")?u:`/ipfs/${u}`;u=(await z8(e)(f)).cid}else u=L.parse(u);let l={name:c.Name,path:s+(c.Name?`/${c.Name}`:""),size:c.Size,cid:u,type:$$e(c)};return c.Mode&&(l.mode=parseInt(c.Mode,8)),c.Mtime!==void 0&&c.Mtime!==null&&(l.mtime={secs:c.Mtime},c.MtimeNsecs!==void 0&&c.MtimeNsecs!==null&&(l.mtime.nsecs=c.MtimeNsecs)),l}let a=await t.post("ls",{signal:i.signal,searchParams:j({arg:s,...i}),headers:i.headers});for await(let c of a.ndjson()){if(c=c.Objects,!c)throw new Error("expected .Objects in results");if(c=c[0],!c)throw new Error("expected one array in results.Objects");let u=c.Links;if(!Array.isArray(u))throw new Error("expected one array in results.Objects[0].Links");if(!u.length){yield o(c);return}yield*u.map(o)}}return r})});var Kpe,jpe=w(()=>{$n();ge();_e();Kpe=q(t=>{async function e(r={}){let n=await t.post("dns",{signal:r.signal,searchParams:j(r),headers:r.headers});return qt(await n.json())}return e})});var Vpe,zpe=w(()=>{$n();ge();_e();Vpe=q(t=>{async function*e(r,n={}){yield*(await t.post("ping",{signal:n.signal,searchParams:j({arg:`${r}`,...n}),headers:n.headers,transform:qt})).ndjson()}return e})});var Hpe,$pe=w(()=>{ge();_e();Hpe=q(t=>{async function e(r,n={}){let i=await t.post("resolve",{signal:n.signal,searchParams:j({arg:r,...n}),headers:n.headers}),{Path:s}=await i.json();return s}return e})});var Gpe,Wpe,Ype=w(()=>{ge();Gpe=A(oe(),1),Wpe=q(t=>async(r={})=>{throw(0,Gpe.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var Xpe,Qpe=w(()=>{ge();_e();Xpe=q(t=>{async function e(r={}){await(await t.post("shutdown",{signal:r.signal,searchParams:j(r),headers:r.headers})).text()}return e})});var Zpe,Jpe=w(()=>{$n();ge();_e();Zpe=q(t=>{async function e(r={}){let n=await t.post("version",{signal:r.signal,searchParams:j(r),headers:r.headers});return{...qt(await n.json()),"ipfs-http-client":"1.0.0"}}return e})});var e0e=g(()=>{});var eC=g((YNt,t0e)=>{"use strict";var G$e=Kp(),W$e=(t,e)=>({path:decodeURIComponent(new URL(t).pathname.split("/").pop()||""),content:Y$e(t,e)});async function*Y$e(t,e){yield*(await new G$e().get(t,e)).iterator()}t0e.exports=W$e});function r0e(t={}){let e={name:Cs.name,code:Cs.code,encode:u=>u,decode:u=>u},r=Object.values(Zf);(t.ipld&&t.ipld.bases?t.ipld.bases:[]).forEach(u=>r.push(u));let n=new Gm({bases:r,loadBase:t.ipld&&t.ipld.loadBase}),i=Object.values(X4);[Kt,wp,Ep,X$e,e].concat(t.ipld&&t.ipld.codecs||[]).forEach(u=>i.push(u));let s=new Wm({codecs:i,loadCodec:t.ipld&&t.ipld.loadCodec}),o=Object.values(Y4);(t.ipld&&t.ipld.hashers?t.ipld.hashers:[]).forEach(u=>o.push(u));let a=new Ym({hashers:o,loadHasher:t.ipld&&t.ipld.loadHasher});return{add:Ape(t),addAll:Q8(t),bitswap:Nue(t),block:ele(t),bootstrap:mle(t),cat:Ipe(t),commands:xpe(t),config:Dle(t),dag:Gle(s,t),dht:cfe(t),diag:gfe(t),dns:Cpe(t),files:jfe(t),get:Npe(t),getEndpointConfig:kpe(t),id:Z8(t),isOnline:Mpe(t),key:ohe(t),log:phe(t),ls:qpe(t),mount:Kpe(t),name:xhe(t),object:Zhe(s,t),pin:kde(t),ping:Vpe(t),pubsub:$de(t),refs:Xde(t),repo:rpe(t),resolve:Hpe(t),start:Wpe(t),stats:ope(t),stop:Xpe(t),swarm:vpe(t),version:Zpe(t),bases:n,codecs:s,hashers:a}}var X$e,Q$e,Z$e,n0e=w(()=>{DP();NP();BP();xt();bp();H4();X$e=A(bE(),1);Zc();Q4();Bue();tle();wle();Nle();Wle();ufe();mfe();Vfe();ahe();yhe();Phe();Jhe();Dde();Gde();Qde();npe();ape();Epe();Rpe();ZP();Tpe();Ppe();Ope();Dpe();Bpe();JP();Upe();Fpe();jpe();zpe();$pe();Ype();Qpe();Jpe();Se();Q$e=A(yt(),1),Z$e=A(eC(),1)});var i0e=g(()=>{});var o0e=g((qBt,s0e)=>{s0e.exports=typeof WebSocket>"u"?i0e():WebSocket});var c0e=g(J8=>{"use strict";Object.defineProperty(J8,"__esModule",{value:!0});var a0e=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let r={value:e,done:!1};if(this.pullQueue.length){let n=this.pullQueue.shift();n&&n.resolve(r)}else this.pushQueue.push(Promise.resolve(r)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let r of this.pullQueue)r.reject(e);this.pullQueue.length=0}else{let r=Promise.reject(e);r.catch(()=>{}),this.pushQueue.push(r)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let r=this.pushQueue.shift();return r?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),r):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((n,i)=>{this.pullQueue.push({resolve:n,reject:i})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},tC=class{constructor(e,{highWaterMark:r=100,lowWaterMark:n=1}={}){let i=new a0e;i.highWaterMark=r,i.lowWaterMark=n,i.removeCallback=e({push:s=>i.push(s),stop:()=>i.stop(),fail:s=>i.fail(s),on:(s,o)=>{i.eventHandlers[s]=o}})||(()=>{}),this[Symbol.asyncIterator]=()=>i[Symbol.asyncIterator](),Object.freeze(this)}};J8.EventIterator=tC;J8.default=tC});var u0e=g(t3=>{"use strict";Object.defineProperty(t3,"__esModule",{value:!0});var rC=c0e();t3.EventIterator=rC.EventIterator;function J$e(t,e,r){return new rC.EventIterator(({push:n})=>(this.addEventListener(t,n,e),()=>this.removeEventListener(t,n,e)),r)}t3.subscribe=J$e;t3.default=rC.EventIterator});var f0e=g((jBt,l0e)=>{var{Buffer:eGe}=On(),{EventIterator:tGe}=u0e();function rGe(t){return t instanceof ArrayBuffer||t!=null&&t.constructor!=null&&t.constructor.name==="ArrayBuffer"&&typeof t.byteLength=="number"}l0e.exports=t=>{let e=t.removeEventListener||t.removeListener,r=async function*(){let s=new tGe(({push:o,stop:a,fail:c})=>(t.addEventListener("message",o),t.addEventListener("error",c),t.addEventListener("close",a),()=>{e.call(t,"message",o),e.call(t,"error",c),e.call(t,"close",a)}),{highWaterMark:1/0});for await(let{data:o}of s)yield rGe(o)?eGe.from(o):o}(),n=t.readyState===1,i;return t.addEventListener("open",()=>{n=!0,i=null}),t.addEventListener("close",()=>{n=!1,i=null}),t.addEventListener("error",s=>{n||(i=s)}),r.connected=()=>new Promise((s,o)=>{if(n)return s();if(i)return o(i);let a=l=>{e.call(t,"open",c),e.call(t,"error",u),l()},c=()=>a(s),u=l=>a(()=>o(l));t.addEventListener("open",c),t.addEventListener("error",u)}),r}});var d0e=g((VBt,h0e)=>{h0e.exports=async t=>{if(t.readyState>=2)throw new Error("socket closed");if(t.readyState!==1)return new Promise((e,r)=>{let n=t&&(t.removeEventListener||t.removeListener);function i(){typeof n=="function"&&(n.call(t,"open",s),n.call(t,"error",o))}function s(){i(),e()}function o(a){i(),r(a)}t.addEventListener("open",s),t.addEventListener("error",o)})}});var y0e=g((zBt,p0e)=>{var nGe=d0e();p0e.exports=(t,e)=>(e=e||{},e.closeOnEnd=e.closeOnEnd!==!1,async r=>{for await(let n of r){try{await nGe(t)}catch(i){if(i.message==="socket closed")break;throw i}t.send(n)}if(e.closeOnEnd&&t.readyState<=1)return new Promise((n,i)=>{t.addEventListener("close",s=>{if(s.wasClean||s.code===1006)n();else{let o=Object.assign(new Error("ws error"),{event:s});i(o)}}),setTimeout(()=>t.close())})})});var m0e=g((HBt,g0e)=>{var iGe=f0e(),sGe=y0e();g0e.exports=(t,e)=>{e=e||{},e.binaryType?t.binaryType=e.binaryType:e.binary&&(t.binaryType="arraybuffer");let r={sink:sGe(t,e),source:iGe(t,e),connected:()=>r.source.connected()};return r}});var b0e=g(($Bt,w0e)=>{var{relative:oGe}=a6(),aGe={http:"ws",https:"wss"},cGe="ws";w0e.exports=(t,e)=>oGe(t,e,aGe,cGe)});var _0e=g((GBt,e_)=>{"use strict";var uGe=o0e(),lGe=m0e(),fGe=b0e();e_.exports=function(t,e={}){let r=typeof window>"u"?{}:window.location,n=fGe(t,r),i=new uGe(n,e.websocket),s=lGe(i,e);return s.remoteAddress=n,s.close=()=>new Promise((o,a)=>{i.addEventListener("close",o),i.close()}),s.destroy=()=>{i.terminate?i.terminate():i.close()},s.socket=i,s};e_.exports.connect=e_.exports});var E0e=g((WBt,v0e)=>{"use strict";v0e.exports=function(){throw new Error("WebSocket Servers can not be created in the browser!")}});var nC=g(Ad=>{"use strict";Ad.CODE_P2P=421;Ad.CODE_CIRCUIT=290;Ad.CODE_TCP=6;Ad.CODE_WS=477;Ad.CODE_WSS=478;Ad.CLOSE_TIMEOUT=2e3});var iC=g(V1=>{"use strict";Object.defineProperty(V1,"__esModule",{value:!0});V1.isCorrect=V1.isInSubnet=void 0;function hGe(t){return this.subnetMask<t.subnetMask?!1:this.mask(t.subnetMask)===t.mask()}V1.isInSubnet=hGe;function dGe(t){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===t&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}V1.isCorrect=dGe});var sC=g(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.RE_SUBNET_STRING=Cc.RE_ADDRESS=Cc.GROUPS=Cc.BITS=void 0;Cc.BITS=32;Cc.GROUPS=4;Cc.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;Cc.RE_SUBNET_STRING=/\/\d{1,2}$/});var t_=g(z1=>{"use strict";var pGe=z1&&z1.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(z1,"__esModule",{value:!0});z1.AddressError=void 0;var yGe=function(t){pGe(e,t);function e(r,n){var i=t.call(this,r)||this;return i.name="AddressError",n!==null&&(i.parseMessage=n),i}return e}(Error);z1.AddressError=yGe});var oC=g((r_,S0e)=>{(function(){var t,e=244837814094590,r=(e&16777215)==15715070;function n(v,E,C){v!=null&&(typeof v=="number"?this.fromNumber(v,E,C):E==null&&typeof v!="string"?this.fromString(v,256):this.fromString(v,E))}function i(){return new n(null)}function s(v,E,C,H,fe,ve){for(;--ve>=0;){var Ne=E*this[v++]+C[H]+fe;fe=Math.floor(Ne/67108864),C[H++]=Ne&67108863}return fe}function o(v,E,C,H,fe,ve){for(var Ne=E&32767,je=E>>15;--ve>=0;){var Br=this[v]&32767,Yn=this[v++]>>15,Gs=je*Br+Yn*Ne;Br=Ne*Br+((Gs&32767)<<15)+C[H]+(fe&1073741823),fe=(Br>>>30)+(Gs>>>15)+je*Yn+(fe>>>30),C[H++]=Br&1073741823}return fe}function a(v,E,C,H,fe,ve){for(var Ne=E&16383,je=E>>14;--ve>=0;){var Br=this[v]&16383,Yn=this[v++]>>14,Gs=je*Br+Yn*Ne;Br=Ne*Br+((Gs&16383)<<14)+C[H]+fe,fe=(Br>>28)+(Gs>>14)+je*Yn,C[H++]=Br&268435455}return fe}var c=typeof navigator<"u";c&&r&&navigator.appName=="Microsoft Internet Explorer"?(n.prototype.am=o,t=30):c&&r&&navigator.appName!="Netscape"?(n.prototype.am=s,t=26):(n.prototype.am=a,t=28),n.prototype.DB=t,n.prototype.DM=(1<<t)-1,n.prototype.DV=1<<t;var u=52;n.prototype.FV=Math.pow(2,u),n.prototype.F1=u-t,n.prototype.F2=2*t-u;var l="0123456789abcdefghijklmnopqrstuvwxyz",f=new Array,h,d;for(h="0".charCodeAt(0),d=0;d<=9;++d)f[h++]=d;for(h="a".charCodeAt(0),d=10;d<36;++d)f[h++]=d;for(h="A".charCodeAt(0),d=10;d<36;++d)f[h++]=d;function p(v){return l.charAt(v)}function y(v,E){var C=f[v.charCodeAt(E)];return C??-1}function b(v){for(var E=this.t-1;E>=0;--E)v[E]=this[E];v.t=this.t,v.s=this.s}function m(v){this.t=1,this.s=v<0?-1:0,v>0?this[0]=v:v<-1?this[0]=v+this.DV:this.t=0}function _(v){var E=i();return E.fromInt(v),E}function R(v,E){var C;if(E==16)C=4;else if(E==8)C=3;else if(E==256)C=8;else if(E==2)C=1;else if(E==32)C=5;else if(E==4)C=2;else{this.fromRadix(v,E);return}this.t=0,this.s=0;for(var H=v.length,fe=!1,ve=0;--H>=0;){var Ne=C==8?v[H]&255:y(v,H);if(Ne<0){v.charAt(H)=="-"&&(fe=!0);continue}fe=!1,ve==0?this[this.t++]=Ne:ve+C>this.DB?(this[this.t-1]|=(Ne&(1<<this.DB-ve)-1)<<ve,this[this.t++]=Ne>>this.DB-ve):this[this.t-1]|=Ne<<ve,ve+=C,ve>=this.DB&&(ve-=this.DB)}C==8&&(v[0]&128)!=0&&(this.s=-1,ve>0&&(this[this.t-1]|=(1<<this.DB-ve)-1<<ve)),this.clamp(),fe&&n.ZERO.subTo(this,this)}function k(){for(var v=this.s&this.DM;this.t>0&&this[this.t-1]==v;)--this.t}function P(v){if(this.s<0)return"-"+this.negate().toString(v);var E;if(v==16)E=4;else if(v==8)E=3;else if(v==2)E=1;else if(v==32)E=5;else if(v==4)E=2;else return this.toRadix(v);var C=(1<<E)-1,H,fe=!1,ve="",Ne=this.t,je=this.DB-Ne*this.DB%E;if(Ne-- >0)for(je<this.DB&&(H=this[Ne]>>je)>0&&(fe=!0,ve=p(H));Ne>=0;)je<E?(H=(this[Ne]&(1<<je)-1)<<E-je,H|=this[--Ne]>>(je+=this.DB-E)):(H=this[Ne]>>(je-=E)&C,je<=0&&(je+=this.DB,--Ne)),H>0&&(fe=!0),fe&&(ve+=p(H));return fe?ve:"0"}function x(){var v=i();return n.ZERO.subTo(this,v),v}function D(){return this.s<0?this.negate():this}function U(v){var E=this.s-v.s;if(E!=0)return E;var C=this.t;if(E=C-v.t,E!=0)return this.s<0?-E:E;for(;--C>=0;)if((E=this[C]-v[C])!=0)return E;return 0}function M(v){var E=1,C;return(C=v>>>16)!=0&&(v=C,E+=16),(C=v>>8)!=0&&(v=C,E+=8),(C=v>>4)!=0&&(v=C,E+=4),(C=v>>2)!=0&&(v=C,E+=2),(C=v>>1)!=0&&(v=C,E+=1),E}function ae(){return this.t<=0?0:this.DB*(this.t-1)+M(this[this.t-1]^this.s&this.DM)}function ne(v,E){var C;for(C=this.t-1;C>=0;--C)E[C+v]=this[C];for(C=v-1;C>=0;--C)E[C]=0;E.t=this.t+v,E.s=this.s}function de(v,E){for(var C=v;C<this.t;++C)E[C-v]=this[C];E.t=Math.max(this.t-v,0),E.s=this.s}function me(v,E){var C=v%this.DB,H=this.DB-C,fe=(1<<H)-1,ve=Math.floor(v/this.DB),Ne=this.s<<C&this.DM,je;for(je=this.t-1;je>=0;--je)E[je+ve+1]=this[je]>>H|Ne,Ne=(this[je]&fe)<<C;for(je=ve-1;je>=0;--je)E[je]=0;E[ve]=Ne,E.t=this.t+ve+1,E.s=this.s,E.clamp()}function Ke(v,E){E.s=this.s;var C=Math.floor(v/this.DB);if(C>=this.t){E.t=0;return}var H=v%this.DB,fe=this.DB-H,ve=(1<<H)-1;E[0]=this[C]>>H;for(var Ne=C+1;Ne<this.t;++Ne)E[Ne-C-1]|=(this[Ne]&ve)<<fe,E[Ne-C]=this[Ne]>>H;H>0&&(E[this.t-C-1]|=(this.s&ve)<<fe),E.t=this.t-C,E.clamp()}function xe(v,E){for(var C=0,H=0,fe=Math.min(v.t,this.t);C<fe;)H+=this[C]-v[C],E[C++]=H&this.DM,H>>=this.DB;if(v.t<this.t){for(H-=v.s;C<this.t;)H+=this[C],E[C++]=H&this.DM,H>>=this.DB;H+=this.s}else{for(H+=this.s;C<v.t;)H-=v[C],E[C++]=H&this.DM,H>>=this.DB;H-=v.s}E.s=H<0?-1:0,H<-1?E[C++]=this.DV+H:H>0&&(E[C++]=H),E.t=C,E.clamp()}function Ue(v,E){var C=this.abs(),H=v.abs(),fe=C.t;for(E.t=fe+H.t;--fe>=0;)E[fe]=0;for(fe=0;fe<H.t;++fe)E[fe+C.t]=C.am(0,H[fe],E,fe,0,C.t);E.s=0,E.clamp(),this.s!=v.s&&n.ZERO.subTo(E,E)}function ie(v){for(var E=this.abs(),C=v.t=2*E.t;--C>=0;)v[C]=0;for(C=0;C<E.t-1;++C){var H=E.am(C,E[C],v,2*C,0,1);(v[C+E.t]+=E.am(C+1,2*E[C],v,2*C+1,H,E.t-C-1))>=E.DV&&(v[C+E.t]-=E.DV,v[C+E.t+1]=1)}v.t>0&&(v[v.t-1]+=E.am(C,E[C],v,2*C,0,1)),v.s=0,v.clamp()}function Ve(v,E,C){var H=v.abs();if(!(H.t<=0)){var fe=this.abs();if(fe.t<H.t){E!=null&&E.fromInt(0),C!=null&&this.copyTo(C);return}C==null&&(C=i());var ve=i(),Ne=this.s,je=v.s,Br=this.DB-M(H[H.t-1]);Br>0?(H.lShiftTo(Br,ve),fe.lShiftTo(Br,C)):(H.copyTo(ve),fe.copyTo(C));var Yn=ve.t,Gs=ve[Yn-1];if(Gs!=0){var Ss=Gs*(1<<this.F1)+(Yn>1?ve[Yn-2]>>this.F2:0),zc=this.FV/Ss,l4=(1<<this.F1)/Ss,Wo=1<<this.F2,Yo=C.t,f4=Yo-Yn,Gu=E??i();for(ve.dlShiftTo(f4,Gu),C.compareTo(Gu)>=0&&(C[C.t++]=1,C.subTo(Gu,C)),n.ONE.dlShiftTo(Yn,Gu),Gu.subTo(ve,ve);ve.t<Yn;)ve[ve.t++]=0;for(;--f4>=0;){var g7=C[--Yo]==Gs?this.DM:Math.floor(C[Yo]*zc+(C[Yo-1]+Wo)*l4);if((C[Yo]+=ve.am(0,g7,C,f4,0,Yn))<g7)for(ve.dlShiftTo(f4,Gu),C.subTo(Gu,C);C[Yo]<--g7;)C.subTo(Gu,C)}E!=null&&(C.drShiftTo(Yn,E),Ne!=je&&n.ZERO.subTo(E,E)),C.t=Yn,C.clamp(),Br>0&&C.rShiftTo(Br,C),Ne<0&&n.ZERO.subTo(C,C)}}}function pt(v){var E=i();return this.abs().divRemTo(v,null,E),this.s<0&&E.compareTo(n.ZERO)>0&&v.subTo(E,E),E}function Je(v){this.m=v}function et(v){return v.s<0||v.compareTo(this.m)>=0?v.mod(this.m):v}function pe(v){return v}function J(v){v.divRemTo(this.m,null,v)}function Ie(v,E,C){v.multiplyTo(E,C),this.reduce(C)}function ze(v,E){v.squareTo(E),this.reduce(E)}Je.prototype.convert=et,Je.prototype.revert=pe,Je.prototype.reduce=J,Je.prototype.mulTo=Ie,Je.prototype.sqrTo=ze;function We(){if(this.t<1)return 0;var v=this[0];if((v&1)==0)return 0;var E=v&3;return E=E*(2-(v&15)*E)&15,E=E*(2-(v&255)*E)&255,E=E*(2-((v&65535)*E&65535))&65535,E=E*(2-v*E%this.DV)%this.DV,E>0?this.DV-E:-E}function De(v){this.m=v,this.mp=v.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<v.DB-15)-1,this.mt2=2*v.t}function ht(v){var E=i();return v.abs().dlShiftTo(this.m.t,E),E.divRemTo(this.m,null,E),v.s<0&&E.compareTo(n.ZERO)>0&&this.m.subTo(E,E),E}function T(v){var E=i();return v.copyTo(E),this.reduce(E),E}function O(v){for(;v.t<=this.mt2;)v[v.t++]=0;for(var E=0;E<this.m.t;++E){var C=v[E]&32767,H=C*this.mpl+((C*this.mph+(v[E]>>15)*this.mpl&this.um)<<15)&v.DM;for(C=E+this.m.t,v[C]+=this.m.am(0,H,v,E,0,this.m.t);v[C]>=v.DV;)v[C]-=v.DV,v[++C]++}v.clamp(),v.drShiftTo(this.m.t,v),v.compareTo(this.m)>=0&&v.subTo(this.m,v)}function N(v,E){v.squareTo(E),this.reduce(E)}function Y(v,E,C){v.multiplyTo(E,C),this.reduce(C)}De.prototype.convert=ht,De.prototype.revert=T,De.prototype.reduce=O,De.prototype.mulTo=Y,De.prototype.sqrTo=N;function K(){return(this.t>0?this[0]&1:this.s)==0}function W(v,E){if(v>4294967295||v<1)return n.ONE;var C=i(),H=i(),fe=E.convert(this),ve=M(v)-1;for(fe.copyTo(C);--ve>=0;)if(E.sqrTo(C,H),(v&1<<ve)>0)E.mulTo(H,fe,C);else{var Ne=C;C=H,H=Ne}return E.revert(C)}function ee(v,E){var C;return v<256||E.isEven()?C=new Je(E):C=new De(E),this.exp(v,C)}n.prototype.copyTo=b,n.prototype.fromInt=m,n.prototype.fromString=R,n.prototype.clamp=k,n.prototype.dlShiftTo=ne,n.prototype.drShiftTo=de,n.prototype.lShiftTo=me,n.prototype.rShiftTo=Ke,n.prototype.subTo=xe,n.prototype.multiplyTo=Ue,n.prototype.squareTo=ie,n.prototype.divRemTo=Ve,n.prototype.invDigit=We,n.prototype.isEven=K,n.prototype.exp=W,n.prototype.toString=P,n.prototype.negate=x,n.prototype.abs=D,n.prototype.compareTo=U,n.prototype.bitLength=ae,n.prototype.mod=pt,n.prototype.modPowInt=ee,n.ZERO=_(0),n.ONE=_(1);function V(){var v=i();return this.copyTo(v),v}function X(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function re(){return this.t==0?this.s:this[0]<<24>>24}function I(){return this.t==0?this.s:this[0]<<16>>16}function B(v){return Math.floor(Math.LN2*this.DB/Math.log(v))}function G(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Z(v){if(v==null&&(v=10),this.signum()==0||v<2||v>36)return"0";var E=this.chunkSize(v),C=Math.pow(v,E),H=_(C),fe=i(),ve=i(),Ne="";for(this.divRemTo(H,fe,ve);fe.signum()>0;)Ne=(C+ve.intValue()).toString(v).substr(1)+Ne,fe.divRemTo(H,fe,ve);return ve.intValue().toString(v)+Ne}function ye(v,E){this.fromInt(0),E==null&&(E=10);for(var C=this.chunkSize(E),H=Math.pow(E,C),fe=!1,ve=0,Ne=0,je=0;je<v.length;++je){var Br=y(v,je);if(Br<0){v.charAt(je)=="-"&&this.signum()==0&&(fe=!0);continue}Ne=E*Ne+Br,++ve>=C&&(this.dMultiply(H),this.dAddOffset(Ne,0),ve=0,Ne=0)}ve>0&&(this.dMultiply(Math.pow(E,ve)),this.dAddOffset(Ne,0)),fe&&n.ZERO.subTo(this,this)}function Fe(v,E,C){if(typeof E=="number")if(v<2)this.fromInt(1);else for(this.fromNumber(v,C),this.testBit(v-1)||this.bitwiseTo(n.ONE.shiftLeft(v-1),Fr,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(E);)this.dAddOffset(2,0),this.bitLength()>v&&this.subTo(n.ONE.shiftLeft(v-1),this);else{var H=new Array,fe=v&7;H.length=(v>>3)+1,E.nextBytes(H),fe>0?H[0]&=(1<<fe)-1:H[0]=0,this.fromString(H,256)}}function Ye(){var v=this.t,E=new Array;E[0]=this.s;var C=this.DB-v*this.DB%8,H,fe=0;if(v-- >0)for(C<this.DB&&(H=this[v]>>C)!=(this.s&this.DM)>>C&&(E[fe++]=H|this.s<<this.DB-C);v>=0;)C<8?(H=(this[v]&(1<<C)-1)<<8-C,H|=this[--v]>>(C+=this.DB-8)):(H=this[v]>>(C-=8)&255,C<=0&&(C+=this.DB,--v)),(H&128)!=0&&(H|=-256),fe==0&&(this.s&128)!=(H&128)&&++fe,(fe>0||H!=this.s)&&(E[fe++]=H);return E}function He(v){return this.compareTo(v)==0}function $e(v){return this.compareTo(v)<0?this:v}function ct(v){return this.compareTo(v)>0?this:v}function zt(v,E,C){var H,fe,ve=Math.min(v.t,this.t);for(H=0;H<ve;++H)C[H]=E(this[H],v[H]);if(v.t<this.t){for(fe=v.s&this.DM,H=ve;H<this.t;++H)C[H]=E(this[H],fe);C.t=this.t}else{for(fe=this.s&this.DM,H=ve;H<v.t;++H)C[H]=E(fe,v[H]);C.t=v.t}C.s=E(this.s,v.s),C.clamp()}function gt(v,E){return v&E}function Ir(v){var E=i();return this.bitwiseTo(v,gt,E),E}function Fr(v,E){return v|E}function Bi(v){var E=i();return this.bitwiseTo(v,Fr,E),E}function vt(v,E){return v^E}function ut(v){var E=i();return this.bitwiseTo(v,vt,E),E}function Er(v,E){return v&~E}function Z7e(v){var E=i();return this.bitwiseTo(v,Er,E),E}function J7e(){for(var v=i(),E=0;E<this.t;++E)v[E]=this.DM&~this[E];return v.t=this.t,v.s=~this.s,v}function eEe(v){var E=i();return v<0?this.rShiftTo(-v,E):this.lShiftTo(v,E),E}function tEe(v){var E=i();return v<0?this.lShiftTo(-v,E):this.rShiftTo(v,E),E}function rEe(v){if(v==0)return-1;var E=0;return(v&65535)==0&&(v>>=16,E+=16),(v&255)==0&&(v>>=8,E+=8),(v&15)==0&&(v>>=4,E+=4),(v&3)==0&&(v>>=2,E+=2),(v&1)==0&&++E,E}function nEe(){for(var v=0;v<this.t;++v)if(this[v]!=0)return v*this.DB+rEe(this[v]);return this.s<0?this.t*this.DB:-1}function iEe(v){for(var E=0;v!=0;)v&=v-1,++E;return E}function sEe(){for(var v=0,E=this.s&this.DM,C=0;C<this.t;++C)v+=iEe(this[C]^E);return v}function oEe(v){var E=Math.floor(v/this.DB);return E>=this.t?this.s!=0:(this[E]&1<<v%this.DB)!=0}function aEe(v,E){var C=n.ONE.shiftLeft(v);return this.bitwiseTo(C,E,C),C}function cEe(v){return this.changeBit(v,Fr)}function uEe(v){return this.changeBit(v,Er)}function lEe(v){return this.changeBit(v,vt)}function fEe(v,E){for(var C=0,H=0,fe=Math.min(v.t,this.t);C<fe;)H+=this[C]+v[C],E[C++]=H&this.DM,H>>=this.DB;if(v.t<this.t){for(H+=v.s;C<this.t;)H+=this[C],E[C++]=H&this.DM,H>>=this.DB;H+=this.s}else{for(H+=this.s;C<v.t;)H+=v[C],E[C++]=H&this.DM,H>>=this.DB;H+=v.s}E.s=H<0?-1:0,H>0?E[C++]=H:H<-1&&(E[C++]=this.DV+H),E.t=C,E.clamp()}function hEe(v){var E=i();return this.addTo(v,E),E}function dEe(v){var E=i();return this.subTo(v,E),E}function pEe(v){var E=i();return this.multiplyTo(v,E),E}function yEe(){var v=i();return this.squareTo(v),v}function gEe(v){var E=i();return this.divRemTo(v,E,null),E}function mEe(v){var E=i();return this.divRemTo(v,null,E),E}function wEe(v){var E=i(),C=i();return this.divRemTo(v,E,C),new Array(E,C)}function bEe(v){this[this.t]=this.am(0,v-1,this,0,0,this.t),++this.t,this.clamp()}function _Ee(v,E){if(v!=0){for(;this.t<=E;)this[this.t++]=0;for(this[E]+=v;this[E]>=this.DV;)this[E]-=this.DV,++E>=this.t&&(this[this.t++]=0),++this[E]}}function Wy(){}function DD(v){return v}function vEe(v,E,C){v.multiplyTo(E,C)}function EEe(v,E){v.squareTo(E)}Wy.prototype.convert=DD,Wy.prototype.revert=DD,Wy.prototype.mulTo=vEe,Wy.prototype.sqrTo=EEe;function SEe(v){return this.exp(v,new Wy)}function AEe(v,E,C){var H=Math.min(this.t+v.t,E);for(C.s=0,C.t=H;H>0;)C[--H]=0;var fe;for(fe=C.t-this.t;H<fe;++H)C[H+this.t]=this.am(0,v[H],C,H,0,this.t);for(fe=Math.min(v.t,E);H<fe;++H)this.am(0,v[H],C,H,0,E-H);C.clamp()}function REe(v,E,C){--E;var H=C.t=this.t+v.t-E;for(C.s=0;--H>=0;)C[H]=0;for(H=Math.max(E-this.t,0);H<v.t;++H)C[this.t+H-E]=this.am(E-H,v[H],C,0,0,this.t+H-E);C.clamp(),C.drShiftTo(1,C)}function Hf(v){this.r2=i(),this.q3=i(),n.ONE.dlShiftTo(2*v.t,this.r2),this.mu=this.r2.divide(v),this.m=v}function IEe(v){if(v.s<0||v.t>2*this.m.t)return v.mod(this.m);if(v.compareTo(this.m)<0)return v;var E=i();return v.copyTo(E),this.reduce(E),E}function TEe(v){return v}function xEe(v){for(v.drShiftTo(this.m.t-1,this.r2),v.t>this.m.t+1&&(v.t=this.m.t+1,v.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);v.compareTo(this.r2)<0;)v.dAddOffset(1,this.m.t+1);for(v.subTo(this.r2,v);v.compareTo(this.m)>=0;)v.subTo(this.m,v)}function PEe(v,E){v.squareTo(E),this.reduce(E)}function CEe(v,E,C){v.multiplyTo(E,C),this.reduce(C)}Hf.prototype.convert=IEe,Hf.prototype.revert=TEe,Hf.prototype.reduce=xEe,Hf.prototype.mulTo=CEe,Hf.prototype.sqrTo=PEe;function OEe(v,E){var C=v.bitLength(),H,fe=_(1),ve;if(C<=0)return fe;C<18?H=1:C<48?H=3:C<144?H=4:C<768?H=5:H=6,C<8?ve=new Je(E):E.isEven()?ve=new Hf(E):ve=new De(E);var Ne=new Array,je=3,Br=H-1,Yn=(1<<H)-1;if(Ne[1]=ve.convert(this),H>1){var Gs=i();for(ve.sqrTo(Ne[1],Gs);je<=Yn;)Ne[je]=i(),ve.mulTo(Gs,Ne[je-2],Ne[je]),je+=2}var Ss=v.t-1,zc,l4=!0,Wo=i(),Yo;for(C=M(v[Ss])-1;Ss>=0;){for(C>=Br?zc=v[Ss]>>C-Br&Yn:(zc=(v[Ss]&(1<<C+1)-1)<<Br-C,Ss>0&&(zc|=v[Ss-1]>>this.DB+C-Br)),je=H;(zc&1)==0;)zc>>=1,--je;if((C-=je)<0&&(C+=this.DB,--Ss),l4)Ne[zc].copyTo(fe),l4=!1;else{for(;je>1;)ve.sqrTo(fe,Wo),ve.sqrTo(Wo,fe),je-=2;je>0?ve.sqrTo(fe,Wo):(Yo=fe,fe=Wo,Wo=Yo),ve.mulTo(Wo,Ne[zc],fe)}for(;Ss>=0&&(v[Ss]&1<<C)==0;)ve.sqrTo(fe,Wo),Yo=fe,fe=Wo,Wo=Yo,--C<0&&(C=this.DB-1,--Ss)}return ve.revert(fe)}function kEe(v){var E=this.s<0?this.negate():this.clone(),C=v.s<0?v.negate():v.clone();if(E.compareTo(C)<0){var H=E;E=C,C=H}var fe=E.getLowestSetBit(),ve=C.getLowestSetBit();if(ve<0)return E;for(fe<ve&&(ve=fe),ve>0&&(E.rShiftTo(ve,E),C.rShiftTo(ve,C));E.signum()>0;)(fe=E.getLowestSetBit())>0&&E.rShiftTo(fe,E),(fe=C.getLowestSetBit())>0&&C.rShiftTo(fe,C),E.compareTo(C)>=0?(E.subTo(C,E),E.rShiftTo(1,E)):(C.subTo(E,C),C.rShiftTo(1,C));return ve>0&&C.lShiftTo(ve,C),C}function DEe(v){if(v<=0)return 0;var E=this.DV%v,C=this.s<0?v-1:0;if(this.t>0)if(E==0)C=this[0]%v;else for(var H=this.t-1;H>=0;--H)C=(E*C+this[H])%v;return C}function NEe(v){var E=v.isEven();if(this.isEven()&&E||v.signum()==0)return n.ZERO;for(var C=v.clone(),H=this.clone(),fe=_(1),ve=_(0),Ne=_(0),je=_(1);C.signum()!=0;){for(;C.isEven();)C.rShiftTo(1,C),E?((!fe.isEven()||!ve.isEven())&&(fe.addTo(this,fe),ve.subTo(v,ve)),fe.rShiftTo(1,fe)):ve.isEven()||ve.subTo(v,ve),ve.rShiftTo(1,ve);for(;H.isEven();)H.rShiftTo(1,H),E?((!Ne.isEven()||!je.isEven())&&(Ne.addTo(this,Ne),je.subTo(v,je)),Ne.rShiftTo(1,Ne)):je.isEven()||je.subTo(v,je),je.rShiftTo(1,je);C.compareTo(H)>=0?(C.subTo(H,C),E&&fe.subTo(Ne,fe),ve.subTo(je,ve)):(H.subTo(C,H),E&&Ne.subTo(fe,Ne),je.subTo(ve,je))}if(H.compareTo(n.ONE)!=0)return n.ZERO;if(je.compareTo(v)>=0)return je.subtract(v);if(je.signum()<0)je.addTo(v,je);else return je;return je.signum()<0?je.add(v):je}var Li=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],BEe=(1<<26)/Li[Li.length-1];function LEe(v){var E,C=this.abs();if(C.t==1&&C[0]<=Li[Li.length-1]){for(E=0;E<Li.length;++E)if(C[0]==Li[E])return!0;return!1}if(C.isEven())return!1;for(E=1;E<Li.length;){for(var H=Li[E],fe=E+1;fe<Li.length&&H<BEe;)H*=Li[fe++];for(H=C.modInt(H);E<fe;)if(H%Li[E++]==0)return!1}return C.millerRabin(v)}function MEe(v){var E=this.subtract(n.ONE),C=E.getLowestSetBit();if(C<=0)return!1;var H=E.shiftRight(C);v=v+1>>1,v>Li.length&&(v=Li.length);for(var fe=i(),ve=0;ve<v;++ve){fe.fromInt(Li[Math.floor(Math.random()*Li.length)]);var Ne=fe.modPow(H,this);if(Ne.compareTo(n.ONE)!=0&&Ne.compareTo(E)!=0){for(var je=1;je++<C&&Ne.compareTo(E)!=0;)if(Ne=Ne.modPowInt(2,this),Ne.compareTo(n.ONE)==0)return!1;if(Ne.compareTo(E)!=0)return!1}}return!0}n.prototype.chunkSize=B,n.prototype.toRadix=Z,n.prototype.fromRadix=ye,n.prototype.fromNumber=Fe,n.prototype.bitwiseTo=zt,n.prototype.changeBit=aEe,n.prototype.addTo=fEe,n.prototype.dMultiply=bEe,n.prototype.dAddOffset=_Ee,n.prototype.multiplyLowerTo=AEe,n.prototype.multiplyUpperTo=REe,n.prototype.modInt=DEe,n.prototype.millerRabin=MEe,n.prototype.clone=V,n.prototype.intValue=X,n.prototype.byteValue=re,n.prototype.shortValue=I,n.prototype.signum=G,n.prototype.toByteArray=Ye,n.prototype.equals=He,n.prototype.min=$e,n.prototype.max=ct,n.prototype.and=Ir,n.prototype.or=Bi,n.prototype.xor=ut,n.prototype.andNot=Z7e,n.prototype.not=J7e,n.prototype.shiftLeft=eEe,n.prototype.shiftRight=tEe,n.prototype.getLowestSetBit=nEe,n.prototype.bitCount=sEe,n.prototype.testBit=oEe,n.prototype.setBit=cEe,n.prototype.clearBit=uEe,n.prototype.flipBit=lEe,n.prototype.add=hEe,n.prototype.subtract=dEe,n.prototype.multiply=pEe,n.prototype.divide=gEe,n.prototype.remainder=mEe,n.prototype.divideAndRemainder=wEe,n.prototype.modPow=OEe,n.prototype.modInverse=NEe,n.prototype.pow=SEe,n.prototype.gcd=kEe,n.prototype.isProbablePrime=LEe,n.prototype.square=yEe,n.prototype.Barrett=Hf;var u4,Es,Wn;function UEe(v){Es[Wn++]^=v&255,Es[Wn++]^=v>>8&255,Es[Wn++]^=v>>16&255,Es[Wn++]^=v>>24&255,Wn>=y7&&(Wn-=y7)}function ND(){UEe(new Date().getTime())}if(Es==null){Es=new Array,Wn=0;var Go;if(typeof window<"u"&&window.crypto){if(window.crypto.getRandomValues){var BD=new Uint8Array(32);for(window.crypto.getRandomValues(BD),Go=0;Go<32;++Go)Es[Wn++]=BD[Go]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var LD=window.crypto.random(32);for(Go=0;Go<LD.length;++Go)Es[Wn++]=LD.charCodeAt(Go)&255}}for(;Wn<y7;)Go=Math.floor(65536*Math.random()),Es[Wn++]=Go>>>8,Es[Wn++]=Go&255;Wn=0,ND()}function qEe(){if(u4==null){for(ND(),u4=VEe(),u4.init(Es),Wn=0;Wn<Es.length;++Wn)Es[Wn]=0;Wn=0}return u4.next()}function FEe(v){var E;for(E=0;E<v.length;++E)v[E]=qEe()}function d7(){}d7.prototype.nextBytes=FEe;function p7(){this.i=0,this.j=0,this.S=new Array}function KEe(v){var E,C,H;for(E=0;E<256;++E)this.S[E]=E;for(C=0,E=0;E<256;++E)C=C+this.S[E]+v[E%v.length]&255,H=this.S[E],this.S[E]=this.S[C],this.S[C]=H;this.i=0,this.j=0}function jEe(){var v;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,v=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=v,this.S[v+this.S[this.i]&255]}p7.prototype.init=KEe,p7.prototype.next=jEe;function VEe(){return new p7}var y7=256;typeof r_<"u"?r_=S0e.exports={default:n,BigInteger:n,SecureRandom:d7}:this.jsbn={BigInteger:n,SecureRandom:d7}}).call(r_)});var r3=g(n_=>{(function(){"use strict";var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return n(s(o),arguments)}function r(o,a){return e.apply(null,[o].concat(a||[]))}function n(o,a){var c=1,u=o.length,l,f="",h,d,p,y,b,m,_,R;for(h=0;h<u;h++)if(typeof o[h]=="string")f+=o[h];else if(typeof o[h]=="object"){if(p=o[h],p.keys)for(l=a[c],d=0;d<p.keys.length;d++){if(l==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',p.keys[d],p.keys[d-1]));l=l[p.keys[d]]}else p.param_no?l=a[p.param_no]:l=a[c++];if(t.not_type.test(p.type)&&t.not_primitive.test(p.type)&&l instanceof Function&&(l=l()),t.numeric_arg.test(p.type)&&typeof l!="number"&&isNaN(l))throw new TypeError(e("[sprintf] expecting number but found %T",l));switch(t.number.test(p.type)&&(_=l>=0),p.type){case"b":l=parseInt(l,10).toString(2);break;case"c":l=String.fromCharCode(parseInt(l,10));break;case"d":case"i":l=parseInt(l,10);break;case"j":l=JSON.stringify(l,null,p.width?parseInt(p.width):0);break;case"e":l=p.precision?parseFloat(l).toExponential(p.precision):parseFloat(l).toExponential();break;case"f":l=p.precision?parseFloat(l).toFixed(p.precision):parseFloat(l);break;case"g":l=p.precision?String(Number(l.toPrecision(p.precision))):parseFloat(l);break;case"o":l=(parseInt(l,10)>>>0).toString(8);break;case"s":l=String(l),l=p.precision?l.substring(0,p.precision):l;break;case"t":l=String(!!l),l=p.precision?l.substring(0,p.precision):l;break;case"T":l=Object.prototype.toString.call(l).slice(8,-1).toLowerCase(),l=p.precision?l.substring(0,p.precision):l;break;case"u":l=parseInt(l,10)>>>0;break;case"v":l=l.valueOf(),l=p.precision?l.substring(0,p.precision):l;break;case"x":l=(parseInt(l,10)>>>0).toString(16);break;case"X":l=(parseInt(l,10)>>>0).toString(16).toUpperCase();break}t.json.test(p.type)?f+=l:(t.number.test(p.type)&&(!_||p.sign)?(R=_?"+":"-",l=l.toString().replace(t.sign,"")):R="",b=p.pad_char?p.pad_char==="0"?"0":p.pad_char.charAt(1):" ",m=p.width-(R+l).length,y=p.width&&m>0?b.repeat(m):"",f+=p.align?R+l+y:b==="0"?R+y+l:y+R+l)}return f}var i=Object.create(null);function s(o){if(i[o])return i[o];for(var a=o,c,u=[],l=0;a;){if((c=t.text.exec(a))!==null)u.push(c[0]);else if((c=t.modulo.exec(a))!==null)u.push("%");else if((c=t.placeholder.exec(a))!==null){if(c[2]){l|=1;var f=[],h=c[2],d=[];if((d=t.key.exec(h))!==null)for(f.push(d[1]);(h=h.substring(d[0].length))!=="";)if((d=t.key_access.exec(h))!==null)f.push(d[1]);else if((d=t.index_access.exec(h))!==null)f.push(d[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");c[2]=f}else l|=2;if(l===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");u.push({placeholder:c[0],param_no:c[1],keys:c[2],sign:c[3],pad_char:c[4],align:c[5],width:c[6],precision:c[7],type:c[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(c[0].length)}return i[o]=u}typeof n_<"u"&&(n_.sprintf=e,n_.vsprintf=r),typeof window<"u"&&(window.sprintf=e,window.vsprintf=r,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:r}}))})()});var aC=g(Oc=>{"use strict";var gGe=Oc&&Oc.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mGe=Oc&&Oc.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),I0e=Oc&&Oc.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&gGe(e,t,r);return mGe(e,t),e};Object.defineProperty(Oc,"__esModule",{value:!0});Oc.Address4=void 0;var A0e=I0e(iC()),Ta=I0e(sC()),R0e=t_(),n3=oC(),H1=r3(),wGe=function(){function t(e){this.groups=Ta.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=A0e.isCorrect(Ta.BITS),this.isInSubnet=A0e.isInSubnet,this.address=e;var r=Ta.RE_SUBNET_STRING.exec(e);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>Ta.BITS)throw new R0e.AddressError("Invalid subnet mask.");e=e.replace(Ta.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}return t.isValid=function(e){try{return new t(e),!0}catch{return!1}},t.prototype.parse=function(e){var r=e.split(".");if(!e.match(Ta.RE_ADDRESS))throw new R0e.AddressError("Invalid IPv4 address.");return r},t.prototype.correctForm=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)}).join(".")},t.fromHex=function(e){var r=e.replace(/:/g,"").padStart(8,"0"),n=[],i;for(i=0;i<8;i+=2){var s=r.slice(i,i+2);n.push(parseInt(s,16))}return new t(n.join("."))},t.fromInteger=function(e){return t.fromHex(e.toString(16))},t.fromArpa=function(e){var r=e.replace(/(\.in-addr\.arpa)?\.$/,""),n=r.split(".").reverse().join(".");return new t(n)},t.prototype.toHex=function(){return this.parsedAddress.map(function(e){return H1.sprintf("%02x",parseInt(e,10))}).join(":")},t.prototype.toArray=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)})},t.prototype.toGroup6=function(){var e=[],r;for(r=0;r<Ta.GROUPS;r+=2){var n=H1.sprintf("%02x%02x",parseInt(this.parsedAddress[r],10),parseInt(this.parsedAddress[r+1],10));e.push(H1.sprintf("%x",parseInt(n,16)))}return e.join(":")},t.prototype.bigInteger=function(){return new n3.BigInteger(this.parsedAddress.map(function(e){return H1.sprintf("%02x",parseInt(e,10))}).join(""),16)},t.prototype._startAddress=function(){return new n3.BigInteger(this.mask()+"0".repeat(Ta.BITS-this.subnetMask),2)},t.prototype.startAddress=function(){return t.fromBigInteger(this._startAddress())},t.prototype.startAddressExclusive=function(){var e=new n3.BigInteger("1");return t.fromBigInteger(this._startAddress().add(e))},t.prototype._endAddress=function(){return new n3.BigInteger(this.mask()+"1".repeat(Ta.BITS-this.subnetMask),2)},t.prototype.endAddress=function(){return t.fromBigInteger(this._endAddress())},t.prototype.endAddressExclusive=function(){var e=new n3.BigInteger("1");return t.fromBigInteger(this._endAddress().subtract(e))},t.fromBigInteger=function(e){return t.fromInteger(parseInt(e.toString(),10))},t.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},t.prototype.getBitsBase2=function(e,r){return this.binaryZeroPad().slice(e,r)},t.prototype.reverseForm=function(e){e||(e={});var r=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?r:H1.sprintf("%s.in-addr.arpa.",r)},t.prototype.isMulticast=function(){return this.isInSubnet(new t("224.0.0.0/4"))},t.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(Ta.BITS,"0")},t.prototype.groupForV6=function(){var e=this.parsedAddress;return this.address.replace(Ta.RE_ADDRESS,H1.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))},t}();Oc.Address4=wGe});var cC=g(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.RE_URL_WITH_PORT=ln.RE_URL=ln.RE_ZONE_STRING=ln.RE_SUBNET_STRING=ln.RE_BAD_ADDRESS=ln.RE_BAD_CHARACTERS=ln.TYPES=ln.SCOPES=ln.GROUPS=ln.BITS=void 0;ln.BITS=128;ln.GROUPS=8;ln.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"globalThis",15:"Reserved"};ln.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};ln.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;ln.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;ln.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;ln.RE_ZONE_STRING=/%.*$/;ln.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);ln.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)});var uC=g(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});kc.simpleGroup=kc.spanLeadingZeroes=kc.spanAll=kc.spanAllZeroes=void 0;var T0e=r3();function x0e(t){return t.replace(/(0+)/g,'<span class="zero">$1</span>')}kc.spanAllZeroes=x0e;function bGe(t,e){e===void 0&&(e=0);var r=t.split("");return r.map(function(n,i){return T0e.sprintf('<span class="digit value-%s position-%d">%s</span>',n,i+e,x0e(n))}).join("")}kc.spanAll=bGe;function P0e(t){return t.replace(/^(0+)/,'<span class="zero">$1</span>')}function _Ge(t){var e=t.split(":");return e.map(function(r){return P0e(r)}).join(":")}kc.spanLeadingZeroes=_Ge;function vGe(t,e){e===void 0&&(e=0);var r=t.split(":");return r.map(function(n,i){return/group-v4/.test(n)?n:T0e.sprintf('<span class="hover-group group-%d">%s</span>',i+e,P0e(n))})}kc.simpleGroup=vGe});var C0e=g(ai=>{"use strict";var EGe=ai&&ai.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),SGe=ai&&ai.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),AGe=ai&&ai.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&EGe(e,t,r);return SGe(e,t),e};Object.defineProperty(ai,"__esModule",{value:!0});ai.possibleElisions=ai.simpleRegularExpression=ai.ADDRESS_BOUNDARY=ai.padGroup=ai.groupPossibilities=void 0;var RGe=AGe(cC()),$1=r3();function s_(t){return $1.sprintf("(%s)",t.join("|"))}ai.groupPossibilities=s_;function i_(t){return t.length<4?$1.sprintf("0{0,%d}%s",4-t.length,t):t}ai.padGroup=i_;ai.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function IGe(t){var e=[];t.forEach(function(n,i){var s=parseInt(n,16);s===0&&e.push(i)});var r=e.map(function(n){return t.map(function(i,s){if(s===n){var o=s===0||s===RGe.GROUPS-1?":":"";return s_([i_(i),o])}return i_(i)}).join(":")});return r.push(t.map(i_).join(":")),s_(r)}ai.simpleRegularExpression=IGe;function TGe(t,e,r){var n=e?"":":",i=r?"":":",s=[];!e&&!r&&s.push("::"),e&&r&&s.push(""),(r&&!e||!r&&e)&&s.push(":"),s.push($1.sprintf("%s(:0{1,4}){1,%d}",n,t-1)),s.push($1.sprintf("(0{1,4}:){1,%d}%s",t-1,i)),s.push($1.sprintf("(0{1,4}:){%d}0{1,4}",t-1));for(var o=1;o<t-1;o++)for(var a=1;a<t-o;a++)s.push($1.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",a,t-a-o-1));return s_(s)}ai.possibleElisions=TGe});var B0e=g(Co=>{"use strict";var xGe=Co&&Co.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),PGe=Co&&Co.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a_=Co&&Co.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&xGe(e,t,r);return PGe(e,t),e},O0e=Co&&Co.__spreadArray||function(t,e){for(var r=0,n=e.length,i=t.length;r<n;r++,i++)t[i]=e[r];return t};Object.defineProperty(Co,"__esModule",{value:!0});Co.Address6=void 0;var k0e=a_(iC()),lC=a_(sC()),kr=a_(cC()),fC=a_(uC()),Rd=aC(),Id=C0e(),Ou=t_(),Yi=oC(),Xi=r3();function o_(t){if(!t)throw new Error("Assertion failed.")}function CGe(t){for(var e=/(\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}function OGe(t){return t=t.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),t=t.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),t}function kGe(t,e){var r=[],n=[],i;for(i=0;i<t.length;i++)i<e[0]?r.push(t[i]):i>e[1]&&n.push(t[i]);return r.concat(["compact"]).concat(n)}function D0e(t){return Xi.sprintf("%04x",parseInt(t,16))}function N0e(t){return t&255}var DGe=function(){function t(e,r){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=k0e.isInSubnet,this.isCorrect=k0e.isCorrect(kr.BITS),r===void 0?this.groups=kr.GROUPS:this.groups=r,this.address=e;var n=kr.RE_SUBNET_STRING.exec(e);if(n){if(this.parsedSubnet=n[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>kr.BITS)throw new Ou.AddressError("Invalid subnet mask.");e=e.replace(kr.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new Ou.AddressError("Invalid subnet mask.");var i=kr.RE_ZONE_STRING.exec(e);i&&(this.zone=i[0],e=e.replace(kr.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}return t.isValid=function(e){try{return new t(e),!0}catch{return!1}},t.fromBigInteger=function(e){var r=e.toString(16).padStart(32,"0"),n=[],i;for(i=0;i<kr.GROUPS;i++)n.push(r.slice(i*4,(i+1)*4));return new t(n.join(":"))},t.fromURL=function(e){var r,n=null,i;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(i=kr.RE_URL_WITH_PORT.exec(e),i===null)return{error:"failed to parse address with port",address:null,port:null};r=i[1],n=i[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),i=kr.RE_URL.exec(e),i===null)return{error:"failed to parse address from URL",address:null,port:null};r=i[1]}else r=e;return n?(n=parseInt(n,10),(n<0||n>65536)&&(n=null)):n=null,{address:new t(r),port:n}},t.fromAddress4=function(e){var r=new Rd.Address4(e),n=kr.BITS-(lC.BITS-r.subnetMask);return new t("::ffff:"+r.correctForm()+"/"+n)},t.fromArpa=function(e){var r=e.replace(/(\.ip6\.arpa)?\.$/,""),n=7;if(r.length!==63)throw new Ou.AddressError("Invalid 'ip6.arpa' form.");for(var i=r.split(".").reverse(),s=n;s>0;s--){var o=s*4;i.splice(o,0,":")}return r=i.join(""),new t(r)},t.prototype.microsoftTranscription=function(){return Xi.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))},t.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},t.prototype.possibleSubnets=function(e){e===void 0&&(e=128);var r=kr.BITS-this.subnetMask,n=Math.abs(e-kr.BITS),i=r-n;return i<0?"0":CGe(new Yi.BigInteger("2",10).pow(i).toString(10))},t.prototype._startAddress=function(){return new Yi.BigInteger(this.mask()+"0".repeat(kr.BITS-this.subnetMask),2)},t.prototype.startAddress=function(){return t.fromBigInteger(this._startAddress())},t.prototype.startAddressExclusive=function(){var e=new Yi.BigInteger("1");return t.fromBigInteger(this._startAddress().add(e))},t.prototype._endAddress=function(){return new Yi.BigInteger(this.mask()+"1".repeat(kr.BITS-this.subnetMask),2)},t.prototype.endAddress=function(){return t.fromBigInteger(this._endAddress())},t.prototype.endAddressExclusive=function(){var e=new Yi.BigInteger("1");return t.fromBigInteger(this._endAddress().subtract(e))},t.prototype.getScope=function(){var e=kr.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="globalThis unicast"&&e!=="Link local"&&(e="globalThis"),e||"Unknown"},t.prototype.getType=function(){for(var e=0,r=Object.keys(kr.TYPES);e<r.length;e++){var n=r[e];if(this.isInSubnet(new t(n)))return kr.TYPES[n]}return"globalThis unicast"},t.prototype.getBits=function(e,r){return new Yi.BigInteger(this.getBitsBase2(e,r),2)},t.prototype.getBitsBase2=function(e,r){return this.binaryZeroPad().slice(e,r)},t.prototype.getBitsBase16=function(e,r){var n=r-e;if(n%4!==0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,r).toString(16).padStart(n/4,"0")},t.prototype.getBitsPastSubnet=function(){return this.getBitsBase2(this.subnetMask,kr.BITS)},t.prototype.reverseForm=function(e){e||(e={});var r=Math.floor(this.subnetMask/4),n=this.canonicalForm().replace(/:/g,"").split("").slice(0,r).reverse().join(".");return r>0?e.omitSuffix?n:Xi.sprintf("%s.ip6.arpa.",n):e.omitSuffix?"":"ip6.arpa."},t.prototype.correctForm=function(){var e,r=[],n=0,i=[];for(e=0;e<this.parsedAddress.length;e++){var s=parseInt(this.parsedAddress[e],16);s===0&&n++,s!==0&&n>0&&(n>1&&i.push([e-n,e-1]),n=0)}n>1&&i.push([this.parsedAddress.length-n,this.parsedAddress.length-1]);var o=i.map(function(u){return u[1]-u[0]+1});if(i.length>0){var a=o.indexOf(Math.max.apply(Math,o));r=kGe(this.parsedAddress,i[a])}else r=this.parsedAddress;for(e=0;e<r.length;e++)r[e]!=="compact"&&(r[e]=parseInt(r[e],16).toString(16));var c=r.join(":");return c=c.replace(/^compact$/,"::"),c=c.replace(/^compact|compact$/,":"),c=c.replace(/compact/,""),c},t.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(kr.BITS,"0")},t.prototype.parse4in6=function(e){var r=e.split(":"),n=r.slice(-1)[0],i=n.match(lC.RE_ADDRESS);if(i){this.parsedAddress4=i[0],this.address4=new Rd.Address4(this.parsedAddress4);for(var s=0;s<this.address4.groups;s++)if(/^0[0-9]+/.test(this.address4.parsedAddress[s]))throw new Ou.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(lC.RE_ADDRESS,this.address4.parsedAddress.map(OGe).join(".")));this.v4=!0,r[r.length-1]=this.address4.toGroup6(),e=r.join(":")}return e},t.prototype.parse=function(e){e=this.parse4in6(e);var r=e.match(kr.RE_BAD_CHARACTERS);if(r)throw new Ou.AddressError(Xi.sprintf("Bad character%s detected in address: %s",r.length>1?"s":"",r.join("")),e.replace(kr.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var n=e.match(kr.RE_BAD_ADDRESS);if(n)throw new Ou.AddressError(Xi.sprintf("Address failed regex: %s",n.join("")),e.replace(kr.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var i=[],s=e.split("::");if(s.length===2){var o=s[0].split(":"),a=s[1].split(":");o.length===1&&o[0]===""&&(o=[]),a.length===1&&a[0]===""&&(a=[]);var c=this.groups-(o.length+a.length);if(!c)throw new Ou.AddressError("Error parsing groups");this.elidedGroups=c,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,i=i.concat(o);for(var u=0;u<c;u++)i.push("0");i=i.concat(a)}else if(s.length===1)i=e.split(":"),this.elidedGroups=0;else throw new Ou.AddressError("Too many :: groups found");if(i=i.map(function(l){return Xi.sprintf("%x",parseInt(l,16))}),i.length!==this.groups)throw new Ou.AddressError("Incorrect number of groups found");return i},t.prototype.canonicalForm=function(){return this.parsedAddress.map(D0e).join(":")},t.prototype.decimal=function(){return this.parsedAddress.map(function(e){return Xi.sprintf("%05d",parseInt(e,16))}).join(":")},t.prototype.bigInteger=function(){return new Yi.BigInteger(this.parsedAddress.map(D0e).join(""),16)},t.prototype.to4=function(){var e=this.binaryZeroPad().split("");return Rd.Address4.fromHex(new Yi.BigInteger(e.slice(96,128).join(""),2).toString(16))},t.prototype.to4in6=function(){var e=this.to4(),r=new t(this.parsedAddress.slice(0,6).join(":"),6),n=r.correctForm(),i="";return/:$/.test(n)||(i=":"),n+i+e.address},t.prototype.inspectTeredo=function(){var e=this.getBitsBase16(0,32),r=this.getBits(80,96).xor(new Yi.BigInteger("ffff",16)).toString(),n=Rd.Address4.fromHex(this.getBitsBase16(32,64)),i=Rd.Address4.fromHex(this.getBits(96,128).xor(new Yi.BigInteger("ffffffff",16)).toString(16)),s=this.getBits(64,80),o=this.getBitsBase2(64,80),a=s.testBit(15),c=s.testBit(14),u=s.testBit(8),l=s.testBit(9),f=new Yi.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:Xi.sprintf("%s:%s",e.slice(0,4),e.slice(4,8)),server4:n.address,client4:i.address,flags:o,coneNat:a,microsoft:{reserved:c,universalLocal:l,groupIndividual:u,nonce:f},udpPort:r}},t.prototype.inspect6to4=function(){var e=this.getBitsBase16(0,16),r=Rd.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:Xi.sprintf("%s",e.slice(0,4)),gateway:r.address}},t.prototype.to6to4=function(){if(!this.is4())return null;var e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new t(e)},t.prototype.toByteArray=function(){var e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e},t.prototype.toUnsignedByteArray=function(){return this.toByteArray().map(N0e)},t.fromByteArray=function(e){return this.fromUnsignedByteArray(e.map(N0e))},t.fromUnsignedByteArray=function(e){for(var r=new Yi.BigInteger("256",10),n=new Yi.BigInteger("0",10),i=new Yi.BigInteger("1",10),s=e.length-1;s>=0;s--)n=n.add(i.multiply(new Yi.BigInteger(e[s].toString(10),10))),i=i.multiply(r);return t.fromBigInteger(n)},t.prototype.isCanonical=function(){return this.addressMinusSuffix===this.canonicalForm()},t.prototype.isLinkLocal=function(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"},t.prototype.isMulticast=function(){return this.getType()==="Multicast"},t.prototype.is4=function(){return this.v4},t.prototype.isTeredo=function(){return this.isInSubnet(new t("2001::/32"))},t.prototype.is6to4=function(){return this.isInSubnet(new t("2002::/16"))},t.prototype.isLoopback=function(){return this.getType()==="Loopback"},t.prototype.href=function(e){return e===void 0?e="":e=Xi.sprintf(":%s",e),Xi.sprintf("http://[%s]%s/",this.correctForm(),e)},t.prototype.link=function(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);var r=this.correctForm;return e.v4&&(r=this.to4in6),e.className?Xi.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,r.call(this),e.className):Xi.sprintf('<a href="%1$s%2$s">%2$s</a>',e.prefix,r.call(this))},t.prototype.group=function(){if(this.elidedGroups===0)return fC.simpleGroup(this.address).join(":");o_(typeof this.elidedGroups=="number"),o_(typeof this.elisionBegin=="number");var e=[],r=this.address.split("::"),n=r[0],i=r[1];n.length?e.push.apply(e,fC.simpleGroup(n)):e.push("");for(var s=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)s.push(Xi.sprintf("group-%d",o));return e.push(Xi.sprintf('<span class="%s"></span>',s.join(" "))),i.length?e.push.apply(e,fC.simpleGroup(i,this.elisionEnd)):e.push(""),this.is4()&&(o_(this.address4 instanceof Rd.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")},t.prototype.regularExpressionString=function(e){e===void 0&&(e=!1);var r=[],n=new t(this.correctForm());if(n.elidedGroups===0)r.push(Id.simpleRegularExpression(n.parsedAddress));else if(n.elidedGroups===kr.GROUPS)r.push(Id.possibleElisions(kr.GROUPS));else{var i=n.address.split("::");i[0].length&&r.push(Id.simpleRegularExpression(i[0].split(":"))),o_(typeof n.elidedGroups=="number"),r.push(Id.possibleElisions(n.elidedGroups,i[0].length!==0,i[1].length!==0)),i[1].length&&r.push(Id.simpleRegularExpression(i[1].split(":"))),r=[r.join(":")]}return e||(r=O0e(O0e(["(?=^|",Id.ADDRESS_BOUNDARY,"|[^\\w\\:])("],r),[")(?=[^\\w\\:]|",Id.ADDRESS_BOUNDARY,"|$)"])),r.join("")},t.prototype.regularExpression=function(e){return e===void 0&&(e=!1),new RegExp(this.regularExpressionString(e),"i")},t}();Co.Address6=DGe});var L0e=g(Oi=>{"use strict";var NGe=Oi&&Oi.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),BGe=Oi&&Oi.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),LGe=Oi&&Oi.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&NGe(e,t,r);return BGe(e,t),e};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.v6=Oi.AddressError=Oi.Address6=Oi.Address4=void 0;var MGe=aC();Object.defineProperty(Oi,"Address4",{enumerable:!0,get:function(){return MGe.Address4}});var UGe=B0e();Object.defineProperty(Oi,"Address6",{enumerable:!0,get:function(){return UGe.Address6}});var qGe=t_();Object.defineProperty(Oi,"AddressError",{enumerable:!0,get:function(){return qGe.AddressError}});var FGe=LGe(uC());Oi.v6={helpers:FGe}});var yC=g((oLt,pC)=>{"use strict";var M0e=he(),KGe=Object.assign(M0e("libp2p:ip-port-to-multiaddr"),{error:M0e("libp2p:ip-port-to-multiaddr:err")}),{Multiaddr:hC}=yt(),dC=oe(),{Address4:jGe,Address6:VGe}=L0e(),c_={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};function zGe(t,e){if(typeof t!="string")throw dC(new Error(`invalid ip provided: ${t}`),c_.ERR_INVALID_IP_PARAMETER);if(typeof e=="string"&&(e=parseInt(e)),isNaN(e))throw dC(new Error(`invalid port provided: ${e}`),c_.ERR_INVALID_PORT_PARAMETER);try{return new jGe(t),new hC(`/ip4/${t}/tcp/${e}`)}catch{}try{let r=new VGe(t);return r.is4()?new hC(`/ip4/${r.to4().correctForm()}/tcp/${e}`):new hC(`/ip6/${t}/tcp/${e}`)}catch{let n=`invalid ip:port for creating a multiaddr: ${t}:${e}`;throw KGe.error(n),dC(new Error(n),c_.ERR_INVALID_IP)}}pC.exports=zGe;pC.exports.Errors=c_});var q0e=g((aLt,u_)=>{"use strict";var gC=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},U0e=(t,e,r,n)=>{let i,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(t);return}n={customTimers:{setTimeout,clearTimeout},...n},i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{o(r())}catch(l){a(l)}return}let c=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,u=r instanceof Error?r:new gC(c);typeof t.cancel=="function"&&t.cancel(),a(u)},e),(async()=>{try{o(await t)}catch(c){a(c)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return s.clear=()=>{clearTimeout(i),i=void 0},s};u_.exports=U0e;u_.exports.default=U0e;u_.exports.TimeoutError=gC});var z0e=g((cLt,V0e)=>{"use strict";var F0e=Ea(),{CLOSE_TIMEOUT:HGe}=nC(),K0e=yC(),$Ge=q0e(),j0e=he(),mC=j0e("libp2p:websockets:socket");mC.error=j0e("libp2p:websockets:socket:error");V0e.exports=(t,e={})=>{let r={async sink(n){e.signal&&(n=F0e(n,e.signal));try{await t.sink(async function*(){for await(let i of n)yield i instanceof Uint8Array?i:i.slice()}())}catch(i){i.type!=="aborted"&&mC.error(i)}},source:e.signal?F0e(t.source,e.signal):t.source,conn:t,localAddr:e.localAddr||(t.localAddress&&t.localPort?K0e(t.localAddress,t.localPort):void 0),remoteAddr:e.remoteAddr||K0e(t.remoteAddress,t.remotePort),timeline:{open:Date.now()},async close(){let n=Date.now();try{await $Ge(t.close(),HGe)}catch{let{host:s,port:o}=r.remoteAddr.toOptions();mC("timeout closing stream to %s:%s after %dms, destroying it manually",s,o,Date.now()-n),t.destroy()}finally{r.timeline.close=Date.now()}}};return t.socket.once&&t.socket.once("close",()=>{r.timeline.close||(r.timeline.close=Date.now())}),r}});var G0e=g((uLt,$0e)=>{"use strict";var _f=eh(),{CODE_CIRCUIT:wC,CODE_P2P:bC,CODE_TCP:_C,CODE_WS:GGe,CODE_WSS:H0e}=nC();$0e.exports={all:t=>t.filter(e=>{if(e.protoCodes().includes(wC))return!1;let r=e.decapsulateCode(bC);return _f.WebSockets.matches(r)||_f.WebSocketsSecure.matches(r)}),dnsWss:t=>t.filter(e=>{if(e.protoCodes().includes(wC))return!1;let r=e.decapsulateCode(bC);return _f.WebSocketsSecure.matches(r)&&_f.DNS.matches(r.decapsulateCode(_C).decapsulateCode(H0e))}),dnsWsOrWss:t=>t.filter(e=>{if(e.protoCodes().includes(wC))return!1;let r=e.decapsulateCode(bC);return _f.WebSockets.matches(r)?_f.DNS.matches(r.decapsulateCode(_C).decapsulateCode(GGe)):_f.WebSocketsSecure.matches(r)&&_f.DNS.matches(r.decapsulateCode(_C).decapsulateCode(H0e))})}});var e1e=g((lLt,J0e)=>{"use strict";var WGe=_0e(),YGe=r5(),XGe=jw(),{AbortError:W0e}=Ea(),QGe=uc(),Q0e=he(),vf=Q0e("libp2p:websockets");vf.error=Q0e("libp2p:websockets:error");var Y0e=Xy(),ZGe=E0e(),JGe=z0e(),X0e=G0e(),Z0e=class{constructor({upgrader:e,filter:r}){if(!e)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e,this._filter=r}async dial(e,r={}){vf("dialing %s",e);let n=await this._connect(e,r),i=JGe(n,{remoteAddr:e,signal:r.signal});vf("new outbound connection %s",i.remoteAddr);let s=await this._upgrader.upgradeOutbound(i);return vf("outbound connection %s upgraded",i.remoteAddr),s}async _connect(e,r={}){if(r.signal&&r.signal.aborted)throw new W0e;let n=e.toOptions();vf("dialing %s:%s",n.host,n.port);let i=QGe(),s=u=>{let l=`connection error: ${u.message}`;vf.error(l),i.reject(u)},o=WGe(XGe(e),Object.assign({binary:!0},r));if(o.socket.on?o.socket.on("error",s):o.socket.onerror=s,!r.signal)return await Promise.race([o.connected(),i.promise]),vf("connected %s",e),o;let a,c=new Promise((u,l)=>{if(a=()=>{l(new W0e),setTimeout(()=>{o.close()})},r.signal.aborted)return a();r.signal.addEventListener("abort",a)});try{await Promise.race([c,i.promise,o.connected()])}finally{r.signal.removeEventListener("abort",a)}return vf("connected %s",e),o}createListener(e={},r){return typeof e=="function"&&(r=e,e={}),ZGe({handler:r,upgrader:this._upgrader},e)}filter(e){return e=Array.isArray(e)?e:[e],this._filter?this._filter(e):Y0e.isBrowser||Y0e.isWebWorker?X0e.dnsWss(e):X0e.all(e)}};J0e.exports=YGe(Z0e,{className:"WebSockets",symbolName:"@libp2p/js-libp2p-websockets/websockets"})});var r1e=g((fLt,t1e)=>{t1e.exports=function(){if(typeof globalThis>"u")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}});var SC=g((hLt,EC)=>{"use strict";var vC=65536,eWe=4294967295;function tWe(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var rWe=_x().Buffer,l_=globalThis.crypto||globalThis.msCrypto;l_&&l_.getRandomValues?EC.exports=nWe:EC.exports=tWe;function nWe(t,e){if(t>eWe)throw new RangeError("requested too many random bytes");var r=rWe.allocUnsafe(t);if(t>0)if(t>vC)for(var n=0;n<t;n+=vC)l_.getRandomValues(r.slice(n,n+vC));else l_.getRandomValues(r);return typeof e=="function"?process.nextTick(function(){e(null,r)}):r}});var s1e=g((dLt,i1e)=>{"use strict";function n1e(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function iWe(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=void 0),e!=null&&(r.code=e);try{return n1e(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),n1e(new i,r)}}i1e.exports=iWe});var IC=g((pLt,u1e)=>{var sWe=he()("simple-peer"),c1e=r1e(),o1e=SC(),oWe=Lx(),AC=Am(),Dr=s1e(),RC=64*1024,aWe=5*1e3,cWe=5*1e3;function a1e(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function uWe(t){console.warn(t)}var Ef=class extends oWe.Duplex{constructor(e){e=Object.assign({allowHalfOpen:!1},e);super(e);if(this._id=o1e(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||o1e(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||Ef.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},Ef.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(r=>r),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||aWe,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:c1e(),!this._wrtc)throw Dr(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=this.negotiated?!1:!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(r){AC(()=>this.destroy(Dr(r,"ERR_PC_CONSTRUCTOR")));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=r=>{this._onIceCandidate(r)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=r=>{this._setupData(r)},this.streams&&this.streams.forEach(r=>{this.addStream(r)}),this._pc.ontrack=r=>{this._onTrack(r)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw Dr(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(r=>{this._addIceCandidate(r)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(r=>{this.destroy(Dr(r,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(Dr(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){var r=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(r).catch(n=>{!r.address||r.address.endsWith(".local")?uWe("Ignoring unsupported ICE candidate."):this.destroy(Dr(n,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,r){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,r),this._needsNegotiation()}catch(n){this.destroy(Dr(n,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:r}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(r=>{this.addTrack(r,e)})}addTrack(e,r){this._debug("addTrack()");var n=this._senderMap.get(e)||new Map,i=n.get(r);if(!i)i=this._pc.addTrack(e,r),n.set(r,i),this._senderMap.set(e,n),this._needsNegotiation();else throw i.removed?Dr(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):Dr(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,r,n){this._debug("replaceTrack()");var i=this._senderMap.get(e),s=i?i.get(n):null;if(!s)throw Dr(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");r&&this._senderMap.set(r,i),s.replaceTrack!=null?s.replaceTrack(r):this.destroy(Dr(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,r){this._debug("removeSender()");var n=this._senderMap.get(e),i=n?n.get(r):null;if(!i)throw Dr(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{i.removed=!0,this._pc.removeTrack(i)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(i):this.destroy(Dr(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(r=>{this.removeTrack(r,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,AC(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}_destroy(e,r){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,r(e)}_setupData(e){if(!e.channel)return this.destroy(Dr(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=RC),this.channelName=this._channel.label,this._channel.onmessage=n=>{this._onChannelMessage(n)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=n=>{this.destroy(Dr(n,"ERR_DATA_CHANNEL"))};var r=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(r&&this._onChannelClose(),r=!0):r=!1},cWe)}_read(){}_write(e,r,n){if(this.destroyed)return n(Dr(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(i){return this.destroy(Dr(i,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>RC?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n}_onFinish(){if(this.destroyed)return;let e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=a1e(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})}},n=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},i=s=>{this.destroy(Dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(n).catch(i)}).catch(e=>{this.destroy(Dr(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=a1e(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()}},n=()=>{this.destroyed||(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},i=s=>{this.destroy(Dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(n).catch(i)}).catch(e=>{this.destroy(Dr(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(Dr(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,r=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,r),this.emit("iceStateChange",e,r),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(Dr(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(Dr(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){let r=n=>(Object.prototype.toString.call(n.values)==="[object Array]"&&n.values.forEach(i=>{Object.assign(n,i)}),n);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(n=>{var i=[];n.forEach(s=>{i.push(r(s))}),e(null,i)},n=>e(n)):this._pc.getStats.length>0?this._pc.getStats(n=>{if(!this.destroyed){var i=[];n.result().forEach(s=>{var o={};s.names().forEach(a=>{o[a]=s.stat(a)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,i.push(r(o))}),e(null,i)}},n=>e(n)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((r,n)=>{if(this.destroyed)return;r&&(n=[]);var i={},s={},o={},a=!1;n.forEach(l=>{(l.type==="remotecandidate"||l.type==="remote-candidate")&&(i[l.id]=l),(l.type==="localcandidate"||l.type==="local-candidate")&&(s[l.id]=l),(l.type==="candidatepair"||l.type==="candidate-pair")&&(o[l.id]=l)});let c=l=>{a=!0;var f=s[l.localCandidateId];f&&(f.ip||f.address)?(this.localAddress=f.ip||f.address,this.localPort=Number(f.port)):f&&f.ipAddress?(this.localAddress=f.ipAddress,this.localPort=Number(f.portNumber)):typeof l.googLocalAddress=="string"&&(f=l.googLocalAddress.split(":"),this.localAddress=f[0],this.localPort=Number(f[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var h=i[l.remoteCandidateId];h&&(h.ip||h.address)?(this.remoteAddress=h.ip||h.address,this.remotePort=Number(h.port)):h&&h.ipAddress?(this.remoteAddress=h.ipAddress,this.remotePort=Number(h.portNumber)):typeof l.googRemoteAddress=="string"&&(h=l.googRemoteAddress.split(":"),this.remoteAddress=h[0],this.remotePort=Number(h[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(n.forEach(l=>{l.type==="transport"&&l.selectedCandidatePairId&&c(o[l.selectedCandidatePairId]),(l.type==="googCandidatePair"&&l.googActiveConnection==="true"||(l.type==="candidatepair"||l.type==="candidate-pair")&&l.selected)&&c(l)}),!a&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(l){return this.destroy(Dr(l,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var u=this._cb;this._cb=null,u(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>RC||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&!this._firstStable&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var r=e.data;r instanceof ArrayBuffer&&(r=new Uint8Array(r)),this.push(r)}}_onChannelBufferedAmountLow(){if(!(this.destroyed||!this._cb)){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(r=>{this._debug("on track"),this.emit("track",e.track,r),this._remoteTracks.push({track:e.track,stream:r}),!this._remoteStreams.some(n=>n.id===r.id)&&(this._remoteStreams.push(r),AC(()=>{this.emit("stream",r)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],sWe.apply(null,e)}};Ef.WEBRTC_SUPPORT=!!c1e();Ef.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:globalThis.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};Ef.channelConfig={};u1e.exports=Ef});var f1e=g((yLt,l1e)=>{"use strict";l1e.exports={supportsFileReader:typeof self<"u"&&"FileReader"in self,supportsWebRTC:"RTCPeerConnection"in globalThis&&typeof navigator<"u"&&typeof navigator.mediaDevices<"u"&&"getUserMedia"in navigator.mediaDevices,supportsWebRTCDataChannels:"RTCPeerConnection"in globalThis}});var h_=g(f_=>{"use strict";f_.CODE_P2P=421;f_.CODE_CIRCUIT=290;f_.CLOSE_TIMEOUT=2e3});var TC=g(Sf=>{"use strict";Object.defineProperty(Sf,"__esModule",{value:!0});Sf.ERROR_PACKET=Sf.PACKET_TYPES_REVERSE=Sf.PACKET_TYPES=void 0;var Dc=Object.create(null);Sf.PACKET_TYPES=Dc;Dc.open="0";Dc.close="1";Dc.ping="2";Dc.pong="3";Dc.message="4";Dc.upgrade="5";Dc.noop="6";var h1e=Object.create(null);Sf.PACKET_TYPES_REVERSE=h1e;Object.keys(Dc).forEach(t=>{h1e[Dc[t]]=t});var lWe={type:"error",data:"parser error"};Sf.ERROR_PACKET=lWe});var p1e=g(xC=>{"use strict";Object.defineProperty(xC,"__esModule",{value:!0});var fWe=TC(),hWe=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",dWe=typeof ArrayBuffer=="function",pWe=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,yWe=({type:t,data:e},r,n)=>hWe&&e instanceof Blob?r?n(e):d1e(e,n):dWe&&(e instanceof ArrayBuffer||pWe(e))?r?n(e):d1e(new Blob([e]),n):n(fWe.PACKET_TYPES[t]+(e||"")),d1e=(t,e)=>{let r=new FileReader;return r.onload=function(){let n=r.result.split(",")[1];e("b"+n)},r.readAsDataURL(t)};xC.default=yWe});var y1e=g(W1=>{"use strict";Object.defineProperty(W1,"__esModule",{value:!0});W1.decode=W1.encode=void 0;var G1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i3=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<G1.length;t++)i3[G1.charCodeAt(t)]=t;var gWe=t=>{let e=new Uint8Array(t),r,n=e.length,i="";for(r=0;r<n;r+=3)i+=G1[e[r]>>2],i+=G1[(e[r]&3)<<4|e[r+1]>>4],i+=G1[(e[r+1]&15)<<2|e[r+2]>>6],i+=G1[e[r+2]&63];return n%3===2?i=i.substring(0,i.length-1)+"=":n%3===1&&(i=i.substring(0,i.length-2)+"=="),i};W1.encode=gWe;var mWe=t=>{let e=t.length*.75,r=t.length,n,i=0,s,o,a,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);let u=new ArrayBuffer(e),l=new Uint8Array(u);for(n=0;n<r;n+=4)s=i3[t.charCodeAt(n)],o=i3[t.charCodeAt(n+1)],a=i3[t.charCodeAt(n+2)],c=i3[t.charCodeAt(n+3)],l[i++]=s<<2|o>>4,l[i++]=(o&15)<<4|a>>2,l[i++]=(a&3)<<6|c&63;return u};W1.decode=mWe});var m1e=g(PC=>{"use strict";Object.defineProperty(PC,"__esModule",{value:!0});var d_=TC(),wWe=y1e(),bWe=typeof ArrayBuffer=="function",_We=(t,e)=>{if(typeof t!="string")return{type:"message",data:g1e(t,e)};let r=t.charAt(0);return r==="b"?{type:"message",data:vWe(t.substring(1),e)}:d_.PACKET_TYPES_REVERSE[r]?t.length>1?{type:d_.PACKET_TYPES_REVERSE[r],data:t.substring(1)}:{type:d_.PACKET_TYPES_REVERSE[r]}:d_.ERROR_PACKET},vWe=(t,e)=>{if(bWe){let r=(0,wWe.decode)(t);return g1e(r,e)}else return{base64:!0,data:t}},g1e=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};PC.default=_We});var s3=g(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.decodePayload=Oo.decodePacket=Oo.encodePayload=Oo.encodePacket=Oo.protocol=void 0;var w1e=p1e();Oo.encodePacket=w1e.default;var b1e=m1e();Oo.decodePacket=b1e.default;var _1e=String.fromCharCode(30),EWe=(t,e)=>{let r=t.length,n=new Array(r),i=0;t.forEach((s,o)=>{(0,w1e.default)(s,!1,a=>{n[o]=a,++i===r&&e(n.join(_1e))})})};Oo.encodePayload=EWe;var SWe=(t,e)=>{let r=t.split(_1e),n=[];for(let i=0;i<r.length;i++){let s=(0,b1e.default)(r[i],e);if(n.push(s),s.type==="error")break}return n};Oo.decodePayload=SWe;Oo.protocol=4});var Td=g(v1e=>{v1e.Emitter=Qi;function Qi(t){if(t)return AWe(t)}function AWe(t){for(var e in Qi.prototype)t[e]=Qi.prototype[e];return t}Qi.prototype.on=Qi.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Qi.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};Qi.prototype.off=Qi.prototype.removeListener=Qi.prototype.removeAllListeners=Qi.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};Qi.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};Qi.prototype.emitReserved=Qi.prototype.emit;Qi.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Qi.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var o3=g(p_=>{"use strict";Object.defineProperty(p_,"__esModule",{value:!0});p_.globalThisShim=void 0;p_.globalThisShim=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())()});var Y1=g(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0});Af.byteLength=Af.installTimerFunctions=Af.pick=void 0;var y_=o3();function RWe(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}Af.pick=RWe;var IWe=setTimeout,TWe=clearTimeout;function xWe(t,e){e.useNativeTimers?(t.setTimeoutFn=IWe.bind(y_.globalThisShim),t.clearTimeoutFn=TWe.bind(y_.globalThisShim)):(t.setTimeoutFn=setTimeout.bind(y_.globalThisShim),t.clearTimeoutFn=clearTimeout.bind(y_.globalThisShim))}Af.installTimerFunctions=xWe;var PWe=1.33;function CWe(t){return typeof t=="string"?OWe(t):Math.ceil((t.byteLength||t.size)*PWe)}Af.byteLength=CWe;function OWe(t){let e=0,r=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}});var g_=g(X1=>{"use strict";var kWe=X1&&X1.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(X1,"__esModule",{value:!0});X1.Transport=void 0;var DWe=s3(),NWe=Td(),BWe=Y1(),LWe=kWe(he()),MWe=(0,LWe.default)("engine.io-client:transport"),E1e=class extends Error{constructor(e,r,n){super(e);this.description=r,this.context=n,this.type="TransportError"}},S1e=class extends NWe.Emitter{constructor(e){super();this.writable=!1,(0,BWe.installTimerFunctions)(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,r,n){return super.emitReserved("error",new E1e(e,r,n)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):MWe("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let r=(0,DWe.decodePacket)(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}};X1.Transport=S1e});var OC=g(If=>{"use strict";Object.defineProperty(If,"__esModule",{value:!0});If.yeast=If.decode=If.encode=void 0;var I1e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),m_=64,T1e={},A1e=0,Rf=0,R1e;function CC(t){let e="";do e=I1e[t%m_]+e,t=Math.floor(t/m_);while(t>0);return e}If.encode=CC;function UWe(t){let e=0;for(Rf=0;Rf<t.length;Rf++)e=e*m_+T1e[t.charAt(Rf)];return e}If.decode=UWe;function qWe(){let t=CC(+new Date);return t!==R1e?(A1e=0,R1e=t):t+"."+CC(A1e++)}If.yeast=qWe;for(;Rf<m_;Rf++)T1e[I1e[Rf]]=Rf});var w_=g(Q1=>{"use strict";Object.defineProperty(Q1,"__esModule",{value:!0});Q1.decode=Q1.encode=void 0;function FWe(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}Q1.encode=FWe;function KWe(t){let e={},r=t.split("&");for(let n=0,i=r.length;n<i;n++){let s=r[n].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}Q1.decode=KWe});var P1e=g(b_=>{"use strict";Object.defineProperty(b_,"__esModule",{value:!0});b_.hasCORS=void 0;var x1e=!1;try{x1e=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}b_.hasCORS=x1e});var C1e=g(__=>{"use strict";Object.defineProperty(__,"__esModule",{value:!0});__.XHR=void 0;var jWe=P1e(),VWe=o3();function zWe(t){let e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||jWe.hasCORS))return new XMLHttpRequest}catch{}if(!e)try{return new VWe.globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}__.XHR=zWe});var L1e=g(Tf=>{"use strict";var HWe=Tf&&Tf.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Tf,"__esModule",{value:!0});Tf.Request=Tf.Polling=void 0;var $We=g_(),GWe=HWe(he()),WWe=OC(),YWe=w_(),O1e=s3(),N1e=C1e(),XWe=Td(),k1e=Y1(),QWe=o3(),ms=(0,GWe.default)("engine.io-client:polling");function ZWe(){}var JWe=function(){return new N1e.XHR({xdomain:!1}).responseType!=null}(),B1e=class extends $We.Transport{constructor(e){super(e);if(this.polling=!1,typeof location<"u"){let n=location.protocol==="https:",i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port,this.xs=e.secure!==n}let r=e&&e.forceBase64;this.supportsBinary=JWe&&!r}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let r=()=>{ms("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let n=0;this.polling&&(ms("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){ms("pre-pause polling complete"),--n||r()})),this.writable||(ms("we are currently writing - waiting to pause"),n++,this.once("drain",function(){ms("pre-pause writing complete"),--n||r()}))}else r()}poll(){ms("polling"),this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){ms("polling got data %s",e);let r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};(0,O1e.decodePayload)(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"?this.poll():ms('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{ms("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(ms("transport open - closing"),e()):(ms("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,(0,O1e.encodePayload)(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.query||{},r=this.opts.secure?"https":"http",n="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=(0,WWe.yeast)()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(r==="https"&&Number(this.opts.port)!==443||r==="http"&&Number(this.opts.port)!==80)&&(n=":"+this.opts.port);let i=(0,YWe.encode)(e),s=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new ko(this.uri(),e)}doWrite(e,r){let n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){ms("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}};Tf.Polling=B1e;var ko=class extends XWe.Emitter{constructor(e,r){super();(0,k1e.installTimerFunctions)(this,r),this.opts=r,this.method=r.method||"GET",this.uri=e,this.async=r.async!==!1,this.data=r.data!==void 0?r.data:null,this.create()}create(){let e=(0,k1e.pick)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let r=this.xhr=new N1e.XHR(e);try{ms("xhr open %s: %s",this.method,this.uri),r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let n in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(n)&&r.setRequestHeader(n,this.opts.extraHeaders[n])}}catch{}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},ms("xhr data %s",this.data),r.send(this.data)}catch(n){this.setTimeoutFn(()=>{this.onError(n)},0);return}typeof document<"u"&&(this.index=ko.requestsCount++,ko.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=ZWe,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete ko.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};Tf.Request=ko;ko.requestsCount=0;ko.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",D1e);else if(typeof addEventListener=="function"){let t="onpagehide"in QWe.globalThisShim?"pagehide":"unload";addEventListener(t,D1e,!1)}}function D1e(){for(let t in ko.requests)ko.requests.hasOwnProperty(t)&&ko.requests[t].abort()}});var U1e=g(Nc=>{"use strict";Object.defineProperty(Nc,"__esModule",{value:!0});Nc.defaultBinaryType=Nc.usingBrowserWebSocket=Nc.WebSocket=Nc.nextTick=void 0;var M1e=o3();Nc.nextTick=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0))();Nc.WebSocket=M1e.globalThisShim.WebSocket||M1e.globalThisShim.MozWebSocket;Nc.usingBrowserWebSocket=!0;Nc.defaultBinaryType="arraybuffer"});var K1e=g(Z1=>{"use strict";var eYe=Z1&&Z1.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Z1,"__esModule",{value:!0});Z1.WS=void 0;var tYe=g_(),rYe=w_(),nYe=OC(),iYe=Y1(),ku=U1e(),sYe=eYe(he()),oYe=s3(),aYe=(0,sYe.default)("engine.io-client:websocket"),q1e=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",F1e=class extends tYe.Transport{constructor(e){super(e);this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),r=this.opts.protocols,n=q1e?{}:(0,iYe.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=ku.usingBrowserWebSocket&&!q1e?r?new ku.WebSocket(e,r):new ku.WebSocket(e):new ku.WebSocket(e,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType||ku.defaultBinaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){let n=e[r],i=r===e.length-1;(0,oYe.encodePacket)(n,this.supportsBinary,s=>{let o={};ku.usingBrowserWebSocket||(n.options&&(o.compress=n.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(o.compress=!1));try{ku.usingBrowserWebSocket?this.ws.send(s):this.ws.send(s,o)}catch{aYe("websocket closed before onclose event")}i&&(0,ku.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},r=this.opts.secure?"wss":"ws",n="";this.opts.port&&(r==="wss"&&Number(this.opts.port)!==443||r==="ws"&&Number(this.opts.port)!==80)&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=(0,nYe.yeast)()),this.supportsBinary||(e.b64=1);let i=(0,rYe.encode)(e),s=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}check(){return!!ku.WebSocket}};Z1.WS=F1e});var kC=g(v_=>{"use strict";Object.defineProperty(v_,"__esModule",{value:!0});v_.transports=void 0;var cYe=L1e(),uYe=K1e();v_.transports={websocket:uYe.WS,polling:cYe.Polling}});var DC=g(E_=>{"use strict";Object.defineProperty(E_,"__esModule",{value:!0});E_.parse=void 0;var lYe=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fYe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function hYe(t){let e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let i=lYe.exec(t||""),s={},o=14;for(;o--;)s[fYe[o]]=i[o]||"";return r!=-1&&n!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=dYe(s,s.path),s.queryKey=pYe(s,s.query),s}E_.parse=hYe;function dYe(t,e){let r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&n.splice(0,1),e.substr(e.length-1,1)=="/"&&n.splice(n.length-1,1),n}function pYe(t,e){let r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,s){i&&(r[i]=s)}),r}});var H1e=g(J1=>{"use strict";var yYe=J1&&J1.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(J1,"__esModule",{value:!0});J1.Socket=void 0;var gYe=kC(),j1e=Y1(),mYe=w_(),V1e=DC(),wYe=yYe(he()),bYe=Td(),z1e=s3(),en=(0,wYe.default)("engine.io-client:socket"),Du=class extends bYe.Emitter{constructor(e,r={}){super();e&&typeof e=="object"&&(r=e,e=null),e?(e=(0,V1e.parse)(e),r.hostname=e.host,r.secure=e.protocol==="https"||e.protocol==="wss",r.port=e.port,e.query&&(r.query=e.query)):r.host&&(r.hostname=(0,V1e.parse)(r.host).host),(0,j1e.installTimerFunctions)(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=r.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},r),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=(0,mYe.decode)(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){en('creating transport "%s"',e);let r=Object.assign({},this.opts.query);r.EIO=z1e.protocol,r.transport=e,this.id&&(r.sid=this.id);let n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return en("options: %j",n),new gYe.transports[e](n)}open(){let e;if(this.opts.rememberUpgrade&&Du.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(r){en("error while creating transport: %s",r),this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){en("setting transport %s",e.name),this.transport&&(en("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",r=>this.onClose("transport close",r))}probe(e){en('probing transport "%s"',e);let r=this.createTransport(e),n=!1;Du.priorWebsocketSuccess=!1;let i=()=>{n||(en('probe transport "%s" opened',e),r.send([{type:"ping",data:"probe"}]),r.once("packet",f=>{if(!n)if(f.type==="pong"&&f.data==="probe"){if(en('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Du.priorWebsocketSuccess=r.name==="websocket",en('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{n||this.readyState!=="closed"&&(en("changing transport and sending upgrade packet"),l(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{en('probe transport "%s" failed',e);let h=new Error("probe error");h.transport=r.name,this.emitReserved("upgradeError",h)}}))};function s(){n||(n=!0,l(),r.close(),r=null)}let o=f=>{let h=new Error("probe error: "+f);h.transport=r.name,s(),en('probe transport "%s" failed because of error: %s',e,f),this.emitReserved("upgradeError",h)};function a(){o("transport closed")}function c(){o("socket closed")}function u(f){r&&f.name!==r.name&&(en('"%s" works - aborting "%s"',f.name,r.name),s())}let l=()=>{r.removeListener("open",i),r.removeListener("error",o),r.removeListener("close",a),this.off("close",c),this.off("upgrading",u)};r.once("open",i),r.once("error",o),r.once("close",a),this.once("close",c),this.once("upgrading",u),r.open()}onOpen(){if(en("socket open"),this.readyState="open",Du.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){en("starting upgrade probes");let e=0,r=this.upgrades.length;for(;e<r;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(en('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let r=new Error("server error");r.code=e.data,this.onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}else en('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this.getWritablePackets();en("flushing %d packets in socket",e.length),this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){let i=this.writeBuffer[n].data;if(i&&(r+=(0,j1e.byteLength)(i)),n>0&&r>this.maxPayload)return en("only send %d out of %d packets",n,this.writeBuffer.length),this.writeBuffer.slice(0,n);r+=2}return en("payload size is %d (max: %d)",r,this.maxPayload),this.writeBuffer}write(e,r,n){return this.sendPacket("message",e,r,n),this}send(e,r,n){return this.sendPacket("message",e,r,n),this}sendPacket(e,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;let s={type:e,data:r,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){let e=()=>{this.onClose("forced close"),en("socket closing - telling transport to close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}onError(e){en("socket error %j",e),Du.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(en('socket close with reason: "%s"',e),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let r=[],n=0,i=e.length;for(;n<i;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}};J1.Socket=Du;Du.protocol=z1e.protocol});var NC=g(ws=>{"use strict";Object.defineProperty(ws,"__esModule",{value:!0});ws.parse=ws.installTimerFunctions=ws.transports=ws.Transport=ws.protocol=ws.Socket=void 0;var $1e=H1e();Object.defineProperty(ws,"Socket",{enumerable:!0,get:function(){return $1e.Socket}});ws.protocol=$1e.Socket.protocol;var _Ye=g_();Object.defineProperty(ws,"Transport",{enumerable:!0,get:function(){return _Ye.Transport}});var vYe=kC();Object.defineProperty(ws,"transports",{enumerable:!0,get:function(){return vYe.transports}});var EYe=Y1();Object.defineProperty(ws,"installTimerFunctions",{enumerable:!0,get:function(){return EYe.installTimerFunctions}});var SYe=DC();Object.defineProperty(ws,"parse",{enumerable:!0,get:function(){return SYe.parse}})});var W1e=g(ey=>{"use strict";var AYe=ey&&ey.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ey,"__esModule",{value:!0});ey.url=void 0;var RYe=NC(),IYe=AYe(he()),G1e=IYe.default("socket.io-client:url");function TYe(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(G1e("protocol-less url %s",t),typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),G1e("parse %s",t),n=RYe.parse(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let s=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+e,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}ey.url=TYe});var BC=g(ty=>{"use strict";Object.defineProperty(ty,"__esModule",{value:!0});ty.hasBinary=ty.isBinary=void 0;var xYe=typeof ArrayBuffer=="function",PYe=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Y1e=Object.prototype.toString,CYe=typeof Blob=="function"||typeof Blob<"u"&&Y1e.call(Blob)==="[object BlobConstructor]",OYe=typeof File=="function"||typeof File<"u"&&Y1e.call(File)==="[object FileConstructor]";function X1e(t){return xYe&&(t instanceof ArrayBuffer||PYe(t))||CYe&&t instanceof Blob||OYe&&t instanceof File}ty.isBinary=X1e;function S_(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(S_(t[r]))return!0;return!1}if(X1e(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return S_(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&S_(t[r]))return!0;return!1}ty.hasBinary=S_});var Q1e=g(ry=>{"use strict";Object.defineProperty(ry,"__esModule",{value:!0});ry.reconstructPacket=ry.deconstructPacket=void 0;var kYe=BC();function DYe(t){let e=[],r=t.data,n=t;return n.data=LC(r,e),n.attachments=e.length,{packet:n,buffers:e}}ry.deconstructPacket=DYe;function LC(t,e){if(!t)return t;if(kYe.isBinary(t)){let r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){let r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=LC(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){let r={};for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=LC(t[n],e));return r}return t}function NYe(t,e){return t.data=MC(t.data,e),t.attachments=void 0,t}ry.reconstructPacket=NYe;function MC(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=MC(t[r],e);else if(typeof t=="object")for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=MC(t[r],e));return t}});var R_=g(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.Decoder=xa.Encoder=xa.PacketType=xa.protocol=void 0;var BYe=Td(),Z1e=Q1e(),J1e=BC(),LYe=he(),UC=LYe.default("socket.io-parser");xa.protocol=5;var Mn;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Mn=xa.PacketType||(xa.PacketType={}));var eye=class{constructor(e){this.replacer=e}encode(e){return UC("encoding packet %j",e),(e.type===Mn.EVENT||e.type===Mn.ACK)&&J1e.hasBinary(e)?(e.type=e.type===Mn.EVENT?Mn.BINARY_EVENT:Mn.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===Mn.BINARY_EVENT||e.type===Mn.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),UC("encoded %j as %s",e,r),r}encodeAsBinary(e){let r=Z1e.deconstructPacket(e),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}};xa.Encoder=eye;var A_=class extends BYe.Emitter{constructor(e){super();this.reviver=e}add(e){let r;if(typeof e=="string")r=this.decodeString(e),r.type===Mn.BINARY_EVENT||r.type===Mn.BINARY_ACK?(this.reconstructor=new tye(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r);else if(J1e.isBinary(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0,n={type:Number(e.charAt(0))};if(Mn[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===Mn.BINARY_EVENT||n.type===Mn.BINARY_ACK){let s=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);let o=e.substring(s,r);if(o!=Number(o)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(r+1)==="/"){let s=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(s,r)}else n.nsp="/";let i=e.charAt(r+1);if(i!==""&&Number(i)==i){let s=r+1;for(;++r;){let o=e.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===e.length)break}n.id=Number(e.substring(s,r+1))}if(e.charAt(++r)){let s=this.tryParse(e.substr(r));if(A_.isPayloadValid(n.type,s))n.data=s;else throw new Error("invalid payload")}return UC("decoded %s as %j",e,n),n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case Mn.CONNECT:return typeof r=="object";case Mn.DISCONNECT:return r===void 0;case Mn.CONNECT_ERROR:return typeof r=="string"||typeof r=="object";case Mn.EVENT:case Mn.BINARY_EVENT:return Array.isArray(r)&&r.length>0;case Mn.ACK:case Mn.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}};xa.Decoder=A_;var tye=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let r=Z1e.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}});var qC=g(I_=>{"use strict";Object.defineProperty(I_,"__esModule",{value:!0});I_.on=void 0;function MYe(t,e,r){return t.on(e,r),function(){t.off(e,r)}}I_.on=MYe});var FC=g(ny=>{"use strict";var UYe=ny&&ny.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ny,"__esModule",{value:!0});ny.Socket=void 0;var Do=R_(),T_=qC(),qYe=Td(),FYe=UYe(he()),bs=FYe.default("socket.io-client:socket"),KYe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),rye=class extends qYe.Emitter{constructor(e,r,n){super();this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[T_.on(e,"open",this.onopen.bind(this)),T_.on(e,"packet",this.onpacket.bind(this)),T_.on(e,"error",this.onerror.bind(this)),T_.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){if(KYe.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');r.unshift(e);let n={type:Do.PacketType.EVENT,data:r};if(n.options={},n.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){let o=this.ids++;bs("emitting packet with ack id %d",o);let a=r.pop();this._registerAckCallback(o,a),n.id=o}let i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)?bs("discard packet as the transport is not currently writable"):this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n),this.flags={},this}_registerAckCallback(e,r){let n=this.flags.timeout;if(n===void 0){this.acks[e]=r;return}let i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&(bs("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(s,1));bs("event with ack id %d has timed out after %d ms",e,n),r.call(this,new Error("operation has timed out"))},n);this.acks[e]=(...s)=>{this.io.clearTimeoutFn(i),r.apply(this,[null,...s])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){bs("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this.packet({type:Do.PacketType.CONNECT,data:e})}):this.packet({type:Do.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){bs("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Do.PacketType.CONNECT:if(e.data&&e.data.sid){let i=e.data.sid;this.onconnect(i)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Do.PacketType.EVENT:case Do.PacketType.BINARY_EVENT:this.onevent(e);break;case Do.PacketType.ACK:case Do.PacketType.BINARY_ACK:this.onack(e);break;case Do.PacketType.DISCONNECT:this.ondisconnect();break;case Do.PacketType.CONNECT_ERROR:this.destroy();let n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){let r=e.data||[];bs("emitting event %j",r),e.id!=null&&(bs("attaching ack callback to event"),r.push(this.ack(e.id))),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let r=this._anyListeners.slice();for(let n of r)n.apply(this,e)}super.emit.apply(this,e)}ack(e){let r=this,n=!1;return function(...i){n||(n=!0,bs("sending ack %j",i),r.packet({type:Do.PacketType.ACK,id:e,data:i}))}}onack(e){let r=this.acks[e.id];typeof r=="function"?(bs("calling ack %s with %j",e.id,e.data),r.apply(this,e.data),delete this.acks[e.id]):bs("bad ack %s",e.id)}onconnect(e){bs("socket connected with id %s",e),this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){bs("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(bs("performing disconnect (%s)",this.nsp),this.packet({type:Do.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let r=this._anyOutgoingListeners.slice();for(let n of r)n.apply(this,e.data)}}};ny.Socket=rye});var nye=g(x_=>{"use strict";Object.defineProperty(x_,"__esModule",{value:!0});x_.Backoff=void 0;function iy(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}x_.Backoff=iy;iy.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};iy.prototype.reset=function(){this.attempts=0};iy.prototype.setMin=function(t){this.ms=t};iy.prototype.setMax=function(t){this.max=t};iy.prototype.setJitter=function(t){this.jitter=t}});var oye=g(No=>{"use strict";var jYe=No&&No.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),VYe=No&&No.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),zYe=No&&No.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&jYe(e,t,r);return VYe(e,t),e},HYe=No&&No.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(No,"__esModule",{value:!0});No.Manager=void 0;var iye=NC(),$Ye=FC(),GYe=zYe(R_()),xd=qC(),WYe=nye(),YYe=Td(),XYe=HYe(he()),bi=XYe.default("socket.io-client:manager"),sye=class extends YYe.Emitter{constructor(e,r){var n;super();this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,iye.installTimerFunctions(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new WYe.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;let i=r.parser||GYe;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(bi("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;bi("opening %s",this.uri),this.engine=new iye.Socket(this.uri,this.opts);let r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;let i=xd.on(r,"open",function(){n.onopen(),e&&e()}),s=xd.on(r,"error",o=>{bi("error"),n.cleanup(),n._readyState="closed",this.emitReserved("error",o),e?e(o):n.maybeReconnectOnOpen()});if(this._timeout!==!1){let o=this._timeout;bi("connect attempt will timeout after %d",o),o===0&&i();let a=this.setTimeoutFn(()=>{bi("connect attempt timed out after %d",o),i(),r.close(),r.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(i),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){bi("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(xd.on(e,"ping",this.onping.bind(this)),xd.on(e,"data",this.ondata.bind(this)),xd.on(e,"error",this.onerror.bind(this)),xd.on(e,"close",this.onclose.bind(this)),xd.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){bi("error",e),this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n||(n=new $Ye.Socket(this,e,r),this.nsps[e]=n),n}_destroy(e){let r=Object.keys(this.nsps);for(let n of r)if(this.nsps[n].active){bi("socket %s is still active, skipping close",n);return}this._close()}_packet(e){bi("writing packet %j",e);let r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){bi("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){bi("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,r){bi("closed due to %s",e),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)bi("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let r=this.backoff.duration();bi("will wait %dms before reconnect attempt",r),this._reconnecting=!0;let n=this.setTimeoutFn(()=>{e.skipReconnect||(bi("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(bi("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):(bi("reconnect success"),e.onreconnect())}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(function(){clearTimeout(n)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};No.Manager=sye});var lye=g((ki,uye)=>{"use strict";var QYe=ki&&ki.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ki,"__esModule",{value:!0});ki.default=ki.connect=ki.io=ki.Socket=ki.Manager=ki.protocol=void 0;var ZYe=W1e(),P_=oye();Object.defineProperty(ki,"Manager",{enumerable:!0,get:function(){return P_.Manager}});var cye=FC();Object.defineProperty(ki,"Socket",{enumerable:!0,get:function(){return cye.Socket}});var JYe=QYe(he()),aye=JYe.default("socket.io-client"),a3={};function Pd(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};let r=ZYe.url(t,e.path||"/socket.io"),n=r.source,i=r.id,s=r.path,o=a3[i]&&s in a3[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,c;return a?(aye("ignoring socket cache for %s",n),c=new P_.Manager(n,e)):(a3[i]||(aye("new io instance for %s",n),a3[i]=new P_.Manager(n,e)),c=a3[i]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}ki.io=Pd;ki.connect=Pd;ki.default=Pd;Object.assign(Pd,{Manager:P_.Manager,Socket:cye.Socket,io:Pd,connect:Pd});var eXe=R_();Object.defineProperty(ki,"protocol",{enumerable:!0,get:function(){return eXe.protocol}});uye.exports=Pd});var KC=g((HLt,fye)=>{var tXe=R8();fye.exports=t=>async e=>{e=tXe(e);let r=m=>{typeof m.return=="function"&&m.return()},n=null,i=null,s=m=>{n=m,i&&i(m),r(e)},o=null,a=!1,c=()=>{a=!0,o&&o()},u=null,l=!1,f=()=>{l=!0,u&&u()},h=null,d=()=>{h&&h()},p=()=>new Promise((m,_)=>{o=h=m,i=_,t.once("drain",d)}),y=()=>(r(e),new Promise((m,_)=>{if(a||l||n)return m();u=o=m,i=_})),b=()=>{t.removeListener("error",s),t.removeListener("close",c),t.removeListener("finish",f),t.removeListener("drain",d)};t.once("error",s),t.once("close",c),t.once("finish",f);try{for await(let m of e){if(!t.writable||t.destroyed||n)break;t.write(m)===!1&&await p()}}catch(m){n||t.destroy(),n=m}try{if(t.writable&&t.end(),await y(),n)throw n}finally{b()}}});var jC=g(($Lt,hye)=>{var rXe=KC(),nXe=Zm();hye.exports=t=>({sink:rXe(t),source:nXe(t)})});var pye=g((GLt,dye)=>{var iXe=jC();dye.exports=t=>async function*(e){let r=iXe(t),n;if(r.sink(e).catch(i=>{n=i}),yield*r.source,n)throw n}});var yye=g((WLt,sy)=>{sy.exports=Zm();sy.exports.source=Zm();sy.exports.sink=KC();sy.exports.transform=pye();sy.exports.duplex=jC()});var VC=g((YLt,_ye)=>{"use strict";var gye=Ea(),sXe=yye(),{CLOSE_TIMEOUT:oXe}=h_(),mye=yC(),bye=he(),C_=bye("libp2p:webrtc-star:socket");C_.error=bye("libp2p:webrtc-star:socket:error");var wye=(t,e)=>{if(!(!t||!e))try{return mye(t,e)}catch(r){return C_.error(r),mye("0.0.0.0",e)}};_ye.exports=(t,e={})=>{let{sink:r,source:n}=sXe.duplex(t),i=e.remoteAddr||wye(t.remoteAddress,t.remotePort),s=wye(t.localAddress,t.localPort),o={async sink(a){e.signal&&(a=gye(a,e.signal));try{await r(async function*(){for await(let c of a)yield c instanceof Uint8Array?c:c.slice()}())}catch(c){c.type!=="aborted"&&C_.error(c)}},source:e.signal?gye(n,e.signal):n,conn:t,localAddr:s,remoteAddr:i,timeline:{open:Date.now()},close(){if(!t.destroyed)return new Promise((a,c)=>{let u=Date.now(),l=setTimeout(()=>{if(o.remoteAddr){let{host:f,port:h}=o.remoteAddr.toOptions();C_("timeout closing socket to %s:%s after %dms, destroying it manually",f,h,Date.now()-u)}t.destroyed||t.destroy()},oXe);t.once("close",()=>{a()}),t.end(f=>{if(clearTimeout(l),o.timeline.close=Date.now(),f)return c(f)})})}};return t.once("close",()=>{o.timeline.close||(o.timeline.close=Date.now())}),o}});var zC=g((XLt,Eye)=>{"use strict";var{Multiaddr:vye}=yt();function aXe(t){let e=t.toString().split("/"),r=t.protos()[1].name,n=t.protos()[2].name,i=t.stringTuples()[1][1];if(r!=="tcp"||n!=="ws"&&n!=="wss")throw new Error("invalid multiaddr: "+t.toString());if(!vye.isName(t))return"http://"+e[2]+":"+e[4];if(n==="ws")return"http://"+e[2]+(i==="80"?"":":"+i);if(n==="wss")return"https://"+e[2]+(i==="443"?"":":"+i)}function cXe(t){let e="/libp2p-webrtc-star";if(t.indexOf(e)!==-1){t=t.substring(e.length,t.length);let r=new vye(t),n=r.stringTuples().filter(i=>i[0]===421)[0];r=r.decapsulate("p2p"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/p2p/${n[1]}`),t=r.toString()}return t}Eye.exports={cleanUrlSIO:aXe,cleanMultiaddr:cXe}});var Iye=g((QLt,Rye)=>{"use strict";var uXe=Gt(),Aye=he(),Cd=Aye("libp2p:webrtc-star:listener");Cd.error=Aye("libp2p:webrtc-star:listener:error");var lXe=oe(),fXe=lye(),hXe=IC(),dXe=uc(),pXe=VC(),{cleanUrlSIO:yXe}=zC(),{CODE_P2P:Sye}=h_(),gXe={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"};Rye.exports=({handler:t,upgrader:e},r,n={})=>{let i=new uXe,s,o;return i.__connections=[],i.__spChannels=new Map,i.__pendingIntents=new Map,i.listen=a=>{if(s)throw lXe(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let c=dXe();s=a;let u;!a.protoCodes().includes(Sye)&&e.localPeer?u=a.encapsulate(`/p2p/${e.localPeer.toB58String()}`):u=a,i.on("error",()=>c.reject()),o=yXe(a),Cd("Dialing to Signalling Server on: "+o),i.io=fXe.connect(o,gXe);let l=f=>{if(f.answer||f.err||!f.intentId)return;let h=f.intentId,d=i.__pendingIntents.get(h);d||(d=[],i.__pendingIntents.set(h,d));let p=i.__spChannels.get(h);if(p){p.signal(f.signal);return}else if(f.signal.type!=="offer"){d.push(f);return}let y={trickle:!1,...n};r.wrtc&&(y.wrtc=r.wrtc),p=new hXe(y);let b=m=>{Cd.error("incoming connection errored",m)};p.on("error",b),p.once("close",(...m)=>{p.removeListener("error",b)}),p.on("signal",m=>{f.signal=m,f.answer=!0,i.io.emit("ss-handshake",f)}),p.signal(f.signal);for(let m of d)p.signal(m.signal);i.__pendingIntents.set(h,[]),p.once("connect",async()=>{let m=pXe(p);Cd("new inbound connection %s",m.remoteAddr);let _;try{_=await e.upgradeInbound(m)}catch(R){return Cd.error("inbound connection failed to upgrade",R),m.close()}if(!_.remoteAddr)try{_.remoteAddr=a.decapsulateCode(Sye).encapsulate(`/p2p/${_.remotePeer.toB58String()}`)}catch(R){Cd.error("could not determine remote address",R)}Cd("inbound connection %s upgraded",m.remoteAddr),mXe(i,m,h),i.emit("connection",_),t(_)}),i.__spChannels.set(h,p)};return i.io.once("connect_error",f=>c.reject(f)),i.io.once("error",f=>{i.emit("error",f),i.emit("close")}),i.io.on("ws-handshake",l),i.io.on("ws-peer",r._peerDiscovered),i.io.on("connect",()=>{i.io.emit("ss-join",u.toString())}),i.io.once("connect",()=>{i.emit("listening"),c.resolve()}),r.sigReferences.set(o,{listener:i,signallingAddr:u}),c.promise},i.close=async()=>{let a=r.sigReferences.get(o);a&&a.listener.io&&(a.listener.io.emit("ss-leave"),a.listener.io.close()),await Promise.all(i.__connections.map(c=>c.close())),i.emit("close"),i.removeAllListeners(),s=void 0,r.sigReferences.delete(o)},i.getAddrs=()=>[s],i};function mXe(t,e,r){t.__connections.push(e);let n=()=>{t.__connections=t.__connections.filter(i=>i!==e),t.__spChannels.delete(r),t.__pendingIntents.delete(r)};e.conn.once("close",n)}});var Oye=g((ZLt,Cye)=>{"use strict";var xye=he(),Nu=xye("libp2p:webrtc-star");Nu.error=xye("libp2p:webrtc-star:error");var{EventEmitter:wXe}=Gt(),O_=oe(),bXe=r5(),{AbortError:Tye}=Ea(),_Xe=IC(),{supportsWebRTCDataChannels:vXe}=f1e(),{Multiaddr:EXe}=yt(),SXe=eh(),AXe=ft(),{CODE_CIRCUIT:RXe}=h_(),IXe=Iye(),TXe=VC(),{cleanMultiaddr:xXe,cleanUrlSIO:PXe}=zC();function CXe(){}var Pye=class{constructor(e={}){if(!e.upgrader)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e.upgrader,this.sioOptions={transports:["websocket"],"force new connection":!0},e.wrtc&&(this.wrtc=e.wrtc),this.sigReferences=new Map,this.discovery=new wXe,this.discovery.tag="webRTCStar",this.discovery._isStarted=!1,this.discovery.start=()=>{this.discovery._isStarted=!0},this.discovery.stop=()=>{this.discovery._isStarted=!1},this._peerDiscovered=this._peerDiscovered.bind(this)}async dial(e,r={}){let n=await this._connect(e,r),i=TXe(n,{remoteAddr:e,signal:r.signal});Nu("new outbound connection %s",i.remoteAddr);let s=await this._upgrader.upgradeOutbound(i);return Nu("outbound connection %s upgraded",i.remoteAddr),s}_connect(e,r={}){if(r.signal&&r.signal.aborted)throw new Tye;let n={initiator:!0,trickle:!1,...r.spOptions||{}};this.wrtc&&(n.wrtc=this.wrtc);let i=e.toOptions(),s=(~~(Math.random()*1e9)).toString(36)+Date.now();return new Promise((o,a)=>{let c=this.sigReferences.get(PXe(e));if(!c||!c.listener)return a(O_(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let u=c.listener.io,l=Date.now(),f;Nu("dialing %s:%s",i.host,i.port);let h=new _Xe(n),d=_=>{if(!f){let R=`connection error ${i.host}:${i.port}: ${_.message}`;Nu.error(R),m(_)}},p=()=>{Nu("connnection timeout %s:%s",i.host,i.port);let _=O_(new Error(`connection timeout after ${Date.now()-l}ms`),"ERR_CONNECT_TIMEOUT");h.emit("error",_)},y=()=>{f=!0,Nu("connection opened %s:%s",i.host,i.port),m(null)},b=()=>{Nu.error("connection aborted %s:%s",i.host,i.port),h.destroy(),m(new Tye)},m=_=>{h.removeListener("timeout",p),h.removeListener("connect",y),r.signal&&r.signal.removeEventListener("abort",b),_?a(_):o(h)};h.on("error",d),h.once("timeout",p),h.once("connect",y),h.on("close",()=>{h.removeListener("error",d)}),r.signal&&r.signal.addEventListener("abort",b),h.on("signal",_=>{u.emit("ss-handshake",{intentId:s,srcMultiaddr:c.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:_})}),u.on("ws-handshake",_=>{_.intentId===s&&_.err&&(h.destroy(),a(O_(_.err instanceof Error?_.err:new Error(_.err),"ERR_SIGNALLING_FAILED"))),!(_.intentId!==s||!_.answer||h.destroyed)&&h.signal(_.signal)})})}createListener(e={},r){if(!vXe&&!this.wrtc)throw O_(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return typeof e=="function"&&(r=e,e={}),r=r||CXe,IXe({handler:r,upgrader:this._upgrader},this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>r.protoCodes().includes(RXe)?!1:SXe.WebRTCStar.matches(r))}_peerDiscovered(e){if(!this.discovery._isStarted)return;Nu("Peer Discovered:",e),e=xXe(e);let r=new EXe(e),n=AXe.createFromB58String(r.getPeerId());this.discovery.emit("peer",{id:n,multiaddrs:[r]})}};Cye.exports=bXe(Pye,{className:"WebRTCStar",symbolName:"@libp2p/js-libp2p-webrtc-star/webrtcstar"})});var Lye=g((JLt,Bye)=>{"use strict";var k_=ns(),kye=yi(),HC=10*1024,Nye=class{constructor(){this._pool=new Uint8Array(HC),this._poolOffset=0}write(e){let r=this._pool,n=this._poolOffset;k_.encode(e.id<<3|e.type,r,n),n+=k_.encode.bytes,k_.encode(e.data?e.data.length:0,r,n),n+=k_.encode.bytes;let i=r.subarray(this._poolOffset,n);return HC-n<100?(this._pool=new Uint8Array(HC),this._poolOffset=0):this._poolOffset=n,e.data?[i,e.data]:i}},Dye=new Nye;Bye.exports=t=>async function*(){for await(let r of t)Array.isArray(r)?yield new kye(r.map(n=>Dye.write(n))):yield new kye(Dye.write(r))}()});var qye=g((eMt,Uye)=>{"use strict";var D_=ns(),OXe=yi();Uye.exports=t=>async function*(){let r=new Mye;for await(let n of t){let i=r.write(n);i.length&&(yield i)}}();var Mye=class{constructor(){this._buffer=new OXe,this._bufferProxy=new Proxy({},{get:(e,r)=>r[0]==="l"?this._buffer[r]:this._buffer.get(parseInt(r))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);let r=[];for(;this._buffer.length;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch{break}let{id:n,type:i,length:s,offset:o}=this._headerInfo;if(this._buffer.length-o<s)break;r.push({id:n,type:i,data:this._buffer.shallowSlice(o,o+s)}),this._buffer.consume(o+s),this._headerInfo=null}return r}_decodeHeader(e){let r=D_.decode(e),n=D_.decode.bytes,i=D_.decode(e,n);return n+=D_.decode.bytes,{id:r>>3,type:r&7,offset:n,length:i}}}});var Fye=g($C=>{"use strict";$C.encode=Lye();$C.decode=qye()});var WC=g((rMt,GC)=>{"use strict";GC.exports=t=>{t=t||1048576;let e=r=>{if(r.data&&r.data.length>t)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return r=>async function*(){for await(let i of r)Array.isArray(i)?i.forEach(e):e(i),yield i}()};GC.exports.MAX_MSG_SIZE=1048576});var YC=g(c3=>{"use strict";var Bu=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});c3.MessageTypes=Bu;c3.InitiatorMessageTypes=Object.freeze({NEW_STREAM:Bu.NEW_STREAM,MESSAGE:Bu.MESSAGE_INITIATOR,CLOSE:Bu.CLOSE_INITIATOR,RESET:Bu.RESET_INITIATOR});c3.ReceiverMessageTypes=Object.freeze({MESSAGE:Bu.MESSAGE_RECEIVER,CLOSE:Bu.CLOSE_RECEIVER,RESET:Bu.RESET_RECEIVER});c3.MessageTypeNames=Object.freeze(Object.entries(Bu).reduce((t,e)=>(t[e[1]]=e[0],t),{}))});var Vye=g((iMt,jye)=>{"use strict";var kXe=Ea(),u3=he()("libp2p:mplex:stream"),DXe=ac(),Kye=yi(),NXe=oe(),{MAX_MSG_SIZE:BXe}=WC(),{InitiatorMessageTypes:LXe,ReceiverMessageTypes:MXe}=YC(),XC="ERR_MPLEX_STREAM_RESET",UXe="ERR_MPLEX_STREAM_ABORT";jye.exports=({id:t,name:e,send:r,onEnd:n=()=>{},type:i="initiator",maxMsgSize:s=BXe})=>{let o=new AbortController,a=new AbortController,c=i==="initiator"?LXe:MXe,u=i==="initiator"?`i${t}`:`r${t}`;e=String(e??t);let l=!1,f=!1,h,d=b=>{l||(l=!0,u3("%s stream %s source end",i,e,b),b&&!h&&(h=b),f&&(y.timeline.close=Date.now(),n(h)))},p=b=>{f||(f=!0,u3("%s stream %s sink end",i,e,b),b&&!h&&(h=b),l&&(y.timeline.close=Date.now(),n(h)))},y={close:()=>y.source.end(),abort:b=>{u3("%s stream %s abort",i,e,b),y.source.end(b),o.abort(),p(b)},reset:()=>{let b=NXe(new Error("stream reset"),XC);a.abort(),y.source.end(b),p(b)},sink:async b=>{b=kXe(b,[{signal:o.signal,options:{abortMessage:"stream aborted",abortCode:UXe}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:XC}}]),i==="initiator"&&r({id:t,type:c.NEW_STREAM,data:e});try{for await(let m of b)for(;m.length;){if(m.length<=s){r({id:t,type:c.MESSAGE,data:m});break}m=Kye.isBufferList(m)?m:new Kye(m),r({id:t,type:c.MESSAGE,data:m.shallowSlice(0,s)}),m.consume(s)}}catch(m){return m.code===XC?u3("%s stream %s reset",i,e):(u3("%s stream %s error",i,e,m),r({id:t,type:c.RESET})),y.source.end(m),p(m)}r({id:t,type:c.CLOSE}),p()},source:DXe(d),timeline:{open:Date.now(),close:null},id:u};return y}});var Gye=g((sMt,$ye)=>{"use strict";var qXe=br(),FXe=ac(),Lu=he()("libp2p:mplex"),KXe=Ea(),zye=Fye(),jXe=WC(),{MessageTypes:Od,MessageTypeNames:Hye}=YC(),VXe=Vye(),QC=class{constructor(e){e=e||{},e=typeof e=="function"?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){let e=[];return this._streams.initiators.forEach(r=>{e.push(r)}),this._streams.receivers.forEach(r=>{e.push(r)}),e}newStream(e){let r=this._streamId++;e=e==null?r.toString():String(e);let n=this._streams.initiators;return this._newStream({id:r,name:e,type:"initiator",registry:n})}_newReceiverStream({id:e,name:r}){let n=this._streams.receivers;return this._newStream({id:e,name:r,type:"receiver",registry:n})}_newStream({id:e,name:r,type:n,registry:i}){if(i.has(e))throw new Error(`${n} stream ${e} already exists!`);Lu("new %s stream %s %s",n,e,r);let a=VXe({id:e,name:r,send:c=>(Lu.enabled&&Lu("%s stream %s %s send",n,e,r,{...c,type:Hye[c.type],data:c.data&&c.data.slice()}),this.source.push(c)),type:n,onEnd:()=>{Lu("%s stream %s %s ended",n,e,r),i.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return i.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=KXe(e,this._options.signal));try{await qXe(e,zye.decode,jXe(this._options.maxMsgSize),async r=>{for await(let n of r)for(let i of n)this._handleIncoming(i)})}catch(r){return Lu("error in sink",r),this.source.end(r)}this.source.end()}}_createSource(){let r=FXe({onEnd:n=>{let{initiators:i,receivers:s}=this._streams;for(let o of i.values())o.abort(n);for(let o of s.values())o.abort(n)},writev:!0});return Object.assign(zye.encode(r),{push:r.push,end:r.end,return:r.return})}_handleIncoming({id:e,type:r,data:n}){if(Lu.enabled&&Lu("incoming message",{id:e,type:Hye[r],data:n.slice()}),r===Od.NEW_STREAM&&this.onStream){let o=this._newReceiverStream({id:e,name:n.toString()});return this.onStream(o)}let s=(r&1?this._streams.initiators:this._streams.receivers).get(e);if(!s)return Lu("missing stream %s",e);switch(r){case Od.MESSAGE_INITIATOR:case Od.MESSAGE_RECEIVER:s.source.push(n);break;case Od.CLOSE_INITIATOR:case Od.CLOSE_RECEIVER:s.close();break;case Od.RESET_INITIATOR:case Od.RESET_RECEIVER:s.reset();break;default:Lu("unknown message type %s",r)}}};QC.multicodec="/mplex/6.7.0";$ye.exports=QC});var Yye=g((oMt,Wye)=>{"use strict";Wye.exports=Gye()});var Qye=g(ZC=>{"use strict";Object.defineProperty(ZC,"__esModule",{value:!0});var Xye=65536,zXe=function(){function t(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var r=new Uint8Array(e),n=0;n<r.length;n+=Xye)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Xye)));return r},t}();ZC.BrowserRandomSource=zXe});var Bc=g(JC=>{"use strict";Object.defineProperty(JC,"__esModule",{value:!0});function HXe(t){for(var e=0;e<t.length;e++)t[e]=0;return t}JC.wipe=HXe});var Zye=g(eO=>{"use strict";Object.defineProperty(eO,"__esModule",{value:!0});var $Xe=Bc(),GXe=function(){function t(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof La<"u"){var e=nh();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var n=new Uint8Array(e),i=0;i<n.length;i++)n[i]=r[i];return $Xe.wipe(r),n},t}();eO.NodeRandomSource=GXe});var Jye=g(tO=>{"use strict";Object.defineProperty(tO,"__esModule",{value:!0});var WXe=Qye(),YXe=Zye(),XXe=function(){function t(){if(this.isAvailable=!1,this.name="",this._source=new WXe.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new YXe.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return t.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},t}();tO.SystemRandomSource=XXe});var e2e=g(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});function QXe(t,e){var r=t>>>16&65535,n=t&65535,i=e>>>16&65535,s=e&65535;return n*s+(r*s+n*i<<16>>>0)|0}qs.mul=Math.imul||QXe;function ZXe(t,e){return t+e|0}qs.add=ZXe;function JXe(t,e){return t-e|0}qs.sub=JXe;function eQe(t,e){return t<<e|t>>>32-e}qs.rotl=eQe;function tQe(t,e){return t<<32-e|t>>>e}qs.rotr=tQe;function rQe(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}qs.isInteger=Number.isInteger||rQe;qs.MAX_SAFE_INTEGER=9007199254740991;qs.isSafeInteger=function(t){return qs.isInteger(t)&&t>=-qs.MAX_SAFE_INTEGER&&t<=qs.MAX_SAFE_INTEGER}});var l3=g(It=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});var t2e=e2e();function nQe(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}It.readInt16BE=nQe;function iQe(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}It.readUint16BE=iQe;function sQe(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}It.readInt16LE=sQe;function oQe(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}It.readUint16LE=oQe;function r2e(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}It.writeUint16BE=r2e;It.writeInt16BE=r2e;function n2e(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}It.writeUint16LE=n2e;It.writeInt16LE=n2e;function rO(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}It.readInt32BE=rO;function nO(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}It.readUint32BE=nO;function iO(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}It.readInt32LE=iO;function sO(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}It.readUint32LE=sO;function N_(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}It.writeUint32BE=N_;It.writeInt32BE=N_;function B_(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}It.writeUint32LE=B_;It.writeInt32LE=B_;function aQe(t,e){e===void 0&&(e=0);var r=rO(t,e),n=rO(t,e+4);return r*4294967296+n-(n>>31)*4294967296}It.readInt64BE=aQe;function cQe(t,e){e===void 0&&(e=0);var r=nO(t,e),n=nO(t,e+4);return r*4294967296+n}It.readUint64BE=cQe;function uQe(t,e){e===void 0&&(e=0);var r=iO(t,e),n=iO(t,e+4);return n*4294967296+r-(r>>31)*4294967296}It.readInt64LE=uQe;function lQe(t,e){e===void 0&&(e=0);var r=sO(t,e),n=sO(t,e+4);return n*4294967296+r}It.readUint64LE=lQe;function i2e(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),N_(t/4294967296>>>0,e,r),N_(t>>>0,e,r+4),e}It.writeUint64BE=i2e;It.writeInt64BE=i2e;function s2e(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),B_(t>>>0,e,r),B_(t/4294967296>>>0,e,r+4),e}It.writeUint64LE=s2e;It.writeInt64LE=s2e;function fQe(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}It.readUintBE=fQe;function hQe(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}It.readUintLE=hQe;function dQe(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!t2e.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}It.writeUintBE=dQe;function pQe(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!t2e.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}It.writeUintLE=pQe;function yQe(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}It.readFloat32BE=yQe;function gQe(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}It.readFloat32LE=gQe;function mQe(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}It.readFloat64BE=mQe;function wQe(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}It.readFloat64LE=wQe;function bQe(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}It.writeFloat32BE=bQe;function _Qe(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}It.writeFloat32LE=_Qe;function vQe(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}It.writeFloat64BE=vQe;function EQe(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}It.writeFloat64LE=EQe});var u2e=g(Pa=>{"use strict";Object.defineProperty(Pa,"__esModule",{value:!0});var SQe=Jye(),AQe=l3(),o2e=Bc();Pa.defaultRandomSource=new SQe.SystemRandomSource;function oO(t,e){return e===void 0&&(e=Pa.defaultRandomSource),e.randomBytes(t)}Pa.randomBytes=oO;function RQe(t){t===void 0&&(t=Pa.defaultRandomSource);var e=oO(4,t),r=AQe.readUint32LE(e);return o2e.wipe(e),r}Pa.randomUint32=RQe;var a2e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c2e(t,e,r){if(e===void 0&&(e=a2e),r===void 0&&(r=Pa.defaultRandomSource),e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");for(var n="",i=e.length,s=256-256%i;t>0;){for(var o=oO(Math.ceil(t*256/s),r),a=0;a<o.length&&t>0;a++){var c=o[a];c<s&&(n+=e.charAt(c%i),t--)}o2e.wipe(o)}return n}Pa.randomString=c2e;function IQe(t,e,r){e===void 0&&(e=a2e),r===void 0&&(r=Pa.defaultRandomSource);var n=Math.ceil(t/(Math.log(e.length)/Math.LN2));return c2e(n,e,r)}Pa.randomStringForEntropy=IQe});var U_=g(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});var TQe=u2e(),xQe=Bc();_s.PUBLIC_KEY_LENGTH=32;_s.SECRET_KEY_LENGTH=32;_s.SHARED_KEY_LENGTH=32;function Lc(t){var e=new Float64Array(16);if(t)for(var r=0;r<t.length;r++)e[r]=t[r];return e}var l2e=new Uint8Array(32);l2e[0]=9;var PQe=Lc([56129,1]);function aO(t){for(var e=1,r=0;r<16;r++){var n=t[r]+e+65535;e=Math.floor(n/65536),t[r]=n-e*65536}t[0]+=e-1+37*(e-1)}function f3(t,e,r){for(var n=~(r-1),i=0;i<16;i++){var s=n&(t[i]^e[i]);t[i]^=s,e[i]^=s}}function CQe(t,e){for(var r=Lc(),n=Lc(),i=0;i<16;i++)n[i]=e[i];aO(n),aO(n),aO(n);for(var s=0;s<2;s++){r[0]=n[0]-65517;for(var i=1;i<15;i++)r[i]=n[i]-65535-(r[i-1]>>16&1),r[i-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);var o=r[15]>>16&1;r[14]&=65535,f3(n,r,1-o)}for(var i=0;i<16;i++)t[2*i]=n[i]&255,t[2*i+1]=n[i]>>8}function OQe(t,e){for(var r=0;r<16;r++)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function L_(t,e,r){for(var n=0;n<16;n++)t[n]=e[n]+r[n]}function M_(t,e,r){for(var n=0;n<16;n++)t[n]=e[n]-r[n]}function Mu(t,e,r){var n,i,s=0,o=0,a=0,c=0,u=0,l=0,f=0,h=0,d=0,p=0,y=0,b=0,m=0,_=0,R=0,k=0,P=0,x=0,D=0,U=0,M=0,ae=0,ne=0,de=0,me=0,Ke=0,xe=0,Ue=0,ie=0,Ve=0,pt=0,Je=r[0],et=r[1],pe=r[2],J=r[3],Ie=r[4],ze=r[5],We=r[6],De=r[7],ht=r[8],T=r[9],O=r[10],N=r[11],Y=r[12],K=r[13],W=r[14],ee=r[15];n=e[0],s+=n*Je,o+=n*et,a+=n*pe,c+=n*J,u+=n*Ie,l+=n*ze,f+=n*We,h+=n*De,d+=n*ht,p+=n*T,y+=n*O,b+=n*N,m+=n*Y,_+=n*K,R+=n*W,k+=n*ee,n=e[1],o+=n*Je,a+=n*et,c+=n*pe,u+=n*J,l+=n*Ie,f+=n*ze,h+=n*We,d+=n*De,p+=n*ht,y+=n*T,b+=n*O,m+=n*N,_+=n*Y,R+=n*K,k+=n*W,P+=n*ee,n=e[2],a+=n*Je,c+=n*et,u+=n*pe,l+=n*J,f+=n*Ie,h+=n*ze,d+=n*We,p+=n*De,y+=n*ht,b+=n*T,m+=n*O,_+=n*N,R+=n*Y,k+=n*K,P+=n*W,x+=n*ee,n=e[3],c+=n*Je,u+=n*et,l+=n*pe,f+=n*J,h+=n*Ie,d+=n*ze,p+=n*We,y+=n*De,b+=n*ht,m+=n*T,_+=n*O,R+=n*N,k+=n*Y,P+=n*K,x+=n*W,D+=n*ee,n=e[4],u+=n*Je,l+=n*et,f+=n*pe,h+=n*J,d+=n*Ie,p+=n*ze,y+=n*We,b+=n*De,m+=n*ht,_+=n*T,R+=n*O,k+=n*N,P+=n*Y,x+=n*K,D+=n*W,U+=n*ee,n=e[5],l+=n*Je,f+=n*et,h+=n*pe,d+=n*J,p+=n*Ie,y+=n*ze,b+=n*We,m+=n*De,_+=n*ht,R+=n*T,k+=n*O,P+=n*N,x+=n*Y,D+=n*K,U+=n*W,M+=n*ee,n=e[6],f+=n*Je,h+=n*et,d+=n*pe,p+=n*J,y+=n*Ie,b+=n*ze,m+=n*We,_+=n*De,R+=n*ht,k+=n*T,P+=n*O,x+=n*N,D+=n*Y,U+=n*K,M+=n*W,ae+=n*ee,n=e[7],h+=n*Je,d+=n*et,p+=n*pe,y+=n*J,b+=n*Ie,m+=n*ze,_+=n*We,R+=n*De,k+=n*ht,P+=n*T,x+=n*O,D+=n*N,U+=n*Y,M+=n*K,ae+=n*W,ne+=n*ee,n=e[8],d+=n*Je,p+=n*et,y+=n*pe,b+=n*J,m+=n*Ie,_+=n*ze,R+=n*We,k+=n*De,P+=n*ht,x+=n*T,D+=n*O,U+=n*N,M+=n*Y,ae+=n*K,ne+=n*W,de+=n*ee,n=e[9],p+=n*Je,y+=n*et,b+=n*pe,m+=n*J,_+=n*Ie,R+=n*ze,k+=n*We,P+=n*De,x+=n*ht,D+=n*T,U+=n*O,M+=n*N,ae+=n*Y,ne+=n*K,de+=n*W,me+=n*ee,n=e[10],y+=n*Je,b+=n*et,m+=n*pe,_+=n*J,R+=n*Ie,k+=n*ze,P+=n*We,x+=n*De,D+=n*ht,U+=n*T,M+=n*O,ae+=n*N,ne+=n*Y,de+=n*K,me+=n*W,Ke+=n*ee,n=e[11],b+=n*Je,m+=n*et,_+=n*pe,R+=n*J,k+=n*Ie,P+=n*ze,x+=n*We,D+=n*De,U+=n*ht,M+=n*T,ae+=n*O,ne+=n*N,de+=n*Y,me+=n*K,Ke+=n*W,xe+=n*ee,n=e[12],m+=n*Je,_+=n*et,R+=n*pe,k+=n*J,P+=n*Ie,x+=n*ze,D+=n*We,U+=n*De,M+=n*ht,ae+=n*T,ne+=n*O,de+=n*N,me+=n*Y,Ke+=n*K,xe+=n*W,Ue+=n*ee,n=e[13],_+=n*Je,R+=n*et,k+=n*pe,P+=n*J,x+=n*Ie,D+=n*ze,U+=n*We,M+=n*De,ae+=n*ht,ne+=n*T,de+=n*O,me+=n*N,Ke+=n*Y,xe+=n*K,Ue+=n*W,ie+=n*ee,n=e[14],R+=n*Je,k+=n*et,P+=n*pe,x+=n*J,D+=n*Ie,U+=n*ze,M+=n*We,ae+=n*De,ne+=n*ht,de+=n*T,me+=n*O,Ke+=n*N,xe+=n*Y,Ue+=n*K,ie+=n*W,Ve+=n*ee,n=e[15],k+=n*Je,P+=n*et,x+=n*pe,D+=n*J,U+=n*Ie,M+=n*ze,ae+=n*We,ne+=n*De,de+=n*ht,me+=n*T,Ke+=n*O,xe+=n*N,Ue+=n*Y,ie+=n*K,Ve+=n*W,pt+=n*ee,s+=38*P,o+=38*x,a+=38*D,c+=38*U,u+=38*M,l+=38*ae,f+=38*ne,h+=38*de,d+=38*me,p+=38*Ke,y+=38*xe,b+=38*Ue,m+=38*ie,_+=38*Ve,R+=38*pt,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=_+i+65535,i=Math.floor(n/65536),_=n-i*65536,n=R+i+65535,i=Math.floor(n/65536),R=n-i*65536,n=k+i+65535,i=Math.floor(n/65536),k=n-i*65536,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=_+i+65535,i=Math.floor(n/65536),_=n-i*65536,n=R+i+65535,i=Math.floor(n/65536),R=n-i*65536,n=k+i+65535,i=Math.floor(n/65536),k=n-i*65536,s+=i-1+37*(i-1),t[0]=s,t[1]=o,t[2]=a,t[3]=c,t[4]=u,t[5]=l,t[6]=f,t[7]=h,t[8]=d,t[9]=p,t[10]=y,t[11]=b,t[12]=m,t[13]=_,t[14]=R,t[15]=k}function h3(t,e){Mu(t,e,e)}function kQe(t,e){for(var r=Lc(),n=0;n<16;n++)r[n]=e[n];for(var n=253;n>=0;n--)h3(r,r),n!==2&&n!==4&&Mu(r,r,e);for(var n=0;n<16;n++)t[n]=r[n]}function cO(t,e){for(var r=new Uint8Array(32),n=new Float64Array(80),i=Lc(),s=Lc(),o=Lc(),a=Lc(),c=Lc(),u=Lc(),l=0;l<31;l++)r[l]=t[l];r[31]=t[31]&127|64,r[0]&=248,OQe(n,e);for(var l=0;l<16;l++)s[l]=n[l];i[0]=a[0]=1;for(var l=254;l>=0;--l){var f=r[l>>>3]>>>(l&7)&1;f3(i,s,f),f3(o,a,f),L_(c,i,o),M_(i,i,o),L_(o,s,a),M_(s,s,a),h3(a,c),h3(u,i),Mu(i,o,i),Mu(o,s,c),L_(c,i,o),M_(i,i,o),h3(s,i),M_(o,a,u),Mu(i,o,PQe),L_(i,i,a),Mu(o,o,i),Mu(i,a,u),Mu(a,s,n),h3(s,c),f3(i,s,f),f3(o,a,f)}for(var l=0;l<16;l++)n[l+16]=i[l],n[l+32]=o[l],n[l+48]=s[l],n[l+64]=a[l];var h=n.subarray(32),d=n.subarray(16);kQe(h,h),Mu(d,d,h);var p=new Uint8Array(32);return CQe(p,d),p}_s.scalarMult=cO;function f2e(t){return cO(t,l2e)}_s.scalarMultBase=f2e;function h2e(t){if(t.length!==_s.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+_s.SECRET_KEY_LENGTH+" bytes");var e=new Uint8Array(t),r=f2e(e);return{publicKey:r,secretKey:e}}_s.generateKeyPairFromSeed=h2e;function DQe(t){var e=TQe.randomBytes(32,t),r=h2e(e);return xQe.wipe(e),r}_s.generateKeyPair=DQe;function NQe(t,e,r){if(r===void 0&&(r=!1),t.length!==_s.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==_s.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var n=cO(t,e);if(r){for(var i=0,s=0;s<n.length;s++)i|=n[s];if(i===0)throw new Error("X25519: invalid shared key")}return n}_s.sharedKey=NQe});var kd=g((yMt,d2e)=>{"use strict";var BQe=yw(),LQe=ac(),MQe=uc();d2e.exports=t=>{let e=LQe(),r=BQe(t.source),n=MQe(),i,s=t.sink(async function*(){yield*e,yield*await n.promise}());return s.catch(a=>{i=a}),{reader:r,writer:e,stream:{sink:a=>i?Promise.reject(i):(n.resolve(a),s),source:r},rest:()=>e.end(),write:e.push,read:async()=>(await r.next()).value}}});var g2e=g((gMt,y2e)=>{"use strict";var UQe=kd(),p2e=xo();y2e.exports=(t,e={})=>{let r=UQe(t),n=p2e.decode.fromReader(r.reader,e),i=!1,s={read:async o=>{let{value:a,done:c}=await r.reader.next(o);if(c&&a.length<o)throw new Error("Couldn't read enough bytes");if(i=c,!a)throw new Error("Value is null");return a},readLP:async()=>{let{value:o,done:a}=await n.next();if(i=a,!o)throw new Error("Value is null");return o},readPB:async o=>{let a=await s.readLP();if(!a)throw new Error("Value is null");let c=a instanceof Uint8Array?a:a.slice();return o.decode(c)},write:o=>{r.writer.push(o)},writeLP:o=>{s.write(p2e.encode.single(o,e))},writePB:(o,a)=>{s.writeLP(a.encode(o))},pb:o=>({read:()=>s.readPB(o),write:a=>s.writePB(a,o)}),unwrap:()=>(r.rest(),r.stream)};return s}});var w2e=g((mMt,m2e)=>{"use strict";var qQe=R8();m2e.exports=function(){let e,r,n=async s=>{if(e)throw new Error("already piped");e=qQe(s),r&&r(e)},i={[Symbol.asyncIterator](){return this},next(){return e?e.next():new Promise(s=>{r=o=>{r=null,s(o.next())}})}};return{sink:n,source:i}}});var v2e=g((wMt,_2e)=>{var b2e=w2e();_2e.exports=function(){var t=b2e(),e=b2e();return[{source:t.source,sink:e.sink},{source:e.source,sink:t.sink}]}});var K_=g((bMt,d3)=>{"use strict";var{Buffer:F_}=On(),q_=yi();d3.exports=async function*(t){for await(let e of t)F_.isBuffer(e)?yield e:q_.isBufferList(e)?yield e.slice():yield F_.from(e)};d3.exports.toBuffer=d3.exports;d3.exports.toList=async function*(t){for await(let e of t)F_.isBuffer(e)?yield new q_().append(e):q_.isBufferList(e)?yield e:yield new q_().append(F_.from(e))}});var E2e=g(uO=>{"use strict";Object.defineProperty(uO,"__esModule",{value:!0});function FQe(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}uO.isSerializableHash=FQe});var j_=g(oy=>{"use strict";Object.defineProperty(oy,"__esModule",{value:!0});function KQe(t,e,r){return~(t-1)&e|t-1&r}oy.select=KQe;function jQe(t,e){return(t|0)-(e|0)-1>>>31&1}oy.lessOrEqual=jQe;function S2e(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}oy.compare=S2e;function VQe(t,e){return t.length===0||e.length===0?!1:S2e(t,e)!==0}oy.equal=VQe});var R2e=g(p3=>{"use strict";Object.defineProperty(p3,"__esModule",{value:!0});var Mc=E2e(),zQe=j_(),HQe=Bc(),A2e=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),Mc.isSerializableHash(this._inner)&&Mc.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),HQe.wipe(n)}return t.prototype.reset=function(){if(!Mc.isSerializableHash(this._inner)||!Mc.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Mc.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Mc.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Mc.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Mc.isSerializableHash(this._inner)||!Mc.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Mc.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();p3.HMAC=A2e;function $Qe(t,e,r){var n=new A2e(t,e);n.update(r);var i=n.digest();return n.clean(),i}p3.hmac=$Qe;p3.equal=zQe.equal});var x2e=g(lO=>{"use strict";Object.defineProperty(lO,"__esModule",{value:!0});var I2e=R2e(),T2e=Bc(),GQe=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=I2e.hmac(this._hash,n,r);this._hmac=new I2e.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),T2e.wipe(this._buffer),T2e.wipe(this._counter),this._bufpos=0},t}();lO.HKDF=GQe});var hO=g(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});var z_=l3(),V_=Bc();xf.DIGEST_LENGTH=32;xf.BLOCK_SIZE=64;var P2e=function(){function t(){this.digestLength=xf.DIGEST_LENGTH,this.blockSize=xf.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return t.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},t.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},t.prototype.clean=function(){V_.wipe(this._buffer),V_.wipe(this._temp),this.reset()},t.prototype.update=function(e,r){if(r===void 0&&(r=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var n=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&r>0;)this._buffer[this._bufferLength++]=e[n++],r--;this._bufferLength===this.blockSize&&(fO(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(n=fO(this._temp,this._state,e,n,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[n++],r--;return this},t.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,n=this._bufferLength,i=r/536870912|0,s=r<<3,o=r%64<56?64:128;this._buffer[n]=128;for(var a=n+1;a<o-8;a++)this._buffer[a]=0;z_.writeUint32BE(i,this._buffer,o-8),z_.writeUint32BE(s,this._buffer,o-4),fO(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)z_.writeUint32BE(this._state[a],e,a*4);return this},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},t.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},t.prototype.cleanSavedState=function(e){V_.wipe(e.state),e.buffer&&V_.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},t}();xf.SHA256=P2e;var WQe=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function fO(t,e,r,n,i){for(;i>=64;){for(var s=e[0],o=e[1],a=e[2],c=e[3],u=e[4],l=e[5],f=e[6],h=e[7],d=0;d<16;d++){var p=n+d*4;t[d]=z_.readUint32BE(r,p)}for(var d=16;d<64;d++){var y=t[d-2],b=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=t[d-15];var m=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;t[d]=(b+t[d-7]|0)+(m+t[d-16]|0)}for(var d=0;d<64;d++){var b=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&l^~u&f)|0)+(h+(WQe[d]+t[d]|0)|0)|0,m=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&o^s&a^o&a)|0;h=f,f=l,l=u,u=c+b|0,c=a,a=o,o=s,s=b+m|0}e[0]+=s,e[1]+=o,e[2]+=a,e[3]+=c,e[4]+=u,e[5]+=l,e[6]+=f,e[7]+=h,n+=64,i-=64}return n}function YQe(t){var e=new P2e;e.update(t);var r=e.digest();return e.clean(),r}xf.hash=YQe});var O2e=g((C2e,y3)=>{"use strict";(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof La=="function"&&typeof y3=="object"&&y3&&y3.exports&&(y3.exports=e(Kr()))})(C2e,function(t){"use strict";var e=t.Reader,r=t.Writer,n=t.util,i=t.roots["libp2p-noise"]||(t.roots["libp2p-noise"]={});return i.pb=function(){var s={};return s.NoiseHandshakePayload=function(){function o(a){if(a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}return o.prototype.identityKey=n.newBuffer([]),o.prototype.identitySig=n.newBuffer([]),o.prototype.data=n.newBuffer([]),o.create=function(c){return new o(c)},o.encode=function(c,u){return u||(u=r.create()),c.identityKey!=null&&Object.hasOwnProperty.call(c,"identityKey")&&u.uint32(10).bytes(c.identityKey),c.identitySig!=null&&Object.hasOwnProperty.call(c,"identitySig")&&u.uint32(18).bytes(c.identitySig),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&u.uint32(26).bytes(c.data),u},o.encodeDelimited=function(c,u){return this.encode(c,u).ldelim()},o.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,f=new i.pb.NoiseHandshakePayload;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:f.identityKey=c.bytes();break;case 2:f.identitySig=c.bytes();break;case 3:f.data=c.bytes();break;default:c.skipType(h&7);break}}return f},o.decodeDelimited=function(c){return c instanceof e||(c=new e(c)),this.decode(c,c.uint32())},o.verify=function(c){return typeof c!="object"||c===null?"object expected":c.identityKey!=null&&c.hasOwnProperty("identityKey")&&!(c.identityKey&&typeof c.identityKey.length=="number"||n.isString(c.identityKey))?"identityKey: buffer expected":c.identitySig!=null&&c.hasOwnProperty("identitySig")&&!(c.identitySig&&typeof c.identitySig.length=="number"||n.isString(c.identitySig))?"identitySig: buffer expected":c.data!=null&&c.hasOwnProperty("data")&&!(c.data&&typeof c.data.length=="number"||n.isString(c.data))?"data: buffer expected":null},o.fromObject=function(c){if(c instanceof i.pb.NoiseHandshakePayload)return c;var u=new i.pb.NoiseHandshakePayload;return c.identityKey!=null&&(typeof c.identityKey=="string"?n.base64.decode(c.identityKey,u.identityKey=n.newBuffer(n.base64.length(c.identityKey)),0):c.identityKey.length&&(u.identityKey=c.identityKey)),c.identitySig!=null&&(typeof c.identitySig=="string"?n.base64.decode(c.identitySig,u.identitySig=n.newBuffer(n.base64.length(c.identitySig)),0):c.identitySig.length&&(u.identitySig=c.identitySig)),c.data!=null&&(typeof c.data=="string"?n.base64.decode(c.data,u.data=n.newBuffer(n.base64.length(c.data)),0):c.data.length&&(u.data=c.data)),u},o.toObject=function(c,u){u||(u={});var l={};return u.defaults&&(u.bytes===String?l.identityKey="":(l.identityKey=[],u.bytes!==Array&&(l.identityKey=n.newBuffer(l.identityKey))),u.bytes===String?l.identitySig="":(l.identitySig=[],u.bytes!==Array&&(l.identitySig=n.newBuffer(l.identitySig))),u.bytes===String?l.data="":(l.data=[],u.bytes!==Array&&(l.data=n.newBuffer(l.data)))),c.identityKey!=null&&c.hasOwnProperty("identityKey")&&(l.identityKey=u.bytes===String?n.base64.encode(c.identityKey,0,c.identityKey.length):u.bytes===Array?Array.prototype.slice.call(c.identityKey):c.identityKey),c.identitySig!=null&&c.hasOwnProperty("identitySig")&&(l.identitySig=u.bytes===String?n.base64.encode(c.identitySig,0,c.identitySig.length):u.bytes===Array?Array.prototype.slice.call(c.identitySig):c.identitySig),c.data!=null&&c.hasOwnProperty("data")&&(l.data=u.bytes===String?n.base64.encode(c.data,0,c.data.length):u.bytes===Array?Array.prototype.slice.call(c.data):c.data),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s}(),i})});var Pf=g(ur=>{"use strict";var XQe=ur&&ur.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),QQe=ur&&ur.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ZQe=ur&&ur.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&XQe(e,t,r);return QQe(e,t),e},JQe=ur&&ur.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ur,"__esModule",{value:!0});ur.isValidPublicKey=ur.getHkdf=ur.verifySignedPayload=ur.getHandshakePayload=ur.decodePayload=ur.getPeerIdFromPayload=ur.signPayload=ur.createHandshakePayload=ur.getPayload=ur.generateKeypair=void 0;var eZe=x2e(),tZe=hO(),rZe=ZQe(U_()),dO=JQe(ft()),nZe=O2e(),iZe=(bn(),se(Ei)),sZe=(dt(),se(nn)),oZe=(Pn(),se(Ui)),H_=nZe.pb.NoiseHandshakePayload;function aZe(){let t=rZe.generateKeyPair();return{publicKey:t.publicKey,privateKey:t.secretKey}}ur.generateKeypair=aZe;async function cZe(t,e,r){let n=await D2e(t,pO(e)),i=r??new Uint8Array(0);return k2e(t.marshalPubKey(),n,i)}ur.getPayload=cZe;function k2e(t,e,r){let n=H_.create({identityKey:t,identitySig:e,data:r??null});return H_.encode(n).finish()}ur.createHandshakePayload=k2e;async function D2e(t,e){return await t.privKey.sign(e)}ur.signPayload=D2e;async function uZe(t){return await dO.default.createFromPubKey(t.identityKey)}ur.getPeerIdFromPayload=uZe;function lZe(t){return H_.toObject(H_.decode(t))}ur.decodePayload=lZe;function pO(t){let e=(0,sZe.fromString)("noise-libp2p-static-key:");return(0,oZe.concat)([e,t],e.length+t.length)}ur.getHandshakePayload=pO;async function fZe(t,e){let r=await dO.default.createFromPubKey(e);return(0,iZe.equals)(r.id,t)}async function hZe(t,e,r){let n=e.identityKey;if(!await fZe(r.id,n))throw new Error("Peer ID doesn't match libp2p public key.");let i=pO(t),s=await dO.default.createFromPubKey(n);if(!e.identitySig||!await s.pubKey.verify(i,e.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return s}ur.verifySignedPayload=hZe;function dZe(t,e){let i=new eZe.HKDF(tZe.SHA256,e,t).expand(96),s=i.slice(0,32),o=i.slice(32,64),a=i.slice(64,96);return[s,o,a]}ur.getHkdf=dZe;function pZe(t){return!(!(t instanceof Uint8Array)||t.length!==32)}ur.isValidPublicKey=pZe});var B2e=g($_=>{"use strict";Object.defineProperty($_,"__esModule",{value:!0});var Di=l3(),yO=Bc(),yZe=20;function gZe(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],c=r[7]<<24|r[6]<<16|r[5]<<8|r[4],u=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],f=r[19]<<24|r[18]<<16|r[17]<<8|r[16],h=r[23]<<24|r[22]<<16|r[21]<<8|r[20],d=r[27]<<24|r[26]<<16|r[25]<<8|r[24],p=r[31]<<24|r[30]<<16|r[29]<<8|r[28],y=e[3]<<24|e[2]<<16|e[1]<<8|e[0],b=e[7]<<24|e[6]<<16|e[5]<<8|e[4],m=e[11]<<24|e[10]<<16|e[9]<<8|e[8],_=e[15]<<24|e[14]<<16|e[13]<<8|e[12],R=n,k=i,P=s,x=o,D=a,U=c,M=u,ae=l,ne=f,de=h,me=d,Ke=p,xe=y,Ue=b,ie=m,Ve=_,pt=0;pt<yZe;pt+=2)R=R+D|0,xe^=R,xe=xe>>>32-16|xe<<16,ne=ne+xe|0,D^=ne,D=D>>>32-12|D<<12,k=k+U|0,Ue^=k,Ue=Ue>>>32-16|Ue<<16,de=de+Ue|0,U^=de,U=U>>>32-12|U<<12,P=P+M|0,ie^=P,ie=ie>>>32-16|ie<<16,me=me+ie|0,M^=me,M=M>>>32-12|M<<12,x=x+ae|0,Ve^=x,Ve=Ve>>>32-16|Ve<<16,Ke=Ke+Ve|0,ae^=Ke,ae=ae>>>32-12|ae<<12,P=P+M|0,ie^=P,ie=ie>>>32-8|ie<<8,me=me+ie|0,M^=me,M=M>>>32-7|M<<7,x=x+ae|0,Ve^=x,Ve=Ve>>>32-8|Ve<<8,Ke=Ke+Ve|0,ae^=Ke,ae=ae>>>32-7|ae<<7,k=k+U|0,Ue^=k,Ue=Ue>>>32-8|Ue<<8,de=de+Ue|0,U^=de,U=U>>>32-7|U<<7,R=R+D|0,xe^=R,xe=xe>>>32-8|xe<<8,ne=ne+xe|0,D^=ne,D=D>>>32-7|D<<7,R=R+U|0,Ve^=R,Ve=Ve>>>32-16|Ve<<16,me=me+Ve|0,U^=me,U=U>>>32-12|U<<12,k=k+M|0,xe^=k,xe=xe>>>32-16|xe<<16,Ke=Ke+xe|0,M^=Ke,M=M>>>32-12|M<<12,P=P+ae|0,Ue^=P,Ue=Ue>>>32-16|Ue<<16,ne=ne+Ue|0,ae^=ne,ae=ae>>>32-12|ae<<12,x=x+D|0,ie^=x,ie=ie>>>32-16|ie<<16,de=de+ie|0,D^=de,D=D>>>32-12|D<<12,P=P+ae|0,Ue^=P,Ue=Ue>>>32-8|Ue<<8,ne=ne+Ue|0,ae^=ne,ae=ae>>>32-7|ae<<7,x=x+D|0,ie^=x,ie=ie>>>32-8|ie<<8,de=de+ie|0,D^=de,D=D>>>32-7|D<<7,k=k+M|0,xe^=k,xe=xe>>>32-8|xe<<8,Ke=Ke+xe|0,M^=Ke,M=M>>>32-7|M<<7,R=R+U|0,Ve^=R,Ve=Ve>>>32-8|Ve<<8,me=me+Ve|0,U^=me,U=U>>>32-7|U<<7;Di.writeUint32LE(R+n|0,t,0),Di.writeUint32LE(k+i|0,t,4),Di.writeUint32LE(P+s|0,t,8),Di.writeUint32LE(x+o|0,t,12),Di.writeUint32LE(D+a|0,t,16),Di.writeUint32LE(U+c|0,t,20),Di.writeUint32LE(M+u|0,t,24),Di.writeUint32LE(ae+l|0,t,28),Di.writeUint32LE(ne+f|0,t,32),Di.writeUint32LE(de+h|0,t,36),Di.writeUint32LE(me+d|0,t,40),Di.writeUint32LE(Ke+p|0,t,44),Di.writeUint32LE(xe+y|0,t,48),Di.writeUint32LE(Ue+b|0,t,52),Di.writeUint32LE(ie+m|0,t,56),Di.writeUint32LE(Ve+_|0,t,60)}function N2e(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=i}for(var a=new Uint8Array(64),c=0;c<r.length;c+=64){gZe(a,s,t);for(var u=c;u<c+64&&u<r.length;u++)n[u]=r[u]^a[u-c];wZe(s,0,o)}return yO.wipe(a),i===0&&yO.wipe(s),n}$_.streamXOR=N2e;function mZe(t,e,r,n){return n===void 0&&(n=0),yO.wipe(r),N2e(t,e,r,r,n)}$_.stream=mZe;function wZe(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}});var M2e=g(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});var bZe=j_(),G_=Bc();Uu.DIGEST_LENGTH=16;var L2e=function(){function t(e){this.digestLength=Uu.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=r&8191;var n=e[2]|e[3]<<8;this._r[1]=(r>>>13|n<<3)&8191;var i=e[4]|e[5]<<8;this._r[2]=(n>>>10|i<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(i>>>7|s<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(c>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return t.prototype._blocks=function(e,r,n){for(var i=this._fin?0:2048,s=this._h[0],o=this._h[1],a=this._h[2],c=this._h[3],u=this._h[4],l=this._h[5],f=this._h[6],h=this._h[7],d=this._h[8],p=this._h[9],y=this._r[0],b=this._r[1],m=this._r[2],_=this._r[3],R=this._r[4],k=this._r[5],P=this._r[6],x=this._r[7],D=this._r[8],U=this._r[9];n>=16;){var M=e[r+0]|e[r+1]<<8;s+=M&8191;var ae=e[r+2]|e[r+3]<<8;o+=(M>>>13|ae<<3)&8191;var ne=e[r+4]|e[r+5]<<8;a+=(ae>>>10|ne<<6)&8191;var de=e[r+6]|e[r+7]<<8;c+=(ne>>>7|de<<9)&8191;var me=e[r+8]|e[r+9]<<8;u+=(de>>>4|me<<12)&8191,l+=me>>>1&8191;var Ke=e[r+10]|e[r+11]<<8;f+=(me>>>14|Ke<<2)&8191;var xe=e[r+12]|e[r+13]<<8;h+=(Ke>>>11|xe<<5)&8191;var Ue=e[r+14]|e[r+15]<<8;d+=(xe>>>8|Ue<<8)&8191,p+=Ue>>>5|i;var ie=0,Ve=ie;Ve+=s*y,Ve+=o*(5*U),Ve+=a*(5*D),Ve+=c*(5*x),Ve+=u*(5*P),ie=Ve>>>13,Ve&=8191,Ve+=l*(5*k),Ve+=f*(5*R),Ve+=h*(5*_),Ve+=d*(5*m),Ve+=p*(5*b),ie+=Ve>>>13,Ve&=8191;var pt=ie;pt+=s*b,pt+=o*y,pt+=a*(5*U),pt+=c*(5*D),pt+=u*(5*x),ie=pt>>>13,pt&=8191,pt+=l*(5*P),pt+=f*(5*k),pt+=h*(5*R),pt+=d*(5*_),pt+=p*(5*m),ie+=pt>>>13,pt&=8191;var Je=ie;Je+=s*m,Je+=o*b,Je+=a*y,Je+=c*(5*U),Je+=u*(5*D),ie=Je>>>13,Je&=8191,Je+=l*(5*x),Je+=f*(5*P),Je+=h*(5*k),Je+=d*(5*R),Je+=p*(5*_),ie+=Je>>>13,Je&=8191;var et=ie;et+=s*_,et+=o*m,et+=a*b,et+=c*y,et+=u*(5*U),ie=et>>>13,et&=8191,et+=l*(5*D),et+=f*(5*x),et+=h*(5*P),et+=d*(5*k),et+=p*(5*R),ie+=et>>>13,et&=8191;var pe=ie;pe+=s*R,pe+=o*_,pe+=a*m,pe+=c*b,pe+=u*y,ie=pe>>>13,pe&=8191,pe+=l*(5*U),pe+=f*(5*D),pe+=h*(5*x),pe+=d*(5*P),pe+=p*(5*k),ie+=pe>>>13,pe&=8191;var J=ie;J+=s*k,J+=o*R,J+=a*_,J+=c*m,J+=u*b,ie=J>>>13,J&=8191,J+=l*y,J+=f*(5*U),J+=h*(5*D),J+=d*(5*x),J+=p*(5*P),ie+=J>>>13,J&=8191;var Ie=ie;Ie+=s*P,Ie+=o*k,Ie+=a*R,Ie+=c*_,Ie+=u*m,ie=Ie>>>13,Ie&=8191,Ie+=l*b,Ie+=f*y,Ie+=h*(5*U),Ie+=d*(5*D),Ie+=p*(5*x),ie+=Ie>>>13,Ie&=8191;var ze=ie;ze+=s*x,ze+=o*P,ze+=a*k,ze+=c*R,ze+=u*_,ie=ze>>>13,ze&=8191,ze+=l*m,ze+=f*b,ze+=h*y,ze+=d*(5*U),ze+=p*(5*D),ie+=ze>>>13,ze&=8191;var We=ie;We+=s*D,We+=o*x,We+=a*P,We+=c*k,We+=u*R,ie=We>>>13,We&=8191,We+=l*_,We+=f*m,We+=h*b,We+=d*y,We+=p*(5*U),ie+=We>>>13,We&=8191;var De=ie;De+=s*U,De+=o*D,De+=a*x,De+=c*P,De+=u*k,ie=De>>>13,De&=8191,De+=l*R,De+=f*_,De+=h*m,De+=d*b,De+=p*y,ie+=De>>>13,De&=8191,ie=(ie<<2)+ie|0,ie=ie+Ve|0,Ve=ie&8191,ie=ie>>>13,pt+=ie,s=Ve,o=pt,a=Je,c=et,u=pe,l=J,f=Ie,h=ze,d=We,p=De,r+=16,n-=16}this._h[0]=s,this._h[1]=o,this._h[2]=a,this._h[3]=c,this._h[4]=u,this._h[5]=l,this._h[6]=f,this._h[7]=h,this._h[8]=d,this._h[9]=p},t.prototype.finish=function(e,r){r===void 0&&(r=0);var n=new Uint16Array(10),i,s,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(i=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=i,i=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=i*5,i=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=i,i=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=i,n[0]=this._h[0]+5,i=n[0]>>>13,n[0]&=8191,a=1;a<10;a++)n[a]=this._h[a]+i,i=n[a]>>>13,n[a]&=8191;for(n[9]-=1<<13,s=(i^1)-1,a=0;a<10;a++)n[a]&=s;for(s=~s,a=0;a<10;a++)this._h[a]=this._h[a]&s|n[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return e[r+0]=this._h[0]>>>0,e[r+1]=this._h[0]>>>8,e[r+2]=this._h[1]>>>0,e[r+3]=this._h[1]>>>8,e[r+4]=this._h[2]>>>0,e[r+5]=this._h[2]>>>8,e[r+6]=this._h[3]>>>0,e[r+7]=this._h[3]>>>8,e[r+8]=this._h[4]>>>0,e[r+9]=this._h[4]>>>8,e[r+10]=this._h[5]>>>0,e[r+11]=this._h[5]>>>8,e[r+12]=this._h[6]>>>0,e[r+13]=this._h[6]>>>8,e[r+14]=this._h[7]>>>0,e[r+15]=this._h[7]>>>8,this._finished=!0,this},t.prototype.update=function(e){var r=0,n=e.length,i;if(this._leftover){i=16-this._leftover,i>n&&(i=n);for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[r+s];if(n-=i,r+=i,this._leftover+=i,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(i=n-n%16,this._blocks(e,r,i),r+=i,n-=i),n){for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[r+s];this._leftover+=n}return this},t.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},t.prototype.clean=function(){return G_.wipe(this._buffer),G_.wipe(this._r),G_.wipe(this._h),G_.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},t}();Uu.Poly1305=L2e;function _Ze(t,e){var r=new L2e(t);r.update(e);var n=r.digest();return r.clean(),n}Uu.oneTimeAuth=_Ze;function vZe(t,e){return t.length!==Uu.DIGEST_LENGTH||e.length!==Uu.DIGEST_LENGTH?!1:bZe.equal(t,e)}Uu.equal=vZe});var F2e=g(qu=>{"use strict";Object.defineProperty(qu,"__esModule",{value:!0});var W_=B2e(),EZe=M2e(),g3=Bc(),U2e=l3(),SZe=j_();qu.KEY_LENGTH=32;qu.NONCE_LENGTH=12;qu.TAG_LENGTH=16;var q2e=new Uint8Array(16),AZe=function(){function t(e){if(this.nonceLength=qu.NONCE_LENGTH,this.tagLength=qu.TAG_LENGTH,e.length!==qu.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return t.prototype.seal=function(e,r,n,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);W_.stream(this._key,s,o,4);var a=r.length+this.tagLength,c;if(i){if(i.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");c=i}else c=new Uint8Array(a);return W_.streamXOR(this._key,s,r,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),o,c.subarray(0,c.length-this.tagLength),n),g3.wipe(s),c},t.prototype.open=function(e,r,n,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);W_.stream(this._key,s,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,r.subarray(0,r.length-this.tagLength),n),!SZe.equal(a,r.subarray(r.length-this.tagLength,r.length)))return null;var c=r.length-this.tagLength,u;if(i){if(i.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");u=i}else u=new Uint8Array(c);return W_.streamXOR(this._key,s,r.subarray(0,r.length-this.tagLength),u,4),g3.wipe(s),u},t.prototype.clean=function(){return g3.wipe(this._key),this},t.prototype._authenticate=function(e,r,n,i){var s=new EZe.Poly1305(r);i&&(s.update(i),i.length%16>0&&s.update(q2e.subarray(i.length%16))),s.update(n),n.length%16>0&&s.update(q2e.subarray(n.length%16));var o=new Uint8Array(8);i&&U2e.writeUint64LE(i.length,o),s.update(o),U2e.writeUint64LE(n.length,o),s.update(o);for(var a=s.digest(),c=0;c<a.length;c++)e[c]=a[c];s.clean(),g3.wipe(a),g3.wipe(o)},t}();qu.ChaCha20Poly1305=AZe});var Y_={};Tt(Y_,{xor:()=>gO});function gO(t,e){if(t.length!==e.length)throw new Error("Inputs should have the same length");let r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}var m3=w(()=>{});var K2e={};Tt(K2e,{compare:()=>om,concat:()=>Kn,equals:()=>ro,fromString:()=>tt,toString:()=>Xe,xor:()=>gO});var j2e=w(()=>{ub();Pn();bn();dt();st();m3()});var X_=g(Fu=>{"use strict";Object.defineProperty(Fu,"__esModule",{value:!0});Fu.DUMP_SESSION_KEYS=Fu.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Fu.NOISE_MSG_MAX_LENGTH_BYTES=void 0;Fu.NOISE_MSG_MAX_LENGTH_BYTES=65535;Fu.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Fu.NOISE_MSG_MAX_LENGTH_BYTES-16;Fu.DUMP_SESSION_KEYS=process.env.DUMP_SESSION_KEYS});var ay=g(_i=>{"use strict";var RZe=_i&&_i.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(_i,"__esModule",{value:!0});_i.logCipherState=_i.logRemoteEphemeralKey=_i.logRemoteStaticKey=_i.logLocalEphemeralKeys=_i.logLocalStaticKeys=_i.logger=void 0;var IZe=RZe(he()),TZe=X_(),Cf=(st(),se(hr));_i.logger=(0,IZe.default)("libp2p:noise");var Bo;TZe.DUMP_SESSION_KEYS?Bo=_i.logger:Bo=()=>{};function xZe(t){Bo(`LOCAL_STATIC_PUBLIC_KEY ${(0,Cf.toString)(t.publicKey,"hex")}`),Bo(`LOCAL_STATIC_PRIVATE_KEY ${(0,Cf.toString)(t.privateKey,"hex")}`)}_i.logLocalStaticKeys=xZe;function PZe(t){t?(Bo(`LOCAL_PUBLIC_EPHEMERAL_KEY ${(0,Cf.toString)(t.publicKey,"hex")}`),Bo(`LOCAL_PRIVATE_EPHEMERAL_KEY ${(0,Cf.toString)(t.privateKey,"hex")}`)):Bo("Missing local ephemeral keys.")}_i.logLocalEphemeralKeys=PZe;function CZe(t){Bo(`REMOTE_STATIC_PUBLIC_KEY ${(0,Cf.toString)(t,"hex")}`)}_i.logRemoteStaticKey=CZe;function OZe(t){Bo(`REMOTE_EPHEMERAL_PUBLIC_KEY ${(0,Cf.toString)(t,"hex")}`)}_i.logRemoteEphemeralKey=OZe;function kZe(t){t.cs1&&t.cs2?(Bo(`CIPHER_STATE_1 ${t.cs1.n} ${(0,Cf.toString)(t.cs1.k,"hex")}`),Bo(`CIPHER_STATE_2 ${t.cs2.n} ${(0,Cf.toString)(t.cs2.k,"hex")}`)):Bo("Missing cipher state.")}_i.logCipherState=kZe});var mO=g(vi=>{"use strict";var DZe=vi&&vi.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),NZe=vi&&vi.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),$2e=vi&&vi.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&DZe(e,t,r);return NZe(e,t),e};Object.defineProperty(vi,"__esModule",{value:!0});vi.AbstractHandshake=vi.MAX_NONCE=vi.MIN_NONCE=void 0;var BZe=$2e(U_()),LZe=$2e(hO()),V2e=F2e(),MZe=(bn(),se(Ei)),UZe=(Pn(),se(Ui)),qZe=(j2e(),se(K2e)),z2e=Pf(),FZe=ay();vi.MIN_NONCE=0;vi.MAX_NONCE=Number.MAX_SAFE_INTEGER;var H2e="Cipherstate has reached maximum n, a new handshake must be performed",G2e=class{encryptWithAd(e,r,n){let i=this.encrypt(e.k,e.n,r,n);return this.setNonce(e,this.incrementNonce(e.n)),i}decryptWithAd(e,r,n){let{plaintext:i,valid:s}=this.decrypt(e.k,e.n,r,n);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:i,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,r){e.n=r}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){let r=this.createEmptyKey();return(0,MZe.equals)(r,e)}incrementNonce(e){return e+1}nonceToBytes(e){let r=new Uint8Array(12);return new DataView(r.buffer,r.byteOffset,r.byteLength).setUint32(4,e,!0),r}encrypt(e,r,n,i){if(r>vi.MAX_NONCE)throw new Error(H2e);let s=this.nonceToBytes(r);return new V2e.ChaCha20Poly1305(e).seal(s,i,n)}encryptAndHash(e,r){let n;return this.hasKey(e.cs)?n=this.encryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,n),n}decrypt(e,r,n,i){if(r>vi.MAX_NONCE)throw new Error(H2e);let s=this.nonceToBytes(r),a=new V2e.ChaCha20Poly1305(e).open(s,i,n);return a?{plaintext:a,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,r){let n,i=!0;return this.hasKey(e.cs)?{plaintext:n,valid:i}=this.decryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,r),{plaintext:n,valid:i}}dh(e,r){try{let n=BZe.sharedKey(e,r);return n.length===32?n:n.slice(0,32)}catch(n){return(0,FZe.logger)(n.message),new Uint8Array(32)}}mixHash(e,r){e.h=this.getHash(e.h,r)}getHash(e,r){return LZe.hash((0,UZe.concat)([e,r],e.length+r.length))}mixKey(e,r){let[n,i]=(0,z2e.getHkdf)(e.ck,r);e.cs=this.initializeKey(i),e.ck=n}initializeKey(e){let r=vi.MIN_NONCE;return{k:e,n:r}}initializeSymmetric(e){let r=(0,qZe.fromString)(e,"utf-8"),n=this.hashProtocolName(r),i=n,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:i,h:n}}hashProtocolName(e){if(e.length<=32){let r=new Uint8Array(32);return r.set(e),r}else return this.getHash(e,new Uint8Array(0))}split(e){let[r,n]=(0,z2e.getHkdf)(e.ck,new Uint8Array(0)),i=this.initializeKey(r),s=this.initializeKey(n);return{cs1:i,cs2:s}}writeMessageRegular(e,r){let n=this.encryptWithAd(e,new Uint8Array(0),r),i=this.createEmptyKey(),s=new Uint8Array(0);return{ne:i,ns:s,ciphertext:n}}readMessageRegular(e,r){return this.decryptWithAd(e,new Uint8Array(0),r.ciphertext)}};vi.AbstractHandshake=G2e});var Y2e=g(Q_=>{"use strict";Object.defineProperty(Q_,"__esModule",{value:!0});Q_.XX=void 0;var cy=Pf(),KZe=mO(),W2e=class extends KZe.AbstractHandshake{initializeInitiator(e,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=new Uint8Array(32);return{ss:o,s:r,rs:n,psk:i,re:a}}initializeResponder(e,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=new Uint8Array(32);return{ss:o,s:r,rs:n,psk:i,re:a}}writeMessageA(e,r,n){let i=new Uint8Array(0);n!==void 0?e.e=n:e.e=(0,cy.generateKeypair)();let s=e.e.publicKey;this.mixHash(e.ss,s);let o=this.encryptAndHash(e.ss,r);return{ne:s,ns:i,ciphertext:o}}writeMessageB(e,r){e.e=(0,cy.generateKeypair)();let n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let i=e.s.publicKey,s=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,r);return{ne:n,ns:s,ciphertext:o}}writeMessageC(e,r){let n=e.s.publicKey,i=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,r),a={ne:this.createEmptyKey(),ns:i,ciphertext:s},{cs1:c,cs2:u}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:u}}readMessageA(e,r){return(0,cy.isValidPublicKey)(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,r.ciphertext)}readMessageB(e,r){if((0,cy.isValidPublicKey)(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);i&&n.length===32&&(0,cy.isValidPublicKey)(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:s,valid:i&&o}}readMessageC(e,r){let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);if(i&&n.length===32&&(0,cy.isValidPublicKey)(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:i&&o,cs1:a,cs2:c}}initSession(e,r,n){let i=this.createEmptyKey(),s=new Uint8Array(32),o;return e?o=this.initializeInitiator(r,n,s,i):o=this.initializeResponder(r,n,s,i),{hs:o,i:e,mc:0}}sendMessage(e,r,n){let i;if(e.mc===0)i=this.writeMessageA(e.hs,r,n);else if(e.mc===1)i=this.writeMessageB(e.hs,r);else if(e.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,r);i=o,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,r){let n=new Uint8Array(0),i=!1;if(e.mc===0)({plaintext:n,valid:i}=this.readMessageA(e.hs,r));else if(e.mc===1)({plaintext:n,valid:i}=this.readMessageB(e.hs,r));else if(e.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:u}=this.readMessageC(e.hs,r);n=o,i=a,e.h=s,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:n,valid:i}}};Q_.XX=W2e});var w3=g(fn=>{"use strict";var jZe=fn&&fn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fn,"__esModule",{value:!0});fn.decode2=fn.decode1=fn.decode0=fn.encode2=fn.encode1=fn.encode0=fn.uint16BEDecode=fn.uint16BEEncode=void 0;var VZe=jZe(yi()),wO=(Pn(),se(Ui)),zZe=t=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t),HZe=(t,e,r)=>(e=e||zZe(2),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint16(r,t,!1),e);fn.uint16BEEncode=HZe;fn.uint16BEEncode.bytes=2;var $Ze=t=>{if(t.length<2)throw RangeError("Could not decode int16BE");return t instanceof VZe.default?t.readUInt16BE(0):new DataView(t.buffer,t.byteOffset,t.byteLength).getUint16(0,!1)};fn.uint16BEDecode=$Ze;fn.uint16BEDecode.bytes=2;function GZe(t){return(0,wO.concat)([t.ne,t.ciphertext],t.ne.length+t.ciphertext.length)}fn.encode0=GZe;function WZe(t){return(0,wO.concat)([t.ne,t.ns,t.ciphertext],t.ne.length+t.ns.length+t.ciphertext.length)}fn.encode1=WZe;function YZe(t){return(0,wO.concat)([t.ns,t.ciphertext],t.ns.length+t.ciphertext.length)}fn.encode2=YZe;function XZe(t){if(t.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:t.slice(0,32),ciphertext:t.slice(32,t.length),ns:new Uint8Array(0)}}fn.decode0=XZe;function QZe(t){if(t.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:t.slice(0,32),ns:t.slice(32,80),ciphertext:t.slice(80,t.length)}}fn.decode1=QZe;function ZZe(t){if(t.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:t.slice(0,48),ciphertext:t.slice(48,t.length)}}fn.decode2=ZZe});var bO=g(Z_=>{"use strict";Object.defineProperty(Z_,"__esModule",{value:!0});Z_.XXHandshake=void 0;var JZe=Y2e(),uy=Pf(),Sn=ay(),ly=w3(),X2e=class{constructor(e,r,n,i,s,o,a){this.isInitiator=e,this.payload=r,this.prologue=n,this.staticKeypair=i,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new JZe.XX,this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=new Uint8Array(0)}async propose(){if((0,Sn.logLocalStaticKeys)(this.session.hs.s),this.isInitiator){(0,Sn.logger)("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP((0,ly.encode0)(e)),(0,Sn.logger)("Stage 0 - Initiator finished sending first message."),(0,Sn.logLocalEphemeralKeys)(this.session.hs.e)}else{(0,Sn.logger)("Stage 0 - Responder waiting to receive first message...");let e=(0,ly.decode0)((await this.connection.readLP()).slice()),{valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new Error("xx handshake stage 0 validation fail");(0,Sn.logger)("Stage 0 - Responder received first message."),(0,Sn.logRemoteEphemeralKey)(this.session.hs.re)}}async exchange(){if(this.isInitiator){(0,Sn.logger)("Stage 1 - Initiator waiting to receive first message from responder...");let e=(0,ly.decode1)((await this.connection.readLP()).slice()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new Error("xx handshake stage 1 validation fail");(0,Sn.logger)("Stage 1 - Initiator received the message."),(0,Sn.logRemoteEphemeralKey)(this.session.hs.re),(0,Sn.logRemoteStaticKey)(this.session.hs.rs),(0,Sn.logger)("Initiator going to check remote's signature...");try{let i=await(0,uy.decodePayload)(r);this.remotePeer=this.remotePeer||await(0,uy.getPeerIdFromPayload)(i),this.remotePeer=await(0,uy.verifySignedPayload)(this.session.hs.rs,i,this.remotePeer),this.setRemoteEarlyData(i.data)}catch(i){let s=i;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}(0,Sn.logger)("All good with the signature!")}else{(0,Sn.logger)("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP((0,ly.encode1)(e)),(0,Sn.logger)("Stage 1 - Responder sent the second handshake message with signed payload."),(0,Sn.logLocalEphemeralKeys)(this.session.hs.e)}}async finish(){if(this.isInitiator){(0,Sn.logger)("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP((0,ly.encode2)(e)),(0,Sn.logger)("Stage 2 - Initiator sent message with signed payload.")}else{(0,Sn.logger)("Stage 2 - Responder waiting for third handshake message...");let e=(0,ly.decode2)((await this.connection.readLP()).slice()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new Error("xx handshake stage 2 validation fail");(0,Sn.logger)("Stage 2 - Responder received the message, finished handshake.");try{let i=await(0,uy.decodePayload)(r);this.remotePeer=this.remotePeer||await(0,uy.getPeerIdFromPayload)(i),await(0,uy.verifySignedPayload)(this.session.hs.rs,i,this.remotePeer),this.setRemoteEarlyData(i.data)}catch(i){let s=i;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}}(0,Sn.logCipherState)(this.session)}encrypt(e,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,new Uint8Array(0),e)}decrypt(e,r){let n=this.getCS(r,!1);return this.xx.decryptWithAd(n,new Uint8Array(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}};Z_.XXHandshake=X2e});var Z2e=g(J_=>{"use strict";Object.defineProperty(J_,"__esModule",{value:!0});J_.IK=void 0;var b3=Pf(),eJe=mO(),Q2e=class extends eJe.AbstractHandshake{initSession(e,r,n,i){let s=this.createEmptyKey(),o;return e?o=this.initializeInitiator(r,n,i,s):o=this.initializeResponder(r,n,i,s),{hs:o,i:e,mc:0}}sendMessage(e,r){let n;if(e.mc===0)n=this.writeMessageA(e.hs,r);else if(e.mc===1){let{messageBuffer:i,h:s,cs1:o,cs2:a}=this.writeMessageB(e.hs,r);n=i,e.h=s,e.cs1=o,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,r){let n=new Uint8Array(0),i=!1;if(e.mc===0&&({plaintext:n,valid:i}=this.readMessageA(e.hs,r)),e.mc===1){let{plaintext:s,valid:o,h:a,cs1:c,cs2:u}=this.readMessageB(e.hs,r);n=s,i=o,e.h=a,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:n,valid:i}}writeMessageA(e,r){e.e=(0,b3.generateKeypair)();let n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let i=e.s.publicKey,s=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let o=this.encryptAndHash(e.ss,r);return{ne:n,ns:s,ciphertext:o}}writeMessageB(e,r){e.e=(0,b3.generateKeypair)();let n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let i=this.encryptAndHash(e.ss,r),s=this.createEmptyKey(),o={ne:n,ns:s,ciphertext:i},{cs1:a,cs2:c}=this.split(e.ss);return{messageBuffer:o,cs1:a,cs2:c,h:e.ss.h}}readMessageA(e,r){(0,b3.isValidPublicKey)(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);i&&n.length===32&&(0,b3.isValidPublicKey)(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:s,valid:i&&o}}readMessageB(e,r){if((0,b3.isValidPublicKey)(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:s,cs2:o}=this.split(e.ss);return{h:e.ss.h,valid:i,plaintext:n,cs1:s,cs2:o}}initializeInitiator(e,r,n,i){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,n);let a=new Uint8Array(32);return{ss:o,s:r,rs:n,re:a,psk:i}}initializeResponder(e,r,n,i){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,r.publicKey);let a=new Uint8Array(32);return{ss:o,s:r,rs:n,re:a,psk:i}}};J_.IK=Q2e});var ege=g(ev=>{"use strict";Object.defineProperty(ev,"__esModule",{value:!0});ev.FailedIKError=void 0;var J2e=class extends Error{constructor(e,r){super(r);this.initialMsg=e,this.name="FailedIKhandshake"}};ev.FailedIKError=J2e});var nge=g(rv=>{"use strict";Object.defineProperty(rv,"__esModule",{value:!0});rv.IKHandshake=void 0;var tJe=Z2e(),tv=w3(),fy=Pf(),tge=ege(),Gn=ay(),rge=class{constructor(e,r,n,i,s,o,a,c){this.isInitiator=e,this.payload=r,this.prologue=n,this.staticKeypair=i,this.connection=s,a&&(this.remotePeer=a),this.ik=c??new tJe.IK,this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,o),this.remoteEarlyData=new Uint8Array}async stage0(){if((0,Gn.logLocalStaticKeys)(this.session.hs.s),(0,Gn.logRemoteStaticKey)(this.session.hs.rs),this.isInitiator){(0,Gn.logger)("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP((0,tv.encode1)(e)),(0,Gn.logger)("IK Stage 0 - Initiator sent message."),(0,Gn.logLocalEphemeralKeys)(this.session.hs.e)}else{(0,Gn.logger)("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let r=(0,tv.decode1)(e.slice()),{plaintext:n,valid:i}=this.ik.recvMessage(this.session,r);if(!i)throw new Error("ik handshake stage 0 decryption validation fail");(0,Gn.logger)("IK Stage 0 - Responder got message, going to verify payload.");let s=await(0,fy.decodePayload)(n);this.remotePeer=this.remotePeer||await(0,fy.getPeerIdFromPayload)(s),await(0,fy.verifySignedPayload)(this.session.hs.rs,s,this.remotePeer),this.setRemoteEarlyData(s.data),(0,Gn.logger)("IK Stage 0 - Responder successfully verified payload!"),(0,Gn.logRemoteEphemeralKey)(this.session.hs.re)}catch(r){let n=r;throw(0,Gn.logger)("Responder breaking up with IK handshake in stage 0."),new tge.FailedIKError(e,`Error occurred while verifying initiator's signed payload: ${n.message}`)}}}async stage1(){if(this.isInitiator){(0,Gn.logger)("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),r=(0,tv.decode0)(e),{plaintext:n,valid:i}=this.ik.recvMessage(this.session,r);(0,Gn.logger)("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!i)throw new Error("ik stage 1 decryption validation fail");let s=await(0,fy.decodePayload)(n);this.remotePeer=this.remotePeer||await(0,fy.getPeerIdFromPayload)(s),await(0,fy.verifySignedPayload)(r.ns.slice(0,32),s,this.remotePeer),this.setRemoteEarlyData(s.data),(0,Gn.logger)("IK Stage 1 - Initiator successfully verified payload!"),(0,Gn.logRemoteEphemeralKey)(this.session.hs.re)}catch(s){let o=s;throw(0,Gn.logger)("Initiator breaking up with IK handshake in stage 1."),new tge.FailedIKError(e,`Error occurred while verifying responder's signed payload: ${o.message}`)}}else{(0,Gn.logger)("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP((0,tv.encode0)(e)),(0,Gn.logger)("IK Stage 1 - Responder sent message..."),(0,Gn.logLocalEphemeralKeys)(this.session.hs.e)}(0,Gn.logCipherState)(this.session)}decrypt(e,r){let n=this.getCS(r,!1);return this.ik.decryptWithAd(n,new Uint8Array(0),e)}encrypt(e,r){let n=this.getCS(r);return this.ik.encryptWithAd(n,new Uint8Array(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}};rv.IKHandshake=rge});var oge=g(nv=>{"use strict";Object.defineProperty(nv,"__esModule",{value:!0});nv.XXFallbackHandshake=void 0;var rJe=bO(),_O=Pf(),Lo=ay(),ige=w3(),sge=class extends rJe.XXHandshake{constructor(e,r,n,i,s,o,a,c,u){super(e,r,n,i,s,a,u);c&&(this.ephemeralKeys=c),this.initialMsg=o}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,new Uint8Array(0),this.ephemeralKeys),(0,Lo.logger)("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),(0,Lo.logLocalEphemeralKeys)(this.session.hs.e);else{(0,Lo.logger)("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=(0,ige.decode0)(this.initialMsg),{valid:r}=this.xx.recvMessage(this.session,{ne:e.ne,ns:new Uint8Array(0),ciphertext:new Uint8Array(0)});if(!r)throw new Error("xx fallback stage 0 decryption validation fail");(0,Lo.logger)("XX Fallback Stage 0 - Responder used received message from IK."),(0,Lo.logRemoteEphemeralKey)(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=(0,ige.decode1)(this.initialMsg),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new Error("xx fallback stage 1 decryption validation fail");(0,Lo.logger)("XX Fallback Stage 1 - Initiator used received message from IK."),(0,Lo.logRemoteEphemeralKey)(this.session.hs.re),(0,Lo.logRemoteStaticKey)(this.session.hs.rs),(0,Lo.logger)("Initiator going to check remote's signature...");try{let i=await(0,_O.decodePayload)(r);this.remotePeer=this.remotePeer||await(0,_O.getPeerIdFromPayload)(i),await(0,_O.verifySignedPayload)(this.session.hs.rs,i,this.remotePeer),this.setRemoteEarlyData(i.data)}catch(i){let s=i;throw new Error(`Error occurred while verifying signed payload from responder: ${s.message}`)}(0,Lo.logger)("All good with the signature!")}else(0,Lo.logger)("XX Fallback Stage 1 - Responder start"),await super.exchange(),(0,Lo.logger)("XX Fallback Stage 1 - Responder end")}};nv.XXFallbackHandshake=sge});var age=g(hy=>{"use strict";Object.defineProperty(hy,"__esModule",{value:!0});hy.decryptStream=hy.encryptStream=void 0;var iv=X_();function nJe(t){return async function*(e){for await(let r of e)for(let n=0;n<r.length;n+=iv.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let i=n+iv.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;i>r.length&&(i=r.length),yield t.encrypt(r.slice(n,i),t.session)}}}hy.encryptStream=nJe;function iJe(t){return async function*(e){for await(let r of e)for(let n=0;n<r.length;n+=iv.NOISE_MSG_MAX_LENGTH_BYTES){let i=n+iv.NOISE_MSG_MAX_LENGTH_BYTES;i>r.length&&(i=r.length);let{plaintext:s,valid:o}=await t.decrypt(r.slice(n,i),t.session);if(!o)throw new Error("Failed to validate decrypted chunk");yield s}}}hy.decryptStream=iJe});var uge=g(sv=>{"use strict";Object.defineProperty(sv,"__esModule",{value:!0});sv.KeyCache=void 0;var cge=class{constructor(){this.storage=new Map}store(e,r){this.storage.set(e.id,r)}load(e){var r;return e&&(r=this.storage.get(e.id))!==null&&r!==void 0?r:null}resetStorage(){this.storage.clear()}},sJe=new cge;sv.KeyCache=sJe});var EO=g(Mo=>{"use strict";var oJe=Mo&&Mo.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),aJe=Mo&&Mo.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),cJe=Mo&&Mo.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&oJe(e,t,r);return aJe(e,t),e},ov=Mo&&Mo.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.Noise=void 0;var uJe=cJe(U_()),lge=ov(g2e()),lJe=ov(v2e()),fge=ov(K_()),fJe=ov(br()),hge=xo(),hJe=bO(),dJe=nge(),pJe=oge(),dge=Pf(),dy=w3(),pge=age(),vO=uge(),yJe=ay(),yge=X_(),gge=class{constructor(e,r){if(this.protocol="/noise",this.prologue=new Uint8Array(0),this.earlyData=r??new Uint8Array(0),this.useNoisePipes=!1,e){let n=uJe.generateKeyPairFromSeed(e);this.staticKeys={privateKey:n.secretKey,publicKey:n.publicKey}}else this.staticKeys=(0,dge.generateKeypair)()}async secureOutbound(e,r,n){let i=(0,lge.default)(r,{lengthEncoder:dy.uint16BEEncode,lengthDecoder:dy.uint16BEDecode,maxDataLength:yge.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:i,isInitiator:!0,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(i,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async secureInbound(e,r,n){let i=(0,lge.default)(r,{lengthEncoder:dy.uint16BEEncode,lengthDecoder:dy.uint16BEDecode,maxDataLength:yge.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:i,isInitiator:!1,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(i,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async performHandshake(e){var r;let n=await(0,dge.getPayload)(e.localPeer,this.staticKeys.publicKey,this.earlyData),i=this.useNoisePipes;if(e.isInitiator&&vO.KeyCache.load(e.remotePeer)===null&&(i=!1),i){let{remotePeer:s,connection:o,isInitiator:a}=e,c=new dJe.IKHandshake(a,n,this.prologue,this.staticKeys,o,(r=vO.KeyCache.load(e.remotePeer))!==null&&r!==void 0?r:new Uint8Array(32),s);try{return await this.performIKHandshake(c)}catch(u){let l;return e.isInitiator&&(l=c.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,n,u.initialMsg,l)}}else return await this.performXXHandshake(e,n)}async performXXFallbackHandshake(e,r,n,i){let{isInitiator:s,remotePeer:o,connection:a}=e,c=new pJe.XXFallbackHandshake(s,r,this.prologue,this.staticKeys,a,n,o,i);try{await c.propose(),await c.exchange(),await c.finish()}catch(u){(0,yJe.logger)(u);let l=u;throw new Error(`Error occurred during XX Fallback handshake: ${l.message}`)}return c}async performXXHandshake(e,r){let{isInitiator:n,remotePeer:i,connection:s}=e,o=new hJe.XXHandshake(n,r,this.prologue,this.staticKeys,s,i);try{await o.propose(),await o.exchange(),await o.finish(),this.useNoisePipes&&o.remotePeer&&vO.KeyCache.store(o.remotePeer,o.getRemoteStaticKey())}catch(a){let c=a;throw new Error(`Error occurred during XX handshake: ${c.message}`)}return o}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,r){let[n,i]=(0,lJe.default)(),s=e.unwrap();return await(0,fJe.default)(n,fge.default,(0,pge.encryptStream)(r),(0,hge.encode)({lengthEncoder:dy.uint16BEEncode}),s,(0,hge.decode)({lengthDecoder:dy.uint16BEDecode}),fge.default,(0,pge.decryptStream)(r),n),i}};Mo.Noise=gge});var mge=g(Ku=>{"use strict";var gJe=Ku&&Ku.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mJe=Ku&&Ku.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&gJe(e,t,r)};Object.defineProperty(Ku,"__esModule",{value:!0});Ku.NOISE=void 0;var wJe=EO();mJe(EO(),Ku);Ku.NOISE=new wJe.Noise});var _ge=g((YMt,bge)=>{"use strict";var bJe=SC(),{EventEmitter:_Je}=Gt();function wge(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0,n=t.length;r<n;++r)if(t[r]!==e[r])return!1;return!0}function SO(){return{contacts:[],dontSplit:!1,left:null,right:null}}function _3(t,e){if(!(e instanceof Uint8Array))throw new TypeError(t+" is not a Uint8Array")}var v3=class extends _Je{constructor(e={}){super();this.localNodeId=e.localNodeId||bJe(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||v3.distance,this.arbiter=e.arbiter||v3.arbiter,this.metadata=Object.assign({},e.metadata),_3("option.localNodeId as parameter 1",this.localNodeId),this.root=SO()}static arbiter(e,r){return e.vectorClock>r.vectorClock?e:r}static distance(e,r){let n=0,i=0,s=Math.min(e.length,r.length),o=Math.max(e.length,r.length);for(;i<s;++i)n=n*256+(e[i]^r[i]);for(;i<o;++i)n=n*256+255;return n}add(e){_3("contact.id",(e||{}).id);let r=0,n=this.root;for(;n.contacts===null;)n=this._determineNode(n,e.id,r++);let i=this._indexOf(n,e.id);return i>=0?(this._update(n,i,e),this):n.contacts.length<this.numberOfNodesPerKBucket?(n.contacts.push(e),this.emit("added",e),this):n.dontSplit?(this.emit("ping",n.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(n,r),this.add(e))}closest(e,r=1/0){if(_3("id",e),!Number.isInteger(r)&&r!==1/0||r<=0)throw new TypeError("n is not positive number");let n=[];for(let i=[this.root],s=0;i.length>0&&n.length<r;){let o=i.pop();if(o.contacts===null){let a=this._determineNode(o,e,s++);i.push(o.left===a?o.right:o.left),i.push(a)}else n=n.concat(o.contacts)}return n.map(i=>[this.distance(i.id,e),i]).sort((i,s)=>i[0]-s[0]).slice(0,r).map(i=>i[1])}count(){let e=0;for(let r=[this.root];r.length>0;){let n=r.pop();n.contacts===null?r.push(n.right,n.left):e+=n.contacts.length}return e}_determineNode(e,r,n){let i=n>>3,s=n%8;return r.length<=i&&s!==0?e.left:r[i]&1<<7-s?e.right:e.left}get(e){_3("id",e);let r=0,n=this.root;for(;n.contacts===null;)n=this._determineNode(n,e,r++);let i=this._indexOf(n,e);return i>=0?n.contacts[i]:null}_indexOf(e,r){for(let n=0;n<e.contacts.length;++n)if(wge(e.contacts[n].id,r))return n;return-1}remove(e){_3("the id as parameter 1",e);let r=0,n=this.root;for(;n.contacts===null;)n=this._determineNode(n,e,r++);let i=this._indexOf(n,e);if(i>=0){let s=n.contacts.splice(i,1)[0];this.emit("removed",s)}return this}_split(e,r){e.left=SO(),e.right=SO();for(let s of e.contacts)this._determineNode(e,s.id,r).contacts.push(s);e.contacts=null;let n=this._determineNode(e,this.localNodeId,r),i=e.left===n?e.right:e.left;i.dontSplit=!0}toArray(){let e=[];for(let r=[this.root];r.length>0;){let n=r.pop();n.contacts===null?r.push(n.right,n.left):e=e.concat(n.contacts)}return e}*toIterable(){for(let e=[this.root];e.length>0;){let r=e.pop();r.contacts===null?e.push(r.right,r.left):yield*r.contacts}}_update(e,r,n){if(!wge(e.contacts[r].id,n.id))throw new Error("wrong index for _update");let i=e.contacts[r],s=this.arbiter(i,n);s===i&&i!==n||(e.contacts.splice(r,1),e.contacts.push(s),this.emit("updated",i,s))}};bge.exports=v3});var vge=g(E3=>{(function(){var t,e,r,n,i,s,o,a;a=function(c){var u,l,f,h;return u=(c&255<<24)>>>24,l=(c&255<<16)>>>16,f=(c&255<<8)>>>8,h=c&255,[u,l,f,h].join(".")},o=function(c){var u,l,f,h,d,p;for(u=[],f=h=0;h<=3&&c.length!==0;f=++h){if(f>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}p=e(c),d=p[0],l=p[1],c=c.substring(l),u.push(d)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},r=function(c){return c.charCodeAt(0)},n=r("0"),s=r("a"),i=r("A"),e=function(c){var u,l,f,h,d;for(h=0,u=10,l="9",f=0,c.length>1&&c[f]==="0"&&(c[f+1]==="x"||c[f+1]==="X"?(f+=2,u=16):"0"<=c[f+1]&&c[f+1]<="9"&&(f++,u=8,l="7")),d=f;f<c.length;){if("0"<=c[f]&&c[f]<=l)h=h*u+(r(c[f])-n)>>>0;else if(u===16)if("a"<=c[f]&&c[f]<="f")h=h*u+(10+r(c[f])-s)>>>0;else if("A"<=c[f]&&c[f]<="F")h=h*u+(10+r(c[f])-i)>>>0;else break;else break;if(h>4294967295)throw new Error("too large");f++}if(f===d)throw new Error("empty octet");return[h,f]},t=function(){function c(u,l){var f,h,d,p;if(typeof u!="string")throw new Error("Missing `net' parameter");if(l||(p=u.split("/",2),u=p[0],l=p[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=o(l)}catch(y){throw f=y,new Error("Invalid mask: "+l)}for(h=d=32;d>=0;h=--d)if(this.maskLong===4294967295<<32-h>>>0){this.bitmask=h;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(u)&this.maskLong)>>>0}catch(y){throw f=y,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(o(u)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var l,f,h;for(h=o(this.first),f=o(this.last),l=0;h<=f;)u(a(h),h,l),l++,h++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),E3.ip2long=o,E3.long2ip=a,E3.Netmask=t}).call(E3)});var Sge=g((Ege,av)=>{(function(t){"use strict";let e="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp(`^${e}\\.${e}\\.${e}\\.${e}$`,"i"),threeOctet:new RegExp(`^${e}\\.${e}\\.${e}$`,"i"),twoOctet:new RegExp(`^${e}\\.${e}$`,"i"),longValue:new RegExp(`^${e}$`,"i")},n=new RegExp("^0[0-7]+$","i"),i=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${e}\\.${e}\\.${e}\\.${e}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${e}\\.${e}\\.${e}\\.${e}(${s})?$`,"i")};function c(d,p){if(d.indexOf("::")!==d.lastIndexOf("::"))return null;let y=0,b=-1,m=(d.match(a.zoneIndex)||[])[0],_,R;for(m&&(m=m.substring(1),d=d.replace(/%.+$/,""));(b=d.indexOf(":",b+1))>=0;)y++;if(d.substr(0,2)==="::"&&y--,d.substr(-2,2)==="::"&&y--,y>p)return null;for(R=p-y,_=":";R--;)_+="0:";return d=d.replace("::",_),d[0]===":"&&(d=d.slice(1)),d[d.length-1]===":"&&(d=d.slice(0,-1)),p=function(){let k=d.split(":"),P=[];for(let x=0;x<k.length;x++)P.push(parseInt(k[x],16));return P}(),{parts:p,zoneId:m}}function u(d,p,y,b){if(d.length!==p.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let m=0,_;for(;b>0;){if(_=y-b,_<0&&(_=0),d[m]>>_!==p[m]>>_)return!1;b-=y,m+=1}return!0}function l(d){if(i.test(d))return parseInt(d,16);if(d[0]==="0"&&!isNaN(parseInt(d[1],10))){if(n.test(d))return parseInt(d,8);throw new Error(`ipaddr: cannot parse ${d} as octal`)}return parseInt(d,10)}function f(d,p){for(;d.length<p;)d=`0${d}`;return d}let h={};h.IPv4=function(){function d(p){if(p.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let y,b;for(y=0;y<p.length;y++)if(b=p[y],!(0<=b&&b<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=p}return d.prototype.SpecialRanges={unspecified:[[new d([0,0,0,0]),8]],broadcast:[[new d([255,255,255,255]),32]],multicast:[[new d([224,0,0,0]),4]],linkLocal:[[new d([169,254,0,0]),16]],loopback:[[new d([127,0,0,0]),8]],carrierGradeNat:[[new d([100,64,0,0]),10]],private:[[new d([10,0,0,0]),8],[new d([172,16,0,0]),12],[new d([192,168,0,0]),16]],reserved:[[new d([192,0,0,0]),24],[new d([192,0,2,0]),24],[new d([192,88,99,0]),24],[new d([198,51,100,0]),24],[new d([203,0,113,0]),24],[new d([240,0,0,0]),4]]},d.prototype.kind=function(){return"ipv4"},d.prototype.match=function(p,y){let b;if(y===void 0&&(b=p,p=b[0],y=b[1]),p.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,p.octets,8,y)},d.prototype.prefixLengthFromSubnetMask=function(){let p=0,y=!1,b={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},m,_,R;for(m=3;m>=0;m-=1)if(_=this.octets[m],_ in b){if(R=b[_],y&&R!==0)return null;R!==8&&(y=!0),p+=R}else return null;return 32-p},d.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},d.prototype.toByteArray=function(){return this.octets.slice(0)},d.prototype.toIPv4MappedAddress=function(){return h.IPv6.parse(`::ffff:${this.toString()}`)},d.prototype.toNormalizedString=function(){return this.toString()},d.prototype.toString=function(){return this.octets.join(".")},d}(),h.IPv4.broadcastAddressFromCIDR=function(d){try{let p=this.parseCIDR(d),y=p[0].toByteArray(),b=this.subnetMaskFromPrefixLength(p[1]).toByteArray(),m=[],_=0;for(;_<4;)m.push(parseInt(y[_],10)|parseInt(b[_],10)^255),_++;return new this(m)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.isIPv4=function(d){return this.parser(d)!==null},h.IPv4.isValid=function(d){try{return new this(this.parser(d)),!0}catch{return!1}},h.IPv4.isValidFourPartDecimal=function(d){return!!(h.IPv4.isValid(d)&&d.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},h.IPv4.networkAddressFromCIDR=function(d){let p,y,b,m,_;try{for(p=this.parseCIDR(d),b=p[0].toByteArray(),_=this.subnetMaskFromPrefixLength(p[1]).toByteArray(),m=[],y=0;y<4;)m.push(parseInt(b[y],10)&parseInt(_[y],10)),y++;return new this(m)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.parse=function(d){let p=this.parser(d);if(p===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(p)},h.IPv4.parseCIDR=function(d){let p;if(p=d.match(/^(.+)\/(\d+)$/)){let y=parseInt(p[2]);if(y>=0&&y<=32){let b=[this.parse(p[1]),y];return Object.defineProperty(b,"toString",{value:function(){return this.join("/")}}),b}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},h.IPv4.parser=function(d){let p,y,b;if(p=d.match(r.fourOctet))return function(){let m=p.slice(1,6),_=[];for(let R=0;R<m.length;R++)y=m[R],_.push(l(y));return _}();if(p=d.match(r.longValue)){if(b=l(p[1]),b>4294967295||b<0)throw new Error("ipaddr: address outside defined range");return function(){let m=[],_;for(_=0;_<=24;_+=8)m.push(b>>_&255);return m}().reverse()}else return(p=d.match(r.twoOctet))?function(){let m=p.slice(1,4),_=[];if(b=l(m[1]),b>16777215||b<0)throw new Error("ipaddr: address outside defined range");return _.push(l(m[0])),_.push(b>>16&255),_.push(b>>8&255),_.push(b&255),_}():(p=d.match(r.threeOctet))?function(){let m=p.slice(1,5),_=[];if(b=l(m[2]),b>65535||b<0)throw new Error("ipaddr: address outside defined range");return _.push(l(m[0])),_.push(l(m[1])),_.push(b>>8&255),_.push(b&255),_}():null},h.IPv4.subnetMaskFromPrefixLength=function(d){if(d=parseInt(d),d<0||d>32)throw new Error("ipaddr: invalid IPv4 prefix length");let p=[0,0,0,0],y=0,b=Math.floor(d/8);for(;y<b;)p[y]=255,y++;return b<4&&(p[b]=Math.pow(2,d%8)-1<<8-d%8),new this(p)},h.IPv6=function(){function d(p,y){let b,m;if(p.length===16)for(this.parts=[],b=0;b<=14;b+=2)this.parts.push(p[b]<<8|p[b+1]);else if(p.length===8)this.parts=p;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(b=0;b<this.parts.length;b++)if(m=this.parts[b],!(0<=m&&m<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");y&&(this.zoneId=y)}return d.prototype.SpecialRanges={unspecified:[new d([0,0,0,0,0,0,0,0]),128],linkLocal:[new d([65152,0,0,0,0,0,0,0]),10],multicast:[new d([65280,0,0,0,0,0,0,0]),8],loopback:[new d([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new d([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new d([0,0,0,0,0,65535,0,0]),96],rfc6145:[new d([0,0,0,0,65535,0,0,0]),96],rfc6052:[new d([100,65435,0,0,0,0,0,0]),96],"6to4":[new d([8194,0,0,0,0,0,0,0]),16],teredo:[new d([8193,0,0,0,0,0,0,0]),32],reserved:[[new d([8193,3512,0,0,0,0,0,0]),32]]},d.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},d.prototype.kind=function(){return"ipv6"},d.prototype.match=function(p,y){let b;if(y===void 0&&(b=p,p=b[0],y=b[1]),p.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,p.parts,16,y)},d.prototype.prefixLengthFromSubnetMask=function(){let p=0,y=!1,b={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},m,_;for(let R=7;R>=0;R-=1)if(m=this.parts[R],m in b){if(_=b[m],y&&_!==0)return null;_!==16&&(y=!0),p+=_}else return null;return 128-p},d.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},d.prototype.toByteArray=function(){let p,y=[],b=this.parts;for(let m=0;m<b.length;m++)p=b[m],y.push(p>>8),y.push(p&255);return y},d.prototype.toFixedLengthString=function(){let p=function(){let b=[];for(let m=0;m<this.parts.length;m++)b.push(f(this.parts[m].toString(16),4));return b}.call(this).join(":"),y="";return this.zoneId&&(y=`%${this.zoneId}`),p+y},d.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let p=this.parts.slice(-2),y=p[0],b=p[1];return new h.IPv4([y>>8,y&255,b>>8,b&255])},d.prototype.toNormalizedString=function(){let p=function(){let b=[];for(let m=0;m<this.parts.length;m++)b.push(this.parts[m].toString(16));return b}.call(this).join(":"),y="";return this.zoneId&&(y=`%${this.zoneId}`),p+y},d.prototype.toRFC5952String=function(){let p=/((^|:)(0(:|$)){2,})/g,y=this.toNormalizedString(),b=0,m=-1,_;for(;_=p.exec(y);)_[0].length>m&&(b=_.index,m=_[0].length);return m<0?y:`${y.substring(0,b)}::${y.substring(b+m)}`},d.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},d}(),h.IPv6.broadcastAddressFromCIDR=function(d){try{let p=this.parseCIDR(d),y=p[0].toByteArray(),b=this.subnetMaskFromPrefixLength(p[1]).toByteArray(),m=[],_=0;for(;_<16;)m.push(parseInt(y[_],10)|parseInt(b[_],10)^255),_++;return new this(m)}catch(p){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${p})`)}},h.IPv6.isIPv6=function(d){return this.parser(d)!==null},h.IPv6.isValid=function(d){if(typeof d=="string"&&d.indexOf(":")===-1)return!1;try{let p=this.parser(d);return new this(p.parts,p.zoneId),!0}catch{return!1}},h.IPv6.networkAddressFromCIDR=function(d){let p,y,b,m,_;try{for(p=this.parseCIDR(d),b=p[0].toByteArray(),_=this.subnetMaskFromPrefixLength(p[1]).toByteArray(),m=[],y=0;y<16;)m.push(parseInt(b[y],10)&parseInt(_[y],10)),y++;return new this(m)}catch(R){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${R})`)}},h.IPv6.parse=function(d){let p=this.parser(d);if(p.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(p.parts,p.zoneId)},h.IPv6.parseCIDR=function(d){let p,y,b;if((y=d.match(/^(.+)\/(\d+)$/))&&(p=parseInt(y[2]),p>=0&&p<=128))return b=[this.parse(y[1]),p],Object.defineProperty(b,"toString",{value:function(){return this.join("/")}}),b;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},h.IPv6.parser=function(d){let p,y,b,m,_,R;if(b=d.match(a.deprecatedTransitional))return this.parser(`::ffff:${b[1]}`);if(a.native.test(d))return c(d,8);if((b=d.match(a.transitional))&&(R=b[6]||"",p=c(b[1].slice(0,-1)+R,6),p.parts)){for(_=[parseInt(b[2]),parseInt(b[3]),parseInt(b[4]),parseInt(b[5])],y=0;y<_.length;y++)if(m=_[y],!(0<=m&&m<=255))return null;return p.parts.push(_[0]<<8|_[1]),p.parts.push(_[2]<<8|_[3]),{parts:p.parts,zoneId:p.zoneId}}return null},h.IPv6.subnetMaskFromPrefixLength=function(d){if(d=parseInt(d),d<0||d>128)throw new Error("ipaddr: invalid IPv6 prefix length");let p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],y=0,b=Math.floor(d/8);for(;y<b;)p[y]=255,y++;return b<16&&(p[b]=Math.pow(2,d%8)-1<<8-d%8),new this(p)},h.fromByteArray=function(d){let p=d.length;if(p===4)return new h.IPv4(d);if(p===16)return new h.IPv6(d);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},h.isValid=function(d){return h.IPv6.isValid(d)||h.IPv4.isValid(d)},h.parse=function(d){if(h.IPv6.isValid(d))return h.IPv6.parse(d);if(h.IPv4.isValid(d))return h.IPv4.parse(d);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},h.parseCIDR=function(d){try{return h.IPv6.parseCIDR(d)}catch{try{return h.IPv4.parseCIDR(d)}catch{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},h.process=function(d){let p=this.parse(d);return p.kind()==="ipv6"&&p.isIPv4MappedAddress()?p.toIPv4Address():p},h.subnetMatch=function(d,p,y){let b,m,_,R;y==null&&(y="unicast");for(m in p)if(Object.prototype.hasOwnProperty.call(p,m)){for(_=p[m],_[0]&&!(_[0]instanceof Array)&&(_=[_]),b=0;b<_.length;b++)if(R=_[b],d.kind()===R[0].kind()&&d.match.apply(d,R))return m}return y},typeof av<"u"&&av.exports?av.exports=h:t.ipaddr=h})(Ege)});var Tge=g(S3=>{"use strict";var Ige=S3&&S3.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(S3,"__esModule",{value:!0});var vJe=vge(),EJe=Ige(CE()),SJe=Ige(kE()),Age=Sge(),AJe=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],RJe=AJe.map(t=>new vJe.Netmask(t));function IJe(t){for(let e of RJe)if(e.contains(t))return!0;return!1}function Rge(t){return/^::$/.test(t)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t)}S3.default=t=>{if(Age.isValid(t)){let e=Age.parse(t);if(e.kind()==="ipv4")return IJe(e.toNormalizedString());if(e.kind()==="ipv6")return Rge(t)}else if(SJe.default(t)&&EJe.default.v6().test(t))return Rge(t)}});var cv=g((ZMt,xge)=>{"use strict";xge.exports=Tge().default});var qr=g((JMt,Oge)=>{"use strict";var A3=he(),{sha256:Pge}=(Tn(),se(Js)),{base58btc:TJe}=(wn(),se(Zo)),{base32:xJe}=(fi(),se(Wc)),{Key:PJe}=(Vr(),se(Mp)),{Record:CJe}=cc(),OJe=ft(),{fromString:kJe}=(dt(),se(nn)),{toString:AO}=(st(),se(hr)),{concat:DJe}=(Pn(),se(Ui)),Cge=cv(),NJe=kJe("/pk/");function BJe({id:t,multiaddrs:e}){return{id:t,multiaddrs:e.filter(r=>{let[[n,i]]=r.stringTuples();return n!==4&&n!==6?!1:!Cge(i)})}}function LJe({id:t,multiaddrs:e}){return{id:t,multiaddrs:e.filter(r=>{let[[n,i]]=r.stringTuples();return n!==4&&n!==6?!1:Cge(i)})}}var MJe=async t=>(await Pge.digest(t)).digest,UJe=async t=>(await Pge.digest(t.id)).digest,qJe=t=>new PJe("/"+AO(t,"base32"),!1),FJe=t=>DJe([NJe,t.id]),KJe=t=>AO(t.slice(0,4))==="/pk/",jJe=t=>AO(t.slice(0,4))==="/ipns/",VJe=t=>new OJe(t.slice(4)),zJe=(t,e)=>{let r=new Date;return new CJe(t,e,r).serialize()},HJe=t=>(A3.formatters.b=r=>TJe.baseEncode(r),A3.formatters.t=r=>xJe.baseEncode(r),A3.formatters.p=r=>r.toB58String(),Object.assign(A3(t),{error:A3(`${t}:error`)}));Oge.exports={removePrivateAddresses:BJe,removePublicAddresses:LJe,convertBuffer:MJe,convertPeerId:UJe,bufferToKey:qJe,keyForPublicKey:FJe,isPublicKeyKey:KJe,isIPNSKey:jJe,fromPublicKeyKey:VJe,createPutRecord:zJe,logger:HJe}});var Uc=g(Un=>{"use strict";var R3=Un.second=1e3,RO=Un.minute=60*R3,IO=Un.hour=60*RO;Un.MAX_RECORD_AGE=36*IO;Un.PROTOCOL_DHT="/kad/1.0.0";Un.RECORD_KEY_PREFIX="/dht/record";Un.PROVIDER_KEY_PREFIX="/dht/provider";Un.PROVIDERS_LRU_CACHE_SIZE=256;Un.PROVIDERS_VALIDITY=24*IO;Un.PROVIDERS_CLEANUP_INTERVAL=IO;Un.READ_MESSAGE_TIMEOUT=10*R3;Un.GET_MANY_RECORD_COUNT=16;Un.K=20;Un.ALPHA=3;Un.QUERY_SELF_INTERVAL=Number(5*RO);Un.QUERY_SELF_TIMEOUT=Number(30*R3);Un.TABLE_REFRESH_INTERVAL=Number(5*RO);Un.TABLE_REFRESH_QUERY_TIMEOUT=Number(30*R3);Un.DEFAULT_QUERY_TIMEOUT=Number(30*R3)});var Nge=g((tUt,Dge)=>{"use strict";var $Je=_ge(),I3=qr(),{default:GJe}=ia(),{PROTOCOL_DHT:WJe}=Uc(),{TimeoutController:YJe}=za(),TO="routing-table-size",kge=class{constructor({peerId:e,dialer:r,kBucketSize:n,pingTimeout:i,lan:s,metrics:o}){this._log=I3.logger(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table`),this._peerId=e,this._dialer=r,this._kBucketSize=n||20,this._pingTimeout=i||1e4,this._lan=s,this._metrics=o,this.kb,this.commonPrefixLengthRefreshedAt=[],this._onPing=this._onPing.bind(this),this._pingQueue=new GJe({concurrency:1}),this._running=!1}async start(){this._running=!0,this.kb=new $Je({localNodeId:await I3.convertPeerId(this._peerId),numberOfNodesPerKBucket:this._kBucketSize,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}async stop(){this._running=!1,this._pingQueue.clear()}_onPing(e,r){this._pingQueue.add(async()=>{if(!this._running)return;let n=0;try{await Promise.all(e.map(async i=>{let s;try{s=new YJe(this._pingTimeout),this._log(`pinging old contact ${i.peer}`);let{stream:o}=await this._dialer.dialProtocol(i.peer,WJe,{signal:s.signal});await o.close(),n++}catch(o){this._running&&(this._log.error("could not ping peer %p",i.peer,o),this._log(`evicting old contact after ping failed ${i.peer}`),this.kb.remove(i.id))}finally{s&&s.clear(),this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:TO,value:this.size})}})),this._running&&n<e.length&&(this._log(`adding new contact ${r.peer}`),this.kb.add(r))}catch(i){this._log.error("could not process k-bucket ping event",i)}})}get size(){return this.kb.count()}async find(e){let r=await I3.convertPeerId(e),n=this.closestPeer(r);if(n&&e.equals(n))return n}closestPeer(e){let r=this.closestPeers(e,1);if(r.length>0)return r[0]}closestPeers(e,r=this._kBucketSize){return this.kb.closest(e,r).map(i=>i.peer)}async add(e){let r=await I3.convertPeerId(e);this.kb.add({id:r,peer:e}),this._log("added %p with kad id %b",e,r),this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:TO,value:this.size})}async remove(e){let r=await I3.convertPeerId(e);this.kb.remove(r),this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:TO,value:this.size})}};Dge.exports.RoutingTable=kge});var Bge=g((rUt,XJe)=>{XJe.exports=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782]});var Uge=g((nUt,Mge)=>{"use strict";var{xor:QJe}=(m3(),se(Y_)),ZJe=Bge(),{sha256:JJe}=(Tn(),se(Js)),eet=oc(),tet=ft(),ret=qr(),net=im(),{TimeoutController:iet}=za(),{TABLE_REFRESH_INTERVAL:set,TABLE_REFRESH_QUERY_TIMEOUT:oet}=Uc(),uv=15,Lge=class{constructor({peerRouting:e,routingTable:r,refreshInterval:n,refreshQueryTimeout:i,lan:s}){this._log=ret.logger(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table:refresh`),this._peerRouting=e,this._routingTable=r,this._refreshInterval=n||set,this._refreshQueryTimeout=i||oet,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this._log(`refreshing routing table every ${this._refreshInterval}ms`),await this.refreshTable(!0)}async stop(){this._refreshTimeoutId&&clearTimeout(this._refreshTimeoutId)}async refreshTable(e){this._log("refreshing routing table");let r=this._maxCommonPrefix(),n=this._getTrackedCommonPrefixLengthsForRefresh(r);this._log(`max common prefix length ${r}`),this._log(`tracked CPLs [ ${n.map(i=>i.toISOString()).join(", ")} ]`),await Promise.all(n.map(async(i,s)=>{try{if(await this._refreshCommonPrefixLength(s,i,e===!0),this._numPeersForCpl(r)===0){let o=Math.min(2*(s+1),n.length-1);for(let a=s+1;a<o+1;a++)try{await this._refreshCommonPrefixLength(a,i,e===!0)}catch(c){this._log.error(c)}}}catch(o){this._log.error(o)}})),this._refreshTimeoutId=setTimeout(this.refreshTable,this._refreshInterval),this._refreshTimeoutId.unref&&this._refreshTimeoutId.unref()}async _refreshCommonPrefixLength(e,r,n){if(!n&&r.getTime()>Date.now()-this._refreshInterval){this._log("not running refresh for cpl %s as time since last refresh not above interval",e);return}let i=await this._generateRandomPeerId(e);this._log("starting refreshing cpl %s with key %p (routing table size was %s)",e,i,this._routingTable.kb.count());let s=new iet(this._refreshQueryTimeout);try{let o=await net(this._peerRouting.getClosestPeers(i.toBytes(),{signal:s.signal}));this._log(`found ${o} peers that were close to imaginary peer %p`,i),this._log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,i,this._routingTable.kb.count())}finally{s.clear()}}_getTrackedCommonPrefixLengthsForRefresh(e){e>uv&&(e=uv);let r=[];for(let n=0;n<=e;n++)r[n]=this.commonPrefixLengthRefreshedAt[n]||new Date;return r}async _generateRandomPeerId(e){let r=eet.randomBytes(2),n=(r[1]<<8)+r[0],i=await this._makePeerId(this._routingTable.kb.localNodeId,n,e);return tet.createFromBytes(i)}async _makePeerId(e,r,n){if(n>uv)throw new Error(`Cannot generate peer ID for common prefix length greater than ${uv}`);let o=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1)^32768>>n,a=65535<<16-(n+1),c=o&a|r&~a,u=ZJe[c],l=new ArrayBuffer(34),f=new DataView(l,0,l.byteLength);return f.setUint8(0,JJe.code),f.setUint8(1,32),f.setUint32(2,u,!1),new Uint8Array(f.buffer,f.byteOffset,f.byteLength)}_maxCommonPrefix(){let e=0;for(let r of this._prefixLengths())r>e&&(e=r);return e}_numPeersForCpl(e){let r=0;for(let n of this._prefixLengths())n===e&&r++;return r}*_prefixLengths(){if(!!this._routingTable.kb)for(let{id:e}of this._routingTable.kb.toIterable()){let r=QJe(this._routingTable.kb.localNodeId,e),n=0;for(let i of r)if(i===0)n++;else break;yield n}}};Mge.exports.RoutingTableRefresh=Lge});var PO=g((iUt,qge)=>{"use strict";var Of=Kr(),py=Of.Reader,xO=Of.Writer,Ze=Of.util,hn=Of.roots["libp2p-dht-message"]||(Of.roots["libp2p-dht-message"]={});hn.Record=function(){function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}t.prototype.key=null,t.prototype.value=null,t.prototype.author=null,t.prototype.signature=null,t.prototype.timeReceived=null;var e;return Object.defineProperty(t.prototype,"_key",{get:Ze.oneOfGetter(e=["key"]),set:Ze.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_value",{get:Ze.oneOfGetter(e=["value"]),set:Ze.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_author",{get:Ze.oneOfGetter(e=["author"]),set:Ze.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_signature",{get:Ze.oneOfGetter(e=["signature"]),set:Ze.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_timeReceived",{get:Ze.oneOfGetter(e=["timeReceived"]),set:Ze.oneOfSetter(e)}),t.encode=function(n,i){return i||(i=xO.create()),n.key!=null&&Object.hasOwnProperty.call(n,"key")&&i.uint32(10).bytes(n.key),n.value!=null&&Object.hasOwnProperty.call(n,"value")&&i.uint32(18).bytes(n.value),n.author!=null&&Object.hasOwnProperty.call(n,"author")&&i.uint32(26).bytes(n.author),n.signature!=null&&Object.hasOwnProperty.call(n,"signature")&&i.uint32(34).bytes(n.signature),n.timeReceived!=null&&Object.hasOwnProperty.call(n,"timeReceived")&&i.uint32(42).string(n.timeReceived),i},t.decode=function(n,i){n instanceof py||(n=py.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new hn.Record;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.key=n.bytes();break;case 2:o.value=n.bytes();break;case 3:o.author=n.bytes();break;case 4:o.signature=n.bytes();break;case 5:o.timeReceived=n.string();break;default:n.skipType(a&7);break}}return o},t.fromObject=function(n){if(n instanceof hn.Record)return n;var i=new hn.Record;return n.key!=null&&(typeof n.key=="string"?Ze.base64.decode(n.key,i.key=Ze.newBuffer(Ze.base64.length(n.key)),0):n.key.length&&(i.key=n.key)),n.value!=null&&(typeof n.value=="string"?Ze.base64.decode(n.value,i.value=Ze.newBuffer(Ze.base64.length(n.value)),0):n.value.length&&(i.value=n.value)),n.author!=null&&(typeof n.author=="string"?Ze.base64.decode(n.author,i.author=Ze.newBuffer(Ze.base64.length(n.author)),0):n.author.length&&(i.author=n.author)),n.signature!=null&&(typeof n.signature=="string"?Ze.base64.decode(n.signature,i.signature=Ze.newBuffer(Ze.base64.length(n.signature)),0):n.signature.length&&(i.signature=n.signature)),n.timeReceived!=null&&(i.timeReceived=String(n.timeReceived)),i},t.toObject=function(n,i){i||(i={});var s={};return n.key!=null&&n.hasOwnProperty("key")&&(s.key=i.bytes===String?Ze.base64.encode(n.key,0,n.key.length):i.bytes===Array?Array.prototype.slice.call(n.key):n.key,i.oneofs&&(s._key="key")),n.value!=null&&n.hasOwnProperty("value")&&(s.value=i.bytes===String?Ze.base64.encode(n.value,0,n.value.length):i.bytes===Array?Array.prototype.slice.call(n.value):n.value,i.oneofs&&(s._value="value")),n.author!=null&&n.hasOwnProperty("author")&&(s.author=i.bytes===String?Ze.base64.encode(n.author,0,n.author.length):i.bytes===Array?Array.prototype.slice.call(n.author):n.author,i.oneofs&&(s._author="author")),n.signature!=null&&n.hasOwnProperty("signature")&&(s.signature=i.bytes===String?Ze.base64.encode(n.signature,0,n.signature.length):i.bytes===Array?Array.prototype.slice.call(n.signature):n.signature,i.oneofs&&(s._signature="signature")),n.timeReceived!=null&&n.hasOwnProperty("timeReceived")&&(s.timeReceived=n.timeReceived,i.oneofs&&(s._timeReceived="timeReceived")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,Of.util.toJSONOptions)},t}();hn.Message=function(){function t(r){if(this.closerPeers=[],this.providerPeers=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}t.prototype.type=null,t.prototype.clusterLevelRaw=null,t.prototype.key=null,t.prototype.record=null,t.prototype.closerPeers=Ze.emptyArray,t.prototype.providerPeers=Ze.emptyArray;var e;return Object.defineProperty(t.prototype,"_type",{get:Ze.oneOfGetter(e=["type"]),set:Ze.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_clusterLevelRaw",{get:Ze.oneOfGetter(e=["clusterLevelRaw"]),set:Ze.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_key",{get:Ze.oneOfGetter(e=["key"]),set:Ze.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_record",{get:Ze.oneOfGetter(e=["record"]),set:Ze.oneOfSetter(e)}),t.encode=function(n,i){if(i||(i=xO.create()),n.type!=null&&Object.hasOwnProperty.call(n,"type")&&i.uint32(8).int32(n.type),n.key!=null&&Object.hasOwnProperty.call(n,"key")&&i.uint32(18).bytes(n.key),n.record!=null&&Object.hasOwnProperty.call(n,"record")&&i.uint32(26).bytes(n.record),n.closerPeers!=null&&n.closerPeers.length)for(var s=0;s<n.closerPeers.length;++s)hn.Message.Peer.encode(n.closerPeers[s],i.uint32(66).fork()).ldelim();if(n.providerPeers!=null&&n.providerPeers.length)for(var s=0;s<n.providerPeers.length;++s)hn.Message.Peer.encode(n.providerPeers[s],i.uint32(74).fork()).ldelim();return n.clusterLevelRaw!=null&&Object.hasOwnProperty.call(n,"clusterLevelRaw")&&i.uint32(80).int32(n.clusterLevelRaw),i},t.decode=function(n,i){n instanceof py||(n=py.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new hn.Message;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.type=n.int32();break;case 10:o.clusterLevelRaw=n.int32();break;case 2:o.key=n.bytes();break;case 3:o.record=n.bytes();break;case 8:o.closerPeers&&o.closerPeers.length||(o.closerPeers=[]),o.closerPeers.push(hn.Message.Peer.decode(n,n.uint32()));break;case 9:o.providerPeers&&o.providerPeers.length||(o.providerPeers=[]),o.providerPeers.push(hn.Message.Peer.decode(n,n.uint32()));break;default:n.skipType(a&7);break}}return o},t.fromObject=function(n){if(n instanceof hn.Message)return n;var i=new hn.Message;switch(n.type){case"PUT_VALUE":case 0:i.type=0;break;case"GET_VALUE":case 1:i.type=1;break;case"ADD_PROVIDER":case 2:i.type=2;break;case"GET_PROVIDERS":case 3:i.type=3;break;case"FIND_NODE":case 4:i.type=4;break;case"PING":case 5:i.type=5;break}if(n.clusterLevelRaw!=null&&(i.clusterLevelRaw=n.clusterLevelRaw|0),n.key!=null&&(typeof n.key=="string"?Ze.base64.decode(n.key,i.key=Ze.newBuffer(Ze.base64.length(n.key)),0):n.key.length&&(i.key=n.key)),n.record!=null&&(typeof n.record=="string"?Ze.base64.decode(n.record,i.record=Ze.newBuffer(Ze.base64.length(n.record)),0):n.record.length&&(i.record=n.record)),n.closerPeers){if(!Array.isArray(n.closerPeers))throw TypeError(".Message.closerPeers: array expected");i.closerPeers=[];for(var s=0;s<n.closerPeers.length;++s){if(typeof n.closerPeers[s]!="object")throw TypeError(".Message.closerPeers: object expected");i.closerPeers[s]=hn.Message.Peer.fromObject(n.closerPeers[s])}}if(n.providerPeers){if(!Array.isArray(n.providerPeers))throw TypeError(".Message.providerPeers: array expected");i.providerPeers=[];for(var s=0;s<n.providerPeers.length;++s){if(typeof n.providerPeers[s]!="object")throw TypeError(".Message.providerPeers: object expected");i.providerPeers[s]=hn.Message.Peer.fromObject(n.providerPeers[s])}}return i},t.toObject=function(n,i){i||(i={});var s={};if((i.arrays||i.defaults)&&(s.closerPeers=[],s.providerPeers=[]),n.type!=null&&n.hasOwnProperty("type")&&(s.type=i.enums===String?hn.Message.MessageType[n.type]:n.type,i.oneofs&&(s._type="type")),n.key!=null&&n.hasOwnProperty("key")&&(s.key=i.bytes===String?Ze.base64.encode(n.key,0,n.key.length):i.bytes===Array?Array.prototype.slice.call(n.key):n.key,i.oneofs&&(s._key="key")),n.record!=null&&n.hasOwnProperty("record")&&(s.record=i.bytes===String?Ze.base64.encode(n.record,0,n.record.length):i.bytes===Array?Array.prototype.slice.call(n.record):n.record,i.oneofs&&(s._record="record")),n.closerPeers&&n.closerPeers.length){s.closerPeers=[];for(var o=0;o<n.closerPeers.length;++o)s.closerPeers[o]=hn.Message.Peer.toObject(n.closerPeers[o],i)}if(n.providerPeers&&n.providerPeers.length){s.providerPeers=[];for(var o=0;o<n.providerPeers.length;++o)s.providerPeers[o]=hn.Message.Peer.toObject(n.providerPeers[o],i)}return n.clusterLevelRaw!=null&&n.hasOwnProperty("clusterLevelRaw")&&(s.clusterLevelRaw=n.clusterLevelRaw,i.oneofs&&(s._clusterLevelRaw="clusterLevelRaw")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,Of.util.toJSONOptions)},t.MessageType=function(){var r={},n=Object.create(r);return n[r[0]="PUT_VALUE"]=0,n[r[1]="GET_VALUE"]=1,n[r[2]="ADD_PROVIDER"]=2,n[r[3]="GET_PROVIDERS"]=3,n[r[4]="FIND_NODE"]=4,n[r[5]="PING"]=5,n}(),t.ConnectionType=function(){var r={},n=Object.create(r);return n[r[0]="NOT_CONNECTED"]=0,n[r[1]="CONNECTED"]=1,n[r[2]="CAN_CONNECT"]=2,n[r[3]="CANNOT_CONNECT"]=3,n}(),t.Peer=function(){function r(i){if(this.addrs=[],i)for(var s=Object.keys(i),o=0;o<s.length;++o)i[s[o]]!=null&&(this[s[o]]=i[s[o]])}r.prototype.id=null,r.prototype.addrs=Ze.emptyArray,r.prototype.connection=null;var n;return Object.defineProperty(r.prototype,"_id",{get:Ze.oneOfGetter(n=["id"]),set:Ze.oneOfSetter(n)}),Object.defineProperty(r.prototype,"_connection",{get:Ze.oneOfGetter(n=["connection"]),set:Ze.oneOfSetter(n)}),r.encode=function(s,o){if(o||(o=xO.create()),s.id!=null&&Object.hasOwnProperty.call(s,"id")&&o.uint32(10).bytes(s.id),s.addrs!=null&&s.addrs.length)for(var a=0;a<s.addrs.length;++a)o.uint32(18).bytes(s.addrs[a]);return s.connection!=null&&Object.hasOwnProperty.call(s,"connection")&&o.uint32(24).int32(s.connection),o},r.decode=function(s,o){s instanceof py||(s=py.create(s));for(var a=o===void 0?s.len:s.pos+o,c=new hn.Message.Peer;s.pos<a;){var u=s.uint32();switch(u>>>3){case 1:c.id=s.bytes();break;case 2:c.addrs&&c.addrs.length||(c.addrs=[]),c.addrs.push(s.bytes());break;case 3:c.connection=s.int32();break;default:s.skipType(u&7);break}}return c},r.fromObject=function(s){if(s instanceof hn.Message.Peer)return s;var o=new hn.Message.Peer;if(s.id!=null&&(typeof s.id=="string"?Ze.base64.decode(s.id,o.id=Ze.newBuffer(Ze.base64.length(s.id)),0):s.id.length&&(o.id=s.id)),s.addrs){if(!Array.isArray(s.addrs))throw TypeError(".Message.Peer.addrs: array expected");o.addrs=[];for(var a=0;a<s.addrs.length;++a)typeof s.addrs[a]=="string"?Ze.base64.decode(s.addrs[a],o.addrs[a]=Ze.newBuffer(Ze.base64.length(s.addrs[a])),0):s.addrs[a].length&&(o.addrs[a]=s.addrs[a])}switch(s.connection){case"NOT_CONNECTED":case 0:o.connection=0;break;case"CONNECTED":case 1:o.connection=1;break;case"CAN_CONNECT":case 2:o.connection=2;break;case"CANNOT_CONNECT":case 3:o.connection=3;break}return o},r.toObject=function(s,o){o||(o={});var a={};if((o.arrays||o.defaults)&&(a.addrs=[]),s.id!=null&&s.hasOwnProperty("id")&&(a.id=o.bytes===String?Ze.base64.encode(s.id,0,s.id.length):o.bytes===Array?Array.prototype.slice.call(s.id):s.id,o.oneofs&&(a._id="id")),s.addrs&&s.addrs.length){a.addrs=[];for(var c=0;c<s.addrs.length;++c)a.addrs[c]=o.bytes===String?Ze.base64.encode(s.addrs[c],0,s.addrs[c].length):o.bytes===Array?Array.prototype.slice.call(s.addrs[c]):s.addrs[c]}return s.connection!=null&&s.hasOwnProperty("connection")&&(a.connection=o.enums===String?hn.Message.ConnectionType[s.connection]:s.connection,o.oneofs&&(a._connection="connection")),a},r.prototype.toJSON=function(){return this.constructor.toObject(this,Of.util.toJSONOptions)},r}(),t}();qge.exports=hn});var Ca=g((sUt,fv)=>{"use strict";var aet=ft(),{Multiaddr:cet}=yt(),{Record:uet}=cc(),lv=PO(),CO=lv.Message.MessageType,jge=lv.Message.ConnectionType,fet=Object.keys(CO),yy=class{constructor(e,r,n){if(r&&!(r instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=r,this._clusterLevelRaw=n,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){let e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(Fge),providerPeers:this.providerPeers.map(Fge),record:void 0};return this.record&&(this.record instanceof Uint8Array?e.record=this.record:e.record=this.record.serialize()),lv.Message.encode(e).finish()}static deserialize(e){let r=lv.Message.decode(e),n=new yy(r.type||0,r.key||Uint8Array.from([]),r.clusterLevelRaw||0);return n.closerPeers=r.closerPeers.map(Kge),n.providerPeers=r.providerPeers.map(Kge),r.record&&r.record.length&&(n.record=uet.deserialize(r.record)),n}};yy.TYPES=CO;yy.CONNECTION_TYPES=jge;function Fge(t){return{id:t.id.id,addrs:(t.multiaddrs||[]).map(r=>r.bytes),connection:jge.CONNECTED}}function Kge(t){return{id:new aet(t.id),multiaddrs:(t.addrs||[]).map(e=>new cet(e))}}fv.exports.Message=yy;fv.exports.MESSAGE_TYPE=CO;fv.exports.MESSAGE_TYPE_LOOKUP=fet});var Dd=g((oUt,Vge)=>{"use strict";var{MESSAGE_TYPE_LOOKUP:het}=Ca(),det=["PUT_VALUE","GET_VALUE","ADD_PROVIDER","GET_PROVIDERS","FIND_NODE","PING"];function pet(t){return{...t,name:"SENDING_QUERY",type:0,messageName:het[t.type],messageType:t.type}}function yet(t){return{...t,name:"PEER_RESPONSE",type:1,messageName:det[t.messageType],closer:t.closer?t.closer:[],providers:t.providers?t.providers:[]}}function get(t){return{...t,name:"FINAL_PEER",type:2}}function met(t){return{...t,name:"QUERY_ERROR",type:3}}function wet(t){return{...t,name:"PROVIDER",type:4}}function bet(t){return{...t,name:"VALUE",type:5}}function _et(t){return{...t,name:"ADDING_PEER",type:6}}function vet(t){return{...t,name:"DIALING_PEER",type:7}}Vge.exports={sendingQueryEvent:pet,peerResponseEvent:yet,finalPeerEvent:get,queryErrorEvent:met,providerEvent:wet,valueEvent:bet,addingPeerEvent:_et,dialingPeerEvent:vet}});var Zge=g((aUt,Qge)=>{"use strict";var Eet=oe(),{pipe:zge}=br(),OO=xo(),Aet=ls(),Ret=qh(),{Message:Iet,MESSAGE_TYPE_LOOKUP:Hge}=Ca(),Tet=qr(),{EventEmitter:xet}=Gt(),{dialingPeerEvent:$ge,sendingQueryEvent:Gge,peerResponseEvent:Wge,queryErrorEvent:Yge}=Dd(),Xge=class extends xet{constructor({dialer:e,protocol:r,lan:n}){super();this._log=Tet.logger(`libp2p:kad-dht:${n?"lan":"wan"}:network`),this._running=!1,this._dialer=e,this._protocol=r}start(){this._running||(this._running=!0)}stop(){this._running=!1}get isStarted(){return this._running}async*sendRequest(e,r,n={}){if(!!this._running){this._log("sending %s to %p",Hge[r.type],e);try{yield $ge({peer:e});let{stream:i}=await this._dialer.dialProtocol(e,this._protocol,n);yield Gge({to:e,type:r.type});let s=await this._writeReadMessage(i,r.serialize(),n);yield Wge({from:e,messageType:s.type,closer:s.closerPeers,providers:s.providerPeers,record:s.record})}catch(i){yield Yge({from:e,error:i})}}}async*sendMessage(e,r,n={}){if(!this._running)return;this._log("sending %s to %p",Hge[r.type],e),yield $ge({peer:e});let{stream:i}=await this._dialer.dialProtocol(e,this._protocol,n);yield Gge({to:e,type:r.type});try{await this._writeMessage(i,r.serialize(),n),yield Wge({from:e,messageType:r.type})}catch(s){yield Yge({from:e,error:s})}}async _writeMessage(e,r,n={}){await zge([r],OO.encode(),e,Aet)}async _writeReadMessage(e,r,n={}){let i=await zge([r],OO.encode(),e,OO.decode(),async o=>{let a=await Ret(o);if(a)return a.slice()});if(i.length===0)throw Eet(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED");let s=Iet.deserialize(i);return s.closerPeers.forEach(o=>{this.emit("peer",o)}),s.providerPeers.forEach(o=>{this.emit("peer",o)}),s}};Qge.exports.Network=Xge});var nme=g((cUt,rme)=>{"use strict";var kO=oe(),{equals:DO}=(bn(),se(Ei)),{toString:Pet}=(st(),se(hr)),NO=cc(),{ALPHA:Cet}=Uc(),kf=qr(),T3=NO.Record,Oet=L5(),ket=xi(),{valueEvent:Jge,queryErrorEvent:eme}=Dd(),{Message:hv}=Ca(),{pipe:Det}=br(),tme=class{constructor({peerId:e,records:r,validators:n,selectors:i,peerRouting:s,queryManager:o,routingTable:a,network:c,lan:u}){this._log=kf.logger(`libp2p:kad-dht:${u?"lan":"wan"}:content-fetching`),this._peerId=e,this._records=r,this._validators=n,this._selectors=i,this._peerRouting=s,this._queryManager=o,this._routingTable=a,this._network=c}async putLocal(e,r){return this._records.put(kf.bufferToKey(e),r)}async getLocal(e){this._log(`getLocal ${Pet(e,"base32")}`);let r=kf.bufferToKey(e);this._log(`fetching record for key ${r}`);let n=await this._records.get(r);this._log(`found ${r} in local datastore`);let i=T3.deserialize(n);return await NO.validator.verifyRecord(this._validators,i),i}async*sendCorrectionRecord(e,r,n,i={}){this._log("sendCorrection for %b",e);let s=await kf.createPutRecord(e,n);for(let{value:o,from:a}of r){if(DO(o,n)){this._log("record was ok");continue}if(this._peerId.equals(a)){try{let l=kf.bufferToKey(e);this._log(`Storing corrected record for key ${l}`),await this._records.put(l,s)}catch(l){this._log.error("Failed error correcting self",l)}continue}let c=!1,u=new hv(hv.TYPES.PUT_VALUE,e,0);u.record=T3.deserialize(s);for await(let l of this._network.sendRequest(a,u,i))l.name==="PEER_RESPONSE"&&l.record&&DO(l.record.value,T3.deserialize(s).value)&&(c=!0),yield l;c||(yield eme({from:a,error:kO(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this._log.error("Failed error correcting entry")}}async*put(e,r,n={}){this._log("put key %b value %b",e,r);let i=await kf.createPutRecord(e,r),s=kf.bufferToKey(e);this._log(`storing record for key ${s}`),await this._records.put(s,i),yield*Det(this._peerRouting.getClosestPeers(e,{signal:n.signal}),o=>ket(o,a=>async()=>{if(a.name!=="FINAL_PEER")return[a];let c=[],u=new hv(hv.TYPES.PUT_VALUE,e,0);u.record=T3.deserialize(i);for await(let l of this._network.sendRequest(a.peer.id,u,n))c.push(l),l.name==="PEER_RESPONSE"&&(l.record&&DO(l.record.value,T3.deserialize(i).value)||c.push(eme({from:a.peer.id,error:kO(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return c}),o=>Oet(o,{ordered:!1,concurrency:Cet}),async function*(o){for await(let a of o)yield*a})}async*get(e,r={}){this._log("get %b",e);let n=[];for await(let a of this.getMany(e,r))a.name==="VALUE"&&n.push(a),yield a;if(!n.length)return;let i=n.map(a=>a.value),s=0;try{s=NO.selection.bestRecord(this._selectors,e,i)}catch(a){if(a.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw a}let o=i[s];if(this._log("GetValue %b %b",e,o),!o)throw kO(new Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(e,n,o,r),yield n[s]}async*getMany(e,r={}){this._log("getMany values for %t",e);try{let a=await this.getLocal(e);yield Jge({value:a.value,from:this._peerId})}catch(a){this._log("error getting local value for %b",e,a)}let n=await kf.convertBuffer(e),i=this._routingTable.closestPeers(n);this._log("found %d peers in routing table",i.length);let s=this,o=async function*({peer:a,signal:c}){for await(let u of s._peerRouting.getValueOrPeers(a,e,{signal:c}))yield u,u.name==="PEER_RESPONSE"&&u.record&&(yield Jge({from:a,value:u.record.value}))};yield*this._queryManager.run(e,i,o,r)}};rme.exports.ContentFetching=tme});var ame=g((uUt,ome)=>{"use strict";var{Message:dv}=Ca(),Net=L5(),Bet=xi(),{convertBuffer:Let,logger:Met}=qr(),{ALPHA:Uet}=Uc(),{pipe:qet}=br(),{queryErrorEvent:Fet,peerResponseEvent:Ket,providerEvent:ime}=Dd(),{Message:{MessageType:jet}}=PO(),sme=class{constructor({peerId:e,network:r,peerRouting:n,queryManager:i,routingTable:s,providers:o,peerStore:a,lan:c}){this._log=Met(`libp2p:kad-dht:${c?"lan":"wan"}:content-routing`),this._peerId=e,this._network=r,this._peerRouting=n,this._queryManager=i,this._routingTable=s,this._providers=o,this._peerStore=a}async*provide(e,r,n={}){this._log("provide %s",e),await this._providers.addProvider(e,this._peerId);let i=new dv(dv.TYPES.ADD_PROVIDER,e.bytes,0);i.providerPeers=[{id:this._peerId,multiaddrs:r}];let s=0,o=a=>async()=>{if(a.name!=="FINAL_PEER")return[a];let c=[];this._log("putProvider %s to %p",e,a.peer.id);try{this._log("sending provider record for %s to %p",e,a.peer.id);for await(let u of this._network.sendMessage(a.peer.id,i,n))u.name==="PEER_RESPONSE"&&(this._log("sent provider record for %s to %p",e,a.peer.id),s++),c.push(u)}catch(u){this._log.error("error sending provide record to peer %p",a.peer.id,u),c.push(Fet({from:a.peer.id,error:u}))}return c};yield*qet(this._peerRouting.getClosestPeers(e.multihash.bytes,n),a=>Bet(a,c=>o(c)),a=>Net(a,{ordered:!1,concurrency:Uet}),async function*(a){for await(let c of a)yield*c}),this._log("sent provider records to %d peers",s)}async*findProviders(e,r={maxNumProviders:5}){let n=r.maxNumProviders||this._routingTable._kBucketSize,i=e.multihash.bytes,s=await Let(i),o=this;this._log(`findProviders ${e}`);let a=await this._providers.getProviders(e);if(a.length){let l=[];for(let f of a.slice(0,n))l.push({id:f,multiaddrs:(await this._peerStore.addressBook.get(f)||[]).map(h=>h.multiaddr)});yield Ket({from:this._peerId,messageType:jet.GET_PROVIDERS,providers:l}),yield ime({from:this._peerId,providers:l})}if(a.length>=n)return;let c=async function*({peer:l,signal:f}){let h=new dv(dv.TYPES.GET_PROVIDERS,i,0);yield*o._network.sendRequest(l,h,{signal:f})},u=new Set(a.map(l=>l.toB58String()));for await(let l of this._queryManager.run(i,this._routingTable.closestPeers(s),c,r))if(yield l,l.name==="PEER_RESPONSE"){this._log(`Found ${l.providers.length} provider entries for ${e} and ${l.closer.length} closer peers`);let f=[];for(let h of l.providers)u.has(h.id.toB58String())||(u.add(h.id.toB58String()),f.push(h));if(f.length&&(yield ime({from:l.from,providers:f})),u.size===n)return}}};ome.exports.ContentRouting=sme});var ume=g((lUt,cme)=>{"use strict";cme.exports=(t,e=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(e===0)return t;let n=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(n,r.indent.repeat(e))}});var lme=g(()=>{});var pme=g((dUt,dme)=>{"use strict";var fme=lme(),hme=/\s+at.*(?:\(|\s)(.*)\)?/,Vet=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,zet=typeof fme.homedir>"u"?"":fme.homedir();dme.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split(`
`).filter(r=>{let n=r.match(hme);if(n===null||!n[1])return!0;let i=n[1];return i.includes(".app/Contents/Resources/electron.asar")||i.includes(".app/Contents/Resources/default_app.asar")?!1:!Vet.test(i)}).filter(r=>r.trim()!=="").map(r=>e.pretty?r.replace(hme,(n,i)=>n.replace(i,i.replace(zet,"~"))):r).join(`
`))});var BO=g((pUt,gme)=>{"use strict";var Het=ume(),$et=pme(),Get=t=>t.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),yme=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(n=>n instanceof Error?n:n!==null&&typeof n=="object"?Object.assign(new Error(n.message),n):new Error(n));let r=e.map(n=>typeof n.stack=="string"?Get($et(n.stack)):String(n)).join(`
`);r=`
`+Het(r,4);super(r);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};gme.exports=yme});var wme=g((yUt,mme)=>{"use strict";var Wet=BO();mme.exports=async(t,e,{concurrency:r=1/0,stopOnError:n=!0}={})=>new Promise((i,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(r)||r===1/0)&&r>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${r}\` (${typeof r})`);let o=[],a=[],c=t[Symbol.iterator](),u=!1,l=!1,f=0,h=0,d=()=>{if(u)return;let p=c.next(),y=h;if(h++,p.done){l=!0,f===0&&(!n&&a.length!==0?s(new Wet(a)):i(o));return}f++,(async()=>{try{let b=await p.value;o[y]=await e(b,y),f--,d()}catch(b){n?(u=!0,s(b)):(a.push(b),f--,d())}})()};for(let p=0;p<r&&(d(),!l);p++);})});var Ame=g((gUt,Sme)=>{"use strict";var bme=qr(),Yet=wme(),{compare:_me}=(ub(),se(Fte)),{xor:vme}=(m3(),se(Y_)),Eme=class{constructor(e,r){this.originDhtKey=e,this.capacity=r,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(i=>i.peerId.equals(e)))return;let r=await bme.convertPeerId(e),n={peerId:e,distance:vme(this.originDhtKey,r)};this.peerDistances.push(n),this.peerDistances.sort((i,s)=>_me(i.distance,s.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(!e.length)return!1;if(!this.length)return!0;let r=await Yet(e,i=>bme.convertPeerId(i)),n=this.peerDistances[this.peerDistances.length-1].distance;for(let i of r){let s=vme(this.originDhtKey,i);if(_me(s,n)<0)return!0}return!1}};Sme.exports=Eme});var xme=g((mUt,Tme)=>{"use strict";var pv=oe(),{validator:Xet}=cc(),Qet=ft(),{toString:Zet}=(st(),se(hr)),{Message:gy}=Ca(),x3=qr(),{queryErrorEvent:Rme,finalPeerEvent:yv,valueEvent:Jet}=Dd(),ett=Ame(),{Record:ttt}=cc(),Ime=class{constructor({peerId:e,routingTable:r,peerStore:n,network:i,validators:s,queryManager:o,lan:a}){this._peerId=e,this._routingTable=r,this._peerStore=n,this._network=i,this._validators=s,this._queryManager=o,this._log=x3.logger(`libp2p:kad-dht:${a?"lan":"wan"}:peer-routing`)}async findPeerLocal(e){let r,n=await this._routingTable.find(e);if(n){this._log("findPeerLocal found %p in routing table",e);try{r=await this._peerStore.get(n)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i}}if(!r)try{r=await this._peerStore.get(e)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i}if(r)return this._log("findPeerLocal found %p in peer store",e),{id:r.id,multiaddrs:r.addresses.map(i=>i.multiaddr)}}async*_getValueSingle(e,r,n={}){let i=new gy(gy.TYPES.GET_VALUE,r,0);yield*this._network.sendRequest(e,i,n)}async*getPublicKeyFromNode(e,r){let n=x3.keyForPublicKey(e);for await(let i of this._getValueSingle(e,n,r))if(yield i,i.name==="PEER_RESPONSE"&&i.record){let s=await Qet.createFromPubKey(i.record.value);if(!s.equals(e))throw pv(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");yield Jet({from:e,value:s.pubKey.bytes})}throw pv(new Error(`Node not responding with its public key: ${e.toB58String()}`),"ERR_INVALID_RECORD")}async*findPeer(e,r={}){this._log("findPeer %p",e);let n=await this.findPeerLocal(e);if(n!=null){this._log("found local"),yield yv({from:this._peerId,peer:n});return}let i=await x3.convertPeerId(e),s=this._routingTable.closestPeers(i);if(s.find(l=>l.equals(e)))try{let l=await this._peerStore.get(e);this._log("found in peerStore"),yield yv({from:this._peerId,peer:{id:l.id,multiaddrs:l.addresses.map(f=>f.multiaddr)}});return}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}let a=this,c=async function*({peer:l,signal:f}){let h=new gy(gy.TYPES.FIND_NODE,e.toBytes(),0);for await(let d of a._network.sendRequest(l,h,{signal:f}))if(yield d,d.name==="PEER_RESPONSE"){let p=d.closer.find(y=>y.id.equals(e));p&&(yield yv({from:d.from,peer:p}))}},u=!1;for await(let l of this._queryManager.run(e.id,s,c,r))l.name==="FINAL_PEER"&&(u=!0),yield l;u||(yield Rme({from:this._peerId,error:pv(new Error("Not found"),"ERR_NOT_FOUND")}))}async*getClosestPeers(e,r={}){this._log("getClosestPeers to %b",e);let n=await x3.convertBuffer(e),i=this._routingTable.closestPeers(n),s=this,o=new ett(n,this._routingTable._kBucketSize);i.forEach(c=>o.add(c));let a=async function*({peer:c,signal:u}){s._log("closerPeersSingle %s from %p",Zet(e,"base32"),c);let l=new gy(gy.TYPES.FIND_NODE,e,0);yield*s._network.sendRequest(c,l,{signal:u})};for await(let c of this._queryManager.run(e,i,a,r))yield c,c.name==="PEER_RESPONSE"&&c.closer.forEach(u=>{o.add(u.id)});this._log("found %d peers close to %b",o.length,e);for(let c of o.peers)yield yv({from:this._peerId,peer:{id:c,multiaddrs:(await this._peerStore.addressBook.get(c)||[]).map(u=>u.multiaddr)}})}async*getValueOrPeers(e,r,n={}){for await(let i of this._getValueSingle(e,r,n)){if(i.name==="PEER_RESPONSE"&&i.record)try{await this._verifyRecordOnline(i.record)}catch{let o="invalid record received, discarded";this._log(o),yield Rme({from:i.from,error:pv(new Error(o),"ERR_INVALID_RECORD")});continue}yield i}}async _verifyRecordOnline({key:e,value:r,timeReceived:n}){await Xet.verifyRecord(this._validators,new ttt(e,r,n))}async getCloserPeersOffline(e,r){let n=await x3.convertBuffer(e),i=this._routingTable.closestPeers(n),s=[];for(let o of i)if(!o.equals(r))try{let a=await this._peerStore.addressBook.get(o);s.push({id:o,multiaddrs:a.map(c=>c.multiaddr)})}catch(a){if(a.code!=="ERR_NOT_FOUND")throw a}return s.length?this._log("getCloserPeersOffline found %d peer(s) closer to %b than %p",s.length,e,r):this._log("getCloserPeersOffline could not find peer closer to %b than %p",e,r),s}};Tme.exports.PeerRouting=Ime});var Bme=g((wUt,Nme)=>{"use strict";var rtt=qp(),Pme=ns(),ntt=ft(),{Key:itt}=(Vr(),se(Mp)),{default:stt}=ia(),{PROVIDERS_CLEANUP_INTERVAL:ott,PROVIDERS_VALIDITY:att,PROVIDERS_LRU_CACHE_SIZE:ctt,PROVIDER_KEY_PREFIX:Cme}=Uc(),utt=qr(),{toString:ltt}=(st(),se(hr)),Df=utt.logger("libp2p:kad-dht:providers"),Ome=class{constructor({providers:e,cacheSize:r,cleanupInterval:n,provideValidity:i}){this.datastore=e,this.cleanupInterval=n||ott,this.provideValidity=i||att,this.cache=rtt(r||ctt),this.syncQueue=new stt({concurrency:1})}start(){this._started||(this._started=!0,this._cleaner=setInterval(()=>this._cleanup(),this.cleanupInterval))}stop(){this._started=!1,this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add(async()=>{let e=Date.now(),r=0,n=0,i=new Map,s=this.datastore.batch(),o=this.datastore.query({prefix:Cme});for await(let a of o)try{let{cid:c,peerId:u}=kme(a.key),l=Dme(a.value),f=Date.now(),h=f-l,d=h>this.provideValidity;if(Df("comparing: %d - %d = %d > %d %s",f,l,h,this.provideValidity,d?"(expired)":""),d){n++,s.delete(a.key);let p=i.get(c)||new Set;p.add(u),i.set(c,p)}r++}catch(c){Df.error(c.message)}i.size?(Df("deleting %d / %d entries",n,r),await s.commit()):Df("nothing to delete");for(let[a,c]of i){let u=P3(a),l=this.cache.get(u);if(l){for(let f of c)l.delete(f);l.size===0?this.cache.remove(u):this.cache.set(u,l)}}Df("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let r=P3(e),n=this.cache.get(r);return n||(n=await htt(this.datastore,e),this.cache.set(r,n)),n}async addProvider(e,r){return this.syncQueue.add(async()=>{Df("%p provides %s",r,e);let n=await this._getProvidersMap(e);Df("loaded %s provs",n.size);let i=new Date;n.set(r.toString(),i);let s=P3(e);return this.cache.set(s,n),ftt(this.datastore,e,r,i)})}async getProviders(e){return this.syncQueue.add(async()=>(Df("get providers for %s",e),[...(await this._getProvidersMap(e)).keys()].map(n=>ntt.parse(n))))}};function P3(t){return t=typeof t=="string"?t:ltt(t.multihash.bytes,"base32"),`${Cme}/${t}`}async function ftt(t,e,r,n){let i=[P3(e),"/",r.toString()].join(""),s=new itt(i),o=Uint8Array.from(Pme.encode(n.getTime()));return t.put(s,o)}function kme(t){let e=t.toString().split("/");if(e.length!==5)throw new Error("incorrectly formatted provider entry key in datastore: "+t);return{cid:e[3],peerId:e[4]}}async function htt(t,e){let r=new Map,n=t.query({prefix:P3(e)});for await(let i of n){let{peerId:s}=kme(i.key);r.set(s,Dme(i.value))}return r}function Dme(t){return Pme.decode(t)}Nme.exports.Providers=Ome});var Kme=g((bUt,Fme)=>{"use strict";var{default:dtt}=ia(),{xor:Lme}=(m3(),se(Y_)),{toString:Mme}=(st(),se(hr)),Ume=uc(),ptt=oe(),{convertPeerId:qme,convertBuffer:ytt}=qr(),{TimeoutController:gtt}=za(),{anySignal:mtt}=na(),{queryErrorEvent:wtt}=Dd(),btt=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");Fme.exports.queryPath=async function*({key:e,startingPeer:r,ourPeerId:n,signal:i,query:s,alpha:o,pathIndex:a,numPaths:c,cleanUp:u,queryFuncTimeout:l,log:f}){let h=new dtt({concurrency:o}),d=await ytt(e),p=new Set;function y(b,m){if(!b)return;p.add(b.toB58String());let _=BigInt("0x"+Mme(Lme(m,d),"base16"));h.add(async()=>{let R,k=[i];l!=null&&(R=new gtt(l),k.push(R.signal));let P=mtt(k);try{for await(let x of s({key:e,peer:b,signal:P,pathIndex:a,numPaths:c})){if(P.aborted)return;if(x.name==="PEER_RESPONSE")for(let D of x.closer){if(p.has(D.id.toB58String())){f("already seen %p in query",D.id);continue}if(n.equals(D.id)){f("not querying ourselves");continue}let U=await qme(D.id);if(BigInt("0x"+Mme(Lme(U,d),"base16"))>_){f("skipping %p as they are not closer to %b than %p",D.id,e,b);continue}f("querying closer peer %p",D.id),y(D.id,U)}h.emit("completed",x)}R&&R.clear()}catch(x){i.aborted?h.emit("error",x):h.emit("completed",wtt({from:b,error:x}))}finally{R&&R.clear()}},{priority:btt-_})}y(r,await qme(r)),yield*_tt(h,i,u,f)};async function*_tt(t,e,r,n){let i=Ume(),s=!0,o=[],a=()=>{!s||(n("clean up queue, results %d, queue size %d, pending tasks %d",o.length,t.size,t.pending),s=!1,t.clear(),o.splice(0,o.length))};for(t.on("completed",c=>{o.push(c),i.resolve()}),t.on("error",c=>{n("queue error",c),a(),i.reject(c)}),t.on("idle",()=>{n("queue idle"),s=!1,i.resolve()}),e.addEventListener("abort",()=>{n("abort queue");let c=s;a(),c&&i.reject(ptt(new Error("Query aborted"),"ERR_QUERY_ABORTED"))}),r.on("cleanup",()=>{a(),i.resolve()});s;)for(await i.promise,i=Ume();o.length;){let c=o.shift();c&&(yield c)}yield*o}});var Wme=g((_Ut,Gme)=>{"use strict";var{TimeoutController:vtt}=za(),{anySignal:Ett}=na(),{ALPHA:jme,K:Vme,DEFAULT_QUERY_TIMEOUT:Stt}=Uc(),{toString:Att}=(st(),se(hr)),{logger:Rtt}=qr(),{queryPath:Itt}=Kme(),Ttt=Dl(),{EventEmitter:xtt,setMaxListeners:zme}=Gt(),Hme="running-queries",$me=class{constructor({peerId:e,lan:r,metrics:n,disjointPaths:i=Vme,alpha:s=jme}){this._peerId=e,this._disjointPaths=i||Vme,this._controllers=new Set,this._running=!1,this._alpha=s||jme,this._lan=r,this._metrics=n,this._queries=0}start(){this._running=!0}stop(){this._running=!1;for(let e of this._controllers)e.abort();this._controllers.clear()}async*run(e,r,n,i={}){if(!this._running)throw new Error("QueryManager not started");let s;i.signal||(s=new vtt(Stt),i.signal=s.signal);let o=new AbortController;this._controllers.add(o);let a=[o.signal];i.signal&&a.push(i.signal);let c=Ett(a);try{zme&&zme(0,c)}catch{}let u=Rtt(`libp2p:kad-dht:${this._lan?"lan":"wan"}:query:`+Att(e,"base58btc")),l=r.slice(0,Math.min(this._disjointPaths,r.length)),f=Date.now(),h=new xtt;try{if(u("query:start"),this._queries++,this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:Hme,value:this._queries}),r.length===0){u.error("Running query with no peers");return}let d=l.map((p,y)=>Itt({key:e,startingPeer:p,ourPeerId:this._peerId,signal:c,query:n,pathIndex:y,numPaths:l.length,alpha:this._alpha,cleanUp:h,queryFuncTimeout:i.queryFuncTimeout,log:u}));for await(let p of Ttt(...d))yield p,p.name==="QUERY_ERROR"&&p.error&&u("error",p.error)}catch(d){if(!(!this._running&&d.code==="ERR_QUERY_ABORTED"))throw d}finally{this._controllers.delete(o),s&&s.clear(),this._queries--,this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:Hme,value:this._queries}),h.emit("cleanup"),u(`query:done in ${Date.now()-(f||0)}ms`)}}};Gme.exports.QueryManager=$me});var Zme=g((vUt,Qme)=>{"use strict";var{CID:Ptt}=(Se(),se(Yc)),Yme=oe(),Ctt=qr(),C3=Ctt.logger("libp2p:kad-dht:rpc:handlers:add-provider"),Xme=class{constructor({peerId:e,providers:r,peerStore:n}){this._peerId=e,this._providers=r,this._peerStore=n}async handle(e,r){if(C3("start"),!r.key||r.key.length===0)throw Yme(new Error("Missing key"),"ERR_MISSING_KEY");let n;try{n=Ptt.decode(r.key)}catch(i){let s=`Invalid CID: ${i.message}`;throw Yme(new Error(s),"ERR_INVALID_CID")}(!r.providerPeers||!r.providerPeers.length)&&C3.error("no providers found in message"),await Promise.all(r.providerPeers.map(async i=>{if(!i.id.equals(e)){C3("invalid provider peer %p from %p",i.id,e);return}if(i.multiaddrs.length<1){C3("no valid addresses for provider %p. Ignore",e);return}C3("received provider %p for %s (addrs %s)",e,n,i.multiaddrs.map(s=>s.toString())),this._peerId.equals(i.id)||(await this._peerStore.addressBook.add(i.id,i.multiaddrs),await this._providers.addProvider(n,i.id))}))}};Qme.exports.AddProviderHandler=Xme});var r3e=g((EUt,t3e)=>{"use strict";var{Message:Ott}=Ca(),ktt=qr(),Jme=ktt.logger("libp2p:kad-dht:rpc:handlers:find-node"),{removePrivateAddresses:Dtt,removePublicAddresses:Ntt}=qr(),e3e=class{constructor({peerId:e,addressable:r,peerRouting:n,lan:i}){this._peerId=e,this._addressable=r,this._peerRouting=n,this._lan=Boolean(i)}async handle(e,r){Jme("incoming request from %p for peers closer to %b",e,r.key);let n;this._peerId.equals(r.key)?n=[{id:this._peerId,multiaddrs:this._addressable.multiaddrs}]:n=await this._peerRouting.getCloserPeersOffline(r.key,e),n=n.map(this._lan?Ntt:Dtt).filter(({multiaddrs:s})=>s.length);let i=new Ott(r.type,new Uint8Array(0),r.clusterLevel);return n.length>0?i.closerPeers=n:Jme("could not find any peers closer to %p",e),i}};t3e.exports.FindNodeHandler=e3e});var o3e=g((SUt,s3e)=>{"use strict";var{CID:Btt}=(Se(),se(Yc)),Ltt=oe(),{Message:Mtt}=Ca(),Utt=qr(),n3e=Utt.logger("libp2p:kad-dht:rpc:handlers:get-providers"),{removePrivateAddresses:qtt,removePublicAddresses:Ftt}=qr(),i3e=class{constructor({peerId:e,peerRouting:r,providers:n,peerStore:i,addressable:s,lan:o}){this._peerId=e,this._peerRouting=r,this._providers=n,this._peerStore=i,this._addressable=s,this._lan=Boolean(o)}async handle(e,r){let n;try{n=Btt.decode(r.key)}catch(u){throw Ltt(new Error(`Invalid CID: ${u.message}`),"ERR_INVALID_CID")}n3e("%p asking for providers for %s",e,n);let[i,s]=await Promise.all([this._providers.getProviders(n),this._peerRouting.getCloserPeersOffline(r.key,e)]),o=await this._getPeers(i),a=await this._getPeers(s.map(({id:u})=>u)),c=new Mtt(r.type,r.key,r.clusterLevel);return o.length>0&&(c.providerPeers=o),a.length>0&&(c.closerPeers=a),n3e("got %s providers %s closerPeers",o.length,a.length),c}async _getAddresses(e){return this._peerId.equals(e)?this._addressable.multiaddrs:(await this._peerStore.addressBook.get(e)||[]).map(r=>r.multiaddr)}async _getPeers(e){let r=[],n=this._lan?Ftt:qtt;for(let i of e){let s=n({id:i,multiaddrs:await this._getAddresses(i)});s.multiaddrs.length&&r.push(s)}return r}};s3e.exports.GetProvidersHandler=i3e});var h3e=g((AUt,f3e)=>{"use strict";var{Record:a3e}=cc(),c3e=oe(),{Message:u3e}=Ca(),{MAX_RECORD_AGE:Ktt}=Uc(),gv=qr(),my=gv.logger("libp2p:kad-dht:rpc:handlers:get-value"),l3e=class{constructor({peerId:e,peerStore:r,peerRouting:n,records:i}){this._peerId=e,this._peerStore=r,this._peerRouting=n,this._records=i}async handle(e,r){let n=r.key;if(my("%p asked for key %b",e,n),!n||n.length===0)throw c3e(new Error("Invalid key"),"ERR_INVALID_KEY");let i=new u3e(u3e.TYPES.GET_VALUE,n,r.clusterLevel);if(gv.isPublicKeyKey(n)){my("is public key");let a=gv.fromPublicKeyKey(n),c;if(this._peerId.equals(a))c=this._peerId.pubKey;else try{c=await this._peerStore.keyBook.get(a)}catch(u){if(u.code!=="ERR_NOT_FOUND")throw u}if(c!=null)return my("returning found public key"),i.record=new a3e(n,c.bytes),i}let[s,o]=await Promise.all([this._checkLocalDatastore(n),this._peerRouting.getCloserPeersOffline(r.key,e)]);return s&&(my("had record for %b in local datastore",n),i.record=s),o.length>0&&(my("had %s closer peers in routing table",o.length),i.closerPeers=o),i}async _checkLocalDatastore(e){my("checkLocalDatastore looking for %b",e);let r=gv.bufferToKey(e),n;try{n=await this._records.get(r)}catch(s){if(s.code==="ERR_NOT_FOUND")return;throw s}let i=a3e.deserialize(n);if(!i)throw c3e(new Error("Invalid record"),"ERR_INVALID_RECORD");if(i.timeReceived==null||Date.now()-i.timeReceived.getTime()>Ktt){await this._records.delete(r);return}return i}};f3e.exports.GetValueHandler=l3e});var y3e=g((RUt,p3e)=>{"use strict";var jtt=qr(),Vtt=jtt.logger("libp2p:kad-dht:rpc:handlers:ping"),d3e=class{async handle(e,r){return Vtt(`ping from ${e}`),r}};p3e.exports.PingHandler=d3e});var _3e=g((IUt,b3e)=>{"use strict";var m3e=qr(),ztt=oe(),Htt=cc(),g3e=m3e.logger("libp2p:kad-dht:rpc:handlers:put-value"),w3e=class{constructor({validators:e,records:r}){this._validators=e,this._records=r}async handle(e,r){let n=r.key;g3e("%p asked to store value for key %b",e,n);let i=r.record;if(!i){let o=`Empty record from: ${e.toB58String()}`;throw g3e.error(o),ztt(new Error(o),"ERR_EMPTY_RECORD")}await Htt.validator.verifyRecord(this._validators,i),i.timeReceived=new Date;let s=m3e.bufferToKey(i.key);return await this._records.put(s,i.serialize()),r}};b3e.exports.PutValueHandler=w3e});var E3e=g((TUt,v3e)=>{"use strict";var{Message:wy}=Ca(),{AddProviderHandler:$tt}=Zme(),{FindNodeHandler:Gtt}=r3e(),{GetProvidersHandler:Wtt}=o3e(),{GetValueHandler:Ytt}=h3e(),{PingHandler:Xtt}=y3e(),{PutValueHandler:Qtt}=_3e();v3e.exports=({peerId:t,providers:e,peerStore:r,addressable:n,peerRouting:i,records:s,validators:o,lan:a})=>{let c={[wy.TYPES.GET_VALUE]:new Ytt({peerId:t,peerStore:r,peerRouting:i,records:s}),[wy.TYPES.PUT_VALUE]:new Qtt({validators:o,records:s}),[wy.TYPES.FIND_NODE]:new Gtt({peerId:t,addressable:n,peerRouting:i,lan:a}),[wy.TYPES.ADD_PROVIDER]:new $tt({peerId:t,providers:e,peerStore:r}),[wy.TYPES.GET_PROVIDERS]:new Wtt({peerId:t,peerRouting:i,providers:e,peerStore:r,addressable:n,lan:a}),[wy.TYPES.PING]:new Xtt};function u(l){return c[l]}return u}});var I3e=g((xUt,R3e)=>{"use strict";var{pipe:Ztt}=br(),S3e=xo(),{Message:Jtt,MESSAGE_TYPE_LOOKUP:ert}=Ca(),trt=E3e(),rrt=qr(),mv=rrt.logger("libp2p:kad-dht:rpc"),A3e=class{constructor(e){this._messageHandler=trt(e),this._routingTable=e.routingTable}async handleMessage(e,r){let n=this._messageHandler(r.type);try{await this._routingTable.add(e)}catch(i){mv.error("Failed to update the kbucket store",i)}if(!n){mv.error(`no handler found for message type: ${r.type}`);return}return n.handle(e,r)}async onIncomingStream({stream:e,connection:r}){let n=r.remotePeer;try{await this._routingTable.add(n)}catch(s){mv.error(s)}let i=this;await Ztt(e.source,S3e.decode(),s=>async function*(){for await(let o of s){let a=Jtt.deserialize(o.slice());mv("incoming %s from %p",ert[a.type],n);let c=await i.handleMessage(n,a);c&&(yield c.serialize())}}(),S3e.encode(),e.sink)}};R3e.exports.RPC=A3e});var P3e=g((PUt,x3e)=>{"use strict";var nrt=v8(),{EventEmitter:irt}=Gt(),srt=qr(),T3e=class extends irt{constructor({registrar:e,protocol:r,lan:n}){super();this._log=srt.logger(`libp2p:kad-dht:topology-listener:${n?"lan":"wan"}:network`),this._running=!1,this._registrar=e,this._protocol=r}async start(){if(this._running)return;this._running=!0;let e=new nrt({multicodecs:[this._protocol],handlers:{onConnect:r=>{this._log("observed peer that with protocol %s %p",this._protocol,r),this.emit("peer",r)},onDisconnect:()=>{}}});this._registrarId=await this._registrar.register(e)}stop(){this._running=!1,this._registrarId&&this._registrar.unregister(this._registrarId)}};x3e.exports.TopologyListener=T3e});var L3e=g((CUt,B3e)=>{"use strict";var{EventEmitter:ort}=Gt(),art=_h(),crt=im(),{QUERY_SELF_INTERVAL:C3e,QUERY_SELF_TIMEOUT:O3e,K:k3e}=Uc(),urt=qr(),{TimeoutController:lrt}=za(),{anySignal:frt}=na(),{setMaxListeners:D3e}=Gt(),N3e=class extends ort{constructor({peerId:e,peerRouting:r,lan:n,count:i=k3e,interval:s=C3e,queryTimeout:o=O3e}){super();this._log=urt.logger(`libp2p:kad-dht:${n?"lan":"wan"}:query-self`),this._running=!1,this._peerId=e,this._peerRouting=r,this._count=i||k3e,this._interval=s||C3e,this._queryTimeout=o||O3e}start(){this._running||(this._running=!0,this._querySelf())}stop(){this._running=!1,this._timeoutId&&clearTimeout(this._timeoutId),this._controller&&this._controller.abort()}async _querySelf(){let e=new lrt(this._queryTimeout);try{this._controller=new AbortController;let r=frt([this._controller.signal,e.signal]);try{D3e&&D3e(1/0,r)}catch{}let n=await crt(await art(this._peerRouting.getClosestPeers(this._peerId.toBytes(),{signal:r}),this._count));this._log("query ran successfully - found %d peers",n)}catch(r){this._log("query error",r)}finally{this._timeoutId=setTimeout(this._querySelf.bind(this),this._interval),e.clear()}}};B3e.exports.QuerySelf=N3e});var z3e=g((OUt,V3e)=>{"use strict";var{EventEmitter:hrt}=Gt(),M3e=oc(),U3e=cc(),{MemoryDatastore:drt}=(b5(),se(YS)),{RoutingTable:prt}=Nge(),{RoutingTableRefresh:yrt}=Uge(),q3e=qr(),{K:grt,QUERY_SELF_INTERVAL:mrt,RECORD_KEY_PREFIX:wrt}=Uc(),{Network:brt}=Zge(),{ContentFetching:_rt}=nme(),{ContentRouting:vrt}=ame(),{PeerRouting:Ert}=xme(),{Providers:Srt}=Bme(),{QueryManager:Art}=Wme(),{RPC:Rrt}=I3e(),{TopologyListener:Irt}=P3e(),{QuerySelf:Trt}=L3e(),{removePrivateAddresses:xrt,removePublicAddresses:Prt}=qr(),{KeyTransformDatastore:Crt}=(S5(),se(kz)),{Key:F3e}=(Vr(),se(Mp)),K3e=class{constructor(e){this._prefix=e,this._prefix.startsWith("/")&&(this._prefix=this._prefix.substring(1))}convert(e){return new F3e(`/${this._prefix}${e}`)}invert(e){let r=e.namespaces();return r[0]===this._prefix&&r.shift(),F3e.withNamespaces(r)}},j3e=class extends hrt{constructor({libp2p:e,kBucketSize:r=grt,clientMode:n=!0,validators:i={},selectors:s={},querySelfInterval:o=mrt,lan:a=!0,protocol:c="/ipfs/lan/kad/1.0.0",bootstrapPeers:u=[]}){super();this._running=!1,this._log=q3e.logger(`libp2p:kad-dht:${a?"lan":"wan"}`),this._libp2p=e,this._protocol=c,this._kBucketSize=r,this._clientMode=n,this._bootstrapPeers=u,this._routingTable=new prt({peerId:e.peerId,dialer:e,kBucketSize:r,metrics:e.metrics,lan:a});let l=e.datastore||new drt,f=new Crt(l,new K3e(wrt));this._providers=new Srt({providers:l}),this._lan=a,this._validators={pk:U3e.validator.validators.pk,...i},this._selectors={pk:U3e.selection.selectors.pk,...s},this._network=new brt({dialer:e,protocol:this._protocol,lan:a}),this._queryManager=new Art({peerId:e.peerId,disjointPaths:Math.ceil(r/2),metrics:e.metrics,lan:a}),this._peerRouting=new Ert({peerId:e.peerId,routingTable:this._routingTable,peerStore:e.peerStore,network:this._network,validators:this._validators,queryManager:this._queryManager,lan:a}),this._contentFetching=new _rt({peerId:e.peerId,records:f,validators:this._validators,selectors:this._selectors,peerRouting:this._peerRouting,queryManager:this._queryManager,routingTable:this._routingTable,network:this._network,lan:a}),this._contentRouting=new vrt({peerId:e.peerId,network:this._network,peerRouting:this._peerRouting,queryManager:this._queryManager,routingTable:this._routingTable,providers:this._providers,peerStore:e.peerStore,lan:a}),this._routingTableRefresh=new yrt({peerRouting:this._peerRouting,routingTable:this._routingTable,lan:a}),this._rpc=new Rrt({routingTable:this._routingTable,peerId:e.peerId,providers:this._providers,peerStore:e.peerStore,addressable:e,peerRouting:this._peerRouting,records:f,validators:this._validators,lan:a}),this._topologyListener=new Irt({registrar:e.registrar,protocol:this._protocol,lan:a}),this._querySelf=new Trt({peerId:e.peerId,peerRouting:this._peerRouting,interval:o,lan:a}),this._network.on("peer",h=>{this.onPeerConnect(h).catch(d=>{this._log.error(`could not add ${h.id} to routing table`,d)}),this.emit("peer",h)}),this._topologyListener.on("peer",async h=>{let d=await this._libp2p.peerStore.addressBook.get(h),p={id:h,multiaddrs:d.map(y=>y.multiaddr)};this.onPeerConnect(p).catch(y=>{this._log.error(`could not add ${p.id} to routing table`,y)})})}async onPeerConnect(e){if(this._log("peer %p connected",e.id),this._lan?e=Prt(e):e=xrt(e),!e.multiaddrs.length){this._log("ignoring %p as they do not have any %s addresses in %s",e.id,this._lan?"private":"public",e.multiaddrs.map(r=>r.toString()));return}try{await this._routingTable.add(e.id)}catch(r){this._log.error("could not add %p to routing table",e.id,r)}}isStarted(){return this._running}isServer(){return!this._clientMode}async enableServerMode(){this._log("enabling server mode"),this._clientMode=!1,await this._libp2p.handle(this._protocol,this._rpc.onIncomingStream.bind(this._rpc))}async enableClientMode(){this._log("enabling client mode"),this._clientMode=!0,await this._libp2p.unhandle(this._protocol)}async start(){this._running=!0,this._clientMode?await this.enableClientMode():await this.enableServerMode(),await Promise.all([this._providers.start(),this._queryManager.start(),this._network.start(),this._routingTable.start(),this._topologyListener.start(),this._querySelf.start()]),await Promise.all(this._bootstrapPeers.map(e=>this._routingTable.add(e.id))),await this._routingTableRefresh.start(),await this.refreshRoutingTable()}async stop(){this._running=!1,await Promise.all([this._providers.stop(),this._queryManager.stop(),this._network.stop(),this._routingTable.stop(),this._routingTableRefresh.stop(),this._topologyListener.stop(),this._querySelf.stop()])}async*put(e,r,n={}){yield*this._contentFetching.put(e,r,n)}async*get(e,r={}){yield*this._contentFetching.get(e,r)}async*provide(e,r={}){yield*this._contentRouting.provide(e,this._libp2p.multiaddrs,r)}async*findProviders(e,r={maxNumProviders:5}){yield*this._contentRouting.findProviders(e,r)}async*findPeer(e,r={}){yield*this._peerRouting.findPeer(e,r)}async*getClosestPeers(e,r={}){yield*this._peerRouting.getClosestPeers(e,r)}async getPublicKey(e,r={}){this._log("getPublicKey %p",e);for await(let i of this._peerRouting.getPublicKeyFromNode(e,r))if(i.name==="VALUE")return M3e.keys.unmarshalPublicKey(i.value);let n=q3e.keyForPublicKey(e);for await(let i of this.get(n,r))if(i.name==="VALUE")return M3e.keys.unmarshalPublicKey(i.value)}async refreshRoutingTable(){await this._routingTableRefresh.refreshTable(!0)}};V3e.exports={KadDHT:j3e}});var G3e=g((kUt,$3e)=>{"use strict";var{EventEmitter:Ort}=Gt(),krt=ft(),Drt=qr(),Nf=oe(),by=Dl(),{queryErrorEvent:Nrt}=Dd(),O3=Drt.logger("libp2p:kad-dht"),H3e=class extends Ort{constructor(e,r,n){super();this._wan=e,this._lan=r,this._libp2p=n,this._wan.on("peer",i=>{this.emit("peer",i)}),this._lan.on("peer",i=>{this.emit("peer",i)})}isStarted(){return this._wan.isStarted()&&this._lan.isStarted()}async enableServerMode(){await this._wan.enableServerMode()}async enableClientMode(){await this._wan.enableClientMode()}async start(){await Promise.all([this._lan.start(),this._wan.start()])}async stop(){await Promise.all([this._lan.stop(),this._wan.stop()])}async*put(e,r,n={}){let i=0,s=0;for await(let a of by(this._lan.put(e,r,n),this._wan.put(e,r,n)))yield a,a.name==="SENDING_QUERY"&&a.messageName==="PUT_VALUE"&&i++,a.name==="PEER_RESPONSE"&&a.messageName==="PUT_VALUE"&&s++;let o=n.minPeers==null?i||1:n.minPeers;if(s<o){let a=Nf(new Error(`Failed to put value to enough peers: ${s}/${o}`),"ERR_NOT_ENOUGH_PUT_PEERS");throw O3.error(a),a}}async*get(e,r={}){let n=!1,i=!1;for await(let s of by(this._lan.get(e,r),this._wan.get(e,r)))yield s,s.name==="DIALING_PEER"&&(n=!0),s.name==="VALUE"&&(n=!0,s.value!=null&&(i=!0)),s.name==="SENDING_QUERY"&&(n=!0);if(!n)throw Nf(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");i||(yield Nrt({from:this._libp2p.peerId,error:Nf(new Error("Not found"),"ERR_NOT_FOUND")}))}async*provide(e,r={}){let n=0,i=0,s=[],o=[this._lan];this._wan.isServer()&&o.push(this._wan);for await(let a of by(...o.map(c=>c.provide(e,r))))yield a,a.name==="SENDING_QUERY"&&n++,a.name==="QUERY_ERROR"&&s.push(a.error),a.name==="PEER_RESPONSE"&&a.messageName==="ADD_PROVIDER"&&(O3("sent provider record for %s to %p",e,a.from.id),i++);if(i===0)throw s.length?Nf(new Error(`Failed to provide to ${s.length} of ${n} peers`),"ERR_PROVIDES_FAILED",{errors:s}):Nf(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}async*findProviders(e,r={maxNumProviders:5}){yield*by(this._lan.findProviders(e,r),this._wan.findProviders(e,r))}async*findPeer(e,r={}){let n=!1;for await(let i of by(this._lan.findPeer(e,r),this._wan.findPeer(e,r)))yield i,(i.name==="SENDING_QUERY"||i.name==="FINAL_PEER")&&(n=!0);if(!n)throw Nf(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async*getClosestPeers(e,r={}){yield*by(this._lan.getClosestPeers(e,r),this._wan.getClosestPeers(e,r))}async getPublicKey(e,r={}){O3("getPublicKey %p",e);let n;try{if(n=await this._libp2p.peerStore.get(e),n.pubKey)return O3("getPublicKey: found local copy"),n.pubKey;if(n.id.pubKey)return O3("getPublicKey: found local copy"),n.id.pubKey}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}let i=await Promise.all([this._lan.getPublicKey(e,r),this._wan.getPublicKey(e,r)]);if(i[0]&&i[1]&&!i[0].equals(i[1]))throw Nf(new Error("Inconsistent public key loaded from wan and lan DHTs"),"ERR_FAILED_TO_LOAD_KEY");let s=i[0]||i[1];if(!s)throw Nf(new Error("Failed to load public key"),"ERR_FAILED_TO_LOAD_KEY");let o=new krt(e.id,void 0,s),a=(n&&n.addresses||[]).map(c=>c.multiaddr);return await this._libp2p.peerStore.addressBook.add(o,a),await this._libp2p.peerStore.keyBook.set(o,s),s}async refreshRoutingTable(){await Promise.all([this._lan.refreshRoutingTable(),this._wan.refreshRoutingTable()])}};$3e.exports={DualKadDHT:H3e}});var X3e=g((DUt,Y3e)=>{"use strict";var{KadDHT:W3e}=z3e(),{DualKadDHT:Brt}=G3e();Y3e.exports={create:t=>new Brt(new W3e({...t,protocol:"/ipfs/kad/1.0.0",lan:!1}),new W3e({...t,protocol:"/ipfs/lan/kad/1.0.0",clientMode:!1,lan:!0}),t.libp2p)}});function Z3e(t,e){return mh.select(e[0],e[1])}var Q3e,J3e=w(()=>{wh();Q3e={func:(t,e)=>mh.validate(e,t)}});function o4e(){return{dialer:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4},modules:{transport:[e4e.default,t4e.default],streamMuxer:[r4e.default],connEncryption:[n4e.NOISE],peerDiscovery:[],dht:i4e.default,pubsub:s4e.default},config:{peerDiscovery:{autoDial:!0,bootstrap:{enabled:!0},webRTCStar:{enabled:!0}},dht:{kBucketSize:20,enabled:!0,clientMode:!0,validators:{ipns:Q3e},selectors:{ipns:Z3e}},pubsub:{enabled:!0,emitSelf:!0},nat:{enabled:!1}},metrics:{enabled:!0},peerStore:{persistence:!0}}}var e4e,t4e,r4e,n4e,i4e,s4e,a4e=w(()=>{e4e=A(e1e(),1),t4e=A(Oye(),1),r4e=A(Yye(),1),n4e=A(mge(),1),i4e=A(X3e(),1),s4e=A(OP(),1);J3e()});var f4e=g((LO,l4e)=>{"use strict";var Lrt=ft(),{Multiaddr:Mrt}=yt(),Urt=eh(),{EventEmitter:qrt}=Gt(),c4e=he(),wv=Object.assign(c4e("libp2p:bootstrap"),{error:c4e("libp2p:bootstrap:error")}),u4e=class extends qrt{constructor(e={list:[]}){if(!e.list||!e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super();this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(){this._timer||(this._timer=setInterval(()=>this._discoverBootstrapPeers(),this._interval),wv("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){!this._timer||this._list.forEach(e=>{if(!Urt.P2P.matches(e))return wv.error("Invalid multiaddr");let r=new Mrt(e),n=r.getPeerId();if(!n){wv.error("Invalid bootstrap multiaddr without peer id");return}let i=Lrt.createFromB58String(n);try{this.emit("peer",{id:i,multiaddrs:[r]})}catch(s){wv.error("Invalid bootstrap peer id",s)}})}stop(){this._timer&&clearInterval(this._timer),this._timer=null}};LO=l4e.exports=u4e;LO.tag="bootstrap"});var MO=g((MUt,h4e)=>{"use strict";var Frt=oe(),Krt=fs(),jrt=xi(),Vrt=_h();async function*zrt(t,e){yield*jrt(t,async r=>(await e.addressBook.add(r.id,r.multiaddrs),r))}function Hrt(t){let e=new Set;return Krt(t,r=>e.has(r.id.toString())?!1:(e.add(r.id.toString()),!0))}async function*$rt(t,e=1){let r=0;for await(let n of t)r++,yield n;if(r<e)throw Frt(new Error("not found"),"NOT_FOUND")}function Grt(t,e){return e?Vrt(t,e):t}h4e.exports={storeAddresses:zrt,uniquePeers:Hrt,requirePeers:$rt,maybeLimitSource:Grt}});var UO=g((UUt,d4e)=>{"use strict";var _y=new Map,Wrt=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function Yrt(t,e,r){for(;_y.get(r);){try{await t()}catch(n){setTimeout(()=>{throw n},1);break}if(!_y.get(r))break;await new Promise(n=>{let i=setTimeout(n,e);_y.set(r,i)})}}function Xrt(t,e,r){r=r||e;let n=Wrt(),i=setTimeout(()=>{Yrt(t,e,n)},r);return _y.set(n,i),n}function Qrt(t){let e=_y.get(t);e&&(clearTimeout(e),_y.delete(t))}d4e.exports={setDelayedInterval:Xrt,clearDelayedInterval:Qrt}});var g4e=g((qUt,y4e)=>{"use strict";var Zrt=oe(),{messages:Jrt,codes:ent}=Rr(),p4e=class{constructor(e){this._dht=e}async findPeer(e,r={}){for await(let n of this._dht.findPeer(e,r))if(n.name==="FINAL_PEER")return n.peer;throw Zrt(new Error(Jrt.NOT_FOUND),ent.ERR_NOT_FOUND)}async*getClosestPeers(e,r={}){for await(let n of this._dht.getClosestPeers(e,r))n.name==="PEER_RESPONSE"&&(yield*n.closer)}};y4e.exports={DHTPeerRouting:p4e}});var R4e=g((FUt,A4e)=>{"use strict";var m4e=he(),w4e=Object.assign(m4e("libp2p:peer-routing"),{error:m4e("libp2p:peer-routing:err")}),bv=oe(),k3=Rr(),{storeAddresses:b4e,uniquePeers:tnt,requirePeers:rnt}=MO(),{TimeoutController:nnt}=za(),_4e=Dl(),{pipe:v4e}=br(),int=qh(),snt=ls(),ont=fs(),{setDelayedInterval:ant,clearDelayedInterval:cnt}=UO(),{DHTPeerRouting:unt}=g4e(),{setMaxListeners:E4e}=Gt(),S4e=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(new unt(e._dht)),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=ant(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await snt(this.getClosestPeers(this._peerId.id,{timeout:this._refreshManagerOptions.timeout||1e4}))}catch(e){w4e.error(e)}}stop(){cnt(this._timeoutId)}async findPeer(e,r){if(!this._routers.length)throw bv(new Error("No peer routers available"),k3.codes.ERR_NO_ROUTERS_AVAILABLE);if(e.toB58String()===this._peerId.toB58String())throw bv(new Error("Should not try to find self"),k3.codes.ERR_FIND_SELF);let n=await v4e(_4e(...this._routers.map(i=>async function*(){try{yield await i.findPeer(e,r)}catch(s){w4e.error(s)}}())),i=>ont(i,Boolean),i=>b4e(i,this._peerStore),i=>int(i));if(n)return n;throw bv(new Error(k3.messages.NOT_FOUND),k3.codes.ERR_NOT_FOUND)}async*getClosestPeers(e,r={timeout:3e4}){if(!this._routers.length)throw bv(new Error("No peer routers available"),k3.codes.ERR_NO_ROUTERS_AVAILABLE);if(r.timeout){let n=new nnt(r.timeout);try{E4e&&E4e(1/0,n.signal)}catch{}r.signal=n.signal}yield*v4e(_4e(...this._routers.map(n=>n.getClosestPeers(e,r))),n=>b4e(n,this._peerStore),n=>tnt(n),n=>rnt(n))}};A4e.exports=S4e});var x4e=g((KUt,T4e)=>{"use strict";var lnt=ls(),I4e=class{constructor(e){this._dht=e}async provide(e){await lnt(this._dht.provide(e))}async*findProviders(e,r){for await(let n of this._dht.findProviders(e,r))n.name==="PROVIDER"&&(yield*n.providers)}};T4e.exports={DHTContentRouting:I4e}});var O4e=g((jUt,C4e)=>{"use strict";var Nd=oe(),{messages:D3,codes:Bd}=Rr(),{storeAddresses:fnt,uniquePeers:hnt,requirePeers:dnt,maybeLimitSource:pnt}=MO(),ynt=ls(),gnt=Dl(),{pipe:mnt}=br(),{DHTContentRouting:wnt}=x4e(),P4e=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(new wnt(this.dht))}async*findProviders(e,r={}){if(!this.routers.length)throw Nd(new Error("No content this.routers available"),Bd.ERR_NO_ROUTERS_AVAILABLE);yield*mnt(gnt(...this.routers.map(n=>n.findProviders(e,r))),n=>fnt(n,this.libp2p.peerStore),n=>hnt(n),n=>pnt(n,r.maxNumProviders),n=>dnt(n))}async provide(e){if(!this.routers.length)throw Nd(new Error("No content routers available"),Bd.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(r=>r.provide(e)))}async put(e,r,n){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw Nd(new Error(D3.NOT_STARTED_YET),Bd.DHT_NOT_STARTED);await ynt(this.dht.put(e,r,n))}async get(e,r){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw Nd(new Error(D3.NOT_STARTED_YET),Bd.DHT_NOT_STARTED);for await(let n of this.dht.get(e,r))if(n.name==="VALUE")return{from:n.peerId,val:n.value};throw Nd(new Error(D3.NOT_FOUND),Bd.ERR_NOT_FOUND)}async*getMany(e,r,n){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw Nd(new Error(D3.NOT_STARTED_YET),Bd.DHT_NOT_STARTED);if(!r)return;let i=0;for await(let s of this.dht.get(e,n))if(s.name==="VALUE"&&(yield{from:s.peerId,val:s.value},i++,i===r))break;if(i===0)throw Nd(new Error(D3.NOT_FOUND),Bd.ERR_NOT_FOUND)}};C4e.exports=P4e});var qO=g((VUt,B4e)=>{"use strict";var bnt=ft(),{Multiaddr:k4e}=yt(),D4e=oe(),{codes:N4e}=Rr();function _nt(t){typeof t=="string"&&(t=new k4e(t));let e;if(k4e.isMultiaddr(t)){e=t;let r=t.getPeerId();if(!r)throw D4e(new Error(`${t} does not have a valid peer type`),N4e.ERR_INVALID_MULTIADDR);try{t=bnt.createFromB58String(r)}catch{throw D4e(new Error(`${t} is not a valid peer type`),N4e.ERR_INVALID_MULTIADDR)}}return{id:t,multiaddrs:e?[e]:void 0}}B4e.exports=_nt});var M4e=g((zUt,L4e)=>{var vy=1e3,Ey=vy*60,Sy=Ey*60,Ld=Sy*24,vnt=Ld*7,Ent=Ld*365.25;L4e.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Snt(t);if(r==="number"&&isFinite(t))return e.long?Rnt(t):Ant(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Snt(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Ent;case"weeks":case"week":case"w":return r*vnt;case"days":case"day":case"d":return r*Ld;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Sy;case"minutes":case"minute":case"mins":case"min":case"m":return r*Ey;case"seconds":case"second":case"secs":case"sec":case"s":return r*vy;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Ant(t){var e=Math.abs(t);return e>=Ld?Math.round(t/Ld)+"d":e>=Sy?Math.round(t/Sy)+"h":e>=Ey?Math.round(t/Ey)+"m":e>=vy?Math.round(t/vy)+"s":t+"ms"}function Rnt(t){var e=Math.abs(t);return e>=Ld?_v(t,e,Ld,"day"):e>=Sy?_v(t,e,Sy,"hour"):e>=Ey?_v(t,e,Ey,"minute"):e>=vy?_v(t,e,vy,"second"):t+" ms"}function _v(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var F4e=g((HUt,q4e)=>{"use strict";q4e.exports=U4e;var Int=M4e(),Bf=U4e.prototype,Tnt=new Date%1e9;function xnt(){return(Math.random()*1e9>>>0)+Tnt++}function U4e(t){t=t||{},this.id=t.id||xnt(),this.max=t.max||1/0,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,n=this.items.length;n--;)e=this.items[n],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}Bf.has=function(t){return t in this._lookup};Bf.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};Bf.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null};Bf.set=function(t,e,r){var n=this._lookup[t],i=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,i)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(i),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(i.meta=r.meta),r.refresh&&(i.refresh=r.ttl)),this};Bf.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1};Bf.expire=function(t,e){var r=e||0,n=this._lookup[t];if(!n)return this;if(typeof r=="string"&&(r=Int(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(n.timeout),n.timeout=setTimeout(this.delete.bind(this,n.key),r),n.expires=Number(new Date)+r,this};Bf.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this};Bf.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}});var j4e=g(($Ut,K4e)=>{"use strict";var{default:Pnt,Headers:Cnt}=h9();function Ont({serverResolver:t,hostname:e,recordType:r}){return`${t}?name=${e}&type=${r}`}function knt(t){return Pnt(t,{headers:new Cnt({accept:"application/dns-json"})})}function Dnt(t,e){return`${e}_${t}`}K4e.exports={buildResource:Ont,fetch:knt,getCacheKey:Dnt}});var H4e=g((GUt,z4e)=>{"use strict";var V4e=he(),vv=V4e("dns-over-http-resolver");vv.error=V4e("dns-over-http-resolver:error");var Nnt=F4e(),Uo=j4e(),Ev=class{constructor({maxCache:e=100}={}){this._cache=new Nnt({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let r=e.length-1;r>0;r--){let n=Math.floor(Math.random()*r),i=e[r];e[r]=e[n],e[n]=i}return e}setServers(e){this._servers=e}resolve(e,r="A"){switch(r){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${r} is not supported`)}}async resolve4(e){let r="A",n=this._cache.get(Uo.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await Uo.fetch(Uo.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Uo.getCacheKey(e,r),a,{ttl:c}),a}catch{vv.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolve6(e){let r="AAAA",n=this._cache.get(Uo.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await Uo.fetch(Uo.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Uo.getCacheKey(e,r),a,{ttl:c}),a}catch{vv.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolveTxt(e){let r="TXT",n=this._cache.get(Uo.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await Uo.fetch(Uo.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Uo.getCacheKey(e,r),a,{ttl:c}),a}catch{vv.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}};Ev.Resolver=Ev;z4e.exports=Ev});var G4e=g((WUt,$4e)=>{"use strict";var Bnt=H4e();$4e.exports=Bnt});var Y4e=g((YUt,W4e)=>{"use strict";var Lnt=p2(),{code:Mnt}=Lnt("dnsaddr");async function Unt(t){let e=G4e(),r=new e,n=t.getPeerId(),[,i]=t.stringTuples().find(([a])=>a===Mnt)||[],o=(await r.resolveTxt(`_dnsaddr.${i}`)).flat().map(a=>a.split("=")[1]);return n&&(o=o.filter(a=>a.includes(n))),o}W4e.exports={dnsaddrResolver:Unt}});var Sv=g((XUt,X4e)=>{"use strict";X4e.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var FO=g((QUt,qnt)=>{qnt.exports={name:"libp2p",version:"0.36.2",description:"JavaScript implementation of libp2p, a modular peer to peer network stack",leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",main:"src/index.js",types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},files:["dist","src"],scripts:{lint:"aegir lint",build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:fetch && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:fetch":"pbjs -t static-module -w commonjs -r libp2p-fetch --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/fetch/proto.js ./src/fetch/proto.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:peer":"pbjs -t static-module -w commonjs -r libp2p-peer --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/pb/peer.js ./src/peer-store/pb/peer.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:fetch && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:fetch":"pbts -o src/fetch/proto.d.ts src/fetch/proto.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:peer":"pbts -o src/peer-store/pb/peer.d.ts src/peer-store/pb/peer.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js",test:"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","test:interop":"LIBP2P_JS=$PWD npx aegir test -t node -f ./node_modules/libp2p-interop/test/*",prepare:"npm run build",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},repository:{type:"git",url:"https://github.com/libp2p/js-libp2p.git"},keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},homepage:"https://libp2p.io",license:"MIT",engines:{node:">=15.0.0"},browser:{"nat-api":!1},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use","*.d.ts"]},dependencies:{"@vascosantos/moving-average":"^1.1.0","abortable-iterator":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^3.0.0","bignumber.js":"^9.0.1","class-is":"^1.1.0","datastore-core":"^7.0.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^7.0.0",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^6.0.2","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-foreach":"^0.1.1","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-sort":"^1.0.1","it-take":"^1.0.0","libp2p-crypto":"^0.21.2","libp2p-interfaces":"^4.0.0","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",mortice:"^2.0.1",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^3.0.0","mutable-proxy":"^1.0.0","nat-api":"^0.3.1","node-forge":"^1.2.1","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.16.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^3.0.0",uint8arrays:"^3.0.0",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},devDependencies:{"@chainsafe/libp2p-noise":"^5.0.0","@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^1.0.0","@types/varint":"^6.0.0",aegir:"^36.0.0",buffer:"^6.0.3",delay:"^5.0.0","into-stream":"^6.0.0","ipfs-http-client":"^54.0.2","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.14.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.11.1","libp2p-interfaces-compliance-tests":"^4.0.8","libp2p-interop":"^0.7.1","libp2p-kad-dht":"^0.28.6","libp2p-mdns":"^0.18.0","libp2p-mplex":"^0.10.4","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.25.0","libp2p-websockets":"^0.16.0",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^12.0.1",util:"^0.12.3"},contributors:["Vasco Santos <vasco.santos@moxy.studio>","David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","dirkmc <dirkmdev@gmail.com>","Volker Mische <volker.mische@gmail.com>","Chris Dostert <chrisdostert@users.noreply.github.com>","zeim839 <50573884+zeim839@users.noreply.github.com>","Robert Kiel <robert.kiel@hoprnet.org>","Richard Littauer <richard.littauer@gmail.com>","a1300 <matthias-knopp@gmx.net>","Ryan Bell <ryan@piing.net>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Andrew Nesbitt <andrewnez@gmail.com>","Franck Royer <franck@royer.one>","Thomas Eizinger <thomas@eizinger.io>","V\xEDt Habada <vithabada93@gmail.com>","Giovanni T. Parra <fiatjaf@gmail.com>","acolytec3 <17355484+acolytec3@users.noreply.github.com>","Alan Smithee <ggnore.alan.smithee@gmail.com>","Elven <mon.samuel@qq.com>","Samlior <samlior@foxmail.com>","Didrik Nordstr\xF6m <didrik.nordstrom@gmail.com>","Aditya Bose <13054902+adbose@users.noreply.github.com>","TJKoury <TJKoury@gmail.com>","TheStarBoys <41286328+TheStarBoys@users.noreply.github.com>","Tiago Alves <alvesjtiago@gmail.com>","Tim Daubensch\xFCtz <tim@daubenschuetz.de>","XiaoZhang <zxinmyth@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","ebinks <elizabethjbinks@gmail.com>","greenSnot <greenSnot@users.noreply.github.com>","isan_rivkin <isanrivkin@gmail.com>","mayerwin <mayerwin@users.noreply.github.com>","mcclure <andi.m.mcclure@gmail.com>","patrickwoodhead <91056047+patrickwoodhead@users.noreply.github.com>","phillmac <phillmac@users.noreply.github.com>","robertkiel <robert.kiel@validitylabs.org>","shresthagrawal <34920931+shresthagrawal@users.noreply.github.com>","swedneck <40505480+swedneck@users.noreply.github.com>","tuyennhv <vutuyen2636@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","Aleksei <vozhdb@gmail.com>","Bernd Strehl <bernd.strehl@gmail.com>","Chris Bratlien <chrisbratlien@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Diogo Silva <fsdiogo@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Ethan Lam <elmemphis2000@gmail.com>","Fei Liu <liu.feiwood@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","Francis Gulotta <wizard@roborooter.com>","Guy Sviry <32539816+guysv@users.noreply.github.com>","Henrique Dias <hacdias@gmail.com>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","John Rees <johnrees@users.noreply.github.com>","Jo\xE3o Santos <joaosantos15@users.noreply.github.com>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Lars Gierth <lgierth@users.noreply.github.com>","Leask Wong <i@leaskh.com>","Marcin Tojek <mtojek@users.noreply.github.com>","Marston Connell <34043723+TheMarstonConnell@users.noreply.github.com>","Michael Burns <5170+mburns@users.noreply.github.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Philipp Muens <raute1337@gmx.de>","RasmusErik Voel Jensen <github@solsort.com>","Smite Chow <xiaopengyou@live.com>","Soeren <nikorpoulsen@gmail.com>"]}});var KO=g((ZUt,qc)=>{"use strict";var Fnt=FO().version;qc.exports.PROTOCOL_VERSION="ipfs/0.1.0";qc.exports.AGENT_VERSION=`js-libp2p/${Fnt}`;qc.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";qc.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0";qc.exports.IDENTIFY_PROTOCOL_VERSION="0.1.0";qc.exports.MULTICODEC_IDENTIFY_PROTOCOL_NAME="id";qc.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push";qc.exports.MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0";qc.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0"});var Av=g((JUt,Q4e)=>{"use strict";Q4e.exports={ADVERTISE_BOOT_DELAY:15*6e4,ADVERTISE_TTL:30*6e4,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var J4e=g((eqt,Z4e)=>{"use strict";var Knt=cv();function jnt(t){let{address:e}=t.nodeAddress();return Knt(e)}Z4e.exports=jnt});var jO=g((tqt,t6e)=>{"use strict";var e6e=J4e();function Vnt(t,e){let r=e6e(t.multiaddr),n=e6e(e.multiaddr);return r&&!n?1:!r&&n||t.isCertified&&!e.isCertified?-1:!t.isCertified&&e.isCertified?1:0}function znt(t){return[...t].sort(Vnt)}t6e.exports.publicAddressesFirst=znt});var n6e=g((rqt,VO)=>{"use strict";var r6e=async t=>{try{let e=await t;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};VO.exports=r6e;VO.exports.default=r6e});var s6e=g((nqt,zO)=>{"use strict";var i6e=(t,...e)=>new Promise(r=>{r(t(...e))});zO.exports=i6e;zO.exports.default=i6e});var a6e=g((iqt,HO)=>{"use strict";var Hnt=s6e(),o6e=t=>{if(!((Number.isInteger(t)||t===1/0)&&t>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],r=0,n=()=>{r--,e.length>0&&e.shift()()},i=(a,c,...u)=>{r++;let l=Hnt(a,...u);c(l),l.then(n,n)},s=(a,c,...u)=>{r<t?i(a,c,...u):e.push(i.bind(null,a,c,...u))},o=(a,...c)=>new Promise(u=>s(a,u,...c));return Object.defineProperties(o,{activeCount:{get:()=>r},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};HO.exports=o6e;HO.exports.default=o6e});var u6e=g((sqt,c6e)=>{"use strict";var $O=n6e(),$nt=a6e();c6e.exports=async(t,e={})=>{let{concurrency:r=1/0}=e,n=$nt(r);return Promise.all(t.map(i=>i&&typeof i.then=="function"?$O(i):$O(typeof i=="function"?n(()=>i()):Promise.resolve(i))))}});var f6e=g((oqt,l6e)=>{"use strict";function Gnt(t,e){return t.length===e.length&&e.sort()&&t.sort().every((r,n)=>e[n].equals(r))}l6e.exports=Gnt});var p6e=g((aqt,d6e)=>{"use strict";var Md=Kr(),Rv=Md.Reader,h6e=Md.Writer,dn=Md.util,qo=Md.roots["libp2p-peer-record"]||(Md.roots["libp2p-peer-record"]={});qo.PeerRecord=function(){function t(e){if(this.addresses=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.peerId=dn.newBuffer([]),t.prototype.seq=dn.Long?dn.Long.fromBits(0,0,!0):0,t.prototype.addresses=dn.emptyArray,t.encode=function(r,n){if(n||(n=h6e.create()),r.peerId!=null&&Object.hasOwnProperty.call(r,"peerId")&&n.uint32(10).bytes(r.peerId),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&n.uint32(16).uint64(r.seq),r.addresses!=null&&r.addresses.length)for(var i=0;i<r.addresses.length;++i)qo.PeerRecord.AddressInfo.encode(r.addresses[i],n.uint32(26).fork()).ldelim();return n},t.decode=function(r,n){r instanceof Rv||(r=Rv.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new qo.PeerRecord;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.peerId=r.bytes();break;case 2:s.seq=r.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(qo.PeerRecord.AddressInfo.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof qo.PeerRecord)return r;var n=new qo.PeerRecord;if(r.peerId!=null&&(typeof r.peerId=="string"?dn.base64.decode(r.peerId,n.peerId=dn.newBuffer(dn.base64.length(r.peerId)),0):r.peerId.length&&(n.peerId=r.peerId)),r.seq!=null&&(dn.Long?(n.seq=dn.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?n.seq=parseInt(r.seq,10):typeof r.seq=="number"?n.seq=r.seq:typeof r.seq=="object"&&(n.seq=new dn.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".PeerRecord.addresses: array expected");n.addresses=[];for(var i=0;i<r.addresses.length;++i){if(typeof r.addresses[i]!="object")throw TypeError(".PeerRecord.addresses: object expected");n.addresses[i]=qo.PeerRecord.AddressInfo.fromObject(r.addresses[i])}}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addresses=[]),n.defaults)if(n.bytes===String?i.peerId="":(i.peerId=[],n.bytes!==Array&&(i.peerId=dn.newBuffer(i.peerId))),dn.Long){var s=new dn.Long(0,0,!0);i.seq=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.seq=n.longs===String?"0":0;if(r.peerId!=null&&r.hasOwnProperty("peerId")&&(i.peerId=n.bytes===String?dn.base64.encode(r.peerId,0,r.peerId.length):n.bytes===Array?Array.prototype.slice.call(r.peerId):r.peerId),r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?i.seq=n.longs===String?String(r.seq):r.seq:i.seq=n.longs===String?dn.Long.prototype.toString.call(r.seq):n.longs===Number?new dn.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.addresses&&r.addresses.length){i.addresses=[];for(var o=0;o<r.addresses.length;++o)i.addresses[o]=qo.PeerRecord.AddressInfo.toObject(r.addresses[o],n)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Md.util.toJSONOptions)},t.AddressInfo=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.multiaddr=dn.newBuffer([]),e.encode=function(n,i){return i||(i=h6e.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),i},e.decode=function(n,i){n instanceof Rv||(n=Rv.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new qo.PeerRecord.AddressInfo;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof qo.PeerRecord.AddressInfo)return n;var i=new qo.PeerRecord.AddressInfo;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?dn.base64.decode(n.multiaddr,i.multiaddr=dn.newBuffer(dn.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),i},e.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=dn.newBuffer(s.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?dn.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Md.util.toJSONOptions)},e}(),t}();d6e.exports=qo});var g6e=g((cqt,y6e)=>{"use strict";var Wnt="libp2p-peer-record",Ynt=Uint8Array.from([3,1]);y6e.exports={ENVELOPE_DOMAIN_PEER_RECORD:Wnt,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:Ynt}});var Iv=g((uqt,b6e)=>{"use strict";var{Multiaddr:Xnt}=yt(),Qnt=ft(),Znt=f6e(),{PeerRecord:m6e}=p6e(),{ENVELOPE_DOMAIN_PEER_RECORD:w6e,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:Jnt}=g6e(),Ud=class{constructor({peerId:e,multiaddrs:r=[],seqNumber:n=Date.now()}){this.domain=w6e,this.codec=Jnt,this.peerId=e,this.multiaddrs=r,this.seqNumber=n,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=m6e.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof Ud)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!Znt(this.multiaddrs,e.multiaddrs))}};Ud.createFromProtobuf=t=>{let e=m6e.decode(t),r=Qnt.createFromBytes(e.peerId),n=(e.addresses||[]).map(s=>new Xnt(s.multiaddr)),i=Number(e.seq);return new Ud({peerId:r,multiaddrs:n,seqNumber:i})};Ud.DOMAIN=w6e;b6e.exports=Ud});var GO=g((lqt,_6e)=>{"use strict";var eit=$m(),tit=Iv();async function rit(t){let e=new tit({peerId:t.peerId,multiaddrs:t.multiaddrs}),r=await eit.seal(e,t.peerId);await t.peerStore.addressBook.consumePeerRecord(r)}_6e.exports.updateSelfPeerRecord=rit});var YO=g((fqt,S6e)=>{"use strict";var v6e=he(),qd=Object.assign(v6e("libp2p:transports"),{error:v6e("libp2p:transports:err")}),nit=u6e(),{codes:Ay}=Rr(),N3=oe(),{updateSelfPeerRecord:E6e}=GO(),WO=class{constructor({libp2p:e,upgrader:r,faultTolerance:n=Tv.FATAL_ALL}){this.libp2p=e,this.upgrader=r,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=n}add(e,r,n={}){if(qd("adding %s",e),!e)throw N3(new Error(`Transport must have a valid key, was given '${e}'`),Ay.ERR_INVALID_KEY);if(this._transports.has(e))throw N3(new Error("There is already a transport with this key"),Ay.ERR_DUPLICATE_TRANSPORT);let i=new r({...n,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,i),this._listenerOptions.set(e,n.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[r,n]of this._listeners)for(qd("closing listeners for %s",r);n.length;){let i=n.pop();i.removeAllListeners("listening"),i.removeAllListeners("close"),e.push(i.close())}await Promise.all(e),qd("all listeners closed");for(let r of this._listeners.keys())this._listeners.set(r,[])}async dial(e,r){let n=this.transportForMultiaddr(e);if(!n)throw N3(new Error(`No transport available for address ${String(e)}`),Ay.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,r)}catch(i){throw i.code||(i.code=Ay.ERR_TRANSPORT_DIAL_FAILED),i}}getAddrs(){let e=[];for(let r of this._listeners.values())for(let n of r)e=[...e,...n.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let r of this._transports.values())if(r.filter([e]).length)return r;return null}async listen(e){if(!e||e.length===0){qd("no addresses were provided for listening, this node is dial only");return}let r=[];for(let[n,i]of this._transports.entries()){let s=i.filter(e),o=[];for(let u of s){qd("creating listener for %s on %s",n,u);let l=i.createListener(this._listenerOptions.get(n));this._listeners.get(n).push(l),l.on("listening",()=>E6e(this.libp2p)),l.on("close",()=>E6e(this.libp2p)),o.push(l.listen(u))}if(o.length===0){r.push(n);continue}if(!(await nit(o)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==Tv.NO_FATAL)throw N3(new Error(`Transport (${n}) could not listen on any available address`),Ay.ERR_NO_VALID_ADDRESSES)}if(r.length===this._transports.size){let n=`no valid addresses were provided for transports [${r}]`;if(this.faultTolerance===Tv.FATAL_ALL)throw N3(new Error(n),Ay.ERR_NO_VALID_ADDRESSES);qd(`libp2p in dial mode only: ${n}`)}}async remove(e){if(qd("removing %s",e),this._listeners.has(e))for(let r of this._listeners.get(e))r.removeAllListeners("listening"),r.removeAllListeners("close"),await r.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let r of this._transports.keys())e.push(this.remove(r));await Promise.all(e)}},Tv={FATAL_ALL:0,NO_FATAL:1};WO.FaultTolerance=Tv;S6e.exports=WO});var I6e=g((hqt,R6e)=>{"use strict";var iit=Wu(),{dnsaddrResolver:sit}=Y4e(),XO=Sv(),{AGENT_VERSION:oit}=KO(),A6e=Av(),{publicAddressesFirst:ait}=jO(),{FaultTolerance:cit}=YO(),uit={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:t=>t},connectionManager:{minConnections:25},connectionGater:{},transportManager:{faultTolerance:cit.FATAL_ALL},dialer:{maxParallelDials:XO.MAX_PARALLEL_DIALS,maxDialsPerPeer:XO.MAX_PER_PEER_DIALS,dialTimeout:XO.DIAL_TIMEOUT,resolvers:{dnsaddr:sit},addressSorter:ait},host:{agentVersion:oit},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{protocolPrefix:"ipfs",dht:{enabled:!1,kBucketSize:20},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:A6e.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:A6e.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};R6e.exports.validate=t=>{let e=iit(uit,t);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var P6e=g((dqt,x6e)=>{"use strict";var{EventEmitter:lit}=Gt(),{Multiaddr:B3}=yt(),fit=ft(),T6e=class extends lit{constructor(e,{listen:r=[],announce:n=[]}={}){super();this.peerId=e,this.listen=new Set(r.map(i=>i.toString())),this.announce=new Set(n.map(i=>i.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new B3(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new B3(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new B3(e))}addObservedAddr(e){let r=new B3(e),n=r.getPeerId();n&&fit.createFromB58String(n).equals(this.peerId)&&(r=r.decapsulate(new B3(`/p2p/${this.peerId}`)));let i=r.toString();this.observed.has(i)||(this.observed.add(i),this.emit("change:addresses"))}};x6e.exports=T6e});var k6e=g((pqt,O6e)=>{"use strict";var{EventEmitter:hit}=Gt(),QO=he()("latency-monitor:VisibilityChangeEmitter"),C6e=class extends hit{constructor(){super();if(typeof document>"u"){QO('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,r;typeof document.hidden<"u"?(e="hidden",r="visibilitychange"):typeof document.mozHidden<"u"?(e="mozHidden",r="mozvisibilitychange"):typeof document.msHidden<"u"?(e="msHidden",r="msvisibilitychange"):typeof document.webkitHidden<"u"&&(e="webkitHidden",r="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=r}_addVisibilityChangeListener(){typeof document.addEventListener>"u"||typeof document[this._hidden]>"u"?QO("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];QO(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};O6e.exports=C6e});var B6e=g((yqt,N6e)=>{"use strict";var{EventEmitter:dit}=Gt(),pit=k6e(),ju=he()("latency-monitor:LatencyMonitor"),D6e=class extends dit{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:r,asyncTestFn:n,latencyRandomPercentage:i}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=i||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=r===null||r===0?void 0:r||5*1e3,ju("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?ju("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):ju("Not emitting summaries"),s.asyncTestFn=n}start(){globalThis.process&&globalThis.process.hrtime?(ju("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let r=this.now(e);return r[0]*1e3+r[1]/1e6}):typeof window<"u"&&window.performance&&window.performance.now?(ju("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(ju("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),yit()&&(this._visibilityChangeEmitter=new pit,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),ju("Summary: %O",e),e}_checkLatency(){let e=this,r=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,n={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+r),startTime:e.now()},i=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(n.startTime)-n.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,ju("MS: %s Data: %O",s,e._latencyData)};ju("localData: %O",n),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(n.deltaOffset=0,n.startTime=e.now(),e.asyncTestFn(i)):(n.deltaOffset-=1,i())},n.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function yit(){return typeof window<"u"}N6e.exports=D6e});var Fd=g((gqt,M6e)=>{"use strict";var L6e=class extends Map{constructor(e){super();let{system:r,component:n,metric:i,metrics:s}=e;this._system=r,this._component=n,this._metric=i,this._metrics=s,this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size})}set(e,r){return super.set(e,r),this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size}),this}delete(e){let r=super.delete(e);return this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size}),r}clear(){super.clear(),this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size})}};M6e.exports=({system:t="libp2p",component:e,metric:r,metrics:n})=>{let i;return n?i=new L6e({system:t,component:e,metric:r,metrics:n}):i=new Map,i}});var $6e=g((mqt,H6e)=>{"use strict";var U6e=he(),Oa=Object.assign(U6e("libp2p:connection-manager"),{error:U6e("libp2p:connection-manager:err")}),q6e=oe(),git=Wu(),mit=B6e(),F6e=S2(),{EventEmitter:wit}=Gt(),K6e=Fd(),bit=ft(),{codes:{ERR_INVALID_PARAMETERS:j6e}}=Rr(),_it={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},V6e="connection-manager",vit="peer-connections",Eit="peer-values",z6e=class extends wit{constructor(e,r={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=git.call({ignoreUndefined:!0},_it,r),this._options.maxConnections<this._options.minConnections)throw q6e(new Error("Connection Manager maxConnections must be greater than minConnections"),j6e);Oa("options: %j",this._options),this._peerValues=K6e({component:V6e,metric:Eit,metrics:this._libp2p.metrics}),this.connections=K6e({component:V6e,metric:vit,metrics:this._libp2p.metrics}),this._started=!1,this._timer=null,this._checkMetrics=this._checkMetrics.bind(this),this._latencyMonitor=new mit({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval}),this.setMaxListeners(1/0)}get size(){return Array.from(this.connections.values()).reduce((e,r)=>e+r.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||F6e(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,Oa("started")}async stop(){this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),Oa("stopped")}async _close(){let e=[];for(let r of this.connections.values())for(let n of r)e.push(n.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,r){if(r<0||r>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),r)}async _checkMetrics(){if(this._libp2p.metrics)try{let e=this._libp2p.metrics.globalThis.movingAverages,r=e.dataReceived[this._options.movingAverageInterval].movingAverage();await this._checkMaxLimit("maxReceivedData",r);let n=e.dataSent[this._options.movingAverageInterval].movingAverage();await this._checkMaxLimit("maxSentData",n);let i=r+n;await this._checkMaxLimit("maxData",i),Oa("metrics update",i)}finally{this._timer=F6e(this._checkMetrics,this._options.pollInterval)}}async onConnect(e){if(!this._started){await e.close();return}let r=e.remotePeer,n=r.toB58String(),i=this.connections.get(n);this.emit("peer:connect",e),i?i.push(e):this.connections.set(n,[e]),await this._libp2p.peerStore.keyBook.set(r,r.pubKey),this._peerValues.has(n)||this._peerValues.set(n,this._options.defaultPeerValue),await this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){if(!this._started)return;let r=e.remotePeer.toB58String(),n=this.connections.get(r);n&&n.length>1?(n=n.filter(i=>i.id!==e.id),this.connections.set(r,n)):n&&(this.connections.delete(r),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e),this._libp2p.metrics&&this._libp2p.metrics.onPeerDisconnected(e.remotePeer))}get(e){let r=this.getAll(e);return r.length?r[0]:null}getAll(e){if(!bit.isPeerId(e))throw q6e(new Error("peerId must be an instance of peer-id"),j6e);let r=e.toB58String(),n=this.connections.get(r);return n?n.filter(i=>i.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs).catch(r=>{Oa.error(r)})}async _checkMaxLimit(e,r){let n=this._options[e];Oa("checking limit of %s. current value: %d of %d",e,r,n),r>n&&(Oa("%s: limit exceeded: %s, %d",this._peerId,e,r),await this._maybeDisconnectOne())}async _maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((n,i)=>n[1]-i[1])));Oa("%s: sorted peer values: %j",this._peerId,e);let r=e[0];if(r){let n=r[0];Oa("%s: lowest value peer is %s",this._peerId,n),Oa("%s: closing a connection to %j",this._peerId,n);for(let i of this.connections.values())if(i[0].remotePeer.toB58String()===n){i[0].close().catch(s=>{Oa.error(s)}),this.onDisconnect(i[0]);break}}}}};H6e.exports=z6e});var Q6e=g((wqt,X6e)=>{"use strict";var G6e=he(),Sit=Wu(),W6e=S2(),Ait=yo(),{pipe:Rit}=br(),Iit=fs(),Tit=IT(),Lf=Object.assign(G6e("libp2p:connection-manager:auto-dialler"),{error:G6e("libp2p:connection-manager:auto-dialler:err")}),xit={enabled:!0,minConnections:0,autoDialInterval:1e4},Y6e=class{constructor(e,r={}){this._options=Sit.call({ignoreUndefined:!0},xit,r),this._libp2p=e,this._running=!1,this._autoDialTimeout=null,this._autoDial=this._autoDial.bind(this),Lf("options: %j",this._options)}async start(){if(!this._options.enabled){Lf("not enabled");return}this._running=!0,this._autoDial().catch(e=>{Lf.error("could start autodial",e)}),Lf("started")}async stop(){if(!this._options.enabled){Lf("not enabled");return}this._running=!1,this._autoDialTimeout&&this._autoDialTimeout.clear(),Lf("stopped")}async _autoDial(){let e=this._options.minConnections;if(this._libp2p.connections.size>=e){this._autoDialTimeout=W6e(this._autoDial,this._options.autoDialInterval);return}let r=await Rit(this._libp2p.peerStore.getPeers(),n=>Iit(n,i=>!i.id.equals(this._libp2p.peerId)),n=>Tit(n,(i,s)=>s.protocols&&s.protocols.length&&(!i.protocols||!i.protocols.length)||s.id.pubKey&&!i.id.pubKey?1:-1),n=>Ait(n));for(let n=0;this._running&&n<r.length&&this._libp2p.connections.size<e;n++){let i=r[n];if(!this._libp2p.connectionManager.get(i.id)){Lf("connecting to a peerStore stored peer %s",i.id.toB58String());try{await this._libp2p.dialer.connectToPeer(i.id)}catch(s){Lf.error("could not connect to peerStore stored peer",s)}}}!this._running||(this._autoDialTimeout=W6e(this._autoDial,this._options.autoDialInterval))}};X6e.exports=Y6e});var Ry=g((bqt,J6e)=>{"use strict";var Kd=Kr(),xv=Kd.Reader,Z6e=Kd.Writer,Fo=Kd.util,ci=Kd.roots["libp2p-circuit"]||(Kd.roots["libp2p-circuit"]={});ci.CircuitRelay=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.type=1,t.prototype.srcPeer=null,t.prototype.dstPeer=null,t.prototype.code=100,t.encode=function(r,n){return n||(n=Z6e.create()),r.type!=null&&Object.hasOwnProperty.call(r,"type")&&n.uint32(8).int32(r.type),r.srcPeer!=null&&Object.hasOwnProperty.call(r,"srcPeer")&&ci.CircuitRelay.Peer.encode(r.srcPeer,n.uint32(18).fork()).ldelim(),r.dstPeer!=null&&Object.hasOwnProperty.call(r,"dstPeer")&&ci.CircuitRelay.Peer.encode(r.dstPeer,n.uint32(26).fork()).ldelim(),r.code!=null&&Object.hasOwnProperty.call(r,"code")&&n.uint32(32).int32(r.code),n},t.decode=function(r,n){r instanceof xv||(r=xv.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ci.CircuitRelay;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.type=r.int32();break;case 2:s.srcPeer=ci.CircuitRelay.Peer.decode(r,r.uint32());break;case 3:s.dstPeer=ci.CircuitRelay.Peer.decode(r,r.uint32());break;case 4:s.code=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof ci.CircuitRelay)return r;var n=new ci.CircuitRelay;switch(r.type){case"HOP":case 1:n.type=1;break;case"STOP":case 2:n.type=2;break;case"STATUS":case 3:n.type=3;break;case"CAN_HOP":case 4:n.type=4;break}if(r.srcPeer!=null){if(typeof r.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");n.srcPeer=ci.CircuitRelay.Peer.fromObject(r.srcPeer)}if(r.dstPeer!=null){if(typeof r.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");n.dstPeer=ci.CircuitRelay.Peer.fromObject(r.dstPeer)}switch(r.code){case"SUCCESS":case 100:n.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:n.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:n.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:n.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:n.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:n.code=260;break;case"HOP_CANT_DIAL_DST":case 261:n.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:n.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:n.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:n.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:n.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:n.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:n.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:n.code=351;break;case"STOP_RELAY_REFUSED":case 390:n.code=390;break;case"MALFORMED_MESSAGE":case 400:n.code=400;break}return n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.type=n.enums===String?"HOP":1,i.srcPeer=null,i.dstPeer=null,i.code=n.enums===String?"SUCCESS":100),r.type!=null&&r.hasOwnProperty("type")&&(i.type=n.enums===String?ci.CircuitRelay.Type[r.type]:r.type),r.srcPeer!=null&&r.hasOwnProperty("srcPeer")&&(i.srcPeer=ci.CircuitRelay.Peer.toObject(r.srcPeer,n)),r.dstPeer!=null&&r.hasOwnProperty("dstPeer")&&(i.dstPeer=ci.CircuitRelay.Peer.toObject(r.dstPeer,n)),r.code!=null&&r.hasOwnProperty("code")&&(i.code=n.enums===String?ci.CircuitRelay.Status[r.code]:r.code),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Kd.util.toJSONOptions)},t.Status=function(){var e={},r=Object.create(e);return r[e[100]="SUCCESS"]=100,r[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,r[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,r[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,r[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,r[e[260]="HOP_NO_CONN_TO_DST"]=260,r[e[261]="HOP_CANT_DIAL_DST"]=261,r[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,r[e[270]="HOP_CANT_SPEAK_RELAY"]=270,r[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,r[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,r[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,r[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,r[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,r[e[390]="STOP_RELAY_REFUSED"]=390,r[e[400]="MALFORMED_MESSAGE"]=400,r}(),t.Type=function(){var e={},r=Object.create(e);return r[e[1]="HOP"]=1,r[e[2]="STOP"]=2,r[e[3]="STATUS"]=3,r[e[4]="CAN_HOP"]=4,r}(),t.Peer=function(){function e(r){if(this.addrs=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.id=Fo.newBuffer([]),e.prototype.addrs=Fo.emptyArray,e.encode=function(n,i){if(i||(i=Z6e.create()),i.uint32(10).bytes(n.id),n.addrs!=null&&n.addrs.length)for(var s=0;s<n.addrs.length;++s)i.uint32(18).bytes(n.addrs[s]);return i},e.decode=function(n,i){n instanceof xv||(n=xv.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new ci.CircuitRelay.Peer;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.id=n.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(n.bytes());break;default:n.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw Fo.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(n){if(n instanceof ci.CircuitRelay.Peer)return n;var i=new ci.CircuitRelay.Peer;if(n.id!=null&&(typeof n.id=="string"?Fo.base64.decode(n.id,i.id=Fo.newBuffer(Fo.base64.length(n.id)),0):n.id.length&&(i.id=n.id)),n.addrs){if(!Array.isArray(n.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");i.addrs=[];for(var s=0;s<n.addrs.length;++s)typeof n.addrs[s]=="string"?Fo.base64.decode(n.addrs[s],i.addrs[s]=Fo.newBuffer(Fo.base64.length(n.addrs[s])),0):n.addrs[s].length&&(i.addrs[s]=n.addrs[s])}return i},e.toObject=function(n,i){i||(i={});var s={};if((i.arrays||i.defaults)&&(s.addrs=[]),i.defaults&&(i.bytes===String?s.id="":(s.id=[],i.bytes!==Array&&(s.id=Fo.newBuffer(s.id)))),n.id!=null&&n.hasOwnProperty("id")&&(s.id=i.bytes===String?Fo.base64.encode(n.id,0,n.id.length):i.bytes===Array?Array.prototype.slice.call(n.id):n.id),n.addrs&&n.addrs.length){s.addrs=[];for(var o=0;o<n.addrs.length;++o)s.addrs[o]=i.bytes===String?Fo.base64.encode(n.addrs[o],0,n.addrs[o].length):i.bytes===Array?Array.prototype.slice.call(n.addrs[o]):n.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Kd.util.toJSONOptions)},e}(),t}();J6e.exports=ci});var r5e=g((_qt,t5e)=>{"use strict";var{source:e5e}=Ea(),Pit=he(),Cit=Pit("libp2p:stream:converter");function Oit({stream:t,remoteAddr:e,localAddr:r},n={}){let{sink:i,source:s}=t,o={async sink(c){n.signal&&(c=e5e(c,n.signal));try{await i(c)}catch(u){u.type!=="aborted"&&Cit(u)}a()},source:n.signal?e5e(s,n.signal):s,conn:t,localAddr:r,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return i(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}t5e.exports=Oit});var L3=g((vqt,n5e)=>{"use strict";n5e.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var s5e=g((Eqt,i5e)=>{"use strict";var{EventEmitter:kit}=Gt(),{Multiaddr:Dit}=yt();i5e.exports=t=>{let e=new Map;async function r(s){let o=String(s).split("/p2p-circuit").find(u=>u!==""),a=await t.dial(new Dit(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),i.emit("listening")}function n(){let s=[];for(let o of e.values())s.push(o);return s}let i=Object.assign(new kit,{close:()=>Promise.resolve(),listen:r,getAddrs:n});return t.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&i.emit("close")}),i}});var ZO=g((Sqt,c5e)=>{"use strict";var{Multiaddr:o5e}=yt(),{CircuitRelay:jd}=Ry();function a5e(t,e){t.write({type:jd.Type.STATUS,code:e})}function Nit(t,e){try{t.dstPeer&&t.dstPeer.addrs&&t.dstPeer.addrs.forEach(r=>new o5e(r))}catch(r){throw a5e(e,t.type===jd.Type.HOP?jd.Status.HOP_DST_MULTIADDR_INVALID:jd.Status.STOP_DST_MULTIADDR_INVALID),r}try{t.srcPeer&&t.srcPeer.addrs&&t.srcPeer.addrs.forEach(r=>new o5e(r))}catch(r){throw a5e(e,t.type===jd.Type.HOP?jd.Status.HOP_SRC_MULTIADDR_INVALID:jd.Status.STOP_SRC_MULTIADDR_INVALID),r}}c5e.exports={validateAddrs:Nit}});var Cv=g((Aqt,d5e)=>{"use strict";var u5e=he(),Pv=Object.assign(u5e("libp2p:circuit:stream-handler"),{error:u5e("libp2p:circuit:stream-handler:err")}),l5e=xo(),Bit=kd(),{CircuitRelay:f5e}=Ry(),h5e=class{constructor({stream:e,maxLength:r=4096}){this.stream=e,this.shake=Bit(this.stream),this.decoder=l5e.decode.fromReader(this.shake.reader,{maxDataLength:r})}async read(){let e=await this.decoder.next();if(e.value){let r=f5e.decode(e.value.slice());return Pv("read message type",r.type),r}Pv("read received no value, closing stream"),this.close()}write(e){Pv("write message type %s",e.type),this.shake.write(l5e.encode.single(f5e.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){Pv("closing the stream"),this.rest().sink([])}};d5e.exports=h5e});var tk=g((Rqt,ek)=>{"use strict";var p5e=he(),M3=Object.assign(p5e("libp2p:circuit:stop"),{error:p5e("libp2p:circuit:stop:err")}),{CircuitRelay:JO}=Ry(),Lit=L3(),Mit=Cv(),{validateAddrs:Uit}=ZO();ek.exports.handleStop=function({connection:e,request:r,streamHandler:n}){try{Uit(r,n)}catch(i){return M3.error("invalid stop request via peer %s",e.remotePeer.toB58String(),i)}return M3("stop request is valid"),n.write({type:JO.Type.STATUS,code:JO.Status.SUCCESS}),n.rest()};ek.exports.stop=async function({connection:e,request:r}){let{stream:n}=await e.newStream([Lit.relay]);M3("starting stop request to %s",e.remotePeer.toB58String());let i=new Mit({stream:n});i.write(r);let s=await i.read();if(!s)return i.close();if(s.code===JO.Status.SUCCESS)return M3("stop request to %s was successful",e.remotePeer.toB58String()),i.rest();M3("stop request failed with code %d",s.code),i.close()}});var rk=g((Iqt,_5e)=>{"use strict";var y5e=he(),Vu=Object.assign(y5e("libp2p:circuit:hop"),{error:y5e("libp2p:circuit:hop:err")}),g5e=oe(),qit=ft(),{validateAddrs:Fit}=ZO(),w5e=Cv(),{CircuitRelay:Fs}=Ry(),{pipe:Kit}=br(),{codes:m5e}=Rr(),{stop:jit}=tk(),b5e=L3();async function Vit({connection:t,request:e,streamHandler:r,circuit:n}){if(!n._options.hop.enabled)return Vu("HOP request received but we are not acting as a relay"),r.end({type:Fs.Type.STATUS,code:Fs.Status.HOP_CANT_SPEAK_RELAY});try{Fit(e,r)}catch(u){return Vu.error("invalid hop request via peer %s",t.remotePeer.toB58String(),u)}if(!e.dstPeer){Vu("HOP request received but we do not receive a dstPeer");return}let i=new qit(e.dstPeer.id),s=n._connectionManager.get(i);if(!s&&!n._options.hop.active)return Vu("HOP request received but we are not connected to the destination peer"),r.end({type:Fs.Type.STATUS,code:Fs.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:Fs.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await jit({connection:s,request:o})}catch(u){return Vu.error(u)}Vu("hop request from %s is valid",t.remotePeer.toB58String()),r.write({type:Fs.Type.STATUS,code:Fs.Status.SUCCESS});let c=r.rest();return Kit(c,a,c)}async function zit({connection:t,request:e}){let{stream:r}=await t.newStream([b5e.relay]),n=new w5e({stream:r});n.write(e);let i=await n.read();if(!i)throw g5e(new Error("HOP request had no response"),m5e.ERR_HOP_REQUEST_FAILED);if(i.code===Fs.Status.SUCCESS)return Vu("hop request was successful"),n.rest();throw Vu("hop request failed with code %d, closing stream",i.code),n.close(),g5e(new Error(`HOP request failed with code ${i.code}`),m5e.ERR_HOP_REQUEST_FAILED)}async function Hit({connection:t}){let{stream:e}=await t.newStream([b5e.relay]),r=new w5e({stream:e});r.write({type:Fs.Type.CAN_HOP});let n=await r.read();return await r.close(),!(!n||n.code!==Fs.Status.SUCCESS)}function $it({connection:t,streamHandler:e,circuit:r}){let n=r._options.hop.enabled;Vu("can hop (%s) request from %s",n,t.remotePeer.toB58String()),e.end({type:Fs.Type.STATUS,code:n?Fs.Status.SUCCESS:Fs.Status.HOP_CANT_SPEAK_RELAY})}_5e.exports={handleHop:Vit,hop:zit,canHop:Hit,handleCanHop:$it}});var I5e=g((Tqt,R5e)=>{"use strict";var v5e=he(),zu=Object.assign(v5e("libp2p:circuit"),{error:v5e("libp2p:circuit:err")}),Git=oe(),Wit=eh(),{Multiaddr:U3}=yt(),E5e=ft(),{CircuitRelay:q3}=Ry(),{codes:Yit}=Rr(),S5e=r5e(),{relay:Xit}=L3(),Qit=s5e(),{handleCanHop:Zit,handleHop:Jit,hop:est}=rk(),{handleStop:tst}=tk(),rst=Cv(),nst=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),A5e=class{constructor({libp2p:e,upgrader:r}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=r,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(Xit,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:r}){let n=new rst({stream:r}),i=await n.read();if(!i)return;let s=this,o;switch(i.type){case q3.Type.CAN_HOP:{zu("received CAN_HOP request from %s",e.remotePeer.toB58String()),await Zit({circuit:s,connection:e,streamHandler:n});break}case q3.Type.HOP:{zu("received HOP request from %s",e.remotePeer.toB58String()),o=await Jit({connection:e,request:i,streamHandler:n,circuit:s});break}case q3.Type.STOP:{zu("received STOP request from %s",e.remotePeer.toB58String()),o=await tst({connection:e,request:i,streamHandler:n});break}default:zu("Request of type %s not supported",i.type)}if(o){let a=new U3(i.dstPeer.addrs[0]),c=new U3(i.srcPeer.addrs[0]),u=S5e({stream:o,remoteAddr:a,localAddr:c}),l=i.type===q3.Type.HOP?"relay":"inbound";zu("new %s connection %s",l,u.remoteAddr);let f=await this._upgrader.upgradeInbound(u);zu("%s connection %s upgraded",l,u.remoteAddr),this.handler&&this.handler(f)}}async dial(e,r){let n=e.toString().split("/p2p-circuit"),i=new U3(n[0]),s=new U3(n[n.length-1]),o=i.getPeerId(),a=s.getPeerId();if(!o||!a){let h="Circuit relay dial failed as addresses did not have peer id";throw zu.error(h),Git(new Error(h),Yit.ERR_RELAYED_DIAL)}let c=E5e.createFromB58String(o),u=E5e.createFromB58String(a),l=!1,f=this._connectionManager.get(c);f||(f=await this._dialer.connectToPeer(i,r),l=!0);try{let h=await est({connection:f,request:{type:q3.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(y=>y.bytes)},dstPeer:{id:u.toBytes(),addrs:[new U3(s).bytes]}}}),d=i.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),p=S5e({stream:h,remoteAddr:e,localAddr:d});return zu("new outbound connection %s",p.remoteAddr),this._upgrader.upgradeOutbound(p)}catch(h){throw zu.error("Circuit relay dial failed",h),l&&await f.close(),h}}createListener(e,r){return typeof e=="function"&&(r=e,e={}),this.handler=r,Qit(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>Wit.Circuit.matches(r))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[nst])}};R5e.exports=A5e});var nk=g((xqt,T5e)=>{"use strict";var{CID:ist}=(Se(),se(Yc)),{sha256:sst}=(Tn(),se(Js));T5e.exports.namespaceToCid=async t=>{let e=new TextEncoder().encode(t),r=await sst.digest(e);return ist.createV0(r)}});var D5e=g((Pqt,k5e)=>{"use strict";var x5e=he(),ik=Object.assign(x5e("libp2p:auto-relay"),{error:x5e("libp2p:auto-relay:err")}),{fromString:ost}=(dt(),se(nn)),{toString:ast}=(st(),se(hr)),{Multiaddr:cst}=yt(),ust=yo(),{relay:lst}=L3(),{canHop:fst}=rk(),{namespaceToCid:hst}=nk(),{CIRCUIT_PROTO_CODE:dst,HOP_METADATA_KEY:P5e,HOP_METADATA_VALUE:C5e,RELAY_RENDEZVOUS_NS:pst}=Av(),O5e=class{constructor({libp2p:e,maxListeners:r=1,onError:n}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=r,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(i,s)=>{ik.error(s||i),n&&n(i,s)}}async _onProtocolChange({peerId:e,protocols:r}){let n=e.toB58String(),i=r.find(s=>s===lst);if(!i&&this._listenRelays.has(n)){await this._removeListenRelay(n);return}else if(!i||this._listenRelays.has(n))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(dst)){ik(`relayed connection to ${n} will not be used to hop on`);return}await fst({connection:s})&&(await this._peerStore.metadataBook.setValue(e,P5e,ost(C5e)),await this._addListenRelay(s,n))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let n=e.remotePeer.toB58String();!this._listenRelays.has(n)||this._removeListenRelay(n).catch(i=>{ik.error(i)})}async _addListenRelay(e,r){try{if(this._listenRelays.size>=this.maxListeners)return;let n=await this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);(await Promise.all(n.map(async s=>{try{return await this._transportManager.listen([new cst(`${s.toString()}/p2p-circuit`)]),!0}catch(o){this._onError(o)}return!1}))).includes(!0)&&this._listenRelays.add(r)}catch(n){this._onError(n),this._listenRelays.delete(r)}}async _removeListenRelay(e){this._listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let r=[],n=await ust(this._peerStore.getPeers());for await(let{id:i,metadata:s}of n){let o=i.toB58String();if(this._listenRelays.has(o)||e.includes(o))continue;let a=s.get(P5e);if(!a||ast(a)!==C5e)continue;let c=this._connectionManager.get(i);if(!c){r.push(i);continue}if(await this._addListenRelay(c,o),this._listenRelays.size>=this.maxListeners)return}for(let i of r)if(await this._tryToListenOnRelay(i),this._listenRelays.size>=this.maxListeners)return;try{let i=await hst(pst);for await(let s of this._libp2p.contentRouting.findProviders(i)){if(!s.multiaddrs.length)continue;let o=s.id;if(await this._peerStore.addressBook.add(o,s.multiaddrs),await this._tryToListenOnRelay(o),this._listenRelays.size>=this.maxListeners)return}}catch(i){this._onError(i)}}async _tryToListenOnRelay(e){try{let r=await this._libp2p.dial(e);await this._addListenRelay(r,e.toB58String())}catch(r){this._onError(r,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};k5e.exports=O5e});var U5e=g((Cqt,M5e)=>{"use strict";var N5e=he(),B5e=Object.assign(N5e("libp2p:relay"),{error:N5e("libp2p:relay:err")}),{codes:yst}=Rr(),{setDelayedInterval:gst,clearDelayedInterval:mst}=UO(),wst=D5e(),{namespaceToCid:bst}=nk(),{RELAY_RENDEZVOUS_NS:_st}=Av(),L5e=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new wst({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=gst(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){mst(this._timeout)}async _advertiseService(){try{let e=await bst(_st);await this._libp2p.contentRouting.provide(e)}catch(e){e.code===yst.ERR_NO_ROUTERS_AVAILABLE?(B5e.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):B5e.error(e)}}};M5e.exports=L5e});var j5e=g((kqt,K5e)=>{var q5e=BS(),F5e=uc();K5e.exports=class{constructor(){this._buffer=new q5e,this._waitingConsumers=new q5e}push(e){let{promise:r,resolve:n}=F5e();return this._buffer.push({chunk:e,resolve:n}),this._consume(),r}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),r=this._buffer.shift();e.resolve(r.chunk),r.resolve()}}shift(){let{promise:e,resolve:r}=F5e();return this._waitingConsumers.push({resolve:r}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var ak=g((Dqt,ok)=>{"use strict";var sk=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},F3=class{static fn(e){return(...r)=>new F3((n,i,s)=>{r.push(s),e(...r).then(n,i)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,n(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(i,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new sk(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(F3.prototype,Promise.prototype);ok.exports=F3;ok.exports.CancelError=sk});var z5e=g((Nqt,Ov)=>{"use strict";var V5e=BO(),vst=ak(),ck=class extends Error{},Est=(t,e)=>new vst((r,n,i)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){n(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],u=0,l=!1,f=new Set,h=()=>(a.length===s&&(r(a),l=!0),u-c.length<s&&(n(new V5e(c)),l=!0),l),d=()=>{for(let p of t)!f.has(p)&&typeof p.cancel=="function"&&p.cancel()};i(d);for(let p of t)u++,(async()=>{try{let y=await p;if(l)return;if(!o(y))throw new ck("Value does not satisfy filter");a.push(y)}catch(y){c.push(y)}finally{f.add(p),!l&&h()&&d()}})();s>u&&(n(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),d())});Ov.exports=Est;Ov.exports.AggregateError=V5e;Ov.exports.FilterError=ck});var $5e=g((Bqt,uk)=>{"use strict";var H5e=z5e(),Sst=ak();uk.exports=(t,e)=>{let r=H5e(t,{...e,count:1});return Sst.fn(async n=>{n(()=>{r.cancel()});let[i]=await r;return i})()};uk.exports.AggregateError=H5e.AggregateError});var X5e=g((Lqt,Y5e)=>{"use strict";var Ast=oe(),{anySignal:Rst}=na(),Ist=j5e(),Tst=$5e(),{setMaxListeners:G5e}=Gt(),{codes:xst}=Rr(),W5e=class{constructor({addrs:e,dialAction:r,dialer:n}){this.addrs=e,this.dialer=n,this.dialAction=r}async run(e={}){let r=this.dialer.getTokens(this.addrs.length);if(r.length<1)throw Ast(new Error("No dial tokens available"),xst.ERR_NO_DIAL_TOKENS);let n=new Ist;r.forEach(o=>n.push(o));let i=this.addrs.map(()=>{let o=new AbortController;try{G5e&&G5e(1/0,o.signal)}catch{}return o}),s=0;try{return await Tst(this.addrs.map(async(o,a)=>{let c=await n.shift(),u;try{let l=i[a].signal;u=await this.dialAction(o,{...e,signal:e.signal?Rst([l,e.signal]):l}),i.splice(a,1)}finally{s++,this.addrs.length-s>=r.length?n.push(c):this.dialer.releaseToken(r.splice(r.indexOf(c),1)[0])}return u}))}finally{i.map(o=>o.abort()),r.forEach(o=>this.dialer.releaseToken(o))}}};Y5e.exports=W5e});var iwe=g((Mqt,nwe)=>{"use strict";var Q5e=he(),Pst=yo(),Cst=fs(),{pipe:Ost}=br(),Iy=Object.assign(Q5e("libp2p:dialer"),{error:Q5e("libp2p:dialer:err")}),kv=oe(),{Multiaddr:lk}=yt(),{TimeoutController:kst}=za(),{AbortError:Dst}=Ea(),{anySignal:Nst}=na(),{setMaxListeners:Z5e}=Gt(),Bst=X5e(),{publicAddressesFirst:Lst}=jO(),J5e=qO(),ewe=Fd(),{codes:K3}=Rr(),{DIAL_TIMEOUT:Mst,MAX_PARALLEL_DIALS:Ust,MAX_PER_PEER_DIALS:qst,MAX_ADDRS_TO_DIAL:Fst}=Sv(),twe="dialler",Kst="pending-dials",jst="pending-dial-targets",rwe=class{constructor({transportManager:e,peerStore:r,connectionGater:n,addressSorter:i=Lst,maxParallelDials:s=Ust,maxAddrsToDial:o=Fst,dialTimeout:a=Mst,maxDialsPerPeer:c=qst,resolvers:u={},metrics:l}){this.connectionGater=n,this.transportManager=e,this.peerStore=r,this.addressSorter=i,this.maxParallelDials=s,this.maxAddrsToDial=o,this.timeout=a,this.maxDialsPerPeer=c,this.tokens=[...new Array(s)].map((f,h)=>h),this._pendingDials=ewe({component:twe,metric:Kst,metrics:l}),this._pendingDialTargets=ewe({component:twe,metric:jst,metrics:l});for(let[f,h]of Object.entries(u))lk.resolvers.set(f,h)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(r){Iy.error(r)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new Dst("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,r={}){let{id:n}=J5e(e);if(await this.connectionGater.denyDialPeer(n))throw kv(new Error("The dial request is blocked by gater.allowDialPeer"),K3.ERR_PEER_DIAL_INTERCEPTED);let i=await this._createCancellableDialTarget(e);if(!i.addrs.length)throw kv(new Error("The dial request has no valid addresses"),K3.ERR_NO_VALID_ADDRESSES);let s=this._pendingDials.get(i.id)||this._createPendingDial(i,r);try{let o=await s.promise;return Iy("dial succeeded to %s",i.id),o}catch(o){throw s.controller.signal.aborted&&(o.code=K3.ERR_TIMEOUT),Iy.error(o),o}finally{s.destroy()}}async _createCancellableDialTarget(e){let r=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,n=new Promise((i,s)=>{this._pendingDialTargets.set(r,{resolve:i,reject:s})});try{return await Promise.race([this._createDialTarget(e),n])}finally{this._pendingDialTargets.delete(r)}}async _createDialTarget(e){let{id:r,multiaddrs:n}=J5e(e);n&&await this.peerStore.addressBook.add(r,n);let i=await Ost(await this.peerStore.addressBook.getMultiaddrsForPeer(r,this.addressSorter),a=>Cst(a,async c=>!await this.connectionGater.denyDialMultiaddr(r,c)),a=>Pst(a));lk.isMultiaddr(e)&&(i=i.filter(a=>!e.equals(a)),i.unshift(e));let s=[];for(let a of i)(await this._resolve(a)).forEach(u=>s.push(u));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw await this.peerStore.delete(r),kv(new Error("dial with more addresses than allowed"),K3.ERR_TOO_MANY_ADDRESSES);return{id:r.toB58String(),addrs:o}}_createPendingDial(e,r={}){let n=(u,l)=>{if(l.signal.aborted)throw kv(new Error("already aborted"),K3.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,l)},i=new Bst({addrs:e.addrs,dialAction:n,dialer:this}),s=new kst(this.timeout),o=[s.signal];r.signal&&o.push(r.signal);let a=Nst(o);try{Z5e&&Z5e(1/0,a)}catch{}let c={dialRequest:i,controller:s,promise:i.run({...r,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let r=Math.min(e,this.maxDialsPerPeer,this.tokens.length),n=this.tokens.splice(0,r);return Iy("%d tokens request, returning %d, %d remaining",e,r,this.tokens.length),n}releaseToken(e){this.tokens.indexOf(e)>-1||(Iy("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let n=await this._resolveRecord(e);return(await Promise.all(n.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new lk(e.toString()),await e.resolve()}catch{return Iy.error(`multiaddr ${e} could not be resolved`),[]}}};nwe.exports=rwe});var owe=g((Uqt,swe)=>{"use strict";function Vst(t){return t>=55296&&t<=56319}function zst(t){return t>=56320&&t<=57343}swe.exports=function(e,r,n){if(typeof r!="string")throw new Error("Input must be string");for(var i=r.length,s=0,o,a,c=0;c<i;c+=1){if(o=r.charCodeAt(c),a=r[c],Vst(o)&&zst(r.charCodeAt(c+1))&&(c+=1,a+=r[c]),s+=e(a),s===n)return r.slice(0,c+1);if(s>n)return r.slice(0,c-a.length+1)}return r}});var cwe=g((qqt,awe)=>{"use strict";function Hst(t){return t>=55296&&t<=56319}function $st(t){return t>=56320&&t<=57343}awe.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,n=0,i=null,s=null,o=0;o<r;o++)i=e.charCodeAt(o),$st(i)?s!=null&&Hst(s)?n+=1:n+=3:i<=127?n+=1:i>=128&&i<=2047?n+=2:i>=2048&&i<=65535&&(n+=3),s=i;return n}});var lwe=g((Fqt,uwe)=>{"use strict";var Gst=owe(),Wst=cwe();uwe.exports=Gst.bind(null,Wst)});var dwe=g((Kqt,hwe)=>{"use strict";var Yst=lwe(),Xst=/[\/\?<>\\:\*\|"]/g,Qst=/[\x00-\x1f\x80-\x9f]/g,Zst=/^\.+$/,Jst=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,eot=/[\. ]+$/;function fwe(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(Xst,e).replace(Qst,e).replace(Zst,e).replace(Jst,e).replace(eot,e);return Yst(r,255)}hwe.exports=function(t,e){var r=e&&e.replacement||"",n=fwe(t,r);return r===""?n:fwe(n,"")}});var mwe=g((jqt,gwe)=>{var Ty=Pt();wl();Tr();var Le=Ty.asn1,xy=gwe.exports=Ty.pkcs7asn1=Ty.pkcs7asn1||{};Ty.pkcs7=Ty.pkcs7||{};Ty.pkcs7.asn1=xy;var pwe={name:"ContentInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};xy.contentInfoValidator=pwe;var ywe={name:"EncryptedContentInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Le.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};xy.envelopedDataValidator={name:"EnvelopedData",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(ywe)};xy.encryptedDataValidator={name:"EncryptedData",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"}].concat(ywe)};var tot={name:"SignerInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Le.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Le.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};xy.signedDataValidator={name:"SignedData",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},pwe,{name:"SignedData.Certificates",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Le.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SET,capture:"signerInfos",optional:!0,value:[tot]}]};xy.recipientInfoValidator={name:"RecipientInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Le.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var bwe=g((Vqt,wwe)=>{var Vd=Pt();Tr();Vd.mgf=Vd.mgf||{};var rot=wwe.exports=Vd.mgf.mgf1=Vd.mgf1=Vd.mgf1||{};rot.create=function(t){var e={generate:function(r,n){for(var i=new Vd.util.ByteBuffer,s=Math.ceil(n/t.digestLength),o=0;o<s;o++){var a=new Vd.util.ByteBuffer;a.putInt32(o),t.start(),t.update(r+a.getBytes()),i.putBuffer(t.digest())}return i.truncate(i.length()-n),i.getBytes()}};return e}});var vwe=g((zqt,_we)=>{var Dv=Pt();bwe();_we.exports=Dv.mgf=Dv.mgf||{};Dv.mgf.mgf1=Dv.mgf1});var Swe=g((Hqt,Ewe)=>{var zd=Pt();ih();Tr();var not=Ewe.exports=zd.pss=zd.pss||{};not.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,n=e.digestLength,i=t.salt||null;typeof i=="string"&&(i=zd.util.createBuffer(i));var s;if("saltLength"in t)s=t.saltLength;else if(i!==null)s=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=t.prng||zd.random,a={};return a.encode=function(c,u){var l,f=u-1,h=Math.ceil(f/8),d=c.digest().getBytes();if(h<n+s+2)throw new Error("Message is too long to encrypt.");var p;i===null?p=o.getBytesSync(s):p=i.bytes();var y=new zd.util.ByteBuffer;y.fillWithByte(0,8),y.putBytes(d),y.putBytes(p),e.start(),e.update(y.getBytes());var b=e.digest().getBytes(),m=new zd.util.ByteBuffer;m.fillWithByte(0,h-s-n-2),m.putByte(1),m.putBytes(p);var _=m.getBytes(),R=h-n-1,k=r.generate(b,R),P="";for(l=0;l<R;l++)P+=String.fromCharCode(_.charCodeAt(l)^k.charCodeAt(l));var x=65280>>8*h-f&255;return P=String.fromCharCode(P.charCodeAt(0)&~x)+P.substr(1),P+b+String.fromCharCode(188)},a.verify=function(c,u,l){var f,h=l-1,d=Math.ceil(h/8);if(u=u.substr(-d),d<n+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(d-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var p=d-n-1,y=u.substr(0,p),b=u.substr(p,n),m=65280>>8*d-h&255;if((y.charCodeAt(0)&m)!==0)throw new Error("Bits beyond keysize not zero as expected.");var _=r.generate(b,p),R="";for(f=0;f<p;f++)R+=String.fromCharCode(y.charCodeAt(f)^_.charCodeAt(f));R=String.fromCharCode(R.charCodeAt(0)&~m)+R.substr(1);var k=d-n-s-2;for(f=0;f<k;f++)if(R.charCodeAt(f)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(k)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var P=R.substr(-s),x=new zd.util.ByteBuffer;x.fillWithByte(0,8),x.putBytes(c),x.putBytes(P),e.start(),e.update(x.getBytes());var D=e.digest().getBytes();return b===D},a}});var hk=g(($qt,xwe)=>{var it=Pt();Hp();wl();P6();bl();vwe();jp();D6();Swe();N2();Tr();var S=it.asn1,Re=xwe.exports=it.pki=it.pki||{},Yt=Re.oids,pn={};pn.CN=Yt.commonName;pn.commonName="CN";pn.C=Yt.countryName;pn.countryName="C";pn.L=Yt.localityName;pn.localityName="L";pn.ST=Yt.stateOrProvinceName;pn.stateOrProvinceName="ST";pn.O=Yt.organizationName;pn.organizationName="O";pn.OU=Yt.organizationalUnitName;pn.organizationalUnitName="OU";pn.E=Yt.emailAddress;pn.emailAddress="E";var Rwe=it.pki.rsa.publicKeyValidator,iot={name:"Certificate",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:S.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:S.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:S.Class.UNIVERSAL,type:S.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:S.Class.UNIVERSAL,type:S.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:S.Class.UNIVERSAL,type:S.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:S.Class.UNIVERSAL,type:S.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},Rwe,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:S.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:S.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:S.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:S.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},sot={name:"rsapss",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:S.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:S.Class.UNIVERSAL,type:S.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:S.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:S.Class.UNIVERSAL,type:S.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:S.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:S.Class.UNIVERSAL,type:S.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:S.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:S.Class.UNIVERSAL,type:S.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},oot={name:"CertificationRequestInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},Rwe,{name:"CertificationRequestInfo.attributes",tagClass:S.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:S.Class.UNIVERSAL,type:S.Type.SET,constructed:!0}]}]}]},aot={name:"CertificationRequest",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[oot,{name:"CertificationRequest.signatureAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:S.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Re.RDNAttributesAsArray=function(t,e){for(var r=[],n,i,s,o=0;o<t.value.length;++o){n=t.value[o];for(var a=0;a<n.value.length;++a)s={},i=n.value[a],s.type=S.derToOid(i.value[0].value),s.value=i.value[1].value,s.valueTagClass=i.value[1].type,s.type in Yt&&(s.name=Yt[s.type],s.name in pn&&(s.shortName=pn[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};Re.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var n=t[r],i=S.derToOid(n.value[0].value),s=n.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=i,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in Yt&&(a.name=Yt[a.type],a.name in pn&&(a.shortName=pn[a.name])),a.type===Yt.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(Re.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function Mf(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,n,i=0;r===null&&i<t.attributes.length;++i)n=t.attributes[i],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}var Nv=function(t,e,r){var n={};if(t!==Yt["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:Yt.sha1},mgf:{algorithmOid:Yt.mgf1,hash:{algorithmOid:Yt.sha1}},saltLength:20});var i={},s=[];if(!S.validate(e,sot,i,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return i.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=S.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=S.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=S.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(n.saltLength=i.saltLength.charCodeAt(0)),n},Bv=function(t){switch(Yt[t.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return it.md.sha1.create();case"md5WithRSAEncryption":return it.md.md5.create();case"sha256WithRSAEncryption":return it.md.sha256.create();case"sha384WithRSAEncryption":return it.md.sha384.create();case"sha512WithRSAEncryption":return it.md.sha512.create();case"RSASSA-PSS":return it.md.sha256.create();default:var e=new Error("Could not compute "+t.type+" digest. Unknown signature OID.");throw e.signatureOid=t.signatureOid,e}},Iwe=function(t){var e=t.certificate,r;switch(e.signatureOid){case Yt.sha1WithRSAEncryption:case Yt.sha1WithRSASignature:break;case Yt["RSASSA-PSS"]:var n,i;if(n=Yt[e.signatureParameters.mgf.hash.algorithmOid],n===void 0||it.md[n]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=n,s}if(i=Yt[e.signatureParameters.mgf.algorithmOid],i===void 0||it.mgf[i]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=i,s}if(i=it.mgf[i].create(it.md[n].create()),n=Yt[e.signatureParameters.hash.algorithmOid],n===void 0||it.md[n]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=e.signatureParameters.hash.algorithmOid,s.name=n,s}r=it.pss.create(it.md[n].create(),i,e.signatureParameters.saltLength);break}return e.publicKey.verify(t.md.digest().getBytes(),t.signature,r)};Re.certificateFromPem=function(t,e,r){var n=it.pem.decode(t)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=S.fromDer(n.body,r);return Re.certificateFromAsn1(s,e)};Re.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:S.toDer(Re.certificateToAsn1(t)).getBytes()};return it.pem.encode(r,{maxline:e})};Re.publicKeyFromPem=function(t){var e=it.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=S.fromDer(e.body);return Re.publicKeyFromAsn1(n)};Re.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:S.toDer(Re.publicKeyToAsn1(t)).getBytes()};return it.pem.encode(r,{maxline:e})};Re.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:S.toDer(Re.publicKeyToRSAPublicKey(t)).getBytes()};return it.pem.encode(r,{maxline:e})};Re.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||it.md.sha1.create(),n=e.type||"RSAPublicKey",i;switch(n){case"RSAPublicKey":i=S.toDer(Re.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":i=S.toDer(Re.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(i);var s=r.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};Re.certificationRequestFromPem=function(t,e,r){var n=it.pem.decode(t)[0];if(n.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=S.fromDer(n.body,r);return Re.certificationRequestFromAsn1(s,e)};Re.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:S.toDer(Re.certificationRequestToAsn1(t)).getBytes()};return it.pem.encode(r,{maxline:e})};Re.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return Mf(t.issuer,e)},t.issuer.addField=function(e){Ko([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return Mf(t.subject,e)},t.subject.addField=function(e){Ko([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){Ko(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){Ko(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)Twe(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,n,i=0;r===null&&i<t.extensions.length;++i)n=t.extensions[i],(e.id&&n.id===e.id||e.name&&n.name===e.name)&&(r=n);return r},t.sign=function(e,r){t.md=r||it.md.sha1.create();var n=Yt[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.tbsCertificate=Re.getTBSCertificate(t);var s=S.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var n=e.issuer,i=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var o=e.md;if(o===null){o=Bv({signatureOid:e.signatureOid,type:"certificate"});var a=e.tbsCertificate||Re.getTBSCertificate(e),c=S.toDer(a);o.update(c.getBytes())}return o!==null&&(r=Iwe({certificate:t,md:o,signature:e.signature})),r},t.isIssuer=function(e){var r=!1,n=t.issuer,i=e.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){r=!0;for(var s,o,a=0;r&&a<n.attributes.length;++a)s=n.attributes[a],o=i.attributes[a],(s.type!==o.type||s.value!==o.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return Re.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=Yt.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var n=t.extensions[r];if(n.id===e){var i=t.generateSubjectKeyIdentifier().getBytes();return it.util.hexToBytes(n.subjectKeyIdentifier)===i}}return!1},t};Re.certificateFromAsn1=function(t,e){var r={},n=[];if(!S.validate(t,iot,r,n)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=n,i}var s=S.derToOid(r.publicKeyOid);if(s!==Re.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Re.createCertificate();o.version=r.certVersion?r.certVersion.charCodeAt(0):0;var a=it.util.createBuffer(r.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=it.asn1.derToOid(r.certSignatureOid),o.signatureParameters=Nv(o.signatureOid,r.certSignatureParams,!0),o.siginfo.algorithmOid=it.asn1.derToOid(r.certinfoSignatureOid),o.siginfo.parameters=Nv(o.siginfo.algorithmOid,r.certinfoSignatureParams,!1),o.signature=r.certSignature;var c=[];if(r.certValidity1UTCTime!==void 0&&c.push(S.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&c.push(S.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&c.push(S.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&c.push(S.generalizedTimeToDate(r.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=r.tbsCertificate,e){o.md=Bv({signatureOid:o.signatureOid,type:"certificate"});var u=S.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var l=it.md.sha1.create(),f=S.toDer(r.certIssuer);l.update(f.getBytes()),o.issuer.getField=function(p){return Mf(o.issuer,p)},o.issuer.addField=function(p){Ko([p]),o.issuer.attributes.push(p)},o.issuer.attributes=Re.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(o.issuer.uniqueId=r.certIssuerUniqueId),o.issuer.hash=l.digest().toHex();var h=it.md.sha1.create(),d=S.toDer(r.certSubject);return h.update(d.getBytes()),o.subject.getField=function(p){return Mf(o.subject,p)},o.subject.addField=function(p){Ko([p]),o.subject.attributes.push(p)},o.subject.attributes=Re.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(o.subject.uniqueId=r.certSubjectUniqueId),o.subject.hash=h.digest().toHex(),r.certExtensions?o.extensions=Re.certificateExtensionsFromAsn1(r.certExtensions):o.extensions=[],o.publicKey=Re.publicKeyFromAsn1(r.subjectPublicKeyInfo),o};Re.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var n=t.value[r],i=0;i<n.value.length;++i)e.push(Re.certificateExtensionFromAsn1(n.value[i]));return e};Re.certificateExtensionFromAsn1=function(t){var e={};if(e.id=S.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===S.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in Yt){if(e.name=Yt[e.id],e.name==="keyUsage"){var r=S.fromDer(e.value),n=0,i=0;r.value.length>1&&(n=r.value.charCodeAt(1),i=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(n&128)===128,e.nonRepudiation=(n&64)===64,e.keyEncipherment=(n&32)===32,e.dataEncipherment=(n&16)===16,e.keyAgreement=(n&8)===8,e.keyCertSign=(n&4)===4,e.cRLSign=(n&2)===2,e.encipherOnly=(n&1)===1,e.decipherOnly=(i&128)===128}else if(e.name==="basicConstraints"){var r=S.fromDer(e.value);r.value.length>0&&r.value[0].type===S.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===S.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=S.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=S.fromDer(e.value),o=0;o<r.value.length;++o){var a=S.derToOid(r.value[o].value);a in Yt?e[Yt[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var r=S.fromDer(e.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),e.client=(n&128)===128,e.server=(n&64)===64,e.email=(n&32)===32,e.objsign=(n&16)===16,e.reserved=(n&8)===8,e.sslCA=(n&4)===4,e.emailCA=(n&2)===2,e.objCA=(n&1)===1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,r=S.fromDer(e.value),u=0;u<r.value.length;++u){c=r.value[u];var l={type:c.type,value:c.value};switch(e.altNames.push(l),c.type){case 1:case 2:case 6:break;case 7:l.ip=it.util.bytesToIP(c.value);break;case 8:l.oid=S.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=S.fromDer(e.value);e.subjectKeyIdentifier=it.util.bytesToHex(r.value)}}return e};Re.certificationRequestFromAsn1=function(t,e){var r={},n=[];if(!S.validate(t,aot,r,n)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=n,i}var s=S.derToOid(r.publicKeyOid);if(s!==Re.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Re.createCertificationRequest();if(o.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,o.signatureOid=it.asn1.derToOid(r.csrSignatureOid),o.signatureParameters=Nv(o.signatureOid,r.csrSignatureParams,!0),o.siginfo.algorithmOid=it.asn1.derToOid(r.csrSignatureOid),o.siginfo.parameters=Nv(o.siginfo.algorithmOid,r.csrSignatureParams,!1),o.signature=r.csrSignature,o.certificationRequestInfo=r.certificationRequestInfo,e){o.md=Bv({signatureOid:o.signatureOid,type:"certification request"});var a=S.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=it.md.sha1.create();return o.subject.getField=function(u){return Mf(o.subject,u)},o.subject.addField=function(u){Ko([u]),o.subject.attributes.push(u)},o.subject.attributes=Re.RDNAttributesAsArray(r.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=Re.publicKeyFromAsn1(r.subjectPublicKeyInfo),o.getAttribute=function(u){return Mf(o,u)},o.addAttribute=function(u){Ko([u]),o.attributes.push(u)},o.attributes=Re.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),o};Re.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return Mf(t.subject,e)},t.subject.addField=function(e){Ko([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return Mf(t,e)},t.addAttribute=function(e){Ko([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){Ko(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){Ko(e),t.attributes=e},t.sign=function(e,r){t.md=r||it.md.sha1.create();var n=Yt[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.certificationRequestInfo=Re.getCertificationRequestInfo(t);var s=S.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){r=Bv({signatureOid:t.signatureOid,type:"certification request"});var n=t.certificationRequestInfo||Re.getCertificationRequestInfo(t),i=S.toDer(n);r.update(i.getBytes())}return r!==null&&(e=Iwe({certificate:t,md:r,signature:t.signature})),e},t};function Py(t){for(var e=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),r,n,i=t.attributes,s=0;s<i.length;++s){r=i[s];var o=r.value,a=S.Type.PRINTABLESTRING;"valueTagClass"in r&&(a=r.valueTagClass,a===S.Type.UTF8&&(o=it.util.encodeUtf8(o))),n=S.create(S.Class.UNIVERSAL,S.Type.SET,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(r.type).getBytes()),S.create(S.Class.UNIVERSAL,a,!1,o)])]),e.value.push(n)}return e}function Ko(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name>"u"&&(e.type&&e.type in Re.oids?e.name=Re.oids[e.type]:e.shortName&&e.shortName in pn&&(e.name=Re.oids[pn[e.shortName]])),typeof e.type>"u")if(e.name&&e.name in Re.oids)e.type=Re.oids[e.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=e,n}if(typeof e.shortName>"u"&&e.name&&e.name in pn&&(e.shortName=pn[e.name]),e.type===Yt.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=S.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var i=0;i<e.extensions.length;++i)e.value.push(Re.certificateExtensionToAsn1(Twe(e.extensions[i])))}if(typeof e.value>"u"){var n=new Error("Attribute value not specified.");throw n.attribute=e,n}}}function Twe(t,e){if(e=e||{},typeof t.name>"u"&&t.id&&t.id in Re.oids&&(t.name=Re.oids[t.id]),typeof t.id>"u")if(t.name&&t.name in Re.oids)t.id=Re.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value<"u")return t;if(t.name==="keyUsage"){var n=0,i=0,s=0;t.digitalSignature&&(i|=128,n=7),t.nonRepudiation&&(i|=64,n=6),t.keyEncipherment&&(i|=32,n=5),t.dataEncipherment&&(i|=16,n=4),t.keyAgreement&&(i|=8,n=3),t.keyCertSign&&(i|=4,n=2),t.cRLSign&&(i|=2,n=1),t.encipherOnly&&(i|=1,n=0),t.decipherOnly&&(s|=128,n=7);var o=String.fromCharCode(n);s!==0?o+=String.fromCharCode(i)+String.fromCharCode(s):i!==0&&(o+=String.fromCharCode(i)),t.value=S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,o)}else if(t.name==="basicConstraints")t.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(S.create(S.Class.UNIVERSAL,S.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);var a=t.value.value;for(var c in t)t[c]===!0&&(c in Yt?a.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Yt[c]).getBytes())):c.indexOf(".")!==-1&&a.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(c).getBytes())))}else if(t.name==="nsCertType"){var n=0,i=0;t.client&&(i|=128,n=7),t.server&&(i|=64,n=6),t.email&&(i|=32,n=5),t.objsign&&(i|=16,n=4),t.reserved&&(i|=8,n=3),t.sslCA&&(i|=4,n=2),t.emailCA&&(i|=2,n=1),t.objCA&&(i|=1,n=0);var o=String.fromCharCode(n);i!==0&&(o+=String.fromCharCode(i)),t.value=S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,o)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);for(var u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=it.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=S.oidToDer(S.oidToDer(u.oid)):o=S.oidToDer(o));t.value.value.push(S.create(S.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=S.create(S.Class.UNIVERSAL,S.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var f=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=f.toHex(),t.value=S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,f.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);var a=t.value.value;if(t.keyIdentifier){var h=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;a.push(S.create(S.Class.CONTEXT_SPECIFIC,0,!1,h))}if(t.authorityCertIssuer){var d=[S.create(S.Class.CONTEXT_SPECIFIC,4,!0,[Py(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];a.push(S.create(S.Class.CONTEXT_SPECIFIC,1,!0,d))}if(t.serialNumber){var p=it.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);a.push(S.create(S.Class.CONTEXT_SPECIFIC,2,!1,p))}}else if(t.name==="cRLDistributionPoints"){t.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);for(var a=t.value.value,y=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),b=S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[]),u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=it.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=S.oidToDer(S.oidToDer(u.oid)):o=S.oidToDer(o));b.value.push(S.create(S.Class.CONTEXT_SPECIFIC,u.type,!1,o))}y.value.push(S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[b])),a.push(y)}if(typeof t.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function fk(t,e){switch(t){case Yt["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(e.hash.algorithmOid).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(S.create(S.Class.CONTEXT_SPECIFIC,1,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(e.mgf.algorithmOid).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(e.mgf.hash.algorithmOid).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(S.create(S.Class.CONTEXT_SPECIFIC,2,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(e.saltLength).getBytes())])),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,r);default:return S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")}}function cot(t){var e=S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,n=0;n<r.length;++n){var i=r[n],s=i.value,o=S.Type.UTF8;"valueTagClass"in i&&(o=i.valueTagClass),o===S.Type.UTF8&&(s=it.util.encodeUtf8(s));var a=!1;"valueConstructed"in i&&(a=i.valueConstructed);var c=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(i.type).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SET,!0,[S.create(S.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var uot=new Date("1950-01-01T00:00:00Z"),lot=new Date("2050-01-01T00:00:00Z");function Awe(t){return t>=uot&&t<lot?S.create(S.Class.UNIVERSAL,S.Type.UTCTIME,!1,S.dateToUtcTime(t)):S.create(S.Class.UNIVERSAL,S.Type.GENERALIZEDTIME,!1,S.dateToGeneralizedTime(t))}Re.getTBSCertificate=function(t){var e=Awe(t.validity.notBefore),r=Awe(t.validity.notAfter),n=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(t.version).getBytes())]),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,it.util.hexToBytes(t.serialNumber)),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(t.siginfo.algorithmOid).getBytes()),fk(t.siginfo.algorithmOid,t.siginfo.parameters)]),Py(t.issuer),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[e,r]),Py(t.subject),Re.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(S.create(S.Class.CONTEXT_SPECIFIC,1,!0,[S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(S.create(S.Class.CONTEXT_SPECIFIC,2,!0,[S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(Re.certificateExtensionsToAsn1(t.extensions)),n};Re.getCertificationRequestInfo=function(t){var e=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(t.version).getBytes()),Py(t.subject),Re.publicKeyToAsn1(t.publicKey),cot(t)]);return e};Re.distinguishedNameToAsn1=function(t){return Py(t)};Re.certificateToAsn1=function(t){var e=t.tbsCertificate||Re.getTBSCertificate(t);return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[e,S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(t.signatureOid).getBytes()),fk(t.signatureOid,t.signatureParameters)]),S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};Re.certificateExtensionsToAsn1=function(t){var e=S.create(S.Class.CONTEXT_SPECIFIC,3,!0,[]),r=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);e.value.push(r);for(var n=0;n<t.length;++n)r.value.push(Re.certificateExtensionToAsn1(t[n]));return e};Re.certificateExtensionToAsn1=function(t){var e=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);e.value.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(t.id).getBytes())),t.critical&&e.value.push(S.create(S.Class.UNIVERSAL,S.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=t.value;return typeof t.value!="string"&&(r=S.toDer(r).getBytes()),e.value.push(S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,r)),e};Re.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||Re.getCertificationRequestInfo(t);return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[e,S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(t.signatureOid).getBytes()),fk(t.signatureOid,t.signatureParameters)]),S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};Re.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(o){var a=r(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=it.pki.certificateFromPem(o)),n(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];it.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=it.pki.certificateFromPem(o));var a=r(o.subject);if(!a)return!1;it.util.isArray(a)||(a=[a]);for(var c=S.toDer(Re.certificateToAsn1(o)).getBytes(),u=0;u<a.length;++u){var l=S.toDer(Re.certificateToAsn1(a[u])).getBytes();if(c===l)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!it.util.isArray(c))o.push(c);else for(var u=0;u<c.length;++u)o.push(c[u])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=it.pki.certificateFromPem(o)),n(o.subject),!e.hasCertificate(o))return null;var c=r(o.subject);if(!it.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var u=S.toDer(Re.certificateToAsn1(o)).getBytes(),l=0;l<c.length;++l){var f=S.toDer(Re.certificateToAsn1(c[l])).getBytes();u===f&&(a=c[l],c.splice(l,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function r(o){return n(o),e.certs[o.hash]||null}function n(o){if(!o.hash){var a=it.md.sha1.create();o.attributes=Re.RDNAttributesAsArray(Py(o),a),o.hash=a.digest().toHex()}}if(t)for(var i=0;i<t.length;++i){var s=t[i];e.addCertificate(s)}return e};Re.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Re.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var n=e.slice(0),i=r.validityCheckDate;typeof i>"u"&&(i=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),u=null,l=!1;if(i&&(i<c.validity.notBefore||i>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:Re.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:i}),o===null){if(u=e[0]||t.getIssuer(c),u===null&&c.isIssuer(c)&&(l=!0,u=c),u){var f=u;it.util.isArray(f)||(f=[f]);for(var h=!1;!h&&f.length>0;){u=f.shift();try{h=u.verify(c)}catch{}}h||(o={message:"Certificate signature is invalid.",error:Re.certificateError.bad_certificate})}o===null&&(!u||l)&&!t.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:Re.certificateError.unknown_ca})}if(o===null&&u&&!c.isIssuer(u)&&(o={message:"Certificate issuer is invalid.",error:Re.certificateError.bad_certificate}),o===null)for(var d={keyUsage:!0,basicConstraints:!0},p=0;o===null&&p<c.extensions.length;++p){var y=c.extensions[p];y.critical&&!(y.name in d)&&(o={message:"Certificate has an unsupported critical extension.",error:Re.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!u||l))){var b=c.getExtension("basicConstraints"),m=c.getExtension("keyUsage");if(m!==null&&(!m.keyCertSign||b===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Re.certificateError.bad_certificate}),o===null&&b!==null&&!b.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Re.certificateError.bad_certificate}),o===null&&m!==null&&"pathLenConstraint"in b){var _=a-1;_>b.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:Re.certificateError.bad_certificate})}}var R=o===null?!0:o.error,k=r.verify?r.verify(R,a,n):R;if(k===!0)o=null;else throw R===!0&&(o={message:"The application rejected the certificate.",error:Re.certificateError.bad_certificate}),(k||k===0)&&(typeof k=="object"&&!it.util.isArray(k)?(k.message&&(o.message=k.message),k.error&&(o.error=k.error)):typeof k=="string"&&(o.error=k)),o;s=!1,++a}while(e.length>0);return!0}});var Owe=g((Gqt,Cwe)=>{var ke=Pt();Hp();wl();P6();jp();D6();mwe();ih();Tr();hk();var F=ke.asn1,Zi=Cwe.exports=ke.pkcs7=ke.pkcs7||{};Zi.messageFromPem=function(t){var e=ke.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=F.fromDer(e.body);return Zi.messageFromAsn1(n)};Zi.messageToPem=function(t,e){var r={type:"PKCS7",body:F.toDer(t.toAsn1()).getBytes()};return ke.pem.encode(r,{maxline:e})};Zi.messageFromAsn1=function(t){var e={},r=[];if(!F.validate(t,Zi.asn1.contentInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var i=F.derToOid(e.contentType),s;switch(i){case ke.pki.oids.envelopedData:s=Zi.createEnvelopedData();break;case ke.pki.oids.encryptedData:s=Zi.createEncryptedData();break;case ke.pki.oids.signedData:s=Zi.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Zi.createSignedData=function(){var t=null;return t={type:ke.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(pk(t,n,Zi.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var i=t.rawCapture.certificates.value,s=0;s<i.length;++s)t.certificates.push(ke.pki.certificateFromAsn1(i[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var n=[],i=0;i<t.certificates.length;++i)n.push(ke.pki.certificateToAsn1(t.certificates[i]));var s=[],o=F.create(F.Class.CONTEXT_SPECIFIC,0,!0,[F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,F.integerToDer(t.version).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return n.length>0&&o.value[0].value.push(F.create(F.Class.CONTEXT_SPECIFIC,0,!0,n)),s.length>0&&o.value[0].value.push(F.create(F.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(F.create(F.Class.UNIVERSAL,F.Type.SET,!0,t.signerInfos)),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(t.type).getBytes()),o])},addSigner:function(n){var i=n.issuer,s=n.serialNumber;if(n.certificate){var o=n.certificate;typeof o=="string"&&(o=ke.pki.certificateFromPem(o)),i=o.issuer.attributes,s=o.serialNumber}var a=n.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=ke.pki.privateKeyFromPem(a));var c=n.digestAlgorithm||ke.pki.oids.sha1;switch(c){case ke.pki.oids.sha1:case ke.pki.oids.sha256:case ke.pki.oids.sha384:case ke.pki.oids.sha512:case ke.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=n.authenticatedAttributes||[];if(u.length>0){for(var l=!1,f=!1,h=0;h<u.length;++h){var d=u[h];if(!l&&d.type===ke.pki.oids.contentType){if(l=!0,f)break;continue}if(!f&&d.type===ke.pki.oids.messageDigest){if(f=!0,l)break;continue}}if(!l||!f)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:a,version:1,issuer:i,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:ke.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(ke.pki.oids.data).getBytes())]),"content"in t)){var i;t.content instanceof ke.util.ByteBuffer?i=t.content.bytes():typeof t.content=="string"&&(i=ke.util.encodeUtf8(t.content)),n.detached?t.detachedContent=F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,i):t.contentInfo.value.push(F.create(F.Class.CONTEXT_SPECIFIC,0,!0,[F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,i)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=ke.pki.certificateFromPem(n)),t.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var n={},i=0;i<t.signers.length;++i){var s=t.signers[i],o=s.digestAlgorithm;o in n||(n[o]=ke.md[ke.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=n[o]:s.md=ke.md[ke.pki.oids[o]].create()}t.digestAlgorithmIdentifiers=[];for(var o in n)t.digestAlgorithmIdentifiers.push(F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(o).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.NULL,!1,"")]));return n}function r(n){var i;if(t.detachedContent?i=t.detachedContent:(i=t.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=F.derToOid(t.contentInfo.value[0].value),o=F.toDer(i);o.getByte(),F.getBerValueLength(o),o=o.getBytes();for(var a in n)n[a].start().update(o);for(var c=new Date,u=0;u<t.signers.length;++u){var l=t.signers[u];if(l.authenticatedAttributes.length===0){if(s!==ke.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=F.create(F.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=F.create(F.Class.UNIVERSAL,F.Type.SET,!0,[]),h=0;h<l.authenticatedAttributes.length;++h){var d=l.authenticatedAttributes[h];d.type===ke.pki.oids.messageDigest?d.value=n[l.digestAlgorithm].digest():d.type===ke.pki.oids.signingTime&&(d.value||(d.value=c)),f.value.push(dk(d)),l.authenticatedAttributesAsn1.value.push(dk(d))}o=F.toDer(f).getBytes(),l.md.start().update(o)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=got(t.signers)}};Zi.createEncryptedData=function(){var t=null;return t={type:ke.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:ke.pki.oids["aes256-CBC"]},fromAsn1:function(e){pk(t,e,Zi.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),Pwe(t)}},t};Zi.createEnvelopedData=function(){var t=null;return t={type:ke.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:ke.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=pk(t,e,Zi.asn1.envelopedDataValidator);t.recipients=dot(r.recipientInfos.value)},toAsn1:function(){return F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(t.type).getBytes()),F.create(F.Class.CONTEXT_SPECIFIC,0,!0,[F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,F.integerToDer(t.version).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SET,!0,pot(t.recipients)),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,mot(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var i=t.recipients[n],s=i.issuer;if(i.serialNumber===e.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return i}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case ke.pki.oids.rsaEncryption:case ke.pki.oids.desCBC:var n=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=ke.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}Pwe(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:ke.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var n,i,s;switch(r){case ke.pki.oids["aes128-CBC"]:n=16,i=16,s=ke.aes.createEncryptionCipher;break;case ke.pki.oids["aes192-CBC"]:n=24,i=16,s=ke.aes.createEncryptionCipher;break;case ke.pki.oids["aes256-CBC"]:n=32,i=16,s=ke.aes.createEncryptionCipher;break;case ke.pki.oids["des-EDE3-CBC"]:n=24,i=8,s=ke.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=ke.util.createBuffer(ke.random.getBytes(n));else if(e.length()!=n)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+n+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=ke.util.createBuffer(ke.random.getBytes(i));var o=s(e);if(o.start(t.encryptedContent.parameter.copy()),o.update(t.content),!o.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=o.output}for(var a=0;a<t.recipients.length;++a){var c=t.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case ke.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},t};function fot(t){var e={},r=[];if(!F.validate(t,Zi.asn1.recipientInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:e.version.charCodeAt(0),issuer:ke.pki.RDNAttributesAsArray(e.issuer),serialNumber:ke.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:F.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function hot(t){return F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,F.integerToDer(t.version).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[ke.pki.distinguishedNameToAsn1({attributes:t.issuer}),F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,ke.util.hexToBytes(t.serialNumber))]),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(t.encryptedContent.algorithm).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.NULL,!1,"")]),F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function dot(t){for(var e=[],r=0;r<t.length;++r)e.push(fot(t[r]));return e}function pot(t){for(var e=[],r=0;r<t.length;++r)e.push(hot(t[r]));return e}function yot(t){var e=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,F.integerToDer(t.version).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[ke.pki.distinguishedNameToAsn1({attributes:t.issuer}),F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,ke.util.hexToBytes(t.serialNumber))]),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(t.digestAlgorithm).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(t.signatureAlgorithm).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.NULL,!1,"")])),e.value.push(F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=F.create(F.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<t.unauthenticatedAttributes.length;++n){var i=t.unauthenticatedAttributes[n];r.values.push(dk(i))}e.value.push(r)}return e}function got(t){for(var e=[],r=0;r<t.length;++r)e.push(yot(t[r]));return e}function dk(t){var e;if(t.type===ke.pki.oids.contentType)e=F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(t.value).getBytes());else if(t.type===ke.pki.oids.messageDigest)e=F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===ke.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=t.value;if(typeof i=="string"){var s=Date.parse(i);isNaN(s)?i.length===13?i=F.utcTimeToDate(i):i=F.generalizedTimeToDate(i):i=new Date(s)}i>=r&&i<n?e=F.create(F.Class.UNIVERSAL,F.Type.UTCTIME,!1,F.dateToUtcTime(i)):e=F.create(F.Class.UNIVERSAL,F.Type.GENERALIZEDTIME,!1,F.dateToGeneralizedTime(i))}return F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(t.type).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SET,!0,[e])])}function mot(t){return[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(ke.pki.oids.data).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(t.algorithm).getBytes()),t.parameter?F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),F.create(F.Class.CONTEXT_SPECIFIC,0,!0,[F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,t.content.getBytes())])]}function pk(t,e,r){var n={},i=[];if(!F.validate(e,r,n,i)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=F.derToOid(n.contentType);if(o!==ke.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var a="";if(ke.util.isArray(n.encryptedContent))for(var c=0;c<n.encryptedContent.length;++c){if(n.encryptedContent[c].type!==F.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=n.encryptedContent[c].value}else a=n.encryptedContent;t.encryptedContent={algorithm:F.derToOid(n.encAlgorithm),parameter:ke.util.createBuffer(n.encParameter.value),content:ke.util.createBuffer(a)}}if(n.content){var a="";if(ke.util.isArray(n.content))for(var c=0;c<n.content.length;++c){if(n.content[c].type!==F.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=n.content[c].value}else a=n.content;t.content=ke.util.createBuffer(a)}return t.version=n.version.charCodeAt(0),t.rawCapture=n,n}function Pwe(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case ke.pki.oids["aes128-CBC"]:case ke.pki.oids["aes192-CBC"]:case ke.pki.oids["aes256-CBC"]:e=ke.aes.createDecryptionCipher(t.encryptedContent.key);break;case ke.pki.oids.desCBC:case ke.pki.oids["des-EDE3-CBC"]:e=ke.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var Nwe=g((Wqt,Dwe)=>{"use strict";hk();var wot=Pt(),kwe=wot.pki,bot=(t,e)=>{let r=kwe.setRsaPublicKey(e.n,e.e),n=kwe.createCertificate();n.publicKey=r,n.serialNumber="01",n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+10);let i=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:t.id}];return n.setSubject(i),n.setIssuer(i),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(e),n};async function _ot(t,e){let r=t.map(e),i=(await Promise.all(r)).findIndex(s=>s);return t[i]}Dwe.exports={certificateForKey:bot,findAsync:_ot}});var Uwe=g((Yqt,Mwe)=>{"use strict";Owe();q9();var Uf=Pt(),{certificateForKey:vot,findAsync:Eot}=Nwe(),Cy=oe(),{fromString:Bwe}=(dt(),se(nn)),{toString:Sot}=(st(),se(hr)),{codes:Oy}=Rr(),yk=new WeakMap,Lwe=class{constructor(e,r){if(!e)throw Cy(new Error("keychain is required"),Oy.ERR_KEYCHAIN_REQUIRED);this.keychain=e,yk.set(this,{dek:r})}async encrypt(e,r){if(!(r instanceof Uint8Array))throw Cy(new Error("Plain data must be a Uint8Array"),Oy.ERR_INVALID_PARAMETERS);let n=await this.keychain.findKeyByName(e),i=await this.keychain._getPrivateKey(e),s=yk.get(this).dek,o=Uf.pki.decryptRsaPrivateKey(i,s),a=await vot(n,o),c=Uf.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=Uf.util.createBuffer(r),c.encrypt();let u=Uf.asn1.toDer(c.toAsn1()).getBytes();return Bwe(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw Cy(new Error("CMS data is required"),Oy.ERR_INVALID_PARAMETERS);let r;try{let u=Uf.util.createBuffer(Sot(e,"ascii")),l=Uf.asn1.fromDer(u);r=Uf.pkcs7.messageFromAsn1(l)}catch(u){throw Cy(new Error("Invalid CMS: "+u.message),Oy.ERR_INVALID_CMS)}let n=r.recipients.filter(u=>u.issuer.find(l=>l.shortName==="O"&&l.value==="ipfs")).filter(u=>u.issuer.find(l=>l.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(l=>l.shortName==="CN").value})),i=await Eot(n,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch{return!1}return!1});if(!i){let u=n.map(l=>l.keyId);throw Cy(new Error("Decryption needs one of the key(s): "+u.join(", ")),Oy.ERR_MISSING_KEYS,{missingKeys:u})}let s=await this.keychain.findKeyById(i.keyId);if(!s)throw Cy(new Error("No key available to decrypto"),Oy.ERR_NO_KEY);let o=await this.keychain._getPrivateKey(s.name),a=yk.get(this).dek,c=Uf.pki.decryptRsaPrivateKey(o,a);return r.decrypt(i.recipient,c),Bwe(r.content.getBytes(),"ascii")}};Mwe.exports=Lwe});var Hwe=g((Xqt,zwe)=>{"use strict";var qwe=he(),Fwe=Object.assign(qwe("libp2p:keychain"),{error:qwe("libp2p:keychain:err")}),Aot=dwe(),Rot=Wu(),Hd=oc(),{Key:Kwe}=(Vr(),se(Mp)),Iot=Uwe(),Xr=oe(),{codes:Qr}=Rr(),{toString:$d}=(st(),se(hr)),{fromString:Hu}=(dt(),se(nn));V9();var Tot="/pkcs8/",jwe="/info/",qf=new WeakMap,Gd={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},gk={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function $u(t){return!t||typeof t!="string"?!1:t===Aot(t.trim())}async function lr(t){let n=Math.random()*800+200;throw await new Promise(i=>setTimeout(i,n)),t}function Fc(t){return new Kwe(Tot+t)}function Ff(t){return new Kwe(jwe+t)}var Vwe=class{constructor(e,r){if(!e)throw new Error("store is required");if(this.store=e,this.opts=Rot(gk,r),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<Gd.minKeyLength)throw new Error(`dek.keyLength must be least ${Gd.minKeyLength} bytes`);if(this.opts.dek.salt.length<Gd.minSaltLength)throw new Error(`dek.saltLength must be least ${Gd.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Gd.minIterationCount)throw new Error(`dek.iterationCount must be least ${Gd.minIterationCount}`);let n=this.opts.pass?Hd.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";qf.set(this,{dek:n})}get cms(){return new Iot(this,qf.get(this).dek)}static generateOptions(){let e=Object.assign({},gk),r=Math.ceil(Gd.minSaltLength/3)*3;return e.dek.salt=$d(Hd.randomBytes(r),"base64"),e}static get options(){return gk}async createKey(e,r,n=2048){let i=this;if(!$u(e)||e==="self")return lr(Xr(new Error(`Invalid key name '${e}'`),Qr.ERR_INVALID_KEY_NAME));if(typeof r!="string")return lr(Xr(new Error(`Invalid key type '${r}'`),Qr.ERR_INVALID_KEY_TYPE));let s=Fc(e);if(await i.store.has(s))return lr(Xr(new Error(`Key '${e}' already exists`),Qr.ERR_KEY_ALREADY_EXISTS));switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(n)||n<2048)return lr(Xr(new Error(`Invalid RSA key size ${n}`),Qr.ERR_INVALID_KEY_SIZE));break;default:break}let a;try{let c=await Hd.keys.generateKeyPair(r,n),u=await c.id(),l=qf.get(this).dek,f=await c.export(l);a={name:e,id:u};let h=i.store.batch();h.put(s,Hu(f)),h.put(Ff(e),Hu(JSON.stringify(a))),await h.commit()}catch(c){return lr(c)}return a}async listKeys(){let e=this,r={prefix:jwe},n=[];for await(let i of e.store.query(r))n.push(JSON.parse($d(i.value)));return n}async findKeyById(e){try{return(await this.listKeys()).find(n=>n.id===e)}catch(r){return lr(r)}}async findKeyByName(e){if(!$u(e))return lr(Xr(new Error(`Invalid key name '${e}'`),Qr.ERR_INVALID_KEY_NAME));let r=Ff(e);try{let n=await this.store.get(r);return JSON.parse($d(n))}catch(n){return lr(Xr(new Error(`Key '${e}' does not exist. ${n.message}`),Qr.ERR_KEY_NOT_FOUND))}}async removeKey(e){let r=this;if(!$u(e)||e==="self")return lr(Xr(new Error(`Invalid key name '${e}'`),Qr.ERR_INVALID_KEY_NAME));let n=Fc(e),i=await r.findKeyByName(e),s=r.store.batch();return s.delete(n),s.delete(Ff(e)),await s.commit(),i}async renameKey(e,r){let n=this;if(!$u(e)||e==="self")return lr(Xr(new Error(`Invalid old key name '${e}'`),Qr.ERR_OLD_KEY_NAME_INVALID));if(!$u(r)||r==="self")return lr(Xr(new Error(`Invalid new key name '${r}'`),Qr.ERR_NEW_KEY_NAME_INVALID));let i=Fc(e),s=Fc(r),o=Ff(e),a=Ff(r);if(await n.store.has(s))return lr(Xr(new Error(`Key '${r}' already exists`),Qr.ERR_KEY_ALREADY_EXISTS));try{let u=await n.store.get(i),l=await n.store.get(o),f=JSON.parse($d(l));f.name=r;let h=n.store.batch();return h.put(s,u),h.put(a,Hu(JSON.stringify(f))),h.delete(i),h.delete(o),await h.commit(),f}catch(u){return lr(u)}}async exportKey(e,r){if(!$u(e))return lr(Xr(new Error(`Invalid key name '${e}'`),Qr.ERR_INVALID_KEY_NAME));if(!r)return lr(Xr(new Error("Password is required"),Qr.ERR_PASSWORD_REQUIRED));let n=Fc(e);try{let i=await this.store.get(n),s=$d(i),o=qf.get(this).dek;return(await Hd.keys.import(s,o)).export(r)}catch(i){return lr(i)}}async importKey(e,r,n){let i=this;if(!$u(e)||e==="self")return lr(Xr(new Error(`Invalid key name '${e}'`),Qr.ERR_INVALID_KEY_NAME));if(!r)return lr(Xr(new Error("PEM encoded key is required"),Qr.ERR_PEM_REQUIRED));let s=Fc(e);if(await i.store.has(s))return lr(Xr(new Error(`Key '${e}' already exists`),Qr.ERR_KEY_ALREADY_EXISTS));let a;try{a=await Hd.keys.import(r,n)}catch{return lr(Xr(new Error("Cannot read the key, most likely the password is wrong"),Qr.ERR_CANNOT_READ_KEY))}let c;try{c=await a.id();let f=qf.get(this).dek;r=await a.export(f)}catch(f){return lr(f)}let u={name:e,id:c},l=i.store.batch();return l.put(s,Hu(r)),l.put(Ff(e),Hu(JSON.stringify(u))),await l.commit(),u}async importPeer(e,r){let n=this;if(!$u(e))return lr(Xr(new Error(`Invalid key name '${e}'`),Qr.ERR_INVALID_KEY_NAME));if(!r||!r.privKey)return lr(Xr(new Error("Peer.privKey is required"),Qr.ERR_MISSING_PRIVATE_KEY));let i=r.privKey,s=Fc(e);if(await n.store.has(s))return lr(Xr(new Error(`Key '${e}' already exists`),Qr.ERR_KEY_ALREADY_EXISTS));try{let a=await i.id(),c=qf.get(this).dek,u=await i.export(c),l={name:e,id:a},f=n.store.batch();return f.put(s,Hu(u)),f.put(Ff(e),Hu(JSON.stringify(l))),await f.commit(),l}catch(a){return lr(a)}}async _getPrivateKey(e){if(!$u(e))return lr(Xr(new Error(`Invalid key name '${e}'`),Qr.ERR_INVALID_KEY_NAME));try{let r=Fc(e),n=await this.store.get(r);return $d(n)}catch(r){return lr(Xr(new Error(`Key '${e}' does not exist. ${r.message}`),Qr.ERR_KEY_NOT_FOUND))}}async rotateKeychainPass(e,r){if(typeof e!="string")return lr(Xr(new Error(`Invalid old pass type '${typeof e}'`),Qr.ERR_INVALID_OLD_PASS_TYPE));if(typeof r!="string")return lr(Xr(new Error(`Invalid new pass type '${typeof r}'`),Qr.ERR_INVALID_NEW_PASS_TYPE));if(r.length<20)return lr(Xr(new Error(`Invalid pass length ${r.length}`),Qr.ERR_INVALID_PASS_LENGTH));Fwe("recreating keychain");let n=qf.get(this).dek;this.opts.pass=r;let i=r?Hd.pbkdf2(r,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";qf.set(this,{dek:i});let s=await this.listKeys();for(let o of s){let a=await this.store.get(Fc(o.name)),c=$d(a),u=await Hd.keys.import(c,n),l=i.toString(),f=await u.export(l),h=this.store.batch(),d={name:o.name,id:o.id};h.put(Fc(o.name),Hu(f)),h.put(Ff(o.name),Hu(JSON.stringify(d))),await h.commit()}Fwe("keychain reconstructed")}};zwe.exports=Vwe});var Mv=g((Lv,$we)=>{(function(t,e){typeof Lv=="object"&&typeof $we<"u"?e(Lv):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis<"u"?globalThis:t||self,e(t.streamingIterables={}))})(Lv,function(t){"use strict";async function*e(I,B){let G=[];for await(let Z of B)G.push(Z),G.length===I&&(yield G,G=[]);G.length>0&&(yield G)}function*r(I,B){let G=[];for(let Z of B)G.push(Z),G.length===I&&(yield G,G=[]);G.length>0&&(yield G)}function n(I,B){return B===void 0?G=>n(I,G):B[Symbol.asyncIterator]?e(I,B):r(I,B)}let i=Symbol("TIMEOUT"),s=I=>{let B;return[new Promise(G=>{B=setTimeout(()=>G(i),I)}),()=>{clearTimeout(B)}]};async function*o(I,B,G){let Z=G[Symbol.asyncIterator](),ye,Fe=[],Ye,He,$e=()=>{ct(),[Ye,He]=s(B)},ct=()=>{He&&He(),Ye=void 0};for(ye=Z.next();;){let zt=await(Ye?Promise.race([ye,Ye]):ye);if(zt===i||zt.done){if(Fe.length&&(yield Fe,Fe=[]),ct(),zt!==i)break;continue}if(ye=Z.next(),Fe.push(zt.value),Fe.length===1&&$e(),Fe.length===I){yield Fe,Fe=[],ct();continue}}}function a(I,B,G){return G===void 0?Z=>a(I,B,Z):G[Symbol.asyncIterator]&&B!==1/0?o(I,B,G):n(I,G)}function c(I){if(typeof I.next=="function")return I;if(typeof I[Symbol.iterator]=="function")return I[Symbol.iterator]();if(typeof I[Symbol.asyncIterator]=="function")return I[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function u(){let I,B;return{promise:new Promise((Z,ye)=>{B=Z,I=ye}),reject:I,resolve:B}}function l(I,B){let G=c(B),Z=[],ye=[],Fe=!1,Ye=!1;function He(){for(;ye.length>0&&Z.length>0;){let gt=ye.shift(),{error:Ir,value:Fr}=Z.shift();Ir?gt.reject(Ir):gt.resolve({done:!1,value:Fr})}for(;ye.length>0&&Ye;){let{resolve:gt}=ye.shift();gt({done:!0,value:void 0})}}async function $e(){if(!Ye&&!Fe&&!(Z.length>=I)){Fe=!0;try{let{done:gt,value:Ir}=await G.next();gt?Ye=!0:Z.push({value:Ir})}catch(gt){Ye=!0,Z.push({error:gt})}He(),Fe=!1,$e()}}async function ct(){if(Z.length>0){let{error:Ir,value:Fr}=Z.shift();if(Ir)throw Ir;return $e(),{done:!1,value:Fr}}if(Ye)return{done:!0,value:void 0};let gt=u();return ye.push(gt),$e(),gt.promise}let zt={next:ct,[Symbol.asyncIterator]:()=>zt};return zt}function*f(I,B){let G=[],Z;try{for(let ye of B)G.push(ye),!(G.length<=I)&&(yield G.shift())}catch(ye){Z=ye}for(let ye of G)yield ye;if(Z)throw Z}function h(I,B){return B===void 0?G=>h(I,G):I===0?B:B[Symbol.asyncIterator]?l(I,B):f(I,B)}async function d(I){let B=[];for await(let G of I)B.push(G);return B}function p(I){return I[Symbol.asyncIterator]?d(I):Array.from(I)}async function*y(I){for await(let B of I)yield*B}function*b(I){for(let B of I)yield*B}function m(...I){return I.find(G=>G[Symbol.asyncIterator]!==void 0)?y(I):b(I)}async function _(I){for await(let B of I);}function R(I){if(I[Symbol.asyncIterator])return _(I);for(let B of I);}async function*k(I,B){for await(let G of B)await I(G)&&(yield G)}function P(I,B){return B===void 0?G=>k(I,G):k(I,B)}async function*x(I){for await(let B of I)B&&typeof B!="string"&&(B[Symbol.iterator]||B[Symbol.asyncIterator])?yield*x(B):yield B}async function*D(I,B){for await(let G of B)yield await I(G)}function U(I,B){return B===void 0?G=>D(I,G):D(I,B)}function M(I,B){return B===void 0?G=>M(I,G):P(G=>G!=null,x(U(I,B)))}function ae(I,B,G){let Z=c(G),ye=[],Fe=[],Ye=!1,He=!1,$e=0,ct=null;function zt(){for(;Fe.length>0&&ye.length>0;){let{resolve:vt}=Fe.shift(),ut=ye.shift();vt({done:!1,value:ut})}for(;Fe.length>0&&$e===0&&Ye;){let{resolve:vt,reject:ut}=Fe.shift();ct?(ut(ct),ct=null):vt({done:!0,value:void 0})}}async function gt(){if(Ye){zt();return}if(!He&&!($e+ye.length>=I)){He=!0,$e++;try{let{done:vt,value:ut}=await Z.next();vt?(Ye=!0,$e--,zt()):Ir(ut)}catch(vt){Ye=!0,$e--,ct=vt,zt()}He=!1,gt()}}async function Ir(vt){try{let ut=await B(vt);if(ut&&ut[Symbol.asyncIterator])for await(let Er of ut)ye.push(Er);else ye.push(ut)}catch(ut){Ye=!0,ct=ut}$e--,zt(),gt()}async function Fr(){if(ye.length===0){let ut=u();return Fe.push(ut),gt(),ut.promise}let vt=ye.shift();return gt(),{done:!1,value:vt}}let Bi={next:Fr,[Symbol.asyncIterator]:()=>Bi};return Bi}function ne(I,B,G){return B===void 0?(Z,ye)=>ye?ne(I,Z,ye):ne(I,Z):G===void 0?Z=>ne(I,B,Z):P(Z=>Z!=null,x(ae(I,B,G)))}async function de(I){return new Promise(B=>{I.once("readable",()=>{B()})})}async function*me(I){for(;;){let B=I.read();if(B!==null){yield B;continue}if(I._readableState.ended)break;await de(I)}}function Ke(I){return typeof I[Symbol.asyncIterator]=="function"?I:me(I)}async function*xe(...I){let B=new Set(I.map(c));for(;B.size>0;)for(let G of B){let Z=await G.next();Z.done?B.delete(G):yield Z.value}}function Ue(I,...B){let G=I();for(let Z of B)G=Z(G);return G}async function*ie(I,B,G){let Z=null,ye=$e=>({value:B($e)}),Fe=async function*($e){for await(let ct of $e){if(Z)return;yield ct}},Ye=Ue(()=>G,h(1),Fe,U(ye),h(I-1)),He=c(Ye);for(;;){let{value:$e,done:ct}=await He.next();if(ct)break;try{let zt=await $e.value;Z||(yield zt)}catch(zt){Z=zt}}if(Z)throw Z}function Ve(I,B,G){return B===void 0?(Z,ye)=>Ve(I,Z,ye):G===void 0?Z=>Ve(I,B,Z):I===1?U(B,G):ie(I,B,G)}function pt(I,B,G){return B===void 0?(Z,ye)=>ye?pt(I,Z,ye):pt(I,Z):G===void 0?Z=>pt(I,B,Z):P(Z=>Z!=null,x(Ve(I,B,G)))}async function*Je(...I){let B=I.map(c),G=new Set,Z=new Map,ye=null,Fe=null,Ye=null,He=gt=>{ye=gt,Fe&&Fe(gt)},$e=gt=>{Ye&&Ye(gt)},ct=()=>new Promise((gt,Ir)=>{if(ye&&Ir(ye),Z.size>0)return gt();Ye=gt,Fe=Ir}),zt=gt=>{let Ir=Promise.resolve(gt.next()).then(async({done:Fr,value:Bi})=>{Fr||Z.set(gt,Bi),G.delete(Ir)});G.add(Ir),Ir.then($e,He)};for(let gt of B)zt(gt);for(;;){if(G.size===0&&Z.size===0)return;await ct();for(let[gt,Ir]of Z)Z.delete(gt),yield Ir,zt(gt)}}async function et(I,B,G){let Z=B;for await(let ye of G)Z=await I(Z,ye);return Z}function pe(I,B,G){return B===void 0?(Z,ye)=>ye?et(I,Z,ye):pe(I,Z):G===void 0?Z=>pe(I,B,Z):et(I,B,G)}async function*J(I,B){let G=0;for await(let Z of B)if(yield await Z,G++,G>=I)break}function*Ie(I,B){let G=0;for(let Z of B)if(yield Z,G++,G>=I)break}function ze(I,B){return B===void 0?G=>ze(I,G):B[Symbol.asyncIterator]?J(I,B):Ie(I,B)}async function*We(I,B){for await(let G of B)await I(G),yield G}function De(I,B){return B===void 0?G=>We(I,G):We(I,B)}let ht=I=>new Promise(B=>setTimeout(B,I));function T(I,B,G){if(!Number.isFinite(I))throw new TypeError("Expected `limit` to be a finite number");if(I<=0)throw new TypeError("Expected `limit` to be greater than 0");if(!Number.isFinite(B))throw new TypeError("Expected `interval` to be a finite number");return async function*(){let ye=0,Fe;for await(let Ye of G){if(ye<I){typeof Fe>"u"&&(Fe=Date.now()),ye++,yield Ye;continue}let He=Date.now()-Fe,$e=B-He;$e>0&&await ht($e),Fe=Date.now(),ye=1,yield Ye}}()}function O(I,B,G){return G===void 0?Z=>T(I,B,Z):T(I,B,G)}function N(I,B){let G=I[0]+B[0],Z=I[1]+B[1];if(Z>=1e9){let ye=Z%1e9;G+=(Z-ye)/1e9,Z=ye}return[G,Z]}async function*Y(I,B){let G=B[Symbol.asyncIterator](),Z=[0,0];for(;;){let ye=process.hrtime(),{value:Fe,done:Ye}=await G.next(),He=process.hrtime(ye);if(Z=N(Z,He),I.progress&&I.progress(He,Z),Ye)return I.total&&I.total(Z),Fe;yield Fe}}function*K(I,B){let G=B[Symbol.iterator](),Z=[0,0];for(;;){let ye=process.hrtime(),{value:Fe,done:Ye}=G.next(),He=process.hrtime(ye);if(Z=N(Z,He),I.progress&&I.progress(He,Z),Ye)return I.total&&I.total(Z),Fe;yield Fe}}function W(I={},B){return B===void 0?G=>W(I,G):B[Symbol.asyncIterator]!==void 0?Y(I,B):K(I,B)}function ee(I,B,G){let Z=c(G),ye=[],Fe=[],Ye=!1,He=!1,$e=0,ct=null;function zt(){for(;Fe.length>0&&ye.length>0;){let{resolve:vt}=Fe.shift(),ut=ye.shift();vt({done:!1,value:ut})}for(;Fe.length>0&&$e===0&&Ye;){let{resolve:vt,reject:ut}=Fe.shift();ct?(ut(ct),ct=null):vt({done:!0,value:void 0})}}async function gt(){if(Ye){zt();return}if(!He&&!($e+ye.length>=I)){He=!0,$e++;try{let{done:vt,value:ut}=await Z.next();vt?(Ye=!0,$e--,zt()):Ir(ut)}catch(vt){Ye=!0,$e--,ct=vt,zt()}He=!1,gt()}}async function Ir(vt){try{let ut=await B(vt);ye.push(ut)}catch(ut){Ye=!0,ct=ut}$e--,zt(),gt()}async function Fr(){if(ye.length===0){let ut=u();return Fe.push(ut),gt(),ut.promise}let vt=ye.shift();return gt(),{done:!1,value:vt}}let Bi={next:Fr,[Symbol.asyncIterator]:()=>Bi};return Bi}function V(I,B,G){return B===void 0?(Z,ye)=>ye?V(I,Z,ye):V(I,Z):G===void 0?Z=>V(I,B,Z):ee(I,B,G)}async function X(I,B){let G=null,Z=null,ye=null,Fe=ct=>{G=ct,Z&&Z(ct)},Ye=()=>{ye&&ye()},He=()=>{I.removeListener("error",Fe),I.removeListener("drain",Ye)};I.once("error",Fe);let $e=()=>new Promise((ct,zt)=>{if(G)return zt(G);I.once("drain",Ye),ye=ct,Z=zt});for await(let ct of B)if(I.write(ct)===!1&&await $e(),G)break;if(He(),G)throw G}function re(I,B){return B===void 0?G=>X(I,G):X(I,B)}t.batch=n,t.batchWithTimeout=a,t.buffer=h,t.collect=p,t.concat=m,t.consume=R,t.filter=P,t.flatMap=M,t.flatTransform=ne,t.flatten=x,t.fromStream=Ke,t.getIterator=c,t.map=U,t.merge=xe,t.parallelFlatMap=pt,t.parallelMap=Ve,t.parallelMerge=Je,t.pipeline=Ue,t.reduce=pe,t.take=ze,t.tap=De,t.throttle=O,t.time=W,t.transform=V,t.writeToStream=re,Object.defineProperty(t,"__esModule",{value:!0})})});var Wwe=g((Qqt,Gwe)=>{"use strict";var xot=qp();Gwe.exports=t=>{let e=xot(t);return e.delete=e.remove,e}});var Xwe=g((Ywe,Uv)=>{(function(t){"use strict";var e,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,i=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,h=1e9;function d(P){var x,D,U,M=J.prototype={constructor:J,toString:null,valueOf:null},ae=new J(1),ne=20,de=4,me=-7,Ke=21,xe=-1e7,Ue=1e7,ie=!1,Ve=1,pt=0,Je={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},et="0123456789abcdefghijklmnopqrstuvwxyz",pe=!0;function J(T,O){var N,Y,K,W,ee,V,X,re,I=this;if(!(I instanceof J))return new J(T,O);if(O==null){if(T&&T._isBigNumber===!0){I.s=T.s,!T.c||T.e>Ue?I.c=I.e=null:T.e<xe?I.c=[I.e=0]:(I.e=T.e,I.c=T.c.slice());return}if((V=typeof T=="number")&&T*0==0){if(I.s=1/T<0?(T=-T,-1):1,T===~~T){for(W=0,ee=T;ee>=10;ee/=10,W++);W>Ue?I.c=I.e=null:(I.e=W,I.c=[T]);return}re=String(T)}else{if(!r.test(re=String(T)))return U(I,re,V);I.s=re.charCodeAt(0)==45?(re=re.slice(1),-1):1}(W=re.indexOf("."))>-1&&(re=re.replace(".","")),(ee=re.search(/e/i))>0?(W<0&&(W=ee),W+=+re.slice(ee+1),re=re.substring(0,ee)):W<0&&(W=re.length)}else{if(m(O,2,et.length,"Base"),O==10&&pe)return I=new J(T),De(I,ne+I.e+1,de);if(re=String(T),V=typeof T=="number"){if(T*0!=0)return U(I,re,V,O);if(I.s=1/T<0?(re=re.slice(1),-1):1,J.DEBUG&&re.replace(/^0\.0*|\./,"").length>15)throw Error(o+T)}else I.s=re.charCodeAt(0)===45?(re=re.slice(1),-1):1;for(N=et.slice(0,O),W=ee=0,X=re.length;ee<X;ee++)if(N.indexOf(Y=re.charAt(ee))<0){if(Y=="."){if(ee>W){W=X;continue}}else if(!K&&(re==re.toUpperCase()&&(re=re.toLowerCase())||re==re.toLowerCase()&&(re=re.toUpperCase()))){K=!0,ee=-1,W=0;continue}return U(I,String(T),V,O)}V=!1,re=D(re,O,10,I.s),(W=re.indexOf("."))>-1?re=re.replace(".",""):W=re.length}for(ee=0;re.charCodeAt(ee)===48;ee++);for(X=re.length;re.charCodeAt(--X)===48;);if(re=re.slice(ee,++X)){if(X-=ee,V&&J.DEBUG&&X>15&&(T>u||T!==i(T)))throw Error(o+I.s*T);if((W=W-ee-1)>Ue)I.c=I.e=null;else if(W<xe)I.c=[I.e=0];else{if(I.e=W,I.c=[],ee=(W+1)%c,W<0&&(ee+=c),ee<X){for(ee&&I.c.push(+re.slice(0,ee)),X-=c;ee<X;)I.c.push(+re.slice(ee,ee+=c));ee=c-(re=re.slice(ee)).length}else ee-=X;for(;ee--;re+="0");I.c.push(+re)}}else I.c=[I.e=0]}J.clone=d,J.ROUND_UP=0,J.ROUND_DOWN=1,J.ROUND_CEIL=2,J.ROUND_FLOOR=3,J.ROUND_HALF_UP=4,J.ROUND_HALF_DOWN=5,J.ROUND_HALF_EVEN=6,J.ROUND_HALF_CEIL=7,J.ROUND_HALF_FLOOR=8,J.EUCLID=9,J.config=J.set=function(T){var O,N;if(T!=null)if(typeof T=="object"){if(T.hasOwnProperty(O="DECIMAL_PLACES")&&(N=T[O],m(N,0,h,O),ne=N),T.hasOwnProperty(O="ROUNDING_MODE")&&(N=T[O],m(N,0,8,O),de=N),T.hasOwnProperty(O="EXPONENTIAL_AT")&&(N=T[O],N&&N.pop?(m(N[0],-h,0,O),m(N[1],0,h,O),me=N[0],Ke=N[1]):(m(N,-h,h,O),me=-(Ke=N<0?-N:N))),T.hasOwnProperty(O="RANGE"))if(N=T[O],N&&N.pop)m(N[0],-h,-1,O),m(N[1],1,h,O),xe=N[0],Ue=N[1];else if(m(N,-h,h,O),N)xe=-(Ue=N<0?-N:N);else throw Error(s+O+" cannot be zero: "+N);if(T.hasOwnProperty(O="CRYPTO"))if(N=T[O],N===!!N)if(N)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ie=N;else throw ie=!N,Error(s+"crypto unavailable");else ie=N;else throw Error(s+O+" not true or false: "+N);if(T.hasOwnProperty(O="MODULO_MODE")&&(N=T[O],m(N,0,9,O),Ve=N),T.hasOwnProperty(O="POW_PRECISION")&&(N=T[O],m(N,0,h,O),pt=N),T.hasOwnProperty(O="FORMAT"))if(N=T[O],typeof N=="object")Je=N;else throw Error(s+O+" not an object: "+N);if(T.hasOwnProperty(O="ALPHABET"))if(N=T[O],typeof N=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(N))pe=N.slice(0,10)=="0123456789",et=N;else throw Error(s+O+" invalid: "+N)}else throw Error(s+"Object expected: "+T);return{DECIMAL_PLACES:ne,ROUNDING_MODE:de,EXPONENTIAL_AT:[me,Ke],RANGE:[xe,Ue],CRYPTO:ie,MODULO_MODE:Ve,POW_PRECISION:pt,FORMAT:Je,ALPHABET:et}},J.isBigNumber=function(T){if(!T||T._isBigNumber!==!0)return!1;if(!J.DEBUG)return!0;var O,N,Y=T.c,K=T.e,W=T.s;e:if({}.toString.call(Y)=="[object Array]"){if((W===1||W===-1)&&K>=-h&&K<=h&&K===i(K)){if(Y[0]===0){if(K===0&&Y.length===1)return!0;break e}if(O=(K+1)%c,O<1&&(O+=c),String(Y[0]).length==O){for(O=0;O<Y.length;O++)if(N=Y[O],N<0||N>=a||N!==i(N))break e;if(N!==0)return!0}}}else if(Y===null&&K===null&&(W===null||W===1||W===-1))return!0;throw Error(s+"Invalid BigNumber: "+T)},J.maximum=J.max=function(){return ze(arguments,M.lt)},J.minimum=J.min=function(){return ze(arguments,M.gt)},J.random=function(){var T=9007199254740992,O=Math.random()*T&2097151?function(){return i(Math.random()*T)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(N){var Y,K,W,ee,V,X=0,re=[],I=new J(ae);if(N==null?N=ne:m(N,0,h),ee=n(N/c),ie)if(crypto.getRandomValues){for(Y=crypto.getRandomValues(new Uint32Array(ee*=2));X<ee;)V=Y[X]*131072+(Y[X+1]>>>11),V>=9e15?(K=crypto.getRandomValues(new Uint32Array(2)),Y[X]=K[0],Y[X+1]=K[1]):(re.push(V%1e14),X+=2);X=ee/2}else if(crypto.randomBytes){for(Y=crypto.randomBytes(ee*=7);X<ee;)V=(Y[X]&31)*281474976710656+Y[X+1]*1099511627776+Y[X+2]*4294967296+Y[X+3]*16777216+(Y[X+4]<<16)+(Y[X+5]<<8)+Y[X+6],V>=9e15?crypto.randomBytes(7).copy(Y,X):(re.push(V%1e14),X+=7);X=ee/7}else throw ie=!1,Error(s+"crypto unavailable");if(!ie)for(;X<ee;)V=O(),V<9e15&&(re[X++]=V%1e14);for(ee=re[--X],N%=c,ee&&N&&(V=l[c-N],re[X]=i(ee/V)*V);re[X]===0;re.pop(),X--);if(X<0)re=[W=0];else{for(W=-1;re[0]===0;re.splice(0,1),W-=c);for(X=1,V=re[0];V>=10;V/=10,X++);X<c&&(W-=c-X)}return I.e=W,I.c=re,I}}(),J.sum=function(){for(var T=1,O=arguments,N=new J(O[0]);T<O.length;)N=N.plus(O[T++]);return N},D=function(){var T="0123456789";function O(N,Y,K,W){for(var ee,V=[0],X,re=0,I=N.length;re<I;){for(X=V.length;X--;V[X]*=Y);for(V[0]+=W.indexOf(N.charAt(re++)),ee=0;ee<V.length;ee++)V[ee]>K-1&&(V[ee+1]==null&&(V[ee+1]=0),V[ee+1]+=V[ee]/K|0,V[ee]%=K)}return V.reverse()}return function(N,Y,K,W,ee){var V,X,re,I,B,G,Z,ye,Fe=N.indexOf("."),Ye=ne,He=de;for(Fe>=0&&(I=pt,pt=0,N=N.replace(".",""),ye=new J(Y),G=ye.pow(N.length-Fe),pt=I,ye.c=O(k(y(G.c),G.e,"0"),10,K,T),ye.e=ye.c.length),Z=O(N,Y,K,ee?(V=et,T):(V=T,et)),re=I=Z.length;Z[--I]==0;Z.pop());if(!Z[0])return V.charAt(0);if(Fe<0?--re:(G.c=Z,G.e=re,G.s=W,G=x(G,ye,Ye,He,K),Z=G.c,B=G.r,re=G.e),X=re+Ye+1,Fe=Z[X],I=K/2,B=B||X<0||Z[X+1]!=null,B=He<4?(Fe!=null||B)&&(He==0||He==(G.s<0?3:2)):Fe>I||Fe==I&&(He==4||B||He==6&&Z[X-1]&1||He==(G.s<0?8:7)),X<1||!Z[0])N=B?k(V.charAt(1),-Ye,V.charAt(0)):V.charAt(0);else{if(Z.length=X,B)for(--K;++Z[--X]>K;)Z[X]=0,X||(++re,Z=[1].concat(Z));for(I=Z.length;!Z[--I];);for(Fe=0,N="";Fe<=I;N+=V.charAt(Z[Fe++]));N=k(N,re,V.charAt(0))}return N}}(),x=function(){function T(Y,K,W){var ee,V,X,re,I=0,B=Y.length,G=K%f,Z=K/f|0;for(Y=Y.slice();B--;)X=Y[B]%f,re=Y[B]/f|0,ee=Z*X+re*G,V=G*X+ee%f*f+I,I=(V/W|0)+(ee/f|0)+Z*re,Y[B]=V%W;return I&&(Y=[I].concat(Y)),Y}function O(Y,K,W,ee){var V,X;if(W!=ee)X=W>ee?1:-1;else for(V=X=0;V<W;V++)if(Y[V]!=K[V]){X=Y[V]>K[V]?1:-1;break}return X}function N(Y,K,W,ee){for(var V=0;W--;)Y[W]-=V,V=Y[W]<K[W]?1:0,Y[W]=V*ee+Y[W]-K[W];for(;!Y[0]&&Y.length>1;Y.splice(0,1));}return function(Y,K,W,ee,V){var X,re,I,B,G,Z,ye,Fe,Ye,He,$e,ct,zt,gt,Ir,Fr,Bi,vt=Y.s==K.s?1:-1,ut=Y.c,Er=K.c;if(!ut||!ut[0]||!Er||!Er[0])return new J(!Y.s||!K.s||(ut?Er&&ut[0]==Er[0]:!Er)?NaN:ut&&ut[0]==0||!Er?vt*0:vt/0);for(Fe=new J(vt),Ye=Fe.c=[],re=Y.e-K.e,vt=W+re+1,V||(V=a,re=p(Y.e/c)-p(K.e/c),vt=vt/c|0),I=0;Er[I]==(ut[I]||0);I++);if(Er[I]>(ut[I]||0)&&re--,vt<0)Ye.push(1),B=!0;else{for(gt=ut.length,Fr=Er.length,I=0,vt+=2,G=i(V/(Er[0]+1)),G>1&&(Er=T(Er,G,V),ut=T(ut,G,V),Fr=Er.length,gt=ut.length),zt=Fr,He=ut.slice(0,Fr),$e=He.length;$e<Fr;He[$e++]=0);Bi=Er.slice(),Bi=[0].concat(Bi),Ir=Er[0],Er[1]>=V/2&&Ir++;do{if(G=0,X=O(Er,He,Fr,$e),X<0){if(ct=He[0],Fr!=$e&&(ct=ct*V+(He[1]||0)),G=i(ct/Ir),G>1)for(G>=V&&(G=V-1),Z=T(Er,G,V),ye=Z.length,$e=He.length;O(Z,He,ye,$e)==1;)G--,N(Z,Fr<ye?Bi:Er,ye,V),ye=Z.length,X=1;else G==0&&(X=G=1),Z=Er.slice(),ye=Z.length;if(ye<$e&&(Z=[0].concat(Z)),N(He,Z,$e,V),$e=He.length,X==-1)for(;O(Er,He,Fr,$e)<1;)G++,N(He,Fr<$e?Bi:Er,$e,V),$e=He.length}else X===0&&(G++,He=[0]);Ye[I++]=G,He[0]?He[$e++]=ut[zt]||0:(He=[ut[zt]],$e=1)}while((zt++<gt||He[0]!=null)&&vt--);B=He[0]!=null,Ye[0]||Ye.splice(0,1)}if(V==a){for(I=1,vt=Ye[0];vt>=10;vt/=10,I++);De(Fe,W+(Fe.e=I+re*c-1)+1,ee,B)}else Fe.e=re,Fe.r=+B;return Fe}}();function Ie(T,O,N,Y){var K,W,ee,V,X;if(N==null?N=de:m(N,0,8),!T.c)return T.toString();if(K=T.c[0],ee=T.e,O==null)X=y(T.c),X=Y==1||Y==2&&(ee<=me||ee>=Ke)?R(X,ee):k(X,ee,"0");else if(T=De(new J(T),O,N),W=T.e,X=y(T.c),V=X.length,Y==1||Y==2&&(O<=W||W<=me)){for(;V<O;X+="0",V++);X=R(X,W)}else if(O-=ee,X=k(X,W,"0"),W+1>V){if(--O>0)for(X+=".";O--;X+="0");}else if(O+=W-V,O>0)for(W+1==V&&(X+=".");O--;X+="0");return T.s<0&&K?"-"+X:X}function ze(T,O){for(var N,Y=1,K=new J(T[0]);Y<T.length;Y++)if(N=new J(T[Y]),N.s)O.call(K,N)&&(K=N);else{K=N;break}return K}function We(T,O,N){for(var Y=1,K=O.length;!O[--K];O.pop());for(K=O[0];K>=10;K/=10,Y++);return(N=Y+N*c-1)>Ue?T.c=T.e=null:N<xe?T.c=[T.e=0]:(T.e=N,T.c=O),T}U=function(){var T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,O=/^([^.]+)\.$/,N=/^\.([^.]+)$/,Y=/^-?(Infinity|NaN)$/,K=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(W,ee,V,X){var re,I=V?ee:ee.replace(K,"");if(Y.test(I))W.s=isNaN(I)?null:I<0?-1:1;else{if(!V&&(I=I.replace(T,function(B,G,Z){return re=(Z=Z.toLowerCase())=="x"?16:Z=="b"?2:8,!X||X==re?G:B}),X&&(re=X,I=I.replace(O,"$1").replace(N,"0.$1")),ee!=I))return new J(I,re);if(J.DEBUG)throw Error(s+"Not a"+(X?" base "+X:"")+" number: "+ee);W.s=null}W.c=W.e=null}}();function De(T,O,N,Y){var K,W,ee,V,X,re,I,B=T.c,G=l;if(B){e:{for(K=1,V=B[0];V>=10;V/=10,K++);if(W=O-K,W<0)W+=c,ee=O,X=B[re=0],I=X/G[K-ee-1]%10|0;else if(re=n((W+1)/c),re>=B.length)if(Y){for(;B.length<=re;B.push(0));X=I=0,K=1,W%=c,ee=W-c+1}else break e;else{for(X=V=B[re],K=1;V>=10;V/=10,K++);W%=c,ee=W-c+K,I=ee<0?0:X/G[K-ee-1]%10|0}if(Y=Y||O<0||B[re+1]!=null||(ee<0?X:X%G[K-ee-1]),Y=N<4?(I||Y)&&(N==0||N==(T.s<0?3:2)):I>5||I==5&&(N==4||Y||N==6&&(W>0?ee>0?X/G[K-ee]:0:B[re-1])%10&1||N==(T.s<0?8:7)),O<1||!B[0])return B.length=0,Y?(O-=T.e+1,B[0]=G[(c-O%c)%c],T.e=-O||0):B[0]=T.e=0,T;if(W==0?(B.length=re,V=1,re--):(B.length=re+1,V=G[c-W],B[re]=ee>0?i(X/G[K-ee]%G[ee])*V:0),Y)for(;;)if(re==0){for(W=1,ee=B[0];ee>=10;ee/=10,W++);for(ee=B[0]+=V,V=1;ee>=10;ee/=10,V++);W!=V&&(T.e++,B[0]==a&&(B[0]=1));break}else{if(B[re]+=V,B[re]!=a)break;B[re--]=0,V=1}for(W=B.length;B[--W]===0;B.pop());}T.e>Ue?T.c=T.e=null:T.e<xe&&(T.c=[T.e=0])}return T}function ht(T){var O,N=T.e;return N===null?T.toString():(O=y(T.c),O=N<=me||N>=Ke?R(O,N):k(O,N,"0"),T.s<0?"-"+O:O)}return M.absoluteValue=M.abs=function(){var T=new J(this);return T.s<0&&(T.s=1),T},M.comparedTo=function(T,O){return b(this,new J(T,O))},M.decimalPlaces=M.dp=function(T,O){var N,Y,K,W=this;if(T!=null)return m(T,0,h),O==null?O=de:m(O,0,8),De(new J(W),T+W.e+1,O);if(!(N=W.c))return null;if(Y=((K=N.length-1)-p(this.e/c))*c,K=N[K])for(;K%10==0;K/=10,Y--);return Y<0&&(Y=0),Y},M.dividedBy=M.div=function(T,O){return x(this,new J(T,O),ne,de)},M.dividedToIntegerBy=M.idiv=function(T,O){return x(this,new J(T,O),0,1)},M.exponentiatedBy=M.pow=function(T,O){var N,Y,K,W,ee,V,X,re,I,B=this;if(T=new J(T),T.c&&!T.isInteger())throw Error(s+"Exponent not an integer: "+ht(T));if(O!=null&&(O=new J(O)),V=T.e>14,!B.c||!B.c[0]||B.c[0]==1&&!B.e&&B.c.length==1||!T.c||!T.c[0])return I=new J(Math.pow(+ht(B),V?2-_(T):+ht(T))),O?I.mod(O):I;if(X=T.s<0,O){if(O.c?!O.c[0]:!O.s)return new J(NaN);Y=!X&&B.isInteger()&&O.isInteger(),Y&&(B=B.mod(O))}else{if(T.e>9&&(B.e>0||B.e<-1||(B.e==0?B.c[0]>1||V&&B.c[1]>=24e7:B.c[0]<8e13||V&&B.c[0]<=9999975e7)))return W=B.s<0&&_(T)?-0:0,B.e>-1&&(W=1/W),new J(X?1/W:W);pt&&(W=n(pt/c+2))}for(V?(N=new J(.5),X&&(T.s=1),re=_(T)):(K=Math.abs(+ht(T)),re=K%2),I=new J(ae);;){if(re){if(I=I.times(B),!I.c)break;W?I.c.length>W&&(I.c.length=W):Y&&(I=I.mod(O))}if(K){if(K=i(K/2),K===0)break;re=K%2}else if(T=T.times(N),De(T,T.e+1,1),T.e>14)re=_(T);else{if(K=+ht(T),K===0)break;re=K%2}B=B.times(B),W?B.c&&B.c.length>W&&(B.c.length=W):Y&&(B=B.mod(O))}return Y?I:(X&&(I=ae.div(I)),O?I.mod(O):W?De(I,pt,de,ee):I)},M.integerValue=function(T){var O=new J(this);return T==null?T=de:m(T,0,8),De(O,O.e+1,T)},M.isEqualTo=M.eq=function(T,O){return b(this,new J(T,O))===0},M.isFinite=function(){return!!this.c},M.isGreaterThan=M.gt=function(T,O){return b(this,new J(T,O))>0},M.isGreaterThanOrEqualTo=M.gte=function(T,O){return(O=b(this,new J(T,O)))===1||O===0},M.isInteger=function(){return!!this.c&&p(this.e/c)>this.c.length-2},M.isLessThan=M.lt=function(T,O){return b(this,new J(T,O))<0},M.isLessThanOrEqualTo=M.lte=function(T,O){return(O=b(this,new J(T,O)))===-1||O===0},M.isNaN=function(){return!this.s},M.isNegative=function(){return this.s<0},M.isPositive=function(){return this.s>0},M.isZero=function(){return!!this.c&&this.c[0]==0},M.minus=function(T,O){var N,Y,K,W,ee=this,V=ee.s;if(T=new J(T,O),O=T.s,!V||!O)return new J(NaN);if(V!=O)return T.s=-O,ee.plus(T);var X=ee.e/c,re=T.e/c,I=ee.c,B=T.c;if(!X||!re){if(!I||!B)return I?(T.s=-O,T):new J(B?ee:NaN);if(!I[0]||!B[0])return B[0]?(T.s=-O,T):new J(I[0]?ee:de==3?-0:0)}if(X=p(X),re=p(re),I=I.slice(),V=X-re){for((W=V<0)?(V=-V,K=I):(re=X,K=B),K.reverse(),O=V;O--;K.push(0));K.reverse()}else for(Y=(W=(V=I.length)<(O=B.length))?V:O,V=O=0;O<Y;O++)if(I[O]!=B[O]){W=I[O]<B[O];break}if(W&&(K=I,I=B,B=K,T.s=-T.s),O=(Y=B.length)-(N=I.length),O>0)for(;O--;I[N++]=0);for(O=a-1;Y>V;){if(I[--Y]<B[Y]){for(N=Y;N&&!I[--N];I[N]=O);--I[N],I[Y]+=a}I[Y]-=B[Y]}for(;I[0]==0;I.splice(0,1),--re);return I[0]?We(T,I,re):(T.s=de==3?-1:1,T.c=[T.e=0],T)},M.modulo=M.mod=function(T,O){var N,Y,K=this;return T=new J(T,O),!K.c||!T.s||T.c&&!T.c[0]?new J(NaN):!T.c||K.c&&!K.c[0]?new J(K):(Ve==9?(Y=T.s,T.s=1,N=x(K,T,0,3),T.s=Y,N.s*=Y):N=x(K,T,0,Ve),T=K.minus(N.times(T)),!T.c[0]&&Ve==1&&(T.s=K.s),T)},M.multipliedBy=M.times=function(T,O){var N,Y,K,W,ee,V,X,re,I,B,G,Z,ye,Fe,Ye,He=this,$e=He.c,ct=(T=new J(T,O)).c;if(!$e||!ct||!$e[0]||!ct[0])return!He.s||!T.s||$e&&!$e[0]&&!ct||ct&&!ct[0]&&!$e?T.c=T.e=T.s=null:(T.s*=He.s,!$e||!ct?T.c=T.e=null:(T.c=[0],T.e=0)),T;for(Y=p(He.e/c)+p(T.e/c),T.s*=He.s,X=$e.length,B=ct.length,X<B&&(ye=$e,$e=ct,ct=ye,K=X,X=B,B=K),K=X+B,ye=[];K--;ye.push(0));for(Fe=a,Ye=f,K=B;--K>=0;){for(N=0,G=ct[K]%Ye,Z=ct[K]/Ye|0,ee=X,W=K+ee;W>K;)re=$e[--ee]%Ye,I=$e[ee]/Ye|0,V=Z*re+I*G,re=G*re+V%Ye*Ye+ye[W]+N,N=(re/Fe|0)+(V/Ye|0)+Z*I,ye[W--]=re%Fe;ye[W]=N}return N?++Y:ye.splice(0,1),We(T,ye,Y)},M.negated=function(){var T=new J(this);return T.s=-T.s||null,T},M.plus=function(T,O){var N,Y=this,K=Y.s;if(T=new J(T,O),O=T.s,!K||!O)return new J(NaN);if(K!=O)return T.s=-O,Y.minus(T);var W=Y.e/c,ee=T.e/c,V=Y.c,X=T.c;if(!W||!ee){if(!V||!X)return new J(K/0);if(!V[0]||!X[0])return X[0]?T:new J(V[0]?Y:K*0)}if(W=p(W),ee=p(ee),V=V.slice(),K=W-ee){for(K>0?(ee=W,N=X):(K=-K,N=V),N.reverse();K--;N.push(0));N.reverse()}for(K=V.length,O=X.length,K-O<0&&(N=X,X=V,V=N,O=K),K=0;O;)K=(V[--O]=V[O]+X[O]+K)/a|0,V[O]=a===V[O]?0:V[O]%a;return K&&(V=[K].concat(V),++ee),We(T,V,ee)},M.precision=M.sd=function(T,O){var N,Y,K,W=this;if(T!=null&&T!==!!T)return m(T,1,h),O==null?O=de:m(O,0,8),De(new J(W),T,O);if(!(N=W.c))return null;if(K=N.length-1,Y=K*c+1,K=N[K]){for(;K%10==0;K/=10,Y--);for(K=N[0];K>=10;K/=10,Y++);}return T&&W.e+1>Y&&(Y=W.e+1),Y},M.shiftedBy=function(T){return m(T,-u,u),this.times("1e"+T)},M.squareRoot=M.sqrt=function(){var T,O,N,Y,K,W=this,ee=W.c,V=W.s,X=W.e,re=ne+4,I=new J("0.5");if(V!==1||!ee||!ee[0])return new J(!V||V<0&&(!ee||ee[0])?NaN:ee?W:1/0);if(V=Math.sqrt(+ht(W)),V==0||V==1/0?(O=y(ee),(O.length+X)%2==0&&(O+="0"),V=Math.sqrt(+O),X=p((X+1)/2)-(X<0||X%2),V==1/0?O="5e"+X:(O=V.toExponential(),O=O.slice(0,O.indexOf("e")+1)+X),N=new J(O)):N=new J(V+""),N.c[0]){for(X=N.e,V=X+re,V<3&&(V=0);;)if(K=N,N=I.times(K.plus(x(W,K,re,1))),y(K.c).slice(0,V)===(O=y(N.c)).slice(0,V))if(N.e<X&&--V,O=O.slice(V-3,V+1),O=="9999"||!Y&&O=="4999"){if(!Y&&(De(K,K.e+ne+2,0),K.times(K).eq(W))){N=K;break}re+=4,V+=4,Y=1}else{(!+O||!+O.slice(1)&&O.charAt(0)=="5")&&(De(N,N.e+ne+2,1),T=!N.times(N).eq(W));break}}return De(N,N.e+ne+1,de,T)},M.toExponential=function(T,O){return T!=null&&(m(T,0,h),T++),Ie(this,T,O,1)},M.toFixed=function(T,O){return T!=null&&(m(T,0,h),T=T+this.e+1),Ie(this,T,O)},M.toFormat=function(T,O,N){var Y,K=this;if(N==null)T!=null&&O&&typeof O=="object"?(N=O,O=null):T&&typeof T=="object"?(N=T,T=O=null):N=Je;else if(typeof N!="object")throw Error(s+"Argument not an object: "+N);if(Y=K.toFixed(T,O),K.c){var W,ee=Y.split("."),V=+N.groupSize,X=+N.secondaryGroupSize,re=N.groupSeparator||"",I=ee[0],B=ee[1],G=K.s<0,Z=G?I.slice(1):I,ye=Z.length;if(X&&(W=V,V=X,X=W,ye-=W),V>0&&ye>0){for(W=ye%V||V,I=Z.substr(0,W);W<ye;W+=V)I+=re+Z.substr(W,V);X>0&&(I+=re+Z.slice(W)),G&&(I="-"+I)}Y=B?I+(N.decimalSeparator||"")+((X=+N.fractionGroupSize)?B.replace(new RegExp("\\d{"+X+"}\\B","g"),"$&"+(N.fractionGroupSeparator||"")):B):I}return(N.prefix||"")+Y+(N.suffix||"")},M.toFraction=function(T){var O,N,Y,K,W,ee,V,X,re,I,B,G,Z=this,ye=Z.c;if(T!=null&&(V=new J(T),!V.isInteger()&&(V.c||V.s!==1)||V.lt(ae)))throw Error(s+"Argument "+(V.isInteger()?"out of range: ":"not an integer: ")+ht(V));if(!ye)return new J(Z);for(O=new J(ae),re=N=new J(ae),Y=X=new J(ae),G=y(ye),W=O.e=G.length-Z.e-1,O.c[0]=l[(ee=W%c)<0?c+ee:ee],T=!T||V.comparedTo(O)>0?W>0?O:re:V,ee=Ue,Ue=1/0,V=new J(G),X.c[0]=0;I=x(V,O,0,1),K=N.plus(I.times(Y)),K.comparedTo(T)!=1;)N=Y,Y=K,re=X.plus(I.times(K=re)),X=K,O=V.minus(I.times(K=O)),V=K;return K=x(T.minus(N),Y,0,1),X=X.plus(K.times(re)),N=N.plus(K.times(Y)),X.s=re.s=Z.s,W=W*2,B=x(re,Y,W,de).minus(Z).abs().comparedTo(x(X,N,W,de).minus(Z).abs())<1?[re,Y]:[X,N],Ue=ee,B},M.toNumber=function(){return+ht(this)},M.toPrecision=function(T,O){return T!=null&&m(T,1,h),Ie(this,T,O,2)},M.toString=function(T){var O,N=this,Y=N.s,K=N.e;return K===null?Y?(O="Infinity",Y<0&&(O="-"+O)):O="NaN":(T==null?O=K<=me||K>=Ke?R(y(N.c),K):k(y(N.c),K,"0"):T===10&&pe?(N=De(new J(N),ne+K+1,de),O=k(y(N.c),N.e,"0")):(m(T,2,et.length,"Base"),O=D(k(y(N.c),K,"0"),10,T,Y,!0)),Y<0&&N.c[0]&&(O="-"+O)),O},M.valueOf=M.toJSON=function(){return ht(this)},M._isBigNumber=!0,P!=null&&J.set(P),J}function p(P){var x=P|0;return P>0||P===x?x:x-1}function y(P){for(var x,D,U=1,M=P.length,ae=P[0]+"";U<M;){for(x=P[U++]+"",D=c-x.length;D--;x="0"+x);ae+=x}for(M=ae.length;ae.charCodeAt(--M)===48;);return ae.slice(0,M+1||1)}function b(P,x){var D,U,M=P.c,ae=x.c,ne=P.s,de=x.s,me=P.e,Ke=x.e;if(!ne||!de)return null;if(D=M&&!M[0],U=ae&&!ae[0],D||U)return D?U?0:-de:ne;if(ne!=de)return ne;if(D=ne<0,U=me==Ke,!M||!ae)return U?0:!M^D?1:-1;if(!U)return me>Ke^D?1:-1;for(de=(me=M.length)<(Ke=ae.length)?me:Ke,ne=0;ne<de;ne++)if(M[ne]!=ae[ne])return M[ne]>ae[ne]^D?1:-1;return me==Ke?0:me>Ke^D?1:-1}function m(P,x,D,U){if(P<x||P>D||P!==i(P))throw Error(s+(U||"Argument")+(typeof P=="number"?P<x||P>D?" out of range: ":" not an integer: ":" not a primitive number: ")+String(P))}function _(P){var x=P.c.length-1;return p(P.e/c)==x&&P.c[x]%2!=0}function R(P,x){return(P.length>1?P.charAt(0)+"."+P.slice(1):P)+(x<0?"e":"e+")+x}function k(P,x,D){var U,M;if(x<0){for(M=D+".";++x;M+=D);P=M+P}else if(U=P.length,++x>U){for(M=D,x-=U;--x;M+=D);P+=M}else x<U&&(P=P.slice(0,x)+"."+P.slice(x));return P}e=d(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof Uv<"u"&&Uv.exports?Uv.exports=e:(t||(t=typeof self<"u"&&self?self:window),t.BigNumber=e)})(Ywe)});var mk=g((Qwe,Zwe)=>{"use strict";var Pot=Math.exp;Qwe=Zwe.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let r,n=0,i=0,s=0,o,a={};function c(u,l){return 1-Pot(-(u-l)/e)}return a.push=function(l,f){if(o){let h=c(l,o),d=f-r,p=h*d;r=h*f+(1-h)*r,n=(1-h)*(n+d*p),i=Math.sqrt(n),s=r+h*d}else r=f;o=l},a.movingAverage=function(){return r},a.variance=function(){return n},a.deviation=function(){return i},a.forecast=function(){return s},a}});var rbe=g((Zqt,tbe)=>{"use strict";var{EventEmitter:Cot}=Gt(),{BigNumber:qv}=Xwe(),Jwe=mk(),Oot=S2(),ebe=class extends Cot{constructor(e,r){super();this._options=r,this._queue=[],this._stats={dataReceived:qv(0),dataSent:qv(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let n=this._options.movingAverageIntervals;for(let i=0;i<e.length;i++){let s=e[i];this._stats[s]=qv(0),this._movingAverages[s]={};for(let o=0;o<n.length;o++){let a=n[o];(this._movingAverages[s][a]=Jwe(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,r=this.movingAverages,n={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},i=Object.keys(r);for(let s of i){n.movingAverages[s]={};for(let o of Object.keys(r[s]))n.movingAverages[s][o]=r[s][o].movingAverage()}return n}push(e,r){this._queue.push([e,r,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=Oot(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;Object.keys(this._stats).forEach(n=>{this._updateFrequencyFor(n,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,n){let i=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=i/(r||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let l=c[u],f=a[l];f||(f=a[l]=Jwe(l)),f.push(n,o)}}_applyOp(e){let r=e[0],n=e[1];if(typeof n!="number")throw new Error(`invalid increment number: ${n}`);let i;Object.prototype.hasOwnProperty.call(this._stats,r)?i=this._stats[r]:i=this._stats[r]=qv(0),this._stats[r]=i.plus(n),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=n}};tbe.exports=ebe});var sbe=g((Jqt,ibe)=>{"use strict";var kot=Wu(),{pipe:Dot}=br(),{tap:nbe}=Mv(),Not=Wwe(),{METRICS:Bot}=Sv(),wk=rbe(),bk=["dataReceived","dataSent"],Lot={in:"dataReceived",out:"dataSent"},Fv=class{constructor(e){this._options=kot(Bot,e),this._globalThisStats=new wk(bk,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=Not(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._systems=new Map}start(){this._running=!0}stop(){this._running=!1,this._globalThisStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get globalThis(){return this._globalThisStats}get peers(){return Array.from(this._peerStats.keys())}getComponentMetrics(){return this._systems}updateComponentMetric({system:e="libp2p",component:r,metric:n,value:i}){this._systems.has(e)||this._systems.set(e,new Map);let s=this._systems.get(e);s.has(r)||s.set(r,new Map),s.get(r).set(n,i)}forPeer(e){let r=e.toB58String();return this._peerStats.get(r)||this._oldPeers.get(r)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let r=e.toB58String(),n=this._peerStats.get(r);n&&(n.stop(),this._peerStats.delete(r),this._oldPeers.set(r,n))}_onMessage({remotePeer:e,protocol:r,direction:n,dataLength:i}){if(!this._running)return;let s=Lot[n],o=this.forPeer(e);if(o||(o=new wk(bk,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,i),this._globalThisStats.push(s,i),r){let a=this.forProtocol(r);a||(a=new wk(bk,this._options),this._protocolStats.set(r,a)),a.push(s,i)}}updatePlaceholder(e,r){if(!this._running)return;let n=this.forPeer(e),i=r.toB58String(),s=this.forPeer(r),o=n;s&&(o=Fv.mergeStats(s,o),this._oldPeers.delete(i)),this._peerStats.delete(e.toB58String()),this._peerStats.set(i,o),o.start()}trackStream({stream:e,remotePeer:r,protocol:n}){let i=this,s=e.source;e.source=nbe(a=>i._onMessage({remotePeer:r,protocol:n,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>Dot(a,nbe(c=>i._onMessage({remotePeer:r,protocol:n,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,r){return e.stop(),r.stop(),e._queue=[...e._queue,...r._queue],e}};ibe.exports=Fv});var Kv=g((eFt,ube)=>{"use strict";var obe=yi(),abe=xo(),{pipe:Mot}=br(),Uot=oe(),{fromString:qot}=(dt(),se(nn)),Fot=qh(),{source:Kot}=Ea(),cbe=qot(`
`);function _k(t){return abe.encode.single(new obe([t,cbe]))}function jot(t,e){t.push(_k(e))}async function Vot(t,e){t.push(e.reduce((r,n)=>r.append(_k(n)),new obe))}async function zot(t,e){let r=1,n={[Symbol.asyncIterator](){return this},next:()=>t.next(r)},i=n;e&&e.signal&&(i=Kot(n,e.signal));let s=a=>{r=a},o=await Mot(i,abe.decode({onLength:s}),Fot);if(o.get(o.length-1)!==cbe[0])throw Uot(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return o.shallowSlice(0,-1)}ube.exports={encode:_k,write:jot,writeAll:Vot,read:zot}});var hbe=g((tFt,fbe)=>{"use strict";var lbe=he(),Hot=oe(),ky=Kv(),$ot=kd(),Dy=Object.assign(lbe("mss:select"),{error:lbe("mss:select:error")});fbe.exports=async function(e,r,n,i){r=Array.isArray(r)?[...r]:[r];let{reader:s,writer:o,rest:a,stream:c}=$ot(e),u=r.shift();if(!u)throw new Error("At least one protocol must be specified");n?(Dy('select: write ["%s", "%s"]',n,u),ky.writeAll(o,[n,u])):(Dy('select: write "%s"',u),ky.write(o,u));let l=(await ky.read(s,i)).toString();if(Dy('select: read "%s"',l),l===n&&(l=(await ky.read(s,i)).toString(),Dy('select: read "%s"',l)),l===u)return a(),{stream:c,protocol:u};for(let f of r){Dy('select: write "%s"',f),ky.write(o,f);let h=(await ky.read(s,i)).toString();if(Dy('select: read "%s" for "%s"',h,f),h===f)return a(),{stream:c,protocol:f}}throw a(),Hot(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var vk=g(dbe=>{"use strict";dbe.PROTOCOL_ID="/multistream/1.0.0"});var gbe=g((nFt,ybe)=>{"use strict";var pbe=he(),Got=yi(),Ny=Kv(),Wot=kd(),{PROTOCOL_ID:Ek}=vk(),j3=Object.assign(pbe("mss:handle"),{error:pbe("mss:handle:error")});ybe.exports=async function(e,r,n){r=Array.isArray(r)?r:[r];let{writer:i,reader:s,rest:o,stream:a}=Wot(e);for(;;){let c=(await Ny.read(s,n)).toString();if(j3('read "%s"',c),c===Ek){j3('respond with "%s" for "%s"',Ek,c),Ny.write(i,Ek);continue}if(r.includes(c))return Ny.write(i,c),j3('respond with "%s" for "%s"',c,c),o(),{stream:a,protocol:c};if(c==="ls"){Ny.write(i,new Got(r.map(u=>Ny.encode(u)))),j3('respond with "%s" for %s',r,c);continue}Ny.write(i,"na"),j3('respond with "na" for "%s"',c)}}});var _be=g((iFt,bbe)=>{"use strict";var Yot=yw(),mbe=he(),wbe=Kv(),Xot=kd(),Qot=xo(),{pipe:Zot}=br(),Jot=Object.assign(mbe("mss:ls"),{error:mbe("mss:ls:error")});bbe.exports=async function(e,r){let{reader:n,writer:i,rest:s,stream:o}=Xot(e);Jot('write "ls"'),wbe.write(i,"ls"),s();let a=await wbe.read(n,r),c=Yot([a]),u=[];return await Zot(c,Qot.decode(),async f=>{for await(let h of f)u.push(h.shallowSlice(0,-1).toString())}),{stream:o,protocols:u}}});var Abe=g(jv=>{"use strict";var vbe=hbe(),eat=gbe(),tat=_be(),{PROTOCOL_ID:Sk}=vk();jv.PROTOCOL_ID=Sk;var Ak=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(e){if(this._shaken)return;let{stream:r}=await vbe(this._stream,Sk,void 0,e);this._stream=r,this._shaken=!0}},Ebe=class extends Ak{select(e,r){return vbe(this._stream,e,this._shaken?void 0:Sk,r)}async ls(e){await this._handshake(e);let r=await tat(this._stream,e),{stream:n,protocols:i}=r;return this._stream=n,i}};jv.Dialer=Ebe;var Sbe=class extends Ak{handle(e,r){return eat(this._stream,e,r)}};jv.Listener=Sbe});var Ibe=g((oFt,Rbe)=>{"use strict";var rat={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};Rbe.exports=rat});var kbe=g((aFt,Obe)=>{"use strict";var Tbe=ft(),{Multiaddr:nat}=yt(),Ks=oe(),{OPEN:iat,CLOSING:xbe,CLOSED:Rk}=Ibe(),Pbe=Symbol.for("@libp2p/interface-connection/connection"),Cbe=class{constructor({localAddr:e,remoteAddr:r,localPeer:n,remotePeer:i,newStream:s,close:o,getStreams:a,stat:c}){sat(e,n,i,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=r,this.localPeer=n,this.remotePeer=i,this._stat={...c,status:iat},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[Pbe](){return!0}static isConnection(e){return Boolean(e&&e[Pbe])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===xbe)throw Ks(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===Rk)throw Ks(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:r,protocol:n}=await this._newStream(e);return this.addStream(r,{protocol:n}),{stream:r,protocol:n}}addStream(e,{protocol:r,metadata:n={}}){this.registry.set(e.id,{protocol:r,...n})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==Rk){if(this._closing)return this._closing;this.stat.status=xbe,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=Rk}}};Obe.exports=Cbe;function sat(t,e,r,n,i,s,o){if(t&&!nat.isMultiaddr(t))throw Ks(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!Tbe.isPeerId(e))throw Ks(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!Tbe.isPeerId(r))throw Ks(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw Ks(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw Ks(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw Ks(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw Ks(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw Ks(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw Ks(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw Ks(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw Ks(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var Nbe=g(Dbe=>{"use strict";Dbe.Connection=kbe()});var Lbe=g((uFt,Bbe)=>{"use strict";function oat(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}else return Array.from(t)}Bbe.exports=function(e){var r=void 0,n=void 0;function i(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');n=a}function s(a){Object.keys(a).forEach(function(c){var u=a[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),r=a}i(function(){}),e&&i(e),s(Reflect);var o=new Proxy({},{get:function(c,u){return function(){for(var l=arguments.length,f=Array(l),h=0;h<l;h++)f[h]=arguments[h];return r[u].apply(null,[n].concat(oat(f.slice(1))))}}});return{setTarget:i,setHandler:s,getTarget:function(){return n},getHandler:function(){return r},proxy:new Proxy(n,o)}}});var Kbe=g((lFt,Fbe)=>{"use strict";var Mbe=he(),qn=Object.assign(Mbe("libp2p:upgrader"),{error:Mbe("libp2p:upgrader:err")}),js=oe(),By=Abe(),{Connection:aat}=Nbe(),cat=ft(),{pipe:uat}=br(),Ube=Lbe(),{codes:Vs}=Rr(),qbe=class{constructor({localPeer:e,metrics:r,connectionGater:n,cryptos:i=new Map,muxers:s=new Map,onConnectionEnd:o=()=>{},onConnection:a=()=>{}}){this.connectionGater=n,this.localPeer=e,this.metrics=r,this.cryptos=i,this.muxers=s,this.protector=null,this.protocols=new Map,this.onConnection=a,this.onConnectionEnd=o}async upgradeInbound(e){let r,n,i,s,o,a,c;if(await this.connectionGater.denyInboundConnection(e))throw js(new Error("The multiaddr connection is blocked by gater.acceptConnection"),Vs.ERR_CONNECTION_INTERCEPTED);if(this.metrics){({setTarget:a,proxy:c}=Ube());let l=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>l}),e=this.metrics.trackStream({stream:e,remotePeer:c})}qn("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{if({conn:r,remotePeer:n,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos),await this.connectionGater.denyInboundEncryptedConnection(n,r))throw js(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Vs.ERR_CONNECTION_INTERCEPTED);this.muxers.size?{stream:i,Muxer:s}=await this._multiplexInbound(r,this.muxers):i=r}catch(l){throw qn.error("Failed to upgrade inbound connection",l),await e.close(l),l}if(await this.connectionGater.denyInboundUpgradedConnection(n,r))throw js(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Vs.ERR_CONNECTION_INTERCEPTED);return this.metrics&&(this.metrics.updatePlaceholder(c,n),a(n)),qn("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:i,Muxer:s,remotePeer:n})}async upgradeOutbound(e){let r=e.remoteAddr.getPeerId();if(!r)throw js(new Error("outbound connection must have a peer id"),Vs.ERR_INVALID_MULTIADDR);let n=cat.createFromB58String(r);if(await this.connectionGater.denyOutboundConnection(n,e))throw js(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),Vs.ERR_CONNECTION_INTERCEPTED);let i,s,o,a,c,u,l;if(this.metrics){({setTarget:u,proxy:l}=Ube());let h=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>h}),e=this.metrics.trackStream({stream:e,remotePeer:l})}qn("Starting the outbound connection upgrade");let f=e;this.protector&&(f=await this.protector.protect(e));try{if({conn:i,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,f,n,this.cryptos),await this.connectionGater.denyOutboundEncryptedConnection(s,i))throw js(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Vs.ERR_CONNECTION_INTERCEPTED);this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(i,this.muxers):o=i}catch(h){throw qn.error("Failed to upgrade outbound connection",h),await e.close(h),h}if(await this.connectionGater.denyOutboundUpgradedConnection(s,i))throw js(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Vs.ERR_CONNECTION_INTERCEPTED);return this.metrics&&(this.metrics.updatePlaceholder(l,s),u(s)),qn("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:r,maConn:n,upgradedConn:i,Muxer:s,remotePeer:o}){let a,c,u;s&&(a=new s({onStream:async h=>{if(!u)return;let d=new By.Listener(h);try{let{stream:p,protocol:y}=await d.handle(Array.from(this.protocols.keys()));qn("%s: incoming stream opened on %s",r,y),this.metrics&&this.metrics.trackStream({stream:p,remotePeer:o,protocol:y}),u.addStream(h,{protocol:y}),this._onStream({connection:u,stream:{...h,...p},protocol:y})}catch(p){qn.error(p)}},onStreamEnd:h=>{u.removeStream(h.id)}}),c=async h=>{qn("%s: starting new stream on %s",r,h);let d=a.newStream(),p=new By.Dialer(d);try{let{stream:y,protocol:b}=await p.select(h);return this.metrics&&this.metrics.trackStream({stream:y,remotePeer:o,protocol:b}),{stream:{...d,...y},protocol:b}}catch(y){throw qn.error("could not create new stream",y),js(y,Vs.ERR_UNSUPPORTED_PROTOCOL)}},uat(i,a,i).catch(qn.error));let l=n.timeline;n.timeline=new Proxy(l,{set:(...h)=>(u&&h[1]==="close"&&h[2]&&!l.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(d){qn.error(d)}finally{this.onConnectionEnd(u)}})().catch(d=>{qn.error(d)}),Reflect.set(...h))}),n.timeline.upgraded=Date.now();let f=()=>{throw js(new Error("connection is not multiplexed"),Vs.ERR_CONNECTION_NOT_MULTIPLEXED)};return u=new aat({localAddr:n.localAddr,remoteAddr:n.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:r,timeline:n.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||f,getStreams:()=>a?a.streams:f(),close:async()=>{await n.close(),a&&a.streams.map(h=>h.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:r,protocol:n}){this.protocols.get(n)({connection:e,stream:r,protocol:n})}async _encryptInbound(e,r,n){let i=new By.Listener(r),s=Array.from(n.keys());qn("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await i.handle(s),c=n.get(a);if(qn("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw js(o,Vs.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,r,n,i){let s=new By.Dialer(r),o=Array.from(i.keys());qn("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),u=i.get(c);if(qn("encrypting outbound connection to %j",n),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,a,n),protocol:c}}catch(a){throw js(a,Vs.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,r){let n=new By.Dialer(e),i=Array.from(r.keys());qn("outbound selecting muxer %s",i);try{let{stream:s,protocol:o}=await n.select(i);qn("%s selected as muxer protocol",o);let a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw js(s,Vs.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,r){let n=new By.Listener(e),i=Array.from(r.keys());qn("inbound handling muxers %s",i);try{let{stream:s,protocol:o}=await n.handle(i),a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw js(s,Vs.ERR_MUXER_UNAVAILABLE)}}};Fbe.exports=qbe});var Vbe=g((fFt,jbe)=>{"use strict";var lat=async function*(t,e){for await(let r of t)await e(r),yield r};jbe.exports=lat});var Xbe=g((hFt,Ybe)=>{"use strict";var zbe=he(),Wd=oe(),{Multiaddr:Hbe}=yt(),Vv=ft(),{codes:ka}=Rr(),$be=Iv(),Gbe=$m(),{pipe:fat}=br(),hat=yo(),dat=fs(),pat=xi(),yat=Vbe(),fr=Object.assign(zbe("libp2p:peer-store:address-book"),{error:zbe("libp2p:peer-store:address-book:err")}),zv="change:multiaddrs",Wbe=class{constructor(e,r,n){this._emit=e,this._store=r,this._addressFilter=n}async consumePeerRecord(e){fr("consumePeerRecord await write lock");let r=await this._store.lock.writeLock();fr("consumePeerRecord got write lock");let n,i;try{let s;try{s=$be.createFromProtobuf(e.payload)}catch{return fr.error("invalid peer record received"),!1}n=s.peerId;let o=s.multiaddrs;if(!n.equals(e.peerId))return fr("signing key does not match PeerId in the PeerRecord"),!1;if(!o||!o.length)return!1;if(await this._store.has(n)){let a=await this._store.load(n);if(a.peerRecordEnvelope){let c=await Gbe.createFromProtobuf(a.peerRecordEnvelope);if($be.createFromProtobuf(c.payload).seqNumber>=s.seqNumber)return!1}}i=await this._store.patchOrCreate(n,{addresses:await Ik(n,o,this._addressFilter,!0),peerRecordEnvelope:e.marshal()}),fr(`stored provided peer record for ${s.peerId.toB58String()}`)}finally{fr("consumePeerRecord release write lock"),r()}return this._emit(zv,{peerId:n,multiaddrs:i.addresses.map(({multiaddr:s})=>s)}),!0}async getRawEnvelope(e){fr("getRawEnvelope await read lock");let r=await this._store.lock.readLock();fr("getRawEnvelope got read lock");try{return(await this._store.load(e)).peerRecordEnvelope}catch(n){if(n.code!==ka.ERR_NOT_FOUND)throw n}finally{fr("getRawEnvelope release read lock"),r()}}async getPeerRecord(e){let r=await this.getRawEnvelope(e);if(!!r)return Gbe.createFromProtobuf(r)}async get(e){if(!Vv.isPeerId(e))throw fr.error("peerId must be an instance of peer-id to store data"),Wd(new Error("peerId must be an instance of peer-id"),ka.ERR_INVALID_PARAMETERS);fr("get wait for read lock");let r=await this._store.lock.readLock();fr("get got read lock");try{return(await this._store.load(e)).addresses}catch(n){if(n.code!==ka.ERR_NOT_FOUND)throw n}finally{fr("get release read lock"),r()}return[]}async set(e,r){if(!Vv.isPeerId(e))throw fr.error("peerId must be an instance of peer-id to store data"),Wd(new Error("peerId must be an instance of peer-id"),ka.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw fr.error("multiaddrs must be an array of Multiaddrs"),Wd(new Error("multiaddrs must be an array of Multiaddrs"),ka.ERR_INVALID_PARAMETERS);fr("set await write lock");let n=await this._store.lock.writeLock();fr("set got write lock");let i=!1,s;try{let o=await Ik(e,r,this._addressFilter);if(!o.length)return;try{let a=await this._store.load(e);if(i=!0,new Set([...o.map(({multiaddr:c})=>c.toString()),...a.addresses.map(({multiaddr:c})=>c.toString())]).size===a.addresses.length&&o.length===a.addresses.length)return}catch(a){if(a.code!==ka.ERR_NOT_FOUND)throw a}s=await this._store.patchOrCreate(e,{addresses:o}),fr(`set multiaddrs for ${e.toB58String()}`)}finally{fr("set release write lock"),n()}this._emit(zv,{peerId:e,multiaddrs:s.addresses.map(o=>o.multiaddr)}),i||this._emit("peer",e)}async add(e,r){if(!Vv.isPeerId(e))throw fr.error("peerId must be an instance of peer-id to store data"),Wd(new Error("peerId must be an instance of peer-id"),ka.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw fr.error("multiaddrs must be an array of Multiaddrs"),Wd(new Error("multiaddrs must be an array of Multiaddrs"),ka.ERR_INVALID_PARAMETERS);fr("add await write lock");let n=await this._store.lock.writeLock();fr("add got write lock");let i,s;try{let o=await Ik(e,r,this._addressFilter);if(!o.length)return;try{let a=await this._store.load(e);if(i=!0,new Set([...o.map(({multiaddr:c})=>c.toString()),...a.addresses.map(({multiaddr:c})=>c.toString())]).size===a.addresses.length)return}catch(a){if(a.code!==ka.ERR_NOT_FOUND)throw a}s=await this._store.mergeOrCreate(e,{addresses:o}),fr(`added multiaddrs for ${e.toB58String()}`)}finally{fr("set release write lock"),n()}this._emit(zv,{peerId:e,multiaddrs:s.addresses.map(o=>o.multiaddr)}),i||this._emit("peer",e)}async delete(e){if(!Vv.isPeerId(e))throw fr.error("peerId must be an instance of peer-id to store data"),Wd(new Error("peerId must be an instance of peer-id"),ka.ERR_INVALID_PARAMETERS);fr("delete await write lock");let r=await this._store.lock.writeLock();fr("delete got write lock");let n;try{n=await this._store.has(e),await this._store.patchOrCreate(e,{addresses:[]})}finally{fr("delete release write lock"),r()}n&&this._emit(zv,{peerId:e,multiaddrs:[]})}async getMultiaddrsForPeer(e,r=n=>n){let n=await this.get(e);return r(n).map(i=>{let s=i.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};function Ik(t,e,r,n=!1){return fat(e,i=>yat(i,s=>{if(!Hbe.isMultiaddr(s))throw fr.error("multiaddr must be an instance of Multiaddr"),Wd(new Error("multiaddr must be an instance of Multiaddr"),ka.ERR_INVALID_PARAMETERS)}),i=>dat(i,s=>r(t,s)),i=>pat(i,s=>({multiaddr:new Hbe(s.toString()),isCertified:n})),i=>hat(i))}Ybe.exports=Wbe});var t8e=g((dFt,e8e)=>{"use strict";var Qbe=he(),Hv=oe(),{codes:Ly}=Rr(),Tk=ft(),{equals:gat}=(bn(),se(Ei)),zs=Object.assign(Qbe("libp2p:peer-store:key-book"),{error:Qbe("libp2p:peer-store:key-book:err")}),Zbe="change:pubkey",Jbe=class{constructor(e,r){this._emit=e,this._store=r}async set(e,r){if(!Tk.isPeerId(e))throw zs.error("peerId must be an instance of peer-id to store data"),Hv(new Error("peerId must be an instance of peer-id"),Ly.ERR_INVALID_PARAMETERS);if(!r)throw zs.error("publicKey must be an instance of PublicKey to store data"),Hv(new Error("publicKey must be an instance of PublicKey"),Ly.ERR_INVALID_PARAMETERS);zs("set await write lock");let n=await this._store.lock.writeLock();zs("set got write lock");let i=!1;try{try{let s=await this._store.load(e);if(s.pubKey&&gat(s.pubKey.bytes,r.bytes))return}catch(s){if(s.code!==Ly.ERR_NOT_FOUND)throw s}await this._store.patchOrCreate(e,{pubKey:r}),i=!0}finally{zs("set release write lock"),n()}i&&this._emit(Zbe,{peerId:e,pubKey:r})}async get(e){if(!Tk.isPeerId(e))throw zs.error("peerId must be an instance of peer-id to store data"),Hv(new Error("peerId must be an instance of peer-id"),Ly.ERR_INVALID_PARAMETERS);zs("get await write lock");let r=await this._store.lock.readLock();zs("get got write lock");try{return(await this._store.load(e)).pubKey}catch(n){if(n.code!==Ly.ERR_NOT_FOUND)throw n}finally{zs("get release write lock"),r()}}async delete(e){if(!Tk.isPeerId(e))throw zs.error("peerId must be an instance of peer-id to store data"),Hv(new Error("peerId must be an instance of peer-id"),Ly.ERR_INVALID_PARAMETERS);zs("delete await write lock");let r=await this._store.lock.writeLock();zs("delete got write lock");try{await this._store.patchOrCreate(e,{pubKey:void 0})}finally{zs("delete release write lock"),r()}this._emit(Zbe,{peerId:e,pubKey:void 0})}};e8e.exports=Jbe});var s8e=g((pFt,i8e)=>{"use strict";var r8e=he(),Kf=oe(),{codes:jo}=Rr(),My=ft(),{equals:mat}=(bn(),se(Ei)),Nr=Object.assign(r8e("libp2p:peer-store:metadata-book"),{error:r8e("libp2p:peer-store:metadata-book:err")}),$v="change:metadata",n8e=class{constructor(e,r){this._emit=e,this._store=r}async get(e){if(!My.isPeerId(e))throw Nr.error("peerId must be an instance of peer-id to store data"),Kf(new Error("peerId must be an instance of peer-id"),jo.ERR_INVALID_PARAMETERS);Nr("get await read lock");let r=await this._store.lock.readLock();Nr("get got read lock");try{return(await this._store.load(e)).metadata}catch(n){if(n.code!==jo.ERR_NOT_FOUND)throw n}finally{Nr("get release read lock"),r()}return new Map}async getValue(e,r){if(!My.isPeerId(e))throw Nr.error("peerId must be an instance of peer-id to store data"),Kf(new Error("peerId must be an instance of peer-id"),jo.ERR_INVALID_PARAMETERS);Nr("getValue await read lock");let n=await this._store.lock.readLock();Nr("getValue got read lock");try{return(await this._store.load(e)).metadata.get(r)}catch(i){if(i.code!==jo.ERR_NOT_FOUND)throw i}finally{Nr("getValue release write lock"),n()}}async set(e,r){if(!My.isPeerId(e))throw Nr.error("peerId must be an instance of peer-id to store data"),Kf(new Error("peerId must be an instance of peer-id"),jo.ERR_INVALID_PARAMETERS);if(!r||!(r instanceof Map))throw Nr.error("valid metadata must be provided to store data"),Kf(new Error("valid metadata must be provided"),jo.ERR_INVALID_PARAMETERS);Nr("set await write lock");let n=await this._store.lock.writeLock();Nr("set got write lock");try{await this._store.mergeOrCreate(e,{metadata:r})}finally{Nr("set release write lock"),n()}this._emit($v,{peerId:e,metadata:r})}async setValue(e,r,n){if(!My.isPeerId(e))throw Nr.error("peerId must be an instance of peer-id to store data"),Kf(new Error("peerId must be an instance of peer-id"),jo.ERR_INVALID_PARAMETERS);if(typeof r!="string"||!(n instanceof Uint8Array))throw Nr.error("valid key and value must be provided to store data"),Kf(new Error("valid key and value must be provided"),jo.ERR_INVALID_PARAMETERS);Nr("setValue await write lock");let i=await this._store.lock.writeLock();Nr("setValue got write lock");let s;try{try{let a=(await this._store.load(e)).metadata.get(r);if(a!=null&&mat(n,a))return}catch(o){if(o.code!==jo.ERR_NOT_FOUND)throw o}s=await this._store.mergeOrCreate(e,{metadata:new Map([[r,n]])})}finally{Nr("setValue release write lock"),i()}this._emit($v,{peerId:e,metadata:s.metadata})}async delete(e){if(!My.isPeerId(e))throw Nr.error("peerId must be an instance of peer-id to store data"),Kf(new Error("peerId must be an instance of peer-id"),jo.ERR_INVALID_PARAMETERS);Nr("delete await write lock");let r=await this._store.lock.writeLock();Nr("delete got write lock");let n;try{n=await this._store.has(e),n&&await this._store.patch(e,{metadata:new Map})}finally{Nr("delete release write lock"),r()}n&&this._emit($v,{peerId:e,metadata:new Map})}async deleteValue(e,r){if(!My.isPeerId(e))throw Nr.error("peerId must be an instance of peer-id to store data"),Kf(new Error("peerId must be an instance of peer-id"),jo.ERR_INVALID_PARAMETERS);Nr("deleteValue await write lock");let n=await this._store.lock.writeLock();Nr("deleteValue got write lock");let i;try{i=(await this._store.load(e)).metadata,i.delete(r),await this._store.patch(e,{metadata:i})}catch(s){if(s.code!==jo.ERR_NOT_FOUND)throw s}finally{Nr("deleteValue release write lock"),n()}i&&this._emit($v,{peerId:e,metadata:i})}};i8e.exports=n8e});var u8e=g((yFt,c8e)=>{"use strict";var o8e=he(),Uy=oe(),{codes:Da}=Rr(),xk=ft(),tn=Object.assign(o8e("libp2p:peer-store:proto-book"),{error:o8e("libp2p:peer-store:proto-book:err")}),Gv="change:protocols",a8e=class{constructor(e,r){this._emit=e,this._store=r}async get(e){tn("get wait for read lock");let r=await this._store.lock.readLock();tn("get got read lock");try{return(await this._store.load(e)).protocols}catch(n){if(n.code!==Da.ERR_NOT_FOUND)throw n}finally{tn("get release read lock"),r()}return[]}async set(e,r){if(!xk.isPeerId(e))throw tn.error("peerId must be an instance of peer-id to store data"),Uy(new Error("peerId must be an instance of peer-id"),Da.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw tn.error("protocols must be provided to store data"),Uy(new Error("protocols must be provided"),Da.ERR_INVALID_PARAMETERS);tn("set await write lock");let n=await this._store.lock.writeLock();tn("set got write lock");let i;try{try{let s=await this._store.load(e);if(new Set([...r]).size===s.protocols.length)return}catch(s){if(s.code!==Da.ERR_NOT_FOUND)throw s}i=await this._store.patchOrCreate(e,{protocols:r}),tn(`stored provided protocols for ${e.toB58String()}`)}finally{tn("set release write lock"),n()}this._emit(Gv,{peerId:e,protocols:i.protocols})}async add(e,r){if(!xk.isPeerId(e))throw tn.error("peerId must be an instance of peer-id to store data"),Uy(new Error("peerId must be an instance of peer-id"),Da.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw tn.error("protocols must be provided to store data"),Uy(new Error("protocols must be provided"),Da.ERR_INVALID_PARAMETERS);tn("add await write lock");let n=await this._store.lock.writeLock();tn("add got write lock");let i;try{try{let s=await this._store.load(e);if(new Set([...s.protocols,...r]).size===s.protocols.length)return}catch(s){if(s.code!==Da.ERR_NOT_FOUND)throw s}i=await this._store.mergeOrCreate(e,{protocols:r}),tn(`added provided protocols for ${e.toB58String()}`)}finally{tn("add release write lock"),n()}this._emit(Gv,{peerId:e,protocols:i.protocols})}async remove(e,r){if(!xk.isPeerId(e))throw tn.error("peerId must be an instance of peer-id to store data"),Uy(new Error("peerId must be an instance of peer-id"),Da.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw tn.error("protocols must be provided to store data"),Uy(new Error("protocols must be provided"),Da.ERR_INVALID_PARAMETERS);tn("remove await write lock");let n=await this._store.lock.writeLock();tn("remove got write lock");let i;try{try{let s=await this._store.load(e),o=new Set(s.protocols);for(let a of r)o.delete(a);if(s.protocols.length===o.size)return;r=Array.from(o)}catch(s){if(s.code!==Da.ERR_NOT_FOUND)throw s}i=await this._store.patchOrCreate(e,{protocols:r})}finally{tn("remove release write lock"),n()}this._emit(Gv,{peerId:e,protocols:i.protocols})}async delete(e){tn("delete await write lock");let r=await this._store.lock.writeLock();tn("delete got write lock");let n;try{n=await this._store.has(e),await this._store.patchOrCreate(e,{protocols:[]})}catch(i){if(i.code!==Da.ERR_NOT_FOUND)throw i}finally{tn("delete release write lock"),r()}n&&this._emit(Gv,{peerId:e,protocols:[]})}};c8e.exports=a8e});var f8e=g((gFt,l8e)=>{"use strict";var jf=Kr(),qy=jf.Reader,Pk=jf.Writer,pr=jf.util,An=jf.roots["libp2p-peer"]||(jf.roots["libp2p-peer"]={});An.Peer=function(){function t(r){if(this.addresses=[],this.protocols=[],this.metadata=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}t.prototype.addresses=pr.emptyArray,t.prototype.protocols=pr.emptyArray,t.prototype.metadata=pr.emptyArray,t.prototype.pubKey=null,t.prototype.peerRecordEnvelope=null;var e;return Object.defineProperty(t.prototype,"_pubKey",{get:pr.oneOfGetter(e=["pubKey"]),set:pr.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_peerRecordEnvelope",{get:pr.oneOfGetter(e=["peerRecordEnvelope"]),set:pr.oneOfSetter(e)}),t.encode=function(n,i){if(i||(i=Pk.create()),n.addresses!=null&&n.addresses.length)for(var s=0;s<n.addresses.length;++s)An.Address.encode(n.addresses[s],i.uint32(10).fork()).ldelim();if(n.protocols!=null&&n.protocols.length)for(var s=0;s<n.protocols.length;++s)i.uint32(18).string(n.protocols[s]);if(n.metadata!=null&&n.metadata.length)for(var s=0;s<n.metadata.length;++s)An.Metadata.encode(n.metadata[s],i.uint32(26).fork()).ldelim();return n.pubKey!=null&&Object.hasOwnProperty.call(n,"pubKey")&&i.uint32(34).bytes(n.pubKey),n.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(n,"peerRecordEnvelope")&&i.uint32(42).bytes(n.peerRecordEnvelope),i},t.decode=function(n,i){n instanceof qy||(n=qy.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new An.Peer;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(An.Address.decode(n,n.uint32()));break;case 2:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(n.string());break;case 3:o.metadata&&o.metadata.length||(o.metadata=[]),o.metadata.push(An.Metadata.decode(n,n.uint32()));break;case 4:o.pubKey=n.bytes();break;case 5:o.peerRecordEnvelope=n.bytes();break;default:n.skipType(a&7);break}}return o},t.fromObject=function(n){if(n instanceof An.Peer)return n;var i=new An.Peer;if(n.addresses){if(!Array.isArray(n.addresses))throw TypeError(".Peer.addresses: array expected");i.addresses=[];for(var s=0;s<n.addresses.length;++s){if(typeof n.addresses[s]!="object")throw TypeError(".Peer.addresses: object expected");i.addresses[s]=An.Address.fromObject(n.addresses[s])}}if(n.protocols){if(!Array.isArray(n.protocols))throw TypeError(".Peer.protocols: array expected");i.protocols=[];for(var s=0;s<n.protocols.length;++s)i.protocols[s]=String(n.protocols[s])}if(n.metadata){if(!Array.isArray(n.metadata))throw TypeError(".Peer.metadata: array expected");i.metadata=[];for(var s=0;s<n.metadata.length;++s){if(typeof n.metadata[s]!="object")throw TypeError(".Peer.metadata: object expected");i.metadata[s]=An.Metadata.fromObject(n.metadata[s])}}return n.pubKey!=null&&(typeof n.pubKey=="string"?pr.base64.decode(n.pubKey,i.pubKey=pr.newBuffer(pr.base64.length(n.pubKey)),0):n.pubKey.length&&(i.pubKey=n.pubKey)),n.peerRecordEnvelope!=null&&(typeof n.peerRecordEnvelope=="string"?pr.base64.decode(n.peerRecordEnvelope,i.peerRecordEnvelope=pr.newBuffer(pr.base64.length(n.peerRecordEnvelope)),0):n.peerRecordEnvelope.length&&(i.peerRecordEnvelope=n.peerRecordEnvelope)),i},t.toObject=function(n,i){i||(i={});var s={};if((i.arrays||i.defaults)&&(s.addresses=[],s.protocols=[],s.metadata=[]),n.addresses&&n.addresses.length){s.addresses=[];for(var o=0;o<n.addresses.length;++o)s.addresses[o]=An.Address.toObject(n.addresses[o],i)}if(n.protocols&&n.protocols.length){s.protocols=[];for(var o=0;o<n.protocols.length;++o)s.protocols[o]=n.protocols[o]}if(n.metadata&&n.metadata.length){s.metadata=[];for(var o=0;o<n.metadata.length;++o)s.metadata[o]=An.Metadata.toObject(n.metadata[o],i)}return n.pubKey!=null&&n.hasOwnProperty("pubKey")&&(s.pubKey=i.bytes===String?pr.base64.encode(n.pubKey,0,n.pubKey.length):i.bytes===Array?Array.prototype.slice.call(n.pubKey):n.pubKey,i.oneofs&&(s._pubKey="pubKey")),n.peerRecordEnvelope!=null&&n.hasOwnProperty("peerRecordEnvelope")&&(s.peerRecordEnvelope=i.bytes===String?pr.base64.encode(n.peerRecordEnvelope,0,n.peerRecordEnvelope.length):i.bytes===Array?Array.prototype.slice.call(n.peerRecordEnvelope):n.peerRecordEnvelope,i.oneofs&&(s._peerRecordEnvelope="peerRecordEnvelope")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,jf.util.toJSONOptions)},t}();An.Address=function(){function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}t.prototype.multiaddr=pr.newBuffer([]),t.prototype.isCertified=null;var e;return Object.defineProperty(t.prototype,"_isCertified",{get:pr.oneOfGetter(e=["isCertified"]),set:pr.oneOfSetter(e)}),t.encode=function(n,i){return i||(i=Pk.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&i.uint32(16).bool(n.isCertified),i},t.decode=function(n,i){n instanceof qy||(n=qy.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new An.Address;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;case 2:o.isCertified=n.bool();break;default:n.skipType(a&7);break}}return o},t.fromObject=function(n){if(n instanceof An.Address)return n;var i=new An.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?pr.base64.decode(n.multiaddr,i.multiaddr=pr.newBuffer(pr.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),n.isCertified!=null&&(i.isCertified=Boolean(n.isCertified)),i},t.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=pr.newBuffer(s.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?pr.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(s.isCertified=n.isCertified,i.oneofs&&(s._isCertified="isCertified")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,jf.util.toJSONOptions)},t}();An.Metadata=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.key="",t.prototype.value=pr.newBuffer([]),t.encode=function(r,n){return n||(n=Pk.create()),r.key!=null&&Object.hasOwnProperty.call(r,"key")&&n.uint32(10).string(r.key),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&n.uint32(18).bytes(r.value),n},t.decode=function(r,n){r instanceof qy||(r=qy.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new An.Metadata;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.key=r.string();break;case 2:s.value=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof An.Metadata)return r;var n=new An.Metadata;return r.key!=null&&(n.key=String(r.key)),r.value!=null&&(typeof r.value=="string"?pr.base64.decode(r.value,n.value=pr.newBuffer(pr.base64.length(r.value)),0):r.value.length&&(n.value=r.value)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.key="",n.bytes===String?i.value="":(i.value=[],n.bytes!==Array&&(i.value=pr.newBuffer(i.value)))),r.key!=null&&r.hasOwnProperty("key")&&(i.key=r.key),r.value!=null&&r.hasOwnProperty("value")&&(i.value=n.bytes===String?pr.base64.encode(r.value,0,r.value.length):n.bytes===Array?Array.prototype.slice.call(r.value):r.value),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,jf.util.toJSONOptions)},t}();l8e.exports=An});var v8e=g((mFt,_8e)=>{"use strict";var h8e=he(),d8e=ft(),p8e=oe(),{codes:Wv}=Rr(),{Key:wat}=(Vr(),se(Mp)),{base32:bat}=(fi(),se(Wc)),{keys:{unmarshalPublicKey:_at,marshalPublicKey:vat}}=oc(),{Multiaddr:y8e}=yt(),{Peer:g8e}=f8e(),Eat=$w(),{equals:Sat}=(bn(),se(Ei)),m8e=Object.assign(h8e("libp2p:peer-store:store"),{error:h8e("libp2p:peer-store:store:err")}),w8e="/peers/",b8e=class{constructor(e){this._datastore=e,this.lock=Eat("peer-store",{singleProcess:!0})}_peerIdToDatastoreKey(e){if(!d8e.isPeerId(e))throw m8e.error("peerId must be an instance of peer-id to store data"),p8e(new Error("peerId must be an instance of peer-id"),Wv.ERR_INVALID_PARAMETERS);let r=e.toString();return new wat(`${w8e}${r}`)}async has(e){return this._datastore.has(this._peerIdToDatastoreKey(e))}async delete(e){await this._datastore.delete(this._peerIdToDatastoreKey(e))}async load(e){let r=await this._datastore.get(this._peerIdToDatastoreKey(e)),n=g8e.decode(r),i=n.pubKey?_at(n.pubKey):e.pubKey,s=new Map;for(let o of n.metadata)s.set(o.key,o.value);return{...n,id:e,pubKey:i,addresses:n.addresses.map(({multiaddr:o,isCertified:a})=>({multiaddr:new y8e(o),isCertified:a||!1})),metadata:s,peerRecordEnvelope:n.peerRecordEnvelope||void 0}}async save(e){if(e.pubKey!=null&&e.id.pubKey!=null&&!Sat(e.pubKey.bytes,e.id.pubKey.bytes))throw m8e.error("peer publicKey bytes do not match peer id publicKey bytes"),p8e(new Error("publicKey bytes do not match peer id publicKey bytes"),Wv.ERR_INVALID_PARAMETERS);let r=new Set,n=g8e.encode({addresses:e.addresses.filter(i=>r.has(i.multiaddr.toString())?!1:(r.add(i.multiaddr.toString()),!0)).sort((i,s)=>i.multiaddr.toString().localeCompare(s.multiaddr.toString())).map(({multiaddr:i,isCertified:s})=>({multiaddr:i.bytes,isCertified:s})),protocols:e.protocols.sort(),pubKey:e.pubKey?vat(e.pubKey):void 0,metadata:[...e.metadata.keys()].sort().map(i=>({key:i,value:e.metadata.get(i)})),peerRecordEnvelope:e.peerRecordEnvelope}).finish();return await this._datastore.put(this._peerIdToDatastoreKey(e.id),n),this.load(e.id)}async patch(e,r){let n=await this.load(e);return await this._patch(e,r,n)}async patchOrCreate(e,r){let n;try{n=await this.load(e)}catch(i){if(i.code!==Wv.ERR_NOT_FOUND)throw i;n={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,r,n)}async _patch(e,r,n){return await this.save({...n,...r,id:e})}async merge(e,r){let n=await this.load(e);return this._merge(e,r,n)}async mergeOrCreate(e,r){let n;try{n=await this.load(e)}catch(i){if(i.code!==Wv.ERR_NOT_FOUND)throw i;n={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,r,n)}async _merge(e,r,n){let i=new Map;return(r.addresses||[]).forEach(s=>{i.set(s.multiaddr.toString(),s.isCertified)}),n.addresses.forEach(({multiaddr:s,isCertified:o})=>{let a=s.toString();i.set(a,Boolean(i.get(a)||o))}),await this.save({id:e,addresses:Array.from(i.entries()).map(([s,o])=>({multiaddr:new y8e(s),isCertified:o})),protocols:Array.from(new Set([...n.protocols||[],...r.protocols||[]])),metadata:new Map([...n.metadata?n.metadata.entries():[],...r.metadata?r.metadata.entries():[]]),pubKey:r.pubKey||(n!=null?n.pubKey:void 0),peerRecordEnvelope:r.peerRecordEnvelope||(n!=null?n.peerRecordEnvelope:void 0)})}async*all(){for await(let e of this._datastore.queryKeys({prefix:w8e})){let r=e.toString().split("/")[2],n=bat.decode(r);yield this.load(d8e.createFromBytes(n))}}};_8e.exports=b8e});var R8e=g((wFt,A8e)=>{"use strict";var E8e=he(),{EventEmitter:Aat}=Gt(),Rat=Xbe(),Iat=t8e(),Tat=s8e(),xat=u8e(),Pat=v8e(),Vo=Object.assign(E8e("libp2p:peer-store"),{error:E8e("libp2p:peer-store:err")}),S8e=class extends Aat{constructor({peerId:e,datastore:r,addressFilter:n}){super();this._peerId=e,this._store=new Pat(r),this.addressBook=new Rat(this.emit.bind(this),this._store,n),this.keyBook=new Iat(this.emit.bind(this),this._store),this.metadataBook=new Tat(this.emit.bind(this),this._store),this.protoBook=new xat(this.emit.bind(this),this._store)}async*getPeers(){Vo("getPeers await read lock");let e=await this._store.lock.readLock();Vo("getPeers got read lock");try{for await(let r of this._store.all())r.id.toB58String()!==this._peerId.toB58String()&&(yield r)}finally{Vo("getPeers release read lock"),e()}}async delete(e){Vo("delete await write lock");let r=await this._store.lock.writeLock();Vo("delete got write lock");try{await this._store.delete(e)}finally{Vo("delete release write lock"),r()}}async get(e){Vo("get await read lock");let r=await this._store.lock.readLock();Vo("get got read lock");try{return this._store.load(e)}finally{Vo("get release read lock"),r()}}async has(e){Vo("has await read lock");let r=await this._store.lock.readLock();Vo("has got read lock");try{return this._store.has(e)}finally{Vo("has release read lock"),r()}}};A8e.exports=S8e});var T8e=g((bFt,I8e)=>{"use strict";function Cat(t,e,r){let n=new t(e,r);n._subscribeAdapter=n.subscribe,n._unsubscribeAdapter=n.unsubscribe;function i(o,a){a&&n.on(o,a),n._subscribeAdapter(o)}function s(o,a){a?n.removeListener(o,a):n.removeAllListeners(o),n.listenerCount(o)===0&&n._unsubscribeAdapter(o)}return n.subscribe=i,n.unsubscribe=s,n}I8e.exports=Cat});var O8e=g((_Ft,C8e)=>{"use strict";var x8e=he(),Oat=Object.assign(x8e("libp2p:registrar"),{error:x8e("libp2p:registrar:err")}),kat=oe(),{codes:{ERR_INVALID_PARAMETERS:Dat}}=Rr(),Nat=nP(),P8e=class{constructor({peerStore:e,connectionManager:r}){this.peerStore=e,this.connectionManager=r,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}async register(e){if(!Nat.isTopology(e))throw Oat.error("topology must be an instance of interfaces/topology"),kat(new Error("topology must be an instance of interfaces/topology"),Dat);let r=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(r,e),await e.setRegistrar(this),r}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,r]of this.topologies)r.disconnect(e.remotePeer)}};C8e.exports=P8e});var N8e=g((vFt,D8e)=>{"use strict";var Fy=Kr(),k8e=Fy.Reader,Bat=Fy.Writer,Zr=Fy.util,V3=Fy.roots["libp2p-identify"]||(Fy.roots["libp2p-identify"]={});V3.Identify=function(){function t(e){if(this.listenAddrs=[],this.protocols=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.protocolVersion="",t.prototype.agentVersion="",t.prototype.publicKey=Zr.newBuffer([]),t.prototype.listenAddrs=Zr.emptyArray,t.prototype.observedAddr=Zr.newBuffer([]),t.prototype.protocols=Zr.emptyArray,t.prototype.signedPeerRecord=Zr.newBuffer([]),t.encode=function(r,n){if(n||(n=Bat.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.listenAddrs!=null&&r.listenAddrs.length)for(var i=0;i<r.listenAddrs.length;++i)n.uint32(18).bytes(r.listenAddrs[i]);if(r.protocols!=null&&r.protocols.length)for(var i=0;i<r.protocols.length;++i)n.uint32(26).string(r.protocols[i]);return r.observedAddr!=null&&Object.hasOwnProperty.call(r,"observedAddr")&&n.uint32(34).bytes(r.observedAddr),r.protocolVersion!=null&&Object.hasOwnProperty.call(r,"protocolVersion")&&n.uint32(42).string(r.protocolVersion),r.agentVersion!=null&&Object.hasOwnProperty.call(r,"agentVersion")&&n.uint32(50).string(r.agentVersion),r.signedPeerRecord!=null&&Object.hasOwnProperty.call(r,"signedPeerRecord")&&n.uint32(66).bytes(r.signedPeerRecord),n},t.decode=function(r,n){r instanceof k8e||(r=k8e.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new V3.Identify;r.pos<i;){var o=r.uint32();switch(o>>>3){case 5:s.protocolVersion=r.string();break;case 6:s.agentVersion=r.string();break;case 1:s.publicKey=r.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(r.bytes());break;case 4:s.observedAddr=r.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;case 8:s.signedPeerRecord=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof V3.Identify)return r;var n=new V3.Identify;if(r.protocolVersion!=null&&(n.protocolVersion=String(r.protocolVersion)),r.agentVersion!=null&&(n.agentVersion=String(r.agentVersion)),r.publicKey!=null&&(typeof r.publicKey=="string"?Zr.base64.decode(r.publicKey,n.publicKey=Zr.newBuffer(Zr.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.listenAddrs){if(!Array.isArray(r.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");n.listenAddrs=[];for(var i=0;i<r.listenAddrs.length;++i)typeof r.listenAddrs[i]=="string"?Zr.base64.decode(r.listenAddrs[i],n.listenAddrs[i]=Zr.newBuffer(Zr.base64.length(r.listenAddrs[i])),0):r.listenAddrs[i].length&&(n.listenAddrs[i]=r.listenAddrs[i])}if(r.observedAddr!=null&&(typeof r.observedAddr=="string"?Zr.base64.decode(r.observedAddr,n.observedAddr=Zr.newBuffer(Zr.base64.length(r.observedAddr)),0):r.observedAddr.length&&(n.observedAddr=r.observedAddr)),r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Identify.protocols: array expected");n.protocols=[];for(var i=0;i<r.protocols.length;++i)n.protocols[i]=String(r.protocols[i])}return r.signedPeerRecord!=null&&(typeof r.signedPeerRecord=="string"?Zr.base64.decode(r.signedPeerRecord,n.signedPeerRecord=Zr.newBuffer(Zr.base64.length(r.signedPeerRecord)),0):r.signedPeerRecord.length&&(n.signedPeerRecord=r.signedPeerRecord)),n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.listenAddrs=[],i.protocols=[]),n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=Zr.newBuffer(i.publicKey))),n.bytes===String?i.observedAddr="":(i.observedAddr=[],n.bytes!==Array&&(i.observedAddr=Zr.newBuffer(i.observedAddr))),i.protocolVersion="",i.agentVersion="",n.bytes===String?i.signedPeerRecord="":(i.signedPeerRecord=[],n.bytes!==Array&&(i.signedPeerRecord=Zr.newBuffer(i.signedPeerRecord)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?Zr.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.listenAddrs&&r.listenAddrs.length){i.listenAddrs=[];for(var s=0;s<r.listenAddrs.length;++s)i.listenAddrs[s]=n.bytes===String?Zr.base64.encode(r.listenAddrs[s],0,r.listenAddrs[s].length):n.bytes===Array?Array.prototype.slice.call(r.listenAddrs[s]):r.listenAddrs[s]}if(r.protocols&&r.protocols.length){i.protocols=[];for(var s=0;s<r.protocols.length;++s)i.protocols[s]=r.protocols[s]}return r.observedAddr!=null&&r.hasOwnProperty("observedAddr")&&(i.observedAddr=n.bytes===String?Zr.base64.encode(r.observedAddr,0,r.observedAddr.length):n.bytes===Array?Array.prototype.slice.call(r.observedAddr):r.observedAddr),r.protocolVersion!=null&&r.hasOwnProperty("protocolVersion")&&(i.protocolVersion=r.protocolVersion),r.agentVersion!=null&&r.hasOwnProperty("agentVersion")&&(i.agentVersion=r.agentVersion),r.signedPeerRecord!=null&&r.hasOwnProperty("signedPeerRecord")&&(i.signedPeerRecord=n.bytes===String?Zr.base64.encode(r.signedPeerRecord,0,r.signedPeerRecord.length):n.bytes===Array?Array.prototype.slice.call(r.signedPeerRecord):r.signedPeerRecord),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Fy.util.toJSONOptions)},t}();D8e.exports=V3});var V8e=g((EFt,j8e)=>{"use strict";var B8e=he(),Hs=Object.assign(B8e("libp2p:identify"),{error:B8e("libp2p:identify:err")}),Ck=oe(),Yv=xo(),{pipe:Xv}=br(),{collect:L8e,take:M8e,consume:U8e}=Mv(),{fromString:Ky}=(dt(),se(nn)),Lat=ft(),{Multiaddr:Ok}=yt(),{toBuffer:q8e}=K_(),z3=N8e(),F8e=$m(),K8e=Iv(),{MULTICODEC_IDENTIFY:Mat,MULTICODEC_IDENTIFY_PUSH:Uat,IDENTIFY_PROTOCOL_VERSION:qat,MULTICODEC_IDENTIFY_PROTOCOL_NAME:Fat,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME:Kat,MULTICODEC_IDENTIFY_PROTOCOL_VERSION:jat,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION:Vat}=KO(),{codes:kk}=Rr(),Yd=class{static getProtocolStr(e){return{identifyProtocolStr:`/${e._config.protocolPrefix}/${Fat}/${jat}`,identifyPushProtocolStr:`/${e._config.protocolPrefix}/${Kat}/${Vat}`}}constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this);let r=Yd.getProtocolStr(e);this.identifyProtocolStr=r.identifyProtocolStr,this.identifyPushProtocolStr=r.identifyPushProtocolStr,this._host={protocolVersion:`${e._config.protocolPrefix}/${qat}`,...e._options.host},this.connectionManager.on("peer:connect",n=>{this.identify(n).catch(Hs.error)}),this.peerStore.on("change:multiaddrs",({peerId:n})=>{n.toString()===this.peerId.toString()&&this.pushToPeerStore().catch(i=>Hs.error(i))}),this.peerStore.on("change:protocols",({peerId:n})=>{n.toString()===this.peerId.toString()&&this.pushToPeerStore().catch(i=>Hs.error(i))})}async start(){await this.peerStore.metadataBook.setValue(this.peerId,"AgentVersion",Ky(this._host.agentVersion)),await this.peerStore.metadataBook.setValue(this.peerId,"ProtocolVersion",Ky(this._host.protocolVersion))}async stop(){}async push(e){let r=await this.peerStore.addressBook.getRawEnvelope(this.peerId),n=this._libp2p.multiaddrs.map(o=>o.bytes),i=await this.peerStore.protoBook.get(this.peerId),s=e.map(async o=>{try{let{stream:a}=await o.newStream(this.identifyPushProtocolStr);await Xv([z3.Identify.encode({listenAddrs:n,signedPeerRecord:r,protocols:i}).finish()],Yv.encode(),a,U8e)}catch(a){Hs.error("could not push identify update to peer",a)}});return Promise.all(s)}async pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],r;for await(let n of this.peerStore.getPeers())n.protocols.includes(this.identifyPushProtocolStr)&&(r=this.connectionManager.get(n.id))&&e.push(r);await this.push(e)}async identify(e){let{stream:r}=await e.newStream(this.identifyProtocolStr),[n]=await Xv([],r,Yv.decode(),M8e(1),q8e,L8e);if(!n)throw Ck(new Error("No data could be retrieved"),kk.ERR_CONNECTION_ENDED);let i;try{i=z3.Identify.decode(n)}catch(h){throw Ck(h,kk.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u}=i,l=await Lat.createFromPubKey(s);if(e.remotePeer.toB58String()!==l.toB58String())throw Ck(new Error("identified peer does not match the expected peer"),kk.ERR_INVALID_PEER);let f=Yd.getCleanMultiaddr(c);try{let h=await F8e.openAndCertify(u,K8e.DOMAIN);if(await this.peerStore.addressBook.consumePeerRecord(h)){await this.peerStore.protoBook.set(l,a),await this.peerStore.metadataBook.setValue(l,"AgentVersion",Ky(i.agentVersion)),await this.peerStore.metadataBook.setValue(l,"ProtocolVersion",Ky(i.protocolVersion));return}}catch(h){Hs("received invalid envelope, discard it and fallback to listenAddrs is available",h)}try{await this.peerStore.addressBook.set(l,o.map(h=>new Ok(h)))}catch(h){Hs.error("received invalid addrs",h)}await this.peerStore.protoBook.set(l,a),await this.peerStore.metadataBook.setValue(l,"AgentVersion",Ky(i.agentVersion)),await this.peerStore.metadataBook.setValue(l,"ProtocolVersion",Ky(i.protocolVersion)),Hs("received observed address of %s",f)}handleMessage({connection:e,stream:r,protocol:n}){switch(n){case this.identifyProtocolStr:return this._handleIdentify({connection:e,stream:r});case this.identifyPushProtocolStr:return this._handlePush({connection:e,stream:r});default:Hs.error("cannot handle unknown protocol %s",n)}}async _handleIdentify({connection:e,stream:r}){try{let n=new Uint8Array(0);this.peerId.pubKey&&(n=this.peerId.pubKey.bytes);let i=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=await this.peerStore.protoBook.get(this.peerId),o=z3.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:n,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:i,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();await Xv([o],Yv.encode(),r,U8e)}catch(n){Hs.error("could not respond to identify request",n)}}async _handlePush({connection:e,stream:r}){let n;try{let[s]=await Xv([],r,Yv.decode(),M8e(1),q8e,L8e);n=z3.Identify.decode(s)}catch(s){return Hs.error("received invalid message",s)}let i=e.remotePeer;try{let s=await F8e.openAndCertify(n.signedPeerRecord,K8e.DOMAIN);if(await this.peerStore.addressBook.consumePeerRecord(s)){await this.peerStore.protoBook.set(i,n.protocols);return}}catch(s){Hs("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{await this.peerStore.addressBook.set(i,n.listenAddrs.map(s=>new Ok(s)))}catch(s){Hs.error("received invalid addrs",s)}try{await this.peerStore.protoBook.set(i,n.protocols)}catch(s){Hs.error("received invalid protocols",s)}}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new Ok(e)}catch{return null}return null}},zat={IDENTIFY:Mat,IDENTIFY_PUSH:Uat};Yd.multicodecs=zat;Yd.Messsage=z3;j8e.exports=Yd});var $8e=g((SFt,H8e)=>{"use strict";var Xd=Kr(),Qv=Xd.Reader,z8e=Xd.Writer,jy=Xd.util,Kc=Xd.roots["libp2p-fetch"]||(Xd.roots["libp2p-fetch"]={});Kc.FetchRequest=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.identifier="",t.encode=function(r,n){return n||(n=z8e.create()),r.identifier!=null&&Object.hasOwnProperty.call(r,"identifier")&&n.uint32(10).string(r.identifier),n},t.decode=function(r,n){r instanceof Qv||(r=Qv.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Kc.FetchRequest;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.identifier=r.string();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Kc.FetchRequest)return r;var n=new Kc.FetchRequest;return r.identifier!=null&&(n.identifier=String(r.identifier)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.identifier=""),r.identifier!=null&&r.hasOwnProperty("identifier")&&(i.identifier=r.identifier),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Xd.util.toJSONOptions)},t}();Kc.FetchResponse=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.status=0,t.prototype.data=jy.newBuffer([]),t.encode=function(r,n){return n||(n=z8e.create()),r.status!=null&&Object.hasOwnProperty.call(r,"status")&&n.uint32(8).int32(r.status),r.data!=null&&Object.hasOwnProperty.call(r,"data")&&n.uint32(18).bytes(r.data),n},t.decode=function(r,n){r instanceof Qv||(r=Qv.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Kc.FetchResponse;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.status=r.int32();break;case 2:s.data=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Kc.FetchResponse)return r;var n=new Kc.FetchResponse;switch(r.status){case"OK":case 0:n.status=0;break;case"NOT_FOUND":case 1:n.status=1;break;case"ERROR":case 2:n.status=2;break}return r.data!=null&&(typeof r.data=="string"?jy.base64.decode(r.data,n.data=jy.newBuffer(jy.base64.length(r.data)),0):r.data.length&&(n.data=r.data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.status=n.enums===String?"OK":0,n.bytes===String?i.data="":(i.data=[],n.bytes!==Array&&(i.data=jy.newBuffer(i.data)))),r.status!=null&&r.hasOwnProperty("status")&&(i.status=n.enums===String?Kc.FetchResponse.StatusCode[r.status]:r.status),r.data!=null&&r.hasOwnProperty("data")&&(i.data=n.bytes===String?jy.base64.encode(r.data,0,r.data.length):n.bytes===Array?Array.prototype.slice.call(r.data):r.data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Xd.util.toJSONOptions)},t.StatusCode=function(){var e={},r=Object.create(e);return r[e[0]="OK"]=0,r[e[1]="NOT_FOUND"]=1,r[e[2]="ERROR"]=2,r}(),t}();H8e.exports=Kc});var W8e=g((AFt,G8e)=>{"use strict";G8e.exports={PROTOCOL:"/libp2p/fetch/0.0.1"}});var J8e=g((Q8e,Z8e)=>{"use strict";var Y8e=he(),Hat=Object.assign(Y8e("libp2p:fetch"),{error:Y8e("libp2p:fetch:err")}),Dk=oe(),{codes:Nk}=Rr(),Zv=xo(),{FetchRequest:Bk,FetchResponse:Na}=$8e(),X8e=kd(),{PROTOCOL:$at}=W8e(),H3=class{constructor(e){this._lookupFunctions=new Map,this._libp2p=e,this.handleMessage=this.handleMessage.bind(this)}async fetch(e,r){Hat("dialing %s to %s",this._protocol,e.toB58String?e.toB58String():e);let n=await this._libp2p.dial(e),{stream:i}=await n.newStream(H3.PROTOCOL),s=X8e(i),o=new Bk({identifier:r});s.write(Zv.encode.single(Bk.encode(o).finish()));let a=Na.decode((await Zv.decode.fromReader(s.reader).next()).value.slice());switch(a.status){case Na.StatusCode.OK:return a.data;case Na.StatusCode.NOT_FOUND:return null;case Na.StatusCode.ERROR:{let c=new TextDecoder().decode(a.data);throw Dk(new Error("Error in fetch protocol response: "+c),Nk.ERR_INVALID_PARAMETERS)}default:throw Dk(new Error("Unknown response status"),Nk.ERR_INVALID_MESSAGE)}}async handleMessage(e){let{stream:r}=e,n=X8e(r),i=Bk.decode((await Zv.decode.fromReader(n.reader).next()).value.slice()),s,o=this._getLookupFunction(i.identifier);if(o){let a=await o(i.identifier);a?s=new Na({status:Na.StatusCode.OK,data:a}):s=new Na({status:Na.StatusCode.NOT_FOUND})}else{let a=new TextEncoder().encode("No lookup function registered for key: "+i.identifier);s=new Na({status:Na.StatusCode.ERROR,data:a})}n.write(Zv.encode.single(Na.encode(s).finish()))}_getLookupFunction(e){for(let r of this._lookupFunctions.keys())if(e.startsWith(r))return this._lookupFunctions.get(r);return null}registerLookupFunction(e,r){if(this._lookupFunctions.has(e))throw Dk(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),Nk.ERR_KEY_ALREADY_EXISTS);this._lookupFunctions.set(e,r)}unregisterLookupFunction(e,r){r!=null&&this._lookupFunctions.get(e)!==r||this._lookupFunctions.delete(e)}};H3.PROTOCOL=$at;Q8e=Z8e.exports=H3});var t_e=g((RFt,e_e)=>{"use strict";e_e.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32,PROTOCOL_VERSION:"1.0.0",PROTOCOL_NAME:"ping"}});var c_e=g((IFt,a_e)=>{"use strict";var r_e=he(),Gat=Object.assign(r_e("libp2p:ping"),{error:r_e("libp2p:ping:err")}),Wat=oe(),{codes:Yat}=Rr(),Xat=oc(),{pipe:n_e}=br(),{toBuffer:Qat}=K_(),{collect:Zat,take:Jat}=Mv(),{equals:ect}=(bn(),se(Ei)),{PROTOCOL_NAME:i_e,PING_LENGTH:tct,PROTOCOL_VERSION:s_e}=t_e(),o_e=class{static getProtocolStr(e){return`/${e._config.protocolPrefix}/${i_e}/${s_e}`}constructor(e){this._libp2p=e}handleMessage({stream:e}){return n_e(e,e)}async ping(e){let r=`/${this._libp2p._config.protocolPrefix}/${i_e}/${s_e}`;Gat("dialing %s to %s",r,e.toB58String?e.toB58String():e);let n=await this._libp2p.dial(e),{stream:i}=await n.newStream(r),s=Date.now(),o=Xat.randomBytes(tct),[a]=await n_e([o],i,u=>Jat(1,u),Qat,Zat),c=Date.now();if(!ect(o,a))throw Wat(new Error("Received wrong ping ack"),Yat.ERR_WRONG_PING_ACK);return c-s}};a_e.exports=o_e});var u_e=g(()=>{});var l_e=g(Lk=>{"use strict";Object.defineProperty(Lk,"__esModule",{value:!0}),Lk.promisify=Jv;var rct="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function Jv(t){if(typeof t!="function")throw new TypeError("Argument to promisify must be a function");var e=t[rct],r=Jv.Promise||Promise;if(typeof r!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var n=this,i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return new r(function(a,c){s.push(function(u){if(u)return c(u);for(var l=arguments.length,f=Array(1<l?l-1:0),h=1;h<l;h++)f[h-1]=arguments[h];if(f.length===1||!e)return a(f[0]);var d={};f.forEach(function(p,y){var b=e[y];b&&(d[b]=p)}),a(d)}),t.apply(n,s)})}}Jv.argumentNames="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__",Jv.Promise=void 0});var h_e=g((CFt,f_e)=>{"use strict";var nct=b7(),e7=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,$3=nct(),ict=e7&&!$3,sct=$3&&!e7,oct=$3&&e7,act=typeof La=="function"&&typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!$3,cct=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerglobalThisScope<"u"&&self instanceof WorkerglobalThisScope,uct=typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"]==="test",lct=typeof navigator<"u"&&navigator.product==="ReactNative";f_e.exports={isTest:uct,isElectron:$3,isElectronMain:sct,isElectronRenderer:oct,isNode:act,isBrowser:ict,isWebWorker:cct,isEnvWithDom:e7,isReactNative:lct}});var p_e=g((OFt,d_e)=>{function zo(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}d_e.exports=zo;zo.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};zo.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};zo.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0};zo.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};zo.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};zo.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};zo.prototype.start=zo.prototype.try;zo.prototype.errors=function(){return this._errors};zo.prototype.attempts=function(){return this._attempts};zo.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],s=i.message,o=(t[s]||0)+1;t[s]=o,o>=r&&(e=i,r=o)}return e}});var y_e=g(Qd=>{var fct=p_e();Qd.operation=function(t){var e=Qd.timeouts(t);return new fct(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};Qd.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],i=0;i<e.retries;i++)n.push(this.createTimeout(i,e));return t&&t.forever&&!n.length&&n.push(this.createTimeout(i,e)),n.sort(function(s,o){return s-o}),n};Qd.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,n=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return n=Math.min(n,e.maxTimeout),n};Qd.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var n in t)typeof t[n]=="function"&&r.push(n)}for(var i=0;i<r.length;i++){var s=r[i],o=t[s];t[s]=function(c){var u=Qd.operation(e),l=Array.prototype.slice.call(arguments,1),f=l.pop();l.push(function(h){u.retry(h)||(h&&(arguments[0]=u.mainError()),f.apply(this,arguments))}),u.attempt(function(){c.apply(t,l)})}.bind(t,o),t[s].options=e}}});var m_e=g((DFt,g_e)=>{g_e.exports=y_e()});var b_e=g((NFt,t7)=>{"use strict";var hct=m_e(),dct=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],Mk=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},pct=(t,e,r)=>{let n=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=n,t},yct=t=>dct.includes(t),w_e=(t,e)=>new Promise((r,n)=>{e={onFailedAttempt:()=>{},retries:10,...e};let i=hct.operation(e);i.attempt(async s=>{try{r(await t(s))}catch(o){if(!(o instanceof Error)){n(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof Mk)i.stop(),n(o.originalError);else if(o instanceof TypeError&&!yct(o.message))i.stop(),n(o);else{pct(o,s,e);try{await e.onFailedAttempt(o)}catch(a){n(a);return}i.retry(o)||n(i.mainError())}}})});t7.exports=w_e;t7.exports.default=w_e;t7.exports.AbortError=Mk});var v_e=g((BFt,__e)=>{"use strict";function gct(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^::1$/.test(t)}__e.exports=gct});var S_e=g((LFt,E_e)=>{"use strict";var mct=v_e();function wct(t){let{address:e}=t.nodeAddress();return mct(e)}E_e.exports=wct});var P_e=g((MFt,x_e)=>{"use strict";var bct=u_e(),A_e=he(),{promisify:Uk}=l_e(),{Multiaddr:_ct}=yt(),Vy=Object.assign(A_e("libp2p:nat"),{error:A_e("libp2p:nat:err")}),{isBrowser:R_e}=h_e(),qk=b_e(),vct=cv(),I_e=FO(),Ect=oe(),{codes:{ERR_INVALID_PARAMETERS:Sct}}=Rr(),Act=S_e(),Fk=7200;function Rct(t=1024,e=65535){return Math.floor(Math.random()*(e-t+1)+t)}var T_e=class{constructor({peerId:e,addressManager:r,transportManager:n,...i}){if(this._peerId=e,this._addressManager=r,this._transportManager=n,this._enabled=i.enabled,this._externalIp=i.externalIp,this._options={description:i.description||`${I_e.name}@${I_e.version} ${this._peerId}`,ttl:i.ttl||Fk,autoUpdate:i.keepAlive||!0,gateway:i.gateway,enablePMP:Boolean(i.pmp&&i.pmp.enabled)},this._options.ttl<Fk)throw Ect(new Error(`NatManager ttl should be at least ${Fk} seconds`),Sct)}start(){R_e||!this._enabled||this._start().catch(e=>{Vy.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let r of e){let{family:n,host:i,port:s,transport:o}=r.toOptions();if(!r.isThinWaistAddress()||o!=="tcp"||Act(r)||n!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(vct(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=Rct();Vy(`opening uPnP connection from ${c}:${u} to ${i}:${s}`),await a.map({publicPort:u,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(_ct.fromNodeAddress({family:4,address:c,port:u},o))}}_getClient(){if(this._client)return this._client;let e=new bct(this._options),r=Uk(e.map.bind(e)),n=Uk(e.destroy.bind(e)),i=Uk(e.externalIp.bind(e));return this._client={map:(...s)=>qk(()=>r(...s),{onFailedAttempt:Vy.error,unref:!0}),destroy:(...s)=>qk(()=>n(...s),{onFailedAttempt:Vy.error,unref:!0}),externalIp:(...s)=>qk(()=>i(...s),{onFailedAttempt:Vy.error,unref:!0})},this._client}async stop(){if(!(R_e||!this._client))try{await this._client.destroy(),this._client=null}catch(e){Vy.error(e)}}};x_e.exports=T_e});var B_e=g((UFt,N_e)=>{"use strict";var C_e=he(),Ni=Object.assign(C_e("libp2p"),{error:C_e("libp2p:err")}),{EventEmitter:Ict}=Gt(),Kk=oe(),Tct=ft(),{Multiaddr:xct}=yt(),{MemoryDatastore:Pct}=(b5(),se(YS)),Cct=R4e(),Oct=O4e(),jk=qO(),{validate:kct}=I6e(),{codes:r7,messages:Dct}=Rr(),Nct=P6e(),Bct=$6e(),Lct=Q6e(),O_e=I5e(),Mct=U5e(),Uct=iwe(),k_e=Hwe(),qct=sbe(),Fct=YO(),Kct=Kbe(),jct=R8e(),Vct=T8e(),zct=O8e(),D_e=V8e(),Vk=J8e(),zk=c_e(),Hct=P_e(),{updateSelfPeerRecord:$ct}=GO(),G3=class extends Ict{static async create(e){if(e.peerId)return new G3(e);let r=await Tct.create();return e.peerId=r,new G3(e)}constructor(e){super();if(this._options=kct(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this._options.metrics.enabled){let n=new qct({...this._options.metrics});this.metrics=n}if(this.connectionGater={denyDialPeer:async()=>Promise.resolve(!1),denyDialMultiaddr:async()=>Promise.resolve(!1),denyInboundConnection:async()=>Promise.resolve(!1),denyOutboundConnection:async()=>Promise.resolve(!1),denyInboundEncryptedConnection:async()=>Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>Promise.resolve(!1),denyInboundUpgradedConnection:async()=>Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>Promise.resolve(!1),filterMultiaddrForPeer:async()=>Promise.resolve(!0),...this._options.connectionGater},this.peerStore=new jct({peerId:this.peerId,datastore:this.datastore&&this._options.peerStore.persistence?this.datastore:new Pct,addressFilter:this.connectionGater.filterMultiaddrForPeer}),this.addresses=this._options.addresses,this.addressManager=new Nct(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{$ct(this).catch(n=>{Ni.error("Error updating self peer record",n)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new Bct(this,{...this._options.connectionManager}),this._autodialler=new Lct(this,{enabled:this._config.peerDiscovery.autoDial,minConnections:this._options.connectionManager.minConnections,autoDialInterval:this._options.connectionManager.autoDialInterval}),this._options.keychain&&this._options.keychain.datastore){Ni("creating keychain");let n=k_e.generateOptions();this.keychain=new k_e(this._options.keychain.datastore,{...n,...this._options.keychain}),Ni("keychain constructed")}if(this.upgrader=new Kct({connectionGater:this.connectionGater,localPeer:this.peerId,metrics:this.metrics,onConnection:n=>this.connectionManager.onConnect(n),onConnectionEnd:n=>this.connectionManager.onDisconnect(n)}),this.transportManager=new Fct({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new Hct({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new zct({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw Kk(new Error(Dct.CONN_ENCRYPTION_REQUIRED),r7.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(n=>{this.upgrader.cryptos.set(n.protocol,n)}),this.dialer=new Uct({transportManager:this.transportManager,connectionGater:this.connectionGater,peerStore:this.peerStore,metrics:this.metrics,...this._options.dialer}),this._modules.transport.forEach(n=>{let i=n.prototype[Symbol.toStringTag],s=this._config.transport[i];this.transportManager.add(i,n,s)}),this._config.relay.enabled&&(this.transportManager.add(O_e.prototype[Symbol.toStringTag],O_e),this.relay=new Mct(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(i=>{this.upgrader.muxers.set(i.multicodec,i)}),this.identifyService=new D_e({libp2p:this})),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let n=this._modules.dht;this._dht=n.create({libp2p:this,...this._config.dht})}if(this._modules.pubsub){let n=this._modules.pubsub;this.pubsub=Vct(n,this,this._config.pubsub)}this.peerRouting=new Cct(this),this.contentRouting=new Oct(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this),this.fetchService=new Vk(this),this.pingService=new zk(this)}emit(e,...r){return e==="error"&&!this._events.error?(Ni.error(r),!1):super.emit(e,...r)}async start(){Ni("libp2p is starting"),this.identifyService&&await this.handle(Object.values(D_e.getProtocolStr(this)),this.identifyService.handleMessage),this.fetchService&&await this.handle(Vk.PROTOCOL,this.fetchService.handleMessage),this.pingService&&await this.handle(zk.getProtocolStr(this),this.pingService.handleMessage);try{await this._onStarting(),await this._onDidStart(),Ni("libp2p has started")}catch(e){throw this.emit("error",e),Ni.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){Ni("libp2p is stopping");try{this._isStarted=!1,this.identifyService&&await this.identifyService.stop(),this.relay&&this.relay.stop(),this.peerRouting.stop(),await this._autodialler.stop(),await(this._dht&&this._dht.stop());for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),await this.unhandle(Vk.PROTOCOL),await this.unhandle(zk.getProtocolStr(this)),this.dialer.destroy()}catch(e){e&&(Ni.error(e),this.emit("error",e))}Ni("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch{await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,r){return this._dial(e,r)}async dialProtocol(e,r,n){if(!r||!r.length)throw Kk(new Error("no protocols were provided to open a stream"),r7.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,n)).newStream(r)}async _dial(e,r){let{id:n,multiaddrs:i}=jk(e);if(n.equals(this.peerId))throw Kk(new Error("Cannot dial self"),r7.ERR_DIALED_SELF);let s=this.connectionManager.get(n);return s?i&&await this.peerStore.addressBook.add(n,i):s=await this.dialer.connectToPeer(e,r),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(i=>i.toString());e.length||(e=this.transportManager.getAddrs().map(i=>i.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(i=>i.toString()));let r=this._options.addresses.announceFilter,n=new Set(e);return r(Array.from(n).map(i=>new xct(i)))}async hangUp(e){let{id:r}=jk(e),n=this.connectionManager.connections.get(r.toB58String());!n||await Promise.all(n.map(i=>i.close()))}fetch(e,r){return this.fetchService.fetch(e,r)}ping(e){let{id:r,multiaddrs:n}=jk(e);return n?this.pingService.ping(n[0]):this.pingService.ping(r)}async handle(e,r){e=Array.isArray(e)?e:[e],e.forEach(n=>{this.upgrader.protocols.set(n,r)}),await this.peerStore.protoBook.add(this.peerId,e)}async unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(r=>{this.upgrader.protocols.delete(r)}),await this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),this._config.pubsub.enabled&&this.pubsub&&await this.pubsub.start(),this._config.dht.enabled&&(this._dht&&await this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start(),this.identifyService&&await this.identifyService.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e).catch(r=>{Ni.error(r)})});for await(let e of this.peerStore.getPeers())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._autodialler.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){Ni.error(new Error(r7.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs).catch(r=>Ni.error(r)),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols).catch(r=>Ni.error(r))}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){Ni("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(n){Ni.error(`could not connect to discovered peer ${e.toB58String()} with ${n}`)}}}async _setupPeerDiscovery(){let e=r=>{let n={enabled:!0};if(r.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[r.tag]&&(n={...n,...this._config.peerDiscovery[r.tag]}),n.enabled&&!this._discovery.has(r.tag)){let i;typeof r=="function"?i=new r(Object.assign({},n,{peerId:this.peerId,libp2p:this})):i=r,i.on("peer",this._onDiscoveryPeer),this._discovery.set(r.tag,i)}};for(let r of this._modules.peerDiscovery||[])e(r);for(let r of this.transportManager.getTransports())r.discovery&&e(r.discovery);await Promise.all(Array.from(this._discovery.values(),r=>r.start()))}};N_e.exports=G3});function W3({options:t={},peerId:e,multiaddrs:r=[],repo:n,keychainConfig:i={},config:s={}}){let{datastore:o,keys:a}=n,c=Wct({options:t,config:s,datastore:o,keys:a,keychainConfig:i,peerId:e,multiaddrs:r});return typeof t.libp2p=="function"?t.libp2p({libp2pOptions:c,options:t,config:s,datastore:o,peerId:e}):K_e.default.create(c)}function Wct({options:t,config:e,datastore:r,keys:n,keychainConfig:i,peerId:s,multiaddrs:o}){let a=()=>{let p=(0,er.default)(e,"Pubsub.Router")||"gossipsub";if(!kP[p])throw(0,L_e.default)(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${p} router.`),"ERR_NOT_SUPPORTED");return kP[p]},c={datastore:r,peerId:s,modules:{}},u={modules:{pubsub:a(),contentRouting:[],peerRouting:[]},config:{peerDiscovery:{mdns:{enabled:(0,er.default)(t,"config.Discovery.MDNS.Enabled",(0,er.default)(e,"Discovery.MDNS.Enabled",!0))},webRTCStar:{enabled:(0,er.default)(t,"config.Discovery.webRTCStar.Enabled",(0,er.default)(e,"Discovery.webRTCStar.Enabled",!0))},bootstrap:{list:(0,er.default)(t,"config.Bootstrap",(0,er.default)(e,"Bootstrap",[]))}},relay:{enabled:(0,er.default)(t,"relay.enabled",(0,er.default)(e,"relay.enabled",!0)),hop:{enabled:(0,er.default)(t,"relay.hop.enabled",(0,er.default)(e,"relay.hop.enabled",!1)),active:(0,er.default)(t,"relay.hop.active",(0,er.default)(e,"relay.hop.active",!1))}},dht:{enabled:(0,er.default)(e,"Routing.Type","dhtclient")!=="none",clientMode:(0,er.default)(e,"Routing.Type","dht")!=="dhtserver",kBucketSize:(0,er.default)(t,"dht.kBucketSize",20),validators:{ipns:mh}},pubsub:{enabled:(0,er.default)(t,"config.Pubsub.Enabled",(0,er.default)(e,"Pubsub.Enabled",!0))},nat:{enabled:!(0,er.default)(e,"Swarm.DisableNatPortMap",!1)}},addresses:{listen:o.map(p=>p.toString()),announce:(0,er.default)(t,"addresses.announce",(0,er.default)(e,"Addresses.Announce",[])),noAnnounce:(0,er.default)(t,"addresses.noAnnounce",(0,er.default)(e,"Addresses.NoAnnounce",[]))},connectionManager:(0,er.default)(t,"connectionManager",{maxConnections:(0,er.default)(t,"config.Swarm.ConnMgr.HighWater",(0,er.default)(e,"Swarm.ConnMgr.HighWater")),minConnections:(0,er.default)(t,"config.Swarm.ConnMgr.LowWater",(0,er.default)(e,"Swarm.ConnMgr.LowWater"))}),keychain:{datastore:n,...i},host:{agentVersion:`js-ipfs/${Uh}`}},l=(0,er.default)(t,"libp2p",void 0);typeof l=="function"&&(l=void 0);let f=Gct(c,o4e(),u,l);(0,er.default)(f,"config.peerDiscovery.bootstrap.list",[]).length>0&&f.modules.peerDiscovery.push(F_e.default);let d=(0,er.default)(t,"config.Addresses.Delegates",(0,er.default)(e,"Addresses.Delegates",[]));if(d.length>0){let p=d[Math.floor(Math.random()*d.length)],y=new q_e.Multiaddr(p).toOptions(),b={host:y.host,protocol:parseInt(y.port)===443?"https":"http",port:y.port},m=r0e(b);u.modules.contentRouting=u.modules.contentRouting||[],u.modules.contentRouting.push(new U_e.default(s,m)),u.modules.peerRouting=u.modules.peerRouting||[],u.modules.peerRouting.push(new M_e.default(m))}return f}var er,L_e,M_e,U_e,q_e,F_e,K_e,Gct,Hk=w(()=>{er=A(hg(),1);Fn();L_e=A(oe(),1);sue();M_e=A(hue(),1),U_e=A(wue(),1);n0e();q_e=A(yt(),1);Dw();a4e();F_e=A(f4e(),1),K_e=A(B_e(),1);wh();Gct=Bt.bind({ignoreUndefined:!0})});var V_e,n7,z_e,Y3,X3,Yct,Xct,Qct,Zct,Jct,j_e,eut,H_e,$_e=w(()=>{V_e=A(he(),1);dae();k5();dt();st();n7=A(ft(),1);Fn();aI();ul();Hk();l1();z_e=Bt.bind({ignoreUndefined:!0}),Y3=(0,V_e.default)("ipfs:components:peer:storage"),X3=class{constructor(e,r,n,i,s){this.print=i,this.peerId=e,this.keychain=r,this.repo=n,this.print=i,this.isNew=s}static async start(e,r,n){let{repoAutoMigrate:i,repo:s,onMigrationProgress:o}=n,a=typeof s=="string"||s==null?hae(e,r,{path:s,autoMigrate:i,onMigrationProgress:o}):s,{peerId:c,keychain:u,isNew:l}=await Yct(e,a,n);return new X3(c,u,a,e,l)}},Yct=async(t,e,r)=>{if(!e.closed)return{...await j_e(e,r),isNew:!1};try{return await e.open(),{...await j_e(e,r),isNew:!1}}catch(n){if(n.code!==Jh)throw n;if(r.init&&r.init.allowNew===!1)throw new Va("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await Xct(t,e,r),isNew:!0}}},Xct=async(t,e,r)=>{let n=r.init||{},i=await e.exists();if(Y3("repo exists?",i),i===!0)throw new Error("repo already exists");let s=n.privateKey?await Qct(n.privateKey):await Zct(t,n),o=Jct(s);Y3("peer identity: %s",o.PeerID);let a={...z_e(H_e(uu(),n.profiles),r.config),Identity:o};await e.init(a),await e.open(),Y3("repo opened");let c={pass:r.pass};try{c.dek=await e.config.get("Keychain.DEK")}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}let u=await W3({options:void 0,multiaddrs:void 0,peerId:s,repo:e,config:a,keychainConfig:c});return u.keychain&&u.keychain.opts&&(await u.loadKeychain(),await e.config.set("Keychain",{DEK:u.keychain.opts.dek})),{peerId:s,keychain:u.keychain}},Qct=t=>(Y3("using user-supplied private-key"),typeof t=="object"?t:n7.default.createFromPrivKey(tt(t,"base64pad"))),Zct=(t,{algorithm:e="Ed25519",bits:r=2048})=>(t("generating %s keypair...",e),n7.default.create({keyType:e,bits:r})),Jct=t=>({PeerID:t.toB58String(),PrivKey:Xe(t.privKey.bytes,"base64pad")}),j_e=async(t,e)=>{let r=e.config,n=e.init&&e.init.profiles||[],i=e.pass,s=await t.config.getAll(),o=eut(H_e(s,n),r);if(s!==o&&await t.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new al("No private key was found in the config, please intialize the repo");let a=await n7.default.createFromPrivKey(o.Identity.PrivKey),c=await W3({options:void 0,multiaddrs:void 0,peerId:a,repo:t,config:o,keychainConfig:{pass:i,...o.Keychain}});return c.keychain&&await c.loadKeychain(),{peerId:a,keychain:c.keychain}},eut=(t,e)=>e?z_e(t,e):t,H_e=(t,e)=>(e||[]).reduce((r,n)=>{let i=H0[n];if(!i)throw new Error(`Could not find profile with name '${n}'`);return Y3("applying profile %s",n),i.transform(r)},t)});var X_e=g((tKt,Y_e)=>{Y_e.exports=W_e;var G_e=128,tut=127,rut=~tut,nut=Math.pow(2,31);function W_e(t,e,r){e=e||[],r=r||0;for(var n=r;t>=nut;)e[r++]=t&255|G_e,t/=128;for(;t&rut;)e[r++]=t&255|G_e,t>>>=7;return e[r]=t|0,W_e.bytes=r-n+1,e}});var J_e=g((rKt,Z_e)=>{Z_e.exports=$k;var iut=128,Q_e=127;function $k(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw $k.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Q_e)<<i:(o&Q_e)*Math.pow(2,i),i+=7}while(o>=iut);return $k.bytes=s-n,r}});var tve=g((nKt,eve)=>{var sut=Math.pow(2,7),out=Math.pow(2,14),aut=Math.pow(2,21),cut=Math.pow(2,28),uut=Math.pow(2,35),lut=Math.pow(2,42),fut=Math.pow(2,49),hut=Math.pow(2,56),dut=Math.pow(2,63);eve.exports=function(t){return t<sut?1:t<out?2:t<aut?3:t<cut?4:t<uut?5:t<lut?6:t<fut?7:t<hut?8:t<dut?9:10}});var nve=g((iKt,rve)=>{rve.exports={encode:X_e(),decode:J_e(),encodingLength:tve()}});var ove=g((sKt,sve)=>{"use strict";var ive=nve();sve.exports=t=>{if(!(t instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;t.length>0;){let r=ive.decode(t);e.push(r),t=t.slice(ive.decode.bytes)}return e}});function put(t){let e=new Uint8Array(t.reduce((n,i)=>n+Q3.default.encodingLength(i),0)),r=0;for(let n of t)e=Q3.encode(n,e,r),r+=Q3.default.encodingLength(n);return e}var Q3,ave,cve=w(()=>{Q3=A(ns(),1);ave=put});var i7,uve=w(()=>{wn();i7=class{constructor(e,r,n){this._refCounter=1,this.cid=e,this.priority=r||1,this.wantType=n}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(bt)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}}});var Ba,jc,Z3,ir,Xt,$s,Gk=w(()=>{Ba=A(Kr(),1),jc=Ba.default.Reader,Z3=Ba.default.Writer,ir=Ba.default.util,Xt=Ba.default.roots["ipfs-bitswap"]||(Ba.default.roots["ipfs-bitswap"]={}),$s=Xt.Message=(()=>{function t(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.wantlist=null,t.prototype.blocks=ir.emptyArray,t.prototype.payload=ir.emptyArray,t.prototype.blockPresences=ir.emptyArray,t.prototype.pendingBytes=0,t.encode=function(r,n){if(n||(n=Z3.create()),r.wantlist!=null&&Object.hasOwnProperty.call(r,"wantlist")&&Xt.Message.Wantlist.encode(r.wantlist,n.uint32(10).fork()).ldelim(),r.blocks!=null&&r.blocks.length)for(var i=0;i<r.blocks.length;++i)n.uint32(18).bytes(r.blocks[i]);if(r.payload!=null&&r.payload.length)for(var i=0;i<r.payload.length;++i)Xt.Message.Block.encode(r.payload[i],n.uint32(26).fork()).ldelim();if(r.blockPresences!=null&&r.blockPresences.length)for(var i=0;i<r.blockPresences.length;++i)Xt.Message.BlockPresence.encode(r.blockPresences[i],n.uint32(34).fork()).ldelim();return r.pendingBytes!=null&&Object.hasOwnProperty.call(r,"pendingBytes")&&n.uint32(40).int32(r.pendingBytes),n},t.decode=function(r,n){r instanceof jc||(r=jc.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Xt.Message;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.wantlist=Xt.Message.Wantlist.decode(r,r.uint32());break;case 2:s.blocks&&s.blocks.length||(s.blocks=[]),s.blocks.push(r.bytes());break;case 3:s.payload&&s.payload.length||(s.payload=[]),s.payload.push(Xt.Message.Block.decode(r,r.uint32()));break;case 4:s.blockPresences&&s.blockPresences.length||(s.blockPresences=[]),s.blockPresences.push(Xt.Message.BlockPresence.decode(r,r.uint32()));break;case 5:s.pendingBytes=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Xt.Message)return r;var n=new Xt.Message;if(r.wantlist!=null){if(typeof r.wantlist!="object")throw TypeError(".Message.wantlist: object expected");n.wantlist=Xt.Message.Wantlist.fromObject(r.wantlist)}if(r.blocks){if(!Array.isArray(r.blocks))throw TypeError(".Message.blocks: array expected");n.blocks=[];for(var i=0;i<r.blocks.length;++i)typeof r.blocks[i]=="string"?ir.base64.decode(r.blocks[i],n.blocks[i]=ir.newBuffer(ir.base64.length(r.blocks[i])),0):r.blocks[i].length&&(n.blocks[i]=r.blocks[i])}if(r.payload){if(!Array.isArray(r.payload))throw TypeError(".Message.payload: array expected");n.payload=[];for(var i=0;i<r.payload.length;++i){if(typeof r.payload[i]!="object")throw TypeError(".Message.payload: object expected");n.payload[i]=Xt.Message.Block.fromObject(r.payload[i])}}if(r.blockPresences){if(!Array.isArray(r.blockPresences))throw TypeError(".Message.blockPresences: array expected");n.blockPresences=[];for(var i=0;i<r.blockPresences.length;++i){if(typeof r.blockPresences[i]!="object")throw TypeError(".Message.blockPresences: object expected");n.blockPresences[i]=Xt.Message.BlockPresence.fromObject(r.blockPresences[i])}}return r.pendingBytes!=null&&(n.pendingBytes=r.pendingBytes|0),n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.blocks=[],i.payload=[],i.blockPresences=[]),n.defaults&&(i.wantlist=null,i.pendingBytes=0),r.wantlist!=null&&r.hasOwnProperty("wantlist")&&(i.wantlist=Xt.Message.Wantlist.toObject(r.wantlist,n)),r.blocks&&r.blocks.length){i.blocks=[];for(var s=0;s<r.blocks.length;++s)i.blocks[s]=n.bytes===String?ir.base64.encode(r.blocks[s],0,r.blocks[s].length):n.bytes===Array?Array.prototype.slice.call(r.blocks[s]):r.blocks[s]}if(r.payload&&r.payload.length){i.payload=[];for(var s=0;s<r.payload.length;++s)i.payload[s]=Xt.Message.Block.toObject(r.payload[s],n)}if(r.blockPresences&&r.blockPresences.length){i.blockPresences=[];for(var s=0;s<r.blockPresences.length;++s)i.blockPresences[s]=Xt.Message.BlockPresence.toObject(r.blockPresences[s],n)}return r.pendingBytes!=null&&r.hasOwnProperty("pendingBytes")&&(i.pendingBytes=r.pendingBytes),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ba.default.util.toJSONOptions)},t.Wantlist=function(){function e(r){if(this.entries=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.entries=ir.emptyArray,e.prototype.full=!1,e.encode=function(n,i){if(i||(i=Z3.create()),n.entries!=null&&n.entries.length)for(var s=0;s<n.entries.length;++s)Xt.Message.Wantlist.Entry.encode(n.entries[s],i.uint32(10).fork()).ldelim();return n.full!=null&&Object.hasOwnProperty.call(n,"full")&&i.uint32(16).bool(n.full),i},e.decode=function(n,i){n instanceof jc||(n=jc.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new Xt.Message.Wantlist;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.entries&&o.entries.length||(o.entries=[]),o.entries.push(Xt.Message.Wantlist.Entry.decode(n,n.uint32()));break;case 2:o.full=n.bool();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof Xt.Message.Wantlist)return n;var i=new Xt.Message.Wantlist;if(n.entries){if(!Array.isArray(n.entries))throw TypeError(".Message.Wantlist.entries: array expected");i.entries=[];for(var s=0;s<n.entries.length;++s){if(typeof n.entries[s]!="object")throw TypeError(".Message.Wantlist.entries: object expected");i.entries[s]=Xt.Message.Wantlist.Entry.fromObject(n.entries[s])}}return n.full!=null&&(i.full=Boolean(n.full)),i},e.toObject=function(n,i){i||(i={});var s={};if((i.arrays||i.defaults)&&(s.entries=[]),i.defaults&&(s.full=!1),n.entries&&n.entries.length){s.entries=[];for(var o=0;o<n.entries.length;++o)s.entries[o]=Xt.Message.Wantlist.Entry.toObject(n.entries[o],i)}return n.full!=null&&n.hasOwnProperty("full")&&(s.full=n.full),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ba.default.util.toJSONOptions)},e.WantType=function(){let r={},n=Object.create(r);return n[r[0]="Block"]=0,n[r[1]="Have"]=1,n}(),e.Entry=function(){function r(n){if(n)for(var i=Object.keys(n),s=0;s<i.length;++s)n[i[s]]!=null&&(this[i[s]]=n[i[s]])}return r.prototype.block=ir.newBuffer([]),r.prototype.priority=0,r.prototype.cancel=!1,r.prototype.wantType=0,r.prototype.sendDontHave=!1,r.encode=function(i,s){return s||(s=Z3.create()),i.block!=null&&Object.hasOwnProperty.call(i,"block")&&s.uint32(10).bytes(i.block),i.priority!=null&&Object.hasOwnProperty.call(i,"priority")&&s.uint32(16).int32(i.priority),i.cancel!=null&&Object.hasOwnProperty.call(i,"cancel")&&s.uint32(24).bool(i.cancel),i.wantType!=null&&Object.hasOwnProperty.call(i,"wantType")&&s.uint32(32).int32(i.wantType),i.sendDontHave!=null&&Object.hasOwnProperty.call(i,"sendDontHave")&&s.uint32(40).bool(i.sendDontHave),s},r.decode=function(i,s){i instanceof jc||(i=jc.create(i));for(var o=s===void 0?i.len:i.pos+s,a=new Xt.Message.Wantlist.Entry;i.pos<o;){var c=i.uint32();switch(c>>>3){case 1:a.block=i.bytes();break;case 2:a.priority=i.int32();break;case 3:a.cancel=i.bool();break;case 4:a.wantType=i.int32();break;case 5:a.sendDontHave=i.bool();break;default:i.skipType(c&7);break}}return a},r.fromObject=function(i){if(i instanceof Xt.Message.Wantlist.Entry)return i;var s=new Xt.Message.Wantlist.Entry;switch(i.block!=null&&(typeof i.block=="string"?ir.base64.decode(i.block,s.block=ir.newBuffer(ir.base64.length(i.block)),0):i.block.length&&(s.block=i.block)),i.priority!=null&&(s.priority=i.priority|0),i.cancel!=null&&(s.cancel=Boolean(i.cancel)),i.wantType){case"Block":case 0:s.wantType=0;break;case"Have":case 1:s.wantType=1;break}return i.sendDontHave!=null&&(s.sendDontHave=Boolean(i.sendDontHave)),s},r.toObject=function(i,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.block="":(o.block=[],s.bytes!==Array&&(o.block=ir.newBuffer(o.block))),o.priority=0,o.cancel=!1,o.wantType=s.enums===String?"Block":0,o.sendDontHave=!1),i.block!=null&&i.hasOwnProperty("block")&&(o.block=s.bytes===String?ir.base64.encode(i.block,0,i.block.length):s.bytes===Array?Array.prototype.slice.call(i.block):i.block),i.priority!=null&&i.hasOwnProperty("priority")&&(o.priority=i.priority),i.cancel!=null&&i.hasOwnProperty("cancel")&&(o.cancel=i.cancel),i.wantType!=null&&i.hasOwnProperty("wantType")&&(o.wantType=s.enums===String?Xt.Message.Wantlist.WantType[i.wantType]:i.wantType),i.sendDontHave!=null&&i.hasOwnProperty("sendDontHave")&&(o.sendDontHave=i.sendDontHave),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,Ba.default.util.toJSONOptions)},r}(),e}(),t.Block=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.prefix=ir.newBuffer([]),e.prototype.data=ir.newBuffer([]),e.encode=function(n,i){return i||(i=Z3.create()),n.prefix!=null&&Object.hasOwnProperty.call(n,"prefix")&&i.uint32(10).bytes(n.prefix),n.data!=null&&Object.hasOwnProperty.call(n,"data")&&i.uint32(18).bytes(n.data),i},e.decode=function(n,i){n instanceof jc||(n=jc.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new Xt.Message.Block;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.prefix=n.bytes();break;case 2:o.data=n.bytes();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof Xt.Message.Block)return n;var i=new Xt.Message.Block;return n.prefix!=null&&(typeof n.prefix=="string"?ir.base64.decode(n.prefix,i.prefix=ir.newBuffer(ir.base64.length(n.prefix)),0):n.prefix.length&&(i.prefix=n.prefix)),n.data!=null&&(typeof n.data=="string"?ir.base64.decode(n.data,i.data=ir.newBuffer(ir.base64.length(n.data)),0):n.data.length&&(i.data=n.data)),i},e.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.prefix="":(s.prefix=[],i.bytes!==Array&&(s.prefix=ir.newBuffer(s.prefix))),i.bytes===String?s.data="":(s.data=[],i.bytes!==Array&&(s.data=ir.newBuffer(s.data)))),n.prefix!=null&&n.hasOwnProperty("prefix")&&(s.prefix=i.bytes===String?ir.base64.encode(n.prefix,0,n.prefix.length):i.bytes===Array?Array.prototype.slice.call(n.prefix):n.prefix),n.data!=null&&n.hasOwnProperty("data")&&(s.data=i.bytes===String?ir.base64.encode(n.data,0,n.data.length):i.bytes===Array?Array.prototype.slice.call(n.data):n.data),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ba.default.util.toJSONOptions)},e}(),t.BlockPresenceType=function(){let e={},r=Object.create(e);return r[e[0]="Have"]=0,r[e[1]="DontHave"]=1,r}(),t.BlockPresence=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.cid=ir.newBuffer([]),e.prototype.type=0,e.encode=function(n,i){return i||(i=Z3.create()),n.cid!=null&&Object.hasOwnProperty.call(n,"cid")&&i.uint32(10).bytes(n.cid),n.type!=null&&Object.hasOwnProperty.call(n,"type")&&i.uint32(16).int32(n.type),i},e.decode=function(n,i){n instanceof jc||(n=jc.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new Xt.Message.BlockPresence;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.cid=n.bytes();break;case 2:o.type=n.int32();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof Xt.Message.BlockPresence)return n;var i=new Xt.Message.BlockPresence;switch(n.cid!=null&&(typeof n.cid=="string"?ir.base64.decode(n.cid,i.cid=ir.newBuffer(ir.base64.length(n.cid)),0):n.cid.length&&(i.cid=n.cid)),n.type){case"Have":case 0:i.type=0;break;case"DontHave":case 1:i.type=1;break}return i},e.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.cid="":(s.cid=[],i.bytes!==Array&&(s.cid=ir.newBuffer(s.cid))),s.type=i.enums===String?"Have":0),n.cid!=null&&n.hasOwnProperty("cid")&&(s.cid=i.bytes===String?ir.base64.encode(n.cid,0,n.cid.length):i.bytes===Array?Array.prototype.slice.call(n.cid):n.cid),n.type!=null&&n.hasOwnProperty("type")&&(s.type=i.enums===String?Xt.Message.BlockPresenceType[n.type]:n.type),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ba.default.util.toJSONOptions)},e}(),t})()});var fve,lve,yut,Vc,J3=w(()=>{uve();wn();Gk();fve=A(Fd(),1),lve={Block:$s.Wantlist.WantType.Block,Have:$s.Wantlist.WantType.Have},yut=(t,e)=>Array.prototype.slice.call(e,0).sort((r,n)=>{let i=t(r),s=t(n);return i<s?-1:i>s?1:0}),Vc=class{constructor(e,r){this.set=r?(0,fve.default)({system:"ipfs",component:"bitswap",metric:"wantlist",metrics:r.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,r,n){let i=e.toString(bt),s=this.set.get(i);s?(s.inc(),s.priority=r,s.wantType===lve.Have&&n===lve.Block&&(s.wantType=n)):(this.set.set(i,new i7(e,r,n)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let r=e.toString(bt),n=this.set.get(r);!n||(n.dec(),!n.hasRefs()&&(this.set.delete(r),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(yut(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let r=e.toString(bt);return this.set.has(r)}get(e){let r=e.toString(bt);return this.set.get(r)}};Vc.Entry=i7});var gut,Zd,Wk=w(()=>{J3();wn();gut=Vc.Entry,Zd=class{constructor(e,r,n,i,s){this.entry=new gut(e,r,n),this.cancel=Boolean(i),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(bt)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}});var Yk,Ho,s7,Vf=w(()=>{Yk=A(he(),1);bn();Wk();Ho=(t,e)=>{let r=["bitswap"];return e&&r.push(e),t&&r.push(`${t.toB58String().slice(0,8)}`),Object.assign((0,Yk.default)(r.join(":")),{error:(0,Yk.default)(r.concat(["error"]).join(":"))})},s7=(t,e)=>{if(t.size!==e.size)return!1;for(let[r,n]of t){let i=e.get(r);if(i===void 0||n instanceof Uint8Array&&i instanceof Uint8Array&&!ro(n,i)||n instanceof Zd&&i instanceof Zd&&!n.equals(i))return!1}return!0}});var hve,dve,yr,e4=w(()=>{Se();Tn();wn();hve=A(ove(),1);cve();Vf();Gk();Wk();dve=A(oe(),1),yr=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,r,n,i,s){n==null&&(n=yr.WantType.Block);let o=e.toString(bt),a=this.wantlist.get(o);a?(a.wantType===n&&(a.priority=r),i&&(a.cancel=Boolean(i)),s&&(a.sendDontHave=Boolean(s)),n===yr.WantType.Block&&a.wantType===yr.WantType.Have&&(a.wantType=n)):this.wantlist.set(o,new Zd(e,r,n,i,s))}addBlock(e,r){let n=e.toString(bt);this.blocks.set(n,r)}addHave(e){let r=e.toString(bt);this.blockPresences.has(r)||this.blockPresences.set(r,yr.BlockPresenceType.Have)}addDontHave(e){let r=e.toString(bt);this.blockPresences.has(r)||this.blockPresences.set(r,yr.BlockPresenceType.DontHave)}cancel(e){let r=e.toString(bt);this.wantlist.delete(r),this.addEntry(e,0,yr.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),cancel:Boolean(r.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return $s.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),wantType:r.wantType,cancel:Boolean(r.cancel),sendDontHave:Boolean(r.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[r,n]of this.blocks.entries()){let i=L.parse(r),s=i.version,o=i.code,a=i.multihash.code,c=i.multihash.digest.length,u=ave([s,o,a,c]);e.payload.push(new $s.Block({prefix:u,data:n}))}for(let[r,n]of this.blockPresences)e.blockPresences.push(new $s.BlockPresence({cid:L.parse(r).bytes,type:n}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),$s.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!s7(this.wantlist,e.wantlist)||!s7(this.blocks,e.blocks)||!s7(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),r=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${r}>`}};yr.deserialize=async(t,e)=>{let r=$s.decode(t),n=r.wantlist&&r.wantlist.full||!1,i=new yr(n);return r.wantlist&&r.wantlist.entries&&r.wantlist.entries.forEach(s=>{if(!s.block)return;let o=L.decode(s.block);i.addEntry(o,s.priority||0,s.wantType,Boolean(s.cancel),Boolean(s.sendDontHave))}),r.blockPresences&&r.blockPresences.forEach(s=>{if(!s.cid)return;let o=L.decode(s.cid);s.type===yr.BlockPresenceType.Have?i.addHave(o):i.addDontHave(o)}),r.blocks.length>0?(await Promise.all(r.blocks.map(async s=>{let o=await jr.digest(s),a=L.createV0(o);i.addBlock(a,s)})),i):(r.payload.length>0&&(await Promise.all(r.payload.map(async s=>{if(!s.prefix||!s.data)return;let o=(0,hve.default)(s.prefix),a=o[0],c=o[1],u=o[2],l=u===jr.code?jr:e&&await e.getHasher(u);if(!l)throw(0,dve.default)(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let f=await l.digest(s.data),h=L.create(a,c,f);i.addBlock(h,s.data)})),i.setPendingBytes(r.pendingBytes)),i)};yr.blockPresenceSize=t=>t.bytes.length+1;yr.Entry=Zd;yr.WantType={Block:$s.Wantlist.WantType.Block,Have:$s.Wantlist.WantType.Have};yr.BlockPresenceType={Have:$s.BlockPresenceType.Have,DontHave:$s.BlockPresenceType.DontHave}});var pve,yve,gve,t4=w(()=>{pve=Math.pow(2,31)-1,yve=1e3,gve=1});var wve=g((xKt,mve)=>{mve.exports=mut;function mut(t,e,r){var n=null,i=null,s=function(){n&&(clearTimeout(n),i=null,n=null)},o=function(){var c=i;s(),c&&c()},a=function(){if(!e)return t.apply(this,arguments);var c=this,u=arguments,l=r&&!n;if(s(),i=function(){t.apply(c,u)},n=setTimeout(function(){if(n=null,!l){var f=i;return i=null,f()}},e),l)return i()};return a.cancel=s,a.flush=o,a}});var bve,Qk,_ve=w(()=>{bve=A(wve(),1);e4();Vf();t4();Qk=class{constructor(e,r,n){this.peerId=r,this.network=n,this.refcnt=1,this._entries=[],this._log=Ho(e,"msgqueue"),this.sendEntries=(0,bve.default)(this._sendEntries.bind(this),gve)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new yr(!1);this._entries.forEach(r=>{r.cancel?e.cancel(r.cid):e.addEntry(r.cid,r.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(r){this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),r.message);return}this._log("sending message to peer %s",this.peerId.toB58String()),this.network.sendMessage(this.peerId,e).catch(r=>{this._log.error("send error: %s",r.message)})}}});var vve,Zk,Eve=w(()=>{e4();J3();t4();_ve();Vf();wn();vve=A(Fd(),1),Zk=class{constructor(e,r,n,i){this.peers=(0,vve.default)({system:"ipfs",component:"bitswap",metric:"want-manager-peers",metrics:i.metrics}),this.wantlist=new Vc(n,i),this.network=r,this._stats=n,this._peerId=e,this._log=Ho(e,"want")}_addEntries(e,r,n){let i=e.map((s,o)=>new yr.Entry(s,pve-o,yr.WantType.Block,r));i.forEach(s=>{s.cancel?n?this.wantlist.removeForce(s.cid.toString(bt)):this.wantlist.remove(s.cid):(this._log("adding to wl"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(i)}_startPeerHandler(e){let r=this.peers.get(e.toB58String());if(r){r.refcnt++;return}r=new Qk(this._peerId,e,this.network);let n=new yr(!0);for(let i of this.wantlist.entries())n.addEntry(i[1].cid,i[1].priority);return r.addMessage(n),this.peers.set(e.toB58String(),r),r}_stopPeerHandler(e){let r=this.peers.get(e.toB58String());!r||(r.refcnt--,!(r.refcnt>0)&&this.peers.delete(e.toB58String()))}wantBlocks(e,r={}){this._addEntries(e,!1),r&&r.signal&&r.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}}});async function _ut(t,e,r){try{await(0,nD.pipe)([e],rD.default.encode(),t)}catch(n){r(n)}}var rD,nD,Sve,Jk,eD,tD,iD,Ave=w(()=>{rD=A(xo(),1),nD=A(br(),1),Sve=A(v8(),1);e4();t4();Vf();Jk="/ipfs/bitswap/1.0.0",eD="/ipfs/bitswap/1.1.0",tD="/ipfs/bitswap/1.2.0",iD=class{constructor(e,r,n,i={}){this._log=Ho(e.peerId,"network"),this._libp2p=e,this._bitswap=r,this._protocols=[Jk],i.b100Only||(this._protocols.unshift(eD),this._protocols.unshift(tD)),this._stats=n,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=i.hashLoader}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection);let e=new Sve.default({multicodecs:this._protocols,handlers:{onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect}});this._registrarId=await this._libp2p.registrar.register(e);for await(let r of this._libp2p.peerStore.getPeers()){let n=this._libp2p.connectionManager.get(r.id);n&&this._onPeerConnect(n.remotePeer)}}async stop(){this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:r,connection:n}){if(!!this._running){this._log("incoming new bitswap %s connection from %s",e,n.remotePeer.toB58String());try{await(0,nD.pipe)(r,rD.default.decode(),async i=>{for await(let s of i)try{let o=await yr.deserialize(s.slice(),this._hashLoader);await this._bitswap._receiveMessage(n.remotePeer,o)}catch(o){this._bitswap._receiveError(o);break}})}catch(i){this._log(i)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,r,n={}){return this._libp2p.contentRouting.findProviders(e,{timeout:1e4,maxNumProviders:r})}async findAndConnect(e,r){let n=[];for await(let i of this.findProviders(e,3,r))this._log(`connecting to provider ${i.id}`),n.push(this.connectTo(i.id,r).catch(s=>{this._log.error(s)}));await Promise.all(n)}async provide(e,r){await this._libp2p.contentRouting.provide(e,r)}async sendMessage(e,r){if(!this._running)throw new Error("network isn't running");let n=e.toB58String();this._log("sendMessage to %s",n,r);let i=await this._libp2p.dial(e),{stream:s,protocol:o}=await i.newStream([tD,eD,Jk]),a;switch(o){case Jk:a=r.serializeToBitswap100();break;case eD:case tD:a=r.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+o)}_ut(s,a,this._log),this._updateSentStats(e,r.blocks)}async connectTo(e,r){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,r)}_updateSentStats(e,r){let n=e.toB58String();if(this._stats){for(let i of r.values())this._stats.push(n,"dataSent",i.length);this._stats.push(n,"blocksSent",r.size)}}}});var sD,Rve=w(()=>{J3();sD=class{constructor(e){this.partner=e,this.wantlist=new Vc,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,r,n){this.wantlist.add(e,r,n)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}});var o7,Ive=w(()=>{o7=class extends Map{constructor(e,r){super();this._cmp=r||this._defaultSort,this._keys=[];for(let[n,i]of e||[])this.set(n,i)}update(e){if(e<0||e>=this._keys.length)return;let r=this._keys[e];this._keys.splice(e,1);let n=this._find(r);this._keys.splice(n,0,r)}set(e,r){if(this.has(e)){let i=this.indexOf(e);this._keys.splice(i,1)}super.set(e,r);let n=this._find(e);return this._keys.splice(n,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let r=this.indexOf(e);return this._keys.splice(r,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let r=this._find(e);if(this._keys[r]===e)return r;for(let n=1;n<this._keys.length;n++){if(this._keys[r+n]===e)return r+n;if(this._keys[r-n]===e)return r-n}return-1}_find(e){let r=0,n=this._keys.length;for(;r<n;){let i=r+n>>>1,s=this._kCmp(this._keys[i],e);if(s<0)r=i+1;else if(s>0)n=i;else return i}return r}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,r){if(!!e)for(let n of this._keys)e.apply(r,[[n,this.get(n)]])}_defaultSort(e,r){return e[0]<r[0]?-1:r[0]<e[0]?1:0}_kCmp(e,r){return this._cmp([e,this.get(e)],[r,this.get(r)])}}});var vut,aD,oD,Tve,xve=w(()=>{Ive();vut={hasNewInfo(){return!1},merge(){}},aD=class{constructor(e=vut){this._taskMerger=e,this._byPeer=new o7([],oD.compare)}pushTasks(e,r){let n=this._byPeer.get(e.toB58String());n||(n=new oD(e,this._taskMerger)),n.pushTasks(r),this._byPeer.set(e.toB58String(),n)}popTasks(e){let r=this._head();if(r===void 0)return{tasks:[],pendingSize:0};let{tasks:n,pendingSize:i}=r.popTasks(e);if(n.length===0)return{tasks:n,pendingSize:i};let s=r.peerId;return r.isIdle()?this._byPeer.delete(s.toB58String()):this._byPeer.update(0),{peerId:s,tasks:n,pendingSize:i}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,r){let n=this._byPeer.get(r.toB58String());n&&n.remove(e)}tasksDone(e,r){let n=this._byPeer.get(e.toB58String());if(!n)return;let i=this._byPeer.indexOf(e.toB58String());for(let s of r)n.taskDone(s);this._byPeer.update(i)}},oD=class{constructor(e,r){this.peerId=e,this._taskMerger=r,this._activeTotalSize=0,this._pending=new Tve,this._active=new Set}pushTasks(e){for(let r of e)this._pushTask(r)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let r=this._pending.get(e.topic);if(r){e.priority>r.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,r);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let r=[];for(let n of this._active)n.topic===e.topic&&r.push(n);return r.length===0?!0:this._taskMerger.hasNewInfo(e,r)}popTasks(e){let r=0,n=[],i=this._pending.tasks();for(let s=0;s<i.length&&r<e;s++){let o=i[s];n.push(o),r+=o.size,this._pending.delete(o.topic),this._activeTotalSize+=o.size,this._active.add(o)}return{tasks:n,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,r){return e[1]._pending.length===0?1:r[1]._pending.length===0?-1:e[1]._activeTotalSize===r[1]._activeTotalSize?r[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-r[1]._activeTotalSize}},Tve=class{constructor(){this._tasks=new o7([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,r)=>e+r.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,r){let n=this._tasks.get(e);if(!n)return;let i=this._tasks.indexOf(e);n.task.priority=r,this._tasks.update(i)}_compare(e,r){return e[1].task.priority===r[1].task.priority?e[1].created-r[1].created:r[1].task.priority-e[1].task.priority}}});var Pve,Cve=w(()=>{Pve={hasNewInfo(t,e){let r=!1,n=!1;for(let i of e)i.data.haveBlock&&(r=!0),i.data.isWantBlock&&(n=!0);return!!(!n&&t.data.isWantBlock||!r&&t.data.haveBlock)},merge(t,e){let r=t.data,n=e.data;!n.haveBlock&&r.haveBlock&&(n.haveBlock=r.haveBlock,n.blockSize=r.blockSize),!n.isWantBlock&&r.isWantBlock&&(n.isWantBlock=!0,(!n.haveBlock||r.haveBlock)&&(n.haveBlock=r.haveBlock,e.size=t.size)),n.isWantBlock&&n.haveBlock&&(e.size=n.blockSize)}}});var kve,Ove,Eut,Sut,cD,Dve=w(()=>{Se();wn();e4();J3();Rve();xve();Cve();Vf();kve=A(Fd(),1),Ove=yr.WantType,Eut=16*1024,Sut=1024,cD=class{constructor(e,r,n,i,s,o={}){this._log=Ho(e,"engine"),this.blockstore=r,this.network=n,this._stats=i,this._opts=this._processOpts(o),this.ledgerMap=(0,kve.default)({system:"ipfs",component:"bitswap",metric:"ledger-map",metrics:s.metrics}),this._running=!1,this._requestQueue=new aD(Pve)}_processOpts(e){return{maxSizeReplaceHasWithBlock:Sut,targetMessageSize:Eut,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:r,pendingSize:n}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(r.length===0)return;let i=new yr(!1);i.setPendingBytes(n);let s=[],o=new Map;for(let c of r){let u=L.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(s.push(u),o.set(c.topic,c.data)):i.addHave(u):i.addDontHave(u)}let a=await this._getBlocks(s);for(let[c,u]of o){let l=L.parse(c),f=a.get(c);f?i.addBlock(l,f):u.sendDontHave&&i.addDontHave(l)}if(i.empty){e&&this._requestQueue.tasksDone(e,r),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,i);for(let[c,u]of a.entries())e&&this.messageSent(e,L.parse(c),u)}catch(c){this._log.error(c)}e&&this._requestQueue.tasksDone(e,r),this._scheduleProcessTasks()}wantlistForPeer(e){let r=e.toB58String(),n=this.ledgerMap.get(r);return n?n.wantlist.sortedEntries():new Map}ledgerForPeer(e){let r=e.toB58String(),n=this.ledgerMap.get(r);return n?{peer:n.partner,value:n.debtRatio(),sent:n.accounting.bytesSent,recv:n.accounting.bytesRecv,exchanged:n.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(!!e.length){for(let r of this.ledgerMap.values())for(let n of e){let i=r.wantlistContains(n.cid);if(!i)continue;let s=n.data.length,o=this._sendAsBlock(i.wantType,s),a=s;o||(a=yr.blockPresenceSize(i.cid)),this._requestQueue.pushTasks(r.partner,[{topic:i.cid.toString(bt),priority:i.priority,size:a,data:{blockSize:s,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,r){let n=this._findOrCreate(e);if(r.empty)return;if(r.full&&(n.wantlist=new Vc),this._updateBlockAccounting(r.blocks,n),r.wantlist.size===0){this._scheduleProcessTasks();return}let i=[],s=[];r.wantlist.forEach(o=>{o.cancel?(n.cancelWant(o.cid),i.push(o.cid)):(n.wants(o.cid,o.priority,o.wantType),s.push(o))}),this._cancelWants(e,i),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,r){for(let n of r)this._requestQueue.remove(n.toString(bt),e)}async _addWants(e,r){let n=await this._getBlockSizes(r.map(s=>s.cid)),i=[];for(let s of r){let o=s.cid.toString(bt),a=n.get(o);if(a==null)s.sendDontHave&&i.push({topic:o,priority:s.priority,size:yr.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===Ove.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{let c=this._sendAsBlock(s.wantType,a),u=a;c||(u=yr.blockPresenceSize(s.cid)),i.push({topic:o,priority:s.priority,size:u,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,i)}}_sendAsBlock(e,r){return e===Ove.Block||r<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let r=await this._getBlocks(e);return new Map([...r].map(([n,i])=>[n,i.length]))}async _getBlocks(e){let r=new Map;return await Promise.all(e.map(async n=>{try{let i=await this.blockstore.get(n);r.set(n.toString(bt),i)}catch(i){i.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",n,i)}})),r}_updateBlockAccounting(e,r){for(let n of e.values())this._log("got block (%s bytes)",n.length),r.receivedBytes(n.length)}messageSent(e,r,n){let i=this._findOrCreate(e);i.sentBytes(n.length),i.wantlist.remove(r)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toB58String())}_findOrCreate(e){let r=e.toB58String(),n=this.ledgerMap.get(r);if(n)return n;let i=new sD(e);return this.ledgerMap.set(r,i),this._stats&&this._stats.push(r,"peerCount",1),i}start(){this._running=!0}stop(){this._running=!1}}});var Lve,Nve,Bve,uD,Mve=w(()=>{Lve=A(Gt(),1);st();t4();Vf();Nve=t=>`unwant:${Xe(t.multihash.bytes,"base64")}`,Bve=t=>`block:${Xe(t.multihash.bytes,"base64")}`,uD=class extends Lve.EventEmitter{constructor(e){super();this.setMaxListeners(yve),this._log=Ho(e,"notif")}hasBlock(e,r){let n=Bve(e);this._log(n),this.emit(n,r)}wantBlock(e,r={}){if(!e)throw new Error("Not a valid cid");let n=Bve(e),i=Nve(e);return this._log(`wantBlock:${e}`),new Promise((s,o)=>{let a=()=>{this.removeListener(n,c),o(new Error(`Block for ${e} unwanted`))},c=u=>{this.removeListener(i,a),s(u)};this.once(i,a),this.once(n,c),r&&r.signal&&r.signal.addEventListener("abort",()=>{this.removeListener(n,c),this.removeListener(i,a),o(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let r=Nve(e);this._log(r),this.emit(r)}}});var Uve,lD,a7,qve=w(()=>{Uve=A(Gt(),1),lD=A(mk(),1),a7=class extends Uve.EventEmitter{constructor(e,r){super();this._options=r,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(n=>{this._stats[n]=BigInt(0),this._movingAverages[n]={},this._options.movingAverageIntervals.forEach(i=>{(this._movingAverages[n][i]=(0,lD.default)(i)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,r){this._enabled&&(this._queue.push([e,r,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let r=e=this._queue.shift();r&&this._applyOp(r)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;r&&Object.keys(this._stats).forEach(n=>{this._updateFrequencyFor(n,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,n){let i=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let s=i/r*1e3,o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=o[a];c||(c=o[a]=(0,lD.default)(a)),c.push(n,s)})}_applyOp(e){let r=e[0],n=e[1];if(typeof n!="number")throw new Error(`invalid increment number: ${n}`);Object.prototype.hasOwnProperty.call(this._stats,r)||(this._stats[r]=BigInt(0)),this._stats[r]=BigInt(this._stats[r])+BigInt(n),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=n}}});var Kve,jve,Fve,fD,Vve=w(()=>{Kve=A(Gt(),1);qve();jve=A(Fd(),1),Fve={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},fD=class extends Kve.EventEmitter{constructor(e,r=[],n=Fve){super();let i=Object.assign({},Fve,n);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=r,this._options=i,this._enabled=this._options.enabled,this._globalThis=new a7(r,i),this._globalThis.on("update",s=>this.emit("update",s)),this._peers=(0,jve.default)({system:"ipfs",component:"bitswap",metric:"stats-peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._globalThis.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._globalThis.disable()}stop(){this._enabled=!1,this._globalThis.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._globalThis.snapshot}get movingAverages(){return this._globalThis.movingAverages}forPeer(e){let r=typeof e!="string"&&e.toB58String?e.toB58String():`${e}`;return this._peers.get(r)}push(e,r,n){if(this._enabled&&(this._globalThis.push(r,n),e)){let i=this._peers.get(e);i||(i=new a7(this._initialCounters,this._options),this._peers.set(e,i)),i.push(r,n)}}disconnected(e){let r=e.toB58String(),n=this._peers.get(r);n&&(n.stop(),this._peers.delete(r))}}});var zve,Aut,Rut,hD,Hve=w(()=>{Eve();Ave();Dve();Mve();Vf();Vve();zve=A(na(),1);Km();Se();Aut={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},Rut=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],hD=class extends Ru{constructor(e,r,n={}){super();this._libp2p=e,this._log=Ho(this.peerId),this._options=Object.assign({},Aut,n),this._stats=new fD(e,Rut,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new iD(e,this,this._stats,{hashLoader:n.hashLoader}),this.blockstore=r,this.engine=new cD(this.peerId,r,this.network,this._stats,e),this.wm=new Zk(this.peerId,this.network,this._stats,e),this.notifications=new uD(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,r){try{await this.engine.messageReceived(e,r)}catch{this._log("failed to receive message",r)}if(r.blocks.size===0)return;let n=[];for(let[i,s]of r.blocks.entries()){let o=L.parse(i);n.push({wasWanted:this.wm.wantlist.contains(o),cid:o,data:s})}this.wm.cancelWants(n.filter(({wasWanted:i})=>i).map(({cid:i})=>i)),await Promise.all(n.map(({cid:i,wasWanted:s,data:o})=>this._handleReceivedBlock(e,i,o,s)))}async _handleReceivedBlock(e,r,n,i){this._log("received block");let s=await this.blockstore.has(r);this._updateReceiveCounters(e.toB58String(),r,n,s),!!i&&await this.put(r,n)}_updateReceiveCounters(e,r,n,i){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",n.length),i&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",n.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,r){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,r={}){let n=(u,l)=>(this.wm.wantBlocks([u],l),this.notifications.wantBlock(u,l)),i=!1,s=async(u,l)=>{try{return await this.blockstore.get(u,l)}catch(f){if(f.code!=="ERR_NOT_FOUND")throw f;return i||(i=!0,this.network.findAndConnect(u).catch(h=>this._log.error(h))),n(u,l)}},o=new AbortController,a=r.signal?(0,zve.anySignal)([r.signal,o.signal]):o.signal,c=await Promise.race([this.notifications.wantBlock(e,{signal:a}),s(e,{signal:a})]);return o.abort(),c}async*getMany(e,r={}){for await(let n of e)yield this.get(n,r)}unwant(e){let r=Array.isArray(e)?e:[e];this.wm.unwantBlocks(r),r.forEach(n=>this.notifications.unwantBlock(n))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,r,n){await this.blockstore.put(e,r),this._sendHaveBlockNotifications(e,r)}async*putMany(e,r){for await(let{key:n,value:i}of this.blockstore.putMany(e,r))this._sendHaveBlockNotifications(n,i),yield{key:n,value:i}}_sendHaveBlockNotifications(e,r){this.notifications.hasBlock(e,r),this.engine.receivedBlocks([{cid:e,data:r}]),this.network.provide(e).catch(n=>{this._log.error("Failed to provide: %s",n.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}}});var $ve,Gve=w(()=>{Hve();$ve=(t,e,r={})=>new hD(t,e,r)});var c7={};Tt(c7,{abortedError:()=>Iut,notFoundError:()=>Wve});function Wve(t){return t=t||new Error("Not Found"),(0,dD.default)(t,"ERR_NOT_FOUND")}function Iut(t){return t=t||new Error("Aborted"),(0,dD.default)(t,"ERR_ABORTED")}var dD,pD=w(()=>{dD=A(oe(),1)});var Yve=w(()=>{Km();fi();eo();Se();li();pD()});var Rjt,Xve=w(()=>{pD();Km();Yve();Rjt={...c7}});var Qve,yD,Zve,gD,Jve=w(()=>{Xve();Qve=A(Dl(),1),yD=A(ac(),1),Zve=A(fs(),1),gD=class extends Ru{constructor(e,r){super();this.child=e,this.bitswap=r}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,r,n={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,r,n):await this.child.put(e,r,n))}async*putMany(e,r={}){let n=(0,Zve.default)(e,async({key:i})=>!await this.has(i));this.bitswap.isStarted()?yield*this.bitswap.putMany(n,r):yield*this.child.putMany(n,r)}async get(e,r={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,r):this.child.get(e,r)}async*getMany(e,r={}){let n=(0,yD.default)(),i=(0,yD.default)();Promise.resolve().then(async()=>{for await(let s of e)!await this.has(s)&&this.bitswap.isStarted()?n.push(s):i.push(s);n.end(),i.end()}),yield*(0,Qve.default)(this.bitswap.getMany(n,r),this.child.getMany(i,r))}async delete(e,r){await this.child.delete(e,r)}async*deleteMany(e,r){yield*this.child.deleteMany(e,r)}async has(e,r={}){return this.child.has(e,r)}async*query(e,r={}){yield*this.child.query(e,r)}async*queryKeys(e,r={}){yield*this.child.queryKeys(e,r)}}});var e7e,t7e,r4,Tut,xut,r7e=w(()=>{Gve();Hk();e7e=A(yt(),1),t7e=A(oe(),1);Jve();r4=class{constructor(e,r,n,i,s){this.peerId=e,this.libp2p=r,this.bitswap=n,this.repo=i,this.blockstore=s}static async start({peerId:e,repo:r,print:n,hashers:i,options:s}){r.closed&&await r.open();let o=await r.config.getAll(),a=await W3({options:s,repo:r,peerId:e,multiaddrs:Tut(e,o),config:o,keychainConfig:void 0});a.keychain&&await a.loadKeychain(),await a.start();for(let l of a.multiaddrs)n(`Swarm listening on ${l}/p2p/${e.toB58String()}`);let c=$ve(a,r.blocks,{statsEnabled:!0,hashLoader:i});await c.start();let u=new gD(r.blocks,c);return r.blocks=u,r.pins.blockstore=u,new r4(e,a,c,r,u)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await e.bitswap.stop(),await e.libp2p.stop()}},Tut=(t,e)=>{let r=t.toB58String(),n=[],i=e.Addresses&&e.Addresses.Swarm||[];for(let s of i){let o=new e7e.Multiaddr(s);if(o.protoCodes().includes(xut))throw(0,t7e.default)(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let a=o.getPeerId();a&&a!==r&&(o=o.encapsulate(`/p2p/${r}`)),n.push(o)}return n},xut=479});function n7e({network:t}){async function e(r={}){let n=[],{libp2p:i}=await t.use(r);for await(let s of i.peerStore.getPeers())n.push({id:s.id.toB58String(),addrs:s.addresses.map(o=>o.multiaddr)});return n}return Q(e)}var i7e=w(()=>{Ce()});function s7e({network:t}){async function e(r,n={}){let{libp2p:i}=await t.use(n);await i.dial(r,n)}return Q(e)}var o7e=w(()=>{Ce()});function a7e({network:t}){async function e(r,n={}){let{libp2p:i}=await t.use(n);await i.hangUp(r)}return Q(e)}var c7e=w(()=>{Ce()});function u7e({network:t}){async function e(r={}){let{libp2p:n}=await t.use(r);return n.multiaddrs}return Q(e)}var l7e=w(()=>{Ce()});function f7e({network:t}){async function e(r={}){let{libp2p:n}=await t.use(r),i=[];for(let[s,o]of n.connections)for(let a of o){let c={addr:a.remoteAddr,peer:s};(r.verbose||r.direction)&&(c.direction=a.stat.direction),r.verbose&&(c.muxer=a.stat.multiplexer,c.latency="n/a",c.streams=[]),i.push(c)}return i}return Q(e)}var h7e=w(()=>{Ce()});var mD,d7e=w(()=>{i7e();o7e();c7e();l7e();h7e();mD=class{constructor({network:e}){this.addrs=n7e({network:e}),this.connect=s7e({network:e}),this.disconnect=a7e({network:e}),this.localAddrs=u7e({network:e}),this.peers=f7e({network:e})}}});function y7e({network:t}){async function*e(r,n={}){let{libp2p:i}=await t.use();n.count=n.count||10;let s=p7e.default.createFromB58String(r),o=await i.peerStore.get(s),a=o&&o.id;if(!a){yield{...n4,text:`Looking up peer ${r}`};let l=await i.peerRouting.findPeer(s);a=l&&l.id}if(!a)throw new Error("Peer was not found");yield{...n4,text:`PING ${a.toB58String()}`};let c=0,u=0;for(let l=0;l<n.count;l++)try{let f=await i.ping(a);u+=f,c++,yield{...n4,time:f}}catch(f){yield{...n4,success:!1,text:f.toString()}}if(c){let l=u/c;yield{...n4,text:`Average latency: ${l}ms`}}}return Q(e)}var p7e,n4,g7e=w(()=>{p7e=A(ft(),1);Ce();n4={success:!0,time:0,text:""}});function m7e(t){t.startsWith(wD)&&(t=t.substring(wD.length));let e;if((t[0]==="1"||t[0]==="Q")&&(t=`z${t}`),t[0]==="z"&&(e=bt.decode(t)),t[0]==="k"&&(e=Ap.decode(t)),!e)throw new Error("Could not parse string");if(e[0]!==1&&e[1]!==114&&(e=Kn([[1,114],e])),e.length!==40)throw new Error("Incorrect length "+e.length);return Kn([tt(wD),e.subarray(2)])}function zy(t){if(t.name==="SENDING_QUERY")return{type:t.type,name:t.name,to:t.to.toB58String()};if(t.name==="PEER_RESPONSE")return{type:t.type,name:t.name,messageType:t.messageType,messageName:t.messageName,closer:t.closer.map(({id:e,multiaddrs:r})=>({id:e.toB58String(),multiaddrs:r})),providers:t.providers.map(({id:e,multiaddrs:r})=>({id:e.toB58String(),multiaddrs:r})),record:t.record,from:t.from.toB58String()};if(t.name==="FINAL_PEER")return{type:t.type,name:t.name,from:t.from.toB58String(),peer:{id:t.peer.id.toB58String(),multiaddrs:t.peer.multiaddrs}};if(t.name==="QUERY_ERROR")return{type:t.type,name:t.name,error:t.error,from:t.from.toB58String()};if(t.name==="PROVIDER")return{type:t.type,name:t.name,providers:t.providers.map(({id:e,multiaddrs:r})=>({id:e.toB58String(),multiaddrs:r})),from:t.from.toB58String()};if(t.name==="VALUE")return{type:t.type,name:t.name,value:t.value,from:t.from.toB58String()};if(t.name==="ADDING_PEER")return{type:t.type,name:t.name,peer:t.peer.toB58String()};if(t.name==="DIALING_PEER")return{type:t.type,name:t.name,peer:t.peer.toB58String()};throw(0,u7.default)(new Error("Unknown DHT event type"),"ERR_UNKNOWN_DHT_EVENT")}function b7e({network:t,repo:e,peerId:r}){let{get:n,put:i,findProvs:s,findPeer:o,provide:a,query:c}={async*get(u,l={}){let{libp2p:f}=await Hy(t,r,l),h=u instanceof Uint8Array?u:m7e(u);yield*(0,Jd.default)(f._dht.get(h,l),zy)},async*put(u,l,f){let{libp2p:h}=await Hy(t,r,f),d=u instanceof Uint8Array?u:m7e(u);yield*(0,Jd.default)(h._dht.put(d,l),zy)},async*findProvs(u,l={}){let{libp2p:f}=await Hy(t,r,l);yield*(0,Jd.default)(f._dht.findProviders(u,{signal:l.signal}),zy)},async*findPeer(u,l={}){let{libp2p:f}=await Hy(t,r,l);yield*(0,Jd.default)(f._dht.findPeer(bD.default.parse(u),{signal:l.signal}),zy)},async*provide(u,l={recursive:!1}){let{libp2p:f}=await Hy(t,r,l);if(!await e.blocks.has(u))throw(0,u7.default)(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(l.recursive)throw(0,u7.default)(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");yield*(0,Jd.default)(f._dht.provide(u),zy)},async*query(u,l={}){let{libp2p:f}=await Hy(t,r,l),h,d=L.asCID(u);d!=null?h=d.multihash.bytes:h=bD.default.parse(u.toString()).toBytes(),yield*(0,Jd.default)(f._dht.getClosestPeers(h,l),zy)}};return{get:Q(n),put:Q(i),findProvs:Q(s),findPeer:Q(o),provide:Q(a),query:Q(c)}}var bD,u7,w7e,Jd,wD,Hy,_7e=w(()=>{bD=A(ft(),1),u7=A(oe(),1);ul();w7e=A(hg(),1);Ce();Jd=A(xi(),1);Se();wn();d2();Pn();dt();wD="/ipns/";Hy=async(t,e,r)=>{let n=await t.use(r);if((0,w7e.default)(n.libp2p,"_config.dht.enabled",!1))return n;{let i=async function*(){yield{from:e,name:"QUERY_ERROR",type:3,error:new Va("dht not enabled")}};return{libp2p:{_dht:{get:i,put:i,findProvs:i,findPeer:i,provide:i,query:i}}}}}});function S7e({network:t,config:e}){let r=(0,E7e.default)(e||{},"Pubsub.Enabled",!0);return{subscribe:r?Q(n):i4,unsubscribe:r?Q(i):i4,publish:r?Q(s):i4,ls:r?Q(o):i4,peers:r?Q(a):i4};async function n(c,u,l={}){let{libp2p:f}=await t.use(l);return f.pubsub.subscribe(c,u,l)}async function i(c,u,l={}){let{libp2p:f}=await t.use(l);f.pubsub.unsubscribe(c,u,l)}async function s(c,u,l={}){let{libp2p:f}=await t.use(l);if(!u)throw(0,v7e.default)(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await f.pubsub.publish(c,u)}async function o(c={}){let{libp2p:u}=await t.use(c);return u.pubsub.getTopics()}async function a(c,u={}){let{libp2p:l}=await t.use(u);return l.pubsub.getSubscribers(c)}}var v7e,E7e,i4,A7e=w(()=>{Ce();v7e=A(oe(),1);ul();E7e=A(hg(),1);i4=async()=>{throw new Va("pubsub not enabled")}});async function T7e(t={}){t=Cut(kut(),t);let e=t.init||{},r={name:Cs.name,code:Cs.code,encode:u=>u,decode:u=>u},n=Object.values(X4);[Kt,wp,Ep,Put,r].concat(t.ipld&&t.ipld.codecs||[]).forEach(u=>n.push(u));let i=new Wm({codecs:n,loadCodec:t.ipld&&t.ipld.loadCodec}),s=t.silent?zf:console.log;zf("creating repo");let o=await X3.start(s,i,t);zf("getting repo config");let a=await o.repo.config.getAll(),c=new I7e({storage:o,print:s,codecs:i,options:{...t,config:a}});if(zf("starting preload"),await c.preload.start(),zf("starting storage"),c.ipns.startOffline(o),o.isNew&&!e.emptyRepo){let u=await Out(c);zf("adding default assets"),await(c.addAll,void 0),zf("initializing IPNS keyspace"),await c.ipns.initializeKeyspace(o.peerId.privKey,tt(`/ipfs/${u}`))}return t.start!==!1&&(zf("starting node"),await c.start()),c}var R7e,_D,vD,Put,Cut,zf,I7e,Out,kut,x7e=w(()=>{Fn();R7e=A(Xy(),1),_D=A(he(),1),vD=A(oe(),1);gn();xt();bp();H4();Put=A(bE(),1);Zc();Q4();uM();ul();dt();ZU();eq();Lq();Uq();Xj();lV();cH();CH();NH();LH();zH();s$();O$();MQ();KQ();$Q();QQ();MZ();WZ();XZ();kee();Yee();dte();bte();Rte();$_e();r7e();y6();d7e();g7e();_7e();A7e();NP();BP();DP();Cut=Bt.bind({ignoreUndefined:!0}),zf=Object.assign((0,_D.default)("ipfs"),{error:(0,_D.default)("ipfs:error")}),I7e=class{constructor({print:e,storage:r,codecs:n,options:i}){let{peerId:s,repo:o,keychain:a}=r,c=Fi.create(r4),u=GZ(i.preload),l=Bq(),f=Mq({network:c}),h=new gA(i),d=Object.values(Y4);(i.ipld&&i.ipld.hashers?i.ipld.hashers:[]).forEach(Ke=>d.push(Ke)),this.hashers=new Ym({hashers:d,loadHasher:i.ipld&&i.ipld.loadHasher});let p=Object.values(Zf);(i.ipld&&i.ipld.bases?i.ipld.bases:[]).forEach(Ke=>p.push(Ke)),this.bases=new Gm({bases:p,loadBase:i.ipld&&i.ipld.loadBase});let y=new dS({repo:o,codecs:n}),b=new kA({codecs:n,hashers:this.hashers,preload:u,repo:o}),m=new SA({dns:l,ipns:h,repo:o,codecs:n,peerId:s,isOnline:f,keychain:a,options:i}),_=Yj({repo:o,codecs:n,bases:this.bases,name:m}),R=new mI({repo:o,codecs:n,hashers:this.hashers,preload:u}),k=Object.assign(DH({repo:o,codecs:n,resolve:_,preload:u}),{local:BH({repo:r.repo})}),{add:P,addAll:x,cat:D,get:U,ls:M}=new iI({preload:u,repo:o,options:i.EXPERIMENTAL,hashers:this.hashers}),ae=Oee({repo:o,preload:u,hashers:this.hashers,options:i}),ne=YZ({files:ae,preload:u,options:i.preload});this.preload=u,this.name=m,this.ipns=h,this.pin=y,this.resolve=_,this.block=b,this.refs=k,this.start=QU({network:c,peerId:s,repo:o,preload:u,ipns:h,mfsPreload:ne,print:e,keychain:a,hashers:this.hashers,options:i}),this.stop=JU({network:c,preload:u,mfsPreload:ne,ipns:h,repo:o}),this.dht=b7e({network:c,repo:o,peerId:s}),this.pubsub=S7e({network:c,config:i.config}),this.dns=l,this.isOnline=f,this.id=HQ({network:c,peerId:s}),this.version=FQ({repo:o}),this.bitswap=new TA({network:c}),this.bootstrap=new PA({repo:o}),this.config=XQ({repo:o}),this.ping=y7e({network:c}),this.add=P,this.addAll=x,this.cat=D,this.get=U,this.ls=M,this.dag=R,this.files=ae,this.key=new FI({keychain:a}),this.object=new VI({preload:u,codecs:n,repo:o}),this.repo=new $I({repo:o,hashers:this.hashers}),this.stats=new GI({repo:o,network:c}),this.swarm=new mD({network:c}),Object.defineProperty(this,"libp2p",{get(){let Ke=c.try();return Ke?Ke.libp2p:void 0}});let de=()=>Promise.reject((0,vD.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),me=async function*(){throw(0,vD.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=de,this.diag={cmds:de,net:de,sys:de},this.log={level:de,ls:de,tail:me},this.mount=de,this.codecs=n}async init(){throw new ja}},Out=async t=>{let e=lt({Data:new mt({type:"directory"}).marshal(),Links:[]}),r=await t.block.put(e,{mhtype:"sha2-256",format:"dag-pb"});return await t.pin.add(r),r},kut=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!R7e.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}})});var N7e={};Tt(N7e,{CID:()=>L,PeerId:()=>Lut,create:()=>Dut,crypto:()=>Nut,globSource:()=>Mut,isIPFS:()=>But,multiaddr:()=>B7e.Multiaddr,urlSource:()=>Uut});var P7e,C7e,O7e,k7e,D7e,B7e,Dut,Nut,But,Lut,Mut,Uut,L7e=w(()=>{x7e();P7e=A(oc(),1),C7e=A(Lp(),1),O7e=A(ft(),1),k7e=A(e0e(),1),D7e=A(eC(),1);Se();B7e=A(yt(),1),Dut=T7e,Nut=P7e.default,But=C7e.default,Lut=O7e.default,Mut=k7e.default,Uut=D7e.default});var vs,$o,$y=w(()=>{Se();vs=(t,e)=>(e&&e.add(t.multihash.bytes.buffer),t),$o=t=>{let e=t;return e._baseCache||Object.defineProperty(e,"_baseCache",{value:new Map}),e.asCID||Object.defineProperty(e,"asCID",{get:()=>e}),Object.setPrototypeOf(e.multihash.digest,Uint8Array.prototype),Object.setPrototypeOf(e.multihash.bytes,Uint8Array.prototype),Object.setPrototypeOf(e.bytes,Uint8Array.prototype),Object.setPrototypeOf(e,L.prototype),Object.defineProperty(e,Symbol.for("@ipld/js-cid/CID"),{value:!0}),e}});var M7e,U7e,ED,q7e=w(()=>{Se();$y();M7e=({dagNode:t,cids:e})=>{for(let r of e)$o(r);return t},U7e=(t,e)=>{let r=[];return ED(t,r,e),{dagNode:t,cids:r}},ED=(t,e,r)=>{if(t!=null&&typeof t=="object"){let n=L.asCID(t);if(n)e.push(n),vs(n,r);else if(t instanceof ArrayBuffer)r&&r.add(t);else if(ArrayBuffer.isView(t))r&&r.add(t.buffer);else if(Array.isArray(t))for(let i of t)ED(i,e,r);else for(let i of Object.values(t))ED(i,e,r)}}});var s4,qut,SD=w(()=>{$y();q7e();s4=class{constructor(e){this.ipfs=e}async put(e){let r=M7e(e.dagNode),n=await this.ipfs.dag.put(r,e);return vs(n)}async get(e){let{cid:r,path:n,localResolve:i,timeout:s,signal:o}=e,{value:a,remainderPath:c}=await this.ipfs.dag.get($o(r),{path:n,localResolve:i,timeout:s,signal:o}),u=new Set;return{remainderPath:c,value:U7e(a,u),transfer:u}}async resolve(e){let{cid:r,remainderPath:n}=await this.ipfs.dag.resolve(qut(e.cid),e);return{cid:vs(r),remainderPath:n}}},qut=t=>typeof t=="string"?t:$o(t)});var Gy,F7e,Fut,l7=w(()=>{Gy=t=>{let{name:e,message:r,stack:n,code:i,detail:s}=t;return{name:e,message:r,stack:n,code:i,detail:s}},F7e=t=>{if(t instanceof Error)return t;{let{name:e,message:r,stack:n,code:i}=t;return Object.assign(Fut(e,r),{name:e,stack:n,code:i})}},Fut=(t,e)=>{switch(t){case"RangeError":return new RangeError(e);case"ReferenceError":return ReferenceError(e);case"SyntaxError":return new SyntaxError(e);case"TypeError":return new TypeError(e);case"URIError":return new URIError(e);default:return new Error(e)}}});var f7,h7,Kut,AD,K7e,j7e=w(()=>{l7();f7=async function*({port:t},e){let r=o=>{},n=()=>new Promise(o=>r=o),i=()=>(t.postMessage({method:"next"}),n());t.onmessage=o=>r(o.data);let s=!1;try{for(;!s;){let{done:o,value:a,error:c}=await i();if(s=o,c!=null)throw F7e(c);a!=null&&(yield e(a))}}finally{s||t.postMessage({method:"return"}),t.close()}},h7=(t,e,r)=>{let{port1:n,port2:i}=new MessageChannel,s=Kut(t),o=new Set;return n.onmessage=async({data:{method:a}})=>{switch(a){case"next":{try{let{done:c,value:u}=await s.next();if(c)n.postMessage({type:"next",done:!0}),n.close();else{o.clear();let l=e(u,o);K7e(n,{type:"next",done:!1,value:l},o)}}catch(c){n.postMessage({type:"throw",error:Gy(c)}),n.close()}break}case"return":{n.close(),s.return&&s.return();break}default:break}},n.start(),r.add(i),{type:"RemoteIterable",port:i}},Kut=t=>{if(t!=null){if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]()}throw TypeError("Value must be async or sync iterable")},AD=({port:t})=>(r,n)=>{K7e(t,r,n)},K7e=(t,e,r)=>t.postMessage(e,r)});var o4,jut,Vut,RD,zut,ID,Hut,$ut,Gut,Wut,Yut,Xut,V7e,Qut,TD=w(()=>{j7e();$y();o4=class{constructor(e){this.ipfs=e}addAll(e){let{input:r}=e,{chunker:n,cidVersion:i,enableShardingExperiment:s,hashAlg:o,onlyHash:a,pin:c,progressCallback:u,rawLeaves:l,shardSplitThreshold:f,trickle:h,wrapWithDirectory:d,timeout:p,signal:y}=e,b;if(u){let R=AD(u);b=(k,P)=>{R([k,P])}}let m={chunker:n,cidVersion:i,enableShardingExperiment:s,hashAlg:o,onlyHash:a,pin:c,rawLeaves:l,shardSplitThreshold:f,trickle:h,wrapWithDirectory:d,timeout:p,progress:b,signal:y},_=jut(r);return Hut(this.ipfs.addAll(_,m))}async add(e){let{input:r}=e,{chunker:n,cidVersion:i,hashAlg:s,onlyHash:o,pin:a,progressCallback:c,rawLeaves:u,trickle:l,wrapWithDirectory:f,timeout:h,signal:d}=e,p;if(c){let m=AD(c);p=(_,R)=>{m([_,R])}}let y={chunker:n,cidVersion:i,hashAlg:s,onlyHash:o,pin:a,rawLeaves:u,trickle:l,wrapWithDirectory:f,timeout:h,progress:p,signal:d},b=Vut(r);return $ut(await this.ipfs.add(b,y))}cat(e){let{path:r,offset:n,length:i,timeout:s,signal:o}=e,a=typeof r=="string"?r:$o(r),c=this.ipfs.cat(a,{offset:n,length:i,timeout:s,signal:o});return Gut(c)}ls(e){let{path:r,recursive:n,preload:i,timeout:s,signal:o}=e,a=typeof r=="string"?r:$o(r),c=this.ipfs.ls(a,{recursive:n,preload:i,timeout:s,signal:o});return Wut(c)}},jut=t=>f7(t,RD),Vut=t=>ID(t,e=>e.type==="RemoteIterable"?{content:f7(e,RD)}:RD(e)),RD=t=>ID(t,e=>({...e,content:e.content&&zut(e.content)})),zut=t=>ID(t,e=>f7(e,Qut)),ID=(t,e)=>typeof t=="string"||t instanceof ArrayBuffer||t instanceof Blob||ArrayBuffer.isView(t)?t:e(t),Hut=t=>{let e=new Set;return{data:h7(t,V7e,e),transfer:e}},$ut=t=>{let e=new Set;return{data:V7e(t,e),transfer:e}},Gut=t=>{let e=new Set;return{data:h7(t,Xut,e),transfer:e}},Wut=t=>{let e=new Set;return{data:h7(t,Yut,e),transfer:e}},Yut=({name:t,path:e,size:r,cid:n,type:i,mode:s,mtime:o})=>({cid:vs(n),type:i,name:t,path:e,mode:s,mtime:o,size:r}),Xut=(t,e)=>(e.add(t.buffer),t),V7e=(t,e)=>({...t,cid:vs(t.cid)}),Qut=t=>t});var a4,xD=w(()=>{$y();a4=class{constructor(e){this.ipfs=e}async stat(e){let r=await this.ipfs.files.stat(e.path,e),n=new Set;return{stat:{...r,cid:vs(r.cid,n)},transfer:n}}}});var z7e,H7e=w(()=>{z7e=(t,e)=>(e&&e.add(t.buffer),t)});var $7e,c4,Zut,PD=w(()=>{$7e=A(yo(),1);l7();$y();H7e();c4=class{constructor(e){this.ipfs=e}async get(e){let r=$o(e.cid),n=await this.ipfs.block.get(r,e),i=new Set;return{transfer:i,block:z7e(n,i)}}async put(e){let r=e.block,n=await this.ipfs.block.put(r,e),i=new Set;return{transfer:i,cid:vs(n,i)}}async rm(e){let r=new Set;return(await(0,$7e.default)(this.ipfs.block.rm(e.cids.map($o),e))).map(i=>Zut(i,r))}async stat(e){let r=$o(e.cid),n=await this.ipfs.block.stat(r,e);return{...n,cid:vs(n.cid)}}},Zut=(t,e)=>{let r=vs(t.cid,e);return t.error?{cid:r,error:Gy(t.error)}:{cid:r}}});var CD,G7e=w(()=>{SD();TD();xD();PD();CD=class{constructor(e){this.dag=new s4(e),this.core=new o4(e),this.files=new a4(e),this.block=new c4(e)}}});var OD,kD,W7e,Jut,Y7e=w(()=>{l7();OD=class{constructor(e,r,n){this.result=new Promise((i,s)=>{this.succeed=i,this.fail=s,this.namespace=e,this.method=r,this.input=n,this.abortController=new AbortController,this.signal=this.abortController.signal})}abort(){this.abortController.abort(),this.fail(new Jut)}},kD=class{constructor(e){this.services=e,this.queries=Object.create(null)}connect(e){e.addEventListener("message",this),e.start()}disconnect(e){e.removeEventListener("message",this),e.close()}handleEvent(e){let r=e.data;switch(r.type){case"query":{this.handleQuery(r.id,new OD(r.namespace,r.method,r.input),e.target);return}case"abort":return this.abort(r.id);default:throw new W7e(e)}}abort(e){let r=this.queries[e];r&&(delete this.queries[e],r.abort())}async handleQuery(e,r,n){if(this.queries[e]=r,await this.run(r),delete this.queries[e],!r.signal.aborted)try{let i=await r.result,s=i.transfer;delete i.transfer,n.postMessage({type:"result",id:e,result:{ok:!0,value:i}},s)}catch(i){n.postMessage({type:"result",id:e,result:{ok:!1,error:Gy(i)}})}}run(e){let{services:r}=this,{namespace:n,method:i}=e,s=r[n];if(s)if(typeof s[i]=="function")try{let o=s[i]({...e.input,signal:e.signal});Promise.resolve(o).then(e.succeed,e.fail)}catch(o){e.fail(o)}else e.fail(new RangeError(`Method '${i}' is not found`));else e.fail(new RangeError(`Namespace '${n}' is not found`))}execute(e){let r=new OD(e.namespace,e.method,e.input);return this.run(r),r.result}},W7e=class extends RangeError{constructor(e){super("Unexpected message was received by the server");this.event=e}get name(){return this.constructor.name}},Jut=class extends Error{get name(){return this.constructor.name}}});var X7e={};Tt(X7e,{BlockService:()=>c4,CoreService:()=>o4,DAGService:()=>s4,FilesService:()=>a4,IPFSService:()=>CD,Server:()=>kD});var Q7e=w(()=>{SD();TD();xD();PD();G7e();Y7e()});var{create:elt}=(L7e(),se(N7e)),{Server:tlt,IPFSService:rlt}=(Q7e(),se(X7e));console.info("hello world");var nlt=async()=>{try{let t=ilt(self,"connect"),e=await elt();await e.add({content:"hello world"});let r=new rlt(e),n=new tlt(r);self.server=n,self.ipfs=e;for await(let i of t){let s=i.ports[0];s&&n.connect(s)}}catch(t){console.error(t)}},ilt=function(t,e,r){let n=[],i,s=new Promise(u=>i=u),o=u=>{n.push(u),i()},a=async()=>(await s,s=new Promise(u=>i=u),n.splice(0)),c=async function*(){try{for(;;)yield*await a()}finally{t.removeEventListener(e,o,r)}};return t.addEventListener(e,o,r),c()};nlt();})();
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
