{
  "version": 3,
  "sources": ["../esbuildEsm.mjs", "../wait.ts"],
  "sourcesContent": ["import { Mutex } from \"async-mutex\";\nimport * as esbuild from \"https://unpkg.com/esbuild-wasm@0.14.10/esm/browser.min.js\";\nimport { wait } from \"./wait\";\n\nconst init = esbuild.initialize({\n  wasmURL: \"https://unpkg.com/esbuild-wasm@0.14.10/esbuild.wasm\",\n});\n\nlet initFinished = false;\nconst mutex = new Mutex();\n\nexport const transform = async (code) => {\n  const startTime = performance.now();\n\n  await mutex.waitForUnlock();\n\n  if (initFinished || await init) {\n    initFinished = true;\n  }\n\n  let result;\n  try {\n    result = await esbuild.transform(code, {\n      loader: \"tsx\",\n      target: \"es2018\",\n    });\n  } catch {\n    await wait(10);\n\n    try {\n      result = await esbuild.transform(code, {\n        loader: \"tsx\",\n        target: \"es2018\",\n      });\n    } catch {\n      await wait(10);\n      try {\n        result = await esbuild.transform(code, {\n          loader: \"tsx\",\n          target: \"es2018\",\n        });\n      } catch {\n        await wait(10);\n        try {\n          result = await esbuild.transform(code, {\n            loader: \"tsx\",\n            target: \"es2018\",\n          });\n        } catch (e) {\n          const endTime = performance.now();\n\n          console.log(\n            `esbuildEsmTransform: took ${endTime - startTime} milliseconds`,\n          );\n\n          throw e;\n        }\n      }\n    }\n  }\n\n  const endTime = performance.now();\n\n  console.log(`esbuildEsmTransform: took ${endTime - startTime} milliseconds`);\n  return result.code;\n};\n", "export async function wait(delay: number): Promise<void> {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve();\n    }, delay);\n  });\n}\n"],
  "mappings": ";AAAA;AACA;;;ACDA,oBAA2B,OAA8B;AACvD,SAAO,IAAI,QAAQ,CAAC,YAAY;AAC9B,eAAW,MAAM;AACf;AAAA,OACC;AAAA;AAAA;;;ADAP,IAAM,OAAO,AAAQ,mBAAW;AAAA,EAC9B,SAAS;AAAA;AAGX,IAAI,eAAe;AACnB,IAAM,QAAQ,IAAI;AAEX,IAAM,aAAY,OAAO,SAAS;AACvC,QAAM,YAAY,YAAY;AAE9B,QAAM,MAAM;AAEZ,MAAI,gBAAgB,MAAM,MAAM;AAC9B,mBAAe;AAAA;AAGjB,MAAI;AACJ,MAAI;AACF,aAAS,MAAM,AAAQ,kBAAU,MAAM;AAAA,MACrC,QAAQ;AAAA,MACR,QAAQ;AAAA;AAAA,UAEV;AACA,UAAM,KAAK;AAEX,QAAI;AACF,eAAS,MAAM,AAAQ,kBAAU,MAAM;AAAA,QACrC,QAAQ;AAAA,QACR,QAAQ;AAAA;AAAA,YAEV;AACA,YAAM,KAAK;AACX,UAAI;AACF,iBAAS,MAAM,AAAQ,kBAAU,MAAM;AAAA,UACrC,QAAQ;AAAA,UACR,QAAQ;AAAA;AAAA,cAEV;AACA,cAAM,KAAK;AACX,YAAI;AACF,mBAAS,MAAM,AAAQ,kBAAU,MAAM;AAAA,YACrC,QAAQ;AAAA,YACR,QAAQ;AAAA;AAAA,iBAEH,GAAP;AACA,gBAAM,WAAU,YAAY;AAE5B,kBAAQ,IACN,6BAA6B,WAAU;AAGzC,gBAAM;AAAA;AAAA;AAAA;AAAA;AAMd,QAAM,UAAU,YAAY;AAE5B,UAAQ,IAAI,6BAA6B,UAAU;AACnD,SAAO,OAAO;AAAA;",
  "names": []
}
