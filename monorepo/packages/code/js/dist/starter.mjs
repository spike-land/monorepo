import "./chunks/chunk-XHYF4LCB.mjs";

// js/starter.mjs
function starter_default(injectedRoom = "") {
  run(injectedRoom);
}
var transform = null;
window.esmsInitOptions = {
  shimMode: true,
  polyfillEnable: ["css-modules", "json-modules"],
  onerror: (error) => console.log(error),
  fetch: async function(url, options) {
    const urlEnd = url.substr(-3);
    if (url.indexOf("monaco") === -1 && ["tsx", ".ts"].indexOf(urlEnd) !== -1) {
      console.log(url);
      const res = await fetch(url, options);
      if (!res.ok)
        return res;
      const source = await res.text();
      transform = transform || (await import("./chunks/esbuildEsm-WXNOTWMV.mjs")).transform;
      const transformed = await transform(source);
      return new Response(new Blob([transformed], { type: "application/javascript" }));
    }
    return fetch(url, options);
  },
  noLoadEventRetriggers: true,
  skip: "/^https?://(cdn.skypack.dev|jspm.dev)//`"
};
var run = async (injectedRoom) => {
  const path = location.pathname.split("/");
  window.aniStart = Date.now();
  const room = injectedRoom || (path[1] === "api" && path[2] === "room" ? path[3] : (path.pop() || path.pop()).slice(-12)) || "code-main";
  const user = (self && self.crypto && self.crypto.randomUUID && self.crypto.randomUUID() || (await import("./chunks/uidV4-VF7B5B4C.mjs")).default()).slice(0, 8);
  if (location.pathname.includes("hydrate")) {
    const App = (await import(`https://spike.land/api/room/${room}/js`)).default;
    const createDelta = (await import("https://unpkg.com/@spike.land/esm@0.6.71/dist/textdiff-create.mjs")).default;
    const { jsx } = await import("https://unpkg.com/@spike.land/esm@0.6.71/dist/emotion-react.mjs");
    const { ReactDOM: ReactDOM2 } = window;
    const container = document.querySelector("#zbody");
    window.aniStart = Date.now();
    const root = ReactDOM2.hydrateRoot(container, jsx(App));
    const deltas = [];
    let first = document.getElementById("zbody").innerHTML;
    const html = first;
    const interV = setInterval(() => {
      const el = container.innerHTML;
      deltas.push(createDelta(first, el));
      first = el;
    }, 1e3 / 60);
    window.deltas = deltas;
    const { join: join2 } = await import("./chunks/ws-DVW5GJGK.mjs");
    join2(room, user, deltas);
    return;
    return;
  } else {
    (async () => {
      const applyDelta = (await import("https://unpkg.com/@spike.land/esm@0.4.33/dist/textdiff-patch.mjs")).default;
      const resp = await fetch(`https://spike.land/api/room/${room}/delta`);
      const deltas = await resp.json();
      let container = document.getElementById("zbody");
      if (!container) {
        const respS = await fetch(`https://spike.land/api/room/${room}/session`);
        const session2 = await respS.json();
        container = document.getElementById("root");
        container.innerHTML = `<style>${session2.css}</style><div id="zbody">${session2.html}</div>`;
        container = document.getElementById("zbody");
      }
      if (deltas && deltas.length) {
        const html = container.innerHTML;
        let i = 0;
        let last = html;
        const deltasLength = deltas.length;
        const animationLength = (2e3 - (Date.now() - window.aniStart)) / deltas.length;
        console.log({ animationLength });
        const clInt = setInterval(() => {
          if (i >= deltas.length) {
            clearInterval(clInt);
            return;
          }
          const index = i % deltasLength;
          if (index === 0)
            last = html;
          i++;
          const delta = deltas[index];
          if (!delta)
            return;
          const next = applyDelta(last, delta);
          last = next;
          container.innerHTML = next;
        }, animationLength);
      } else {
        const App = (await import(`https://spike.land/api/room/${room}/js`)).default;
        const { jsx } = await import("https://unpkg.com/@spike.land/esm@0.6.71/dist/emotion-react.mjs");
        let container2 = document.querySelector("#zbody");
        if (!container2) {
          container3 = document.getElementById("root");
          container3.innerHTML = `<style>${session.css}</style><div id="zbody">${session.html}</div>`;
          let container3 = document.querySelector("#zbody");
        }
        ReactDOM.hydrateRoot(container2, jsx(App));
      }
    })();
  }
  const { join } = await import("./chunks/ws-DVW5GJGK.mjs");
  join(room, user);
};
export {
  starter_default as default,
  run
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc3RhcnRlci5tanMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIChpbmplY3RlZFJvb20gPSBcIlwiKSB7XG4gIHJ1bihpbmplY3RlZFJvb20pO1xufVxuXG5sZXQgdHJhbnNmb3JtID0gbnVsbDtcbndpbmRvdy5lc21zSW5pdE9wdGlvbnMgPSB7XG4gIHNoaW1Nb2RlOiB0cnVlLFxuICBwb2x5ZmlsbEVuYWJsZTogW1wiY3NzLW1vZHVsZXNcIiwgXCJqc29uLW1vZHVsZXNcIl0sXG4gIG9uZXJyb3I6IChlcnJvcikgPT4gY29uc29sZS5sb2coZXJyb3IpLCAvLyBkZWZhdWx0cyB0byBgKChlKSA9PiB7IHRocm93IGU7IH0pYFxuICBmZXRjaDogYXN5bmMgZnVuY3Rpb24gKHVybCwgb3B0aW9ucykge1xuICAgIGNvbnN0IHVybEVuZCA9IHVybC5zdWJzdHIoLTMpO1xuICAgIGlmICh1cmwuaW5kZXhPZihcIm1vbmFjb1wiKSA9PT0gLTEgJiYgW1widHN4XCIsIFwiLnRzXCJdLmluZGV4T2YodXJsRW5kKSAhPT0gLTEpIHtcbiAgICAgIGNvbnNvbGUubG9nKHVybCk7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwsIG9wdGlvbnMpO1xuICAgICAgaWYgKCFyZXMub2spIHJldHVybiByZXM7XG5cbiAgICAgIGNvbnN0IHNvdXJjZSA9IGF3YWl0IHJlcy50ZXh0KCk7XG5cbiAgICAgIHRyYW5zZm9ybSA9IHRyYW5zZm9ybSB8fCAoYXdhaXQgaW1wb3J0KFwiLi9lc2J1aWxkRXNtLnRzXCIpKS50cmFuc2Zvcm07XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IGF3YWl0IHRyYW5zZm9ybShzb3VyY2UpO1xuICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgICAgbmV3IEJsb2IoW3RyYW5zZm9ybWVkXSwgeyB0eXBlOiBcImFwcGxpY2F0aW9uL2phdmFzY3JpcHRcIiB9KSxcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpO1xuICB9LFxuICBub0xvYWRFdmVudFJldHJpZ2dlcnM6IHRydWUsXG4gIHNraXA6IFwiL15odHRwcz86XFwvXFwvKGNkblxcLnNreXBhY2tcXC5kZXZ8anNwbVxcLmRldilcXC8vYFwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHJ1biA9IGFzeW5jIChpbmplY3RlZFJvb20pID0+IHtcbiAgY29uc3QgcGF0aCA9IGxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KFwiL1wiKTtcbiAgd2luZG93LmFuaVN0YXJ0ID0gRGF0ZS5ub3coKTtcblxuICBjb25zdCByb29tID0gaW5qZWN0ZWRSb29tIHx8XG4gICAgKChwYXRoWzFdID09PSBcImFwaVwiICYmIHBhdGhbMl0gPT09IFwicm9vbVwiKVxuICAgICAgPyBwYXRoWzNdXG4gICAgICA6IChwYXRoLnBvcCgpIHx8IHBhdGgucG9wKCkpLnNsaWNlKC0xMikpIHx8XG4gICAgXCJjb2RlLW1haW5cIjtcbiAgY29uc3QgdXNlciA9ICgoc2VsZiAmJiBzZWxmLmNyeXB0byAmJiBzZWxmLmNyeXB0by5yYW5kb21VVUlEICYmXG4gICAgc2VsZi5jcnlwdG8ucmFuZG9tVVVJRCgpKSB8fCAoYXdhaXQgaW1wb3J0KFwiLi91aWRWNC5tanNcIikpLmRlZmF1bHQoKSkuc2xpY2UoXG4gICAgICAwLFxuICAgICAgOCxcbiAgICApO1xuXG4gIGlmIChsb2NhdGlvbi5wYXRobmFtZS5pbmNsdWRlcyhcImh5ZHJhdGVcIikpIHtcbiAgICBjb25zdCBBcHAgPSAoYXdhaXQgaW1wb3J0KFxuICAgICAgYGh0dHBzOi8vc3Bpa2UubGFuZC9hcGkvcm9vbS8ke3Jvb219L2pzYFxuICAgICkpLmRlZmF1bHQ7XG5cbiAgICBjb25zdCBjcmVhdGVEZWx0YSA9IChhd2FpdCBpbXBvcnQoXCJ0ZXh0ZGlmZi1jcmVhdGVcIikpLmRlZmF1bHQ7XG4gICAgLy8gY29uc3QgYXBwbHlEZWx0YSA9IChhd2FpdCBpbXBvcnQoXCJ0ZXh0ZGlmZi1wYXRjaFwiKSkuZGVmYXVsdDtcblxuICAgIGNvbnN0IHsganN4IH0gPSBhd2FpdCBpbXBvcnQoXCJAZW1vdGlvbi9yZWFjdFwiKTtcbiAgICBjb25zdCB7IFJlYWN0RE9NIH0gPSB3aW5kb3c7XG5cbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3pib2R5XCIpO1xuXG4gICAgd2luZG93LmFuaVN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCByb290ID0gUmVhY3RET00uaHlkcmF0ZVJvb3QoY29udGFpbmVyLCBqc3goQXBwKSk7XG5cbiAgICAvLyBjb25zdCBvdXRlcnMgPSBbXTtcbiAgICBjb25zdCBkZWx0YXMgPSBbXTtcblxuICAgIGxldCBmaXJzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiemJvZHlcIikuaW5uZXJIVE1MO1xuICAgIGNvbnN0IGh0bWwgPSBmaXJzdDtcblxuICAgIGNvbnN0IGludGVyViA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGNvbnN0IGVsID0gY29udGFpbmVyLmlubmVySFRNTDtcbiAgICAgIGRlbHRhcy5wdXNoKGNyZWF0ZURlbHRhKGZpcnN0LCBlbCkpO1xuXG4gICAgICBmaXJzdCA9IGVsO1xuICAgICAgLy8gICAgICBkZWx0YXMucHVzaCgpXG4gICAgICAvLyBvdXRlcnMucHVzaChlbCk7XG4gICAgfSwgMTAwMCAvIDYwKTtcblxuICAgIHdpbmRvdy5kZWx0YXMgPSBkZWx0YXM7XG5cbiAgICAvLyBjb25zdCBjb21wcmVzc2VkID0gY29tcHJlc3MoSlNPTi5zdHJpbmdpZnkoZGVsdGFzKSk7XG5cbiAgICAvLyBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAvLyAgIGNsZWFySW50ZXJ2YWwoaW50ZXJWKTtcblxuICAgIC8vICAgLy8gY29uc3QgZGVsdGFTdHIgPSBKU09OLnN0cmluZ2lmeShkZWx0YXMpO1xuICAgIC8vICAgY29uc3QgdXNlciA9ICgoc2VsZiAmJiBzZWxmLmNyeXB0byAmJiBzZWxmLmNyeXB0by5yYW5kb21VVUlEICYmXG4gICAgLy8gICAgIHNlbGYuY3J5cHRvLnJhbmRvbVVVSUQoKSkgfHwgKGF3YWl0IGltcG9ydChcIi4vdWlkVjQubWpzXCIpKS5kZWZhdWx0KCkpXG4gICAgLy8gICAgIC5zbGljZShcbiAgICAvLyAgICAgICAwLFxuICAgIC8vICAgICAgIDgsXG4gICAgLy8gICAgICk7XG5cbiAgICBjb25zdCB7IGpvaW4gfSA9IGF3YWl0IGltcG9ydChcIi4vd3MubWpzXCIpO1xuICAgIGpvaW4ocm9vbSwgdXNlciwgZGVsdGFzKTtcbiAgICByZXR1cm47XG4gICAgLy8gICAvL3NcblxuICAgIC8vICAgLy8gY29uc29sZS5sb2coZGVsdGFTdHIpO1xuICAgIC8vICAgLy8gcm9vdC51bm1vdW50KCk7XG4gICAgLy8gICAvLyAvLyBjb25zdCBjb21wcmVzc2VkID0gY29tcHJlc3MoSlNPTi5zdHJpbmdpZnkoZGVsdGFzKSk7XG4gICAgLy8gICAvLyBjb25zb2xlLmxvZyhcbiAgICAvLyAgIC8vICAgSlNPTi5zdHJpbmdpZnkoZGVsdGFzKS5sZW5ndGgsXG4gICAgLy8gICAvLyAgIC8vIEpTT04uc3RyaW5naWZ5KGNvbXByZXNzZWQpLmxlbmd0aCxcbiAgICAvLyAgIC8vICk7XG5cbiAgICAvLyAgIC8vIGxldCBpID0gMDtcbiAgICAvLyAgIC8vIGNvbnN0IGRlbHRhc0xlbmd0aCA9IGRlbHRhcy5sZW5ndGg7XG4gICAgLy8gICAvLyBsZXQgbGFzdCA9IGh0bWw7XG5cbiAgICAvLyAgIC8vIHNldEludGVydmFsKCgpID0+IHtcbiAgICAvLyAgIC8vICAgY29uc3QgaW5kZXggPSBpICUgZGVsdGFzTGVuZ3RoO1xuICAgIC8vICAgLy8gICBpZiAoaW5kZXggPT09IDApIGxhc3QgPSBodG1sO1xuXG4gICAgLy8gICAvLyAgIGkrKztcbiAgICAvLyAgIC8vICAgY29uc3QgZGVsdGEgPSBkZWx0YXNbaW5kZXhdO1xuICAgIC8vICAgLy8gICBpZiAoIWRlbHRhKSByZXR1cm47XG4gICAgLy8gICAvLyAgIGNvbnN0IG5leHQgPSBhcHBseURlbHRhKGxhc3QsIGRlbHRhKTtcbiAgICAvLyAgIC8vICAgbGFzdCA9IG5leHQ7XG4gICAgLy8gICAvLyAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBuZXh0O1xuICAgIC8vICAgLy8gfSwgMTAwMCAvIDYwKTtcbiAgICAvLyB9LCAyMDAwKTtcblxuICAgIHJldHVybjtcbiAgfSBlbHNlIHtcbiAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gY29uc3QgQXBwID0gKGF3YWl0IGltcG9ydChcbiAgICAgIC8vICAgYGh0dHBzOi8vc3Bpa2UubGFuZC9hcGkvcm9vbS96b2xpL2pzYCxcbiAgICAgIC8vICkpLmRlZmF1bHQ7XG5cbiAgICAgIGNvbnN0IGFwcGx5RGVsdGEgPSAoYXdhaXQgaW1wb3J0KFxuICAgICAgICBcImh0dHBzOi8vdW5wa2cuY29tL0BzcGlrZS5sYW5kL2VzbUAwLjQuMzMvZGlzdC90ZXh0ZGlmZi1wYXRjaC5tanNcIlxuICAgICAgKSkuZGVmYXVsdDtcblxuICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgaHR0cHM6Ly9zcGlrZS5sYW5kL2FwaS9yb29tLyR7cm9vbX0vZGVsdGFgLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGRlbHRhcyA9IGF3YWl0IHJlc3AuanNvbigpO1xuXG4gICAgICAvLyAgIGNvbnN0IHsganN4IH0gPSBlbW90aW9uUmVhY3Q7XG5cbiAgICAgIC8vICAgY29uc3QgeyBSZWFjdERPTSB9ID0gd2luZG93O1xuXG4gICAgICAvLyAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIC8vICBjb250YWluZXIuaWQgPSBcInVwZ3JhZGUtbWVcIjtcbiAgICAgIC8vIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcblxuICAgICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiemJvZHlcIik7XG5cbiAgICAgIGlmICghY29udGFpbmVyKSB7XG4gICAgICAgIGNvbnN0IHJlc3BTID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICAgYGh0dHBzOi8vc3Bpa2UubGFuZC9hcGkvcm9vbS8ke3Jvb219L3Nlc3Npb25gLFxuICAgICAgICApO1xuICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcmVzcFMuanNvbigpO1xuICAgICAgICBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJvb3RcIik7XG4gICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPVxuICAgICAgICAgIGA8c3R5bGU+JHtzZXNzaW9uLmNzc308L3N0eWxlPjxkaXYgaWQ9XCJ6Ym9keVwiPiR7c2Vzc2lvbi5odG1sfTwvZGl2PmA7XG4gICAgICAgIGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiemJvZHlcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChkZWx0YXMgJiYgZGVsdGFzLmxlbmd0aCkge1xuICAgICAgICAvLyAgIGNvbnN0IHN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICAgICAgICAvLyAgIHN0LmlubmVySFRNTCA9IHNlc3Npb24uY3NzO1xuXG4gICAgICAgIGNvbnN0IGh0bWwgPSBjb250YWluZXIuaW5uZXJIVE1MO1xuXG4gICAgICAgIC8vICAgY29uc3QgYXBwbGllZCA9IGFwcGx5RGVsdGEoaHRtbCwgZGVsdGFzWzBdKTtcbiAgICAgICAgLy8gICBjb250YWluZXIuaW5uZXJIVE1MID0gc2Vzc2lvbi5odG1sO1xuICAgICAgICAvLyBgPHN0eWxlPiR7c2Vzc2lvbi5jc3N9PC9zdHlsZT48ZGl2PiR7c2Vzc2lvbi5odG1sfTwvZGl2PmA7XG5cbiAgICAgICAgLy8gIGNvbnN0IHJvb3QgPSBSZWFjdERPTS5jcmVhdGVSb290KHRhcmdldCk7XG5cbiAgICAgICAgLy8gICByb290LnJlbmRlcihqc3goQXBwKSk7XG5cbiAgICAgICAgLy8gICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHN0KTtcblxuICAgICAgICAvLyAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuXG4gICAgICAgIC8vICAgY29uc3QgekJvZHkgPSBjb250YWluZXI7XG5cbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICBsZXQgbGFzdCA9IGh0bWw7XG4gICAgICAgIGNvbnN0IGRlbHRhc0xlbmd0aCA9IGRlbHRhcy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IGFuaW1hdGlvbkxlbmd0aCA9ICgyMDAwIC0gKERhdGUubm93KCkgLSB3aW5kb3cuYW5pU3RhcnQpKSAvXG4gICAgICAgICAgZGVsdGFzLmxlbmd0aDtcbiAgICAgICAgY29uc29sZS5sb2coeyBhbmltYXRpb25MZW5ndGggfSk7XG4gICAgICAgIGNvbnN0IGNsSW50ID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgIGlmIChpID49IGRlbHRhcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoY2xJbnQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBpbmRleCA9IGkgJSBkZWx0YXNMZW5ndGg7XG4gICAgICAgICAgaWYgKGluZGV4ID09PSAwKSBsYXN0ID0gaHRtbDtcbiAgICAgICAgICAvL1xuICAgICAgICAgIGkrKztcbiAgICAgICAgICBjb25zdCBkZWx0YSA9IGRlbHRhc1tpbmRleF07XG4gICAgICAgICAgaWYgKCFkZWx0YSkgcmV0dXJuO1xuICAgICAgICAgIGNvbnN0IG5leHQgPSBhcHBseURlbHRhKGxhc3QsIGRlbHRhKTtcbiAgICAgICAgICBsYXN0ID0gbmV4dDtcblxuICAgICAgICAgIC8vIGNvbnN0IG5ld0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgLy8gbmV3RGl2LmlkID0gXCJ6Ym9keXdcIjtcbiAgICAgICAgICAvLyBuZXdEaXYuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJ6Ym9keXdcIik7XG5cbiAgICAgICAgICAvLyBuZXdEaXYuaW5uZXJIVE1MID0gYDxkaXY+JHtuZXh0fTwvZGl2PmA7XG5cbiAgICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gbmV4dDtcblxuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG5leHQpO1xuICAgICAgICAgIC8vICAgIGRvY3VtZW50LnJlbW92ZUNoaWxkKGNvbnRhaW5lcik7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2cobmV4dCk7XG4gICAgICAgICAgLy8gemJvZFxuICAgICAgICB9LCBhbmltYXRpb25MZW5ndGgpO1xuICAgICAgICAvLyAgZG9jdW1lbnQuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IEFwcCA9IChhd2FpdCBpbXBvcnQoXG4gICAgICAgICAgYGh0dHBzOi8vc3Bpa2UubGFuZC9hcGkvcm9vbS8ke3Jvb219L2pzYFxuICAgICAgICApKS5kZWZhdWx0O1xuXG4gICAgICAgIGNvbnN0IHsganN4IH0gPSBhd2FpdCBpbXBvcnQoXCJAZW1vdGlvbi9yZWFjdFwiKTtcblxuICAgICAgICBsZXQgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN6Ym9keVwiKTtcblxuICAgICAgICBpZiAoIWNvbnRhaW5lcikge1xuICAgICAgICAgIGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicm9vdFwiKTtcbiAgICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID1cbiAgICAgICAgICAgIGA8c3R5bGU+JHtzZXNzaW9uLmNzc308L3N0eWxlPjxkaXYgaWQ9XCJ6Ym9keVwiPiR7c2Vzc2lvbi5odG1sfTwvZGl2PmA7XG4gICAgICAgICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjemJvZHlcIik7XG4gICAgICAgIH1cblxuICAgICAgICBSZWFjdERPTS5oeWRyYXRlUm9vdChjb250YWluZXIsIGpzeChBcHApKTtcbiAgICAgIH1cbiAgICB9KSgpO1xuICB9XG5cbiAgLy8vIEZvciBsb2NhbCBkZXZcbiAgLy8gaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicm9vdFwiKS5pbm5lckhUTUwubGVuZ3RoID09PSAwKSB7XG4gIC8vICAgY29uc3QgY2FjaGVLZXkgPSBgc3RhdGUtJHtyb29tfWA7XG4gIC8vICAgY29uc3Qgc2F2ZWRTdGF0ZVN0ciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGNhY2hlS2V5KTtcbiAgLy8gICBpZiAoIXNhdmVkU3RhdGVTdHIpIHtcbiAgLy8gICAgIGNvbnN0IHNhdmVkU3RhdGUgPSBKU09OLnBhcnNlKHNhdmVkU3RhdGVTdHIpO1xuICAvLyAgICAgY29uc3QgcHJlUmVuZGVyQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyb290XCIpO1xuICAvLyAgICAgaWYgKFxuICAvLyAgICAgICBwcmVSZW5kZXJDb250YWluZXIgJiYgc2F2ZWRTdGF0ZSAmJlxuICAvLyAgICAgICBwcmVSZW5kZXJDb250YWluZXIuaW5uZXJIVE1MLmxlbmd0aCA9PT0gMFxuICAvLyAgICAgKSB7XG4gIC8vICAgICAgIHByZVJlbmRlckNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHN0eWxlPiR7c2F2ZWRTdGF0ZS5jc3N9PC9zdHlsZT5cbiAgLy8gICAgICAgICA8ZGl2IGlkPVwiemJvZHlcIj4ke3NhdmVkU3RhdGUuaHRtbH08L2Rpdj5gO1xuICAvLyAgICAgICBjb25zb2xlLmxvZyhgPHN0eWxlPiR7c2F2ZWRTdGF0ZS5jc3N9PC9zdHlsZT5cbiAgLy8gICAgICAgJHtzYXZlZFN0YXRlLmh0bWx9XG4gIC8vICAgICAgIGApO1xuICAvLyAgICAgfVxuICAvLyAgIH1cbiAgLy8gfVxuXG4gIGNvbnN0IHsgam9pbiB9ID0gYXdhaXQgaW1wb3J0KFwiLi93cy5tanNcIik7XG4gIGpvaW4ocm9vbSwgdXNlcik7XG4gIC8vIENvbnNv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
