import"./chunks/chunk-XOF3GJEG.mjs";var g=async h=>{let r=location.pathname.split("/");window.aniStart=Date.now();let i=h||(r[1]==="api"&&r[2]==="room"?r[3]:(r.pop()||r.pop()).slice(-12))||"code-main",m=(self&&self.crypto&&self.crypto.randomUUID&&self.crypto.randomUUID()||(await import("./chunks/uidV4-GPNAVNE5.mjs")).default()).slice(0,8);if(location.pathname.includes("hydrate")){let d=(await import(`https://spike.land/api/room/${i}/js`)).default,y=(await import("./chunks/textdiff-create-R4Q5EC4X.mjs")).default,{jsx:n}=await import("https://unpkg.com/@spike.land/esm@0.6.117/dist/emotion-react.mjs"),{ReactDOM:o}=window,s=document.querySelector("#zbody");window.aniStart=Date.now();let e=o.hydrateRoot(s,n(d)),t=[],a=document.getElementById("zbody").innerHTML,p=a,w=setInterval(()=>{let c=s.innerHTML;t.push(y(a,c)),a=c},1e3/60);window.deltas=t;let{join:l}=await import("./chunks/ws-JORYPAJW.mjs");l(i,m,t);return}else(async()=>{let d=(await import("https://unpkg.com/@spike.land/esm@0.4.33/dist/textdiff-patch.mjs")).default,n=await(await fetch(`https://spike.land/api/room/${i}/delta`)).json(),o=document.getElementById("zbody");if(!o){let e=await(await fetch(`https://spike.land/api/room/${i}/session`)).json();o=document.getElementById("root"),o.innerHTML=`<style>${e.css}</style><div id="zbody">${e.html}</div>`,o=document.getElementById("zbody")}if(n&&n.length){let s=o.innerHTML,e=0,t=s,a=n.length,p=(2e3-(Date.now()-window.aniStart))/n.length;console.log({animationLength:p});let w=setInterval(()=>{if(e>=n.length){clearInterval(w);return}let l=e%a;l===0&&(t=s),e++;let c=n[l];if(!c)return;let u=d(t,c);t=u,o.innerHTML=u},p)}else{let s=(await import(`https://spike.land/api/room/${i}/js`)).default,{jsx:e}=await import("https://unpkg.com/@spike.land/esm@0.6.117/dist/emotion-react.mjs"),t=document.querySelector("#zbody");if(!t){a=document.getElementById("root"),a.innerHTML=`<style>${session.css}</style><div id="zbody">${session.html}</div>`;let a=document.querySelector("#zbody")}ReactDOM.hydrateRoot(t,e(s))}})();let{join:f}=await import("./chunks/ws-JORYPAJW.mjs");f(i,m)};export{g as run};
