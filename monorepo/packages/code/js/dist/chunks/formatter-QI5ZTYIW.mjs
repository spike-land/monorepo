import"./chunk-UT4UBVWW.mjs";var b=Symbol("Comlink.proxy"),x=Symbol("Comlink.endpoint"),A=Symbol("Comlink.releaseProxy"),w=Symbol("Comlink.thrown"),S=e=>typeof e=="object"&&e!==null||typeof e=="function",C={canHandle:e=>S(e)&&e[b],serialize(e){let{port1:r,port2:t}=new MessageChannel;return M(e,r),[t,[t]]},deserialize(e){return e.start(),h(e)}},O={canHandle:e=>S(e)&&w in e,serialize({value:e}){let r;return e instanceof Error?r={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:r={isError:!1,value:e},[r,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},L=new Map([["proxy",C],["throw",O]]);function M(e,r=self){r.addEventListener("message",function t(n){if(!n||!n.data)return;let{id:l,type:p,path:s}=Object.assign({path:[]},n.data),i=(n.data.argumentList||[]).map(f),o;try{let a=s.slice(0,-1).reduce((c,m)=>c[m],e),u=s.reduce((c,m)=>c[m],e);switch(p){case"GET":o=u;break;case"SET":a[s.slice(-1)[0]]=f(n.data.value),o=!0;break;case"APPLY":o=u.apply(a,i);break;case"CONSTRUCT":{let c=new u(...i);o=$(c)}break;case"ENDPOINT":{let{port1:c,port2:m}=new MessageChannel;M(e,m),o=j(c,[c])}break;case"RELEASE":o=void 0;break;default:return}}catch(a){o={value:a,[w]:0}}Promise.resolve(o).catch(a=>({value:a,[w]:0})).then(a=>{let[u,c]=y(a);r.postMessage(Object.assign(Object.assign({},u),{id:l}),c),p==="RELEASE"&&(r.removeEventListener("message",t),P(r))})}),r.start&&r.start()}function T(e){return e.constructor.name==="MessagePort"}function P(e){T(e)&&e.close()}function h(e,r){return k(e,[],r)}function g(e){if(e)throw new Error("Proxy has been released and is not useable")}function k(e,r=[],t=function(){}){let n=!1,l=new Proxy(t,{get(p,s){if(g(n),s===A)return()=>d(e,{type:"RELEASE",path:r.map(i=>i.toString())}).then(()=>{P(e),n=!0});if(s==="then"){if(r.length===0)return{then:()=>l};let i=d(e,{type:"GET",path:r.map(o=>o.toString())}).then(f);return i.then.bind(i)}return k(e,[...r,s])},set(p,s,i){g(n);let[o,a]=y(i);return d(e,{type:"SET",path:[...r,s].map(u=>u.toString()),value:o},a).then(f)},apply(p,s,i){g(n);let o=r[r.length-1];if(o===x)return d(e,{type:"ENDPOINT"}).then(f);if(o==="bind")return k(e,r.slice(0,-1));let[a,u]=E(i);return d(e,{type:"APPLY",path:r.map(c=>c.toString()),argumentList:a},u).then(f)},construct(p,s){g(n);let[i,o]=E(s);return d(e,{type:"CONSTRUCT",path:r.map(a=>a.toString()),argumentList:i},o).then(f)}});return l}function N(e){return Array.prototype.concat.apply([],e)}function E(e){let r=e.map(y);return[r.map(t=>t[0]),N(r.map(t=>t[1]))]}var R=new WeakMap;function j(e,r){return R.set(e,r),e}function $(e){return Object.assign(e,{[b]:!0})}function y(e){for(let[r,t]of L)if(t.canHandle(e)){let[n,l]=t.serialize(e);return[{type:"HANDLER",name:r,value:n},l]}return[{type:"RAW",value:e},R.get(e)||[]]}function f(e){switch(e.type){case"HANDLER":return L.get(e.name).deserialize(e.value);case"RAW":return e.value}}function d(e,r,t){return new Promise(n=>{let l=H();e.addEventListener("message",function p(s){!s.data||!s.data.id||s.data.id!==l||(e.removeEventListener("message",p),n(s.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:l},r),t)})}function H(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var W=e=>{let r=new Worker(e),{port1:t,port2:n}=new MessageChannel,l={comlinkInit:!0,port:t};return r.postMessage(l,[t]),h(n)};var z=W(src),D=async e=>{let{formatter:r}=await import("./prettierEsm-LS5JKGVF.mjs");return r(e)};export{D as formatter};
