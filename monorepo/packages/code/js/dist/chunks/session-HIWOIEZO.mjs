import{a as En}from"./chunk-OS37FQ3X.mjs";import{a as In,b as Zr,c as zt}from"./chunk-XOF3GJEG.mjs";var gn=In((Oi,ln)=>{"use strict";ln.exports=function(r,t){for(var e="",n=0,i=0;i<t.length;i++){var o=t[i],s=o[0],u=o[1];s==-1?n+=u:s==0?e+=r.slice(n,n+=u):e+=u}return e}});var bt="delete",m=5,D=1<<m,A=D-1,y={};function ar(){return{value:!1}}function B(r){r&&(r.value=!0)}function fr(){}function ht(r){return r.size===void 0&&(r.size=r.__iterate(Gr)),r.size}function V(r,t){if(typeof t!="number"){var e=t>>>0;if(""+e!==t||e===4294967295)return NaN;t=e}return t<0?ht(r)+t:t}function Gr(){return!0}function Jt(r,t,e){return(r===0&&!Vr(r)||e!==void 0&&r<=-e)&&(t===void 0||e!==void 0&&t>=e)}function Mt(r,t){return Qr(r,t,0)}function Yt(r,t){return Qr(r,t,t)}function Qr(r,t,e){return r===void 0?e:Vr(r)?t===1/0?t:Math.max(0,t+r)|0:t===void 0||t===r?r:Math.min(t,r)|0}function Vr(r){return r<0||r===0&&1/r===-1/0}var te="@@__IMMUTABLE_ITERABLE__@@";function T(r){return Boolean(r&&r[te])}var re="@@__IMMUTABLE_KEYED__@@";function I(r){return Boolean(r&&r[re])}var ee="@@__IMMUTABLE_INDEXED__@@";function C(r){return Boolean(r&&r[ee])}function Ht(r){return I(r)||C(r)}var z=function(t){return T(t)?t:L(t)},k=function(r){function t(e){return I(e)?e:tt(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t}(z),ot=function(r){function t(e){return C(e)?e:J(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t}(z),ct=function(r){function t(e){return T(e)&&!Ht(e)?e:dt(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t}(z);z.Keyed=k;z.Indexed=ot;z.Set=ct;var ne="@@__IMMUTABLE_SEQ__@@";function hr(r){return Boolean(r&&r[ne])}var ie="@@__IMMUTABLE_RECORD__@@";function qt(r){return Boolean(r&&r[ie])}function x(r){return T(r)||qt(r)}var pt="@@__IMMUTABLE_ORDERED__@@";function K(r){return Boolean(r&&r[pt])}var At=0,F=1,P=2,cr=typeof Symbol=="function"&&Symbol.iterator,oe="@@iterator",xt=cr||oe,l=function(t){this.next=t};l.prototype.toString=function(){return"[Iterator]"};l.KEYS=At;l.VALUES=F;l.ENTRIES=P;l.prototype.inspect=l.prototype.toSource=function(){return this.toString()};l.prototype[xt]=function(){return this};function O(r,t,e,n){var i=r===0?t:r===1?e:[t,e];return n?n.value=i:n={value:i,done:!1},n}function j(){return{value:void 0,done:!0}}function se(r){return Array.isArray(r)?!0:!!Xt(r)}function ue(r){return r&&typeof r.next=="function"}function pr(r){var t=Xt(r);return t&&t.call(r)}function Xt(r){var t=r&&(cr&&r[cr]||r[oe]);if(typeof t=="function")return t}function zn(r){var t=Xt(r);return t&&t===r.entries}function bn(r){var t=Xt(r);return t&&t===r.keys}var _t=Object.prototype.hasOwnProperty;function ae(r){return Array.isArray(r)||typeof r=="string"?!0:r&&typeof r=="object"&&Number.isInteger(r.length)&&r.length>=0&&(r.length===0?Object.keys(r).length===1:r.hasOwnProperty(r.length-1))}var L=function(r){function t(e){return e==null?dr():x(e)?e.toSeq():qn(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.toSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq {","}")},t.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},t.prototype.__iterate=function(n,i){var o=this._cache;if(o){for(var s=o.length,u=0;u!==s;){var a=o[i?s-++u:u++];if(n(a[1],a[0],this)===!1)break}return u}return this.__iterateUncached(n,i)},t.prototype.__iterator=function(n,i){var o=this._cache;if(o){var s=o.length,u=0;return new l(function(){if(u===s)return j();var a=o[i?s-++u:u++];return O(n,a[0],a[1])})}return this.__iteratorUncached(n,i)},t}(z),tt=function(r){function t(e){return e==null?dr().toKeyedSeq():T(e)?I(e)?e.toSeq():e.fromEntrySeq():qt(e)?e.toSeq():vr(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.toKeyedSeq=function(){return this},t}(L),J=function(r){function t(e){return e==null?dr():T(e)?I(e)?e.entrySeq():e.toIndexedSeq():qt(e)?e.toSeq().entrySeq():he(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toIndexedSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq [","]")},t}(L),dt=function(r){function t(e){return(T(e)&&!Ht(e)?e:J(e)).toSetSeq()}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toSetSeq=function(){return this},t}(L);L.isSeq=hr;L.Keyed=tt;L.Set=dt;L.Indexed=J;L.prototype[ne]=!0;var st=function(r){function t(e){this._array=e,this.size=e.length}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return this.has(n)?this._array[V(this,n)]:i},t.prototype.__iterate=function(n,i){for(var o=this._array,s=o.length,u=0;u!==s;){var a=i?s-++u:u++;if(n(o[a],a,this)===!1)break}return u},t.prototype.__iterator=function(n,i){var o=this._array,s=o.length,u=0;return new l(function(){if(u===s)return j();var a=i?s-++u:u++;return O(n,a,o[a])})},t}(J),_r=function(r){function t(e){var n=Object.keys(e);this._object=e,this._keys=n,this.size=n.length}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return i!==void 0&&!this.has(n)?i:this._object[n]},t.prototype.has=function(n){return _t.call(this._object,n)},t.prototype.__iterate=function(n,i){for(var o=this._object,s=this._keys,u=s.length,a=0;a!==u;){var f=s[i?u-++a:a++];if(n(o[f],f,this)===!1)break}return a},t.prototype.__iterator=function(n,i){var o=this._object,s=this._keys,u=s.length,a=0;return new l(function(){if(a===u)return j();var f=s[i?u-++a:a++];return O(n,f,o[f])})},t}(tt);_r.prototype[pt]=!0;var Mn=function(r){function t(e){this._collection=e,this.size=e.length||e.size}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.__iterateUncached=function(n,i){if(i)return this.cacheResult().__iterate(n,i);var o=this._collection,s=pr(o),u=0;if(ue(s))for(var a;!(a=s.next()).done&&n(a.value,u++,this)!==!1;);return u},t.prototype.__iteratorUncached=function(n,i){if(i)return this.cacheResult().__iterator(n,i);var o=this._collection,s=pr(o);if(!ue(s))return new l(j);var u=0;return new l(function(){var a=s.next();return a.done?a:O(n,u++,a.value)})},t}(J),fe;function dr(){return fe||(fe=new st([]))}function vr(r){var t=yr(r);if(t)return t.fromEntrySeq();if(typeof r=="object")return new _r(r);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+r)}function he(r){var t=yr(r);if(t)return t;throw new TypeError("Expected Array or collection object of values: "+r)}function qn(r){var t=yr(r);if(t)return zn(r)?t.fromEntrySeq():bn(r)?t.toSetSeq():t;if(typeof r=="object")return new _r(r);throw new TypeError("Expected Array or collection object of values, or keyed object: "+r)}function yr(r){return ae(r)?new st(r):se(r)?new Mn(r):void 0}var ce="@@__IMMUTABLE_MAP__@@";function lr(r){return Boolean(r&&r[ce])}function pe(r){return lr(r)&&K(r)}function _e(r){return Boolean(r&&typeof r.equals=="function"&&typeof r.hashCode=="function")}function $(r,t){if(r===t||r!==r&&t!==t)return!0;if(!r||!t)return!1;if(typeof r.valueOf=="function"&&typeof t.valueOf=="function"){if(r=r.valueOf(),t=t.valueOf(),r===t||r!==r&&t!==t)return!0;if(!r||!t)return!1}return!!(_e(r)&&_e(t)&&r.equals(t))}var Rt=typeof Math.imul=="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(t,e){t|=0,e|=0;var n=t&65535,i=e&65535;return n*i+((t>>>16)*i+n*(e>>>16)<<16>>>0)|0};function Zt(r){return r>>>1&1073741824|r&3221225471}var An=Object.prototype.valueOf;function U(r){if(r==null)return de(r);if(typeof r.hashCode=="function")return Zt(r.hashCode(r));var t=Ln(r);if(t==null)return de(t);switch(typeof t){case"boolean":return t?1108378657:1108378656;case"number":return Rn(t);case"string":return t.length>$n?Tn(t):gr(t);case"object":case"function":return jn(t);case"symbol":return Cn(t);default:if(typeof t.toString=="function")return gr(t.toString());throw new Error("Value type "+typeof t+" cannot be hashed.")}}function de(r){return r===null?1108378658:1108378659}function Rn(r){if(r!==r||r===1/0)return 0;var t=r|0;for(t!==r&&(t^=r*4294967295);r>4294967295;)r/=4294967295,t^=r;return Zt(t)}function Tn(r){var t=Ir[r];return t===void 0&&(t=gr(r),Or===Un&&(Or=0,Ir={}),Or++,Ir[r]=t),t}function gr(r){for(var t=0,e=0;e<r.length;e++)t=31*t+r.charCodeAt(e)|0;return Zt(t)}function Cn(r){var t=ge[r];return t!==void 0||(t=le(),ge[r]=t),t}function jn(r){var t;if(Sr&&(t=mr.get(r),t!==void 0)||(t=r[ut],t!==void 0)||!ye&&(t=r.propertyIsEnumerable&&r.propertyIsEnumerable[ut],t!==void 0||(t=Nn(r),t!==void 0)))return t;if(t=le(),Sr)mr.set(r,t);else{if(ve!==void 0&&ve(r)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(ye)Object.defineProperty(r,ut,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(r.propertyIsEnumerable!==void 0&&r.propertyIsEnumerable===r.constructor.prototype.propertyIsEnumerable)r.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},r.propertyIsEnumerable[ut]=t;else if(r.nodeType!==void 0)r[ut]=t;else throw new Error("Unable to set a non-enumerable property on object.")}return t}var ve=Object.isExtensible,ye=function(){try{return Object.defineProperty({},"@",{}),!0}catch(r){return!1}}();function Nn(r){if(r&&r.nodeType>0)switch(r.nodeType){case 1:return r.uniqueID;case 9:return r.documentElement&&r.documentElement.uniqueID}}function Ln(r){return r.valueOf!==An&&typeof r.valueOf=="function"?r.valueOf(r):r}function le(){var r=++wr;return wr&1073741824&&(wr=0),r}var Sr=typeof WeakMap=="function",mr;Sr&&(mr=new WeakMap);var ge=Object.create(null),wr=0,ut="__immutablehash__";typeof Symbol=="function"&&(ut=Symbol(ut));var $n=16,Un=255,Or=0,Ir={},Gt=function(r){function t(e,n){this._iter=e,this._useKeys=n,this.size=e.size}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return this._iter.get(n,i)},t.prototype.has=function(n){return this._iter.has(n)},t.prototype.valueSeq=function(){return this._iter.valueSeq()},t.prototype.reverse=function(){var n=this,i=Er(this,!0);return this._useKeys||(i.valueSeq=function(){return n._iter.toSeq().reverse()}),i},t.prototype.map=function(n,i){var o=this,s=Ie(this,n,i);return this._useKeys||(s.valueSeq=function(){return o._iter.toSeq().map(n,i)}),s},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s,u){return n(s,u,o)},i)},t.prototype.__iterator=function(n,i){return this._iter.__iterator(n,i)},t}(tt);Gt.prototype[pt]=!0;var Se=function(r){function t(e){this._iter=e,this.size=e.size}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.includes=function(n){return this._iter.includes(n)},t.prototype.__iterate=function(n,i){var o=this,s=0;return i&&ht(this),this._iter.__iterate(function(u){return n(u,i?o.size-++s:s++,o)},i)},t.prototype.__iterator=function(n,i){var o=this,s=this._iter.__iterator(F,i),u=0;return i&&ht(this),new l(function(){var a=s.next();return a.done?a:O(n,i?o.size-++u:u++,a.value,a)})},t}(J),me=function(r){function t(e){this._iter=e,this.size=e.size}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.has=function(n){return this._iter.includes(n)},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s){return n(s,s,o)},i)},t.prototype.__iterator=function(n,i){var o=this._iter.__iterator(F,i);return new l(function(){var s=o.next();return s.done?s:O(n,s.value,s.value,s)})},t}(dt),we=function(r){function t(e){this._iter=e,this.size=e.size}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.entrySeq=function(){return this._iter.toSeq()},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s){if(s){qe(s);var u=T(s);return n(u?s.get(1):s[1],u?s.get(0):s[0],o)}},i)},t.prototype.__iterator=function(n,i){var o=this._iter.__iterator(F,i);return new l(function(){for(;;){var s=o.next();if(s.done)return s;var u=s.value;if(u){qe(u);var a=T(u);return O(n,a?u.get(0):u[0],a?u.get(1):u[1],s)}}})},t}(tt);Se.prototype.cacheResult=Gt.prototype.cacheResult=me.prototype.cacheResult=we.prototype.cacheResult=br;function Oe(r){var t=X(r);return t._iter=r,t.size=r.size,t.flip=function(){return r},t.reverse=function(){var e=r.reverse.apply(this);return e.flip=function(){return r.reverse()},e},t.has=function(e){return r.includes(e)},t.includes=function(e){return r.has(e)},t.cacheResult=br,t.__iterateUncached=function(e,n){var i=this;return r.__iterate(function(o,s){return e(s,o,i)!==!1},n)},t.__iteratorUncached=function(e,n){if(e===P){var i=r.__iterator(e,n);return new l(function(){var o=i.next();if(!o.done){var s=o.value[0];o.value[0]=o.value[1],o.value[1]=s}return o})}return r.__iterator(e===F?At:F,n)},t}function Ie(r,t,e){var n=X(r);return n.size=r.size,n.has=function(i){return r.has(i)},n.get=function(i,o){var s=r.get(i,y);return s===y?o:t.call(e,s,i,r)},n.__iterateUncached=function(i,o){var s=this;return r.__iterate(function(u,a,f){return i(t.call(e,u,a,f),a,s)!==!1},o)},n.__iteratorUncached=function(i,o){var s=r.__iterator(P,o);return new l(function(){var u=s.next();if(u.done)return u;var a=u.value,f=a[0];return O(i,f,t.call(e,a[1],f,r),u)})},n}function Er(r,t){var e=this,n=X(r);return n._iter=r,n.size=r.size,n.reverse=function(){return r},r.flip&&(n.flip=function(){var i=Oe(r);return i.reverse=function(){return r.flip()},i}),n.get=function(i,o){return r.get(t?i:-1-i,o)},n.has=function(i){return r.has(t?i:-1-i)},n.includes=function(i){return r.includes(i)},n.cacheResult=br,n.__iterate=function(i,o){var s=this,u=0;return o&&ht(r),r.__iterate(function(a,f){return i(a,t?f:o?s.size-++u:u++,s)},!o)},n.__iterator=function(i,o){var s=0;o&&ht(r);var u=r.__iterator(P,!o);return new l(function(){var a=u.next();if(a.done)return a;var f=a.value;return O(i,t?f[0]:o?e.size-++s:s++,f[1],a)})},n}function Ee(r,t,e,n){var i=X(r);return n&&(i.has=function(o){var s=r.get(o,y);return s!==y&&!!t.call(e,s,o,r)},i.get=function(o,s){var u=r.get(o,y);return u!==y&&t.call(e,u,o,r)?u:s}),i.__iterateUncached=function(o,s){var u=this,a=0;return r.__iterate(function(f,h,c){if(t.call(e,f,h,c))return a++,o(f,n?h:a-1,u)},s),a},i.__iteratorUncached=function(o,s){var u=r.__iterator(P,s),a=0;return new l(function(){for(;;){var f=u.next();if(f.done)return f;var h=f.value,c=h[0],p=h[1];if(t.call(e,p,c,r))return O(o,n?c:a++,p,f)}})},i}function Dn(r,t,e){var n=lt().asMutable();return r.__iterate(function(i,o){n.update(t.call(e,i,o,r),0,function(s){return s+1})}),n.asImmutable()}function Bn(r,t,e){var n=I(r),i=(K(r)?Q():lt()).asMutable();r.__iterate(function(s,u){i.update(t.call(e,s,u,r),function(a){return a=a||[],a.push(n?[u,s]:s),a})});var o=Ae(r);return i.map(function(s){return g(r,o(s))}).asImmutable()}function zr(r,t,e,n){var i=r.size;if(Jt(t,e,i))return r;var o=Mt(t,i),s=Yt(e,i);if(o!==o||s!==s)return zr(r.toSeq().cacheResult(),t,e,n);var u=s-o,a;u===u&&(a=u<0?0:u);var f=X(r);return f.size=a===0?a:r.size&&a||void 0,!n&&hr(r)&&a>=0&&(f.get=function(h,c){return h=V(this,h),h>=0&&h<a?r.get(h+o,c):c}),f.__iterateUncached=function(h,c){var p=this;if(a===0)return 0;if(c)return this.cacheResult().__iterate(h,c);var d=0,_=!0,v=0;return r.__iterate(function(N,H){if(!(_&&(_=d++<o)))return v++,h(N,n?H:v-1,p)!==!1&&v!==a}),v},f.__iteratorUncached=function(h,c){if(a!==0&&c)return this.cacheResult().__iterator(h,c);if(a===0)return new l(j);var p=r.__iterator(h,c),d=0,_=0;return new l(function(){for(;d++<o;)p.next();if(++_>a)return j();var v=p.next();return n||h===F||v.done?v:h===At?O(h,_-1,void 0,v):O(h,_-1,v.value[1],v)})},f}function kn(r,t,e){var n=X(r);return n.__iterateUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterate(i,o);var u=0;return r.__iterate(function(a,f,h){return t.call(e,a,f,h)&&++u&&i(a,f,s)}),u},n.__iteratorUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterator(i,o);var u=r.__iterator(P,o),a=!0;return new l(function(){if(!a)return j();var f=u.next();if(f.done)return f;var h=f.value,c=h[0],p=h[1];return t.call(e,p,c,s)?i===P?f:O(i,c,p,f):(a=!1,j())})},n}function ze(r,t,e,n){var i=X(r);return i.__iterateUncached=function(o,s){var u=this;if(s)return this.cacheResult().__iterate(o,s);var a=!0,f=0;return r.__iterate(function(h,c,p){if(!(a&&(a=t.call(e,h,c,p))))return f++,o(h,n?c:f-1,u)}),f},i.__iteratorUncached=function(o,s){var u=this;if(s)return this.cacheResult().__iterator(o,s);var a=r.__iterator(P,s),f=!0,h=0;return new l(function(){var c,p,d;do{if(c=a.next(),c.done)return n||o===F?c:o===At?O(o,h++,void 0,c):O(o,h++,c.value[1],c);var _=c.value;p=_[0],d=_[1],f&&(f=t.call(e,d,p,u))}while(f);return o===P?c:O(o,p,d,c)})},i}function Pn(r,t){var e=I(r),n=[r].concat(t).map(function(s){return T(s)?e&&(s=k(s)):s=e?vr(s):he(Array.isArray(s)?s:[s]),s}).filter(function(s){return s.size!==0});if(n.length===0)return r;if(n.length===1){var i=n[0];if(i===r||e&&I(i)||C(r)&&C(i))return i}var o=new st(n);return e?o=o.toKeyedSeq():C(r)||(o=o.toSetSeq()),o=o.flatten(!0),o.size=n.reduce(function(s,u){if(s!==void 0){var a=u.size;if(a!==void 0)return s+a}},0),o}function be(r,t,e){var n=X(r);return n.__iterateUncached=function(i,o){if(o)return this.cacheResult().__iterate(i,o);var s=0,u=!1;function a(f,h){f.__iterate(function(c,p){return(!t||h<t)&&T(c)?a(c,h+1):(s++,i(c,e?p:s-1,n)===!1&&(u=!0)),!u},o)}return a(r,0),s},n.__iteratorUncached=function(i,o){if(o)return this.cacheResult().__iterator(i,o);var s=r.__iterator(i,o),u=[],a=0;return new l(function(){for(;s;){var f=s.next();if(f.done!==!1){s=u.pop();continue}var h=f.value;if(i===P&&(h=h[1]),(!t||u.length<t)&&T(h))u.push(s),s=h.__iterator(i,o);else return e?f:O(i,a++,h,f)}return j()})},n}function Wn(r,t,e){var n=Ae(r);return r.toSeq().map(function(i,o){return n(t.call(e,i,o,r))}).flatten(!0)}function Kn(r,t){var e=X(r);return e.size=r.size&&r.size*2-1,e.__iterateUncached=function(n,i){var o=this,s=0;return r.__iterate(function(u){return(!s||n(t,s++,o)!==!1)&&n(u,s++,o)!==!1},i),s},e.__iteratorUncached=function(n,i){var o=r.__iterator(F,i),s=0,u;return new l(function(){return(!u||s%2)&&(u=o.next(),u.done)?u:s%2?O(n,s++,t):O(n,s++,u.value,u)})},e}function vt(r,t,e){t||(t=Re);var n=I(r),i=0,o=r.toSeq().map(function(s,u){return[u,s,i++,e?e(s,u,r):s]}).valueSeq().toArray();return o.sort(function(s,u){return t(s[3],u[3])||s[2]-u[2]}).forEach(n?function(s,u){o[u].length=2}:function(s,u){o[u]=s[1]}),n?tt(o):C(r)?J(o):dt(o)}function Qt(r,t,e){if(t||(t=Re),e){var n=r.toSeq().map(function(i,o){return[i,e(i,o,r)]}).reduce(function(i,o){return Me(t,i[1],o[1])?o:i});return n&&n[0]}return r.reduce(function(i,o){return Me(t,i,o)?o:i})}function Me(r,t,e){var n=r(e,t);return n===0&&e!==t&&(e==null||e!==e)||n>0}function Vt(r,t,e,n){var i=X(r),o=new st(e).map(function(s){return s.size});return i.size=n?o.max():o.min(),i.__iterate=function(s,u){for(var a=this.__iterator(F,u),f,h=0;!(f=a.next()).done&&s(f.value,h++,this)!==!1;);return h},i.__iteratorUncached=function(s,u){var a=e.map(function(c){return c=z(c),pr(u?c.reverse():c)}),f=0,h=!1;return new l(function(){var c;return h||(c=a.map(function(p){return p.next()}),h=n?c.every(function(p){return p.done}):c.some(function(p){return p.done})),h?j():O(s,f++,t.apply(null,c.map(function(p){return p.value})))})},i}function g(r,t){return r===t?r:hr(r)?t:r.constructor(t)}function qe(r){if(r!==Object(r))throw new TypeError("Expected [K, V] tuple: "+r)}function Ae(r){return I(r)?k:C(r)?ot:ct}function X(r){return Object.create((I(r)?tt:C(r)?J:dt).prototype)}function br(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):L.prototype.cacheResult.call(this)}function Re(r,t){return r===void 0&&t===void 0?0:r===void 0?1:t===void 0?-1:r>t?1:r<t?-1:0}function Z(r,t){t=t||0;for(var e=Math.max(0,r.length-t),n=new Array(e),i=0;i<e;i++)n[i]=r[i+t];return n}function Mr(r,t){if(!r)throw new Error(t)}function W(r){Mr(r!==1/0,"Cannot perform this action with an infinite size.")}function Te(r){if(ae(r)&&typeof r!="string")return r;if(K(r))return r.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+r)}var Fn=Object.prototype.toString;function Jn(r){if(!r||typeof r!="object"||Fn.call(r)!=="[object Object]")return!1;var t=Object.getPrototypeOf(r);if(t===null)return!0;for(var e=t,n=Object.getPrototypeOf(t);n!==null;)e=n,n=Object.getPrototypeOf(e);return e===t}function rt(r){return typeof r=="object"&&(x(r)||Array.isArray(r)||Jn(r))}function Tt(r){try{return typeof r=="string"?JSON.stringify(r):String(r)}catch(t){return JSON.stringify(r)}}function Yn(r,t){return x(r)?r.has(t):rt(r)&&_t.call(r,t)}function Ce(r,t,e){return x(r)?r.get(t,e):Yn(r,t)?typeof r.get=="function"?r.get(t):r[t]:e}function tr(r){if(Array.isArray(r))return Z(r);var t={};for(var e in r)_t.call(r,e)&&(t[e]=r[e]);return t}function Hn(r,t){if(!rt(r))throw new TypeError("Cannot update non-data-structure value: "+r);if(x(r)){if(!r.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+r);return r.remove(t)}if(!_t.call(r,t))return r;var e=tr(r);return Array.isArray(e)?e.splice(t,1):delete e[t],e}function xn(r,t,e){if(!rt(r))throw new TypeError("Cannot update non-data-structure value: "+r);if(x(r)){if(!r.set)throw new TypeError("Cannot update immutable value without .set() method: "+r);return r.set(t,e)}if(_t.call(r,t)&&e===r[t])return r;var n=tr(r);return n[t]=e,n}function yt(r,t,e,n){n||(n=e,e=void 0);var i=je(x(r),r,Te(t),0,e,n);return i===y?e:i}function je(r,t,e,n,i,o){var s=t===y;if(n===e.length){var u=s?i:t,a=o(u);return a===u?t:a}if(!s&&!rt(t))throw new TypeError("Cannot update within non-data-structure value in path ["+e.slice(0,n).map(Tt)+"]: "+t);var f=e[n],h=s?y:Ce(t,f,y),c=je(h===y?r:x(h),h,e,n+1,i,o);return c===h?t:c===y?Hn(t,f):xn(s?r?Y():{}:t,f,c)}function Xn(r,t,e){return yt(r,t,y,function(){return e})}function qr(r,t){return Xn(this,r,t)}function Zn(r,t){return yt(r,t,function(){return y})}function Ar(r){return Zn(this,r)}function Ne(r,t,e,n){return yt(r,[t],e,n)}function Rr(r,t,e){return arguments.length===1?r(this):Ne(this,r,t,e)}function Tr(r,t,e){return yt(this,r,t,e)}function Le(){for(var r=[],t=arguments.length;t--;)r[t]=arguments[t];return Ue(this,r)}function $e(r){for(var t=[],e=arguments.length-1;e-- >0;)t[e]=arguments[e+1];if(typeof r!="function")throw new TypeError("Invalid merger function: "+r);return Ue(this,t,r)}function Ue(r,t,e){for(var n=[],i=0;i<t.length;i++){var o=k(t[i]);o.size!==0&&n.push(o)}return n.length===0?r:r.toSeq().size===0&&!r.__ownerID&&n.length===1?r.constructor(n[0]):r.withMutations(function(s){for(var u=e?function(f,h){Ne(s,h,y,function(c){return c===y?f:e(c,f,h)})}:function(f,h){s.set(h,f)},a=0;a<n.length;a++)n[a].forEach(u)})}function Cr(r,t,e){return jr(r,t,Gn(e))}function jr(r,t,e){if(!rt(r))throw new TypeError("Cannot merge into non-data-structure value: "+r);if(x(r))return typeof e=="function"&&r.mergeWith?r.mergeWith.apply(r,[e].concat(t)):r.merge?r.merge.apply(r,t):r.concat.apply(r,t);for(var n=Array.isArray(r),i=r,o=n?ot:k,s=n?function(a){i===r&&(i=tr(i)),i.push(a)}:function(a,f){var h=_t.call(i,f),c=h&&e?e(i[f],a,f):a;(!h||c!==i[f])&&(i===r&&(i=tr(i)),i[f]=c)},u=0;u<t.length;u++)o(t[u]).forEach(s);return i}function Gn(r){function t(e,n,i){return rt(e)&&rt(n)&&Qn(e,n)?jr(e,[n],t):r?r(e,n,i):n}return t}function Qn(r,t){var e=L(r),n=L(t);return C(e)===C(n)&&I(e)===I(n)}function De(){for(var r=[],t=arguments.length;t--;)r[t]=arguments[t];return Cr(this,r)}function Be(r){for(var t=[],e=arguments.length-1;e-- >0;)t[e]=arguments[e+1];return Cr(this,t,r)}function Nr(r){for(var t=[],e=arguments.length-1;e-- >0;)t[e]=arguments[e+1];return yt(this,r,Y(),function(n){return jr(n,t)})}function Lr(r){for(var t=[],e=arguments.length-1;e-- >0;)t[e]=arguments[e+1];return yt(this,r,Y(),function(n){return Cr(n,t)})}function Ct(r){var t=this.asMutable();return r(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this}function jt(){return this.__ownerID?this:this.__ensureOwner(new fr)}function Nt(){return this.__ensureOwner()}function $r(){return this.__altered}var lt=function(r){function t(e){return e==null?Y():lr(e)&&!K(e)?e:Y().withMutations(function(n){var i=r(e);W(i.size),i.forEach(function(o,s){return n.set(s,o)})})}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return Y().withMutations(function(o){for(var s=0;s<n.length;s+=2){if(s+1>=n.length)throw new Error("Missing value for key: "+n[s]);o.set(n[s],n[s+1])}})},t.prototype.toString=function(){return this.__toString("Map {","}")},t.prototype.get=function(n,i){return this._root?this._root.get(0,void 0,n,i):i},t.prototype.set=function(n,i){return We(this,n,i)},t.prototype.remove=function(n){return We(this,n,y)},t.prototype.deleteAll=function(n){var i=z(n);return i.size===0?this:this.withMutations(function(o){i.forEach(function(s){return o.remove(s)})})},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Y()},t.prototype.sort=function(n){return Q(vt(this,n))},t.prototype.sortBy=function(n,i){return Q(vt(this,i,n))},t.prototype.map=function(n,i){var o=this;return this.withMutations(function(s){s.forEach(function(u,a){s.set(a,n.call(i,u,a,o))})})},t.prototype.__iterator=function(n,i){return new Vn(this,n,i)},t.prototype.__iterate=function(n,i){var o=this,s=0;return this._root&&this._root.iterate(function(u){return s++,n(u[1],u[0],o)},i),s},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Dr(this.size,this._root,n,this.__hash):this.size===0?Y():(this.__ownerID=n,this.__altered=!1,this)},t}(k);lt.isMap=lr;var w=lt.prototype;w[ce]=!0;w[bt]=w.remove;w.removeAll=w.deleteAll;w.setIn=qr;w.removeIn=w.deleteIn=Ar;w.update=Rr;w.updateIn=Tr;w.merge=w.concat=Le;w.mergeWith=$e;w.mergeDeep=De;w.mergeDeepWith=Be;w.mergeIn=Nr;w.mergeDeepIn=Lr;w.withMutations=Ct;w.wasAltered=$r;w.asImmutable=Nt;w["@@transducer/init"]=w.asMutable=jt;w["@@transducer/step"]=function(r,t){return r.set(t[0],t[1])};w["@@transducer/result"]=function(r){return r.asImmutable()};var Lt=function(t,e){this.ownerID=t,this.entries=e};Lt.prototype.get=function(t,e,n,i){for(var o=this.entries,s=0,u=o.length;s<u;s++)if($(n,o[s][0]))return o[s][1];return i};Lt.prototype.update=function(t,e,n,i,o,s,u){for(var a=o===y,f=this.entries,h=0,c=f.length;h<c&&!$(i,f[h][0]);h++);var p=h<c;if(p?f[h][1]===o:a)return this;if(B(u),(a||!p)&&B(s),!(a&&f.length===1)){if(!p&&!a&&f.length>=oi)return ti(t,f,i,o);var d=t&&t===this.ownerID,_=d?f:Z(f);return p?a?h===c-1?_.pop():_[h]=_.pop():_[h]=[i,o]:_.push([i,o]),d?(this.entries=_,this):new Lt(t,_)}};var gt=function(t,e,n){this.ownerID=t,this.bitmap=e,this.nodes=n};gt.prototype.get=function(t,e,n,i){e===void 0&&(e=U(n));var o=1<<((t===0?e:e>>>t)&A),s=this.bitmap;return(s&o)===0?i:this.nodes[Fe(s&o-1)].get(t+m,e,n,i)};gt.prototype.update=function(t,e,n,i,o,s,u){n===void 0&&(n=U(i));var a=(e===0?n:n>>>e)&A,f=1<<a,h=this.bitmap,c=(h&f)!==0;if(!c&&o===y)return this;var p=Fe(h&f-1),d=this.nodes,_=c?d[p]:void 0,v=Br(_,t,e+m,n,i,o,s,u);if(v===_)return this;if(!c&&v&&d.length>=si)return ei(t,d,h,a,v);if(c&&!v&&d.length===2&&Ke(d[p^1]))return d[p^1];if(c&&v&&d.length===1&&Ke(v))return v;var N=t&&t===this.ownerID,H=c?v?h:h^f:h|f,it=c?v?Je(d,p,v,N):ii(d,p,N):ni(d,p,v,N);return N?(this.bitmap=H,this.nodes=it,this):new gt(t,H,it)};var $t=function(t,e,n){this.ownerID=t,this.count=e,this.nodes=n};$t.prototype.get=function(t,e,n,i){e===void 0&&(e=U(n));var o=(t===0?e:e>>>t)&A,s=this.nodes[o];return s?s.get(t+m,e,n,i):i};$t.prototype.update=function(t,e,n,i,o,s,u){n===void 0&&(n=U(i));var a=(e===0?n:n>>>e)&A,f=o===y,h=this.nodes,c=h[a];if(f&&!c)return this;var p=Br(c,t,e+m,n,i,o,s,u);if(p===c)return this;var d=this.count;if(!c)d++;else if(!p&&(d--,d<ui))return ri(t,h,d,a);var _=t&&t===this.ownerID,v=Je(h,a,p,_);return _?(this.count=d,this.nodes=v,this):new $t(t,d,v)};var St=function(t,e,n){this.ownerID=t,this.keyHash=e,this.entries=n};St.prototype.get=function(t,e,n,i){for(var o=this.entries,s=0,u=o.length;s<u;s++)if($(n,o[s][0]))return o[s][1];return i};St.prototype.update=function(t,e,n,i,o,s,u){n===void 0&&(n=U(i));var a=o===y;if(n!==this.keyHash)return a?this:(B(u),B(s),kr(this,t,e,n,[i,o]));for(var f=this.entries,h=0,c=f.length;h<c&&!$(i,f[h][0]);h++);var p=h<c;if(p?f[h][1]===o:a)return this;if(B(u),(a||!p)&&B(s),a&&c===2)return new G(t,this.keyHash,f[h^1]);var d=t&&t===this.ownerID,_=d?f:Z(f);return p?a?h===c-1?_.pop():_[h]=_.pop():_[h]=[i,o]:_.push([i,o]),d?(this.entries=_,this):new St(t,this.keyHash,_)};var G=function(t,e,n){this.ownerID=t,this.keyHash=e,this.entry=n};G.prototype.get=function(t,e,n,i){return $(n,this.entry[0])?this.entry[1]:i};G.prototype.update=function(t,e,n,i,o,s,u){var a=o===y,f=$(i,this.entry[0]);if(f?o===this.entry[1]:a)return this;if(B(u),a){B(s);return}return f?t&&t===this.ownerID?(this.entry[1]=o,this):new G(t,this.keyHash,[i,o]):(B(s),kr(this,t,e,U(i),[i,o]))};Lt.prototype.iterate=St.prototype.iterate=function(r,t){for(var e=this.entries,n=0,i=e.length-1;n<=i;n++)if(r(e[t?i-n:n])===!1)return!1};gt.prototype.iterate=$t.prototype.iterate=function(r,t){for(var e=this.nodes,n=0,i=e.length-1;n<=i;n++){var o=e[t?i-n:n];if(o&&o.iterate(r,t)===!1)return!1}};G.prototype.iterate=function(r,t){return r(this.entry)};var Vn=function(r){function t(e,n,i){this._type=n,this._reverse=i,this._stack=e._root&&ke(e._root)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.next=function(){for(var n=this._type,i=this._stack;i;){var o=i.node,s=i.index++,u=void 0;if(o.entry){if(s===0)return Ur(n,o.entry)}else if(o.entries){if(u=o.entries.length-1,s<=u)return Ur(n,o.entries[this._reverse?u-s:s])}else if(u=o.nodes.length-1,s<=u){var a=o.nodes[this._reverse?u-s:s];if(a){if(a.entry)return Ur(n,a.entry);i=this._stack=ke(a,i)}continue}i=this._stack=this._stack.__prev}return j()},t}(l);function Ur(r,t){return O(r,t[0],t[1])}function ke(r,t){return{node:r,index:0,__prev:t}}function Dr(r,t,e,n){var i=Object.create(w);return i.size=r,i._root=t,i.__ownerID=e,i.__hash=n,i.__altered=!1,i}var Pe;function Y(){return Pe||(Pe=Dr(0))}function We(r,t,e){var n,i;if(r._root){var o=ar(),s=ar();if(n=Br(r._root,r.__ownerID,0,void 0,t,e,o,s),!s.value)return r;i=r.size+(o.value?e===y?-1:1:0)}else{if(e===y)return r;i=1,n=new Lt(r.__ownerID,[[t,e]])}return r.__ownerID?(r.size=i,r._root=n,r.__hash=void 0,r.__altered=!0,r):n?Dr(i,n):Y()}function Br(r,t,e,n,i,o,s,u){return r?r.update(t,e,n,i,o,s,u):o===y?r:(B(u),B(s),new G(t,n,[i,o]))}function Ke(r){return r.constructor===G||r.constructor===St}function kr(r,t,e,n,i){if(r.keyHash===n)return new St(t,n,[r.entry,i]);var o=(e===0?r.keyHash:r.keyHash>>>e)&A,s=(e===0?n:n>>>e)&A,u,a=o===s?[kr(r,t,e+m,n,i)]:(u=new G(t,n,i),o<s?[r,u]:[u,r]);return new gt(t,1<<o|1<<s,a)}function ti(r,t,e,n){r||(r=new fr);for(var i=new G(r,U(e),[e,n]),o=0;o<t.length;o++){var s=t[o];i=i.update(r,0,void 0,s[0],s[1])}return i}function ri(r,t,e,n){for(var i=0,o=0,s=new Array(e),u=0,a=1,f=t.length;u<f;u++,a<<=1){var h=t[u];h!==void 0&&u!==n&&(i|=a,s[o++]=h)}return new gt(r,i,s)}function ei(r,t,e,n,i){for(var o=0,s=new Array(D),u=0;e!==0;u++,e>>>=1)s[u]=e&1?t[o++]:void 0;return s[n]=i,new $t(r,o+1,s)}function Fe(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),r=r+(r>>4)&252645135,r+=r>>8,r+=r>>16,r&127}function Je(r,t,e,n){var i=n?r:Z(r);return i[t]=e,i}function ni(r,t,e,n){var i=r.length+1;if(n&&t+1===i)return r[t]=e,r;for(var o=new Array(i),s=0,u=0;u<i;u++)u===t?(o[u]=e,s=-1):o[u]=r[u+s];return o}function ii(r,t,e){var n=r.length-1;if(e&&t===n)return r.pop(),r;for(var i=new Array(n),o=0,s=0;s<n;s++)s===t&&(o=1),i[s]=r[s+o];return i}var oi=D/4,si=D/2,ui=D/4,Ye="@@__IMMUTABLE_LIST__@@";function He(r){return Boolean(r&&r[Ye])}var rr=function(r){function t(e){var n=er();if(e==null)return n;if(He(e))return e;var i=r(e),o=i.size;return o===0?n:(W(o),o>0&&o<D?Dt(0,o,m,null,new et(i.toArray())):n.withMutations(function(s){s.setSize(o),i.forEach(function(u,a){return s.set(a,u)})}))}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("List [","]")},t.prototype.get=function(n,i){if(n=V(this,n),n>=0&&n<this.size){n+=this._origin;var o=Ze(this,n);return o&&o.array[n&A]}return i},t.prototype.set=function(n,i){return ai(this,n,i)},t.prototype.remove=function(n){return this.has(n)?n===0?this.shift():n===this.size-1?this.pop():this.splice(n,1):this},t.prototype.insert=function(n,i){return this.splice(n,0,i)},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=m,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):er()},t.prototype.push=function(){var n=arguments,i=this.size;return this.withMutations(function(o){nt(o,0,i+n.length);for(var s=0;s<n.length;s++)o.set(i+s,n[s])})},t.prototype.pop=function(){return nt(this,0,-1)},t.prototype.unshift=function(){var n=arguments;return this.withMutations(function(i){nt(i,-n.length);for(var o=0;o<n.length;o++)i.set(o,n[o])})},t.prototype.shift=function(){return nt(this,1)},t.prototype.concat=function(){for(var n=arguments,i=[],o=0;o<arguments.length;o++){var s=n[o],u=r(typeof s!="string"&&se(s)?s:[s]);u.size!==0&&i.push(u)}return i.length===0?this:this.size===0&&!this.__ownerID&&i.length===1?this.constructor(i[0]):this.withMutations(function(a){i.forEach(function(f){return f.forEach(function(h){return a.push(h)})})})},t.prototype.setSize=function(n){return nt(this,0,n)},t.prototype.map=function(n,i){var o=this;return this.withMutations(function(s){for(var u=0;u<o.size;u++)s.set(u,n.call(i,s.get(u),u,o))})},t.prototype.slice=function(n,i){var o=this.size;return Jt(n,i,o)?this:nt(this,Mt(n,o),Yt(i,o))},t.prototype.__iterator=function(n,i){var o=i?this.size:0,s=xe(this,i);return new l(function(){var u=s();return u===Ut?j():O(n,i?--o:o++,u)})},t.prototype.__iterate=function(n,i){for(var o=i?this.size:0,s=xe(this,i),u;(u=s())!==Ut&&n(u,i?--o:o++,this)!==!1;);return o},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Dt(this._origin,this._capacity,this._level,this._root,this._tail,n,this.__hash):this.size===0?er():(this.__ownerID=n,this.__altered=!1,this)},t}(ot);rr.isList=He;var b=rr.prototype;b[Ye]=!0;b[bt]=b.remove;b.merge=b.concat;b.setIn=qr;b.deleteIn=b.removeIn=Ar;b.update=Rr;b.updateIn=Tr;b.mergeIn=Nr;b.mergeDeepIn=Lr;b.withMutations=Ct;b.wasAltered=$r;b.asImmutable=Nt;b["@@transducer/init"]=b.asMutable=jt;b["@@transducer/step"]=function(r,t){return r.push(t)};b["@@transducer/result"]=function(r){return r.asImmutable()};var et=function(t,e){this.array=t,this.ownerID=e};et.prototype.removeBefore=function(t,e,n){if(n===e?1<<e:this.array.length===0)return this;var i=n>>>e&A;if(i>=this.array.length)return new et([],t);var o=i===0,s;if(e>0){var u=this.array[i];if(s=u&&u.removeBefore(t,e-m,n),s===u&&o)return this}if(o&&!s)return this;var a=mt(this,t);if(!o)for(var f=0;f<i;f++)a.array[f]=void 0;return s&&(a.array[i]=s),a};et.prototype.removeAfter=function(t,e,n){if(n===(e?1<<e:0)||this.array.length===0)return this;var i=n-1>>>e&A;if(i>=this.array.length)return this;var o;if(e>0){var s=this.array[i];if(o=s&&s.removeAfter(t,e-m,n),o===s&&i===this.array.length-1)return this}var u=mt(this,t);return u.array.splice(i+1),o&&(u.array[i]=o),u};var Ut={};function xe(r,t){var e=r._origin,n=r._capacity,i=Bt(n),o=r._tail;return s(r._root,r._level,0);function s(f,h,c){return h===0?u(f,c):a(f,h,c)}function u(f,h){var c=h===i?o&&o.array:f&&f.array,p=h>e?0:e-h,d=n-h;return d>D&&(d=D),function(){if(p===d)return Ut;var _=t?--d:p++;return c&&c[_]}}function a(f,h,c){var p,d=f&&f.array,_=c>e?0:e-c>>h,v=(n-c>>h)+1;return v>D&&(v=D),function(){for(;;){if(p){var N=p();if(N!==Ut)return N;p=null}if(_===v)return Ut;var H=t?--v:_++;p=s(d&&d[H],h-m,c+(H<<h))}}}}function Dt(r,t,e,n,i,o,s){var u=Object.create(b);return u.size=t-r,u._origin=r,u._capacity=t,u._level=e,u._root=n,u._tail=i,u.__ownerID=o,u.__hash=s,u.__altered=!1,u}var Xe;function er(){return Xe||(Xe=Dt(0,0,m))}function ai(r,t,e){if(t=V(r,t),t!==t)return r;if(t>=r.size||t<0)return r.withMutations(function(s){t<0?nt(s,t).set(0,e):nt(s,0,t+1).set(t,e)});t+=r._origin;var n=r._tail,i=r._root,o=ar();return t>=Bt(r._capacity)?n=Pr(n,r.__ownerID,0,t,e,o):i=Pr(i,r.__ownerID,r._level,t,e,o),o.value?r.__ownerID?(r._root=i,r._tail=n,r.__hash=void 0,r.__altered=!0,r):Dt(r._origin,r._capacity,r._level,i,n):r}function Pr(r,t,e,n,i,o){var s=n>>>e&A,u=r&&s<r.array.length;if(!u&&i===void 0)return r;var a;if(e>0){var f=r&&r.array[s],h=Pr(f,t,e-m,n,i,o);return h===f?r:(a=mt(r,t),a.array[s]=h,a)}return u&&r.array[s]===i?r:(o&&B(o),a=mt(r,t),i===void 0&&s===a.array.length-1?a.array.pop():a.array[s]=i,a)}function mt(r,t){return t&&r&&t===r.ownerID?r:new et(r?r.array.slice():[],t)}function Ze(r,t){if(t>=Bt(r._capacity))return r._tail;if(t<1<<r._level+m){for(var e=r._root,n=r._level;e&&n>0;)e=e.array[t>>>n&A],n-=m;return e}}function nt(r,t,e){t!==void 0&&(t|=0),e!==void 0&&(e|=0);var n=r.__ownerID||new fr,i=r._origin,o=r._capacity,s=i+t,u=e===void 0?o:e<0?o+e:i+e;if(s===i&&u===o)return r;if(s>=u)return r.clear();for(var a=r._level,f=r._root,h=0;s+h<0;)f=new et(f&&f.array.length?[void 0,f]:[],n),a+=m,h+=1<<a;h&&(s+=h,i+=h,u+=h,o+=h);for(var c=Bt(o),p=Bt(u);p>=1<<a+m;)f=new et(f&&f.array.length?[f]:[],n),a+=m;var d=r._tail,_=p<c?Ze(r,u-1):p>c?new et([],n):d;if(d&&p>c&&s<o&&d.array.length){f=mt(f,n);for(var v=f,N=a;N>m;N-=m){var H=c>>>N&A;v=v.array[H]=mt(v.array[H],n)}v.array[c>>>m&A]=d}if(u<o&&(_=_&&_.removeAfter(n,0,u)),s>=p)s-=p,u-=p,a=m,f=null,_=_&&_.removeBefore(n,0,s);else if(s>i||p<c){for(h=0;f;){var it=s>>>a&A;if(it!==p>>>a&A)break;it&&(h+=(1<<a)*it),a-=m,f=f.array[it]}f&&s>i&&(f=f.removeBefore(n,a,s-h)),f&&p<c&&(f=f.removeAfter(n,a,p-h)),h&&(s-=h,u-=h)}return r.__ownerID?(r.size=u-s,r._origin=s,r._capacity=u,r._level=a,r._root=f,r._tail=_,r.__hash=void 0,r.__altered=!0,r):Dt(s,u,a,f,_)}function Bt(r){return r<D?0:r-1>>>m<<m}var Q=function(r){function t(e){return e==null?kt():pe(e)?e:kt().withMutations(function(n){var i=k(e);W(i.size),i.forEach(function(o,s){return n.set(s,o)})})}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("OrderedMap {","}")},t.prototype.get=function(n,i){var o=this._map.get(n);return o!==void 0?this._list.get(o)[1]:i},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):kt()},t.prototype.set=function(n,i){return Qe(this,n,i)},t.prototype.remove=function(n){return Qe(this,n,y)},t.prototype.__iterate=function(n,i){var o=this;return this._list.__iterate(function(s){return s&&n(s[1],s[0],o)},i)},t.prototype.__iterator=function(n,i){return this._list.fromEntrySeq().__iterator(n,i)},t.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n),o=this._list.__ensureOwner(n);return n?Wr(i,o,n,this.__hash):this.size===0?kt():(this.__ownerID=n,this.__altered=!1,this._map=i,this._list=o,this)},t}(lt);Q.isOrderedMap=pe;Q.prototype[pt]=!0;Q.prototype[bt]=Q.prototype.remove;function Wr(r,t,e,n){var i=Object.create(Q.prototype);return i.size=r?r.size:0,i._map=r,i._list=t,i.__ownerID=e,i.__hash=n,i.__altered=!1,i}var Ge;function kt(){return Ge||(Ge=Wr(Y(),er()))}function Qe(r,t,e){var n=r._map,i=r._list,o=n.get(t),s=o!==void 0,u,a;if(e===y){if(!s)return r;i.size>=D&&i.size>=n.size*2?(a=i.filter(function(f,h){return f!==void 0&&o!==h}),u=a.toKeyedSeq().map(function(f){return f[0]}).flip().toMap(),r.__ownerID&&(u.__ownerID=a.__ownerID=r.__ownerID)):(u=n.remove(t),a=o===i.size-1?i.pop():i.set(o,void 0))}else if(s){if(e===i.get(o)[1])return r;u=n,a=i.set(o,[t,e])}else u=n.set(t,i.size),a=i.set(i.size,[t,e]);return r.__ownerID?(r.size=u.size,r._map=u,r._list=a,r.__hash=void 0,r.__altered=!0,r):Wr(u,a)}var Ve="@@__IMMUTABLE_STACK__@@";function Kr(r){return Boolean(r&&r[Ve])}var Fr=function(r){function t(e){return e==null?nr():Kr(e)?e:nr().pushAll(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("Stack [","]")},t.prototype.get=function(n,i){var o=this._head;for(n=V(this,n);o&&n--;)o=o.next;return o?o.value:i},t.prototype.peek=function(){return this._head&&this._head.value},t.prototype.push=function(){var n=arguments;if(arguments.length===0)return this;for(var i=this.size+arguments.length,o=this._head,s=arguments.length-1;s>=0;s--)o={value:n[s],next:o};return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):Pt(i,o)},t.prototype.pushAll=function(n){if(n=r(n),n.size===0)return this;if(this.size===0&&Kr(n))return n;W(n.size);var i=this.size,o=this._head;return n.__iterate(function(s){i++,o={value:s,next:o}},!0),this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):Pt(i,o)},t.prototype.pop=function(){return this.slice(1)},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):nr()},t.prototype.slice=function(n,i){if(Jt(n,i,this.size))return this;var o=Mt(n,this.size),s=Yt(i,this.size);if(s!==this.size)return r.prototype.slice.call(this,n,i);for(var u=this.size-o,a=this._head;o--;)a=a.next;return this.__ownerID?(this.size=u,this._head=a,this.__hash=void 0,this.__altered=!0,this):Pt(u,a)},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Pt(this.size,this._head,n,this.__hash):this.size===0?nr():(this.__ownerID=n,this.__altered=!1,this)},t.prototype.__iterate=function(n,i){var o=this;if(i)return new st(this.toArray()).__iterate(function(a,f){return n(a,f,o)},i);for(var s=0,u=this._head;u&&n(u.value,s++,this)!==!1;)u=u.next;return s},t.prototype.__iterator=function(n,i){if(i)return new st(this.toArray()).__iterator(n,i);var o=0,s=this._head;return new l(function(){if(s){var u=s.value;return s=s.next,O(n,o++,u)}return j()})},t}(ot);Fr.isStack=Kr;var R=Fr.prototype;R[Ve]=!0;R.shift=R.pop;R.unshift=R.push;R.unshiftAll=R.pushAll;R.withMutations=Ct;R.wasAltered=$r;R.asImmutable=Nt;R["@@transducer/init"]=R.asMutable=jt;R["@@transducer/step"]=function(r,t){return r.unshift(t)};R["@@transducer/result"]=function(r){return r.asImmutable()};function Pt(r,t,e,n){var i=Object.create(R);return i.size=r,i._head=t,i.__ownerID=e,i.__hash=n,i.__altered=!1,i}var tn;function nr(){return tn||(tn=Pt(0))}var rn="@@__IMMUTABLE_SET__@@";function Jr(r){return Boolean(r&&r[rn])}function en(r){return Jr(r)&&K(r)}function nn(r,t){if(r===t)return!0;if(!T(t)||r.size!==void 0&&t.size!==void 0&&r.size!==t.size||r.__hash!==void 0&&t.__hash!==void 0&&r.__hash!==t.__hash||I(r)!==I(t)||C(r)!==C(t)||K(r)!==K(t))return!1;if(r.size===0&&t.size===0)return!0;var e=!Ht(r);if(K(r)){var n=r.entries();return t.every(function(a,f){var h=n.next().value;return h&&$(h[1],a)&&(e||$(h[0],f))})&&n.next().done}var i=!1;if(r.size===void 0)if(t.size===void 0)typeof r.cacheResult=="function"&&r.cacheResult();else{i=!0;var o=r;r=t,t=o}var s=!0,u=t.__iterate(function(a,f){if(e?!r.has(a):i?!$(a,r.get(f,y)):!$(r.get(f,y),a))return s=!1,!1});return s&&r.size===u}function at(r,t){var e=function(n){r.prototype[n]=t[n]};return Object.keys(t).forEach(e),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(e),r}function ir(r){if(!r||typeof r!="object")return r;if(!T(r)){if(!rt(r))return r;r=L(r)}if(I(r)){var t={};return r.__iterate(function(n,i){t[i]=ir(n)}),t}var e=[];return r.__iterate(function(n){e.push(ir(n))}),e}var or=function(r){function t(e){return e==null?Wt():Jr(e)&&!K(e)?e:Wt().withMutations(function(n){var i=r(e);W(i.size),i.forEach(function(o){return n.add(o)})})}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(n){return this(k(n).keySeq())},t.intersect=function(n){return n=z(n).toArray(),n.length?M.intersect.apply(t(n.pop()),n):Wt()},t.union=function(n){return n=z(n).toArray(),n.length?M.union.apply(t(n.pop()),n):Wt()},t.prototype.toString=function(){return this.__toString("Set {","}")},t.prototype.has=function(n){return this._map.has(n)},t.prototype.add=function(n){return sr(this,this._map.set(n,n))},t.prototype.remove=function(n){return sr(this,this._map.remove(n))},t.prototype.clear=function(){return sr(this,this._map.clear())},t.prototype.map=function(n,i){var o=this,s=!1,u=sr(this,this._map.mapEntries(function(a){var f=a[1],h=n.call(i,f,f,o);return h!==f&&(s=!0),[h,h]},i));return s?u:this},t.prototype.union=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return n=n.filter(function(o){return o.size!==0}),n.length===0?this:this.size===0&&!this.__ownerID&&n.length===1?this.constructor(n[0]):this.withMutations(function(o){for(var s=0;s<n.length;s++)r(n[s]).forEach(function(u){return o.add(u)})})},t.prototype.intersect=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(s){return r(s)});var o=[];return this.forEach(function(s){n.every(function(u){return u.includes(s)})||o.push(s)}),this.withMutations(function(s){o.forEach(function(u){s.remove(u)})})},t.prototype.subtract=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(s){return r(s)});var o=[];return this.forEach(function(s){n.some(function(u){return u.includes(s)})&&o.push(s)}),this.withMutations(function(s){o.forEach(function(u){s.remove(u)})})},t.prototype.sort=function(n){return Ft(vt(this,n))},t.prototype.sortBy=function(n,i){return Ft(vt(this,i,n))},t.prototype.wasAltered=function(){return this._map.wasAltered()},t.prototype.__iterate=function(n,i){var o=this;return this._map.__iterate(function(s){return n(s,s,o)},i)},t.prototype.__iterator=function(n,i){return this._map.__iterator(n,i)},t.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n);return n?this.__make(i,n):this.size===0?this.__empty():(this.__ownerID=n,this._map=i,this)},t}(ct);or.isSet=Jr;var M=or.prototype;M[rn]=!0;M[bt]=M.remove;M.merge=M.concat=M.union;M.withMutations=Ct;M.asImmutable=Nt;M["@@transducer/init"]=M.asMutable=jt;M["@@transducer/step"]=function(r,t){return r.add(t)};M["@@transducer/result"]=function(r){return r.asImmutable()};M.__empty=Wt;M.__make=on;function sr(r,t){return r.__ownerID?(r.size=t.size,r._map=t,r):t===r._map?r:t.size===0?r.__empty():r.__make(t)}function on(r,t){var e=Object.create(M);return e.size=r?r.size:0,e._map=r,e.__ownerID=t,e}var sn;function Wt(){return sn||(sn=on(Y()))}var fi=function(r){function t(e,n,i){if(!(this instanceof t))return new t(e,n,i);if(Mr(i!==0,"Cannot step a Range by 0"),e=e||0,n===void 0&&(n=1/0),i=i===void 0?1:Math.abs(i),n<e&&(i=-i),this._start=e,this._end=n,this._step=i,this.size=Math.max(0,Math.ceil((n-e)/i-1)+1),this.size===0){if(Yr)return Yr;Yr=this}}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step!==1?" by "+this._step:"")+" ]"},t.prototype.get=function(n,i){return this.has(n)?this._start+V(this,n)*this._step:i},t.prototype.includes=function(n){var i=(n-this._start)/this._step;return i>=0&&i<this.size&&i===Math.floor(i)},t.prototype.slice=function(n,i){return Jt(n,i,this.size)?this:(n=Mt(n,this.size),i=Yt(i,this.size),i<=n?new t(0,0):new t(this.get(n,this._end),this.get(i,this._end),this._step))},t.prototype.indexOf=function(n){var i=n-this._start;if(i%this._step===0){var o=i/this._step;if(o>=0&&o<this.size)return o}return-1},t.prototype.lastIndexOf=function(n){return this.indexOf(n)},t.prototype.__iterate=function(n,i){for(var o=this.size,s=this._step,u=i?this._start+(o-1)*s:this._start,a=0;a!==o&&n(u,i?o-++a:a++,this)!==!1;)u+=i?-s:s;return a},t.prototype.__iterator=function(n,i){var o=this.size,s=this._step,u=i?this._start+(o-1)*s:this._start,a=0;return new l(function(){if(a===o)return j();var f=u;return u+=i?-s:s,O(n,i?o-++a:a++,f)})},t.prototype.equals=function(n){return n instanceof t?this._start===n._start&&this._end===n._end&&this._step===n._step:nn(this,n)},t}(J),Yr;function un(r,t,e){for(var n=Te(t),i=0;i!==n.length;)if(r=Ce(r,n[i++],y),r===y)return e;return r}function an(r,t){return un(this,r,t)}function hi(r,t){return un(r,t,y)!==y}function ci(r){return hi(this,r)}function fn(){W(this.size);var r={};return this.__iterate(function(t,e){r[e]=t}),r}z.isIterable=T;z.isKeyed=I;z.isIndexed=C;z.isAssociative=Ht;z.isOrdered=K;z.Iterator=l;at(z,{toArray:function(){W(this.size);var t=new Array(this.size||0),e=I(this),n=0;return this.__iterate(function(i,o){t[n++]=e?[o,i]:i}),t},toIndexedSeq:function(){return new Se(this)},toJS:function(){return ir(this)},toKeyedSeq:function(){return new Gt(this,!0)},toMap:function(){return lt(this.toKeyedSeq())},toObject:fn,toOrderedMap:function(){return Q(this.toKeyedSeq())},toOrderedSet:function(){return Ft(I(this)?this.valueSeq():this)},toSet:function(){return or(I(this)?this.valueSeq():this)},toSetSeq:function(){return new me(this)},toSeq:function(){return C(this)?this.toIndexedSeq():I(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Fr(I(this)?this.valueSeq():this)},toList:function(){return rr(I(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(t,e){return this.size===0?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return g(this,Pn(this,t))},includes:function(t){return this.some(function(e){return $(e,t)})},entries:function(){return this.__iterator(P)},every:function(t,e){W(this.size);var n=!0;return this.__iterate(function(i,o,s){if(!t.call(e,i,o,s))return n=!1,!1}),n},filter:function(t,e){return g(this,Ee(this,t,e,!0))},find:function(t,e,n){var i=this.findEntry(t,e);return i?i[1]:n},forEach:function(t,e){return W(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){W(this.size),t=t!==void 0?""+t:",";var e="",n=!0;return this.__iterate(function(i){n?n=!1:e+=t,e+=i!=null?i.toString():""}),e},keys:function(){return this.__iterator(At)},map:function(t,e){return g(this,Ie(this,t,e))},reduce:function(t,e,n){return hn(this,t,e,n,arguments.length<2,!1)},reduceRight:function(t,e,n){return hn(this,t,e,n,arguments.length<2,!0)},reverse:function(){return g(this,Er(this,!0))},slice:function(t,e){return g(this,zr(this,t,e,!0))},some:function(t,e){return!this.every(ur(t),e)},sort:function(t){return g(this,vt(this,t))},values:function(){return this.__iterator(F)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(t,e){return ht(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return Dn(this,t,e)},equals:function(t){return nn(this,t)},entrySeq:function(){var t=this;if(t._cache)return new st(t._cache);var e=t.toSeq().map(_i).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(ur(t),e)},findEntry:function(t,e,n){var i=n;return this.__iterate(function(o,s,u){if(t.call(e,o,s,u))return i=[s,o],!1}),i},findKey:function(t,e){var n=this.findEntry(t,e);return n&&n[0]},findLast:function(t,e,n){return this.toKeyedSeq().reverse().find(t,e,n)},findLastEntry:function(t,e,n){return this.toKeyedSeq().reverse().findEntry(t,e,n)},findLastKey:function(t,e){return this.toKeyedSeq().reverse().findKey(t,e)},first:function(t){return this.find(Gr,null,t)},flatMap:function(t,e){return g(this,Wn(this,t,e))},flatten:function(t){return g(this,be(this,t,!0))},fromEntrySeq:function(){return new we(this)},get:function(t,e){return this.find(function(n,i){return $(i,t)},void 0,e)},getIn:an,groupBy:function(t,e){return Bn(this,t,e)},has:function(t){return this.get(t,y)!==y},hasIn:ci,isSubset:function(t){return t=typeof t.includes=="function"?t:z(t),this.every(function(e){return t.includes(e)})},isSuperset:function(t){return t=typeof t.isSubset=="function"?t:z(t),t.isSubset(this)},keyOf:function(t){return this.findKey(function(e){return $(e,t)})},keySeq:function(){return this.toSeq().map(pi).toIndexedSeq()},last:function(t){return this.toSeq().reverse().first(t)},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return Qt(this,t)},maxBy:function(t,e){return Qt(this,e,t)},min:function(t){return Qt(this,t?cn(t):_n)},minBy:function(t,e){return Qt(this,e?cn(e):_n,t)},rest:function(){return this.slice(1)},skip:function(t){return t===0?this:this.slice(Math.max(0,t))},skipLast:function(t){return t===0?this:this.slice(0,-Math.max(0,t))},skipWhile:function(t,e){return g(this,ze(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(ur(t),e)},sortBy:function(t,e){return g(this,vt(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return this.slice(-Math.max(0,t))},takeWhile:function(t,e){return g(this,kn(this,t,e))},takeUntil:function(t,e){return this.takeWhile(ur(t),e)},update:function(t){return t(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=di(this))}});var q=z.prototype;q[te]=!0;q[xt]=q.values;q.toJSON=q.toArray;q.__toStringMapper=Tt;q.inspect=q.toSource=function(){return this.toString()};q.chain=q.flatMap;q.contains=q.includes;at(k,{flip:function(){return g(this,Oe(this))},mapEntries:function(t,e){var n=this,i=0;return g(this,this.toSeq().map(function(o,s){return t.call(e,[s,o],i++,n)}).fromEntrySeq())},mapKeys:function(t,e){var n=this;return g(this,this.toSeq().flip().map(function(i,o){return t.call(e,i,o,n)}).flip())}});var Kt=k.prototype;Kt[re]=!0;Kt[xt]=q.entries;Kt.toJSON=fn;Kt.__toStringMapper=function(r,t){return Tt(t)+": "+Tt(r)};at(ot,{toKeyedSeq:function(){return new Gt(this,!1)},filter:function(t,e){return g(this,Ee(this,t,e,!1))},findIndex:function(t,e){var n=this.findEntry(t,e);return n?n[0]:-1},indexOf:function(t){var e=this.keyOf(t);return e===void 0?-1:e},lastIndexOf:function(t){var e=this.lastKeyOf(t);return e===void 0?-1:e},reverse:function(){return g(this,Er(this,!1))},slice:function(t,e){return g(this,zr(this,t,e,!1))},splice:function(t,e){var n=arguments.length;if(e=Math.max(e||0,0),n===0||n===2&&!e)return this;t=Mt(t,t<0?this.count():this.size);var i=this.slice(0,t);return g(this,n===1?i:i.concat(Z(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var n=this.findLastEntry(t,e);return n?n[0]:-1},first:function(t){return this.get(0,t)},flatten:function(t){return g(this,be(this,t,!1))},get:function(t,e){return t=V(this,t),t<0||this.size===1/0||this.size!==void 0&&t>this.size?e:this.find(function(n,i){return i===t},void 0,e)},has:function(t){return t=V(this,t),t>=0&&(this.size!==void 0?this.size===1/0||t<this.size:this.indexOf(t)!==-1)},interpose:function(t){return g(this,Kn(this,t))},interleave:function(){var t=[this].concat(Z(arguments)),e=Vt(this.toSeq(),J.of,t),n=e.flatten(!0);return e.size&&(n.size=e.size*t.length),g(this,n)},keySeq:function(){return fi(0,this.size)},last:function(t){return this.get(-1,t)},skipWhile:function(t,e){return g(this,ze(this,t,e,!1))},zip:function(){var t=[this].concat(Z(arguments));return g(this,Vt(this,pn,t))},zipAll:function(){var t=[this].concat(Z(arguments));return g(this,Vt(this,pn,t,!0))},zipWith:function(t){var e=Z(arguments);return e[0]=this,g(this,Vt(this,t,e))}});var wt=ot.prototype;wt[ee]=!0;wt[pt]=!0;at(ct,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}});var Ot=ct.prototype;Ot.has=q.includes;Ot.contains=Ot.includes;Ot.keys=Ot.values;at(tt,Kt);at(J,wt);at(dt,Ot);function hn(r,t,e,n,i,o){return W(r.size),r.__iterate(function(s,u,a){i?(i=!1,e=s):e=t.call(n,e,s,u,a)},o),e}function pi(r,t){return t}function _i(r,t){return[t,r]}function ur(r){return function(){return!r.apply(this,arguments)}}function cn(r){return function(){return-r.apply(this,arguments)}}function pn(){return Z(arguments)}function _n(r,t){return r<t?1:r>t?-1:0}function di(r){if(r.size===1/0)return 0;var t=K(r),e=I(r),n=t?1:0,i=r.__iterate(e?t?function(o,s){n=31*n+dn(U(o),U(s))|0}:function(o,s){n=n+dn(U(o),U(s))|0}:t?function(o){n=31*n+U(o)|0}:function(o){n=n+U(o)|0});return vi(i,n)}function vi(r,t){return t=Rt(t,3432918353),t=Rt(t<<15|t>>>-15,461845907),t=Rt(t<<13|t>>>-13,5),t=(t+3864292196|0)^r,t=Rt(t^t>>>16,2246822507),t=Rt(t^t>>>13,3266489909),t=Zt(t^t>>>16),t}function dn(r,t){return r^t+2654435769+(r<<6)+(r>>2)|0}var Ft=function(r){function t(e){return e==null?Hr():en(e)?e:Hr().withMutations(function(n){var i=ct(e);W(i.size),i.forEach(function(o){return n.add(o)})})}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(n){return this(k(n).keySeq())},t.prototype.toString=function(){return this.__toString("OrderedSet {","}")},t}(or);Ft.isOrderedSet=en;var ft=Ft.prototype;ft[pt]=!0;ft.zip=wt.zip;ft.zipWith=wt.zipWith;ft.zipAll=wt.zipAll;ft.__empty=Hr;ft.__make=vn;function vn(r,t){var e=Object.create(ft);return e.size=r?r.size:0,e._map=r,e.__ownerID=t,e}var yn;function Hr(){return yn||(yn=vn(kt()))}function yi(r){if(qt(r))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(x(r))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(r===null||typeof r!="object")throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}var E=function(t,e){var n;yi(t);var i=function(u){var a=this;if(u instanceof i)return u;if(!(this instanceof i))return new i(u);if(!n){n=!0;var f=Object.keys(t),h=o._indices={};o._name=e,o._keys=f,o._defaultValues=t;for(var c=0;c<f.length;c++){var p=f[c];h[p]=c,o[p]?typeof console=="object"&&console.warn&&console.warn("Cannot define "+Xr(this)+' with property "'+p+'" since that property name is part of the Record API.'):li(o,p)}}return this.__ownerID=void 0,this._values=rr().withMutations(function(d){d.setSize(a._keys.length),k(u).forEach(function(_,v){d.set(a._indices[v],_===a._defaultValues[v]?void 0:_)})}),this},o=i.prototype=Object.create(S);return o.constructor=i,e&&(i.displayName=e),i};E.prototype.toString=function(){for(var t=Xr(this)+" { ",e=this._keys,n,i=0,o=e.length;i!==o;i++)n=e[i],t+=(i?", ":"")+n+": "+Tt(this.get(n));return t+" }"};E.prototype.equals=function(t){return this===t||t&&It(this).equals(It(t))};E.prototype.hashCode=function(){return It(this).hashCode()};E.prototype.has=function(t){return this._indices.hasOwnProperty(t)};E.prototype.get=function(t,e){if(!this.has(t))return e;var n=this._indices[t],i=this._values.get(n);return i===void 0?this._defaultValues[t]:i};E.prototype.set=function(t,e){if(this.has(t)){var n=this._values.set(this._indices[t],e===this._defaultValues[t]?void 0:e);if(n!==this._values&&!this.__ownerID)return xr(this,n)}return this};E.prototype.remove=function(t){return this.set(t)};E.prototype.clear=function(){var t=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:xr(this,t)};E.prototype.wasAltered=function(){return this._values.wasAltered()};E.prototype.toSeq=function(){return It(this)};E.prototype.toJS=function(){return ir(this)};E.prototype.entries=function(){return this.__iterator(P)};E.prototype.__iterator=function(t,e){return It(this).__iterator(t,e)};E.prototype.__iterate=function(t,e){return It(this).__iterate(t,e)};E.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._values.__ensureOwner(t);return t?xr(this,e,t):(this.__ownerID=t,this._values=e,this)};E.isRecord=qt;E.getDescriptiveName=Xr;var S=E.prototype;S[ie]=!0;S[bt]=S.remove;S.deleteIn=S.removeIn=Ar;S.getIn=an;S.hasIn=q.hasIn;S.merge=Le;S.mergeWith=$e;S.mergeIn=Nr;S.mergeDeep=De;S.mergeDeepWith=Be;S.mergeDeepIn=Lr;S.setIn=qr;S.update=Rr;S.updateIn=Tr;S.withMutations=Ct;S.asMutable=jt;S.asImmutable=Nt;S[xt]=S.entries;S.toJSON=S.toObject=q.toObject;S.inspect=S.toSource=function(){return this.toString()};function xr(r,t,e){var n=Object.create(Object.getPrototypeOf(r));return n._values=t,n.__ownerID=e,n}function Xr(r){return r.constructor.displayName||r.constructor.name||"Record"}function It(r){return vr(r._keys.map(function(t){return[t,r.get(t)]}))}function li(r,t){try{Object.defineProperty(r,t,{get:function(){return this.get(t)},set:function(e){Mr(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}catch(e){}}var Sn=Zr(En(),1),mn=Zr(gn(),1);function gi(r,t){return E({...t,room:r,state:E(t.state)()})}var Et={},wn=class{constructor(t,e){zt(this,"session");zt(this,"hashCodeSession");zt(this,"room","");zt(this,"created",new Date().toISOString());let n=null;this.room=t,this.session=gi(t,{...e,state:n||e.state,capabilities:{...e.capabilities,sessionStorage:mi("sessionStorage")}})(),this.hashCodeSession=this.session.get("state").hashCode(),Et[this.session.get("state").hashCode()]=this.session.get("state")}addEvent(t){this.session.get("events").push({...t}),setTimeout(()=>this.processEvents)}hashCode(){return this.session.get("state").hashCode()}processEvents(){let t=this.session.get("events"),e=t.shift();if(e)switch(e.type){case"code-init":let{code:n,transpiled:i,i:o,css:s,errorDiff:u,html:a}=e,f={code:n,transpiled:i,i:o,css:s,errorDiff:u,html:a};this.session.set("events",t),this.session.set("state",E(f)())}}createPatchFromHashCode(t,e){if(Et[t]){let n=Et[t],i=JSON.stringify(n.toJSON()),o=n.merge(e),s=o.hashCode();Et[s]=o;let u=JSON.stringify(o.toJSON()),a=On(i,u);return{oldHash:t,newHash:s,patch:a}}}createPatch(t){if(t.code===this.session.get("state").get("code"))return{oldHash:this.session.get("state").hashCode(),newHash:this.session.get("state").hashCode(),patch:""};let e=JSON.stringify(this.session.get("state").toJSON()),n=this.session.get("state").hashCode();Et[n]=this.session.get("state");let o=this.session.get("state").merge(t),s=o.hashCode();Et[s]=o;let u=JSON.stringify(o.toJSON()),a=On(e,u);return{oldHash:n,newHash:s,patch:a}}applyPatch({oldHash:t,newHash:e,patch:n}){if(this.session.get("state").hashCode()!==t){console.error("Cant update");return}let o=this.session.get("state").toJSON(),s=JSON.stringify(o),u=o.code,a=JSON.parse((0,mn.default)(s,JSON.parse(n))),f=E(a)();console.log({newState:a}),console.log(f.hashCode());let h=this.session.get("state").merge(f),c=h.get("code");if(u===c)return;console.log(h.hashCode()),h.hashCode()===e?this.session=this.session.set("state",h):(console.log("WRONG"),console.log({newState:a}))}json(){let t=this.session.toJSON(),e=t.state.toJSON();return{...t,state:e}}setRoom(t){let e=this.session.set("room",t);this.session=e}},Si=null,bi=(r,t)=>Si||new wn(r,t);function mi(r){try{if(!window.hasOwnProperty(r))return;let t=window[r],e="__storage_test__";return t.setItem(e,e),t.removeItem(e),!0}catch(t){return!1}}function On(r,t){return JSON.stringify((0,Sn.default)(r,t))}export{wn as CodeSession,bi as default};
