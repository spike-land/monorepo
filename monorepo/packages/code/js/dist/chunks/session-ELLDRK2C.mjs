import{a as En}from"./chunk-Z37PDJI3.mjs";import{a as In,b as Zr,c as zt}from"./chunk-XOF3GJEG.mjs";var gn=In((Oi,ln)=>{"use strict";ln.exports=function(r,t){for(var e="",n=0,i=0;i<t.length;i++){var o=t[i],s=o[0],u=o[1];s==-1?n+=u:s==0?e+=r.slice(n,n+=u):e+=u}return e}});var Ut="delete",m=5,D=1<<m,A=D-1,y={};function _r(){return{value:!1}}function B(r){r&&(r.value=!0)}function Or(){}function ht(r){return r.size===void 0&&(r.size=r.__iterate(Oe)),r.size}function rt(r,t){if(typeof t!="number"){var e=t>>>0;if(""+e!==t||e===4294967295)return NaN;t=e}return t<0?ht(r)+t:t}function Oe(){return!0}function Vt(r,t,e){return(r===0&&!Ee(r)||e!==void 0&&r<=-e)&&(t===void 0||e!==void 0&&t>=e)}function Dt(r,t){return Ie(r,t,0)}function tr(r,t){return Ie(r,t,t)}function Ie(r,t,e){return r===void 0?e:Ee(r)?t===1/0?t:Math.max(0,t+r)|0:t===void 0||t===r?r:Math.min(t,r)|0}function Ee(r){return r<0||r===0&&1/r===-1/0}var ze="@@__IMMUTABLE_ITERABLE__@@";function C(r){return Boolean(r&&r[ze])}var be="@@__IMMUTABLE_KEYED__@@";function I(r){return Boolean(r&&r[be])}var Me="@@__IMMUTABLE_INDEXED__@@";function T(r){return Boolean(r&&r[Me])}function rr(r){return I(r)||T(r)}var z=function(t){return C(t)?t:U(t)},W=function(r){function t(e){return I(e)?e:nt(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t}(z),ut=function(r){function t(e){return T(e)?e:Y(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t}(z),lt=function(r){function t(e){return C(e)&&!rr(e)?e:mt(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t}(z);z.Keyed=W;z.Indexed=ut;z.Set=lt;var qe="@@__IMMUTABLE_SEQ__@@";function Ir(r){return Boolean(r&&r[qe])}var Ae="@@__IMMUTABLE_RECORD__@@";function Bt(r){return Boolean(r&&r[Ae])}function X(r){return C(r)||Bt(r)}var gt="@@__IMMUTABLE_ORDERED__@@";function F(r){return Boolean(r&&r[gt])}var kt=0,J=1,P=2,dr=typeof Symbol=="function"&&Symbol.iterator,Re="@@iterator",er=dr||Re,l=function(t){this.next=t};l.prototype.toString=function(){return"[Iterator]"};l.KEYS=kt;l.VALUES=J;l.ENTRIES=P;l.prototype.inspect=l.prototype.toSource=function(){return this.toString()};l.prototype[er]=function(){return this};function O(r,t,e,n){var i=r===0?t:r===1?e:[t,e];return n?n.value=i:n={value:i,done:!1},n}function j(){return{value:void 0,done:!0}}function Te(r){return Array.isArray(r)?!0:!!nr(r)}function Gr(r){return r&&typeof r.next=="function"}function vr(r){var t=nr(r);return t&&t.call(r)}function nr(r){var t=r&&(dr&&r[dr]||r[Re]);if(typeof t=="function")return t}function zn(r){var t=nr(r);return t&&t===r.entries}function bn(r){var t=nr(r);return t&&t===r.keys}var St=Object.prototype.hasOwnProperty;function Ce(r){return Array.isArray(r)||typeof r=="string"?!0:r&&typeof r=="object"&&Number.isInteger(r.length)&&r.length>=0&&(r.length===0?Object.keys(r).length===1:r.hasOwnProperty(r.length-1))}var U=function(r){function t(e){return e==null?zr():X(e)?e.toSeq():qn(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.toSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq {","}")},t.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},t.prototype.__iterate=function(n,i){var o=this._cache;if(o){for(var s=o.length,u=0;u!==s;){var a=o[i?s-++u:u++];if(n(a[1],a[0],this)===!1)break}return u}return this.__iterateUncached(n,i)},t.prototype.__iterator=function(n,i){var o=this._cache;if(o){var s=o.length,u=0;return new l(function(){if(u===s)return j();var a=o[i?s-++u:u++];return O(n,a[0],a[1])})}return this.__iteratorUncached(n,i)},t}(z),nt=function(r){function t(e){return e==null?zr().toKeyedSeq():C(e)?I(e)?e.toSeq():e.fromEntrySeq():Bt(e)?e.toSeq():br(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.toKeyedSeq=function(){return this},t}(U),Y=function(r){function t(e){return e==null?zr():C(e)?I(e)?e.entrySeq():e.toIndexedSeq():Bt(e)?e.toSeq().entrySeq():je(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toIndexedSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq [","]")},t}(U),mt=function(r){function t(e){return(C(e)&&!rr(e)?e:Y(e)).toSetSeq()}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toSetSeq=function(){return this},t}(U);U.isSeq=Ir;U.Keyed=nt;U.Set=mt;U.Indexed=Y;U.prototype[qe]=!0;var st=function(r){function t(e){this._array=e,this.size=e.length}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return this.has(n)?this._array[rt(this,n)]:i},t.prototype.__iterate=function(n,i){for(var o=this._array,s=o.length,u=0;u!==s;){var a=i?s-++u:u++;if(n(o[a],a,this)===!1)break}return u},t.prototype.__iterator=function(n,i){var o=this._array,s=o.length,u=0;return new l(function(){if(u===s)return j();var a=i?s-++u:u++;return O(n,a,o[a])})},t}(Y),Er=function(r){function t(e){var n=Object.keys(e);this._object=e,this._keys=n,this.size=n.length}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return i!==void 0&&!this.has(n)?i:this._object[n]},t.prototype.has=function(n){return St.call(this._object,n)},t.prototype.__iterate=function(n,i){for(var o=this._object,s=this._keys,u=s.length,a=0;a!==u;){var f=s[i?u-++a:a++];if(n(o[f],f,this)===!1)break}return a},t.prototype.__iterator=function(n,i){var o=this._object,s=this._keys,u=s.length,a=0;return new l(function(){if(a===u)return j();var f=s[i?u-++a:a++];return O(n,f,o[f])})},t}(nt);Er.prototype[gt]=!0;var Mn=function(r){function t(e){this._collection=e,this.size=e.length||e.size}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.__iterateUncached=function(n,i){if(i)return this.cacheResult().__iterate(n,i);var o=this._collection,s=vr(o),u=0;if(Gr(s))for(var a;!(a=s.next()).done&&n(a.value,u++,this)!==!1;);return u},t.prototype.__iteratorUncached=function(n,i){if(i)return this.cacheResult().__iterator(n,i);var o=this._collection,s=vr(o);if(!Gr(s))return new l(j);var u=0;return new l(function(){var a=s.next();return a.done?a:O(n,u++,a.value)})},t}(Y),Qr;function zr(){return Qr||(Qr=new st([]))}function br(r){var t=Mr(r);if(t)return t.fromEntrySeq();if(typeof r=="object")return new Er(r);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+r)}function je(r){var t=Mr(r);if(t)return t;throw new TypeError("Expected Array or collection object of values: "+r)}function qn(r){var t=Mr(r);if(t)return zn(r)?t.fromEntrySeq():bn(r)?t.toSetSeq():t;if(typeof r=="object")return new Er(r);throw new TypeError("Expected Array or collection object of values, or keyed object: "+r)}function Mr(r){return Ce(r)?new st(r):Te(r)?new Mn(r):void 0}var Ne="@@__IMMUTABLE_MAP__@@";function qr(r){return Boolean(r&&r[Ne])}function Le(r){return qr(r)&&F(r)}function Vr(r){return Boolean(r&&typeof r.equals=="function"&&typeof r.hashCode=="function")}function $(r,t){if(r===t||r!==r&&t!==t)return!0;if(!r||!t)return!1;if(typeof r.valueOf=="function"&&typeof t.valueOf=="function"){if(r=r.valueOf(),t=t.valueOf(),r===t||r!==r&&t!==t)return!0;if(!r||!t)return!1}return!!(Vr(r)&&Vr(t)&&r.equals(t))}var bt=typeof Math.imul=="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(t,e){t|=0,e|=0;var n=t&65535,i=e&65535;return n*i+((t>>>16)*i+n*(e>>>16)<<16>>>0)|0};function ir(r){return r>>>1&1073741824|r&3221225471}var An=Object.prototype.valueOf;function L(r){if(r==null)return te(r);if(typeof r.hashCode=="function")return ir(r.hashCode(r));var t=Ln(r);if(t==null)return te(t);switch(typeof t){case"boolean":return t?1108378657:1108378656;case"number":return Rn(t);case"string":return t.length>$n?Tn(t):yr(t);case"object":case"function":return jn(t);case"symbol":return Cn(t);default:if(typeof t.toString=="function")return yr(t.toString());throw new Error("Value type "+typeof t+" cannot be hashed.")}}function te(r){return r===null?1108378658:1108378659}function Rn(r){if(r!==r||r===1/0)return 0;var t=r|0;for(t!==r&&(t^=r*4294967295);r>4294967295;)r/=4294967295,t^=r;return ir(t)}function Tn(r){var t=hr[r];return t===void 0&&(t=yr(r),fr===Un&&(fr=0,hr={}),fr++,hr[r]=t),t}function yr(r){for(var t=0,e=0;e<r.length;e++)t=31*t+r.charCodeAt(e)|0;return ir(t)}function Cn(r){var t=ne[r];return t!==void 0||(t=$e(),ne[r]=t),t}function jn(r){var t;if(lr&&(t=gr.get(r),t!==void 0)||(t=r[ot],t!==void 0)||!ee&&(t=r.propertyIsEnumerable&&r.propertyIsEnumerable[ot],t!==void 0||(t=Nn(r),t!==void 0)))return t;if(t=$e(),lr)gr.set(r,t);else{if(re!==void 0&&re(r)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(ee)Object.defineProperty(r,ot,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(r.propertyIsEnumerable!==void 0&&r.propertyIsEnumerable===r.constructor.prototype.propertyIsEnumerable)r.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},r.propertyIsEnumerable[ot]=t;else if(r.nodeType!==void 0)r[ot]=t;else throw new Error("Unable to set a non-enumerable property on object.")}return t}var re=Object.isExtensible,ee=function(){try{return Object.defineProperty({},"@",{}),!0}catch(r){return!1}}();function Nn(r){if(r&&r.nodeType>0)switch(r.nodeType){case 1:return r.uniqueID;case 9:return r.documentElement&&r.documentElement.uniqueID}}function Ln(r){return r.valueOf!==An&&typeof r.valueOf=="function"?r.valueOf(r):r}function $e(){var r=++ar;return ar&1073741824&&(ar=0),r}var lr=typeof WeakMap=="function",gr;lr&&(gr=new WeakMap);var ne=Object.create(null),ar=0,ot="__immutablehash__";typeof Symbol=="function"&&(ot=Symbol(ot));var $n=16,Un=255,fr=0,hr={},or=function(r){function t(e,n){this._iter=e,this._useKeys=n,this.size=e.size}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return this._iter.get(n,i)},t.prototype.has=function(n){return this._iter.has(n)},t.prototype.valueSeq=function(){return this._iter.valueSeq()},t.prototype.reverse=function(){var n=this,i=Ar(this,!0);return this._useKeys||(i.valueSeq=function(){return n._iter.toSeq().reverse()}),i},t.prototype.map=function(n,i){var o=this,s=Pe(this,n,i);return this._useKeys||(s.valueSeq=function(){return o._iter.toSeq().map(n,i)}),s},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s,u){return n(s,u,o)},i)},t.prototype.__iterator=function(n,i){return this._iter.__iterator(n,i)},t}(nt);or.prototype[gt]=!0;var Ue=function(r){function t(e){this._iter=e,this.size=e.size}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.includes=function(n){return this._iter.includes(n)},t.prototype.__iterate=function(n,i){var o=this,s=0;return i&&ht(this),this._iter.__iterate(function(u){return n(u,i?o.size-++s:s++,o)},i)},t.prototype.__iterator=function(n,i){var o=this,s=this._iter.__iterator(J,i),u=0;return i&&ht(this),new l(function(){var a=s.next();return a.done?a:O(n,i?o.size-++u:u++,a.value,a)})},t}(Y),De=function(r){function t(e){this._iter=e,this.size=e.size}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.has=function(n){return this._iter.includes(n)},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s){return n(s,s,o)},i)},t.prototype.__iterator=function(n,i){var o=this._iter.__iterator(J,i);return new l(function(){var s=o.next();return s.done?s:O(n,s.value,s.value,s)})},t}(mt),Be=function(r){function t(e){this._iter=e,this.size=e.size}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.entrySeq=function(){return this._iter.toSeq()},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s){if(s){oe(s);var u=C(s);return n(u?s.get(1):s[1],u?s.get(0):s[0],o)}},i)},t.prototype.__iterator=function(n,i){var o=this._iter.__iterator(J,i);return new l(function(){for(;;){var s=o.next();if(s.done)return s;var u=s.value;if(u){oe(u);var a=C(u);return O(n,a?u.get(0):u[0],a?u.get(1):u[1],s)}}})},t}(nt);Ue.prototype.cacheResult=or.prototype.cacheResult=De.prototype.cacheResult=Be.prototype.cacheResult=Tr;function ke(r){var t=Z(r);return t._iter=r,t.size=r.size,t.flip=function(){return r},t.reverse=function(){var e=r.reverse.apply(this);return e.flip=function(){return r.reverse()},e},t.has=function(e){return r.includes(e)},t.includes=function(e){return r.has(e)},t.cacheResult=Tr,t.__iterateUncached=function(e,n){var i=this;return r.__iterate(function(o,s){return e(s,o,i)!==!1},n)},t.__iteratorUncached=function(e,n){if(e===P){var i=r.__iterator(e,n);return new l(function(){var o=i.next();if(!o.done){var s=o.value[0];o.value[0]=o.value[1],o.value[1]=s}return o})}return r.__iterator(e===J?kt:J,n)},t}function Pe(r,t,e){var n=Z(r);return n.size=r.size,n.has=function(i){return r.has(i)},n.get=function(i,o){var s=r.get(i,y);return s===y?o:t.call(e,s,i,r)},n.__iterateUncached=function(i,o){var s=this;return r.__iterate(function(u,a,f){return i(t.call(e,u,a,f),a,s)!==!1},o)},n.__iteratorUncached=function(i,o){var s=r.__iterator(P,o);return new l(function(){var u=s.next();if(u.done)return u;var a=u.value,f=a[0];return O(i,f,t.call(e,a[1],f,r),u)})},n}function Ar(r,t){var e=this,n=Z(r);return n._iter=r,n.size=r.size,n.reverse=function(){return r},r.flip&&(n.flip=function(){var i=ke(r);return i.reverse=function(){return r.flip()},i}),n.get=function(i,o){return r.get(t?i:-1-i,o)},n.has=function(i){return r.has(t?i:-1-i)},n.includes=function(i){return r.includes(i)},n.cacheResult=Tr,n.__iterate=function(i,o){var s=this,u=0;return o&&ht(r),r.__iterate(function(a,f){return i(a,t?f:o?s.size-++u:u++,s)},!o)},n.__iterator=function(i,o){var s=0;o&&ht(r);var u=r.__iterator(P,!o);return new l(function(){var a=u.next();if(a.done)return a;var f=a.value;return O(i,t?f[0]:o?e.size-++s:s++,f[1],a)})},n}function We(r,t,e,n){var i=Z(r);return n&&(i.has=function(o){var s=r.get(o,y);return s!==y&&!!t.call(e,s,o,r)},i.get=function(o,s){var u=r.get(o,y);return u!==y&&t.call(e,u,o,r)?u:s}),i.__iterateUncached=function(o,s){var u=this,a=0;return r.__iterate(function(f,h,c){if(t.call(e,f,h,c))return a++,o(f,n?h:a-1,u)},s),a},i.__iteratorUncached=function(o,s){var u=r.__iterator(P,s),a=0;return new l(function(){for(;;){var f=u.next();if(f.done)return f;var h=f.value,c=h[0],p=h[1];if(t.call(e,p,c,r))return O(o,n?c:a++,p,f)}})},i}function Dn(r,t,e){var n=Ot().asMutable();return r.__iterate(function(i,o){n.update(t.call(e,i,o,r),0,function(s){return s+1})}),n.asImmutable()}function Bn(r,t,e){var n=I(r),i=(F(r)?Q():Ot()).asMutable();r.__iterate(function(s,u){i.update(t.call(e,s,u,r),function(a){return a=a||[],a.push(n?[u,s]:s),a})});var o=Je(r);return i.map(function(s){return g(r,o(s))}).asImmutable()}function Rr(r,t,e,n){var i=r.size;if(Vt(t,e,i))return r;var o=Dt(t,i),s=tr(e,i);if(o!==o||s!==s)return Rr(r.toSeq().cacheResult(),t,e,n);var u=s-o,a;u===u&&(a=u<0?0:u);var f=Z(r);return f.size=a===0?a:r.size&&a||void 0,!n&&Ir(r)&&a>=0&&(f.get=function(h,c){return h=rt(this,h),h>=0&&h<a?r.get(h+o,c):c}),f.__iterateUncached=function(h,c){var p=this;if(a===0)return 0;if(c)return this.cacheResult().__iterate(h,c);var d=0,_=!0,v=0;return r.__iterate(function(N,H){if(!(_&&(_=d++<o)))return v++,h(N,n?H:v-1,p)!==!1&&v!==a}),v},f.__iteratorUncached=function(h,c){if(a!==0&&c)return this.cacheResult().__iterator(h,c);if(a===0)return new l(j);var p=r.__iterator(h,c),d=0,_=0;return new l(function(){for(;d++<o;)p.next();if(++_>a)return j();var v=p.next();return n||h===J||v.done?v:h===kt?O(h,_-1,void 0,v):O(h,_-1,v.value[1],v)})},f}function kn(r,t,e){var n=Z(r);return n.__iterateUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterate(i,o);var u=0;return r.__iterate(function(a,f,h){return t.call(e,a,f,h)&&++u&&i(a,f,s)}),u},n.__iteratorUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterator(i,o);var u=r.__iterator(P,o),a=!0;return new l(function(){if(!a)return j();var f=u.next();if(f.done)return f;var h=f.value,c=h[0],p=h[1];return t.call(e,p,c,s)?i===P?f:O(i,c,p,f):(a=!1,j())})},n}function Ke(r,t,e,n){var i=Z(r);return i.__iterateUncached=function(o,s){var u=this;if(s)return this.cacheResult().__iterate(o,s);var a=!0,f=0;return r.__iterate(function(h,c,p){if(!(a&&(a=t.call(e,h,c,p))))return f++,o(h,n?c:f-1,u)}),f},i.__iteratorUncached=function(o,s){var u=this;if(s)return this.cacheResult().__iterator(o,s);var a=r.__iterator(P,s),f=!0,h=0;return new l(function(){var c,p,d;do{if(c=a.next(),c.done)return n||o===J?c:o===kt?O(o,h++,void 0,c):O(o,h++,c.value[1],c);var _=c.value;p=_[0],d=_[1],f&&(f=t.call(e,d,p,u))}while(f);return o===P?c:O(o,p,d,c)})},i}function Pn(r,t){var e=I(r),n=[r].concat(t).map(function(s){return C(s)?e&&(s=W(s)):s=e?br(s):je(Array.isArray(s)?s:[s]),s}).filter(function(s){return s.size!==0});if(n.length===0)return r;if(n.length===1){var i=n[0];if(i===r||e&&I(i)||T(r)&&T(i))return i}var o=new st(n);return e?o=o.toKeyedSeq():T(r)||(o=o.toSetSeq()),o=o.flatten(!0),o.size=n.reduce(function(s,u){if(s!==void 0){var a=u.size;if(a!==void 0)return s+a}},0),o}function Fe(r,t,e){var n=Z(r);return n.__iterateUncached=function(i,o){if(o)return this.cacheResult().__iterate(i,o);var s=0,u=!1;function a(f,h){f.__iterate(function(c,p){return(!t||h<t)&&C(c)?a(c,h+1):(s++,i(c,e?p:s-1,n)===!1&&(u=!0)),!u},o)}return a(r,0),s},n.__iteratorUncached=function(i,o){if(o)return this.cacheResult().__iterator(i,o);var s=r.__iterator(i,o),u=[],a=0;return new l(function(){for(;s;){var f=s.next();if(f.done!==!1){s=u.pop();continue}var h=f.value;if(i===P&&(h=h[1]),(!t||u.length<t)&&C(h))u.push(s),s=h.__iterator(i,o);else return e?f:O(i,a++,h,f)}return j()})},n}function Wn(r,t,e){var n=Je(r);return r.toSeq().map(function(i,o){return n(t.call(e,i,o,r))}).flatten(!0)}function Kn(r,t){var e=Z(r);return e.size=r.size&&r.size*2-1,e.__iterateUncached=function(n,i){var o=this,s=0;return r.__iterate(function(u){return(!s||n(t,s++,o)!==!1)&&n(u,s++,o)!==!1},i),s},e.__iteratorUncached=function(n,i){var o=r.__iterator(J,i),s=0,u;return new l(function(){return(!u||s%2)&&(u=o.next(),u.done)?u:s%2?O(n,s++,t):O(n,s++,u.value,u)})},e}function ct(r,t,e){t||(t=Ye);var n=I(r),i=0,o=r.toSeq().map(function(s,u){return[u,s,i++,e?e(s,u,r):s]}).valueSeq().toArray();return o.sort(function(s,u){return t(s[3],u[3])||s[2]-u[2]}).forEach(n?function(s,u){o[u].length=2}:function(s,u){o[u]=s[1]}),n?nt(o):T(r)?Y(o):mt(o)}function Jt(r,t,e){if(t||(t=Ye),e){var n=r.toSeq().map(function(i,o){return[i,e(i,o,r)]}).reduce(function(i,o){return ie(t,i[1],o[1])?o:i});return n&&n[0]}return r.reduce(function(i,o){return ie(t,i,o)?o:i})}function ie(r,t,e){var n=r(e,t);return n===0&&e!==t&&(e==null||e!==e)||n>0}function Yt(r,t,e,n){var i=Z(r),o=new st(e).map(function(s){return s.size});return i.size=n?o.max():o.min(),i.__iterate=function(s,u){for(var a=this.__iterator(J,u),f,h=0;!(f=a.next()).done&&s(f.value,h++,this)!==!1;);return h},i.__iteratorUncached=function(s,u){var a=e.map(function(c){return c=z(c),vr(u?c.reverse():c)}),f=0,h=!1;return new l(function(){var c;return h||(c=a.map(function(p){return p.next()}),h=n?c.every(function(p){return p.done}):c.some(function(p){return p.done})),h?j():O(s,f++,t.apply(null,c.map(function(p){return p.value})))})},i}function g(r,t){return r===t?r:Ir(r)?t:r.constructor(t)}function oe(r){if(r!==Object(r))throw new TypeError("Expected [K, V] tuple: "+r)}function Je(r){return I(r)?W:T(r)?ut:lt}function Z(r){return Object.create((I(r)?nt:T(r)?Y:mt).prototype)}function Tr(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):U.prototype.cacheResult.call(this)}function Ye(r,t){return r===void 0&&t===void 0?0:r===void 0?1:t===void 0?-1:r>t?1:r<t?-1:0}function x(r,t){t=t||0;for(var e=Math.max(0,r.length-t),n=new Array(e),i=0;i<e;i++)n[i]=r[i+t];return n}function Cr(r,t){if(!r)throw new Error(t)}function k(r){Cr(r!==1/0,"Cannot perform this action with an infinite size.")}function He(r){if(Ce(r)&&typeof r!="string")return r;if(F(r))return r.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+r)}var Fn=Object.prototype.toString;function Jn(r){if(!r||typeof r!="object"||Fn.call(r)!=="[object Object]")return!1;var t=Object.getPrototypeOf(r);if(t===null)return!0;for(var e=t,n=Object.getPrototypeOf(t);n!==null;)e=n,n=Object.getPrototypeOf(e);return e===t}function et(r){return typeof r=="object"&&(X(r)||Array.isArray(r)||Jn(r))}function Tt(r){try{return typeof r=="string"?JSON.stringify(r):String(r)}catch(t){return JSON.stringify(r)}}function Yn(r,t){return X(r)?r.has(t):et(r)&&St.call(r,t)}function xe(r,t,e){return X(r)?r.get(t,e):Yn(r,t)?typeof r.get=="function"?r.get(t):r[t]:e}function Gt(r){if(Array.isArray(r))return x(r);var t={};for(var e in r)St.call(r,e)&&(t[e]=r[e]);return t}function Hn(r,t){if(!et(r))throw new TypeError("Cannot update non-data-structure value: "+r);if(X(r)){if(!r.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+r);return r.remove(t)}if(!St.call(r,t))return r;var e=Gt(r);return Array.isArray(e)?e.splice(t,1):delete e[t],e}function xn(r,t,e){if(!et(r))throw new TypeError("Cannot update non-data-structure value: "+r);if(X(r)){if(!r.set)throw new TypeError("Cannot update immutable value without .set() method: "+r);return r.set(t,e)}if(St.call(r,t)&&e===r[t])return r;var n=Gt(r);return n[t]=e,n}function wt(r,t,e,n){n||(n=e,e=void 0);var i=Xe(X(r),r,He(t),0,e,n);return i===y?e:i}function Xe(r,t,e,n,i,o){var s=t===y;if(n===e.length){var u=s?i:t,a=o(u);return a===u?t:a}if(!s&&!et(t))throw new TypeError("Cannot update within non-data-structure value in path ["+e.slice(0,n).map(Tt)+"]: "+t);var f=e[n],h=s?y:xe(t,f,y),c=Xe(h===y?r:X(h),h,e,n+1,i,o);return c===h?t:c===y?Hn(t,f):xn(s?r?K():{}:t,f,c)}function Xn(r,t,e){return wt(r,t,y,function(){return e})}function jr(r,t){return Xn(this,r,t)}function Zn(r,t){return wt(r,t,function(){return y})}function Nr(r){return Zn(this,r)}function Ze(r,t,e,n){return wt(r,[t],e,n)}function Lr(r,t,e){return arguments.length===1?r(this):Ze(this,r,t,e)}function $r(r,t,e){return wt(this,r,t,e)}function Ge(){for(var r=[],t=arguments.length;t--;)r[t]=arguments[t];return Ve(this,r)}function Qe(r){for(var t=[],e=arguments.length-1;e-- >0;)t[e]=arguments[e+1];if(typeof r!="function")throw new TypeError("Invalid merger function: "+r);return Ve(this,t,r)}function Ve(r,t,e){for(var n=[],i=0;i<t.length;i++){var o=W(t[i]);o.size!==0&&n.push(o)}return n.length===0?r:r.toSeq().size===0&&!r.__ownerID&&n.length===1?r.constructor(n[0]):r.withMutations(function(s){for(var u=e?function(f,h){Ze(s,h,y,function(c){return c===y?f:e(c,f,h)})}:function(f,h){s.set(h,f)},a=0;a<n.length;a++)n[a].forEach(u)})}function Ur(r,t,e){return Dr(r,t,Gn(e))}function Dr(r,t,e){if(!et(r))throw new TypeError("Cannot merge into non-data-structure value: "+r);if(X(r))return typeof e=="function"&&r.mergeWith?r.mergeWith.apply(r,[e].concat(t)):r.merge?r.merge.apply(r,t):r.concat.apply(r,t);for(var n=Array.isArray(r),i=r,o=n?ut:W,s=n?function(a){i===r&&(i=Gt(i)),i.push(a)}:function(a,f){var h=St.call(i,f),c=h&&e?e(i[f],a,f):a;(!h||c!==i[f])&&(i===r&&(i=Gt(i)),i[f]=c)},u=0;u<t.length;u++)o(t[u]).forEach(s);return i}function Gn(r){function t(e,n,i){return et(e)&&et(n)&&Qn(e,n)?Dr(e,[n],t):r?r(e,n,i):n}return t}function Qn(r,t){var e=U(r),n=U(t);return T(e)===T(n)&&I(e)===I(n)}function tn(){for(var r=[],t=arguments.length;t--;)r[t]=arguments[t];return Ur(this,r)}function rn(r){for(var t=[],e=arguments.length-1;e-- >0;)t[e]=arguments[e+1];return Ur(this,t,r)}function Br(r){for(var t=[],e=arguments.length-1;e-- >0;)t[e]=arguments[e+1];return wt(this,r,K(),function(n){return Dr(n,t)})}function kr(r){for(var t=[],e=arguments.length-1;e-- >0;)t[e]=arguments[e+1];return wt(this,r,K(),function(n){return Ur(n,t)})}function Pt(r){var t=this.asMutable();return r(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this}function Wt(){return this.__ownerID?this:this.__ensureOwner(new Or)}function Kt(){return this.__ensureOwner()}function Pr(){return this.__altered}var Ot=function(r){function t(e){return e==null?K():qr(e)&&!F(e)?e:K().withMutations(function(n){var i=r(e);k(i.size),i.forEach(function(o,s){return n.set(s,o)})})}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return K().withMutations(function(o){for(var s=0;s<n.length;s+=2){if(s+1>=n.length)throw new Error("Missing value for key: "+n[s]);o.set(n[s],n[s+1])}})},t.prototype.toString=function(){return this.__toString("Map {","}")},t.prototype.get=function(n,i){return this._root?this._root.get(0,void 0,n,i):i},t.prototype.set=function(n,i){return ae(this,n,i)},t.prototype.remove=function(n){return ae(this,n,y)},t.prototype.deleteAll=function(n){var i=z(n);return i.size===0?this:this.withMutations(function(o){i.forEach(function(s){return o.remove(s)})})},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):K()},t.prototype.sort=function(n){return Q(ct(this,n))},t.prototype.sortBy=function(n,i){return Q(ct(this,i,n))},t.prototype.map=function(n,i){var o=this;return this.withMutations(function(s){s.forEach(function(u,a){s.set(a,n.call(i,u,a,o))})})},t.prototype.__iterator=function(n,i){return new Vn(this,n,i)},t.prototype.__iterate=function(n,i){var o=this,s=0;return this._root&&this._root.iterate(function(u){return s++,n(u[1],u[0],o)},i),s},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Wr(this.size,this._root,n,this.__hash):this.size===0?K():(this.__ownerID=n,this.__altered=!1,this)},t}(W);Ot.isMap=qr;var w=Ot.prototype;w[Ne]=!0;w[Ut]=w.remove;w.removeAll=w.deleteAll;w.setIn=jr;w.removeIn=w.deleteIn=Nr;w.update=Lr;w.updateIn=$r;w.merge=w.concat=Ge;w.mergeWith=Qe;w.mergeDeep=tn;w.mergeDeepWith=rn;w.mergeIn=Br;w.mergeDeepIn=kr;w.withMutations=Pt;w.wasAltered=Pr;w.asImmutable=Kt;w["@@transducer/init"]=w.asMutable=Wt;w["@@transducer/step"]=function(r,t){return r.set(t[0],t[1])};w["@@transducer/result"]=function(r){return r.asImmutable()};var Ct=function(t,e){this.ownerID=t,this.entries=e};Ct.prototype.get=function(t,e,n,i){for(var o=this.entries,s=0,u=o.length;s<u;s++)if($(n,o[s][0]))return o[s][1];return i};Ct.prototype.update=function(t,e,n,i,o,s,u){for(var a=o===y,f=this.entries,h=0,c=f.length;h<c&&!$(i,f[h][0]);h++);var p=h<c;if(p?f[h][1]===o:a)return this;if(B(u),(a||!p)&&B(s),!(a&&f.length===1)){if(!p&&!a&&f.length>=oi)return ti(t,f,i,o);var d=t&&t===this.ownerID,_=d?f:x(f);return p?a?h===c-1?_.pop():_[h]=_.pop():_[h]=[i,o]:_.push([i,o]),d?(this.entries=_,this):new Ct(t,_)}};var pt=function(t,e,n){this.ownerID=t,this.bitmap=e,this.nodes=n};pt.prototype.get=function(t,e,n,i){e===void 0&&(e=L(n));var o=1<<((t===0?e:e>>>t)&A),s=this.bitmap;return(s&o)===0?i:this.nodes[en(s&o-1)].get(t+m,e,n,i)};pt.prototype.update=function(t,e,n,i,o,s,u){n===void 0&&(n=L(i));var a=(e===0?n:n>>>e)&A,f=1<<a,h=this.bitmap,c=(h&f)!==0;if(!c&&o===y)return this;var p=en(h&f-1),d=this.nodes,_=c?d[p]:void 0,v=Kr(_,t,e+m,n,i,o,s,u);if(v===_)return this;if(!c&&v&&d.length>=si)return ei(t,d,h,a,v);if(c&&!v&&d.length===2&&fe(d[p^1]))return d[p^1];if(c&&v&&d.length===1&&fe(v))return v;var N=t&&t===this.ownerID,H=c?v?h:h^f:h|f,it=c?v?nn(d,p,v,N):ii(d,p,N):ni(d,p,v,N);return N?(this.bitmap=H,this.nodes=it,this):new pt(t,H,it)};var jt=function(t,e,n){this.ownerID=t,this.count=e,this.nodes=n};jt.prototype.get=function(t,e,n,i){e===void 0&&(e=L(n));var o=(t===0?e:e>>>t)&A,s=this.nodes[o];return s?s.get(t+m,e,n,i):i};jt.prototype.update=function(t,e,n,i,o,s,u){n===void 0&&(n=L(i));var a=(e===0?n:n>>>e)&A,f=o===y,h=this.nodes,c=h[a];if(f&&!c)return this;var p=Kr(c,t,e+m,n,i,o,s,u);if(p===c)return this;var d=this.count;if(!c)d++;else if(!p&&(d--,d<ui))return ri(t,h,d,a);var _=t&&t===this.ownerID,v=nn(h,a,p,_);return _?(this.count=d,this.nodes=v,this):new jt(t,d,v)};var _t=function(t,e,n){this.ownerID=t,this.keyHash=e,this.entries=n};_t.prototype.get=function(t,e,n,i){for(var o=this.entries,s=0,u=o.length;s<u;s++)if($(n,o[s][0]))return o[s][1];return i};_t.prototype.update=function(t,e,n,i,o,s,u){n===void 0&&(n=L(i));var a=o===y;if(n!==this.keyHash)return a?this:(B(u),B(s),Fr(this,t,e,n,[i,o]));for(var f=this.entries,h=0,c=f.length;h<c&&!$(i,f[h][0]);h++);var p=h<c;if(p?f[h][1]===o:a)return this;if(B(u),(a||!p)&&B(s),a&&c===2)return new G(t,this.keyHash,f[h^1]);var d=t&&t===this.ownerID,_=d?f:x(f);return p?a?h===c-1?_.pop():_[h]=_.pop():_[h]=[i,o]:_.push([i,o]),d?(this.entries=_,this):new _t(t,this.keyHash,_)};var G=function(t,e,n){this.ownerID=t,this.keyHash=e,this.entry=n};G.prototype.get=function(t,e,n,i){return $(n,this.entry[0])?this.entry[1]:i};G.prototype.update=function(t,e,n,i,o,s,u){var a=o===y,f=$(i,this.entry[0]);if(f?o===this.entry[1]:a)return this;if(B(u),a){B(s);return}return f?t&&t===this.ownerID?(this.entry[1]=o,this):new G(t,this.keyHash,[i,o]):(B(s),Fr(this,t,e,L(i),[i,o]))};Ct.prototype.iterate=_t.prototype.iterate=function(r,t){for(var e=this.entries,n=0,i=e.length-1;n<=i;n++)if(r(e[t?i-n:n])===!1)return!1};pt.prototype.iterate=jt.prototype.iterate=function(r,t){for(var e=this.nodes,n=0,i=e.length-1;n<=i;n++){var o=e[t?i-n:n];if(o&&o.iterate(r,t)===!1)return!1}};G.prototype.iterate=function(r,t){return r(this.entry)};var Vn=function(r){function t(e,n,i){this._type=n,this._reverse=i,this._stack=e._root&&se(e._root)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.next=function(){for(var n=this._type,i=this._stack;i;){var o=i.node,s=i.index++,u=void 0;if(o.entry){if(s===0)return cr(n,o.entry)}else if(o.entries){if(u=o.entries.length-1,s<=u)return cr(n,o.entries[this._reverse?u-s:s])}else if(u=o.nodes.length-1,s<=u){var a=o.nodes[this._reverse?u-s:s];if(a){if(a.entry)return cr(n,a.entry);i=this._stack=se(a,i)}continue}i=this._stack=this._stack.__prev}return j()},t}(l);function cr(r,t){return O(r,t[0],t[1])}function se(r,t){return{node:r,index:0,__prev:t}}function Wr(r,t,e,n){var i=Object.create(w);return i.size=r,i._root=t,i.__ownerID=e,i.__hash=n,i.__altered=!1,i}var ue;function K(){return ue||(ue=Wr(0))}function ae(r,t,e){var n,i;if(r._root){var o=_r(),s=_r();if(n=Kr(r._root,r.__ownerID,0,void 0,t,e,o,s),!s.value)return r;i=r.size+(o.value?e===y?-1:1:0)}else{if(e===y)return r;i=1,n=new Ct(r.__ownerID,[[t,e]])}return r.__ownerID?(r.size=i,r._root=n,r.__hash=void 0,r.__altered=!0,r):n?Wr(i,n):K()}function Kr(r,t,e,n,i,o,s,u){return r?r.update(t,e,n,i,o,s,u):o===y?r:(B(u),B(s),new G(t,n,[i,o]))}function fe(r){return r.constructor===G||r.constructor===_t}function Fr(r,t,e,n,i){if(r.keyHash===n)return new _t(t,n,[r.entry,i]);var o=(e===0?r.keyHash:r.keyHash>>>e)&A,s=(e===0?n:n>>>e)&A,u,a=o===s?[Fr(r,t,e+m,n,i)]:(u=new G(t,n,i),o<s?[r,u]:[u,r]);return new pt(t,1<<o|1<<s,a)}function ti(r,t,e,n){r||(r=new Or);for(var i=new G(r,L(e),[e,n]),o=0;o<t.length;o++){var s=t[o];i=i.update(r,0,void 0,s[0],s[1])}return i}function ri(r,t,e,n){for(var i=0,o=0,s=new Array(e),u=0,a=1,f=t.length;u<f;u++,a<<=1){var h=t[u];h!==void 0&&u!==n&&(i|=a,s[o++]=h)}return new pt(r,i,s)}function ei(r,t,e,n,i){for(var o=0,s=new Array(D),u=0;e!==0;u++,e>>>=1)s[u]=e&1?t[o++]:void 0;return s[n]=i,new jt(r,o+1,s)}function en(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),r=r+(r>>4)&252645135,r+=r>>8,r+=r>>16,r&127}function nn(r,t,e,n){var i=n?r:x(r);return i[t]=e,i}function ni(r,t,e,n){var i=r.length+1;if(n&&t+1===i)return r[t]=e,r;for(var o=new Array(i),s=0,u=0;u<i;u++)u===t?(o[u]=e,s=-1):o[u]=r[u+s];return o}function ii(r,t,e){var n=r.length-1;if(e&&t===n)return r.pop(),r;for(var i=new Array(n),o=0,s=0;s<n;s++)s===t&&(o=1),i[s]=r[s+o];return i}var oi=D/4,si=D/2,ui=D/4,on="@@__IMMUTABLE_LIST__@@";function sn(r){return Boolean(r&&r[on])}var sr=function(r){function t(e){var n=Zt();if(e==null)return n;if(sn(e))return e;var i=r(e),o=i.size;return o===0?n:(k(o),o>0&&o<D?Nt(0,o,m,null,new tt(i.toArray())):n.withMutations(function(s){s.setSize(o),i.forEach(function(u,a){return s.set(a,u)})}))}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("List [","]")},t.prototype.get=function(n,i){if(n=rt(this,n),n>=0&&n<this.size){n+=this._origin;var o=un(this,n);return o&&o.array[n&A]}return i},t.prototype.set=function(n,i){return ai(this,n,i)},t.prototype.remove=function(n){return this.has(n)?n===0?this.shift():n===this.size-1?this.pop():this.splice(n,1):this},t.prototype.insert=function(n,i){return this.splice(n,0,i)},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=m,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):Zt()},t.prototype.push=function(){var n=arguments,i=this.size;return this.withMutations(function(o){V(o,0,i+n.length);for(var s=0;s<n.length;s++)o.set(i+s,n[s])})},t.prototype.pop=function(){return V(this,0,-1)},t.prototype.unshift=function(){var n=arguments;return this.withMutations(function(i){V(i,-n.length);for(var o=0;o<n.length;o++)i.set(o,n[o])})},t.prototype.shift=function(){return V(this,1)},t.prototype.concat=function(){for(var n=arguments,i=[],o=0;o<arguments.length;o++){var s=n[o],u=r(typeof s!="string"&&Te(s)?s:[s]);u.size!==0&&i.push(u)}return i.length===0?this:this.size===0&&!this.__ownerID&&i.length===1?this.constructor(i[0]):this.withMutations(function(a){i.forEach(function(f){return f.forEach(function(h){return a.push(h)})})})},t.prototype.setSize=function(n){return V(this,0,n)},t.prototype.map=function(n,i){var o=this;return this.withMutations(function(s){for(var u=0;u<o.size;u++)s.set(u,n.call(i,s.get(u),u,o))})},t.prototype.slice=function(n,i){var o=this.size;return Vt(n,i,o)?this:V(this,Dt(n,o),tr(i,o))},t.prototype.__iterator=function(n,i){var o=i?this.size:0,s=he(this,i);return new l(function(){var u=s();return u===Rt?j():O(n,i?--o:o++,u)})},t.prototype.__iterate=function(n,i){for(var o=i?this.size:0,s=he(this,i),u;(u=s())!==Rt&&n(u,i?--o:o++,this)!==!1;);return o},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Nt(this._origin,this._capacity,this._level,this._root,this._tail,n,this.__hash):this.size===0?Zt():(this.__ownerID=n,this.__altered=!1,this)},t}(ut);sr.isList=sn;var b=sr.prototype;b[on]=!0;b[Ut]=b.remove;b.merge=b.concat;b.setIn=jr;b.deleteIn=b.removeIn=Nr;b.update=Lr;b.updateIn=$r;b.mergeIn=Br;b.mergeDeepIn=kr;b.withMutations=Pt;b.wasAltered=Pr;b.asImmutable=Kt;b["@@transducer/init"]=b.asMutable=Wt;b["@@transducer/step"]=function(r,t){return r.push(t)};b["@@transducer/result"]=function(r){return r.asImmutable()};var tt=function(t,e){this.array=t,this.ownerID=e};tt.prototype.removeBefore=function(t,e,n){if(n===e?1<<e:this.array.length===0)return this;var i=n>>>e&A;if(i>=this.array.length)return new tt([],t);var o=i===0,s;if(e>0){var u=this.array[i];if(s=u&&u.removeBefore(t,e-m,n),s===u&&o)return this}if(o&&!s)return this;var a=dt(this,t);if(!o)for(var f=0;f<i;f++)a.array[f]=void 0;return s&&(a.array[i]=s),a};tt.prototype.removeAfter=function(t,e,n){if(n===(e?1<<e:0)||this.array.length===0)return this;var i=n-1>>>e&A;if(i>=this.array.length)return this;var o;if(e>0){var s=this.array[i];if(o=s&&s.removeAfter(t,e-m,n),o===s&&i===this.array.length-1)return this}var u=dt(this,t);return u.array.splice(i+1),o&&(u.array[i]=o),u};var Rt={};function he(r,t){var e=r._origin,n=r._capacity,i=Lt(n),o=r._tail;return s(r._root,r._level,0);function s(f,h,c){return h===0?u(f,c):a(f,h,c)}function u(f,h){var c=h===i?o&&o.array:f&&f.array,p=h>e?0:e-h,d=n-h;return d>D&&(d=D),function(){if(p===d)return Rt;var _=t?--d:p++;return c&&c[_]}}function a(f,h,c){var p,d=f&&f.array,_=c>e?0:e-c>>h,v=(n-c>>h)+1;return v>D&&(v=D),function(){for(;;){if(p){var N=p();if(N!==Rt)return N;p=null}if(_===v)return Rt;var H=t?--v:_++;p=s(d&&d[H],h-m,c+(H<<h))}}}}function Nt(r,t,e,n,i,o,s){var u=Object.create(b);return u.size=t-r,u._origin=r,u._capacity=t,u._level=e,u._root=n,u._tail=i,u.__ownerID=o,u.__hash=s,u.__altered=!1,u}var ce;function Zt(){return ce||(ce=Nt(0,0,m))}function ai(r,t,e){if(t=rt(r,t),t!==t)return r;if(t>=r.size||t<0)return r.withMutations(function(s){t<0?V(s,t).set(0,e):V(s,0,t+1).set(t,e)});t+=r._origin;var n=r._tail,i=r._root,o=_r();return t>=Lt(r._capacity)?n=Sr(n,r.__ownerID,0,t,e,o):i=Sr(i,r.__ownerID,r._level,t,e,o),o.value?r.__ownerID?(r._root=i,r._tail=n,r.__hash=void 0,r.__altered=!0,r):Nt(r._origin,r._capacity,r._level,i,n):r}function Sr(r,t,e,n,i,o){var s=n>>>e&A,u=r&&s<r.array.length;if(!u&&i===void 0)return r;var a;if(e>0){var f=r&&r.array[s],h=Sr(f,t,e-m,n,i,o);return h===f?r:(a=dt(r,t),a.array[s]=h,a)}return u&&r.array[s]===i?r:(o&&B(o),a=dt(r,t),i===void 0&&s===a.array.length-1?a.array.pop():a.array[s]=i,a)}function dt(r,t){return t&&r&&t===r.ownerID?r:new tt(r?r.array.slice():[],t)}function un(r,t){if(t>=Lt(r._capacity))return r._tail;if(t<1<<r._level+m){for(var e=r._root,n=r._level;e&&n>0;)e=e.array[t>>>n&A],n-=m;return e}}function V(r,t,e){t!==void 0&&(t|=0),e!==void 0&&(e|=0);var n=r.__ownerID||new Or,i=r._origin,o=r._capacity,s=i+t,u=e===void 0?o:e<0?o+e:i+e;if(s===i&&u===o)return r;if(s>=u)return r.clear();for(var a=r._level,f=r._root,h=0;s+h<0;)f=new tt(f&&f.array.length?[void 0,f]:[],n),a+=m,h+=1<<a;h&&(s+=h,i+=h,u+=h,o+=h);for(var c=Lt(o),p=Lt(u);p>=1<<a+m;)f=new tt(f&&f.array.length?[f]:[],n),a+=m;var d=r._tail,_=p<c?un(r,u-1):p>c?new tt([],n):d;if(d&&p>c&&s<o&&d.array.length){f=dt(f,n);for(var v=f,N=a;N>m;N-=m){var H=c>>>N&A;v=v.array[H]=dt(v.array[H],n)}v.array[c>>>m&A]=d}if(u<o&&(_=_&&_.removeAfter(n,0,u)),s>=p)s-=p,u-=p,a=m,f=null,_=_&&_.removeBefore(n,0,s);else if(s>i||p<c){for(h=0;f;){var it=s>>>a&A;if(it!==p>>>a&A)break;it&&(h+=(1<<a)*it),a-=m,f=f.array[it]}f&&s>i&&(f=f.removeBefore(n,a,s-h)),f&&p<c&&(f=f.removeAfter(n,a,p-h)),h&&(s-=h,u-=h)}return r.__ownerID?(r.size=u-s,r._origin=s,r._capacity=u,r._level=a,r._root=f,r._tail=_,r.__hash=void 0,r.__altered=!0,r):Nt(s,u,a,f,_)}function Lt(r){return r<D?0:r-1>>>m<<m}var Q=function(r){function t(e){return e==null?Mt():Le(e)?e:Mt().withMutations(function(n){var i=W(e);k(i.size),i.forEach(function(o,s){return n.set(s,o)})})}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("OrderedMap {","}")},t.prototype.get=function(n,i){var o=this._map.get(n);return o!==void 0?this._list.get(o)[1]:i},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):Mt()},t.prototype.set=function(n,i){return _e(this,n,i)},t.prototype.remove=function(n){return _e(this,n,y)},t.prototype.__iterate=function(n,i){var o=this;return this._list.__iterate(function(s){return s&&n(s[1],s[0],o)},i)},t.prototype.__iterator=function(n,i){return this._list.fromEntrySeq().__iterator(n,i)},t.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n),o=this._list.__ensureOwner(n);return n?Jr(i,o,n,this.__hash):this.size===0?Mt():(this.__ownerID=n,this.__altered=!1,this._map=i,this._list=o,this)},t}(Ot);Q.isOrderedMap=Le;Q.prototype[gt]=!0;Q.prototype[Ut]=Q.prototype.remove;function Jr(r,t,e,n){var i=Object.create(Q.prototype);return i.size=r?r.size:0,i._map=r,i._list=t,i.__ownerID=e,i.__hash=n,i.__altered=!1,i}var pe;function Mt(){return pe||(pe=Jr(K(),Zt()))}function _e(r,t,e){var n=r._map,i=r._list,o=n.get(t),s=o!==void 0,u,a;if(e===y){if(!s)return r;i.size>=D&&i.size>=n.size*2?(a=i.filter(function(f,h){return f!==void 0&&o!==h}),u=a.toKeyedSeq().map(function(f){return f[0]}).flip().toMap(),r.__ownerID&&(u.__ownerID=a.__ownerID=r.__ownerID)):(u=n.remove(t),a=o===i.size-1?i.pop():i.set(o,void 0))}else if(s){if(e===i.get(o)[1])return r;u=n,a=i.set(o,[t,e])}else u=n.set(t,i.size),a=i.set(i.size,[t,e]);return r.__ownerID?(r.size=u.size,r._map=u,r._list=a,r.__hash=void 0,r.__altered=!0,r):Jr(u,a)}var an="@@__IMMUTABLE_STACK__@@";function mr(r){return Boolean(r&&r[an])}var Yr=function(r){function t(e){return e==null?Ht():mr(e)?e:Ht().pushAll(e)}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("Stack [","]")},t.prototype.get=function(n,i){var o=this._head;for(n=rt(this,n);o&&n--;)o=o.next;return o?o.value:i},t.prototype.peek=function(){return this._head&&this._head.value},t.prototype.push=function(){var n=arguments;if(arguments.length===0)return this;for(var i=this.size+arguments.length,o=this._head,s=arguments.length-1;s>=0;s--)o={value:n[s],next:o};return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):qt(i,o)},t.prototype.pushAll=function(n){if(n=r(n),n.size===0)return this;if(this.size===0&&mr(n))return n;k(n.size);var i=this.size,o=this._head;return n.__iterate(function(s){i++,o={value:s,next:o}},!0),this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):qt(i,o)},t.prototype.pop=function(){return this.slice(1)},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Ht()},t.prototype.slice=function(n,i){if(Vt(n,i,this.size))return this;var o=Dt(n,this.size),s=tr(i,this.size);if(s!==this.size)return r.prototype.slice.call(this,n,i);for(var u=this.size-o,a=this._head;o--;)a=a.next;return this.__ownerID?(this.size=u,this._head=a,this.__hash=void 0,this.__altered=!0,this):qt(u,a)},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?qt(this.size,this._head,n,this.__hash):this.size===0?Ht():(this.__ownerID=n,this.__altered=!1,this)},t.prototype.__iterate=function(n,i){var o=this;if(i)return new st(this.toArray()).__iterate(function(a,f){return n(a,f,o)},i);for(var s=0,u=this._head;u&&n(u.value,s++,this)!==!1;)u=u.next;return s},t.prototype.__iterator=function(n,i){if(i)return new st(this.toArray()).__iterator(n,i);var o=0,s=this._head;return new l(function(){if(s){var u=s.value;return s=s.next,O(n,o++,u)}return j()})},t}(ut);Yr.isStack=mr;var R=Yr.prototype;R[an]=!0;R.shift=R.pop;R.unshift=R.push;R.unshiftAll=R.pushAll;R.withMutations=Pt;R.wasAltered=Pr;R.asImmutable=Kt;R["@@transducer/init"]=R.asMutable=Wt;R["@@transducer/step"]=function(r,t){return r.unshift(t)};R["@@transducer/result"]=function(r){return r.asImmutable()};function qt(r,t,e,n){var i=Object.create(R);return i.size=r,i._head=t,i.__ownerID=e,i.__hash=n,i.__altered=!1,i}var de;function Ht(){return de||(de=qt(0))}var fn="@@__IMMUTABLE_SET__@@";function Hr(r){return Boolean(r&&r[fn])}function hn(r){return Hr(r)&&F(r)}function cn(r,t){if(r===t)return!0;if(!C(t)||r.size!==void 0&&t.size!==void 0&&r.size!==t.size||r.__hash!==void 0&&t.__hash!==void 0&&r.__hash!==t.__hash||I(r)!==I(t)||T(r)!==T(t)||F(r)!==F(t))return!1;if(r.size===0&&t.size===0)return!0;var e=!rr(r);if(F(r)){var n=r.entries();return t.every(function(a,f){var h=n.next().value;return h&&$(h[1],a)&&(e||$(h[0],f))})&&n.next().done}var i=!1;if(r.size===void 0)if(t.size===void 0)typeof r.cacheResult=="function"&&r.cacheResult();else{i=!0;var o=r;r=t,t=o}var s=!0,u=t.__iterate(function(a,f){if(e?!r.has(a):i?!$(a,r.get(f,y)):!$(r.get(f,y),a))return s=!1,!1});return s&&r.size===u}function at(r,t){var e=function(n){r.prototype[n]=t[n]};return Object.keys(t).forEach(e),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(e),r}function Qt(r){if(!r||typeof r!="object")return r;if(!C(r)){if(!et(r))return r;r=U(r)}if(I(r)){var t={};return r.__iterate(function(n,i){t[i]=Qt(n)}),t}var e=[];return r.__iterate(function(n){e.push(Qt(n))}),e}var ur=function(r){function t(e){return e==null?At():Hr(e)&&!F(e)?e:At().withMutations(function(n){var i=r(e);k(i.size),i.forEach(function(o){return n.add(o)})})}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(n){return this(W(n).keySeq())},t.intersect=function(n){return n=z(n).toArray(),n.length?M.intersect.apply(t(n.pop()),n):At()},t.union=function(n){return n=z(n).toArray(),n.length?M.union.apply(t(n.pop()),n):At()},t.prototype.toString=function(){return this.__toString("Set {","}")},t.prototype.has=function(n){return this._map.has(n)},t.prototype.add=function(n){return xt(this,this._map.set(n,n))},t.prototype.remove=function(n){return xt(this,this._map.remove(n))},t.prototype.clear=function(){return xt(this,this._map.clear())},t.prototype.map=function(n,i){var o=this,s=!1,u=xt(this,this._map.mapEntries(function(a){var f=a[1],h=n.call(i,f,f,o);return h!==f&&(s=!0),[h,h]},i));return s?u:this},t.prototype.union=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return n=n.filter(function(o){return o.size!==0}),n.length===0?this:this.size===0&&!this.__ownerID&&n.length===1?this.constructor(n[0]):this.withMutations(function(o){for(var s=0;s<n.length;s++)r(n[s]).forEach(function(u){return o.add(u)})})},t.prototype.intersect=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(s){return r(s)});var o=[];return this.forEach(function(s){n.every(function(u){return u.includes(s)})||o.push(s)}),this.withMutations(function(s){o.forEach(function(u){s.remove(u)})})},t.prototype.subtract=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(s){return r(s)});var o=[];return this.forEach(function(s){n.some(function(u){return u.includes(s)})&&o.push(s)}),this.withMutations(function(s){o.forEach(function(u){s.remove(u)})})},t.prototype.sort=function(n){return $t(ct(this,n))},t.prototype.sortBy=function(n,i){return $t(ct(this,i,n))},t.prototype.wasAltered=function(){return this._map.wasAltered()},t.prototype.__iterate=function(n,i){var o=this;return this._map.__iterate(function(s){return n(s,s,o)},i)},t.prototype.__iterator=function(n,i){return this._map.__iterator(n,i)},t.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n);return n?this.__make(i,n):this.size===0?this.__empty():(this.__ownerID=n,this._map=i,this)},t}(lt);ur.isSet=Hr;var M=ur.prototype;M[fn]=!0;M[Ut]=M.remove;M.merge=M.concat=M.union;M.withMutations=Pt;M.asImmutable=Kt;M["@@transducer/init"]=M.asMutable=Wt;M["@@transducer/step"]=function(r,t){return r.add(t)};M["@@transducer/result"]=function(r){return r.asImmutable()};M.__empty=At;M.__make=pn;function xt(r,t){return r.__ownerID?(r.size=t.size,r._map=t,r):t===r._map?r:t.size===0?r.__empty():r.__make(t)}function pn(r,t){var e=Object.create(M);return e.size=r?r.size:0,e._map=r,e.__ownerID=t,e}var ve;function At(){return ve||(ve=pn(K()))}var fi=function(r){function t(e,n,i){if(!(this instanceof t))return new t(e,n,i);if(Cr(i!==0,"Cannot step a Range by 0"),e=e||0,n===void 0&&(n=1/0),i=i===void 0?1:Math.abs(i),n<e&&(i=-i),this._start=e,this._end=n,this._step=i,this.size=Math.max(0,Math.ceil((n-e)/i-1)+1),this.size===0){if(pr)return pr;pr=this}}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step!==1?" by "+this._step:"")+" ]"},t.prototype.get=function(n,i){return this.has(n)?this._start+rt(this,n)*this._step:i},t.prototype.includes=function(n){var i=(n-this._start)/this._step;return i>=0&&i<this.size&&i===Math.floor(i)},t.prototype.slice=function(n,i){return Vt(n,i,this.size)?this:(n=Dt(n,this.size),i=tr(i,this.size),i<=n?new t(0,0):new t(this.get(n,this._end),this.get(i,this._end),this._step))},t.prototype.indexOf=function(n){var i=n-this._start;if(i%this._step===0){var o=i/this._step;if(o>=0&&o<this.size)return o}return-1},t.prototype.lastIndexOf=function(n){return this.indexOf(n)},t.prototype.__iterate=function(n,i){for(var o=this.size,s=this._step,u=i?this._start+(o-1)*s:this._start,a=0;a!==o&&n(u,i?o-++a:a++,this)!==!1;)u+=i?-s:s;return a},t.prototype.__iterator=function(n,i){var o=this.size,s=this._step,u=i?this._start+(o-1)*s:this._start,a=0;return new l(function(){if(a===o)return j();var f=u;return u+=i?-s:s,O(n,i?o-++a:a++,f)})},t.prototype.equals=function(n){return n instanceof t?this._start===n._start&&this._end===n._end&&this._step===n._step:cn(this,n)},t}(Y),pr;function _n(r,t,e){for(var n=He(t),i=0;i!==n.length;)if(r=xe(r,n[i++],y),r===y)return e;return r}function dn(r,t){return _n(this,r,t)}function hi(r,t){return _n(r,t,y)!==y}function ci(r){return hi(this,r)}function vn(){k(this.size);var r={};return this.__iterate(function(t,e){r[e]=t}),r}z.isIterable=C;z.isKeyed=I;z.isIndexed=T;z.isAssociative=rr;z.isOrdered=F;z.Iterator=l;at(z,{toArray:function(){k(this.size);var t=new Array(this.size||0),e=I(this),n=0;return this.__iterate(function(i,o){t[n++]=e?[o,i]:i}),t},toIndexedSeq:function(){return new Ue(this)},toJS:function(){return Qt(this)},toKeyedSeq:function(){return new or(this,!0)},toMap:function(){return Ot(this.toKeyedSeq())},toObject:vn,toOrderedMap:function(){return Q(this.toKeyedSeq())},toOrderedSet:function(){return $t(I(this)?this.valueSeq():this)},toSet:function(){return ur(I(this)?this.valueSeq():this)},toSetSeq:function(){return new De(this)},toSeq:function(){return T(this)?this.toIndexedSeq():I(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Yr(I(this)?this.valueSeq():this)},toList:function(){return sr(I(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(t,e){return this.size===0?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return g(this,Pn(this,t))},includes:function(t){return this.some(function(e){return $(e,t)})},entries:function(){return this.__iterator(P)},every:function(t,e){k(this.size);var n=!0;return this.__iterate(function(i,o,s){if(!t.call(e,i,o,s))return n=!1,!1}),n},filter:function(t,e){return g(this,We(this,t,e,!0))},find:function(t,e,n){var i=this.findEntry(t,e);return i?i[1]:n},forEach:function(t,e){return k(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){k(this.size),t=t!==void 0?""+t:",";var e="",n=!0;return this.__iterate(function(i){n?n=!1:e+=t,e+=i!=null?i.toString():""}),e},keys:function(){return this.__iterator(kt)},map:function(t,e){return g(this,Pe(this,t,e))},reduce:function(t,e,n){return ye(this,t,e,n,arguments.length<2,!1)},reduceRight:function(t,e,n){return ye(this,t,e,n,arguments.length<2,!0)},reverse:function(){return g(this,Ar(this,!0))},slice:function(t,e){return g(this,Rr(this,t,e,!0))},some:function(t,e){return!this.every(Xt(t),e)},sort:function(t){return g(this,ct(this,t))},values:function(){return this.__iterator(J)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(t,e){return ht(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return Dn(this,t,e)},equals:function(t){return cn(this,t)},entrySeq:function(){var t=this;if(t._cache)return new st(t._cache);var e=t.toSeq().map(_i).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(Xt(t),e)},findEntry:function(t,e,n){var i=n;return this.__iterate(function(o,s,u){if(t.call(e,o,s,u))return i=[s,o],!1}),i},findKey:function(t,e){var n=this.findEntry(t,e);return n&&n[0]},findLast:function(t,e,n){return this.toKeyedSeq().reverse().find(t,e,n)},findLastEntry:function(t,e,n){return this.toKeyedSeq().reverse().findEntry(t,e,n)},findLastKey:function(t,e){return this.toKeyedSeq().reverse().findKey(t,e)},first:function(t){return this.find(Oe,null,t)},flatMap:function(t,e){return g(this,Wn(this,t,e))},flatten:function(t){return g(this,Fe(this,t,!0))},fromEntrySeq:function(){return new Be(this)},get:function(t,e){return this.find(function(n,i){return $(i,t)},void 0,e)},getIn:dn,groupBy:function(t,e){return Bn(this,t,e)},has:function(t){return this.get(t,y)!==y},hasIn:ci,isSubset:function(t){return t=typeof t.includes=="function"?t:z(t),this.every(function(e){return t.includes(e)})},isSuperset:function(t){return t=typeof t.isSubset=="function"?t:z(t),t.isSubset(this)},keyOf:function(t){return this.findKey(function(e){return $(e,t)})},keySeq:function(){return this.toSeq().map(pi).toIndexedSeq()},last:function(t){return this.toSeq().reverse().first(t)},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return Jt(this,t)},maxBy:function(t,e){return Jt(this,e,t)},min:function(t){return Jt(this,t?le(t):Se)},minBy:function(t,e){return Jt(this,e?le(e):Se,t)},rest:function(){return this.slice(1)},skip:function(t){return t===0?this:this.slice(Math.max(0,t))},skipLast:function(t){return t===0?this:this.slice(0,-Math.max(0,t))},skipWhile:function(t,e){return g(this,Ke(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(Xt(t),e)},sortBy:function(t,e){return g(this,ct(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return this.slice(-Math.max(0,t))},takeWhile:function(t,e){return g(this,kn(this,t,e))},takeUntil:function(t,e){return this.takeWhile(Xt(t),e)},update:function(t){return t(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=di(this))}});var q=z.prototype;q[ze]=!0;q[er]=q.values;q.toJSON=q.toArray;q.__toStringMapper=Tt;q.inspect=q.toSource=function(){return this.toString()};q.chain=q.flatMap;q.contains=q.includes;at(W,{flip:function(){return g(this,ke(this))},mapEntries:function(t,e){var n=this,i=0;return g(this,this.toSeq().map(function(o,s){return t.call(e,[s,o],i++,n)}).fromEntrySeq())},mapKeys:function(t,e){var n=this;return g(this,this.toSeq().flip().map(function(i,o){return t.call(e,i,o,n)}).flip())}});var Ft=W.prototype;Ft[be]=!0;Ft[er]=q.entries;Ft.toJSON=vn;Ft.__toStringMapper=function(r,t){return Tt(t)+": "+Tt(r)};at(ut,{toKeyedSeq:function(){return new or(this,!1)},filter:function(t,e){return g(this,We(this,t,e,!1))},findIndex:function(t,e){var n=this.findEntry(t,e);return n?n[0]:-1},indexOf:function(t){var e=this.keyOf(t);return e===void 0?-1:e},lastIndexOf:function(t){var e=this.lastKeyOf(t);return e===void 0?-1:e},reverse:function(){return g(this,Ar(this,!1))},slice:function(t,e){return g(this,Rr(this,t,e,!1))},splice:function(t,e){var n=arguments.length;if(e=Math.max(e||0,0),n===0||n===2&&!e)return this;t=Dt(t,t<0?this.count():this.size);var i=this.slice(0,t);return g(this,n===1?i:i.concat(x(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var n=this.findLastEntry(t,e);return n?n[0]:-1},first:function(t){return this.get(0,t)},flatten:function(t){return g(this,Fe(this,t,!1))},get:function(t,e){return t=rt(this,t),t<0||this.size===1/0||this.size!==void 0&&t>this.size?e:this.find(function(n,i){return i===t},void 0,e)},has:function(t){return t=rt(this,t),t>=0&&(this.size!==void 0?this.size===1/0||t<this.size:this.indexOf(t)!==-1)},interpose:function(t){return g(this,Kn(this,t))},interleave:function(){var t=[this].concat(x(arguments)),e=Yt(this.toSeq(),Y.of,t),n=e.flatten(!0);return e.size&&(n.size=e.size*t.length),g(this,n)},keySeq:function(){return fi(0,this.size)},last:function(t){return this.get(-1,t)},skipWhile:function(t,e){return g(this,Ke(this,t,e,!1))},zip:function(){var t=[this].concat(x(arguments));return g(this,Yt(this,ge,t))},zipAll:function(){var t=[this].concat(x(arguments));return g(this,Yt(this,ge,t,!0))},zipWith:function(t){var e=x(arguments);return e[0]=this,g(this,Yt(this,t,e))}});var It=ut.prototype;It[Me]=!0;It[gt]=!0;at(lt,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}});var vt=lt.prototype;vt.has=q.includes;vt.contains=vt.includes;vt.keys=vt.values;at(nt,Ft);at(Y,It);at(mt,vt);function ye(r,t,e,n,i,o){return k(r.size),r.__iterate(function(s,u,a){i?(i=!1,e=s):e=t.call(n,e,s,u,a)},o),e}function pi(r,t){return t}function _i(r,t){return[t,r]}function Xt(r){return function(){return!r.apply(this,arguments)}}function le(r){return function(){return-r.apply(this,arguments)}}function ge(){return x(arguments)}function Se(r,t){return r<t?1:r>t?-1:0}function di(r){if(r.size===1/0)return 0;var t=F(r),e=I(r),n=t?1:0,i=r.__iterate(e?t?function(o,s){n=31*n+me(L(o),L(s))|0}:function(o,s){n=n+me(L(o),L(s))|0}:t?function(o){n=31*n+L(o)|0}:function(o){n=n+L(o)|0});return vi(i,n)}function vi(r,t){return t=bt(t,3432918353),t=bt(t<<15|t>>>-15,461845907),t=bt(t<<13|t>>>-13,5),t=(t+3864292196|0)^r,t=bt(t^t>>>16,2246822507),t=bt(t^t>>>13,3266489909),t=ir(t^t>>>16),t}function me(r,t){return r^t+2654435769+(r<<6)+(r>>2)|0}var $t=function(r){function t(e){return e==null?wr():hn(e)?e:wr().withMutations(function(n){var i=lt(e);k(i.size),i.forEach(function(o){return n.add(o)})})}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(n){return this(W(n).keySeq())},t.prototype.toString=function(){return this.__toString("OrderedSet {","}")},t}(ur);$t.isOrderedSet=hn;var ft=$t.prototype;ft[gt]=!0;ft.zip=It.zip;ft.zipWith=It.zipWith;ft.zipAll=It.zipAll;ft.__empty=wr;ft.__make=yn;function yn(r,t){var e=Object.create(ft);return e.size=r?r.size:0,e._map=r,e.__ownerID=t,e}var we;function wr(){return we||(we=yn(Mt()))}function yi(r){if(Bt(r))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(X(r))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(r===null||typeof r!="object")throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}var E=function(t,e){var n;yi(t);var i=function(u){var a=this;if(u instanceof i)return u;if(!(this instanceof i))return new i(u);if(!n){n=!0;var f=Object.keys(t),h=o._indices={};o._name=e,o._keys=f,o._defaultValues=t;for(var c=0;c<f.length;c++){var p=f[c];h[p]=c,o[p]?typeof console=="object"&&console.warn&&console.warn("Cannot define "+Xr(this)+' with property "'+p+'" since that property name is part of the Record API.'):li(o,p)}}return this.__ownerID=void 0,this._values=sr().withMutations(function(d){d.setSize(a._keys.length),W(u).forEach(function(_,v){d.set(a._indices[v],_===a._defaultValues[v]?void 0:_)})}),this},o=i.prototype=Object.create(S);return o.constructor=i,e&&(i.displayName=e),i};E.prototype.toString=function(){for(var t=Xr(this)+" { ",e=this._keys,n,i=0,o=e.length;i!==o;i++)n=e[i],t+=(i?", ":"")+n+": "+Tt(this.get(n));return t+" }"};E.prototype.equals=function(t){return this===t||t&&yt(this).equals(yt(t))};E.prototype.hashCode=function(){return yt(this).hashCode()};E.prototype.has=function(t){return this._indices.hasOwnProperty(t)};E.prototype.get=function(t,e){if(!this.has(t))return e;var n=this._indices[t],i=this._values.get(n);return i===void 0?this._defaultValues[t]:i};E.prototype.set=function(t,e){if(this.has(t)){var n=this._values.set(this._indices[t],e===this._defaultValues[t]?void 0:e);if(n!==this._values&&!this.__ownerID)return xr(this,n)}return this};E.prototype.remove=function(t){return this.set(t)};E.prototype.clear=function(){var t=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:xr(this,t)};E.prototype.wasAltered=function(){return this._values.wasAltered()};E.prototype.toSeq=function(){return yt(this)};E.prototype.toJS=function(){return Qt(this)};E.prototype.entries=function(){return this.__iterator(P)};E.prototype.__iterator=function(t,e){return yt(this).__iterator(t,e)};E.prototype.__iterate=function(t,e){return yt(this).__iterate(t,e)};E.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._values.__ensureOwner(t);return t?xr(this,e,t):(this.__ownerID=t,this._values=e,this)};E.isRecord=Bt;E.getDescriptiveName=Xr;var S=E.prototype;S[Ae]=!0;S[Ut]=S.remove;S.deleteIn=S.removeIn=Nr;S.getIn=dn;S.hasIn=q.hasIn;S.merge=Ge;S.mergeWith=Qe;S.mergeIn=Br;S.mergeDeep=tn;S.mergeDeepWith=rn;S.mergeDeepIn=kr;S.setIn=jr;S.update=Lr;S.updateIn=$r;S.withMutations=Pt;S.asMutable=Wt;S.asImmutable=Kt;S[er]=S.entries;S.toJSON=S.toObject=q.toObject;S.inspect=S.toSource=function(){return this.toString()};function xr(r,t,e){var n=Object.create(Object.getPrototypeOf(r));return n._values=t,n.__ownerID=e,n}function Xr(r){return r.constructor.displayName||r.constructor.name||"Record"}function yt(r){return br(r._keys.map(function(t){return[t,r.get(t)]}))}function li(r,t){try{Object.defineProperty(r,t,{get:function(){return this.get(t)},set:function(e){Cr(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}catch(e){}}var mn=Zr(En()),wn=Zr(gn());function gi(r,t){return E({...t,room:r,state:E(t.state)()})}var Et={},On=class{constructor(t,e){zt(this,"session");zt(this,"hashCodeSession");zt(this,"room","");zt(this,"created",new Date().toISOString());let n=null;this.room=t,this.session=gi(t,{...e,state:n||e.state,capabilities:{...e.capabilities,sessionStorage:mi("sessionStorage")}})(),this.hashCodeSession=this.session.get("state").hashCode(),Et[this.session.get("state").hashCode()]=this.session.get("state")}addEvent(t){this.session.get("events").push({...t}),setTimeout(()=>this.processEvents)}hashCode(){return this.session.get("state").hashCode()}processEvents(){let t=this.session.get("events"),e=t.shift();if(e)switch(e.type){case"code-init":let{code:n,transpiled:i,i:o,css:s,errorDiff:u,html:a}=e,f={code:n,transpiled:i,i:o,css:s,errorDiff:u,html:a};this.session.set("events",t),this.session.set("state",E(f)())}}createPatchFromHashCode(t,e){if(Et[t]){let n=Et[t],i=JSON.stringify(n.toJSON()),o=n.merge(e),s=o.hashCode();Et[s]=o;let u=JSON.stringify(o.toJSON()),a=Sn(i,u);return{oldHash:t,newHash:s,patch:a}}}createPatch(t){if(t.code===this.session.get("state").get("code"))return{oldHash:this.session.get("state").hashCode(),newHash:this.session.get("state").hashCode(),patch:""};let e=JSON.stringify(this.session.get("state").toJSON()),n=this.session.get("state").hashCode();Et[n]=this.session.get("state");let o=this.session.get("state").merge(t),s=o.hashCode();Et[s]=o;let u=JSON.stringify(o.toJSON()),a=Sn(e,u);return{oldHash:n,newHash:s,patch:a}}applyPatch({oldHash:t,newHash:e,patch:n}){if(this.session.get("state").hashCode()!==t){console.error("Cant update");return}let o=this.session.get("state").toJSON(),s=JSON.stringify(o),u=o.code,a=JSON.parse((0,wn.default)(s,JSON.parse(n))),f=E(a)();console.log({newState:a}),console.log(f.hashCode());let h=this.session.get("state").merge(f),c=h.get("code");if(u===c)return;console.log(h.hashCode()),h.hashCode()===e?this.session=this.session.set("state",h):(console.log("WRONG"),console.log({newState:a}))}json(){let t=this.session.toJSON(),e=t.state.toJSON();return{...t,state:e}}setRoom(t){let e=this.session.set("room",t);this.session=e}},Si=null,bi=(r,t)=>Si||new On(r,t);function mi(r){try{if(!window.hasOwnProperty(r))return;let t=window[r],e="__storage_test__";return t.setItem(e,e),t.removeItem(e),!0}catch(t){return!1}}function Sn(r,t){return JSON.stringify((0,mn.default)(r,t))}export{On as CodeSession,bi as default};
